{"./":{"url":"./","title":"ğŸ“– ï¸ä¿ºã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µã‚¤ãƒˆã«ã¤ã„ã¦","keywords":"","body":"ä¿ºã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µã‚¤ãƒˆã«ã¤ã„ã¦ ã‚µã‚¤ãƒˆã®ä½œæˆæ–¹æ³• GitBookã‚’ä½¿ç”¨ã—ã¦ã€mdãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰HTMLã‚’ç”Ÿæˆã—ã¦ãŠã‚Šã¾ã™ã€‚ ç”Ÿæˆå…ƒã®mdãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€hiroki-it/tech-notebook-gitbook ãƒªãƒã‚¸ãƒˆãƒªã«ã¦ç®¡ç†ã—ã¦ãŠã‚Šã¾ã™ã€‚ ä½¿ã„æ–¹ æ¤œç´¢ã‹ã‚‰ ã‚¹ãƒãƒ›ã§ã¯ãªãã€PCã§ä½¿ç”¨ã—ã¾ã™ã€‚ ç”»é¢å·¦ä¸Šã®æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ æ¤œç´¢çµæœãŒè¤‡æ•°ã®ãƒãƒ¼ãƒˆã«ã¾ãŸãŒã‚‹å ´åˆã€ãƒãƒ¼ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…ƒã«ã€å‚ç…§ã™ã‚‹ã¹ããƒãƒ¼ãƒˆã‚’åˆ¤æ–­ã—ã¾ã™ã€‚ ãƒãƒ¼ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ æ¤œç´¢çµæœã‹ã‚‰ã¯ã€ãƒãƒ¼ãƒˆå†…ã§ä¸€ç•ªæœ€åˆã«å‡ºç¾ã—ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«ã—ã‹ã‚¸ãƒ£ãƒ³ãƒ—ã§ãã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒ¼ãƒˆå†…ã§æ”¹ã‚ã¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ ç›®æ¬¡ã‹ã‚‰ ã‚¹ãƒãƒ›ã§ã¯ãªãã€PCã§ä½¿ç”¨ã—ã¾ã™ã€‚ ç›®æ¬¡ãƒšãƒ¼ã‚¸ ã‚’ç¢ºèªã—ã¾ã™ã€‚ ãƒãƒ¼ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ ã‚µã‚¤ãƒˆã®ç›®çš„ ã©ã“ã«ã§ã‚‚ã„ã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã® é•·è°·å·åºƒæ¨¹ ãŒã€ä»¥ä¸‹ã®ç›®çš„ã®ãŸã‚ã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã—ãŸã“ã¨ã‚’è‡ªåˆ†ã®è¨€è‘‰ã§æ›¸ãã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’è¡Œã†ã€‚ èª¤ã£ãŸçŸ¥è­˜ã‚’ãã®éƒ½åº¦ä¿®æ­£ã—ã€ã¾ãŸä½“ç³»çš„ã«æ•´ç†ã™ã‚‹ã€‚ ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã—ãŸå†…å®¹ã‚’æ€ã„å‡ºã™ãŸã‚ã«é–²è¦§ã™ã‚‹ã€‚ ãã®ãŸã‚ã€èª¤ã£ãŸæƒ…å ±ã€èª¤ã£ãŸä½“ç³»åŒ–ã€ã‚ã‹ã‚Šã«ãã„æ—¥æœ¬èªã€ãŒå¤šãæ•£è¦‹ã•ã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚ ã“ã‚Œã‚‰ã«ã¤ãã¾ã—ã¦ã¯ã€ã”å®¹èµ¦ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚ å­¦ç¿’æ–¹æ³• æœ¬ã‚µã‚¤ãƒˆã§ã¯ã€ä»¥ä¸‹ã‚’è¨˜è¼‰ã—ã€ãã®æ¦‚å¿µã‚’å­¦ç¿’ã™ã‚‹ã‚ˆã†ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚ å®šç¾©ã¥ã‘ï¼ˆæ¼”ç¹¹çš„ãªå­¦ç¿’ï¼‰ ä¾‹ï¼ˆå¸°ç´çš„ãªå­¦ç¿’ï¼‰ æ¦‚å¿µå›³ï¼ˆè¦–è¦šå„ªä½ãªå­¦ç¿’ï¼‰ ãã®ãŸã‚ã€å†—é•·ãªè¨˜è¼‰ã¨ãªã‚‹ã“ã¨ã‚’ã”å®¹èµ¦ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚ ãŠã‚ã³ ã“ã®ã‚µã‚¤ãƒˆã§ä½¿ã‚ã‚Œã¦ã„ã‚‹èª¬æ˜ã‚„ç”»åƒã«ã¤ãã¾ã—ã¦ã€æ§˜ã€…ãªæ›¸ç±ã‚„ã‚µã‚¤ãƒˆã‹ã‚‰å¼•ç”¨ã•ã›ã¦ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã€‚ ã‚ãã¾ã§ã€ä¸Šè¨˜ã®ç›®çš„ã®ãŸã‚ã ã‘ã«ä½¿ç”¨ã•ã›ã¦ã„ãŸã ãã¨ã„ã†åç›®ã§ã€å¼•ç”¨å…ƒã‚’ååˆ†ã«è¨˜è¼‰ã—ã¦ãŠã‚Šã¾ã›ã‚“ã€‚ æ·±ããŠè©«ã³ç”³ã—ä¸Šã’ã¾ã™ã€‚ "},"public/self_introduction.html":{"url":"public/self_introduction.html","title":"ğŸ“– ï¸ã‚µã‚¤ãƒˆç®¡ç†è€…","keywords":"","body":"ã‚µã‚¤ãƒˆç®¡ç†è€… çµŒæ­´ é•·è°·å·åºƒæ¨¹ã¨ç”³ã—ã¾ã™ã€‚ 2019å¹´ã«ç†å­¦ä¿®å£«ã‚’ç¿’å¾—ã—ã€å¤§å­¦é™¢ã‚’å’æ¥­å¾Œã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ ã¨ã—ã¦ã‚­ãƒ£ãƒªã‚¢ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆã„ãŸã—ã¾ã—ãŸã€‚ ç¾åœ¨ã¯ã€SRE ã¨ã—ã¦åƒã‹ã•ã›ã¦ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã€‚ è©³ã—ãã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã¾ã§ã”è¨ªå•ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚ â–¶ GitHubï¼šhttps://github.com/hiroki-it â–¶ Wantedlyï¼šhttps://www.wantedly.com/id/h_hasegawa â–¶ Speaker Deckï¼šhttps://speakerdeck.com/hiroki_hasegawa é–¢å¿ƒã®ã‚ã‚‹æŠ€è¡“é ˜åŸŸ æ‹¡å¼µæ€§ã€ä¿å®ˆæ€§ã€å¯èª­æ€§ã‚’é«˜ã‚ã‚‹æŠ€è¡“ã«é–¢å¿ƒãŒã”ã–ã„ã¾ã™ã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã€IaCã€ã‚³ãƒ³ãƒ†ãƒŠã€CI/CDã€Goã€etc... "},"public/summary.html":{"url":"public/summary.html","title":"ğŸ“– ï¸ç›®æ¬¡","keywords":"","body":"ç›®æ¬¡ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ &#x1F4D6; ï¸ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆOSï¼‰ &#x1F4D6; ï¸ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ &#x1F4D6; ï¸ã‚«ãƒ¼ãƒãƒ« è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µ &#x1F4D6; ï¸è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µ &#x1F4D6; ï¸è¨€èªåˆ¥ã®å‡¦ç†æ–¹å¼ &#x1F4D6; ï¸æ©Ÿæ¢°èªã¨é€²æ•° ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ Webé–¢é€£ &#x1F4D6; ï¸Nginx &#x1F4D6; ï¸Apache ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–¢é€£ &#x1F4D6; ï¸PHP-FPM ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ &#x1F4D6; ï¸ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ &#x1F4D6; Myï¸SQL ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ &#x1F4D6; ï¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ &#x1F4D6; ï¸ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ &#x1F4D6; ï¸ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆ &#x1F4D6; ï¸ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ &#x1F4D6; ï¸CQRS ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ &#x1F4D6; ï¸ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“é€£æº &#x1F4D6; ï¸JSON &#x1F4D6; ï¸ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“é€šä¿¡ &#x1F4D6; ï¸èªè¨¼ï¼èªå¯ RESTful-API &#x1F4D6; ï¸RESTful-API &#x1F4D6; ï¸APIä»•æ§˜æ›¸ è¨€èª ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘å‹è¨€èª PHP &#x1F4D6; PHPã‚³ãƒãƒ³ãƒ‰ã¨è¨­å®š ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ &#x1F4D6; ï¸ã‚¯ãƒ©ã‚¹ &#x1F4D6; ï¸ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿ &#x1F4D6; ï¸ãƒ‡ãƒ¼ã‚¿æ§‹é€  ãƒ­ã‚¸ãƒƒã‚¯ &#x1F4D6; ï¸æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ &#x1F4D6; ï¸ã‚¨ãƒ©ãƒ¼ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° &#x1F4D6; ï¸åå¾©ãƒ­ã‚¸ãƒƒã‚¯ &#x1F4D6; ï¸ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ &#x1F4D6; ï¸Laravel &#x1F4D6; ï¸Symfony ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ &#x1F4D6; ï¸ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç† &#x1F4D6; ï¸MySQLãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ &#x1F4D6; ï¸ãã®ä»–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒ†ã‚¹ãƒˆ &#x1F4D6; ï¸ãƒ†ã‚¹ãƒˆ &#x1F4D6; ï¸ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ &#x1F4D6; ï¸ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ ãƒ‡ãƒãƒƒã‚° &#x1F4D6; ï¸ãƒ‡ãƒãƒƒã‚° JavaScript ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒ™ãƒ¼ã‚¹ &#x1F4D6; ï¸ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ— &#x1F4D6; ï¸ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿ ãƒ­ã‚¸ãƒƒã‚¯ &#x1F4D6; ï¸æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ &#x1F4D6; ï¸éåŒæœŸå‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ &#x1F4D6; ï¸ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ &#x1F4D6; ï¸Vue.js &#x1F4D6; ï¸Nuxt.js ãƒ‡ãƒãƒƒã‚° &#x1F4D6; ï¸ãƒ‡ãƒãƒƒã‚° ãƒ–ãƒ©ã‚¦ã‚¶ &#x1F4D6; ï¸ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° æ‰‹ç¶šãå‹è¨€èª Go &#x1F4D6; Goã¨ã¯ &#x1F4D6; Goã‚³ãƒãƒ³ãƒ‰ã¨è¨­å®š ãƒ­ã‚¸ãƒƒã‚¯ &#x1F4D6; ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ &#x1F4D6; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ &#x1F4D6; Gin ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ &#x1F4D6; ï¸ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ &#x1F4D6;ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç† &#x1F4D6; ï¸çµ„ã¿è¾¼ã¿æ©Ÿå™¨ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ &#x1F4D6; ï¸ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ &#x1F4D6; ï¸OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ï¼TCPéšå±¤ãƒ¢ãƒ‡ãƒ« ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ &#x1F4D6; ï¸ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒ &#x1F4D6; ï¸é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–æŠ€è¡“ ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° &#x1F4D6; ï¸ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° AWS &#x1F4D6; ï¸AWS &#x1F4D6; ï¸API Gatewayã¸ã®ymlã‚¤ãƒ³ãƒãƒ¼ãƒˆ &#x1F4D6; ï¸Lambdaé–¢æ•°ã®å®Ÿè£… &#x1F4D6; ï¸ã‚³ã‚¹ãƒˆç®¡ç† GCP &#x1F4D6; ï¸GCP Infrastructure as Code &#x1F4D6; ï¸Infrastructure as Code Terraform &#x1F4D6; ï¸terraformã‚³ãƒãƒ³ãƒ‰ &#x1F4D6; ï¸Terraformã®å®Ÿè£… &#x1F4D6; ï¸AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ &#x1F4D6; ï¸Terraformã®CICDãƒ•ãƒ­ãƒ¼ Serverless Framework &#x1F4D6; ï¸serverlessã‚³ãƒãƒ³ãƒ‰ &#x1F4D6; ï¸serverless.yml ä»®æƒ³åŒ– &#x1F4D6; ï¸ä»®æƒ³åŒ– ã‚³ãƒ³ãƒ†ãƒŠ Docker &#x1F4D6; ï¸dockerã‚³ãƒãƒ³ãƒ‰ &#x1F4D6; ï¸Dockerfile ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ &#x1F4D6; ï¸ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ Docker Compose &#x1F4D6; ï¸docker-composeã‚³ãƒãƒ³ãƒ‰ &#x1F4D6; ï¸docker-compose.yml Kubernetes &#x1F4D6; ï¸kubernetesã‚³ãƒãƒ³ãƒ‰ &#x1F4D6; ï¸manifest.yml &#x1F4D6; ï¸Istio &#x1F4D6; ï¸Docker Swarm ï¸ä»®æƒ³ã‚µãƒ¼ãƒï¼ˆä»®æƒ³ãƒã‚·ãƒ³ï¼‰ &#x1F4D6; ï¸ä»®æƒ³ã‚µãƒ¼ãƒï¼ˆä»®æƒ³ãƒã‚·ãƒ³ï¼‰ CICD &#x1F4D6; ï¸CICD &#x1F4D6; ï¸CircleCI &#x1F4D6; ï¸Capistrano å¯è¦³æ¸¬æ€§ï¼ç›£è¦– &#x1F4D6; ï¸å¯è¦³æ¸¬æ€§ &#x1F4D6; ï¸ç›£è¦– Fluentdï¼FluentBit &#x1F4D6; ï¸Fluentdï¼FluentBit &#x1F4D6; ï¸FluentBit Datadog &#x1F4D6; ï¸ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›† &#x1F4D6; ï¸ãƒ­ã‚°åé›† &#x1F4D6; åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹åé›† &#x1F4D6; ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼é–“ã®ç´ä»˜ã‘ &#x1F4D6; ï¸ç›£è¦– ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³•è«– &#x1F4D6; ï¸ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³•è«– &#x1F4D6; ï¸ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç† Git &#x1F4D6; ï¸GitHub &#x1F4D6; ï¸Gitã‚³ãƒãƒ³ãƒ‰ çµ±è¨ˆè§£æ &#x1F4D6; ï¸Rè¨€èª "},"public/software/software.html":{"url":"public/software/software.html","title":"ğŸ“– ï¸ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢","keywords":"","body":"ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¨ã¯ ãƒ¦ãƒ¼ã‚¶ã®æ“ä½œã«ã‚ˆã‚‹å‘½ä»¤ã®æµã‚Œ ãƒ¦ãƒ¼ã‚¶ã®æ“ä½œã«ã‚ˆã‚‹å‘½ä»¤ãŒã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ä»‹ã—ã¦ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã«ä¼ã‚ã‚‹ã¾ã§ã€ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ç¨®é¡ 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆå¿œç”¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼‰ 2. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ 3. åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆåºƒç¾©ã®OSï¼‰ 4. Firmware 5. ãƒ‡ãƒã‚¤ã‚¹ãƒ‰ãƒ©ã‚¤ãƒ 02. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆå¿œç”¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼‰ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä¸€è¦§ ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒª Webã‚¢ãƒ—ãƒªã¨ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¢ãƒ—ãƒª ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒª åˆ©ç”¨å¯èƒ½ãªé€šä¿¡çŠ¶æ³ Onï¼Off On Onï¼Off ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ç«¯æœ«ã®ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦ç¨¼åƒã™ã‚‹ã‚¢ãƒ—ãƒªã®ã“ã¨ã€‚ä¸€åº¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã—ã¾ãˆã°ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ç¹‹ãŒã£ã¦ã„ãªãã¨ã‚‚ã€ä½¿ç”¨ã§ãã‚‹ã€‚ ï¼Šä¾‹ï¼Š Officeã€BookLiveã®ã‚¢ãƒ—ãƒªç‰ˆ Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ»Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ Webã‚µãƒ¼ãƒä¸Šã§ç¨¼åƒã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã“ã¨ã€‚URLã‚’Webã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã“ã¨ã§åˆ©ç”¨ã§ãã€éšæ™‚ã€Webã‚µãƒ¼ãƒã¨ãƒ‡ãƒ¼ã‚¿é€šä¿¡ã‚’è¡Œã†ã€‚å…¨ã¦ã®äººãŒç„¡æ–™ã§åˆ©ç”¨ã§ãã‚‹ã‚‚ã®ã¨ã€ãŠé‡‘ã‚’æ‰•ã£ãŸäººã ã‘ãŒåˆ©ç”¨ã§ãã‚‹ã‚‚ã®ãŒã‚ã‚‹ã€‚ ï¼Šä¾‹ï¼Š Googleã‚¢ãƒ—ãƒªã€Amazonã€BookLiveã®ãƒ–ãƒ©ã‚¦ã‚¶ç‰ˆã€ã‚µã‚¤ãƒœã‚¦ã‚º ãƒ»ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ Webã‚µãƒ¼ãƒä¸Šã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«ã‚ˆã£ã¦ç¨¼åƒã™ã‚‹ã‚¢ãƒ—ãƒªã®ã†ã¡ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š Google Driveã€Dropbox ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ç«¯æœ«ã§Webviewã‚’ç¨¼åƒã•ã›ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®HTLMãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’Webviewä¸Šã§è¡Œã†ã‚¢ãƒ—ãƒªã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š ã‚¯ãƒƒã‚¯ãƒ‘ãƒƒãƒ‰ 03. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ Webã‚µãƒ¼ãƒã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ ãƒ»Apache å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_web_apache.html ãƒ»Nginx å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_web_nginx.html Appã‚µãƒ¼ãƒã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ ãƒ»Apacheã®æ‹¡å¼µãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_web_apache.html ãƒ»PHP-FPMï¼šPHP FastCGI Process Manager å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_application_php_fpm.html ãƒ»NGINX Unit Webã‚µãƒ¼ãƒã®Nginxã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã§ãã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€‚ DBã‚µãƒ¼ãƒã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ ãƒ»MySQL ãƒ»MariaDB 04. åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆåºƒç¾©ã®OSï¼‰ åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ç¨®é¡ ãƒ»Unixç³»OS Unixã‚’æºæµã¨ã—ã¦æ´¾ç”Ÿã—ãŸOSã€‚ç¾åœ¨ã§ã¯ä¸»ã«ã€Linuxç³»çµ±ï¼ˆç·‘è‰²ï¼‰ã€BSDç³»çµ±ï¼ˆé»„è‰²ï¼‰ã€SystemVç³»çµ±ï¼ˆé’è‰²ï¼‰ã®ä¸‰ã¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚ â€»ã¡ãªã¿ã«ã€MacOSã¯BSDç³»çµ± ãƒ»WindowsOS MS-DOSã‚’æºæµã¨ã—ã¦æ´¾ç”Ÿã—ãŸOSã€‚ä»Šã§ã¯ã€å…¨ã¦ã®æ´¾ç”ŸãŒWindows 10ã«é›†ç´„ã•ã‚ŒãŸã€‚ åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ ãƒ»åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ§‹æˆ ãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ãƒ»è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µ ãƒ»åˆ¶å¾¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼ˆã‚«ãƒ¼ãƒãƒ«ï¼‰ 04-02. Unixç³»OS Linuxç³»çµ± ãƒ»OSã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç¢ºèªã‚³ãƒãƒ³ãƒ‰ OSã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ/etc/issueãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã€‚ $ cat /etc/issue Debian GNU/Linux 10 \\n \\l ç¾åœ¨ã€Linuxç³»çµ±ã®OSã¯ã€ã•ã‚‰ã«3ã¤ã®ç³»çµ±ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚ ãƒ»RedHatç³»çµ± RedHatã€CentOSã€Fedora ãƒ»Debianç³»çµ± Debianã€Ubuntuã€ ãƒ»Slackwareç³»çµ± Slackware BSDç³»çµ±ï½œMacOS ãƒ»ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªã™ã‚‹ã€‚å…¨ã¦ã®é …ç›®ã¯ã€å®Ÿéš›ã«å®Ÿè¡Œã—ã¦ç¢ºèªã™ã‚‹ã“ã¨ã€‚ $ export -p export EDITOR=vim export HOME=/Users/h.hasegawa export LANG=en_US.UTF-8 export SHELL=/bin/zsh export USER=h.hasegawa export VISUAL=vim ... 05. ãƒ‡ãƒã‚¤ã‚¹ãƒ‰ãƒ©ã‚¤ãƒ ãƒ‡ãƒã‚¤ã‚¹ãƒ‰ãƒ©ã‚¤ãƒã¨ã¯ è¦å‹‰å¼· 06. Firmware Firmwareã¨ã¯ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ ï¼‹ åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼‰ã¨ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®é–“ã®æ®µéšã«ã‚ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã€‚ROMã«çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã€‚ BIOSï¼šBasic Input/Output System UEFIï¼šUnited Extensible Firmware Interface Windows 8ä»¥é™ã§æ¡ç”¨ã•ã‚Œã¦ã„ã‚‹æ–°ã—ã„Firmware 07. OSSï¼šOpen Source Software OSSã¨ã¯ ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’OSSã¨å‘¼ã¶ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‹ã‚‰åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¾ã§ã€æ§˜ã€…ãªã‚‚ã®ãŒã‚ã‚‹ã€‚ åˆ©ç”¨è€…ã¯ã€ç„¡å„Ÿã‚ã‚‹ã„ã¯æœ‰å„Ÿã§è‡ªç”±ã«å†é…å¸ƒã§ãã‚‹ã€‚ åˆ©ç”¨è€…ã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å…¥æ‰‹ã§ãã‚‹ã€‚ åˆ©ç”¨è€…ã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’è‡ªç”±ã«å¤‰æ›´ã§ãã‚‹ã€‚ã¾ãŸã€å¤‰æ›´å¾Œã«æä¾›ã™ã‚‹å ´åˆã€ç•°ãªã‚‹ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã§ãã‚‹ã€‚ å·®åˆ†æƒ…å ±ã®é…å¸ƒã‚’èªã‚ã‚‹å ´åˆã«ã¯ã€åŒä¸€æ€§ã®ä¿æŒã‚’è¦æ±‚ã—ã¦ã‚‚ã‹ã¾ã‚ãªã„ã€‚ â‡’ ã‚ˆãã‚ã‹ã‚‰ãªã„ æä¾›è€…ã¯ã€ç‰¹å®šã®å€‹äººã‚„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å·®åˆ¥ã§ããªã„ã€‚ æä¾›è€…ã¯ã€ç‰¹å®šã®åˆ†é‡ã‚’å·®åˆ¥ã§ããªã„ã€‚ æä¾›è€…ã¯ã€å…¨ãåŒã˜OSSã®å†é…å¸ƒã«ãŠã„ã¦ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã§ããªã„ã€‚ æä¾›è€…ã¯ã€ç‰¹å®šã®è£½å“ã§ã®ã¿æœ‰åŠ¹ãªãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã§ããªã„ã€‚ æä¾›è€…ã¯ã€ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’åˆ¶é™ã™ã‚‹ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã§ããªã„ã€‚ æä¾›è€…ã¯ã€æŠ€è¡“çš„ã«åã‚Šã®ã‚ã‚‹ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã§ããªã„ã€‚ ç¨®é¡ å¼•ç”¨ï¼šhttps://openstandia.jp/oss_info/ "},"public/software/software_basic_utility.html":{"url":"public/software/software_basic_utility.html","title":"ğŸ“– ï¸ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£","keywords":"","body":"ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®ç¨®é¡ Unixã®å ´åˆ ä»Šå›ã€ä»¥ä¸‹ã«ç´¹ä»‹ã™ã‚‹ã‚‚ã®ã‚’ã¾ã¨ã‚ã‚‹ã€‚RedHatç³»ã¨Debianç³»ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãŒå…¥ã‚Šæ··ã˜ã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŸã‚ã€è¦èª¿æŸ»ã€‚ ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ç³» ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ç³» ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç³» ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ç³» ç’°å¢ƒå¤‰æ•°ç³» ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ç³» mkdir batch nslookup tail export df ls ps curl vim printenv free cp kill netstat grep timedatectl - find systemctl route history - - chmod cron ssh - - - rm - - - - - chown - - - - - ln - - - - - od - - - - - tar Windowsã®å ´åˆ Windowsã¯ã€GUIã§ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ç”¨ã„ã‚‹ã€‚ã‚ˆãä½¿ã†ã‚‚ã®ã‚’è¨˜è¼‰ã™ã‚‹ã€‚ ã‚·ã‚¹ãƒ†ãƒ ç³» ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒã‚¤ã‚¹ç®¡ç†ç³» ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ç³» ãã®ä»– ãƒãƒãƒ¼ã‚¸ãƒ£ ãƒ‡ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆãƒ„ãƒ¼ãƒ« ãƒ•ã‚¡ã‚¤ãƒ«åœ§ç¸®ãƒ—ãƒ­ã‚°ãƒ©ãƒ  ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚»ãƒ¼ãƒãƒ¼ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ - ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚¯ãƒªãƒ¼ãƒŠ - - - ã‚¢ãƒ³ãƒã‚¦ã‚¤ãƒ«ã‚¹ - - - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ /bin Unixãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®å¤šãã€‚ /usr/bin ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«ã‚ˆã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®å¤šãã€‚ /usr/local/bin Unixå¤–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«ã‚ˆã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã€‚æœ€åˆã¯ç©ºã«ãªã£ã¦ã„ã‚‹ã€‚ /sbin Unixãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã†ã¡ã€sudoæ¨©é™ãŒå¿…è¦ãªã‚‚ã®ã€‚ /usr/sbin ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«ã‚ˆã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ã†ã¡ã€sudoæ¨©é™ãŒå¿…è¦ãªã‚‚ã®ã€‚ /usr/local/sbin Unixå¤–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«ã‚ˆã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ã†ã¡ã€sudoæ¨©é™ãŒå¿…è¦ãªã‚‚ã®ã€‚æœ€åˆã¯ç©ºã«ãªã£ã¦ã„ã‚‹ã€‚ # ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ãŒå…¨ã¦ã®å ´æ‰€ã§è¦‹ã¤ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼ $ which python3 which: no python3 in (/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin) # ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ $ which python3 /usr/bin/python3 02. å…¥åŠ›ã¨å‡ºåŠ› æ¨™æº–å…¥å‡ºåŠ› ãƒ»æ¨™æº–å…¥å‡ºåŠ›ã¨ã¯ ç¨®é¡ èª¬æ˜ stddinï¼ˆæ¨™æº–å…¥åŠ›ï¼‰ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã«å¯¾ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã“ã¨ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã”ã¨ã«å­˜åœ¨ã™ã‚‹ã€‚ stdoutï¼ˆæ¨™æº–å‡ºåŠ›ï¼‰ ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å¯¾ã—ã¦ã€ã‚¨ãƒ©ãƒ¼ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã“ã¨ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã”ã¨ã«å­˜åœ¨ã™ã‚‹ã€‚ stderrï¼ˆæ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ï¼‰ ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å¯¾ã—ã¦ã€ã‚¨ãƒ©ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã“ã¨ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã”ã¨ã«å­˜åœ¨ã™ã‚‹ã€‚ ãƒ»æ¨™æº–å‡ºåŠ›ã«å…¨ã¦å‡ºåŠ› ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã®å¾Œã«ã€ã€2>&1ã€ã‚’è¿½åŠ ã™ã‚‹ã¨ã€æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã¸ã®å‡ºåŠ›ã‚’æ¨™æº–å‡ºåŠ›ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å‡¦ç†ã®å…¨ã¦ã®çµæœã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã§ãã‚‹ã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://teratail.com/questions/1285 ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ echo \"text\" 2>&1 ã¾ãŸã€ãƒ—ãƒ­ã‚»ã‚¹ã®æ¨™æº–å‡ºåŠ›ã¯/proc//fdãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ç•ªå·ï¼ˆï¼‘ç•ªï¼‰ã§ç¢ºèªã§ãã‚‹ã€‚ãƒ—ãƒ­ã‚»ã‚¹IDã¯psã‚³ãƒãƒ³ãƒ‰ã§äº‹å‰ã«ç¢ºèªã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š PHP-FPMã®ç¨¼åƒã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¾‹ $ ps -aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.6 83736 25408 ? Ss 01:56 0:03 php-fpm: master process (/usr/local/etc/php-fpm.conf) www-data 2739 3.6 0.7 247968 29296 ? Sl 13:24 1:36 php-fpm: pool www www-data 2815 3.6 0.7 247968 29288 ? Sl 13:43 0:55 php-fpm: pool www www-data 2902 3.6 0.7 247968 29304 ? Sl 14:05 0:07 php-fpm: pool www root 2928 0.0 0.0 9732 3316 pts/0 R+ 14:08 0:00 ps -aux # æ¨™æº–å‡ºåŠ›ã‚’ç¢ºèª $ cat /proc/1/fd/1 å‚è€ƒï¼šhttps://debimate.jp/2020/07/04/%e8%b5%b7%e5%8b%95%e6%b8%88%e3%81%bf%e3%83%97%e3%83%ad%e3%82%bb%e3%82%b9%ef%bc%88%e4%be%8b%ef%bc%9a%e3%83%87%e3%83%bc%e3%83%a2%e3%83%b3%e3%83%97%e3%83%ad%e3%82%bb%e3%82%b9%ef%bc%89%e3%81%ae%e6%a8%99/ ãƒ»æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å…¨ã¦å‡ºåŠ› ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã®å¾Œã«ã€ã€1>&2ã€ã‚’è¿½åŠ ã™ã‚‹ã¨ã€æ¨™æº–å‡ºåŠ›ã¸ã®å‡ºåŠ›ã‚’æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å‡¦ç†ã®å…¨ã¦ã®çµæœã‚’æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã§ãã‚‹ã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://teratail.com/questions/1285 ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ echo \"text\" 1>&2 ã¾ãŸã€ãƒ—ãƒ­ã‚»ã‚¹ã®æ¨™æº–å‡ºåŠ›ã¯/proc//fdãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ç•ªå·ï¼ˆï¼’ç•ªï¼‰ã§ç¢ºèªã§ãã‚‹ã€‚ãƒ—ãƒ­ã‚»ã‚¹IDã¯psã‚³ãƒãƒ³ãƒ‰ã§äº‹å‰ã«ç¢ºèªã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š PHP-FPMã®ç¨¼åƒã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¾‹ $ ps -aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.6 83736 25408 ? Ss 01:56 0:03 php-fpm: master process (/usr/local/etc/php-fpm.conf) www-data 2739 3.6 0.7 247968 29296 ? Sl 13:24 1:36 php-fpm: pool www www-data 2815 3.6 0.7 247968 29288 ? Sl 13:43 0:55 php-fpm: pool www www-data 2902 3.6 0.7 247968 29304 ? Sl 14:05 0:07 php-fpm: pool www root 2928 0.0 0.0 9732 3316 pts/0 R+ 14:08 0:00 ps -aux # æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã‚’ç¢ºèª $ cat /proc/1/fd/2 å‚è€ƒï¼šhttps://debimate.jp/2020/07/04/%e8%b5%b7%e5%8b%95%e6%b8%88%e3%81%bf%e3%83%97%e3%83%ad%e3%82%bb%e3%82%b9%ef%bc%88%e4%be%8b%ef%bc%9a%e3%83%87%e3%83%bc%e3%83%a2%e3%83%b3%e3%83%97%e3%83%ad%e3%82%bb%e3%82%b9%ef%bc%89%e3%81%ae%e6%a8%99/ ãƒ»æ¨™æº–å‡ºåŠ›ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ› ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§teeã‚³ãƒãƒ³ãƒ‰ã‚’ç¹‹ãã¨ã€æ¨™æº–å‡ºåŠ›ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸¡æ–¹ã«å‡ºåŠ›ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://glorificatio.org/archives/2903 ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ echo \"text\" | tee stdout.log pipeline ãƒ»pipelineã¨ã¯ ã€|ã€ã®ç¸¦æ£’è¨˜å·ã®ã“ã¨ã€‚è¤‡æ•°ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å…¥å‡ºåŠ›ã‚’ç¹‹ã’ã‚‹ã€‚ ãƒ»grepã¨ã®çµ„ã¿åˆã‚ã› ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›çµæœã‚’grepã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã—ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š æ¤œç´¢ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ã€ã•ã‚‰ã«æ–‡å­—åˆ—ã‚’æ¤œç´¢ã™ã‚‹ã€‚ $ find /* \\ -type f | xargs grep \"\" ãƒ»killã¨ã®çµ„ã¿åˆã‚ã› ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›çµæœã«å¯¾ã—ã¦ã€killã‚³ãƒãƒ³ãƒ‰ã‚’è¡Œã†ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ—ãƒ­ã‚»ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ sudo pgrep \\ -f | sudo xargs kill -9 ãƒ»awkã¨ã®çµ„ã¿åˆã‚ã› ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›çµæœã«å¯¾ã—ã¦ã€awkã‚³ãƒãƒ³ãƒ‰ã‚’è¡Œã†ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š æ¤œç´¢ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å®¹é‡ã‚’åˆè¨ˆã™ã‚‹ã€‚ $ find ./* -name \"*.js\" -type f -printf \"%s\\n\" | awk \"{ sum += $1; } END { print sum; }\" $ find ./* -name \"*.css\" -type f -printf \"%s\\n\" | awk \"{ sum += $1; } END { print sum; }\" $ find ./* -name \"*.png\" -type f -printf \"%s\\n\" | awk \"{ sum += $1; } END { print sum; }\" ãƒ»sortã¨ã®çµ„ã¿åˆã‚ã› ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›çµæœã«å¯¾ã—ã¦ã€ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š è¡¨ç¤ºã•ã‚ŒãŸç’°å¢ƒå¤‰æ•°ã‚’AZæ˜‡é †ã«ä¸¦ã³æ›¿ãˆã‚‹ã€‚ $ printenv | sort -f 03. ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼Makefile ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ»ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã¯ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®å‡¦ç†ã‚’æ‰‹ç¶šãçš„ã«å®Ÿè£…ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã€‚æœ€åˆã®ã€#!ã€ã‚’ã‚·ã‚§ãƒãƒ³ã¨ã„ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š #!/bin/bash echo \"foo\" echo \"bar\" echo \"baz\" Makefile ãƒ»Makefileã¨ã¯ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®å‡¦ç†ã‚’æ‰‹ç¶šãçš„ã«å®Ÿè£…ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã€‚ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã”ã¨ã«å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚è¤‡æ•°ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåã‚’å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ foo: echo \"foo\" bar: echo \"bar\" baz qux: # è¤‡æ•°ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå echo \"baz\" ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé–“ä¾å­˜é–¢ä¿‚ ç‰¹å®šã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®å®Ÿè¡Œå‰ã«ã€ä»–ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¦ãŠããŸã„å ´åˆã€ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã§ãã‚‹ã€‚ã“ã‚Œã¯è¤‡æ•°å®šç¾©ã§ãã‚‹ã€‚ foo: echo \"foo\" bar: foo # fooã‚’äº‹å‰ã«å®Ÿè¡Œã™ã‚‹ã€‚ echo \"bar\" baz: foo baz # fooã€bazã‚’äº‹å‰ã«å®Ÿè¡Œã™ã‚‹ã€‚ echo \"baz\" ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œæ–¹æ³• ãƒ»source ç¾åœ¨é–‹ã‹ã‚Œã¦ã„ã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã§å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãã®ãŸã‚ã€ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§å®šç¾©ã—ãŸå¤‰æ•°ã¯ã€ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œå¾Œã‚‚ç¶­æŒã•ã‚Œã‚‹ã€‚ $ source hello.sh ãƒ»bash æ–°ã—ãã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚’é–‹ãã€å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãã®ãŸã‚ã€ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§å®šç¾©ã—ãŸå¤‰æ•°ã¯ã€ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œå¾Œã«ç ´æ£„ã•ã‚Œã‚‹ã€‚ $ bash hello.sh ãƒ»ãƒ‰ãƒƒãƒˆ $ . hello.sh ãƒ»ãƒ‘ã‚¹æŒ‡å®š ç›¸å¯¾ãƒ‘ã‚¹ã‚‚ã—ãã¯çµ¶å¯¾ãƒ‘ã‚¹ã§ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŒ‡å®šã™ã‚‹ã€‚å®Ÿè¡Œã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç½®ãã“ã¨ã¯ã§ããªã„ã€‚ $ ./hello.sh Makefileã®å®Ÿè¡Œæ–¹æ³•ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ ãƒ»make MakefileãŒç½®ã‹ã‚ŒãŸéšå±¤ã§ã€makeã‚³ãƒãƒ³ãƒ‰ã®å¼•æ•°ã¨ã—ã¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåã‚„ç’°å¢ƒå¤‰æ•°ã‚’æ¸¡ã›ã‚‹ã€‚Makefileå†…ã§ç’°å¢ƒå¤‰æ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’å®šç¾©ã§ãã‚‹ã€‚ $ make = ï¼Šå®Ÿè£…ä¾‹ï¼Š $ make foo FOO=foo FOO=default foo: echo ${FOO} ãƒ­ã‚¸ãƒƒã‚¯ ãƒ»ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ä½œæˆã—ãŸã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã¯ã€å„è¡Œã«echoãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ #!/bin/bash cat \"echo.sh\" #!/bin/bash hoge fuga EOF #!/bin/bash echo hoge echo fuga ãƒ»for ï¼Šå®Ÿè£…ä¾‹ï¼Š #!/bin/bash for i in 1 2 3 4 5 do echo \"$i\" done ãƒ»switch-case å¤‰æ•°ã«ä»£å…¥ã•ã‚ŒãŸå€¤ã«ã‚ˆã£ã¦ã€å‡¦ç†ã‚’åˆ†ã‘ã‚‹ã€‚å…¨ã¦ã®å ´åˆä»¥å¤–ã‚’ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã§å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š #!/bin/bash case \"$ENV\" in \"test\") VAR=\"XXXXX\" ;; \"stg\") VAR=\"YYYYY\" ;; \"prd\") VAR=\"ZZZZZ\" ;; *) echo \"The parameter ${ENV} is invalid.\" exit 1 ;; esac 04. ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ç³» chmodï¼šchange mode ãƒ» ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ã‚’å¤‰æ›´ã™ã‚‹ã€‚ã‚ˆãç”¨ã„ã‚‰ã‚Œã‚‹ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯æ¬¡ã®é€šã‚Šã€‚ $ chmod 600 ãƒ»-R ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ã€å†å¸°çš„ã«æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ã€‚ $ chmod -R 600 ãƒ»100ç•ªåˆ»ã¿ã®è¦å‰‡æ€§ æ‰€æœ‰è€…ä»¥å¤–ã«å…¨æ¨©é™ãŒä¸ãˆã‚‰ã‚Œãªã„ã€‚ æ•°å­— æ‰€æœ‰è€… ã‚°ãƒ«ãƒ¼ãƒ— ãã®ä»– ç‰¹å¾´ 500 r-x --- --- æ‰€æœ‰è€…ä»¥å¤–ã«å…¨æ¨©é™ãªã— 600 rw- --- --- æ‰€æœ‰è€…ä»¥å¤–ã«å…¨æ¨©é™ãªã— 700 rwx --- --- æ‰€æœ‰è€…ä»¥å¤–ã«å…¨æ¨©é™ãªã— ãƒ»111ç•ªåˆ»ã¿ã®è¦å‰‡æ€§ å…¨ã¦ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§åŒã˜æ¨©é™ã«ãªã‚‹ã€‚ æ•°å­— æ‰€æœ‰è€… ã‚°ãƒ«ãƒ¼ãƒ— ãã®ä»– ç‰¹å¾´ 555 r-x r-x r-x å…¨ã¦ã«Writeæ¨©é™ãªã— 666 rw- rw- rw- å…¨ã¦ã«Executæ¨©é™ãªã— 777 rwx rwx rwx å…¨ã¦ã«å…¨æ¨©é™ã‚ã‚Š ãƒ»ãã®ä»–ã§ã‚ˆãä½¿ã†ç•ªå· æ•°å­— æ‰€æœ‰è€… ã‚°ãƒ«ãƒ¼ãƒ— ãã®ä»– ç‰¹å¾´ 644 rw- r-- r-- æ‰€æœ‰è€…ä»¥å¤–ã«Writeã€Executeæ¨©é™ãªã— 755 rwx r-x r-x æ‰€æœ‰è€…ä»¥å¤–ã«Writeæ¨©é™ãªã— cp ãƒ»-Rp ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å±æ€§æƒ…å ±ã‚‚å«ã‚ã¦ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†å¸°çš„ã«ã‚³ãƒ”ãƒ¼ã€‚ $ cp -Rp // // # éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å«ã‚ã¦ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­èº«ã‚’ä»–ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ã‚³ãƒ”ãƒ¼ # ã€ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã€ã§ãªãã€ãƒ‰ãƒƒãƒˆã€ã«ã™ã‚‹ $ cp -Rp // / ãƒ»-p ã€ãƒ•ã‚¡ã‚¤ãƒ«å.YYYYmmddã€ã®å½¢å¼ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ $ cp -p .`date +\"%Y%m%d\"` echo ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— å®šç¾©ã•ã‚ŒãŸã‚·ã‚§ãƒ«å¤‰æ•°ã‚’å‡ºåŠ›ã™ã‚‹ã€‚å¤‰æ•°åã«ã¯$ãƒãƒ¼ã‚¯ã‚’ä»˜ã‘ã‚‹ã€‚ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã¯ã‚ã£ã¦ã‚‚ãªãã¦ã‚‚ã‚ˆã„ã€‚ $ = $ echo $ $ echo \"$\" file ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ãƒ•ã‚¡ã‚¤ãƒ«ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ # LFã®å ´åˆï¼ˆä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ï¼‰ $ file foo.txt foo.txt: ASCII text # CRLFã®å ´åˆ $ file foo.txt foo.txt: ASCII text, with CRLF line terminators # CRã®å ´åˆ $ file foo.txt foo.txt: ASCII text, with CR line terminators find ãƒ»-type ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€‚ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã‚’ä»˜ã‘ãªãã¨ã‚‚ã€è‡ªå‹•çš„ã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ãŒåƒãã€‚ $ find /* -type f | xargs grep \"\" # ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ãªã©ã®ãƒ­ã‚°ã‚’ç ´æ£„ã—ã¦æ¤œç´¢ã€‚ $ find /* -type f | xargs grep \"\" 2> /dev/null ãƒ»-name åå‰ãŒ .conf ã§çµ‚ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦æ¤œç´¢ã™ã‚‹ã€‚ $ find /* -name \"*.conf\" -type f åå‰ãŒ dir ã§çµ‚ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å…¨ã¦æ¤œç´¢ã™ã‚‹ã€‚ $ find /* -name \"*dir\" -type d ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã§ã€ ã¨ã„ã†æ–‡å­—ã‚’ã‚‚ã¡ã€ãƒ•ã‚¡ã‚¤ãƒ«åãŒ .conf ã§çµ‚ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦æ¤œç´¢ã™ã‚‹ã€‚ $ find /* -name \"*.conf\" -type f | xargs grep \"\" ln ãƒ»ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã¨ã¯ ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã®ã“ã¨ã€‚ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã«å¯¾ã™ã‚‹å‡¦ç†ã¯ã€ãƒªãƒ³ã‚¯å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è»¢é€ã•ã‚Œã‚‹ã€‚ ãƒ»-s ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã€ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹ã€‚ãƒªãƒ³ã‚¯ã®å…ƒã«ãªã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æŒ‡å®šã™ã‚‹ã€‚ $ ln -s ls ãƒ»-lã€-a éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ã‚„éš ã—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚å«ã‚ã¦ã€å…¨ã¦ã®è©³ç´°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ ls -l -a mkdir ãƒ»-p è¤‡æ•°éšå±¤ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã™ã‚‹ã€‚ $ mkdir -p // rm ãƒ»-R ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè‡ªä½“ã¨ä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†å¸°çš„ã«å‰Šé™¤ã™ã‚‹ã€‚ $ rm -R odï¼šoctal dump ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ãƒ•ã‚¡ã‚¤ãƒ«ã‚’8é€²æ•°ã®æ©Ÿæ¢°èªã§å‡ºåŠ›ã™ã‚‹ã€‚ $ od ãƒ»-Adã€-tx ãƒ•ã‚¡ã‚¤ãƒ«ã‚’16é€²æ•°ã®æ©Ÿæ¢°èªã§å‡ºåŠ›ã™ã‚‹ã€‚ $ od -Ad -tx set ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ç¾åœ¨è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‚·ã‚§ãƒ«å¤‰æ•°ã‚’ä¸€è¦§ã§è¡¨ç¤ºã™ã‚‹ã€‚ $ set ãƒ»-n ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ§‹æ–‡è§£æã‚’è¡Œã†ã€‚ $ set -n ãƒ»-e ä¸€é€£ã®å‡¦ç†ã®é€”ä¸­ã§0ä»¥å¤–ã®çµ‚äº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå‡ºåŠ›ã•ã‚ŒãŸå ´åˆã€å…¨ã¦ã®å‡¦ç†ã‚’çµ‚äº†ã™ã‚‹ã€‚ $ set -e ãƒ»-x ä¸€é€£ã®å‡¦ç†ã‚’ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚ $ set -x ãƒ»-u ä¸€é€£ã®å‡¦ç†ã®ä¸­ã§ã€æœªå®šç¾©ã®å¤‰æ•°ãŒå­˜åœ¨ã—ãŸå ´åˆã€å…¨ã¦ã®å‡¦ç†ã‚’çµ‚äº†ã™ã‚‹ã€‚ $ set -u ãƒ»-o pipefail ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆ|ï¼‰å†…ã®ä¸€é€£ã®å‡¦ç†ã®é€”ä¸­ã§ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ãã®çµ‚äº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å‡ºåŠ›ã—ã€å…¨ã¦ã®å‡¦ç†ã‚’çµ‚äº†ã™ã‚‹ã€‚ $ set -o pipefail tar ãƒ»-x åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã™ã‚‹ã€‚ $ tar -xf foo.tar.gz ãƒ»-f åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã™ã‚‹ã€‚ã“ã‚Œã‚’ä»˜ã‘ãªã„å ´åˆã€ãƒ†ãƒ¼ãƒ—ãƒ‰ãƒ©ã‚¤ãƒ–ãŒæŒ‡å®šã•ã‚Œã‚‹ã€‚ $ tar -xf foo.tar.gz ãƒ»-v è§£å‡ä¸­ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ tar -xvf foo.tar.gz ./ ./opt/ ./opt/foo/ ./opt/foo/bar/ ./opt/foo/bar/install.sh ./opt/foo/bar/baz/ ./opt/foo/bar/baz/init.sh ãƒ»-g gzipæ‹¡å¼µå­ã®åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã™ã‚‹ã€‚ãŸã ã—ã€æ¨™æº–ã§æœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ä»˜ã‘ãªã„ãã¦ã‚‚å•é¡Œãªã„ã€‚ $ tar -zxf foo.tar.gz unlink ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ unlink 04-02. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç³» curl ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— GETãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚jqã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã‚‹ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’æ•´å½¢ã§ãã‚‹ã€‚ $ curl http://example.co.jp/foos/1 | jq . ãƒ»-Xã€-Tã€-d Content-Typeã‚’æŒ‡å®šã—ã¦ã€POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ $ curl -X POST -H \"Content-Type: application/json\" -d '{}' https://example.co.jp/foos ãƒ»-oï¼ˆå°æ–‡å­—ï¼‰ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã‚Œã‚’æŒ‡å®šã—ãªã„å ´åˆã€-Oã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ $ curl -o https://example.co.jp ãƒ»-Oï¼ˆå¤§æ–‡å­—ï¼‰ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯ãã®ã¾ã¾ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ã“ã‚Œã‚’æŒ‡å®šã—ãªã„å ´åˆã€-oã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»-L æŒ‡å®šã—ãŸURLã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãŒè¡Œã‚ã‚Œã¦ã‚‚ã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¾Œã®URLã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ $ curl -L https://example.co.jp/foos nslookup ãƒ»-type æŒ‡å®šã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã®å€¤ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã«å•ã„åˆã‚ã›ã‚‹ã€‚å®Ÿéš›ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®åå‰è§£æ±ºã®ä»•çµ„ã¿ã§ã¯ã€DNSã‚µãƒ¼ãƒã¯å•ã„åˆã‚ã›ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸNSãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã‚’æŒã¤ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒï¼ˆä¾‹ï¼šRoute53ï¼‰ã«å†ã³å•ã„åˆã‚ã›ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã®ã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã—ã¦ã‚‚ã‚‰ã†ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws.html ï¼Šä¾‹ï¼Š NSãƒ¬ã‚³ãƒ¼ãƒ‰ã®å€¤ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã«å•ã„åˆã‚ã›ã‚‹ã€‚ $ nslookup -type=NS example.co.jp # ï½ ä¸­ç•¥ ï½ example.co.jp nameserver = ns-***.awsdns-***.net example.co.jp nameserver = ns-***.awsdns-***.co.uk example.co.jp nameserver = ns-***.awsdns-***.org example.co.jp nameserver = ns-***.awsdns-***.com # ï½ ä¸­ç•¥ ï½ sshï¼šsecure shell ãƒ»-lã€-pã€ã€-iã€-T äº‹å‰ã«ã€ç§˜å¯†éµã®æ¨©é™ã¯ã€600ã€ã«ã—ã¦ãŠãã€‚ttyï¼ˆæ“¬ä¼¼ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰ã‚’ç”¨ã„ã‚‹å ´åˆã¯ã€-Tã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã€‚ $ ssh -l @ -p 22 -i -T ãƒ»-lã€-pã€ã€-iã€-Tã€-vvv # -vvvï¼šãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹ $ ssh -l @ -p 22 -i -T -vvv ãƒ»è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ~/.ssh/configï¼‰ è¨­å®šãŒé¢å€’ãªsshã‚³ãƒãƒ³ãƒ‰ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å¼•æ•°ã‚’ã€~/.ssh/configãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã—ã¦ãŠãã€‚ # ã‚µãƒ¼ãƒï¼‘ Host User Port 22 HostName IdentityFile # ã‚µãƒ¼ãƒï¼’ Host User Port 22 HostName IdentityFile ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®å€¤æ¸¡ã—ã‚’çœç•¥ã§ãã‚‹ã€‚ttyï¼ˆæ“¬ä¼¼ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰ã‚’ç”¨ã„ã‚‹å ´åˆã¯ã€-Tã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã€‚ # ç§˜å¯†éµã®æ¨©é™ã¯ã€äº‹å‰ã«ã€600ã€ã«ã—ã¦ãŠã $ ssh -T 04-03. ãƒ—ãƒ­ã‚»ã‚¹ç³» psï¼š process status ãƒ»-aux ç¨¼åƒã—ã¦ã„ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€‚ # ç¨¼åƒã—ã¦ã„ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã®ã†ã¡ã€è©³ç´°æƒ…å ±ã«ã€xxxã€ã‚’å«ã‚€ã‚‚ã®ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ ps -aux | grep \"\" systemctlï¼šsystem controlï¼ˆæ—§serviceï¼‰ ãƒ»systemctlã¨ã¯ ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’èµ·å‹•ã™ã‚‹systemdã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€‚ ãƒ»list-unit-files ãƒ‡ãƒ¼ãƒ¢ãƒ³ã®Unitã‚’ä¸€è¦§ã§è¡¨ç¤ºã™ã‚‹ã€‚ $ systemctl list-unit-files --type=service crond.service enabled # enableï¼šè‡ªå‹•èµ·å‹•ã™ã‚‹ supervisord.service disabled # disableï¼šè‡ªå‹•èµ·å‹•ã—ãªã„ systemd-reboot.service static # enableï¼šä»–ã‚µãƒ¼ãƒ“ã‚¹ä¾å­˜ ãƒ»enable ãƒã‚·ãƒ³èµ·å‹•æ™‚ã«ãƒ‡ãƒ¼ãƒ¢ãƒ³ãŒè‡ªå‹•èµ·å‹•ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚ $ systemctl enable # ä¾‹ï¼šCronã€Apache $ systemctl enable crond.service $ systemctl enable httpd.service ãƒ»disable ãƒã‚·ãƒ³èµ·å‹•æ™‚ã«ãƒ‡ãƒ¼ãƒ¢ãƒ³ãŒè‡ªå‹•èµ·å‹•ã—ãªã„ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚ $ systemctl disable # ä¾‹ï¼šCronã€Apache $ systemctl disable crond.service $ systemctl disable httpd.service ãƒ»systemdï¼šsystem daemon ã®Unitã®ç¨®é¡ å„ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’ã€/usr/lib/systemd/systemã‚„/etc/systemd/systemä¸‹ã§Unitåˆ¥ã«ç®¡ç†ã—ã€Unitã”ã¨ã«èµ·å‹•ã™ã‚‹ã€‚Unitã¯æ‹¡å¼µå­ã®é•ã„ã§åˆ¤åˆ¥ã™ã‚‹ã€‚ Unitã®æ‹¡å¼µå­ æ„å‘³ ãƒ‡ãƒ¼ãƒ¢ãƒ³ä¾‹ mount ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚¦ãƒ³ãƒˆã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ãƒ¢ãƒ³ã€‚ service ãƒ—ãƒ­ã‚»ã‚¹èµ·å‹•åœæ­¢ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ãƒ¢ãƒ³ã€‚ httpdï¼šhttp daemon socket ã‚½ã‚±ãƒƒãƒˆã¨ãƒ—ãƒ­ã‚»ã‚¹ã®ç´ä»˜ã‘ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ãƒ¢ãƒ³ kill ãƒ»-9 æŒ‡å®šã—ãŸPIDã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ kill -9 æŒ‡å®šã—ãŸã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’å…¨ã¦å‰Šé™¤ã™ã‚‹ã€‚ $ sudo pgrep -f | sudo xargs kill -9 cron ãƒ»cronã¨ã¯ æŒ‡å®šã—ãŸã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¾“ã£ã¦ã€æŒ‡å®šã•ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®šæœŸå®Ÿè¡Œã™ã‚‹å¸¸é§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚ ãƒ»cronãƒ•ã‚¡ã‚¤ãƒ« ãƒ•ã‚¡ã‚¤ãƒ«åãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå åˆ©ç”¨è€… ä¸»ãªç”¨é€” /etc/crontab root æ¯æ™‚ã€æ¯æ—¥ã€æ¯æœˆã€æ¯é€±ã®è‡ªå‹•ã‚¿ã‚¹ã‚¯ã®ãƒ¡ã‚¤ãƒ³è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« /etc/cron.hourly root æ¯æ™‚å®Ÿè¡Œã•ã‚Œã‚‹è‡ªå‹•ã‚¿ã‚¹ã‚¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª /etc/cron.daily root æ¯æ—¥å®Ÿè¡Œã•ã‚Œã‚‹è‡ªå‹•ã‚¿ã‚¹ã‚¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª /etc/cron.monthly root æ¯æœˆå®Ÿè¡Œã•ã‚Œã‚‹è‡ªå‹•ã‚¿ã‚¹ã‚¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª /etc/cron.weekly root æ¯é€±å®Ÿè¡Œã•ã‚Œã‚‹è‡ªå‹•ã‚¿ã‚¹ã‚¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚ã‚‰ã‹ã˜ã‚ã€å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«cronãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãŠãã€‚ cronã¨ã—ã¦ç™»éŒ²ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚run-partsã‚³ãƒãƒ³ãƒ‰ã§ã€æŒ‡å®šã—ãŸæ™‚é–“ã«ã€å„cronãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®cronãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬ã§å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¨˜è¿°ã—ã¦ãŠãã€‚ # è¨­å®š SHELL=/bin/bash PATH=/sbin:/bin:/usr/sbin:/usr/bin MAILTO=\"example@gmail.com\" LANG=ja_JP.UTF-8 LC_ALL=ja_JP.UTF-8 CONTENT_TYPE=text/plain; charset=UTF-8 # For details see man 4 crontabs # Example of job definition: # .---------------- minute (0 - 59) # | .------------- hour (0 - 23) # | | .---------- day of month (1 - 31) # | | | .------- month (1 - 12) OR jan,feb,mar,apr ... # | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat # | | | | | # * * * * * user-name command to be executed # run-parts 1 * * * * root run-parts /etc/cron.hourly # æ¯æ™‚ãƒ»1åˆ† 5 2 * * * root run-parts /etc/cron.daily # æ¯æ—¥ãƒ»2æ™‚5åˆ† 20 2 * * 0 root run-parts /etc/cron.weekly # æ¯é€±æ—¥æ›œæ—¥ãƒ»2æ™‚20åˆ† 40 2 1 * * root run-parts /etc/cron.monthly # æ¯æœˆä¸€æ—¥ãƒ»2æ™‚40åˆ† @reboot make clean html # cronèµ·å‹•æ™‚ã«ä¸€åº¦ã ã‘ ãƒ»cron.dãƒ•ã‚¡ã‚¤ãƒ« è¤‡æ•°ã®cronãƒ•ã‚¡ã‚¤ãƒ«ã§å…¨ã¦ã®ä¸€ã¤ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ç®¡ç†ã™ã‚‹å ´åˆã«ç”¨ã„ã‚‹ã€‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå åˆ©ç”¨è€… ä¸»ãªç”¨é€” /etc/cron.d root ä¸Šè¨˜ä»¥å¤–ã®è‡ªå‹•ã‚¿ã‚¹ã‚¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ãƒ»supervisorã¨ã®çµ„ã¿åˆã‚ã› ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€OSä¸Šã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ¶å¾¡ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚ # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« $ pip3 install supervisor # /etc/supervisor/supervisord.conf ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ã¦èµ·å‹•ã€‚ $ /usr/local/bin/supervisord ä»¥ä¸‹ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [supervisord] # å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ user=root # ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹• nodaemon=true # ãƒ­ã‚° logfile=/var/log/supervisord.log # Pid pidfile=/var/tmp/supervisord.pid [program:crond] # å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ command=/usr/sbin/crond -n # ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è‡ªå‹•èµ·å‹• autostart=true # ãƒ—ãƒ­ã‚°ãƒ©ãƒ åœæ­¢å¾Œã®å†èµ·å‹• autorestart=true # ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œãƒ­ã‚° stdout_logfile=/var/log/command.log stderr_logfile=/var/log/command-error.log # ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ user=root # ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª directory=/var/www/tech-notebook crontab ãƒ»crontabã¨ã¯ cronãƒ‡ãƒ¼ãƒ¢ãƒ³ã®å‹•ä½œãŒå®šç¾©ã•ã‚ŒãŸcrontabãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ä½œæˆã—ãŸcronãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç™»éŒ²ã™ã‚‹ã€‚cron.dãƒ•ã‚¡ã‚¤ãƒ«ã¯æ“ä½œã§ããªã„ã€‚ $ crontab ãƒ»ç™»éŒ²ã•ã‚ŒãŸcronãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ã‚’ç¢ºèª $ crontab -l # crontabã‚³ãƒãƒ³ãƒ‰ã§ç™»éŒ²ã•ã‚ŒãŸcronãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç† 1 * * * * rm foo ãƒ»cronãƒ•ã‚¡ã‚¤ãƒ«ã®ç™»éŒ²æ‰‹é † ï¼Šå®Ÿè£…ä¾‹ï¼Š ï¼‘. æ‹¡å¼µå­ã¯è‡ªç”±ã§ã€æ™‚åˆ»ã¨ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè£…ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã™ã‚‹ã€‚ã“ã®æ™‚ã€æœ€å¾Œã«æ”¹è¡ŒãŒãªã„ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆpremature EOFï¼‰ã«ãªã‚‹ãŸã‚ã€æ”¹è¡Œã‚’è¿½åŠ ã™ã‚‹ã€‚ å‚è€ƒï¼š # cron-hourly.txt # æ¯æ™‚ãƒ»1åˆ† 1 * * * * root run-parts /etc/cron.hourly # cron-daily.txt # æ¯æ—¥ãƒ»2æ™‚5åˆ† 5 2 * * * root run-parts /etc/cron.daily # cron-monthly.txt # æ¯é€±æ—¥æ›œæ—¥ãƒ»2æ™‚20åˆ† 20 2 * * 0 root run-parts /etc/cron.weekly # cron-weekly.txt # æ¯æœˆä¸€æ—¥ãƒ»2æ™‚40åˆ† 40 2 1 * * root run-parts /etc/cron.monthly # cronèµ·å‹•æ™‚ã«ä¸€åº¦ã ã‘ @reboot make clean html ï¼’. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’crontabã‚³ãƒãƒ³ãƒ‰ã§ç™»éŒ²ã™ã‚‹ã€‚cronãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿä½“ã¯ãªã„ã“ã¨ã¨ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å¤‰æ›´ã—ãŸå ´åˆã¯ç™»éŒ²ã—ç›´ã•ãªã‘ã‚Œã°ã„ã‘ãªã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ $ crontab /foo/cron-hourly.txt ï¼“. ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å‡¦ç†ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ crontab -l 1 * * * * root run-parts /etc/cron.hourly ï¼”. ãƒ­ã‚°ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã€‚ $ cd /var/log $ tail -f cron ï¼•. æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã€‚æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã¯LFã§ã‚ã‚Šã€å•é¡Œãªã„ã€‚ $ file /foo/cron-hourly.txt foo.txt: ASCII text crond ãƒ»crondã¨ã¯ cronãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’èµ·å‹•ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ  ãƒ»-n ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦cronã‚’èµ·å‹• $ crond -n 04-04. ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ç³» vimï¼šVi Imitaionã€Vi Improved ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— vimä¸Šã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€‚ $ vim history ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— å±¥æ­´1000ä»¶ã®ä¸­ã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ã‚’æ¤œç´¢ã™ã‚‹ã€‚ $ history | grep tr #!/bin/bash cat ./src.txt | tr \"\\n\" \",\" > ./dst.txt 04-05. ç’°å¢ƒå¤‰æ•°ç³» export ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— åŸºæœ¬çš„ãªæ‰‹é †ã¨ã—ã¦ã¯ã€ã‚·ã‚§ãƒ«å¤‰æ•°ã‚’è¨­å®šã—ã€ã“ã‚Œã‚’ç’°å¢ƒå¤‰æ•°ã«è¿½åŠ ã™ã‚‹ã€‚ # ã‚·ã‚§ãƒ«å¤‰æ•°ã‚’è¨­å®š $ PATH=$PATH: # ç’°å¢ƒå¤‰æ•°ã«è¿½åŠ  $ export PATH ã‚·ã‚§ãƒ«å¤‰æ•°ã®è¨­å®šã¨ã€ç’°å¢ƒå¤‰æ•°ã¸ã®è¿½åŠ ã¯ã€ä»¥ä¸‹ã®é€šã‚ŠåŒæ™‚ã«è¨˜è¿°ã§ãã‚‹ã€‚ # ç’°çŠ¶å¤‰æ•°ã¨ã—ã¦ã€æŒ‡å®šã—ãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆbinï¼‰ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’è¿½åŠ ã€‚ # ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€çµ¶å¯¾ãƒ‘ã‚¹ $ export PATH=$PATH: # ä¸è¦ãªãƒ‘ã‚¹ã‚’å‰Šé™¤ã—ãŸã„å ´åˆã¯ã“ã¡ã‚‰ # ç’°çŠ¶å¤‰æ•°ã¨ã—ã¦ã€æŒ‡å®šã—ãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆbinï¼‰ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’ä¸Šæ›¸ã $ export PATH=/sbin:/bin:/usr/sbin:/usr/bin ãƒ».bashrcã¸ã®è¿½è¨˜ exportã®çµæœã¯ã€OSã®å†èµ·å‹•ã§åˆæœŸåŒ–ã•ã‚Œã¦ã—ã¾ã†ã€‚ãã®ãŸã‚ã€å†èµ·å‹•æ™‚ã«è‡ªå‹•çš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã€/home/centos/.bashrcã«è¿½è¨˜ã—ã¦ãŠãã€‚ # Source global definitions if [ -f /etc/bashrc ]; then . /etc/bashrc fi # User specific environment PATH=\"$HOME/.local/bin:$HOME/bin:$PATH\" # xxxãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’è¿½åŠ  ã‚’è¿½åŠ  printenv ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— å…¨ã¦ã®ç’°å¢ƒå¤‰æ•°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ printenv ã¾ãŸã€ç‰¹å®šã®ç’°å¢ƒå¤‰æ•°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ printenv VAR timedatactl ãƒ»set-timezone # ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’æ—¥æœ¬æ™‚é–“ã«å¤‰æ›´ $ timedatectl set-timezone Asia/Tokyo # ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ãŒå¤‰æ›´ã•ã‚ŒãŸã‹ã‚’ç¢ºèª $ date 04-06. ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ç³» top ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— å„ãƒ—ãƒ­ã‚»ã‚¹ã®ç¨¼åƒæƒ…å ±ï¼ˆãƒ¦ãƒ¼ã‚¶åã€CPUã€ãƒ¡ãƒ¢ãƒªï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ CPUä½¿ç”¨ç‡æ˜‡é †ã«ä¸¦ã¹ã‚‹ $ top ãƒ»-a ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡æ˜‡é †ã«è¡¨ç¤ºã™ã‚‹ã€‚ $ top -a free ãƒ»-mã€-total ç‰©ç†ãƒ¡ãƒ¢ãƒªã€ã‚¹ãƒ¯ãƒƒãƒ—é ˜åŸŸã€ã®ä½¿ç”¨çŠ¶æ³ã‚’ãƒ¡ã‚¬ãƒã‚¤ãƒˆã§è¡¨ç¤ºã™ã‚‹ã€‚ # mï¼šMega Bytes # t: -total $ free -m -total df ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ä½¿ç”¨ä¸­ã®ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_basic_kernel.html $ df Filesystem 512-blocks Used Available Capacity iused ifree %iused Mounted on /dev/disk1s1s1 976490576 44424136 671194960 7% 559993 4881892887 0% / devfs 393 393 0 100% 681 0 100% /dev /dev/disk1s5 976490576 10485816 671194960 2% 5 4882452875 0% /System/Volumes/VM /dev/disk1s3 976490576 774096 671194960 1% 1648 4882451232 0% /System/Volumes/Preboot /dev/disk1s6 976490576 224048 671194960 1% 450 4882452430 0% /System/Volumes/Update /dev/disk1s2 976490576 247856952 671194960 27% 1367035 4881085845 0% /System/Volumes/Data map auto_home 0 0 0 100% 0 0 100% /System/Volumes/Data/home /dev/disk1s1 976490576 44424136 671194960 7% 553759 4881899121 0% /System/Volumes/Update/mnt1 /dev/disk2s1 610224 421128 189096 70% 360 4294966919 0% /Volumes/Kindle /dev/disk3s1 188336 149544 38792 80% 735 4294966544 0% /Volumes/Amazon Chime ãƒ»-hã€-mã€-t ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä½¿ç”¨çŠ¶æ³ã‚’ãƒ¡ã‚¬ãƒã‚¤ãƒˆã§è¡¨ç¤ºã™ã‚‹ã€‚ # hï¼š--human-readable # t: -total $ df -h -m -t mkswapã€swaponã€swapoff ãƒ»ã‚¹ãƒ¯ãƒƒãƒ”ãƒ³ã‚°æ–¹å¼ ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç†ã®æ–¹æ³•ã®ä¸€ã¤ã€‚ ãƒ»ã‚¹ãƒ¯ãƒƒãƒ—é ˜åŸŸã®ä½œæˆæ–¹æ³• # æŒ‡å®šã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚¹ãƒ¯ãƒƒãƒ—é ˜åŸŸã¨ã—ã¦ä½¿ç”¨ $ mkswap /swap_volume # ã‚¹ãƒ¯ãƒƒãƒ—é ˜åŸŸã‚’æœ‰åŠ¹åŒ– # å„ªå…ˆåº¦ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒã€ãƒ¡ãƒ¢ãƒªã‹ã‚‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã€ä¸€æ™‚çš„ã«é€€é¿ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ $ swapon /swap_volume # ã‚¹ãƒ¯ãƒƒãƒ—é ˜åŸŸã®ä½¿ç”¨çŠ¶æ³ã‚’ç¢ºèª $ swapon -s # ã‚¹ãƒ¯ãƒƒãƒ—é ˜åŸŸã‚’ç„¡åŠ¹åŒ– $ swapoff /swap_volume 05. ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®ç¨®é¡ ãƒ»ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®å¯¾è±¡ æ§˜ã€…ãªãƒ¬ãƒ™ãƒ«ã‚’å¯¾è±¡ã«ã—ãŸç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãŒã‚ã‚‹ã€‚ ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å å¯¾è±¡ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª composer.pharï¼šComposer PHP pipï¼šPackage Installer for Python Python npmï¼šNode Package Manager Node.js mavenï¼šApache Maven Java gemï¼šRuby Gems Ruby ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å å¯¾è±¡OS ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯å¦ Rpmï¼šRed Hat Package Manager RedHatç³» âœ• Yumï¼šYellow dog Updater ModifiedDNFï¼šDandified Yum RedHatç³» ã€‡ Aptï¼šAdvanced Packaging Tool Debianç³» ã€‡ Apkï¼šAlpine Linux package management Alpine Linux ã€‡ ãƒ»è¨€èªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å å¯¾è±¡ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª phpenv PHP pyenv Python rbenv Ruby 05-02. ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ pip ãƒ»install æŒ‡å®šã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ # /usr/local ä»¥ä¸‹ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« $ pip install --user # requirements.txt ã‚’å…ƒã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« $ pip install -r requirements.txt # æŒ‡å®šã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« pip install -r requirements.txtã€€--prefix=/usr/local ãƒ»freeze pipã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å…ƒã«ã€è¦ä»¶ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ $ pip freeze > requirements.txt ãƒ»show pipã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ pip show sphinx Name: Sphinx Version: 3.2.1 Summary: Python documentation generator Home-page: http://sphinx-doc.org/ Author: Georg Brandl Author-email: georg@python.org License: BSD # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å ´æ‰€ Location: /usr/local/lib/python3.8/site-packages # ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¾å­˜å¯¾è±¡ Requires: sphinxcontrib-applehelp, imagesize, docutils, sphinxcontrib-serializinghtml, snowballstemmer, sphinxcontrib-htmlhelp, sphinxcontrib-devhelp, sphinxcontrib-jsmath, setuptools, packaging, Pygments, babel, alabaster, sphinxcontrib-qthelp, requests, Jinja2 # ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä¾å­˜å¯¾è±¡ã¨ã—ã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Required-by: sphinxcontrib.sqltable, sphinx-rtd-theme, recommonmark npm ãƒ»å…¥æ‰‹æ–¹æ³• # ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ $ curl -sL https://rpm.nodesource.com/setup_.x | bash - # nodejsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«npmã‚‚å«ã¾ã‚Œã‚‹ $ yum install nodejs ãƒ»init package.jsonã‚’ç”Ÿæˆã™ã‚‹ã€‚ $ npm init ãƒ»install ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« $ npm install # ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆã‚ã¾ã‚Šä½¿ã‚ãªã„ï¼‰ $ npm install -g 05-03. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ rpm ãƒ»-ivh ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¾ãŸã¯æ›´æ–°ã™ã‚‹ã€‚ä¸€åº¦ã«è¤‡æ•°ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿åˆã‚ã›ã¦è¨˜è¿°ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸é–“ã®ä¾å­˜é–¢ä¿‚ã‚’è§£æ±ºã§ããªã„ã®ã§æ³¨æ„ã€‚ # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # -ivhï¼š--install -v --hash $ rpm -ivh # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ›´æ–° # -Uvhï¼š--upgrade -v --hash $ rpm -Uvh ãƒ»-qa ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸå…¨ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¸­ã§ã€æŒ‡å®šã—ãŸæ–‡å­—ã‚’åå‰ã«å«ã‚€ã‚‚ã®ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ # -qaï¼š $ rpm -qa | grep ãƒ»-ql æŒ‡å®šã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã§ã€é–¢é€£ã™ã‚‹å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ # -qlï¼š $ rpm -ql ãƒ»-qi æŒ‡å®šã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ—¥ãªã©ã®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ # -qiï¼š $ rpm -qi yumã€dnf ãƒ»installã€reinstall rpmã¨åŒæ§˜ã®ä½¿ã„æ–¹ãŒã§ãã‚‹ã€‚ã¾ãŸã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸é–“ã®ä¾å­˜é–¢ä¿‚ã‚’è§£æ±ºã§ãã‚‹ã€‚ # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« $ yum install -y # å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ™‚ã¯ã€reinstallã¨ã™ã‚‹ã“ã¨ $ yum reinstall -y ãƒ»list ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸå…¨ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ # æŒ‡å®šã—ãŸæ–‡å­—ã‚’åå‰ã«å«ã‚€ã‚‚ã®ã‚’è¡¨ç¤ºã€‚ $ yum list | grep ãƒ»EPELãƒªãƒã‚¸ãƒˆãƒªã€Remiãƒªãƒã‚¸ãƒˆãƒª CentOSå…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„ã“ã¨ãŒã‚ã‚‹ã€‚ãã“ã§ã€--enablerepoã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã¨ã€CentOSå…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ãªãã€æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ‰±ã†å¤–éƒ¨ãƒªãƒã‚¸ãƒˆãƒªï¼ˆEPELã€Remiï¼‰ã‹ã‚‰ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã€‚å¤–éƒ¨ãƒªãƒã‚¸ãƒˆãƒªé–“ã§ä¾å­˜é–¢ä¿‚ã«ã‚ã‚‹ãŸã‚ã€ä¸¡æ–¹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ CentOSã®EPELãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€/etc/yu.repos.d/* ã«é…ç½®ã•ã‚Œã‚‹ã€‚ # CentOS7ç³»ã®å ´åˆ $ yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm # CentOS8ç³»ã®å ´åˆ $ dnf install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm # ã“ã¡ã‚‰ã§ã‚‚ã‚ˆã„ $ yum install -y epel-release ã§ã‚‚ã‚ˆã„ CentOSã®Remiãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚Remiãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯CentOSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¦ç¢ºèªã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€/etc/yu.repos.d/*ã«é…ç½®ã•ã‚Œã‚‹ã€‚ # CentOS7ç³»ã®å ´åˆ $ yum install -y https://rpms.remirepo.net/enterprise/remi-release-7.rpm # CentOS8ç³»ã®å ´åˆ $ dnf install -y https://rpms.remirepo.net/enterprise/remi-release-8.rpm è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¸ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ãƒªãƒ³ã‚¯ãªã©ãŒè‡ªå‹•çš„ã«æ›¸ãè¾¼ã¾ã‚Œã‚‹ã€‚ [epel] name=Extra Packages for Enterprise Linux 6 - $basearch #baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&arch=$basearch failovermethod=priority enabled=0 gpgcheck=1 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6 [epel-debuginfo] name=Extra Packages for Enterprise Linux 6 - $basearch - Debug #baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch/debug mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-debug-6&arch=$basearch failovermethod=priority enabled=0 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6 gpgcheck=1 [epel-source] name=Extra Packages for Enterprise Linux 6 - $basearch - Source #baseurl=http://download.fedoraproject.org/pub/epel/6/SRPMS mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-source-6&arch=$basearch failovermethod=priority enabled=0 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6 gpgcheck=1 Remiãƒªãƒã‚¸ãƒˆãƒªã®æœ‰åŠ¹åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ°¸ç¶šçš„ã«ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ # CentOS7ã®å ´åˆ $ yum install -y yum-utils # æ°¸ç¶šçš„ã«æœ‰åŠ¹åŒ– $ yum-config-manager --enable remi-php74 # CentOS8ã®å ´åˆï¼ˆdnf moduleã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ï¼‰ $ dnf module enable php:remi-7.4 remiãƒªãƒã‚¸ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ã€phpã€php-mbstringã€php-mcryptã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚Remiãƒªãƒã‚¸ãƒˆãƒªã‚’çµŒç”±ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯/opt/remi/*ã«é…ç½®ã•ã‚Œã‚‹ã€‚ # CentOS7ã®å ´åˆ # ä¸€æ™‚çš„ã«æœ‰åŠ¹åŒ–ã§ãã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦ã€æ˜ç¤ºçš„ã«remiã‚’æŒ‡å®š $ yum install --enablerepo=remi,remi-php74 -y php php-mbstring php-mcrypt # CentOS8ã®å ´åˆ # ãƒªãƒã‚¸ãƒˆãƒªã®èªè­˜ã«å¤±æ•—ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã®ã§ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— $ dnf install -y php php-mbstring php-mcrypt å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ™‚ã¯ã€reinstallã¨ã™ã‚‹ã“ã¨ã€‚ # CentOS7ã®å ´åˆ # ä¸€æ™‚çš„ã«æœ‰åŠ¹åŒ–ã§ãã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦ã€æ˜ç¤ºçš„ã«remiã‚’æŒ‡å®š $ yum reinstall --enablerepo=remi,remi-php74 -y php php-mbstring php-mcrypt # CentOS8ã®å ´åˆ # ãƒªãƒã‚¸ãƒˆãƒªã®èªè­˜ã«å¤±æ•—ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã®ã§ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— $ dnf reinstall -y php php-mbstring php-mcrypt 05-04. è¨€èªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ pyenv ãƒ»which # pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèª $ pyenv which python /.pyenv/versions/3.8.0/bin/python "},"public/software/software_basic_kernel.html":{"url":"public/software/software_basic_kernel.html","title":"ğŸ“– ï¸ã‚«ãƒ¼ãƒãƒ«","keywords":"","body":"åˆ¶å¾¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼ˆã‚«ãƒ¼ãƒãƒ«ï¼‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. åˆ¶å¾¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼ˆã‚«ãƒ¼ãƒãƒ«ï¼‰ ï¼ˆä¾‹ï¼‰ã‚«ãƒ¼ãƒãƒ«ã€ãƒã‚¤ã‚¯ãƒ­ã‚«ãƒ¼ãƒãƒ«ã€ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚«ãƒ¼ãƒãƒ« 02. é€šä¿¡ç®¡ç† SELinuxï¼šSecurity Enhanced Linux Linuxã«æ¨™æº–ã§å°å…¥ã•ã‚Œã¦ã„ã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€‚ãŸã ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®é€šä¿¡ã‚’é®æ–­ã—ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€åŸºæœ¬çš„ã«ã¯ç„¡åŠ¹ã«ã—ã¦ãŠãã€‚ SELinuxã®çŠ¶æ…‹ã‚’ç¢ºèª $ getenforce # æœ‰åŠ¹ã®å ´åˆ Enforcing /etc/sellnux/configã‚’ä¿®æ­£ã™ã‚‹ã€‚ # This file controls the state of SELinux on the system. # SELINUX= can take one of these three values: # enforcing - SELinux security policy is enforced. # permissive - SELinux prints warnings instead of enforcing. # disabled - No SELinux policy is loaded. SELINUX=disabled # OSã‚’å†èµ·å‹• OSã‚’å†èµ·å‹•ã—ãªã„ã¨è¨­å®šãŒåæ˜ ã•ã‚Œãªã„ã€‚ 03 ã‚¸ãƒ§ãƒ–ç®¡ç† ã‚¸ãƒ§ãƒ–ç®¡ç†ã¨ã¯ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€ãƒã‚¹ã‚¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¯¾ã—ã¦ã€ã‚¸ãƒ§ãƒ–ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®å‘½ä»¤ã‚’ä¸ãˆã‚‹ã€‚ ãƒã‚¹ã‚¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ©ã€ã‚¸ãƒ§ãƒ–ã‚¹ã‚±ã‚¸ãƒ¥ãƒ© ã‚¸ãƒ§ãƒ–ã¨ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ã‚»ãƒƒãƒˆã®ã“ã¨ã€‚ãƒã‚¹ã‚¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ©ã¯ã€ã‚¸ãƒ§ãƒ–ã‚¹ã‚±ã‚¸ãƒ¥ãƒ©ã«ã‚¸ãƒ§ãƒ–ã®å®Ÿè¡Œã‚’å‘½ä»¤ã™ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«å…¥åŠ›ã—ã€è¤‡æ•°ã®å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã€çµæœãŒå‡ºåŠ›ã•ã‚Œã‚‹ã¾ã§ã®ä¸€é€£ã®å‡¦ç†ã®ã“ã¨ã€‚ã€Taskã€ã¨ã€Jobã€ã®å®šç¾©ã¯æ›–æ˜§ãªã®ã§ã€ã€processã€ã¨ã€set of processesã€ã‚’ä½¿ã†ã¹ãã¨ã®ã“ã¨ã€‚ å¼•ç”¨ï¼šhttps://stackoverflow.com/questions/3073948/job-task-and-process-whats-the-difference/31212568 è¤‡æ•°ã®ã‚¸ãƒ§ãƒ–ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚„ãƒãƒƒãƒï¼‰ã®èµ·å‹•ã¨çµ‚äº†ã‚’åˆ¶å¾¡ã—ãŸã‚Šã€ã‚¸ãƒ§ãƒ–ã®å®Ÿè¡Œã¨çµ‚äº†ã‚’ç›£è¦–å ±å‘Šã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã€‚ã‚„ã‚„ã“ã—ã„ã“ã¨ã«ã€ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã¨ã‚‚å‘¼ã¶ã€‚ ãƒ»Reader ã‚¸ãƒ§ãƒ–å¾…ã¡è¡Œåˆ—ã«ç™»éŒ² ãƒ»Initiator ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã«åˆ†è§£ ãƒ»Terminator å‡ºåŠ›å¾…ã¡è¡Œåˆ—ã«ç™»éŒ² ãƒ»Writer å„ªå…ˆåº¦é †ã«å‡ºåŠ›ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œ Initiatorã«ã‚ˆã‚‹ã‚¸ãƒ§ãƒ–ã®ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã¸ã®åˆ†è§£ Initiatorã«ã‚ˆã£ã¦ã€ã‚¸ãƒ§ãƒ–ã¯ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã«åˆ†è§£ã•ã‚Œã‚‹ã€‚ 04. ã‚¿ã‚¹ã‚¯ç®¡ç† ã‚¿ã‚¹ã‚¯ç®¡ç†ã¨ã¯ ã‚¿ã‚¹ã‚¯ã¨ã¯ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã«ä¼¼ãŸã‚ˆã†ãªã€å˜ä¸€ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ã“ã¨ã€‚Initiatorã«ã‚ˆã‚‹ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰ã€ã‚¿ã‚¹ã‚¯ç®¡ç†ã«ã‚ˆã£ã¦ã€ã‚¿ã‚¹ã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚ã‚¿ã‚¹ã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹ã¨å®Ÿè¡Œå¯èƒ½çŠ¶æ…‹ã«ãªã‚‹ã€‚ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ã«ã‚ˆã£ã¦å®Ÿè¡Œå¯èƒ½çŠ¶æ…‹ã‹ã‚‰å®Ÿè¡ŒçŠ¶æ…‹ã«ãªã‚‹ã€‚ å„ªå…ˆé †æ–¹å¼ å„ã‚¿ã‚¹ã‚¯ã«å„ªå…ˆåº¦ã‚’è¨­å®šã—ã€å„ªå…ˆåº¦ã®é«˜ã„ã‚¿ã‚¹ã‚¯ã‹ã‚‰é †ã«ã€ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã—ã¦ã„ãæ–¹å¼ã€‚ åˆ°ç€é †æ–¹å¼ å¾…ã¡è¡Œåˆ—ã«ç™»éŒ²ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‹ã‚‰é †ã«ã€ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã—ã¦ã„ãæ–¹å¼ã€‚ ï¼Šä¾‹ï¼Š ä»¥ä¸‹ã®æ§˜ã«ã€ã‚¿ã‚¹ã‚¯ãŒCPUã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ãã€‚ Round robin æ–¹å¼ Round robinã¯ã€ã€ç·å½“ãŸã‚Šã€ã®æ„å‘³ã€‚ä¸€å®šæ™‚é–“ï¼ˆã‚¿ã‚¤ãƒ ã‚¯ã‚¦ã‚©ãƒ³ã‚¿ãƒ ï¼‰ã”ã¨ã«ã€å®Ÿè¡ŒçŠ¶æ…‹ã«ã‚ã‚‹ã‚¿ã‚¹ã‚¯ãŒå¼·åˆ¶çš„ã«å¾…ã¡è¡Œåˆ—ã«ç™»éŒ²ã•ã‚Œã‚‹ã€‚äº¤ä»£ã™ã‚‹ã‚ˆã†ã«ã€ä»–ã®ã‚¿ã‚¹ã‚¯ãŒãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã•ã‚Œã‚‹ã€‚ ï¼Šä¾‹ï¼Š ç”Ÿæˆã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®åˆ°ç€æ™‚åˆ»ã¨å‡¦ç†æ™‚é–“ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã‚ã‚‹ã€‚å¼·åˆ¶çš„ãªãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã¯ã€ã€20ç§’ã€ã”ã¨ã«èµ·ã“ã‚‹ã¨ã™ã‚‹ã€‚ ã‚¿ã‚¹ã‚¯AãŒ0ç§’ã«å¾…ã¡è¡Œåˆ—ã¸ç™»éŒ²ã•ã‚Œã‚‹ã€‚ 20ç§’é–“ã€ã‚¿ã‚¹ã‚¯Aã¯å®Ÿè¡ŒçŠ¶æ…‹ã¸å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ 20ç§’æ™‚ç‚¹ã§ã€ã‚¿ã‚¹ã‚¯Aã¯å®Ÿè¡ŒçŠ¶æ…‹ã‹ã‚‰å¾…ã¡è¡Œåˆ—ã«è¿½åŠ ã•ã‚Œã‚‹ã€‚åŒæ™‚ã«ã€å¾…ã¡è¡Œåˆ—ã®å…ˆé ­ã«ã„ã‚‹ã‚¿ã‚¹ã‚¯Bã¯ã€å®Ÿè¡Œå¯èƒ½çŠ¶æ…‹ã‹ã‚‰å®Ÿè¡ŒçŠ¶æ…‹ã«ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã•ã‚Œã‚‹ã€‚ 40ç§’æ™‚ç‚¹ã§ã€ã‚¿ã‚¹ã‚¯Cã¯å®Ÿè¡ŒçŠ¶æ…‹ã‹ã‚‰å¾…ã¡è¡Œåˆ—ã«è¿½åŠ ã•ã‚Œã‚‹ã€‚åŒæ™‚ã«ã€å¾…ã¡è¡Œåˆ—ã®å…ˆé ­ã«ã„ã‚‹ã‚¿ã‚¹ã‚¯Aã¯ã€å®Ÿè¡Œå¯èƒ½çŠ¶æ…‹ã‹ã‚‰å®Ÿè¡ŒçŠ¶æ…‹ã«ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã•ã‚Œã‚‹ã€‚ 05. å…¥å‡ºåŠ›ç®¡ç† å…¥å‡ºåŠ›ç®¡ç†ã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ä½é€Ÿãªå‘¨è¾ºæ©Ÿå™¨ã¸ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹æ™‚ã€ã¾ãšã€CPUã¯ã‚¹ãƒ—ãƒ¼ãƒ©ã«ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹ã€‚Spoolerã¯ã€å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã¾ã¨ã‚ã¦å‡ºåŠ›ã™ã‚‹ã®ã§ã¯ãªãã€ä¸€æ™‚çš„ã«è£œåŠ©è¨˜æ†¶è£…ç½®ï¼ˆSpoolï¼‰ã«ãŸã‚ã¦ãŠããªãŒã‚‰ã€å°‘ã—ãšã¤å‡ºåŠ›ã™ã‚‹ï¼ˆSpoolingï¼‰ã€‚ ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ« ãƒ»ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ ã‚«ãƒ¼ãƒãƒ«ãŒå®Ÿéš›ã®å…¥å‡ºåŠ›è£…ç½®ã‚„æ¨™æº–å…¥å‡ºåŠ›ã‚’æ“ä½œã§ãã‚‹ã‚ˆã†ã«ã€ã“ã‚Œã‚‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ‰±ã£ãŸã‚‚ã®ã€‚/devãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã«é…ç½®ã•ã‚Œã¦ãŠã‚Šã€å„ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯å…·ä½“çš„ãªå…¥å‡ºåŠ›è£…ç½®ã‚’ç¤ºã™ç•ªå·ï¼ˆãƒ¡ã‚¸ãƒ£ãƒ¼ç•ªå·ã€ãƒã‚¤ãƒŠãƒ¼ç•ªå·ï¼‰ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ“ä½œã™ã‚‹ã¨ã€å…¥å‡ºåŠ›è£…ç½®ã‚„æ¨™æº–å…¥å‡ºåŠ›ã«å¯¾ã—ã¦ãã®æ“ä½œãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://e-words.jp/w/%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB.html https://qiita.com/angel_p_57/items/1faafa275525469788b4 ï¼Šä¾‹ï¼Š å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ç¢ºèªã™ã‚‹ã€‚ $ ls -la /dev total 10 dr-xr-xr-x 3 root wheel 4616 Oct 19 09:34 . drwxr-xr-x 20 root wheel 640 Jan 1 2020 .. # ï½ ä¸­ç•¥ ï½ dr-xr-xr-x 1 root wheel 0 Oct 19 09:34 fd # ï½ ä¸­ç•¥ ï½ crw-rw-rw- 1 root wheel 3, 2 Nov 23 17:35 null # ï½ ä¸­ç•¥ ï½ lr-xr-xr-x 1 root wheel 0 Oct 19 09:34 stderr -> fd/2 lr-xr-xr-x 1 root wheel 0 Oct 19 09:34 stdin -> fd/0 lr-xr-xr-x 1 root wheel 0 Oct 19 09:34 stdout -> fd/1 # ï½ ä¸­ç•¥ ï½ crw-rw-rw- 1 root wheel 2, 0 Oct 19 09:34 tty # ï½ ä¸­ç•¥ ï½ ãƒ»ãƒ–ãƒ­ãƒƒã‚¯ãƒ‡ãƒã‚¤ã‚¹ï¼ˆãƒ–ãƒ­ãƒƒã‚¯ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ ã‚ã‚‹ç¨‹åº¦ã®ã¾ã¨ã¾ã‚Šã§ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†å…¥å‡ºåŠ›è£…ç½®ã«ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚HHDï¼ˆ/dev/hdï¼‰ã€ãƒ¡ãƒ¢ãƒªã€ãªã©ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.wikipedia.org/wiki/%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB ãƒ»ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒã‚¤ã‚¹ï¼ˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ ä¸€æ–‡å­—å˜ä½ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†å…¥å‡ºåŠ›è£…ç½®ã«ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ãƒ—ãƒªãƒ³ã‚¿ãƒ¼ï¼ˆ/dev/lpï¼‰ã€ãƒ¢ãƒ‡ãƒ ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã€ãªã©ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.wikipedia.org/wiki/%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB ãƒ»æ“¬ä¼¼ãƒ‡ãƒã‚¤ã‚¹ ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­ã§ã€å®Ÿéš›ã®è£…ç½®ã«å¯¾å¿œã—ã¦ã„ãªã„ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚æ¨™æº–å…¥å‡ºåŠ›ï¼ˆ/dev/stdinã€/dev/stdoutï¼‰ã‚„ç ´æ£„ï¼ˆ/dev/nullï¼‰ãªã©ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.wikipedia.org/wiki/%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB "},"public/software/software_basic_language_processor.html":{"url":"public/software/software_basic_language_processor.html","title":"ğŸ“– ï¸è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µ","keywords":"","body":"è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª è¨€èªã®ç¨®é¡ ãƒ—ãƒ­ã‚°ãƒ©ãƒ è¨€èªã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µã«ã‚ˆã£ã¦æ©Ÿæ¢°èªã«å¤‰æ›ã•ã‚ŒãŸå¾Œã€CPUã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã—ã¦ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«æ›¸ã‹ã‚ŒãŸæ§˜ã€…ãªå‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å‹è¨€èª ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å‹è¨€èªã¨ã¯ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¨ã„ã†è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µã«ã‚ˆã£ã¦ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æ–¹å¼ã§ç¿»è¨³ã•ã‚Œã‚‹è¨€èªã€‚ ãƒ»ä¾‹ Goã€Cã€C#ã€ãªã©ã€‚ ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿å‹è¨€èª ãƒ»ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿å‹è¨€èªã¨ã¯ ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã¨ã„ã†è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µã«ã‚ˆã£ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿æ–¹å¼ã§ç¿»è¨³ã•ã‚Œã‚‹è¨€èªã‚’ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿å‹è¨€èªã¨ã„ã†ã€‚ ãƒ»ä¾‹ PHPã€Rubyã€JavaScriptã€Pythonã€ãªã©ã€‚ ä¸­é–“å‹è¨€èª ãƒ»ä¸­é–“å‹è¨€èªã¨ã¯ Javaä»®æƒ³ãƒã‚·ãƒ³ã«ã‚ˆã£ã¦ã€ä¸­é–“è¨€èªæ–¹å¼ã§ç¿»è¨³ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://kanda-it-school-kensyu.com/java-basic-intro-contents/jbi_ch01/jbi_0102/ ãƒ»ä¾‹ Javaã€Scalaã€Groovyã€Kotlinã€ãªã©ã€‚ 02. è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µã«ã‚ˆã‚‹ç¿»è¨³æ–¹å¼ ã‚¢ã‚»ãƒ³ãƒ–ãƒ©æ–¹å¼ ãƒ»ã‚¢ã‚»ãƒ³ãƒ–ãƒ©æ–¹å¼ã¨ã¯ ã‚¢ã‚»ãƒ³ãƒ–ãƒªå‹è¨€èªã‚’æ©Ÿæ¢°èªã«ç¿»è¨³ã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æ–¹å¼ ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æ–¹å¼ã¨ã¯ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å‹è¨€èªã‚’æ©Ÿæ¢°èªã«ç¿»è¨³ã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿æ–¹å¼ ãƒ»ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿æ–¹å¼ã¨ã¯ ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿å‹è¨€èªã‚’æ©Ÿæ¢°èªã«ç¿»è¨³ã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ 02-02. ã‚¢ã‚»ãƒ³ãƒ–ãƒªå‹è¨€èªã®æ©Ÿæ¢°èªç¿»è¨³ 02-03. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å‹è¨€èªã®æ©Ÿæ¢°èªç¿»è¨³ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æ–¹å¼ ãƒ»æ©Ÿæ¢°èªç¿»è¨³ã¨å®Ÿè¡Œ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã«ç¿»è¨³ã—ãŸå¾Œã€CPUä¸Šã§å‘½ä»¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚å‘½ä»¤ã®çµæœã¯ãƒ¡ãƒ¢ãƒªã«ä¿ç®¡ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š http://samuiui.com/2019/02/24/google-colaboratory%E3%81%A7python%E5%85%A5%E9%96%80/ https://qiita.com/tk_01/items/a84408b5436ec97bfbe1#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%8C%E5%8B%95%E3%81%8F%E4%BB%95%E7%B5%84%E3%81%BF ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã‚‹ãƒ“ãƒ«ãƒ‰ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«ã‚ˆã£ã¦ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯æ©Ÿæ¢°èªã‹ã‚‰ãªã‚‹ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ãã®å¾Œã€ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã¯ãƒªãƒ³ã‚¯ã•ã‚Œã€‚exeãƒ•ã‚¡ã‚¤ãƒ«ã¨ãªã‚‹ã€‚ã“ã®ä¸€é€£ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€ãƒ“ãƒ«ãƒ‰ã€ã¨ã„ã†ã€‚ã¾ãŸã€ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆï¼ˆæˆæœç‰©ï¼‰ã€ã¨ã„ã†ã€‚ ä»•çµ„ã¿ ï¼ˆï¼‘ï¼‰Lexical analysisï¼ˆå­—å¥è§£æï¼‰ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®æ–‡å­—åˆ—ã‚’è¨€èªã®æœ€å°å˜ä½ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã®åˆ—ã«åˆ†è§£ã™ã‚‹ã€‚ ä»¥ä¸‹ã«ã€ãƒˆãƒ¼ã‚¯ãƒ³ã®åˆ†é¡æ–¹æ³•ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ ï¼ˆï¼’ï¼‰Syntax analysisï¼ˆæ§‹æ–‡è§£æï¼‰ ãƒˆãƒ¼ã‚¯ãƒ³ã®åˆ—ã‚’ãƒ„ãƒªãƒ¼æ§‹é€ ã«å¤‰æ›ã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰Semantics analysisï¼ˆæ„å‘³è§£æï¼‰ ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’åŸºã«ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«è«–ç†çš„ãªèª¤ã‚ŠãŒãªã„ã‹ã‚’è§£æã™ã‚‹ã€‚ ï¼ˆï¼”ï¼‰Code optimizationï¼ˆã‚³ãƒ¼ãƒ‰æœ€é©åŒ–ï¼‰ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å†—é•·ãªéƒ¨åˆ†ã‚’å‰Šé™¤ã¾ãŸã¯ç·¨é›†ã™ã‚‹ã€‚æ©Ÿæ¢°èªã‚’ã‚ˆã‚ŠçŸ­ãã™ã‚‹ã“ãŒã§ãã‚‹ã€‚ ï¼ˆï¼•ï¼‰Code generationï¼ˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼‰ æœ€é©åŒ–ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã™ã‚‹ã€‚ ï¼ˆï¼–ï¼‰ãƒªãƒ³ã‚¯ ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ³ã‚¯ã™ã‚‹ã€‚ ï¼ˆï¼—ï¼‰å‘½ä»¤ã®å®Ÿè¡Œ ãƒªãƒ³ã‚¯ã•ã‚ŒãŸãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã‚’åŸºã«ã€å‘½ä»¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ makeã«ã‚ˆã‚‹ãƒ“ãƒ«ãƒ‰ ï¼ˆï¼‘ï¼‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å…¬å¼ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨è§£ç­” $ wget $ tar # ãƒ“ãƒ«ãƒ‰ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆã€‚ $ mkdir build $ cd build ï¼ˆï¼’ï¼‰ãƒ“ãƒ«ãƒ‰ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾© configureãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ã€ãƒ«ãƒ¼ãƒ«ãŒå®šç¾©ã•ã‚ŒãŸMakefileã‚’ä½œæˆã™ã‚‹ã€‚ # configureã¸ã®ãƒ‘ã‚¹ã«æ³¨æ„ã€‚ $ ../configure --prefix=\"\" ï¼ˆï¼“ï¼‰ãƒ“ãƒ«ãƒ‰ ï¼ˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼‹ãƒªãƒ³ã‚¯ï¼‰ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰exeãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã€‚ # -j ã§ç”¨ã„ã‚‹ã‚³ã‚¢æ•°ã‚’å®£è¨€ã—ã€å‡¦ç†ã®é€Ÿåº¦ã‚’ä¸Šã’ã‚‰ã‚Œã‚‹ã€‚ $ make -j4 ä»»æ„ã§ã€exeãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œãˆã‚‹ã€‚ $ make check ï¼ˆï¼”ï¼‰exeãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œ ç”Ÿæˆã•ã‚ŒãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€æŒ‡å®šã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ã€‚ # installã¨å‘½ä»¤ã™ã‚‹ãŒã€å®Ÿéš›ã¯ã‚³ãƒ”ãƒ¼ã€‚sudoã‚’ä»˜ã‘ã‚‹ã€‚ $ sudo make install å…ƒã¨ãªã£ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚„ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã€‚ $ make clean 02-04. ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿å‹è¨€èªã®æ©Ÿæ¢°èªç¿»è¨³ ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿æ–¹å¼ ãƒ»æ©Ÿæ¢°èªç¿»è¨³ã¨å®Ÿè¡Œ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã«ä¸€è¡Œãšã¤å¤‰æ›ã—ã€ãã®éƒ½åº¦ã€CPUä¸Šã§å‘½ä»¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚å‘½ä»¤ã®çµæœã¯ãƒ¡ãƒ¢ãƒªã«ä¿ç®¡ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š http://samuiui.com/2019/02/24/google-colaboratory%E3%81%A7python%E5%85%A5%E9%96%80/ https://qiita.com/tk_01/items/a84408b5436ec97bfbe1#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%8C%E5%8B%95%E3%81%8F%E4%BB%95%E7%B5%84%E3%81%BF ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ãã®ã¾ã¾å…¥åŠ›ã—ã€æ©Ÿæ¢°èªç¿»è¨³ã¨å®Ÿè¡Œã‚’è¡Œãˆã‚‹ã€‚ #=========== # PHPã®å ´åˆ #=========== # PHPãªã®ã§ã€å‡¦ç†çµ‚ã‚ã‚Šã«ã‚»ãƒŸã‚³ãƒ­ãƒ³ãŒå¿…è¦ $ php -r \"\" # Hello Worldã‚’å‡ºåŠ› $ php -r \"echo \"Hello World\";\" # phpinfoã‚’å‡ºåŠ› $ php -r \"phpinfo();\" # ï¼ˆãŠã¾ã‘ï¼‰phpinfoã®å‡ºåŠ›ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ $ php -r \"phpinfo();\" > phpinfo.txt # php.iniã®èª­ã¿è¾¼ã¿çŠ¶æ³ã‚’å‡ºåŠ› $ php --ini ä»•çµ„ã¿ ï¼ˆï¼‘ï¼‰Lexical analysisï¼ˆå­—å¥è§£æï¼‰ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®æ–‡å­—åˆ—ã‚’è¨€èªã®æœ€å°å˜ä½ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã®åˆ—ã«åˆ†è§£ã€‚ ä»¥ä¸‹ã«ã€ãƒˆãƒ¼ã‚¯ãƒ³ã®åˆ†é¡æ–¹æ³•ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ ï¼ˆï¼’ï¼‰Syntax analysisï¼ˆæ§‹æ–‡è§£æï¼‰ ãƒˆãƒ¼ã‚¯ãƒ³ã®åˆ—ã‚’ãƒ„ãƒªãƒ¼æ§‹é€ ã«å¤‰æ›ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰æ§‹é€ ä½“ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ã‚’æ§‹æ–‡è§£æã¨ã„ã„ã€htmlã‚’æ§‹æ–‡è§£æã—ã¦DOMãƒ„ãƒªãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹å‡¦ç†ã¨ã¯åˆ¥ç‰©ãªã®ã§æ³¨æ„ã€‚ ï¼ˆï¼“ï¼‰Semantics analysisï¼ˆæ„å‘³è§£æï¼‰ ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’åŸºã«ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«è«–ç†çš„ãªèª¤ã‚ŠãŒãªã„ã‹è§£æã€‚ ï¼ˆï¼”ï¼‰å‘½ä»¤ã®å®Ÿè¡Œ æ„å‘³è§£æã®çµæœã‚’åŸºã«ã€å‘½ä»¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼ˆï¼•ï¼‰ï¼‘ã‹ã‚‰ï¼”ã‚’ã‚³ãƒ¼ãƒ‰è¡Œã”ã¨ã«ç¹°ã‚Šè¿”ã™ 02-05. ä¸­é–“å‹è¨€èªã®æ©Ÿæ¢°èªç¿»è¨³ ä¸­é–“è¨€èªæ–¹å¼ ãƒ»ä¸­é–“è¨€èªæ–¹å¼ã®æ©Ÿæ¢°èªç¿»è¨³ã®æµã‚Œ Javaã¾ãŸã¯JVMå‹è¨€èªã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã€Javaãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã™ã‚‹ã€‚ JVMï¼šJava Virtual Machineå†…ã§ã€ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã«ã‚ˆã£ã¦ã€ã‚¯ãƒ©ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’æ©Ÿæ¢°èªã«ç¿»è¨³ã™ã‚‹ã€‚ çµæœçš„ã«ã€OSï¼ˆåˆ¶å¾¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼Ÿï¼‰ã«ä¾å­˜ã›ãšã«ã€å‘½ä»¤ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ï¼ˆCè¨€èªï¼‰ ãƒ»Cè¨€èªã¨Javaã®OSã¸ã®ä¾å­˜åº¦æ¯”è¼ƒ JVMè¨€èª ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ "},"public/software/software_basic_language_processor_process_mode.html":{"url":"public/software/software_basic_language_processor_process_mode.html","title":"ğŸ“– ï¸è¨€èªåˆ¥ã®å‡¦ç†æ–¹å¼","keywords":"","body":"è¨€èªåˆ¥ã®å‡¦ç†æ–¹å¼ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ã¯ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã®èµ·ç‚¹ã¨ãªã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼é–¢æ•°ã®ã“ã¨ã€‚ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼é–¢æ•°ã‚’èµ·ç‚¹ã¨ã—ã¦ã€ãã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://en.wikipedia.org/wiki/Entry_point å‹•çš„å‹ä»˜ã‘å‹è¨€èªã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ ãƒ»ç‰¹å¾´ å‹•çš„å‹ä»˜ã‘è¨€èªã§ã¯ã€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã®å®šç¾©æ–¹æ³•ãŒå¼·åˆ¶ã•ã‚Œãšã€æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­è¡ŒãŒã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã«ãªã‚‹ã€‚ãŸã ã—æ…£ä¾‹ã¨ã—ã¦ã€ã€indexã€ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ã™ã‚‹è¨€èªãŒå¤šã„ã€‚ ãƒ»PHPã®å ´åˆ æ…£ä¾‹ã¨ã—ã¦index.phpãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ã™ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã€‚ é™çš„å‹ä»˜ã‘å‹è¨€èªã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ ãƒ»ç‰¹å¾´ é™çš„å‹ä»˜ã‘è¨€èªã§ã¯ã€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã®å®šç¾©æ–¹æ³•ãŒå¼·åˆ¶ã•ã‚Œã‚‹ã€‚ã€mainã€ã¨ã„ã†åå‰ã®é–¢æ•°ã§ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‚’å®šç¾©ã•ã›ã‚‹è¨€èªãŒå¤šã„ã€‚ ãƒ»Javaã®å ´åˆ ä¿®é£¾å­ãŒã€public staticã€ã€è¿”å´å€¤å‹ãŒã€voidã€ã€å¼•æ•°åãŒã€argsã€ã€å¼•æ•°å‹ãŒã€String[]ã€ã§ã‚ã‚‹mainé–¢æ•°ãŒã€è‡ªå‹•çš„ã«ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã«ãªã‚‹ã€‚ import java.util.*; public class Main { // ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹é–¢æ•° public static void main(String[] args) { // ä»–ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ç¹‹ãŒã‚‹å‡¦ç† } } ãƒ»Goã®å ´åˆ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åãŒã€mainã€ã§ã‚ã‚‹`mainãŒã€è‡ªå‹•çš„ã«ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹ã€‚ package main // ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹é–¢æ•° func main() { // ä»–ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ç¹‹ãŒã‚‹å‡¦ç† } 02. ä¸¦è¡Œå‡¦ç†ï¼ˆConcurrent processingï¼‰ ä¸¦è¡Œå‡¦ç†ã¨ã¯ ãƒ—ãƒ­ã‚»ã‚¹ã§ã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ¬ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã€è¤‡æ•°ã®å‡¦ç†ã‚’ã€ç‹¬ç«‹çš„ã€ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚ å‚è€ƒï¼š https://techdifferences.com/difference-between-concurrency-and-parallelism.html https://moz.hatenablog.jp/entry/2018/04/10/175643 https://zenn.dev/hsaki/books/golang-concurrency/viewer/term è¨€èªåˆ¥ã®ä¸¦è¡Œå‡¦ç† 03. ä¸¦åˆ—å‡¦ç†ï¼ˆParallel processingï¼‰ ä¸¦åˆ—å‡¦ç†ã¨ã¯ ãƒ—ãƒ­ã‚»ã‚¹ã§ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã€å„ã‚¹ãƒ¬ãƒƒãƒ‰ä¸Šã§è¤‡æ•°ã®å‡¦ç†ã‚’ã€åŒæ™‚ç™ºç”Ÿçš„ã€ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚é–‹å§‹ã¯åŒæ™‚ã§ã‚ã‚‹ãŒã€çµ‚äº†ã¯ãƒãƒ©ãƒãƒ©ã«ãªã‚‹ã€‚ å‚è€ƒï¼š https://techdifferences.com/difference-between-concurrency-and-parallelism.html https://moz.hatenablog.jp/entry/2018/04/10/175643 è¨€èªåˆ¥ã®ä¸¦åˆ—å‡¦ç† ãƒ»PHPã®å ´åˆ parallelãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼š https://github.com/krakjoe/parallel https://qiita.com/WhiteGrouse/items/6fb906386b8fbabd6405 ãƒ»JavaScriptã®å ´åˆ WebWorkerã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/API/Web_Workers_API/Using_web_workers ãƒ»Goã®å ´åˆ Goroutinesã‚’ç”¨ã„ã‚‹ã€‚ãŸã ã—ã€å®Ÿè¡Œç’°å¢ƒã«ã‚ˆã£ã¦ã¯ä¸¦åˆ—å‡¦ç†ã«ãªã‚‰ãšã«ã€ä¸¦è¡Œå‡¦ç†ã«ãªã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚ãã‚ŒãŒç†ç”±ã‹ã©ã†ã‹ã¯ã‚ã‹ã‚‰ãªã„ãŒã€Goã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Goroutinesã¯concurrencyã®é …ç›®ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://medium.com/sprocket-inc/goroutine-concurrent-and-parallel-programming-669eaae55e73 https://golang.org/doc/effective_go#concurrency https://qiita.com/taigamikami/items/fc798cdd6a4eaf9a7d5e 04. åŒæœŸå‡¦ç†ï¼ˆSynchronous processingï¼‰ åŒæœŸå‡¦ç†ã¨ã¯ å®Œäº†ã‚’å¾…ã£ã¦ã‹ã‚‰å¾Œç¶šã®å‡¦ç†ãŒå§‹ã¾ã‚‹ã‚ˆã†ãªå‡¦ç†ã®ã“ã¨ã€‚ 05. éåŒæœŸå‡¦ç†ï¼ˆAsynchronous processingï¼‰ éåŒæœŸå‡¦ç†ã¨ã¯ å®Œäº†ã‚’å¾…ãŸãšã«å¾Œç¶šã®å‡¦ç†ãŒå§‹ã¾ã‚Šã€å¾Œç¶šã®å‡¦ç†ã¨åŒæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ãªå‡¦ç†ã®ã“ã¨ã€‚ å‚è€ƒï¼š https://qiita.com/kiyodori/items/da434d169755cbb20447 https://qiita.com/klme_u6/items/ea155f82cbe44d6f5d88 éåŒæœŸå‡¦ç†ã®çµæœã‚’ç”¨ã„ã‚‹å¾Œç¶šå‡¦ç† ãƒ»å¾Œç¶šå‡¦ç†ã®å®šç¾© å¾Œç¶šã®å…¨å‡¦ç†ãŒéåŒæœŸå‡¦ç†ã¨ç„¡é–¢ä¿‚ã§ã‚ã‚Œã°ã€ãã®ã¾ã¾ã§å•é¡Œã¯èµ·ã“ã‚‰ãªã„ã€‚ã—ã‹ã—ã€å¾Œç¶šã®å‡¦ç†ã«éåŒæœŸå‡¦ç†ã®çµæœã‚’ç”¨ã„ã‚‹ã‚‚ã®ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ã“ã®å‡¦ç†ã ã‘ã¯éåŒæœŸå‡¦ç†ã®å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚è¨€èªåˆ¥ã«ã€éåŒæœŸå‡¦ç†ã®æˆå¦ã‚’ç®¡ç†ã—ã€å¾Œç¶šã™ã‚‹å‡¦ç†ã‚’å®šç¾©ã§ãã‚‹æ©Ÿèƒ½ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»JavaScriptã®å ´åˆ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_logic_asynchronous_process.html "},"public/software/software_basic_language_processor_machine_language_and_radix.html":{"url":"public/software/software_basic_language_processor_machine_language_and_radix.html","title":"ğŸ“– ï¸æ©Ÿæ¢°èªã¨é€²æ•°","keywords":"","body":"æ©Ÿæ¢°èªã¨é€²æ•° ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. æ©Ÿæ¢°èªã¨2é€²æ•°ã®é–¢ä¿‚ æ©Ÿæ¢°èªã¨ã¯ ã‚ã‚‰ã‚†ã‚‹æƒ…å ±ã‚’ã€0ã€ã¨ã€1ã€ã®2é€²æ•°ã‚’æ©Ÿæ¢°èªã¨ã—ã¦ã€CPUã«å¯¾ã—ã¦ã€å‘½ä»¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ æ§˜ã€…ãªé€²æ•°ã¨bitã®é–¢ä¿‚ ã—ã‹ã—ã€äººé–“ãŒæ‰±ã†ä¸Šã§ã¯8é€²æ•°ã‚ã‚‹ã„ã¯16é€²æ•°ã«å¤‰æ›ã—ã¦è¡¨ç¾ã™ã‚‹ã“ã¨ãŒé©ã—ã¦ã„ã‚‹ã€‚2é€²æ•°1ã‚±ã‚¿ãŒã€1 bitã€ã¨å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚8é€²æ•°ã®1ã‚±ã‚¿ã¯2é€²æ•°ã®3ã‚±ã‚¿ï¼ˆï¼3 bitï¼‰ã«ç›¸å½“ã—ã€16é€²æ•°ã®1ã‚±ã‚¿ã¯2é€²æ•°ã®4ã‚±ã‚¿ï¼ˆ4 bitï¼‰ã«ç›¸å½“ã™ã‚‹ã€‚ ãªãœï¼˜bitã‚’1Byteã¨ã™ã‚‹ã®ã‹ï¼Ÿï¼ˆåŠè§’è‹±æ•°å­—ã¨bitã®é–¢ä¿‚ï¼‰ ï¼˜bitã‚’ä¸€åŒºåˆ‡ã‚Šã¨ã—ã¦ã€ï¼‘Byteã¨è¡¨ç¾ã™ã‚‹ã€‚ã“ã‚Œã¯ã€åŠè§’è‹±æ•°å­—ä¸€æ–‡å­—ãŒï¼˜bitã®ãƒ‡ãƒ¼ã‚¿é‡ã‚’æŒã¤ã‹ã‚‰ã§ã‚ã‚‹ã€‚ Byteå˜ä½ 1000 Byte = 1k Byte ä¸€èˆ¬çš„ãªCPUãŒæ‰±ãˆã‚‹æƒ…å ±ã®ç¨®æ•° CPUã§ã¯ã€å„ãƒ‡ãƒ¼ã‚¿ã¯2é€²æ³•ã«ã‚ˆã£ã¦åŒºåˆ¥ã•ã‚Œã¦ã„ã‚‹ã€‚CPUã¯4 ã€8ã€16ã€32-bitãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨é€²æ­©ã—ã€2008å¹´ã®å¾ŒåŠã‹ã‚‰ã¯ 64-bitãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®CPUãŒæ™®åŠã—å§‹ã‚ãŸã€‚1-bitã¯2ç¨®é¡ã®æƒ…å ±ã‚’è¡¨ã™ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€32-bitã®CPUã§ã¯2^32ã€64-bitã§ã¯2^64ã®ç¨®é¡ã®æƒ…å ±ã‚’æ‰±ã†äº‹ãŒã§ãã‚‹ã€‚ 01-02. æ©Ÿæ¢°èªå‘½ä»¤ã®ç¨®é¡ è¨­å®šå‘½ä»¤ ãƒ»å®Ÿè¡Œã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ¬ã‚¸ã‚¹ã‚¿ã«è¨­å®šã™ã‚‹å ´åˆ ãƒ»å®Ÿè¡Œã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæŒ‡ã™èªã®å†…å®¹ã‚’ãƒ¬ã‚¸ã‚¹ã‚¿ã«è¨­å®šã™ã‚‹å ´åˆ ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ã®å†…å®¹ã‚’å®Ÿè¡Œã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ ¼ç´ã™ã‚‹å ´åˆ ã‚·ãƒ•ãƒˆå‘½ä»¤ è¨ˆç®—å‘½ä»¤ ãƒ¬ã‚¸ã‚¹ã‚¿ã‹ã‚‰å–ã‚Šå‡ºã—ãŸå€¤ã‚’åˆ¥ã®å€¤ã¨è¶³ã—ã€ãã®çµæœã‚’å…ƒã®ãƒ¬ã‚¸ã‚¹ã‚¿ã«è¨­å®šã™ã‚‹ã“ã¨ã€‚ è«–ç†æ¼”ç®—å‘½ä»¤ 01-03. ã‚·ãƒ•ãƒˆå‘½ä»¤ è«–ç†å·¦ã‚·ãƒ•ãƒˆ æœ€ä¸Šä½ã«æ­£è² ã‚’è¡¨ã™ã€ç¬¦å·bitã€ã‚’è¨­å®šã›ãšã«ã€ã‚·ãƒ•ãƒˆã‚’è¡Œã†ã€‚ ï¼’é€²æ•°ã®å ´åˆâ€¦ å·¦ã«ï¼‘bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€2å€ã€ å·¦ã«ï¼‘bitã‚·ãƒ•ãƒˆã—ã€å…ƒã®å€¤ã‚’è¶³ã™ã‚’ã€3å€ã€ å·¦ã«ï¼’bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€4å€ã€ å·¦ã«ï¼’bitã‚·ãƒ•ãƒˆã—ã€å…ƒã®å€¤ã‚’è¶³ã™ã¨ã€5å€ã€ å·¦ã«ï¼’bitã‚·ãƒ•ãƒˆã—ã€å…ƒã®å€¤ã‚’è¶³ã—ã¦ã€5å€ã€ã€‚ã•ã‚‰ã«ï¼’bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€10å€ã€ å·¦ã«ï¼“bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€8å€ã€ ãƒ»æ­£ã®æ•°ã®å ´åˆ ï¼Šä¾‹ï¼Š 00011100 ãƒ»è² ã®æ•°ã®å ´åˆ ï¼Šä¾‹ï¼Š 11100100 è«–ç†å³ã‚·ãƒ•ãƒˆ æœ€ä¸Šä½ã«æ­£è² ã‚’è¡¨ã™ã€ç¬¦å·bitã€ã‚’è¨­å®šã›ãšã«ã€ã‚·ãƒ•ãƒˆã‚’è¡Œã†ã€‚ ï¼’é€²æ•°ã®å ´åˆâ€¦ å³ã«ï¼‘bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€1/2ã€ å³ã«ï¼’bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€1/4ã€ å³ã«ï¼“bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€1/8ã€ ãƒ»æ­£ã®æ•°ã®å ´åˆ ï¼Šä¾‹ï¼Š 00011100 ãƒ»è² ã®æ•°ã®å ´åˆï¼ˆè¨ˆç®—ã¯ã§ããªã„ï¼‰ ï¼Šä¾‹ï¼Š 11100100 è² ã®æ•°ã§è«–ç†å³ã‚·ãƒ•ãƒˆã‚’è¡Œã†å ´åˆã€é–“é•ã£ãŸè¨ˆç®—ãŒè¡Œã‚ã‚Œã¦ã—ã¾ã†ã€‚ã“ã†ã„ã†å ´åˆã€ç®—è¡“ã‚·ãƒ•ãƒˆãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ç®—è¡“å·¦ã‚·ãƒ•ãƒˆ æœ€ä¸Šä½ã«æ­£è² ã‚’è¡¨ã™ã€ç¬¦å·bitã€ã‚’è¨­å®šã—ã€ã‚·ãƒ•ãƒˆã‚’è¡Œã†ã€‚ ï¼’é€²æ•°ã®å ´åˆâ€¦ å·¦ã«ï¼‘bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€2å€ã€ å·¦ã«ï¼‘bitã‚·ãƒ•ãƒˆã—ã€å…ƒã®å€¤ã‚’è¶³ã™ã‚’ã€3å€ã€ å·¦ã«ï¼’bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€4å€ã€ å·¦ã«ï¼’bitã‚·ãƒ•ãƒˆã—ã€å…ƒã®å€¤ã‚’è¶³ã™ã¨ã€5å€ã€ å·¦ã«ï¼’bitã‚·ãƒ•ãƒˆã—ã€å…ƒã®å€¤ã‚’è¶³ã—ã¦ã€5å€ã€ã€‚ã•ã‚‰ã«ï¼’bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€10å€ã€ å·¦ã«ï¼“bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€8å€ã€ ãƒ»æ­£ã®æ•°ã®å ´åˆ ï¼Šä¾‹ï¼Š 00011100 ãƒ»è² ã®æ•°ã®å ´åˆ ï¼Šä¾‹ï¼Š 00011100 ç®—è¡“å³ã‚·ãƒ•ãƒˆ ï¼’é€²æ•°ã®å ´åˆâ€¦ æœ€ä¸Šä½ã«æ­£è² ã‚’è¡¨ã™ã€ç¬¦å·bitã€ã‚’è¨­å®šã—ã€ã‚·ãƒ•ãƒˆã‚’è¡Œã†ã€‚ å³ã«ï¼‘bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€1/2ã€ å³ã«ï¼’bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€1/4ã€ å³ã«ï¼“bitã‚·ãƒ•ãƒˆã™ã‚‹ã¨ã€1/8ã€ ãƒ»æ­£ã®æ•°ã®å ´åˆ ï¼Šä¾‹ï¼Š 00011100 ãƒ»è² ã®æ•°ã®å ´åˆ 01-04. æ©Ÿæ¢°èªå‘½ä»¤ã®å®Ÿè¡Œæ‰‹é † å®Ÿè¡Œæ‰‹é † 16é€²æ•°ãŒ2é€²æ•°ã«å¤‰æ›ã•ã‚Œã€è¨˜å·ã¸å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ï¼ˆãƒ“ãƒƒãƒˆåˆ†å‰²ï¼‰ è¨˜å·ã®å€¤ã‚’åŸºã«ã€å®Ÿè¡Œã‚¢ãƒ‰ãƒ¬ã‚¹ã®è¨ˆç®—æ–¹æ³•ãŒé¸æŠã•ã‚Œã€å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ï¼ˆå®Ÿè¡Œã‚¢ãƒ‰ãƒ¬ã‚¹ã®è¨ˆç®—ï¼‰ å®Ÿè¡Œã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åŸºã«ã€æ©Ÿæ¢°èªå‘½ä»¤ãŒå®Ÿè¡Œã•ã‚Œã€å€¤ãŒãƒ¬ã‚¸ã‚¹ã‚¿ã‚„ãƒ¡ãƒ¢ãƒªã«æ›¸ãç•™ã‚ã‚‰ã‚Œã‚‹ã€‚ï¼ˆæ©Ÿæ¢°èªå‘½ä»¤ã®ãƒˆãƒ¬ãƒ¼ã‚¹ï¼‰ ï¼ˆï¼‘ï¼‰ãƒ“ãƒƒãƒˆåˆ†å‰² ï¼Šä¾‹ï¼Š å‘½ä»¤ï¼š20B3h ãƒ»16é€²æ•°ã®2é€²æ•°ã¸ã®å¤‰æ› ãƒ»è¨˜å·ã¸ã®å€¤ã®å‰²ã‚Šå½“ã¦ ï¼ˆï¼’ï¼‰å®ŸåŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã®è¨ˆç®— ãƒ»å®Ÿè¡Œã‚¢ãƒ‰ãƒ¬ã‚¹ã®è¨ˆç®—æ–¹æ³•ã®é¸æŠ ã€Xï¼2ã€ã€ã€I = 1ã€ã‚ˆã‚Šã€è¡¨ã®ç¶²æ›ã‘ã®è¨ˆç®—å¼ã‚’é¸æŠã€‚ ãƒ»å®ŸåŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã®è¨ˆç®—ã®å®Ÿè¡Œ ã“ã“ã«ã€ãƒ¬ã‚¸ã‚¹ã‚¿ç•ªå·ã¨å†…å®¹ã®è¡¨ã‚’å¼µã‚‹ã€‚ (å®ŸåŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹) = [adr + [X] ] = [1000h + [ãƒ¬ã‚¸ã‚¹ã‚¿2] ]ï¼ˆâ€»é…åˆ—ã®ã‚ˆã†ã«ã€ãƒ¬ã‚¸ã‚¹ã‚¿2ã®å€¤ã‚’å‚ç…§ï¼‰ = [1000h + 0002h] = [1002h] = 1003h ï¼ˆï¼“ï¼‰æ©Ÿæ¢°èªå‘½ä»¤ã®ãƒˆãƒ¬ãƒ¼ã‚¹ 01-05. æ§‹æ–‡è§£æã«ãŠã‘ã‚‹æ•°å¼ã®èªè­˜æ–¹æ³• é€†ãƒãƒ¼ãƒ©ãƒ³ãƒ‰è¡¨è¨˜æ³•ï¼ˆå¾Œç½®è¡¨è¨˜æ³•ï¼‰ æ¼”ç®—å­ï¼ˆï¼‹ã€ï¼ã€Ã—ã€Ã·ãªã©ï¼‰ã‚’è¢«æ¼”ç®—å­ï¼ˆæ•°å€¤ã‚„å¤‰æ•°ã€ã¾ãŸè¨ˆç®—ã®çµæœï¼‰ã®å¾Œã‚ã«æ›¸ãã“ã¨ã§æ•°å¼ã‚’è¡¨ç¾ã™ã‚‹æ–¹æ³•ã€‚ã¡ãªã¿ã«ã€äººé–“ãŒä½¿ã£ã¦ã„ã‚‹è¡¨è¨˜æ–¹æ³•ã¯ã€ã€ä¸­ç½®è¨˜æ³•ã€ã¨ã„ã†ã€‚ ï¼Šä¾‹ï¼Š Y = ( A + B ) Ã— ( C ï¼ ( D Ã· E ) ) æ‹¬å¼§ã¯å…ˆã«è¨ˆç®—ã™ã‚‹ã®ã§å¡Šã¨è¦‹ãªã™ã€‚ ( A + B ) â‡’ AB+ æ‹¬å¼§ã¯å…ˆã«è¨ˆç®—ã™ã‚‹ã®ã§å¡Šã¨è¦‹ãªã™ã€‚ ( D Ã· E ) â‡’ DE Ã· æ‹¬å¼§ã¯å…ˆã«è¨ˆç®—ã™ã‚‹ã®ã§å¡Šã¨è¦‹ãªã™ã€‚ ( AB + ) Ã— ( C ï¼ DE Ã· ) â‡’ ( AB + ) ( CDE Ã· ï¼) Ã— æ‹¬å¼§ã‚’å¤–ã—ã¦ã‚‚ã€å¡Šã¯ãã®ã¾ã¾ã€‚ ã€€ã€€( AB + ) ( CDE Ã· ï¼) Ã— â‡’ AB+CDEÃ·ï¼Ã— å·¦è¾ºã¨å³è¾ºã‚’ãã‚Œãã‚Œå¡Šã¨è¦‹ãªã™ã€‚ ã€€ã€€Y = AB+CDEÃ·ï¼Ã— â‡’ YAB+CDEÃ·ï¼Ã—= 01-06. CPUã«ãŠã‘ã‚‹å°æ•°ã®å‡¦ç†æ–¹æ³• å›ºå®šå°æ•°ç‚¹æ•° ã€ã“ã®ä½ç½®ã«å°æ•°ç‚¹ãŒã‚ã‚‹ã€ãªå‰æã§æ•°å­—ã‚’æ‰±ã†ã“ã¨ã«ã‚ˆã£ã¦ã€å°æ•°ç‚¹ã‚’å«ã‚€æ•°å€¤ã‚’è¡¨ç¾ã™ã‚‹æ–¹æ³•ã€‚ CPUã¯ã€æ•°å€¤ã«å¯¾ã—ã€ç‰¹å®šã®ä½ç½®ã«å°æ•°ç‚¹ã‚’æ‰“ã¤ã€‚ æµ®å‹•å°æ•°ç‚¹æ•° æŒ‡æ•°è¡¨è¨˜ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å°æ•°ç‚¹ã‚’å«ã‚€æ•°å€¤ã‚’è¡¨ç¾ã™ã‚‹æ–¹æ³•ã€‚ ãƒ»æ­£è¦åŒ–ã—ãŸæ•°å¼ã‹ã‚‰æµ®å‹•å°æ•°ç‚¹æ•°ã¸ã®å¤‰æ› ãƒ»æµ®å‹•å°æ•°ç‚¹æ•°ã‹ã‚‰æ­£è¦åŒ–ã—ãŸæ•°å¼ã¸ã®å¤‰æ› æŒ‡æ•°éƒ¨ã¨ä»®æ•°éƒ¨ã‚’èª¿ç¯€ã—ã¦ã€ã§ãã‚‹ã ã‘ä»®æ•°éƒ¨ã®ä¸Šä½æ¡ã«0ãŒå…¥ã‚‰ãªã„ã‚ˆã†ã«ã—ã¦ã€èª¤å·®ã‚’å°‘ãªãã™ã‚‹ã“ã¨ã€‚ä¾‹ãˆã°ã€ã‚ã‚‹è¨ˆç®—ã®çµæœãŒ0.012345Ã—10^ï¼3ã ã£ãŸå ´åˆã€ä»®æ•°éƒ¨ã‚’0.1ï½1ã®ç¯„å›²ã«åã‚ã‚‹ãŸã‚ã«0.12345Ã—10^ï¼4ã«å¤‰æ›´ã™ã‚‹ã€‚ 01-07. èª¤å·® ã€èª¤å·®ã€ï¼šå®Ÿéš›ã®æ•°å€¤ã¨CPUãŒè¡¨ç¾ã§ãã‚‹æ•°å€¤ã®é–“ã«ç”Ÿã˜ã‚‹ã‚ºãƒ¬ã®ã“ã¨ã€‚ ç„¡é™å°æ•° æ¡æº¢ã‚Œèª¤å·® ï¼Šä¾‹ï¼Š åˆä»£ãƒ‰ãƒ©ã‚¯ã‚¨ åˆä»£ã®ãƒ‰ãƒ©ã‚´ãƒ³ã‚¯ã‚¨ã‚¹ãƒˆã®çµŒé¨“å€¤ã®ä¸Šé™ã¯ã€65535ã€ã ã£ãŸã€‚ã“ã‚Œã¯ã€çµŒé¨“å€¤ãŒ16bitï¼ˆ2 Byteï¼‰ã§è¡¨ã•ã‚Œã¦ãŠã‚Šã€æ¡æº¢ã‚ŒãŒèµ·ãã‚‹ã“ã¨ã‚’é˜²ããŸã‚ã«65535ä»¥ä¸Šã¯è¨ˆç®—ã—ãªã„ã‚ˆã†ã«ãªã£ã¦ã„ãŸã€‚ æƒ…å ±è½ã¡ æ‰“åˆ‡ã‚Šèª¤å·® å††å‘¨ç‡ã¯ã€é€”ä¸­ã§è¨ˆç®—ã‚’æ‰“ã¡åˆ‡ã‚‹ã€‚ æ¡è½ã¡ ä¸¸ã‚èª¤å·® 02. N é€²æ•° â” 10é€²æ•°ï¼ˆé‡ã¿æ›ã‘ã‚’è¡Œã†ï¼‰ 16é€²æ•° â” 10é€²æ•° ãƒ»æ•´æ•° ï¼Šä¾‹ï¼Šã€CA125ã€ ã€(16^0 Ã— 5) + (16^1 Ã— 2) + (16^2 Ã— 1) + (16^3 Ã— A) + (16^4 Ã— C) ã€ã¨ã„ã†ã‚ˆã†ã«ã€ä¸‹ã®ä½ã‹ã‚‰ã€é †ã«16^Nã‚’ã‹ã‘ã¦ã„ãã€‚ï¼ˆAã¨Cã¯ã€10é€²æ•°ã«å¤‰æ›ã—ã¦ã€10ã€ã¨ã€12ã€ï¼‰ (1Ã—5) + (16Ã—2) + (256Ã—1) + (4096Ã—10) + (65536Ã—12) ï¼ 827685 ãƒ»å°‘æ•° 2é€²æ•° â” 10é€²æ•° ãƒ»æ•´æ•° ã€1101101ã€ ã€(2^0 Ã— 1) + (2^1 Ã— 0) + (2^2 Ã— 1) + (2^3 Ã— 1) + (2^4 Ã— 0) + (2^5 Ã— 1) + (2^6 Ã— 1)ã€ã¨ã„ã†ã‚ˆã†ã«ã€ä¸‹ã®ä½ã‹ã‚‰ã€é †ã«2^Nã‚’ã‹ã‘ã¦ã„ãã€‚ ãƒ»å°‘æ•° 02-02. 10é€²æ•° â” N é€²æ•°ï¼ˆNã§å‰²ã‚Šç¶šã‘ã‚‹ï¼‰ 10é€²æ•° â” 16é€²æ•° ãƒ»æ•´æ•° ï¼Šä¾‹ï¼Šã€27ã€ 27ã‚’16ã§å‰²ã‚Šç¶šã‘ã‚‹ã€‚ 16é€²æ•°ã§10ï½15ã¯ã€Aï½Fã§è¡¨è¨˜ã•ã‚Œã‚‹ãŸã‚ã€11ã‚’Bã§è¡¨è¨˜ã€‚ ä½™ã‚Šã‚’ä¸¦ã¹ã€ç­”ãˆã¯ã€1Bã€ ãƒ»å°‘æ•° ï¼Šä¾‹ï¼Šã€0.1015625ã€ 1.ã€0.1015625ã€ã«16ã‚’ã‹ã‘ã€æ•´æ•°éƒ¨åˆ†ã‚’å–ã‚Šå‡ºã™ã€‚ï¼ˆ0.1015625 Ã— 16 = 1.625ã€‚ã€1ã€ã‚’å–ã‚Šå‡ºã—ã€16é€²æ•°ã«å¤‰æ›ã—ã¦ã€1ã€ï¼‰ 2ã€‚è¨ˆç®—çµæœã®å°‘æ•°éƒ¨åˆ†ã«16ã‚’ã•ã‚‰ã«ã‹ã‘ã‚‹ã€‚å°‘æ•°éƒ¨åˆ†ãŒ0ã«ãªã‚‹ã¾ã§ã€ã“ã‚Œã‚’ç¹°ã‚Šè¿”ã™ã€‚ï¼ˆ0.625 Ã— 16 = 10.0ã‚ˆã‚Šã€ã€10ã€ã‚’å–ã‚Šå‡ºã—ã€16é€²æ•°ã«å¤‰æ›ã—ã¦ã€Aã€ï¼‰ 3ã€‚å°‘æ•°éƒ¨åˆ†ãŒ0ã«ãªã£ãŸã®ã§ã€å–ã‚Šå‡ºã—ãŸæ•°ã‚’é †ã«ä¸¦ã¹ã€ç­”ãˆã¯ã€0.1Aã€ 10é€²æ•° â” 2é€²æ•° ãƒ»æ•´æ•° ï¼Šä¾‹ï¼Šã€109ã€ ãƒ»å°‘æ•° 02-03. X é€²æ•° â” 10é€²æ•° â” Y é€²æ•° ä¸€åº¦ã€10é€²æ•°ã«å¤‰æ›ã—ã¦ã‹ã‚‰ã€ä»»æ„ã®é€²æ•°ã«å¤‰æ›ã™ã‚‹ã€‚ 16é€²æ•° â” 2é€²æ•° ãƒ»æ•´æ•° ï¼Šä¾‹ï¼Šã€20B3ã€ 2ã€0ã€Bã€3ã‚’10é€²æ•°ã«å¤‰æ›ã—ã¦ã€ã€(16^0 Ã— 3) + (16^1 Ã— 11) + (16^2 Ã— 0) + (16^3 Ã— 2) = 8371ã€ 10ã¨15ã‚’2é€²æ•°ã«å¤‰æ›ã—ã¦ã€ã€0010ã€ã€ã€0000ã€ã€ã€1011ã€ã€ã€0011ã€ ã‚ˆã£ã¦ã€AFã¯10é€²æ³•ã«å¤‰æ›ã—ã¦ã€0010000010110011ã€ 02-04. X é€²æ•° â” 10 é€²æ•° â” Y é€²æ•° â” 10 é€²æ•° 16é€²æ•° â” 2é€²æ•° ãƒ»å°‘æ•° ï¼Šä¾‹ï¼Š 2A.4C æ•´æ•°éƒ¨åˆ†ã®2Aã‚’10é€²æ•°ã«å¤‰æ›ã—ã¦ã€ 42ã‚’2é€²æ•°ã«å¤‰æ›ã—ã¦ã€ã€101010ã€ã€‚ã¾ãŸã€ä½™ã‚Šè¨ˆç®—ã®æ™‚ã€ä½™ã‚Šï¼‘ã‚’2^Nã«ç›´ã—ã¦ãŠãã€‚ æ•´æ•°ã®å ´åˆã€ä¸‹ä½ã®æ¡ã‹ã‚‰ã€ã€(2^0 Ã— 0) + (2^1 Ã— 1) + (2^2 Ã— 0) + (2^3 Ã— 1) + (2^4 Ã— 0) + (2^5 Ã— 1) + (2^6 Ã— 0) + (2^7 Ã— 0) + (2^8 Ã— 0) ã€ =ã€2^5ï¼‹2^3ï¼‹2^1ã€ ï¼ˆâ€»16é€²æ•°ã‹ã‚‰ã®å¤‰æ›ã®å ´åˆã€101010ã¯ã€00101010ã¨ã—ã¦æ‰±ã†ã“ã¨ã«æ³¨æ„ï¼‰ 76ã‚’2é€²æ•°ã«å¤‰æ›ã—ã¦ã€ã€1001100ã€ã€‚ã¾ãŸã€ä½™ã‚Šè¨ˆç®—ã®æ™‚ã€ä½™ã‚Šï¼‘ã‚’2^Nã«ç›´ã—ã¦ãŠãã€‚ å°‘æ•°éƒ¨åˆ†ã®å ´åˆã€ä¸Šä½ã®æ¡ã‹ã‚‰ã€ã€(2^ï¼1 Ã— 0) + (2^ï¼2 Ã— 1) + (2^ï¼3 Ã— 0) + (2^ï¼4 Ã— 0) + (2^ï¼5 Ã— 1) + (2^ï¼6 Ã— 1) + (2^ï¼7 Ã— 0) + (2^ï¼8 Ã— 0) ã€ =ã€ 2^ï¼2ï¼‹2^ï¼5ï¼‹2^ï¼6 ã€ ï¼ˆâ€»16é€²æ•°ã‹ã‚‰ã®å¤‰æ›ã®å ´åˆã€1001100ã¯ã€01001100ã¨ã—ã¦æ‰±ã†ã“ã¨ã«æ³¨æ„ï¼‰ ã—ãŸãŒã£ã¦ã€ã€2^5ï¼‹2^3ï¼‹2^1ï¼‹2^ï¼2ï¼‹2^ï¼5ï¼‹2^ï¼6ã€ 03. è«–ç†å›è·¯ è«–ç†å¼ ä»¥ä¸‹ã®ãƒ™ãƒ³å›³ã§ã¯ã€é›†åˆAã¨é›†åˆBã¯å…¥åŠ›ãŒã€1ã€ã®å ´åˆã€å¤–å´ã¯å…¥åŠ›ãŒã€0ã€ã®å ´åˆã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚æ¼”ç®—æ–¹æ³•ã‚’æ€ã„å‡ºã™ã¨ãã«ã¯ã€ãƒ™ãƒ³å›³ã‚’æ€ã„å‡ºã›ã€‚ å¦å®šå›è·¯ï¼ˆNOTå›è·¯ï¼‰ã€NOTæ¼”ç®—ã€ãƒ™ãƒ³å›³ ä¸¸ã„è¨˜å·ãŒå¦å®šã‚’è¡¨ã™ã€‚ è«–ç†ç©å›è·¯ï¼ˆANDå›è·¯ï¼‰ã€ANDæ¼”ç®—ã€ãƒ™ãƒ³å›³ ï¼’ã¤ã®bitã‚’æ¯”è¼ƒã—ã¦ã€ã©ã¡ã‚‰ã‚‚ã€1ã€ãªã‚‰ã€1ã€ã‚’å‡ºåŠ›ã€‚ å¦å®šè«–ç†ç©å›è·¯ï¼ˆNANDå›è·¯ï¼‰ã€NANDæ¼”ç®—ã€ãƒ™ãƒ³å›³ ï¼’ã¤ã®bitã‚’æ¯”è¼ƒã—ã¦ã€ã©ã¡ã‚‰ã‚‚ã€1ã€ãªã‚‰ã€0ã€ã‚’å‡ºåŠ›ã€‚ãƒ™ãƒ³å›³ã§ã¯ä¸¡æ–¹ãŒã€1ã€ä»¥å¤–ã®å ´åˆã‚’æŒ‡ã—ã¦ã„ã‚‹ãŒã€å›è·¯ã®å‡ºåŠ›ã‚’ã†ã¾ãèª¬æ˜ã§ããªã„â€¦ã€‚ è«–ç†å’Œå›è·¯ï¼ˆORå›è·¯ï¼‰ã€ORæ¼”ç®—ã€ãƒ™ãƒ³å›³ ï¼’ã¤ã®bitã‚’æ¯”è¼ƒã—ã¦ã€ã©ã¡ã‚‰ã‹ãŒã€1ã€ãªã‚‰ã€1ã€ã‚’å‡ºåŠ›ã€‚ æ’ä»–çš„è«–ç†å’Œå›è·¯ï¼ˆEORå›è·¯ï¼XORå›è·¯ï¼‰ã€EORæ¼”ç®—ã€ãƒ™ãƒ³å›³ ï¼’ã¤ã®bitã‚’æ¯”è¼ƒã—ã¦ã€ã©ã¡ã‚‰ã‹ã ã‘ãŒã€1ã€ãªã‚‰ã€1ã€ã‚’å‡ºåŠ›ã€‚ å¦å®šè«–ç†å’Œå›è·¯ï¼ˆNORå›è·¯ï¼‰ã€NORæ¼”ç®—ã€ãƒ™ãƒ³å›³ ï¼’ã¤ã®bitã‚’æ¯”è¼ƒã—ã¦ã€ã©ã¡ã‚‰ã‚‚ã€0ã€ãªã‚‰ã€1ã€ã‚’å‡ºåŠ›ã€‚ ãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—å›è·¯ ã‚ã‹ã‚Šã‚„ã™ã„å‹•ç”»è§£èª¬ï¼šhttps://www.youtube.com/watch?v=4vAGaWyGanU SRAMã®é›»å­å›è·¯ã«ç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ï¼ˆ6ç« ã‚’å‚ç…§ï¼‰ã€‚Setå´ã«åˆæœŸå€¤ã€1ã€ãŒå…¥åŠ›ã•ã‚Œã‚‹ã€‚å…¥åŠ›ã‚’ã€0ã€ã«å¤‰ãˆã¦ã‚‚ã€ä¸¡æ–¹ã®å‡ºåŠ›çµæœã¯å¤‰ã‚ã‚‰ãšã€å®‰å®šã—ã¦ã„ã‚‹ã€‚ Resetå´ã«ã€1ã€ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ä¸¡æ–¹ã®å‡ºåŠ›çµæœã¯å¤‰åŒ–ã™ã‚‹ã€‚ 03-02. è«–ç†æ¼”ç®—å‘½ä»¤ è«–ç†ç© ï¼Šä¾‹é¡Œï¼Š 16é€²æ•°ã®ã€Fã€ã¯ã€2é€²æ•°ã§ã€0000 0000 0000 1111ã€ã§è¡¨ã•ã‚Œã‚‹ã€‚ã‚ˆã£ã¦ã€000Fã‚’ç”¨ã„ã¦ANDæ¼”ç®—ã—ãŸå ´åˆã€ä¸‹ä½4æ¡ã‚’å¤‰åŒ–ã•ã›ãšã«å–ã‚Šå‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚ 1100 1101 1111 1000 0000 0000 0000 1111 ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ 0000 0000 0000 1000 å¼•ç”¨ï¼šhttps://ameblo.jp/kou05/entry-10883110086.html ï¼Šä¾‹é¡Œï¼Š 16é€²æ•°ã®ã€7Fã€ã¯ã€2é€²æ•°ã§ã€0000 0000 0111 1111ã€ã§è¡¨ã•ã‚Œã‚‹ã€‚ã‚ˆã£ã¦ã€7Fã‚’ç”¨ã„ã¦ANDæ¼”ç®—ã—ãŸå ´åˆã€ä¸‹ä½7æ¡ã‚’å¤‰åŒ–ã•ã›ãšã«å–ã‚Šå‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚ 1100 1101 1111 1000 0000 0000 0111 1111 ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ 0000 0000 0111 1000 ï¼Šä¾‹é¡Œï¼Š å¦å®šè«–ç†ç© è«–ç†å’Œ æ’ä»–çš„è«–ç†å’Œ å¦å®šè«–ç†å’Œ ï¼Šä¾‹é¡Œï¼Š Xã¨Yã®å¦å®šè«–ç†ç© X NAND Yã¯ã€NOT(X AND Y)ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹ã€‚X OR Yã‚’NANDã ã‘ã‚’ä½¿ã£ã¦è¡¨ã—ãŸè«–ç†å¼ã¯ã©ã‚Œã‹ã€‚ â‡’Xï¼0ã€Yï¼0ã®ã¨ãã«X OR YãŒã€0ã€ã«ãªã‚‹ã“ã¨ã‹ã‚‰ã€ã€0ã€ã«ãªã‚‹é¸æŠè‚¢ã‚’æ¢ã™ã€‚ ãƒ»((X NAND Y) NAND X) NAND Y ((0 NAND 0)NAND 0)NAND 0 ï¼(1 NAND 0) NAND 0 ï¼1 NAND 0 ï¼1 ãƒ»(X NAND X) NAND (Y NAND Y) (0 NAND 0)NAND(0 NAND 0) ï¼1 NAND 1 ï¼0 ãƒ»(X NAND Y) NAND (X NAND Y) (0 NAND 0)NAND(0 NAND 0) ï¼1 NAND 1 ï¼0 ãƒ»X NAND (Y NAND (X NAND Y)) 0 NAND(0 NAND(0 NAND 0)) ï¼0 NAND (0 NAND 1) ï¼0 NAND 1 ï¼1 "},"public/software/software_middleware_web_nginx.html":{"url":"public/software/software_middleware_web_nginx.html","title":"ğŸ“– ï¸Nginx","keywords":"","body":"Nginx ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Tips ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ ãƒ»nginx å‚è€ƒï¼šhttps://httpd.apache.org/docs/trunk/ja/programs/apachectl.html ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰ ãƒ»èµ·å‹•ï¼åœæ­¢ $ sudo systemctl start nginx $ sudo systemctl stop nginx ãƒ»è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ $ sudo service nginx configtest # ã‚‚ã—ãã¯ã“ã¡ã‚‰ $ sudo nginx -t ãƒ»è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®åæ˜ ã¨å®‰å…¨ãªå†èµ·å‹• $ sudo systemctl reload nginx ãƒ»èª­ã¿è¾¼ã¾ã‚ŒãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨è¨­å®šå€¤ã®ä¸€è¦§ èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹å…¨ã¦ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆincludeãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®å¯¾è±¡ã‚‚å«ã‚€ï¼‰ã®å†…å®¹ã‚’å±•é–‹ã—ã¦è¡¨ç¤ºã™ã‚‹ã€‚ $ sudo nginx -T 02. æ©Ÿèƒ½ã®ç¨®é¡ Webã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã—ã¦ ãƒ»PHP-FPMã¨ã®çµ„ã¿åˆã‚ã› é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã¦ããŸå ´åˆã€Nginxã¯ãã®ã¾ã¾ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚å‹•çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã¦ããŸå ´åˆã€Nginxã¯ã€FastCGIãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä»‹ã—ã¦ã€PHP-FPMã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã€‚ # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ $ php-fpm -t ï¼Šå®Ÿè£…ä¾‹ï¼Š #------------------------------------- # HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ #------------------------------------- server { listen 80; server_name example.com; root /var/www/example/public; index index.php index.html; include /etc/nginx/default/xxx.conf; #ã€/ã€ã§å§‹ã¾ã‚‹å…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆ location / { try_files $uri $uri/ /index.php?$query_string; } #-------------------------------------------------- # FastCGIã‚’ç”¨ã„ãŸAppã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã¸ã®è»¢é€ã€å—ä¿¡ # OSã«ã‚ˆã£ã¦ã€fastcgi_paramsãƒ•ã‚¡ã‚¤ãƒ«ã®å¿…è¦ãªè¨­å®šãŒç•°ãªã‚‹ #-------------------------------------------------- location ~ \\.php$ { # ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã®TCPã‚½ã‚±ãƒƒãƒˆ fastcgi_pass 127.0.0.1:9000; # ã‚‚ã—ãã¯ã€Unixã‚½ã‚±ãƒƒãƒˆ # fastcgi_pass unix:/run/php-fpm/www.sock; # ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã®URLï¼ˆrootãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–å€¤+ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’èª­ã¿è¾¼ã‚€ include fastcgi_params; } } ãƒ»/etc/nginx/fastcgi_paramsãƒ•ã‚¡ã‚¤ãƒ« ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ç”¨ã§ãã‚‹å¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚nginx.confãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã£ã¦èª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚OSã‚„ãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã¯ã€å¤‰æ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒæ›¸ãæ›ãˆã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚å®Ÿéš›ã«ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠå†…ã«æ¥ç¶šã—ã€ä¸Šæ›¸ãè¨­å®šãŒå¿…è¦ãªã‚‚ã®ã¨ä¸è¦ãªã‚‚ã®ã‚’åˆ¤æ–­ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ä»¥ä¸‹ã¯ã€Debian 10ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://mogile.web.fc2.com/nginx_wiki/start/topics/examples/phpfcgi/ ï¼Šå®Ÿè£…ä¾‹ï¼Š #------------------------------------------------------- # OSã«ã‚ˆã£ã¦ã€fastcgi_paramsãƒ•ã‚¡ã‚¤ãƒ«ã®å¿…è¦ãªè¨­å®šãŒç•°ãªã‚‹ #------------------------------------------------------- fastcgi_param QUERY_STRING $query_string; fastcgi_param REQUEST_METHOD $request_method; fastcgi_param CONTENT_TYPE $content_type; fastcgi_param CONTENT_LENGTH $content_length; fastcgi_param SCRIPT_NAME $fastcgi_script_name; fastcgi_param REQUEST_URI $request_uri; fastcgi_param DOCUMENT_URI $document_uri; fastcgi_param DOCUMENT_ROOT $document_root; fastcgi_param SERVER_PROTOCOL $server_protocol; fastcgi_param REQUEST_SCHEME $scheme; fastcgi_param HTTPS $https if_not_empty; fastcgi_param GATEWAY_INTERFACE CGI/1.1; fastcgi_param SERVER_SOFTWARE nginx/$nginx_version; fastcgi_param REMOTE_ADDR $remote_addr; fastcgi_param REMOTE_PORT $remote_port; fastcgi_param SERVER_ADDR $server_addr; fastcgi_param SERVER_PORT $server_port; fastcgi_param SERVER_NAME $server_name; # PHPã ã‘ã§å¿…è¦ãªè¨­å®š fastcgi_param REDIRECT_STATUS 200; ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã—ã¦ HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§å—ä¿¡ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€HTTPSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«å¤‰æ›ã—ã¦è»¢é€ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š #------------------------------------- # HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ #------------------------------------- server { server_name example.com; listen 80; return 301 https://$host$request_uri; } #------------------------------------- # HTTPSãƒªã‚¯ã‚¨ã‚¹ãƒˆ #------------------------------------- server { server_name example.com; listen 443 ssl http2; index index.php index.html; #------------------------------------- # SSL #------------------------------------- ssl on; ssl_certificate /etc/nginx/ssl/server.crt; ssl_certificate_key /etc/nginx/ssl/server.key; add_header Strict-Transport-Security \"max-age=86400\"; location / { proxy_pass http://app1; proxy_set_header Host $host; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Port $remote_port; } } ãƒªãƒãƒ¼ã‚¹Proxyã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã—ã¦ å‰æã¨ã—ã¦ã€ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ã‹ã‚‰è»¢é€ã•ã‚ŒãŸHTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ãƒªãƒãƒ¼ã‚¹Proxyï¼ˆNginxï¼‰ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚Webã‚µãƒ¼ãƒã¯ã€å¿…ãšãƒªãƒãƒ¼ã‚¹Proxyã‚’çµŒç”±ã—ã¦ã€å‹•çš„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š #------------------------------------- # HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ #------------------------------------- server { server_name example.com; listen 80; return 301 https://$host$request_uri; #------------------------------------- # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚Œã°Nginxã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #------------------------------------- location ~ ^/(images|javascript|js|css|flash|media|static)/ { root /var/www/example/static; expires 30d; } #------------------------------------- # å‹•çš„ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚Œã°Webã‚µãƒ¼ãƒã«è»¢é€ #------------------------------------- location / { proxy_pass http://127.0.0.1:8080; } } 03-01. Coreæ©Ÿèƒ½ ãƒ–ãƒ­ãƒƒã‚¯ ãƒ»events å‚è€ƒï¼šhttps://nginx.org/en/docs/ngx_core_module.html#events ï¼Šå®Ÿè£…ä¾‹ï¼Š events { worker_connections 1024; } ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ãƒ»user æœ¬è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ã¨ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ã‚°ãƒ«ãƒ¼ãƒ—åã‚’å…¥åŠ›ã—ãªã‹ã£ãŸå ´åˆã€ãƒ¦ãƒ¼ã‚¶åã¨åŒã˜ã‚‚ã®ãŒè‡ªå‹•çš„ã«è¨­å®šã•ã‚Œã‚‹ã€‚ user www www; ãƒ»error_log error_log logs/error.log; ãƒ»include å…±é€šåŒ–ã•ã‚ŒãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã€‚ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã«ã‚ˆã‚‹ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚ include /etc/nginx/conf.d/*.conf; ãƒ»pid pid logs/nginx.pid; ãƒ»worker_connections workerãƒ—ãƒ­ã‚»ã‚¹ãŒåŒæ™‚ã«å‡¦ç†å¯èƒ½ãªã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã®æœ€å¤§æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/ngx_core_module.html#worker_connections worker_connections 1024; ãƒ»worker_processes worker_processes 5; ãƒ»worker_rlimit_nofile worker_rlimit_nofile 8192; è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ ãƒ»/etc/nginx/conf.d/*.confãƒ•ã‚¡ã‚¤ãƒ« ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã„ãã¤ã‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã€‚åŸºæœ¬çš„ã«ã¯èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã™ã‚‹ã€‚ãŸã ã—ã€nginx.confãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šãŒä¸Šæ›¸ãã•ã‚Œã¦ã—ã¾ã‚ãªã„ã‹ã‚’æ³¨æ„ã™ã‚‹ã€‚ include /etc/nginx/conf.d/*.conf; ãƒ»/etc/nginx/mime.typesãƒ•ã‚¡ã‚¤ãƒ« ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®Content-Typeã®MIMEã‚¿ã‚¤ãƒ—ã¨ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ã®é–“ã®å¯¾å¿œé–¢ä¿‚ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ include /etc/nginx/mime.types; ãƒ»/usr/share/nginx/modules/*.confãƒ•ã‚¡ã‚¤ãƒ« ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®èª­ã¿è¾¼ã¿å‡¦ç†ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ include /usr/share/nginx/modules/*.conf; ä¾‹ãˆã°ã€mod-http-image-filter.confãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚ load_module \"/usr/lib64/nginx/modules/ngx_http_image_filter_module.so\"; 03-02. http_core_module ãƒ–ãƒ­ãƒƒã‚¯ ãƒ»http å…¨ã¦ã®Webã‚µãƒ¼ãƒã«å…±é€šã™ã‚‹å‡¦ç†ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#http http { # Nginxã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤ºã™ã‚‹ã‹ã©ã†ã‹ server_tokens off; # MIMEã‚¿ã‚¤ãƒ—ã‚’è¨­å®š include /etc/nginx/mime.types; default_type application/octet-stream; # ãƒ­ã‚°ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ log_format main \"$remote_addr - $remote_user [$time_local] \"$request\" \" \"$status $body_bytes_sent \"$http_referer\" \" \"\"$http_user_agent\" \"$http_x_forwarded_for\"\"; access_log /var/log/nginx/access.log main; # sendfileã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç”¨ã„ã‚‹ã‹ã©ã†ã‹ sendfile on; # ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¾ã¨ã‚ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã‹ã©ã†ã‹ tcp_nopush on; # keepaliveã‚’ç¶­æŒã™ã‚‹æ™‚é–“ keepalive_timeout 65; default_type application/octet-stream; include /etc/nginx/mime.types; include /etc/nginx/conf.d/*.conf; server { # ï½ ä¸­ç•¥ ï½ } } ãƒ»location å€‹åˆ¥ã®Webã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã«ãŠã‘ã‚‹ç‰¹å®šã®URLã®å‡¦ç†ã‚’è¨­å®šã™ã‚‹ã€‚ https://nginx.org/en/docs/http/ngx_http_core_module.html#location ï¼Šå®Ÿè£…ä¾‹ï¼Š å„è¨­å®šã®å„ªå…ˆé †ä½ã«æ²¿ã£ãŸä»¥ä¸‹ã®é †ç•ªã§å®Ÿè£…ã—ãŸæ–¹ãŒè‰¯ã„ã€‚ # 1. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã‚’æŒ‡å®šã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆ location = / { } # 2. ã€/images/ã€ã§å§‹ã¾ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆ location ^~ /images/ { } # 3ã¨4. æœ«å°¾ãŒã€ã€gifã€jpgã€jpegã®å½¢å¼ã€ ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆ # ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§ãƒ‰ãƒƒãƒˆã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ã€ä»»æ„ã®æ–‡å­—ã§ã¯ãªãã€ãƒ‰ãƒƒãƒˆæ–‡å­—ã€ã¨ã—ã¦èªè­˜ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ location ~* \\.(gif|jpg|jpeg)$ { } # 5-1. ã€/docs/ã€ã§å§‹ã¾ã‚‹å…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆ location /docs/ { } # 5-2. ã€/ã€ã§å§‹ã¾ã‚‹å…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆ location / { } ãƒ«ãƒ¼ãƒˆã®ä¸€è‡´æ¡ä»¶ã¯ã€ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚ å„ªå…ˆé †ä½ prefix ãƒ«ãƒ¼ãƒˆã®ä¸€è‡´æ¡ä»¶ ãƒ«ãƒ¼ãƒˆä¾‹ 1 = æŒ‡å®šã—ãŸãƒ«ãƒ¼ãƒˆã«ä¸€è‡´ã™ã‚‹å ´åˆã€‚ http://example.com/ 2 ^~ æŒ‡å®šã—ãŸãƒ«ãƒ¼ãƒˆã§å§‹ã¾ã‚‹å ´åˆã€‚ http://example.com/images/foo.gif 3 ~ æ­£è¦è¡¨ç¾ï¼ˆå¤§æ–‡å­—ãƒ»å°æ–‡å­—ã‚’åŒºåˆ¥ã™ã‚‹ï¼‰ã€‚ http://example.com/images/FOO.jpg 4 ~* æ­£è¦è¡¨ç¾ï¼ˆå¤§æ–‡å­—ãƒ»å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„ï¼‰ã€‚ http://example.com/images/foo.jpg 5 ãªã— æŒ‡å®šã—ãŸãƒ«ãƒ¼ãƒˆã§å§‹ã¾ã‚‹å ´åˆã€‚ ãƒ»http://example.com/foo.htmlãƒ»http://example.com/docs/foo.html ãƒ»server å€‹åˆ¥ã®Webã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®å‡¦ç†ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#server ï¼Šå®Ÿè£…ä¾‹ï¼Š server { # 80ç•ªãƒãƒ¼ãƒˆã§å—ä¿¡ listen 80; # ãƒ›ã‚¹ãƒˆå server_name example.com; root /var/www/example; index index.php index.html; location / { try_files $uri $uri/ /index.php?$query_string; } location ~ \\.php$ { fastcgi_pass unix:/run/php-fpm/www.sock; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } } ãƒ»ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¨ãƒªãƒ©ã‚¤ãƒˆã®é•ã„ ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ãƒ»default_type Content-Typeãƒ˜ãƒƒãƒ€ãƒ¼ã®å€¤ãŒmime.typesãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã„MIME typeã§ã‚ã£ãŸå ´åˆã«é©ç”¨ã™ã‚‹MIME typeã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#default_type ï¼Šå®Ÿè£…ä¾‹ï¼Š # application/octet-streamï¼šä»»æ„ã®MIME typeï¼ˆæŒ‡å®šãªã—ï¼‰ã¨è¦‹ãªã—ã¦é€ä¿¡ default_type application/octet-stream ãƒ»listen HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’80ç•ªãƒãƒ¼ãƒˆã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#listen ï¼Šå®Ÿè£…ä¾‹ï¼Š listen 80; HTTPSãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’443ç•ªãƒãƒ¼ãƒˆã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š listen 443 ssl; ãƒ»sendfile ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«ã€ãƒ•ã‚¡ã‚¤ãƒ«é€ä¿¡ã®ãŸã‚ã«Linuxã®sendfileã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç”¨ã„ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ãƒ•ã‚¡ã‚¤ãƒ«è¿”ä¿¡å‡¦ç†ã‚’OSå†…ã§è¡Œã†ãŸã‚ã€å‡¦ç†ãŒé€Ÿããªã‚‹ã€‚ä½¿ç”¨ã—ãªã„å ´åˆã€NginxãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«è‡ªèº«ã§ãƒ•ã‚¡ã‚¤ãƒ«è¿”ä¿¡å‡¦ç†ã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#sendfile ï¼Šå®Ÿè£…ä¾‹ï¼Š sendfile on; ãƒ»server_name ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ç´ä»˜ããƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#server_name server_name example.com; ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç›´æ¥è¨˜è¿°ã—ã¦ã‚‚ã‚ˆã„ã€‚ server_name 192.168.0.0; ãƒ»ssl Nginxã§HTTPSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å—ä¿¡ã™ã‚‹å ´åˆã€sslãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#ssl ï¼Šå®Ÿè£…ä¾‹ï¼Š ssl on; ãƒ»ssl_certificate PEMè¨¼æ˜æ›¸ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ssl_certificate /etc/nginx/ssl/server.crt; ãƒ»ssl_certificate_key PEMç§˜å¯†éµã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ssl_certificate_key /etc/nginx/ssl/server.key; ãƒ»tcp_nopush ä¸Šè¿°ã®Linuxã®sendfileã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç”¨ã„ã‚‹å ´åˆã€é©ç”¨ã§ãã‚‹ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ä¸€ã¤ã®ãƒ‘ã‚±ãƒƒãƒˆã«ã¾ã¨ã‚ã¦è¿”ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š tcp_nopush on; ãƒ»try_files æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é †ã«æ¢ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚ã¾ãŸã€æœ€å¾Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å†…éƒ¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã€‚æœ€å¾Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã¯ã€ç•°ãªã‚‹ãƒ‘ã‚¹ã¾ãŸã¯ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã§ãã‚‹ã€‚ã‚‚ã—ã€nginxã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ¥ã€…ã®ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã§ç¨¼åƒã•ã›ã¦ã„ã‚‹å ´åˆã€try_filesãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ãŒãƒ•ã‚¡ã‚¤ãƒ«æ¢ç´¢ã®å¯¾è±¡ã¨ã™ã‚‹å ´æ‰€ã¯ã€ã‚ãã¾ã§nginxã®ç¨¼åƒã™ã‚‹ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠå†…ã«ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚å†…éƒ¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã«ã‚ˆã£ã¦ã€nginxå†…ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå†å‡¦ç†ã•ã‚Œã‚‹ã€‚ç•°ãªã‚‹ãƒ‘ã‚¹ã«å†…éƒ¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¦ã„ãŸå ´åˆã¯ã€ãƒ‘ã‚¹ã«åˆã£ãŸlocationãƒ–ãƒ­ãƒƒã‚¯ã§æ”¹ã‚ã¦å‡¦ç†ã•ã‚Œã‚‹ã€‚å†…éƒ¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¯ã€URLã‚’æ›¸ãæ›ãˆã¦ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã›ãšã«å‡¦ç†ã‚’ç¶šè¡Œã™ã‚‹ã€ãƒªãƒ©ã‚¤ãƒˆã€ã¨ã¯ç•°ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_core_module.html#try_files location / { try_files file ... uri; } location / { try_files file ... =code; } ï¼Šå®Ÿè£…ä¾‹ï¼Š location / { # 1. ã€/foo.htmlã€ã®ãƒ‘ã‚¹ã§ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ # 2. ã€/foo.html/ã€ã®ãƒ‘ã‚¹ã§ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ # 3. ã€/index.php?query_stringã€ã®ãƒ‘ã‚¹ã§å†…éƒ¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ try_files $uri $uri/ /index.php?query_string; } # å†…éƒ¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¾Œã¯ã€ã€/index.php?foo=barã€ã®ãŸã‚ã€ä»¥ä¸‹ã§å‡¦ç†ã•ã‚Œã‚‹ã€‚ location ~ \\.php$ { # php-fpmã«è»¢é€ã•ã‚Œã‚‹ã€‚ fastcgi_pass 127.0.0.1:9000; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®å—ä¿¡ ãƒ»nginxã«ã‚ˆã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ Webã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®ã¿ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å—ä¿¡ã™ã‚‹ã€‚ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç”¨ã®serverãƒ–ãƒ­ãƒƒã‚¯ã§ã€gifãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã‚ˆã†ã«locationãƒ–ãƒ­ãƒƒã‚¯ã‚’å®šç¾©ã™ã‚‹ã€‚Nginxã§ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹å¿…è¦ã¯ãªã„ãŸã‚ã€locationãƒ–ãƒ­ãƒƒã‚¯ã§ã¯access_logã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š server { listen 80 default_server; listen [::]:80 default_server; root /var/www/example; index index.php index.html; location /healthcheck { empty_gif; access_log off; break; } } ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ Webã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸¡æ–¹ã§ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å—ä¿¡ã™ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã«200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å®Ÿè£…ã—ãŸã†ãˆã§ã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç”¨ã®serverãƒ–ãƒ­ãƒƒã‚¯ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«locationãƒ–ãƒ­ãƒƒã‚¯ã‚’å®šç¾©ã™ã‚‹ã€‚Nginxã§ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹å¿…è¦ã¯ãªã„ãŸã‚ã€locationãƒ–ãƒ­ãƒƒã‚¯ã§ã¯access_logã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š server { listen 80 default_server; listen [::]:80 default_server; root /var/www/example; index index.php index.html; location /healthcheck { try_files $uri $uri/ /index.php?$query_string; access_log off; } } 03-03. http_index_module ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ãƒ»index ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®URLãŒãƒˆãƒ¬ã‚¤ãƒªãƒ³ã‚°ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§çµ‚ã‚ã‚‹å…¨ã¦ã®å ´åˆã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’URLã®æœ«å°¾ã«è¿½åŠ ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_index_module.html ï¼Šå®Ÿè£…ä¾‹ï¼Š index index.php; 03-04. http_headers_module ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ãƒ»add_header ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_headers_module.html#add_header ï¼Šå®Ÿè£…ä¾‹ï¼Š # Referrer-Policyãƒ˜ãƒƒãƒ€ãƒ¼ã«å€¤ã‚’è¨­å®šã™ã‚‹ add_header Referrer-Policy \"no-referrer-when-downgrade\"; 03-05. http_upstream_module ãƒ–ãƒ­ãƒƒã‚¯ ãƒ»upstream å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_upstream_module.html#upstream ï¼Šå®Ÿè£…ä¾‹ï¼Š upstream big_server_com { server 127.0.0.3:8000 weight=5; server 127.0.0.3:8001 weight=5; server 192.168.0.1:8000; server 192.168.0.1:8001; } 03-06. http_fast_cgi_module ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ãƒ»fastcgi_params FastCGIãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ã¦Appã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹å ´åˆã€è»¢é€å…ˆã§ç”¨ã„ã‚‹å¤‰æ•°ã¨ãã®å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_fastcgi_module.html#fastcgi_param ï¼Šå®Ÿè£…ä¾‹ï¼Š fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; ãƒ»fastcgi_pass FastCGIãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ã¦Appã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹å ´åˆã€è»¢é€å…ˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_fastcgi_module.html#fastcgi_pass ï¼Šå®Ÿè£…ä¾‹ï¼Š fastcgi_pass 127.0.0.1:9000; 03-07. http_proxy_module ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ãƒ»proxy_pass HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ã¦Appã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹å ´åˆã€è»¢é€å…ˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass ï¼Šå®Ÿè£…ä¾‹ï¼Š proxy_pass http://127.0.0.1:8080/; "},"public/software/software_middleware_web_apache.html":{"url":"public/software/software_middleware_web_apache.html","title":"ğŸ“– ï¸Apache","keywords":"","body":"Apache ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒãƒ³ãƒ‰ ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ ãƒ»httpd å‚è€ƒï¼šhttps://httpd.apache.org/docs/trunk/ja/programs/httpd.html ãƒ»apachectl å‚è€ƒï¼šhttps://httpd.apache.org/docs/trunk/ja/programs/apachectl.html ã‚³ãƒãƒ³ãƒ‰ ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®å®Ÿè£…å ´æ‰€ã®ä¸€è¦§ ç‰¹å®šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å®Ÿè£…ã™ã‚‹ã¹ãè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€è¦§ã§è¡¨ç¤ºã™ã‚‹ã€‚ $ sudo httpd -L ãƒ»è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ # systemctlã‚³ãƒãƒ³ãƒ‰ã§ã¯å®Ÿè¡Œä¸å¯èƒ½ $ sudo service httpd configtest $ sudo apachectl configtest $ sudo apachectl -t ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¸€è¦§ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä¸€è¦§ã§è¡¨ç¤ºã™ã‚‹ã€‚è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ã‚‰ã¨ã„ã£ã¦ã€èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã¨ã¯é™ã‚‰ãªã„ã€‚ $ sudo httpd -l ãƒ»èª­ã¿è¾¼ã¿æ¸ˆã¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¸€è¦§ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã†ã¡ã§ã€å®Ÿéš›ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ sudo httpd -M ãƒ»èª­ã¿è¾¼ã¿æ¸ˆã¿confãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§ èª­ã¿è¾¼ã¾ã‚ŒãŸconfãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€è¦§ã§è¡¨ç¤ºã™ã‚‹ã€‚ã“ã®çµæœã‹ã‚‰ã€ä½¿ã‚ã‚Œã¦ã„ãªã„confãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ã‚’æ¤œå‡ºã§ãã‚‹ã€‚ $ sudo httpd -t -D DUMP_CONFIG 2>/dev/null | grep \"# In\" | awk \"{print $4}\" ãƒ»èª­ã¿è¾¼ã¾ã‚Œã‚‹VirtualHostè¨­å®šã®ä¸€è¦§ $ sudo httpd -S ãƒ»å¼·åˆ¶çš„ãªèµ·å‹•ï¼åœæ­¢ï¼å†èµ·å‹• # èµ·å‹• $ sudo systemctl start httpd # åœæ­¢ $ sudo systemctl stop httpd # å†èµ·å‹• $ sudo systemctl restart httpd ãƒ»å®‰å…¨ãªå†èµ·å‹• Apacheã‚’æ®µéšçš„ã«å†èµ·å‹•ã™ã‚‹ã€‚å®‰å…¨ã«å†èµ·å‹•ã§ãã‚‹ã€‚ $ sudo apachectl graceful 02. æ©Ÿèƒ½ã®ç¨®é¡ Webã‚µãƒ¼ãƒã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã—ã¦ Appã‚µãƒ¼ãƒã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã—ã¦ mod_phpãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã«ã‚ˆã£ã¦ã€Appã‚µãƒ¼ãƒã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã—ã¦ã‚‚æ©Ÿèƒ½ã•ã›ã‚‰ã‚Œã‚‹ã€‚ 03. Coreã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ServerRoot ãƒ»ServerRootã¨ã¯ ä»–ã®è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã«é©ç”¨ã•ã‚Œã‚‹ã€‚ãã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š é€šå¸¸ã§ã‚ã‚Œã°ã€etcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã«confãƒ•ã‚¡ã‚¤ãƒ«ãŒé…ç½®ã•ã‚Œã‚‹ã€‚ ServerRoot /etc/httpd CentOSã®EPELãƒªãƒã‚¸ãƒˆãƒªçµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå ´åˆã€Apacheã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã«ã€optãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã«confãƒ•ã‚¡ã‚¤ãƒ«ãŒè¨­ç½®ã•ã‚Œã‚‹ã€‚ ServerRoot /opt/rh/httpd24/root/etc/httpd VirtualHost ãƒ»VirtualHostã¨ã¯ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å›²ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®ä¸€ã¤ã€‚ç‰¹å®šã®ãƒ›ã‚¹ãƒˆåã‚„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã£ãŸæ™‚ã«å®Ÿè¡Œã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å®šç¾©ã™ã‚‹ã€‚VirtualHostã¨ã„ã†åå‰ã®é€šã‚Šã€1 ã¤ã®ã‚µãƒ¼ãƒä¸Šã§ã€ä»®æƒ³çš„ã«è¤‡æ•°ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’æ‰±ã†ã‚ˆã†ãªå‡¦ç†ã‚‚å®šç¾©ã§ãã‚‹ã€‚è¤‡æ•°ã®VirtualHostã‚’è¨­å®šã—ãŸå ´åˆã€ä¸€ã¤ç›®ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Listen 80 NameVirtualHost *:80 # Defaultã‚µãƒ¼ãƒã¨ã—ã¦æ‰±ã†ã€‚ DocumentRoot /www/foo ServerName www.example.com DocumentRoot /www/bar ServerName www.example.org ãƒ»IPãƒ™ãƒ¼ã‚¹VirtualHost å„ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ç•°ãªã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚ŠæŒ¯ã‚‹ãƒãƒ¼ãƒãƒ£ãƒ«ãƒ›ã‚¹ãƒˆã€‚ ãƒ»åå‰ãƒ™ãƒ¼ã‚¹VirtualHost å…¨ã¦ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åŒã˜IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚ŠæŒ¯ã‚‹ãƒãƒ¼ãƒãƒ£ãƒ«ãƒ›ã‚¹ãƒˆã€‚ DocumentRoot ãƒ»DocumentRootã¨ã¯ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã«ã€index.htmlã€ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã¨ã€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã—ãªãã¨ã‚‚ã€ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®index.htmlãƒ•ã‚¡ã‚¤ãƒ«ãŒã€ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦è‡ªå‹•çš„ã«èªè­˜ã•ã‚Œã¦è¡¨ç¤ºã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š DocumentRoot /www/foo: ServerName www.example.com index.htmlä»¥å¤–ã®åå‰ã‚’ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã«ã™ã‚‹å ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š DocumentRoot /www/foo:/start-up.html ServerName www.example.com Directory ãƒ»Directoryã¨ã¯ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å›²ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®ä¸€ã¤ã€‚æŒ‡å®šã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã£ãŸæ™‚ã«å®Ÿè¡Œã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š DirectoryIndex index.php AllowOverride All Userã€Group ãƒ»Userã¨ã¯ httpdãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¦ãƒ¼ã‚¶åã‚’å®šç¾©ã™ã‚‹ã€‚httpdãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æ‰€æœ‰è€…åã¯ã€ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§å®šç¾©ã—ãŸã‚‚ã®ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š User apache ãƒ»Groupã¨ã¯ httpdãƒ—ãƒ­ã‚»ã‚¹ã®ã‚°ãƒ«ãƒ¼ãƒ—åã‚’å®šç¾©ã™ã‚‹ã€‚httpdãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚°ãƒ«ãƒ¼ãƒ—åã¯ã€ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§å®šç¾©ã—ãŸã‚‚ã®ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Group apache KeepAliveã€MaxKeepAliveRequestsã€KeepAliveTimeout ãƒ»KeepAliveã¨ã¯ HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã—ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä»˜ä¸ã™ã‚‹ã‹ã©ã†ã‹ã€ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š KeepAlive On ãƒ»KeepAliveTimeout ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä»˜ä¸ä¸­ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãŠã„ã¦ã€å†ã³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã¾ã§ã«ä½•ç§’é–“ç©ºã„ãŸã‚‰ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç ´æ£„ã™ã‚‹ã‹ã€ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š # KeepAliveãŒOnã®æ™‚ã®ã¿ KeepAliveTimeout 5 ãƒ»MaxKeepAliveRequests ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä»˜ä¸ä¸­ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãŠã„ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š # KeepAliveãŒOnã®æ™‚ã®ã¿ MaxKeepAliveRequests 1000 04. mod_soã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– LoadModule ãƒ»LoadModule ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å®£è¨€ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ç›¸å¯¾ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã€ServerRootã‚’é©ç”¨ã•ã›ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€httpdãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®modulesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå‚ç…§ã•ã‚Œã‚‹ã€‚ # ServerRoot ãŒ /opt/rh/httpd24/root/etc/httpd ã ã¨ã™ã‚‹ã€‚ LoadModule dir_module modules/mod_dir.so 04-02. mod_dirã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– DirectoryIndex ãƒ»DirectoryIndexã¨ã¯ Directoryãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã«ã‚ˆã£ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š DirectoryIndex index.html index.php ï¼Šå®Ÿè£…ä¾‹ï¼Š DirectoryIndex index.html DirectoryIndex index.php AllowOverride ãƒ»AllowOverrideã¨ã¯ åˆ¥ã«ç”¨æ„ã—ãŸ.htaccessãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€æœ‰åŠ¹åŒ–ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š DirectoryIndex index.php AllowOverride All ãƒ»All åˆ¥ã«ç”¨æ„ã—ãŸ.htaccessãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€å®Ÿè£…å¯èƒ½ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å…¨ã¦æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š AllowOverride All ãƒ»None åˆ¥ã«ç”¨æ„ã—ãŸ.htaccessãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€å®Ÿè£…å¯èƒ½ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å…¨ã¦ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š AllowOverride None ãƒ»Indexes åˆ¥ã«ç”¨æ„ã—ãŸ.htaccessãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€DirectoryIndexãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š AllowOverride Indexes 04-03. mod_writeã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– RewriteCond ãƒ»RewriteCondã¨ã¯ æ¡ä»¶åˆ†å²ã¨ã€ãã‚Œã«ã‚ˆã‚‹å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š RewriteCond %å¤‰æ•°å æ¡ä»¶ ï¼Šå®Ÿè£…ä¾‹ï¼Š RewriteCond %{HTTP:X-Forwarded-Port} !^443$ RewriteRule ãƒ»ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¨ãƒªãƒ©ã‚¤ãƒˆã®é•ã„ ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html ãƒ»RewriteRuleã¨ã¯ æ¡ä»¶åˆ†å²ã«ã‚ˆã‚‹å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚ RewriteRule URLæ›¸æ›ï¼†è»¢é€ã®è¨˜è¿° ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’HTTPSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«å¤‰æ›ã—ã¦ã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã€‚ RewriteRule ^(.*)?$ https://%{HTTP_HOST}$1 [R=301,L] 04-04. mod_setenvifã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– SetEnvIf ãƒ»SetEnvIfã¨ã¯ æ¡ä»¶åˆ†å²ã¨ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã‚’å®šç¾©ã™ã‚‹ã€‚ # ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä»¥ä¸‹ã®æ‹¡å¼µå­ã®å ´åˆ SetEnvIf Request_URI \"\\.(gif|jpe?g|png|js|css)$\" object-is-ignore ãƒ»nolog ãƒ­ã‚°ã‚’å‡ºåŠ›ã—ãªã„å ´åˆã‚’è¨­å®šã§ãã‚‹ã€‚ 04-05. mod_log_configã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– LogFormat ãƒ»LogFormatã¨ã¯ ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸å¼ã‚’å®šç¾©ã™ã‚‹ã€‚ ãƒ»ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°å½¢å¼ã¨å‡ºåŠ›å†…å®¹ ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®å‡ºåŠ›å…ˆãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’åˆã‚ã›ã¦å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š # commonå½¢å¼ CustomLog logs/access_log common LogFormat \"%h %l %u %t \"%r\" %>s %b\" common # combineå½¢å¼ CustomLog logs/access_log combined LogFormat \"%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"\" combined ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ­ã‚°ã«ãªã‚‹ã€‚ # commonå½¢å¼ 118.86.194.71 - - [17/Aug/2011:23:04:03 +0900] \"GET /home/name/category/web HTTP/1.1\" 200 11815 # combineå½¢å¼ 118.86.194.71 - - [17/Aug/2011:23:04:03 +0900] \"GET /home/name/category/web HTTP/1.1\" 200 11815 \"http://naoberry.com/home/name/\" \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.112 Safari/535.1\" ãƒ»ãƒ­ã‚°ã®å¤‰æ•°ä¸€è¦§ å¤‰æ•° å€¤ ä¾‹ %h ãƒªãƒ¢ãƒ¼ãƒˆãƒ›ã‚¹ãƒˆ 118.86.194.71 %l ãƒªãƒ¢ãƒ¼ãƒˆãƒ­ã‚°åï¼ˆåŸºæœ¬â€-â€œã«ãªã‚‹ï¼‰ - %u ãƒªãƒ¢ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶ï¼ˆBasicèªè¨¼ã®ãƒ¦ãƒ¼ã‚¶ï¼‰ - %t ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä»˜æ™‚åˆ» [17/Aug/2011:23:04:03 +0900] %r ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æœ€åˆã®è¡Œ GET /home/name/category/web HTTP/1.1 %s ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ 200 %b ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒã‚¤ãƒˆæ•° 11815 %{Referer}i ãƒªãƒ•ã‚¡ãƒ© http://naoberry.com/home/name/ %{User-Agent}i ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.112 Safari/535.1 ErrorLog ãƒ»ErrorLogã¨ã¯ ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸å¼ã‚’å®šç¾©ã™ã‚‹ã€‚ ãƒ»ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å½¢å¼ã¨å‡ºåŠ›å†…å®¹ ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®å‡ºåŠ›å…ˆã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ErrorLog /var/log/httpd/error_log LogLevel ãƒ»LogLevelã¨ã¯ ã©ã®ãƒ¬ãƒ™ãƒ«ã¾ã§ãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹ã‹ã‚’å®šç¾©ã™ã‚‹ã€‚ ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« æ„å‘³ è¨­å®šã®ç›®å®‰ emerg ã‚µãƒ¼ãƒãŒç¨¼å‹•ã§ããªã„ã»ã©ã®é‡å¤§ãªã‚¨ãƒ©ãƒ¼ alert critã‚ˆã‚Šã‚‚é‡å¤§ãªã‚¨ãƒ©ãƒ¼ crit é‡å¤§ãªã‚¨ãƒ©ãƒ¼ error ã‚¨ãƒ©ãƒ¼ warn è­¦å‘Š æœ¬ç•ªç’°å¢ƒ notice é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ info ã‚µãƒ¼ãƒæƒ…å ± ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ debug ãƒ‡ãƒãƒƒã‚¯ç”¨ã®æƒ…å ± 04-06. mod_sslã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– SSLCertificateFile ãƒ»SSLCertificateFileã¨ã¯ PKIã«ãŠã‘ã‚‹å…¬é–‹éµã®æ¤œè¨¼ã«å¿…è¦ãªSSLè¨¼æ˜æ›¸ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å®šç¾©ã™ã‚‹ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯AWSã®ACMè¨¼æ˜æ›¸ã‚’ç”¨ã„ã‚‹ã“ã¨ãŒå¤šã„ãŸã‚ã€åŸºæœ¬çš„ãªç”¨é€”ã¨ã—ã¦ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã®ã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸èª­ã¿è¾¼ã¿ã®ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š SSLCertificateFile /etc/httpd/conf.d/server.crt SSLCertificateKeyFile ãƒ»SSLCertificateKeyFileã¨ã¯ PKIã«ãŠã‘ã‚‹å…¬é–‹éµã®æ¤œè¨¼ã«å¿…è¦ãªç§˜å¯†éµã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š SSLCertificateKeyFile /etc/httpd/conf.d/server.key 04-07. mod_headersã«ãŠã‘ã‚‹è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– Header ãƒ»Headerã¨ã¯ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚setã€appendã€addã€unsetã€echoã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã§ãã‚‹ã€‚æ¨™æº–ã§ã¯2xxã¨3xxã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã¿ã§è¨­å®šãŒé©ç”¨ã•ã‚Œã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã€alwaysã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€å…¨ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã§ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»set ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Referrer-Policyãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ ã—ã€å€¤ã‚’no-referrer-when-downgradeã¨ã™ã‚‹ã€‚ã¡ãªã¿ã«ã€Chrome85ä»¥é™ã®Referrer-Policyãƒ˜ãƒƒãƒ€ãƒ¼åˆæœŸå€¤ã®ä»•æ§˜å¤‰æ›´ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://www.chromestatus.com/feature/6251880185331712 Header set Referrer-Policy \"no-referrer-when-downgrade\" Header set Referrer-Policy \"no-referrer-when-downgrade\" always ãƒ»unset ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Referrer-Policyãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ Header unset Referrer-Policy \"no-referrer-when-downgrade Header unset Referrer-Policy \"no-referrer-when-downgrade\" always 05. htaccess å½±éŸ¿ç¯„å›² ãƒ»ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆ å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ãŒé©ç”¨ã•ã‚Œã‚‹ã€‚ ãƒ»ãã‚Œä»¥å¤–ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆ è¨­ç½®ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã®éšå±¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦é©ç”¨ã•ã‚Œã‚‹ã€‚ "},"public/software/software_middleware_application_php_fpm.html":{"url":"public/software/software_middleware_application_php_fpm.html","title":"ğŸ“– ï¸PHP-FPM","keywords":"","body":"PHP-FPMï¼šPHP FastCGI Process Manager ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. CGIã«ã¤ã„ã¦ ãƒ»CGIã¨ã¯ FastCGIï¼šFast Common Gateway Interface ãƒ»FastCGIã¨ã¯ CGIãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ä»•æ§˜ã®ã“ã¨ã€‚ PHP-FPM ãƒ»PHP-FPMã¨ã¯ PHPã®ãŸã‚ã«å®Ÿè£…ã•ã‚ŒãŸFastCGIã®ã“ã¨ã€‚Webã‚µãƒ¼ãƒã¨PHPãƒ•ã‚¡ã‚¤ãƒ«ã®é–“ã§ãƒ‡ãƒ¼ã‚¿é€šä¿¡ã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://developpaper.com/shared-cgi-fastcgi-and-php-fpm-1/ 02. è¨­å®š /etc/php-fpm.d/www.confãƒ•ã‚¡ã‚¤ãƒ« ãƒ»/etc/php-fpm.d/www.confãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ PHP-FPMã®è¨­å®šã‚’å®šç¾©ã™ã‚‹ã€‚php.iniãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã£ã¦èª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚php.iniãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šã‚‚å„ªå…ˆã•ã‚Œã‚‹ã®ã§ã€è¨­å®šé …ç›®ãŒé‡è¤‡ã—ã¦ã„ã‚‹å ´åˆã¯ã€ã“ã¡ã‚‰ã‚’å¤‰æ›´ã™ã‚‹ã€‚Nginxã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹å ´åˆã€/etc/php-fpm.d/www.confãƒ•ã‚¡ã‚¤ãƒ«ã¨/etc/nginx/nginx.confãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸¡æ–¹ã§ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¦ãƒ¼ã‚¶åã‚’ã€www-dataã€ã¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã€www-dataã€ã¯Apacheãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¦ãƒ¼ã‚¶åã®æ¨™æº–å€¤ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.php.net/manual/ja/install.unix.nginx.php ï¼Šå®Ÿè£…ä¾‹ï¼Š [www] # ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¦ãƒ¼ã‚¶åã€ã‚°ãƒ«ãƒ¼ãƒ—å user = www-data group = www-data # UNIXãƒ‰ãƒ¡ã‚¤ãƒ³ã‚½ã‚±ãƒƒãƒˆã‚’ç”¨ã„ã‚‹ãŸã‚ã«ã€sockãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š listen = /var/run/php-fpm/php-fpm.sock # 127.0.0.1:9000 # UNIXãƒ‰ãƒ¡ã‚¤ãƒ³ã‚½ã‚±ãƒƒãƒˆã‚’ç”¨ã„ã‚‹ãŸã‚ã«ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¦ãƒ¼ã‚¶åã‚’å¤‰æ›´ listen.owner = www-data listen.group = www-data listen.mode = 0660 # ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆæ¨å¥¨ ;listen.acl_users = apache,nginx # TCPã‚½ã‚±ãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ listen.allowed_clients = 127.0.0.1 # ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ access.log = /dev/stdout pm = dynamic pm.max_children = 50 pm.start_servers = 5 pm.min_spare_servers = 5 pm.max_spare_servers = 35 # ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ slowlog = /var/log/php-fpm/www-slow.log # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ # é–‹ç™ºç’°å¢ƒã§ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ/var/log/php-fpm/www-error.logï¼‰ã«å‡ºåŠ› php_admin_value[error_log] = /dev/stderr php_admin_flag[log_errors] = on # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¿å­˜æ–¹æ³•ã€‚ã“ã“ã§ã¯redisã®ã‚­ãƒ¼ã¨ã—ã¦ä¿å­˜ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯filesï¼‰ php_value[session.save_handler] = redis # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¿å­˜å ´æ‰€ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã€/var/lib/php/sessionï¼‰ php_value[session.save_path] = \"tcp://foo-redis.*****.ng.0001.apne1.cache.amazonaws.com:6379\" php_value[soap.wsdl_cache_dir] = /var/lib/php/wsdlcache ãƒ»Dockerã§ç”¨ã„ã‚‹å ´åˆ PHP-FPMãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã¯zz-docker.confãƒ•ã‚¡ã‚¤ãƒ«ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ãŠã‚Šã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯PHP-FPMã®ä¸€éƒ¨ã®è¨­å®šãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œã«å¾Œå‹ã¡ã™ã‚‹ãŸã‚ã«ã€ãƒ›ã‚¹ãƒˆå´ã§ã¯www.confãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å®šç¾©ã—ã¦ãŠãã€ã‚³ãƒ³ãƒ†ãƒŠå´ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹æ™‚ã¯zzz-www.confãƒ•ã‚¡ã‚¤ãƒ«ã¨ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://kengotakimoto.com/docker-laravel/#toc8 COPY ./php-fpm.d/www.conf /usr/local/etc/php-fpm.d/zzz-www.conf 04. ãƒ­ã‚° ãƒ­ã‚°ã®ç¨®é¡ ãƒ»NOTICE [01-Sep-2021 00:00:00] NOTICE: fpm is running, pid 1 ãƒ»WARNING [01-Sep-2021 00:00:00] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it ãƒ»Fatal Error Fatal error: Allowed memory size of xxxxx bytes exhausted (tried to allocate 16 bytes) "},"public/software/software_middleware_database.html":{"url":"public/software/software_middleware_database.html","title":"ğŸ“– ï¸ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹","keywords":"","body":"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. RDBï¼ˆé–¢ä¿‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰ã¨ã¯ RDBMSï¼ˆé–¢ä¿‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®ä»•çµ„ã¿ RDBã¯ã€ãƒ‡ãƒ¼ã‚¿åŒå£«ãŒãƒ†ãƒ¼ãƒ–ãƒ«çŠ¶ã«é–¢ä¿‚ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿æ ¼ç´å½¢å¼ã§ã‚ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ã¯ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹ã€‚ RDBMSã¨RDBã®ç¨®é¡ ãƒ»MariaDB MariaDBãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç®¡ç†ã§ãã‚‹RDBMS ãƒ»MySQL MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç®¡ç†ã§ãã‚‹RDBMS ãƒ»PostgreSQL PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç®¡ç†ã§ãã‚‹RDBMS RDBSã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³ RDBMSãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å¯¾ã—ã¦ãƒ‡ãƒ¼ã‚¿ã®CRUDã®å‡¦ç†ã‚’è¡Œã†ãŸã‚ã«å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã“ã¨ã€‚ ãƒ»InnoDB 01-02. NoSQLï¼ˆéé–¢ä¿‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰ã¨ã¯ NoSQLã¯ã€ãƒ‡ãƒ¼ã‚¿åŒå£«ãŒé–¢ä¿‚ã‚’æŒãŸãªã„ãƒ‡ãƒ¼ã‚¿æ ¼ç´å½¢å¼ã§ã‚ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ã™ã‚‹ã€‚ NoSQLã®ç¨®é¡ 01-04. ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ ERå›³ï¼šEntity Relation Diagram ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_object_oriented_analysis_and_design.html æ­£è¦åŒ– ãƒ»æ­£è¦åŒ–ã¨ã¯ ç¹°ã‚Šè¿”ã—è¦ç´ ã®ã‚ã‚‹è¡¨ã‚’ã€æ­£è¦å½¢ã€ã€ãã®é€†ã‚’ã€éæ­£è¦å½¢ã€ã¨ã„ã†ã€‚éæ­£è¦å½¢ã®è¡¨ã‹ã‚‰ã€ä»–ã¨é€£å‹•ã™ã‚‹ã‚«ãƒ©ãƒ ã‚’ç‹¬ç«‹ã•ã›ã€æ­£è¦å½¢ã®è¡¨ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚’ã€æ­£è¦åŒ–ã€ã¨ã„ã†ã€‚ ãƒ»æ–¹æ³• ï¼Šä¾‹ï¼Š ã¾ãšã€ä¸»ã‚­ãƒ¼ãŒå—æ³¨Noã¨å•†å“IDã®2ã¤ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚ã“ã‚Œã‚‰ã®ä¸»ã‚­ãƒ¼ã¯ã€è¤‡åˆä¸»ã‚­ãƒ¼ã§ã¯ãªã„ã¨ã™ã‚‹ã€‚ ã‚¨ã‚¯ã‚»ãƒ«ã§è¡¨ã‚’ä½œæˆ ã‚¨ã‚¯ã‚»ãƒ«ã§ä½œã‚‰ã‚ŒãŸä»¥ä¸‹ã®è¡¨ãŒã‚ã‚‹ã¨ä»®å®šã€‚ ç¬¬ä¸€æ­£è¦åŒ–ï¼ˆç¹°ã‚Šè¿”ã—è¦ç´ ã®æ’é™¤ï¼‰ ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’1ã¤ãšã¤ã«åˆ†å‰²ã€‚ ç¬¬äºŒæ­£è¦åŒ–ï¼ˆä¸»ã‚­ãƒ¼ã®é–¢æ•°å¾“å±æ€§ã‚’æ’é™¤ï¼‰ ä¸»ã‚­ãƒ¼ã¨ç‰¹å®šã®ã‚«ãƒ©ãƒ ãŒé€£å‹•ã™ã‚‹ï¼ˆé–¢æ•°å¾“å±æ€§ãŒã‚ã‚‹ï¼‰å ´åˆã€ã‚«ãƒ©ãƒ ã‚’å·¦è¡¨ã¨ã—ã¦ç‹¬ç«‹ã•ã›ã‚‹ã€‚ä»Šå›ã€ä¸»ã‚­ãƒ¼ãŒ2ã¤ã‚ã‚‹ã®ã§ã€ã¾ãšå—æ³¨Noã‹ã‚‰é–¢æ•°å¾“å±æ€§ã‚’æ’é™¤ã—ã¦ã„ãã€‚å—æ³¨Noã¨ä»–3ã‚«ãƒ©ãƒ ãŒé€£å‹•ã—ã¦ãŠã‚Šã€å·¦è¡¨ã¨ã—ã¦ç‹¬ç«‹ã•ã›ã‚‹ã€‚ä¸»ã‚­ãƒ¼ã¨é€£å‹•ã—ã¦ã„ãŸã‚«ãƒ©ãƒ ã‚’é™¤ã„ãŸã‚‚ã®ã‚’å³è¡¨ã¨ã™ã‚‹ã€‚ã¾ãŸã€ä¸»ã‚­ãƒ¼ãŒé‡è¤‡ã™ã‚‹ãƒ­ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã€‚ æ¬¡ã«ã€å•†å“IDã®é–¢æ•°å¾“å±æ€§ã‚’æ’é™¤ã—ã¦ã„ãã€‚å•†å“IDã¨ä»–2ã‚«ãƒ©ãƒ ã«é–¢æ•°å¾“å±æ€§ãŒã‚ã‚Šã€å·¦è¡¨ã¨ã—ã¦ç‹¬ç«‹ã•ã›ã‚‹ã€‚ä¸»ã‚­ãƒ¼ã¨é€£å‹•ã—ã¦ã„ãŸã‚«ãƒ©ãƒ ã‚’é™¤ã„ãŸã‚‚ã®ã‚’å³è¡¨ã¨ã™ã‚‹ã€‚ã¾ãŸã€ä¸»ã‚­ãƒ¼ãŒé‡è¤‡ã™ã‚‹ãƒ­ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã€‚ã“ã‚Œã§ã€ä¸»ã‚­ãƒ¼ã®é–¢æ•°å¾“å±æ€§ã®æ’é™¤ã¯çµ‚äº†ã€‚ ç¬¬ä¸‰æ­£è¦åŒ–ï¼ˆä¸»ã‚­ãƒ¼ä»¥å¤–ã®ã‚«ãƒ©ãƒ ã®é–¢æ•°å¾“å±æ€§ã‚’æ’é™¤ï¼‰ æ¬¡ã«ä¸»ã‚­ãƒ¼ä»¥å¤–ã®ã‚«ãƒ©ãƒ ã®é–¢ä¿‚å¾“å±æ€§ã‚’æ’é™¤ã—ã¦ã„ãã€‚ä¸Šè¨˜ã§ç‹¬ç«‹ã•ã›ãŸ3ã¤ã®è¡¨ã®ã†ã¡ã€ä¸€ç•ªå·¦ã®è¡¨ã§ã€é¡§å®¢IDã¨é¡§å®¢åã«é–¢æ•°å¾“å±æ€§ãŒã‚ã‚‹ã®ã§ã€é¡§å®¢IDã‚’æ–°ã—ã„ä¸»ã‚­ãƒ¼ã«è¨­å®šã—ã€å·¦è¡¨ã¨ã—ã¦ç‹¬ç«‹ã•ã›ã‚‹ã€‚ä¸»ã‚­ãƒ¼ã¨é€£å‹•ã—ã¦ã„ãŸã‚«ãƒ©ãƒ ã‚’é™¤ã„ãŸã‚‚ã®ã‚’å³è¡¨ã¨ã™ã‚‹ã€‚ ã¾ã¨ã‚ ä¸»ã‚­ãƒ¼ã®é–¢ä¿‚å¾“å±æ€§ã®æ’é™¤ã«ã‚ˆã£ã¦ã€å—æ³¨è¡¨ã€å•†å“è¡¨ã€æ•°é‡è¡¨ã«åˆ†å‰²ã§ããŸã€‚ã¾ãŸã€ä¸»ã‚­ãƒ¼ä»¥å¤–ã®é–¢ä¿‚å¾“å±æ€§ã®æ’é™¤ã«ã‚ˆã£ã¦ã€é¡§å®¢IDã‚’æ–°ã—ã„ä¸»ã‚­ãƒ¼ã¨ã—ãŸé¡§å®¢è¡¨ã«åˆ†å‰²ã§ããŸã€‚ ï¼Šä¾‹ï¼Š ã‚¨ã‚¯ã‚»ãƒ«ã§è¡¨ã‚’ä½œæˆ ä»¥ä¸‹ã®ã‚ˆã†ãªè¡¨ã®å ´åˆã€è¡Œã‚’åˆ†å‰²ã—ã€ç•°ãªã‚‹è¡¨ã¨è¦‹ãªã™ã€‚ ç¬¬ä¸€æ­£è¦åŒ–ï¼ˆç¹°ã‚Šè¿”ã—è¦ç´ ã®æ’é™¤ï¼‰ ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ï¼å‰Šé™¤ ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã™ã‚‹ã‚ã‚‹ã„ã¯å‰Šé™¤ã™ã‚‹å ´åˆã€ã‚«ãƒ©ãƒ ã§ã¯ãªãã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å¢—æ¸›ã‚’è¡Œã†ã€‚ã‚«ãƒ©ãƒ ã®å¢—æ¸›ã®å‡¦ç†ã«ã¯æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚ä¸€æ–¹ã§ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å¢—æ¸›ã®å‡¦ç†ã«ã¯æ™‚é–“ãŒã‹ã‹ã‚‰ãªã„ã€‚ ï¼Šä¾‹ï¼Š è³ä¸ã‚’å¹´1å›ã‹ã‚‰ã€2å›ãƒ»3å›ã¨å¤‰ãˆã‚‹å ´åˆã€ä¸»ã‚­ãƒ¼ã‚’ç¹°ã‚Šè¿”ã—ã€æ–°ã—ãè³ä¸åŒºåˆ†ã¨é‡‘é¡åŒºåˆ†ã‚’ä½œã‚‹ã€‚ ãƒ†ãƒ¼ãƒ–ãƒ«å‘½åè¦å‰‡ ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«åã¯è¤‡æ•°å½¢ ä¾‹ãˆã°ã€foosã¨ã™ã‚‹ã€‚ ã‚«ãƒ©ãƒ å‘½åè¦å‰‡ ãƒ»ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã¯å˜æ•°å½¢ãƒ†ãƒ¼ãƒ–ãƒ«å ä¾‹ãˆã°ã€foo_idã€foo_nameã€foo_typeã¨ã™ã‚‹ã€‚ãŸã ã—ã€å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤–éƒ¨ã‚­ãƒ¼ã¨ç´ä»˜ãã‚«ãƒ©ãƒ ãŒã‚ã‚‹å ´åˆã€ãã®ã‚«ãƒ©ãƒ ã®ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã¯ã€å­ãƒ†ãƒ¼ãƒ–ãƒ«åã®å˜æ•°å½¢ã¨ã™ã‚‹ã€‚ä¾‹ãˆã°ã€bar_idã¨ã™ã‚‹ã€‚ä¾‹å¤–ã¨ã—ã¦ã€ActiveRecordãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆLaravelãªã©ï¼‰ã§ã¯ä½¿ç”¨ã—ãªã„æ–¹ãŒã‚ˆã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã“ã‚Œã‚‰ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã¯ã€å˜æ•°å½¢ãƒ†ãƒ¼ãƒ–ãƒ«åã®ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ãŒãªã„ã‚«ãƒ©ãƒ åã‚’æƒ³å®šã—ã¦æ©Ÿèƒ½ãŒå‚™ã‚ã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ã“ã®å ´åˆã€DBã¨ã®é€£æºã§æ¯å›ã‚«ãƒ©ãƒ åã‚’æ˜ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã£ãŸã‚Šã€æ¨™æº–ã§ã¯ãªã„ã‚«ãƒ©ãƒ åã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã‚‹ä¸å…·åˆãŒç™ºç”Ÿã—ãŸã‚Šã€ä¸ä¾¿ãªã“ã¨ãŒå¤šã‹ã£ãŸã‚Šã™ã‚‹ãŸã‚ã€ãŠã™ã™ã‚ã—ãªã„ã€‚ foo_id bar_id foo_name foo_type 1 1 foo 2 02. ACID ACIDã¨ã¯ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚å¿…è¦ãªæ©Ÿèƒ½ã‚’ç•¥ã—ã¦ã€ACIDã€ã¨ã„ã†ã€‚ å‚è€ƒï¼š http://tooljp.com/jyosho/docs/ACID/ACID.html https://atmarkit.itmedia.co.jp/ait/articles/1801/31/news011.html Atomicityï¼ˆä¸å¯åˆ†æ€§ï¼‰ ãƒ»Atomicityã¨ã¯ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«å«ã¾ã‚Œã‚‹å…¨ã¦ã®å‡¦ç†ãŒæˆåŠŸã™ã‚‹ã“ã¨ã¨ã€ã¾ãŸã¯ã„ãšã‚Œã‹ãŒå¤±æ•—ã—ãŸå ´åˆã«ã¯ä½•ã‚‚å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹ã«æˆ»ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹æ€§è³ªã®ã“ã¨ã€‚ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆåˆ¶å¾¡ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹ã€‚ Consistencyï¼ˆæ•´åˆæ€§ï¼‰ ãƒ»Consistencyã¨ã¯ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œå‰å¾Œã§ã‚ã£ã¦ã‚‚ã€ãƒ‡ãƒ¼ã‚¿ã¯å¸¸ã«DBã®ãƒ«ãƒ¼ãƒ«ã«å‰‡ã£ã¦ã„ã‚‹æ€§è³ªã®ã“ã¨ã€‚ã‚«ãƒ©ãƒ ã®åˆ¶ç´„ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹ã€‚ Isolationï¼ˆç‹¬ç«‹æ€§ï¼‰ ãƒ»Isolationã¨ã¯ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯ãŠäº’ã„ã«ç‹¬ç«‹ã—ã€å½±éŸ¿ã‚’ä¸ãˆåˆã‚ãªã„æ€§è³ªã®ã“ã¨ã€‚æ’ä»–åˆ¶å¾¡ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹ã€‚ Durabilityï¼ˆæ°¸ç¶šæ€§ï¼‰ ãƒ»Durabilityã¨ã¯ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å®Œäº†å¾Œã¯ã€ãŸã¨ãˆéšœå®³ãŒã‚ã£ãŸã¨ã—ã¦ã‚‚ã€ãƒ‡ãƒ¼ã‚¿ã¯å¤±ã‚ã‚Œãªã„æ€§è³ªã®ã“ã¨ã€‚éšœå®³å›å¾©åˆ¶å¾¡ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹ã€‚ 02-02. ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆåˆ¶å¾¡ RDBã®æ›¸ãè¾¼ã¿ç³»ã®æ“ä½œ ãƒ»CREATEï¼UPDATE/DELETEå‡¦ç†ã®æµã‚Œ ãƒ»RDBã®æ“ä½œã¨å®Ÿéš›ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å¯¾å¿œé–¢ä¿‚ RDBã®æ›¸ãè¾¼ã¿ç³»ã®æ“ä½œ PDOã§ã®ãƒ¡ã‚½ãƒƒãƒ‰å ãƒ©ãƒƒãƒ”ãƒ³ã‚° éšœå®³ã‹ã‚‰ã®å›å¾© æ›´æ–°å‰ãƒ­ã‚°ã®è¨˜éŒ² â†“ â†“ â†“ â†“ â†“ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹ beginTransaction() execute()é–‹å§‹ â†“ â†“ â†“ â¬†ï¸ ãƒ»Cï¼Uï¼Dã®å‡¦ç†ãƒ»ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³çµ‚äº† ãƒ»insert()ãƒ»update()ãƒ»delete() flush() â¬†ï¸ã€€Roll backï¼šrollBack() â†“ â†“ â†“ â¬†ï¸ Commitã«ã‚ˆã‚‹æ›´æ–°å¾Œãƒ­ã‚°ã®æ›¸ãè¾¼ã¿ã€‚ commit()é–‹å§‹ â†“ â†“ â†“ â†“ â¬‡ï¸ â†“ â†“ â†“ â¬‡ï¸ã€€Roll forward â†“ â†“ â†“ â¬‡ï¸ Check Pointã«ã‚ˆã‚‹æ›´æ–°å¾Œãƒ­ã‚°ã®DBåæ˜  commit()çµ‚äº† execute()çµ‚äº† ãƒ»PDOã«ã‚ˆã‚‹RDBã®æ›¸ãè¾¼ã¿ç³»ã®æ“ä½œ PDOã§ã¯æ›¸ãè¾¼ã¿å‡¦ç†ã«execãƒ¡ã‚½ãƒƒãƒ‰ã€èª­ã¿å‡ºã—å‡¦ç†ã«queryãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã€‚ $db->beginTransaction(); // ã„ãã¤ã‹ã®SQLãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚â€»ã‚‚ã—å¤±æ•—ã—ãŸå ´åˆã€ERRMODE_EXCEPTIONã‚’å®Ÿè¡Œã€‚ $db->exec(\"INSERT INTO movie(title, price) VALUES(\"ãƒãƒªãƒã‚¿\", 2000)\") $db->exec(\"INSERT INTO movie(title, price) VALUES(\"ã‚·ã‚¹ã‚¿ãƒ¼\", 2000)\") // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ä¸€é€£ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆãŒæˆåŠŸã—ãŸã‚‰ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚³ãƒŸãƒƒãƒˆã€‚ $db->commit(); } catch{ // ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã‚‰ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã€‚ $db->rollBack(); print \"å¤±æ•—ã—ã¾ã—ãŸã€‚ï¼š{$e->getMessage()}\" } ãƒ»Doctrineã«ã‚ˆã‚‹RDBã®æ›¸ãè¾¼ã¿ç³»ã®æ“ä½œ è©³ã—ãã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_framework_symfony.html ã‚³ãƒŸãƒƒãƒˆã«ã‚ˆã‚‹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›´æ–°å‰ãƒ­ã‚°ã¸ã®æ›¸ãè¾¼ã¿ ãƒ»ã‚³ãƒŸãƒƒãƒˆ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ä¸€é€£ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å‰ãƒ­ã‚°ã¨ã—ã¦æ›¸ãè¾¼ã‚€ã€‚ ãƒ»äºŒç›¸ã‚³ãƒŸãƒƒãƒˆ ã‚³ãƒŸãƒƒãƒˆã‚’ä»¥ä¸‹ã®äºŒã¤ã®æ®µéšã«åˆ†ã‘ã¦è¡Œã†ã“ã¨ã€‚ACIDã®ã†ã¡ã€åŸå­æ€§ã¨ä¸€è²«æ€§ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã€‚ ä»–ã®ã‚µã‚¤ãƒˆã«æ›´æ–°å¯èƒ½ã‹ã©ã†ã‹ã‚’ç¢ºèªã€‚ å…¨ã‚µã‚¤ãƒˆã‹ã‚‰ã®åˆæ„ãŒå¾—ã‚‰ã‚ŒãŸå ´åˆã«æ›´æ–°ã‚’ç¢ºå®šã€‚ ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®çµ‚äº†å¾Œã€DBMSã¯ã€å‡¦ç†é€Ÿåº¦ã‚’é«˜ã‚ã‚‹ãŸã‚ã«ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å¾Œãƒ­ã‚°ã‚’ã„ã£ãŸã‚“ãƒ¡ãƒ¢ãƒªä¸Šã§ç®¡ç†ã™ã‚‹ã€‚ ãã—ã¦ã€ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã§ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å¾Œãƒ­ã‚°ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜ ã•ã›ã‚‹ã€‚ã“ã®æ™‚ã€ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã¯ã€è‡ªå‹•å®Ÿè¡Œã¾ãŸã¯æ‰‹å‹•å®Ÿè¡Œã§ä½œæˆã™ã‚‹ã€‚ 02-03. éšœå®³å›å¾©åˆ¶å¾¡ éšœå®³ã‹ã‚‰ã®å›å¾© ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒã®éšœå®³ã®ã“ã¨ã€‚ä¾‹ãˆã°ã€DBMSã‚„OSã®ãƒˆãƒ©ãƒ–ãƒ«ç­‰ã«ã‚ˆã‚Šã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ãŒåœæ­¢ã™ã‚‹ã€‚ ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ éšœå®³ã«ã‚ˆã£ã¦ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ä¸€é€£ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆãŒã™ã¹ã¦å®Ÿè¡Œã•ã‚Œãªã‹ã£ãŸå ´åˆã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å‰ãƒ­ã‚°ã‚’ç”¨ã„ã¦ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®é–‹å§‹å‰ã®çŠ¶æ…‹ã«æˆ»ã™ã€‚ ãƒ»ãƒ­ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ éšœå®³ã«ã‚ˆã£ã¦ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®çµ‚äº†å¾Œã«ä¸€é€£ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®æ›´æ–°çµæœãŒãƒ‡ã‚£ã‚¹ã‚¯ã«åæ˜ ã•ã‚Œãªã‹ã£ãŸå ´åˆã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å¾Œãƒ­ã‚°ã‚’ç”¨ã„ã¦ã€ãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›´æ–°çµæœã‚’åæ˜ ã•ã›ã‚‹ã€‚ ï¼Šä¾‹ï¼Š ã€aã€ã®å€¤ã‚’æ›´æ–°ã™ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’å«ã‚€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å¾Œã«ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒç•°å¸¸çµ‚äº†ã—ãŸå ´åˆã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å¾Œãƒ­ã‚°ã€a = 5ã€ã‚’ç”¨ã„ã¦ã€ãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›´æ–°çµæœã‚’åæ˜ ã•ã›ã‚‹ã€‚ï¼ˆãƒ­ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ï¼‰ ã€bã€ã®å€¤ã‚’æ›´æ–°ã™ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’å«ã‚€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®é€”ä¸­ã«ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒç•°å¸¸çµ‚äº†ã—ãŸå ´åˆã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å‰ãƒ­ã‚°ã€b = 1ã€ã‚’ç”¨ã„ã¦ã€éšœå®³ç™ºç”Ÿå‰ã®çŠ¶æ…‹ã«æˆ»ã™ã€‚ï¼ˆãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰ åª’ä½“éšœå®³ã‹ã‚‰ã®å›å¾© ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢éšœå®³ã®ã“ã¨ã€‚ä¾‹ãˆã°ã€ãƒãƒ¼ãƒ‰ãƒ‡ã‚£ã‚¹ã‚¯ã®éšœå®³ãŒã‚ã‚‹ã€‚ãƒ‡ã‚£ã‚¹ã‚¯ã‚’åˆæœŸåŒ–ï¼äº¤æ›ã—ãŸå¾Œã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä¿®å¾©ã—ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°å¾Œãƒ­ã‚°ã€a = 5ã€ã€b = 1ã€ã‚’ç”¨ã„ã¦ã€ä¿®å¾©ã§ãã‚‹é™ã‚Šãƒ­ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã‚’è¡Œã†ã€‚ ï¼Šä¾‹ï¼Š ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ -- -------------------------------------------------------- -- Host: xxxxx -- Server version: 10.1.38-MariaDB - mariadb.org binary distribution -- Server OS: Win64 -- HeidiSQL Version: 10.2.0.5611 -- -------------------------------------------------------- /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */; /*!40101 SET NAMES utf8 */; /*!50503 SET NAMES utf8mb4 */; /*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */; /*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=\"NO_AUTO_VALUE_ON_ZERO\" */; # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ -- Dumping database structure for kizukeba_pronami_php CREATE DATABASE IF NOT EXISTS `kizukeba_pronami_php` /*!40100 DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci */; USE `kizukeba_pronami_php`; # ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’æŒ‡å®š -- Dumping structure for table kizukeba_pronami_php.mst_staff CREATE TABLE IF NOT EXISTS `mst_staff` ( `code` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(15) COLLATE utf8_unicode_ci NOT NULL, `password` varchar(32) COLLATE utf8_unicode_ci NOT NULL, PRIMARY KEY (`code`) ) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; # ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ -- Dumping data for table kizukeba_pronami_php.mst_staff: ~8 rows (approximately) /*!40000 ALTER TABLE `mst_staff` DISABLE KEYS */; INSERT INTO `mst_staff` (`code`, `name`, `password`) VALUES (1, \"ç§¦åŸºåš\", \"xxxxxxx\"), (2, \"è—¤åŸåŸºå¤®\", \"xxxxxxx\"); /*!40000 ALTER TABLE `mst_staff` ENABLE KEYS */; /*!40101 SET SQL_MODE=IFNULL(@OLD_SQL_MODE, \"\") */; /*!40014 SET FOREIGN_KEY_CHECKS=IF(@OLD_FOREIGN_KEY_CHECKS IS NULL, 1, @OLD_FOREIGN_KEY_CHECKS) */; /*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */; 02-04. æ’ä»–åˆ¶å¾¡ UPDATEå‡¦ç†ç«¶åˆå•é¡Œ ãƒ»UPDATEå‡¦ç†ç«¶åˆå•é¡Œã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®UPDATEå‡¦ç†ãŒã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å–å¾—ã¨æ›´æ–°ã‹ã‚‰ãªã‚‹ã¨ã™ã‚‹ã€‚ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ãƒ¦ãƒ¼ã‚¶Aã¨BãŒãŠã‚Šã€ãƒ¦ãƒ¼ã‚¶BãŒUPDATEå‡¦ç†æ™‚ã«å–å¾—ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã®çŠ¶æ…‹ã¯ã€ãƒ¦ãƒ¼ã‚¶AãŒUPDATEå‡¦ç†ã‚’çµ‚ãˆãŸå¾Œã®ã‚‚ã®ã§ã‚ã‚‹ã€‚ã—ã‹ã—ã€ãƒ¦ãƒ¼ã‚¶AãŒãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¦ã‹ã‚‰æ›´æ–°ã‚’çµ‚ãˆã‚‹ã¾ã§ã®é–“ã«ã€ãƒ¦ãƒ¼ã‚¶BãŒåŒã˜ããƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚çµæœã¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶Bã®UPDATEå‡¦ç†ã«ã‚ˆã£ã¦ã€ãƒ¦ãƒ¼ã‚¶Aã®å‡¦ç†ãŒä¸Šæ›¸ãã•ã‚Œã€ç„¡ã‹ã£ãŸã“ã¨ã«ãªã£ã¦ã—ã¾ã†ã€‚ å‚è€ƒï¼šhttps://qiita.com/NagaokaKenichi/items/73040df85b7bd4e9ecfc ãƒ¦ãƒ¼ã‚¶Aã¨ãƒ¦ãƒ¼ã‚¶Bã®UPDATEå‡¦ç†ãŒä¸¦è¡Œã—ãŸã¨ã—ã¦ã‚‚ã€ãƒ¦ãƒ¼ã‚¶Aã®å‡¦ç†ãŒç„¡ã‹ã£ãŸã“ã¨ã«ãªã‚‰ãªã„ã‚ˆã†ä¿è¨¼ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã€ã€æ’ä»–åˆ¶å¾¡ã€ãŒã‚ã‚‹ã€‚ æ’ä»–åˆ¶å¾¡ ãƒ»ç¨®é¡ å‚è€ƒï¼šhttps://qiita.com/momotaro98/items/5e37eefc62d726a30aee ç¨®é¡ èª¬æ˜ å…±æœ‰ï¼å æœ‰ãƒ­ãƒƒã‚¯ DBã«ã‚ˆã‚‹ãƒ­ãƒƒã‚¯æ©Ÿèƒ½ã€‚ æ¥½è¦³çš„ï¼æ‚²è¦³çš„ãƒ­ãƒƒã‚¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¾ãŸã¯DBã«ã‚ˆã‚‹ãƒ­ãƒƒã‚¯æ©Ÿèƒ½ã€‚ ãƒ»UPDATEå‡¦ç†ç«¶åˆå•é¡Œã®è¨±å®¹ UPDATEå‡¦ç†ç«¶åˆå•é¡Œã‚’è¨±å®¹ã—ã€æ’ä»–åˆ¶å¾¡ã‚’ä½¿ç”¨ã—ãªã„é¸æŠè‚¢ã‚‚ã‚ã‚‹ã€‚ å…±æœ‰ï¼å æœ‰ãƒ­ãƒƒã‚¯ ãƒ»å…±æœ‰ãƒ­ãƒƒã‚¯ DBã«ãŠã„ã¦ã€CRUDã®READå‡¦ç†ä»¥å¤–ã®å‡¦ç†ã‚’å®Ÿè¡Œä¸å¯èƒ½ã«ã™ã‚‹ã€‚ãƒ¬ã‚³ãƒ¼ãƒ‰ã®READå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã«ã€ä»–è€…ã«ã‚ˆã£ã¦UPDATEå‡¦ç†ã•ã‚ŒãŸããªã„å ´åˆã«ç”¨ã„ã‚‹ã€‚ã€å…±æœ‰ã€ã®åã®é€šã‚Šã€å…±æœ‰ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã«å¯¾ã—ã¦ã€ä»–ã®äººã‚‚å…±æœ‰ãƒ­ãƒƒã‚¯ã‚’è¡Œãˆã‚‹ã€‚MySQLã§ã¯ã€ã€SELECT ... LOCK IN SHARE MODEã€ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://dev.mysql.com/doc/refman/5.7/en/innodb-locking-reads.html ãƒ»å æœ‰ãƒ­ãƒƒã‚¯ DBã«ãŠã„ã¦ã€CRUDã®å…¨ã¦ã®å‡¦ç†ã‚’å®Ÿè¡Œä¸å¯èƒ½ã«ã™ã‚‹ã€‚ãƒ¬ã‚³ãƒ¼ãƒ‰ã®UPDATEå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã«ã€ä»–è€…ã«ã‚ˆã£ã¦UPDATEï¼READå‡¦ç†ã®ä¸¡æ–¹ã‚’å®Ÿè¡Œã•ã›ãªã„å ´åˆã«ç”¨ã„ã‚‹ã€‚MySQLã§ã¯ã€ã€SELECT ... FOR UPDATEã€ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://dev.mysql.com/doc/refman/5.7/en/innodb-locking-reads.html ãƒ»ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ç¾è±¡ è¤‡æ•°ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒã€äº’ã„ã«ä»–è€…ãŒä½¿ã„ãŸã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒ­ãƒƒã‚¯ã—ã¦ã—ã¾ã„ã€ãŠäº’ã„ã®ãƒ­ãƒƒã‚¯è§£é™¤ã‚’å¾…ã¡ç¶šã‘ã‚‹çŠ¶æ…‹ã®ã“ã¨ã€‚ã‚‚ã†ä¸€æ–¹ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒ­ãƒƒã‚¯ãŒè§£é™¤ã•ã‚Œãªã„ã¨ã€è‡ªèº«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã§ããªã„æ™‚ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒåœæ­¢ã™ã‚‹ã€‚ å…±æœ‰ãƒ­ãƒƒã‚¯ã®å®Ÿè¡Œ å æœ‰ãƒ­ãƒƒã‚¯ã®å®Ÿè¡Œ å…±æœ‰ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰ ã€‡ âœ• å æœ‰ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰ âœ• âœ• æ¥½è¦³çš„ï¼æ‚²è¦³çš„ãƒ­ãƒƒã‚¯ ãƒ»æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ DBã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«é–¢ã™ã‚‹ã‚«ãƒ©ãƒ å€¤ï¼ˆæœ€çµ‚æ›´æ–°æ—¥æ™‚ãªã©ï¼‰ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã¨ã™ã‚‹ã€‚UPDATEå‡¦ç†ã®ãŸã‚ã«ãƒ¦ãƒ¼ã‚¶AãŒDBã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ãŸæ™‚ã«ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³å€¤ã‚’ä¸€æ™‚çš„ã«ä¿æŒã—ã¦ãŠãã€‚ç¶šã‘ã¦æ›´æ–°ã™ã‚‹ç›´å‰ã«ã€DBã‹ã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å€¤ã‚’æ”¹ã‚ã¦å–å¾—ã™ã‚‹ã€‚ä¿æŒã—ã¦ãŠã„ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³å€¤ã¨DBã®å€¤ã‚’æ¯”è¼ƒã—ã€DBã®å€¤ã®æ–¹ãŒã‚ˆã‚Šæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã ã£ãŸå ´åˆã€UPDATEå‡¦ç†ãŒå¤±æ•—ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ç«¶åˆã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ã™409ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã¨ã‚ˆã„ã€‚ å‚è€ƒï¼š https://e-words.jp/w/%E6%A5%BD%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF-%E6%82%B2%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF.html https://medium-company.com/%E6%82%B2%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF%E3%81%A8%E6%A5%BD%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E9%81%95%E3%81%84/ ãƒ»æ‚²è¦³çš„ãƒ­ãƒƒã‚¯ ãƒ¦ãƒ¼ã‚¶AãŒDBã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ãŸæ™‚ç‚¹ã§ãƒ­ãƒƒã‚¯ã‚’èµ·å‹•ã—ã€ãƒ¦ãƒ¼ã‚¶Bã¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å–å¾—ã™ã‚‰ã§ããªãã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶AãŒæ›´æ–°ã‚’çµ‚ãˆã¦ãƒ­ãƒƒã‚¯ãŒè§£é™¤ã•ã‚Œã€ãã“ã§åˆã‚ã¦ãƒ¦ãƒ¼ã‚¶Bã¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§æ‚²è¦³çš„ãƒ­ãƒƒã‚¯ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã¯é›£æ˜“åº¦ãŒé«˜ãã€åŸºæœ¬çš„ã«ã¯DBãŒæä¾›ã™ã‚‹ãƒ­ãƒƒã‚¯æ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼š https://e-words.jp/w/%E6%A5%BD%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF-%E6%82%B2%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF.html https://medium-company.com/%E6%82%B2%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF%E3%81%A8%E6%A5%BD%E8%A6%B3%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E9%81%95%E3%81%84/ ãƒ»ORMã®æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ã«ã¤ã„ã¦ ORMãŒæ¥½è¦³çš„ãƒ­ãƒƒã‚¯ã®æ©Ÿèƒ½ã‚’æŒã£ã¦ã„ã‚‹å ´åˆãŒã‚ã‚‹ã€‚PHPã®ORMã§ã‚ã‚‹Doctrineã®ãƒ­ãƒƒã‚¯æ©Ÿèƒ½ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://www.doctrine-project.org/projects/doctrine-orm/en/2.9/reference/transactions-and-concurrency.html#locking-support https://qiita.com/tatsurou313/items/053cffdfe940a89d7f5a#or-%E3%83%9E%E3%83%83%E3%83%91%E3%83%BC%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E6%A5%BD%E8%A6%B3%E7%9A%84%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E5%AE%9F%E8%A3%85%E6%9C%89%E7%84%A1 ãƒ­ãƒƒã‚¯ã®ç²’åº¦ DB ï¼ ãƒ†ãƒ¼ãƒ–ãƒ« ï¼ ãƒ¬ã‚³ãƒ¼ãƒ‰ ï¼ ã‚«ãƒ©ãƒ  ã®é †ã«ã€ç²’åº¦ã¯å¤§ãã„ã€‚ãƒ­ãƒƒã‚¯ã®ç²’åº¦ãŒç´°ã‹ã‘ã‚Œã°ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®åŒæ™‚å®Ÿè¡Œæ€§ãŒé«˜ããªã£ã¦åŠ¹ç‡ã¯å‘ä¸Šã™ã‚‹ï¼ˆè¤‡æ•°ã®äººãŒDBã«å¯¾ã—ã¦ä½œæ¥­ã§ãã‚‹ï¼‰ã€‚ã—ã‹ã—ã€ãƒ­ãƒƒã‚¯ã®ç²’åº¦ã‚’ç´°ã‹ãã™ã‚Œã°ã™ã‚‹ã»ã©ã€ãã‚Œã ã‘ãƒ™ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®CPUè² è·ã¯å¤§ãããªã‚‹ã€‚ "},"public/software/software_middleware_database_mysql.html":{"url":"public/software/software_middleware_database_mysql.html","title":"ğŸ“– Myï¸SQL","keywords":"","body":"MySQL ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« å…ƒã€…ã®å€¤ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã§ç¤ºã™ [mysqld] skip-host-cache # è¨˜è¿°ãªã— skip-name-resolve # è¨˜è¿°ãªã— datadir = /var/lib/mysql socket = /var/lib/mysql/mysql.sock secure-file-priv = /var/lib/mysql-files user = mysql pid-file = /var/run/mysqld/mysqld.pid # character set / collation character_set_server = utf8mb4 # latin1 collation_server = utf8mb4_general_ci # latin1 # timezone default-time-zone = SYSTEM log_timestamps = SYSTEM # UTC # Error Log log-error = mysql-error.log # /var/log/mysqld.log # Slow Query Log slow_query_log = 1 # off slow_query_log_file = mysql-slow.log # host_name-slow.log long_query_time = 3 # 10 log_queries_not_using_indexes = 0 # off # General Log general_log = 1 # off general_log_file = mysql-general.log # host_name.log [mysql] default-character-set = utf8mb4 # utf8 [client] default-character-set = utf8mb4 # utf8 02. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ MySQLã®æº–å‚™ ãƒ»CentOSã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« mysqlã‚³ãƒãƒ³ãƒ‰ã®ã¿ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„å ´åˆ $ dnf install -y mysql mysqlã‚³ãƒãƒ³ãƒ‰ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒæ©Ÿèƒ½ã€ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„å ´åˆã¯ã“ã¡ã‚‰ $ dnf install -y mysql-server ãƒ»DBã«æ¥ç¶š DBã«æ¥ç¶šã™ã‚‹ã€‚pã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å€¤ã«ã¯ã‚¹ãƒšãƒ¼ã‚¹ãŒä¸è¦ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ $ mysql -u -p -h ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¡¨ç¤º ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ -- ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¡¨ç¤º SHOW SESSION VARIABLES; SHOW GLOBAL VARIABLES; -- OSã¨DBã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¡¨ç¤º SHOW SESSION VARIABLES LIKE \"%time_zone\"; SHOW GLOBAL VARIABLES LIKE \"%time_zone\"; ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨­å®š -- ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å ´åˆ SET GLOBAL time_zone = \"Asia/Tokyo\"; -- ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å ´åˆ SET time_zone = \"Asia/Tokyo\"; 03. ãƒ†ãƒ¼ãƒ–ãƒ« CREATE TABLEå¥ ãƒ»ä½¿ã„æ–¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š -- æ³¨æ–‡ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ CREATE TABLE order_data ( -- ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ order_id INT(10) PRIMARY KEY COMMENT \"æ³¨æ–‡ID\", -- Not Nullåˆ¶ç´„ order_kbn INT(3) NOT NULL COMMENT \"æ³¨æ–‡åŒºåˆ†\", system_create_date_time DATETIME NOT NULL COMMENT \"ã‚·ã‚¹ãƒ†ãƒ ç™»éŒ²æ—¥æ™‚\", system_update_date_time DATETIME NOT NULL COMMENT \"ã‚·ã‚¹ãƒ†ãƒ æ›´æ–°æ—¥æ™‚\", delete_flg INT(1) DEFAULT 0 NOT NULL COMMENT \"0ï¼šé€šå¸¸ã€1ï¼šå‰Šé™¤æ¸ˆ\", -- è¤‡åˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ï¼ˆã“ã‚Œã‚’æŒ‡å®šã™ã‚‹å ´åˆã€ä¸Šè¨˜ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ã®è¨˜è¿°ã¯ä¸è¦ï¼‰ PRIMARY KEY(order_id, order_kbn) -- å‚ç…§åˆ¶ç´„ã‚­ãƒ¼ FOREIGN KEY order_kbn REFERENCES order_kbn_data ) CREATE VIEWå¥ ãƒ»ä½¿ã„æ–¹ ãƒ“ãƒ¥ãƒ¼ã¨ã¯ã‚ã‚‹è¡¨ã®ç‰¹å®šã®ã‚«ãƒ©ãƒ ã‚„æŒ‡å®šã—ãŸæ¡ä»¶ã«åˆè‡´ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ãªã©ã‚’å–ã‚Šå‡ºã—ãŸä»®æƒ³ã®è¡¨ã€‚ã¾ãŸã€è¤‡æ•°ã®è¡¨ã‚’çµåˆã—ãŸãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆã§ãã‚‹ã€‚ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šãƒ¦ãƒ¼ã‚¶ã«å¿…è¦æœ€å°é™ã®ã‚«ãƒ©ãƒ ã‚„ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã›ã‚‹äº‹ãŒã§ãã€ã¾ãŸçµåˆæ¡ä»¶ã‚’æŒ‡å®šã—ãªãã¦ã‚‚æ—¢ã«çµåˆã•ã‚ŒãŸè¡¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚ â‡’ã‚ˆãã‚ã‹ã‚‰ã‚“â€¦ ï¼Šå®Ÿè£…ä¾‹ï¼Š CREATE VIEW { ãƒ†ãƒ¼ãƒ–ãƒ«å } AS SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã¯ ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸­ã§ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ„ã«è­˜åˆ¥ã§ãã‚‹å€¤ã‚’ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã€ã®å€¤ã¨å‘¼ã¶ã€‚ ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦ä½¿ç”¨å¯èƒ½ãªã‚‚ã® ä¸€æ„ã«è­˜åˆ¥ã§ãã‚‹ã‚‚ã®ã‚ã‚Œã°ã€ä½•ã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦ç”¨ã„ã¦ã‚‚å•é¡Œãªãã€åŸºæœ¬çš„ã«ä»¥ä¸‹ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ç¨®é¡ èª¬æ˜ è£œè¶³ MySQLã®Auto Incrementæ©Ÿèƒ½ã«ã‚ˆã£ã¦å¢—åŠ ã™ã‚‹ç•ªå·ã‚«ãƒ©ãƒ  ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ã‚’èª²ã—ãŸã‚«ãƒ©ãƒ ã®Auto Incrementæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–ã—ã¦ãŠãã€‚CREATEå‡¦ç†ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹æ™‚ã«ã€ã€0ã€ã¾ãŸã¯ã€nullã€ã‚’ãƒ¢ãƒ‡ãƒ«ã®IDå€¤ã¨ã—ã¦å‰²ã‚Šå½“ã¦ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å‡¦ç†ã«ã‚ˆã£ã¦æ–°ã—ã„ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒè¿½åŠ ã•ã‚Œã‚‹æ™‚ã«ã€ç¾åœ¨ã®æœ€æ–°ç•ªå·ã«ï¼‹ï¼‘ã—ãŸç•ªå·ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ã“ã‚Œã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ã‚’æº€ãŸã™ã€‚å‚è€ƒï¼šhttps://dev.mysql.com/doc/refman/8.0/en/example-auto-increment.html ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨DBãŒã‚ˆã‚Šå¯†çµåˆã«ãªã‚Šã€Active Recordãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç›¸æ€§ãŒã‚ˆã„ã€‚MySQLã®ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ã€NO_AUTO_VALUE_ON_ZEROã€ã‚’è¨­å®šã™ã‚‹ã¨ã€ã€0ã€ã®å‰²ã‚Šå½“ã¦ã«ã‚ˆã‚‹è‡ªå‹•é€£ç•ªãŒæ‹’å¦ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ UUIDï¼ˆä¾‹ï¼š3cc807ab-8e31-3071-aee4-f8f03781cb91ï¼‰ CREATEå‡¦ç†ã§ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹æ™‚ã«ã€ã‚¢ãƒ—ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ç”Ÿæˆã—ãŸUUIDå€¤ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®IDå€¤ã¨ã—ã¦å‰²ã‚Šå½“ã¦ã‚‹ã€‚UUIDå€¤ãŒé‡è¤‡ã™ã‚‹ã“ã¨ã¯åŸºæœ¬çš„ã«èµ·ã“ã‚Šå¾—ãªã„ãŸã‚ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ã‚’æº€ãŸã™ã€‚UUIDå€¤ã®ç”Ÿæˆé–¢æ•°ã¯è¨€èªã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨DBãŒã‚ˆã‚Šç–çµåˆã«ã§ãã€Repositoryãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç›¸æ€§ãŒã‚ˆã„ã€‚UUIDå€¤ã¯æ–‡å­—åˆ—ã¨ã—ã¦ç®¡ç†ã•ã‚Œã‚‹ãŸã‚ã€DBã‚¢ã‚¯ã‚»ã‚¹å‡¦ç†ã®è² è·ãŒé«˜ã¾ã£ã¦ã—ã¾ã†ã€‚ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’ç”¨ã„ã¦ã‚½ãƒ¼ãƒˆã§ããªã„ã€‚ ãƒ»è¤‡åˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¯è¤‡æ•°è¨­å®šã§ãã€è¤‡åˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®å ´åˆã€ç‰‡æ–¹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒç•°ãªã‚Œã°ã€ç•°ãªã‚‹ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦è¦‹ãªã•ã‚Œã‚‹ã€‚ ï¼Šä¾‹ï¼Š ãƒ¦ãƒ¼ã‚¶IDã¨æœŸé–“é–‹å§‹æ—¥ä»˜ã‚’è¤‡åˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã™ã‚‹ã¨ã€ä¸€äººã®ãƒ¦ãƒ¼ã‚¶ãŒè¤‡æ•°ã®æœŸé–“ã‚’æŒã¤ã“ã¨ã‚’è¡¨ç¾ã§ãã‚‹ã€‚ user_id period_start_date period_end_date fee_yen 1 2019-04-03 2019-05-03 200 1 2019-10-07 2019-11-07 400 2 2019-10-11 2019-11-11 200 ãƒ»æ¡ç•ªãƒ†ãƒ¼ãƒ–ãƒ« å„ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’çµ±åˆçš„ã«ç®¡ç†ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ¡ç•ªãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã„ã†ã€‚å„ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¯æ¡ç•ªãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å…ƒã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ãŸã‚ã€é€£ç•ªã§ã¯ãªãé£›ã³é£›ã³ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttp://blog.livedoor.jp/sasata299/archives/51280681.html ã‚ã‚‰ã‹ã˜ã‚ã€æœ€åˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿æ‰‹å‹•ã§æŒ¿å…¥ã—ã¦ãŠãã€‚ # æ¡ç•ªãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆã™ã‚‹ã€‚ CREATE TABLE id_sequence (id BIGINT NOT NULL); # æœ€åˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ‰‹å‹•ã§æŒ¿å…¥ã™ã‚‹ã€‚ INSERT INTO id_sequence VALUES (0); CREATEå‡¦ç†æ™‚ã«ã¯ã€äº‹å‰ã«ã€æ¡ç•ªãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ããƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚INSERTæ–‡ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«ã€0ã€ã‚„ã€nullã€ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã®ã§ã¯ãªãã€æ¡ç•ªãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å–å¾—ã—ãŸIDã‚’å‰²ã‚Šå½“ã¦ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ # æ–°ã—ããƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚ UPDATE id_sequence SET id = LAST_INSERT_ID(id + 1); # ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT LAST_INSERT_ID(); åˆ¶ç´„ ãƒ»åˆ¶ç´„ã¨ã¯ DBã«ãŠã„ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®CRUDå‡¦ç†ã«å¯¾ã™ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ã—ã‹ã—ã€å¿…ãšã—ã‚‚åˆ¶ç´„ã‚’ç”¨ã„ã‚‹å¿…è¦ã¯ãªãã€ä»£ã‚ã‚Šã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§å®Ÿè£…ã—ã¦ã‚‚ã‚ˆã„ã€‚ãã®åˆ¶ç´„ã‚’ã€DBã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã„ãšã‚Œã®è²¬å‹™ã¨ã™ã‚‹ã‹ã‚’è€ƒãˆã€ç”¨ã„ã‚‹ã‹å¦ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã€‚ ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã™ã‚‹ã‚«ãƒ©ãƒ ã«ã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ã‚’èª²ã™ã‚ˆã†ã«ã™ã‚‹ã€‚ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼åˆ¶ç´„ã«ã‚ˆã£ã¦ã€Uniqueåˆ¶ç´„ã¨Not Nullåˆ¶ç´„ã®ä¸¡æ–¹ãŒèª²ã•ã‚Œã‚‹ã€‚ ãƒ»Not Nullåˆ¶ç´„ ãƒ¬ã‚³ãƒ¼ãƒ‰ã«æŒ¿å…¥ã•ã‚Œã‚‹å€¤ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’æŒ‡å®šã—ã¦ãŠãã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ‡ãƒ¼ã‚¿å‹ä¸ä¸€è‡´ã‚„Nullã®ãŸã‚ã®ä¾‹å¤–å‡¦ç†ã‚’å®Ÿè£…ã—ãªãã¦ã‚‚ã‚ˆããªã‚‹ã€‚ ãƒ»å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã‚’å‚ç…§ã™ã‚‹å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã‚’ã€å¤–éƒ¨ã‚­ãƒ¼ã€ã¨ã„ã„ã€ã“ã®æ™‚ã«å­ãƒ†ãƒ¼ãƒ–ãƒ«ã«èª²ã™åˆ¶ç´„ã‚’ã€å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã€ã¨ã„ã†ã€‚å­ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã«ã‚ˆã£ã¦ã€è¦ªå­ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã«ä»¥ä¸‹ã®æ•´åˆæ€§ãƒ«ãƒ¼ãƒ«ãŒèª²ã•ã‚Œã‚‹ã€‚ è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®å‚ç…§å…ƒã‚«ãƒ©ãƒ ã«å­˜åœ¨ã—ãªã„å€¤ã¯ã€å­ãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²ã§ããªã„ã€‚ å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤–éƒ¨ã‚­ãƒ¼ãŒå‚ç…§ã™ã‚‹å€¤ãŒã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®å‚ç…§å…ƒã‚«ãƒ©ãƒ ã«å­˜åœ¨ã™ã‚‹å ´åˆã€å‚ç…§å…ƒã‚«ãƒ©ãƒ ã¯å‰Šé™¤ã§ããªã„ã€‚ ï¼Šä¾‹ï¼Š ä¼šç¤¾æƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆè¦ªãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã¨å€‹äººæƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå­ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ãŒã‚ã‚‹ã¨ã™ã‚‹ã€‚å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¼šç¤¾IDã‚«ãƒ©ãƒ ã‚’å¤–éƒ¨ã‚­ãƒ¼ã¨ã—ã¦ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¼šç¤¾IDã‚«ãƒ©ãƒ ã‚’å‚ç…§ã™ã‚‹ã€‚è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®å‚ç…§å…ƒã‚«ãƒ©ãƒ ã«å­˜åœ¨ã—ãªã„IDã¯ã€å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤–éƒ¨ã‚­ãƒ¼ã«ç™»éŒ²ã§ããªã„ã€‚ã¾ãŸã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®å‚ç…§å…ƒã‚«ãƒ©ãƒ ã¯å¤–éƒ¨ã‚­ãƒ¼ã«å‚ç…§ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å‚ç…§å…ƒã‚«ãƒ©ãƒ ã¯å‰Šé™¤ã§ããªã„ã€‚ stored procedure ãƒ»stored procedureã¨ã¯ ã‚ã‚‰ã‹ã˜ã‚ä¸€é€£ã®SQLæ–‡ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ ¼ç´ã—ã¦ãŠãã€Callæ–‡ã§å‘¼ã³å‡ºã™æ–¹å¼ã€‚ ãƒ»ä½¿ã„æ–¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š SELECTæ–‡ã®stored procedureã‚’ä½œæˆã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ -- PROCEDUREã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸æ ¼ç´ã—ã¦ãŠãã€‚ CREATE PROCEDURE SelectContact AS SELECT { ã‚«ãƒ©ãƒ å } FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } -- PROCEDUREã‚’å®Ÿè¡Œ EXEC SelectContact ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ DBã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã€‚ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸã„ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ•°ã ã‘ã€ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’é€£ã­ã‚‹ $ mysqldump --force -u \"{ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ }\" -p -h \"{ DBã®ãƒ›ã‚¹ãƒˆ }\" \"{ DBå }\" \"{ ãƒ†ãƒ¼ãƒ–ãƒ«å1 }\" \"{ ãƒ†ãƒ¼ãƒ–ãƒ«å2 }\" > table.sql ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ DBã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚forceã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã‚‚å¼·åˆ¶çš„ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€‚ $ mysql --force -u \"{ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ }\" -p -h \"{ DBã®ãƒ›ã‚¹ãƒˆ }\" \"{ DBå }\" ãƒ‡ãƒ¼ã‚¿å‹ ãƒ»æ•°å€¤å‹ æ•´æ•°å€¤ãŒã©ã®ãã‚‰ã„å¢—ãˆã‚‹ã‹ã«ã‚ˆã£ã¦ã€3ã¤ã‚’ä½¿ã„åˆ†ã‘ã‚‹ã€‚ç¬¦å·ãªã—ï¼ˆUnsignedï¼‰ã‚’æœ‰åŠ¹åŒ–ã—ãŸå ´åˆã€ãƒã‚¤ãƒŠã‚¹å€¤ã‚’ä½¿ç”¨ã—ãªããªã£ãŸåˆ†ã€ä½¿ç”¨å¯èƒ½ãªãƒ—ãƒ©ã‚¹å€¤ãŒå¢—ãˆã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿å‹ å€¤ ç¬¦å·ãªã—ï¼ˆUnsignedï¼‰ã‚’æœ‰åŠ¹åŒ–ã—ãŸå ´åˆ TINYINT -128~ +127 0~ +255 INT 2147483648~ +2147483647 0~ +4294967295 BIGINT -9223372036854775808~ +9223372036854775807 0~ +18446744073709551615 ãƒ»æ–‡å­—åˆ—å‹ æ–‡å­—æ•°ãŒã©ã®ãã‚‰ã„å¢—ãˆã‚‹ã‹ã«ã‚ˆã£ã¦ã€3ã¤ã‚’ä½¿ã„åˆ†ã‘ã‚Œã°è‰¯ã„ã€‚ ãƒ‡ãƒ¼ã‚¿å‹ æœ€å¤§ãƒã‚¤ãƒˆæ•° VARCHAR(M) 255 TEXT 65535 MEDIUMTEXT 16777215 Collationï¼ˆç…§åˆé †åºï¼‰ ãƒ»æ–‡å­—åˆ—å‹ã®ç…§åˆé †åºã¨ã¯ æ–‡å­—åˆ—å‹ã®ã‚«ãƒ©ãƒ ã«é–¢ã—ã¦ã€WHEREå¥ã®æ¯”è¼ƒã«ãŠã‘ã‚‹å€¤ã®ç‰¹å®šã€ORDER BYå¥ã«ãŠã‘ã‚‹ä¸¦ã³æ›¿ãˆã®æ˜‡é †é™é †ã€JOINå¥ã«ãŠã‘ã‚‹çµåˆã€GROUP BYã«ãŠã‘ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ã‚«ãƒ©ãƒ ï¼ãƒ†ãƒ¼ãƒ–ãƒ«ï¼DBå˜ä½ã§è¨­å®šã§ãã€æ¯”è¼ƒã™ã‚‹ã‚«ãƒ©ãƒ åŒå£«ã§ã¯åŒã˜ç…§åˆé †åºãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://johobase.com/sqlserver-where-collate/ ãƒ»ç¨®é¡ å¯¿å¸ã¨ãƒ“ãƒ¼ãƒ«ã®çµµæ–‡å­—ãŒåŒºåˆ¥ã•ã‚Œãªã„ã“ã¨ã‚’ã€å¯¿å¸ãƒ“ãƒ¼ãƒ«å•é¡Œã€ã¨ã„ã†ã€‚å¤§æ–‡å­—Aã¨å°æ–‡å­—aã‚’åŒºåˆ¥ã—ãªã„ã“ã¨ã¯ã€CIï¼šCase Insensitiveã¨è¡¨ç¾ã•ã‚Œã€ç…§åˆé †åºåã«ã‚‚ç‰¹å¾´ã¨ã—ã¦CIã®æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã€‚ ç…§åˆé †åºå Aï¼a ï¼:beer: ã¯ï¼ã±ï¼ã° ã‚„ï¼ã‚ƒ utf8mb4_unicode_ci = = = = utf8mb4_unicode_520_ci = â‰  = = utf8mb4_general_ci = = â‰  â‰  utf8mb4_bin â‰  â‰  â‰  â‰  04. ãƒ¦ãƒ¼ã‚¶ã®ç®¡ç† CREATE ãƒ»ãƒ¦ãƒ¼ã‚¶ä½œæˆ CREATE USER \"{ ãƒ¦ãƒ¼ã‚¶å }\" IDENTIFIED BY \"{ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ }\"; ãƒ»ãƒ¦ãƒ¼ã‚¶ä¸€è¦§ ã“ã“ã§è¡¨ç¤ºã•ã‚Œã‚‹ç‰¹æ¨©ã¨ã€‚ALLç‰¹æ¨©ã¯ç•°ãªã‚‹ã€‚ SELECT * FROM mysql.user; DROP ãƒ»ãƒ¦ãƒ¼ã‚¶å‰Šé™¤ -- ãƒ¦ãƒ¼ã‚¶åˆ¥ã®ãƒ›ã‚¹ãƒˆåã®ç¢ºèª SELECT * FROM mysql.user; -- ãƒ›ã‚¹ãƒˆãŒã€%ã€ã ã£ãŸå ´åˆ DROP USER { ãƒ¦ãƒ¼ã‚¶å }@`%`; GRANT ãƒ»å…¨ã¦ã®æ“ä½œæ¨©é™ã‚’ä»˜ä¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã¯ã€ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã†å¿…è¦ãŒç„¡ã„ã€‚å…¨æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹å ´åˆã€PRIVILEGESã¯çœç•¥ã§ãã‚‹ãŒã€å³å¯†ã«ã¯çœç•¥ã—ãªã„ã‚ˆã†ã»ã†ãŒã‚ˆã„ã€‚ -- å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é–¢ã™ã‚‹æ¨©é™ã‚’ä»˜ä¸ GRANT ALL PRIVILEGES ON *.* TO \"{ ãƒ¦ãƒ¼ã‚¶å }\"; -- Amazon Auroraã¾ãŸã¯RDSã®å ´åˆã¯ã“ã¡ã‚‰ GRANT ALL PRIVILEGES ON `%`.* TO \"{ ãƒ¦ãƒ¼ã‚¶ãƒ¼å }\"; -- Amazon Auroraã‚‚åŒã˜ã -- ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é–¢ã™ã‚‹å…¨æ¨©é™ã‚’ä»˜ä¸ GRANT ALL PRIVILEGES ON {DBå}.* TO \"{ ãƒ¦ãƒ¼ã‚¶å }\"; ãƒ»ä¸€éƒ¨ã®æ“ä½œæ¨©é™ã‚’ä»˜ä¸ ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é–¢ã™ã‚‹èª­ã¿å‡ºã—æ¨©é™ã®ã¿ä»˜ä¸ã™ã‚‹ã€‚ GRANT SELECT ON {DBå}.* TO \"{ ãƒ¦ãƒ¼ã‚¶å }\"; ãƒ»ãƒ¦ãƒ¼ã‚¶æ¨©é™ä¸€è¦§ ãƒ¦ãƒ¼ã‚¶ã«ä»˜ä¸ã•ã‚Œã¦ã„ã‚‹æ¨©é™ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ SHOW GRANTS FOR \"{ ãƒ¦ãƒ¼ã‚¶å }\"; ä½œæˆã—ãŸã ã‘ã§æ¨©é™ã‚’ä½•ã‚‚ä»˜ä¸ã—ã¦ãªã„ãƒ¦ãƒ¼ã‚¶ã®å ´åˆã€ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒå†…ã®å…¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é–¢ã—ã¦ã€å…¨æ¨©é™ãªã—ã€ã‚’è¡¨ã™USAGEã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã€‚ GRANT USAGE ON *.* TO \"{ ãƒ¦ãƒ¼ã‚¶ãƒ¼å }\"; ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ“ä½œæ¨©é™ã‚’ä¸ãˆã‚‹ã¨ã€ä¸Šè¨˜ã«åŠ ãˆã¦ã€ä»˜ä¸ã—ãŸGRANTæ¨©é™ã‚‚è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ REVOKE ãƒ»å…¨æ¨©é™å‰Šé™¤ å…¨æ¨©é™ã‚’å‰Šé™¤ã—ã€GRANTæ¨©é™ã‚’USAGEã«æˆ»ã™ã€‚ -- Amazon Auroraã¾ãŸã¯RDSã®å ´åˆ REVOKE ALL PRIVILEGES ON `%`.* FROM \"{ ãƒ¦ãƒ¼ã‚¶å }\"; REVOKE ALL PRIVILEGES ON { DBå }.* FROM \"{ ãƒ¦ãƒ¼ã‚¶å }\"; ãƒ»ãƒ¦ãƒ¼ã‚¶åå¤‰æ›´ RENAME USER \"{ å¤ã„ãƒ¦ãƒ¼ã‚¶å }\" TO \"{ æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶å }\"; 04-02. ãƒ¦ãƒ¼ã‚¶ã®æº–å‚™æ‰‹é † 1. ãƒ¦ãƒ¼ã‚¶ã®ä½œæˆ CREATEã§ä»¥ä¸‹ã®ï¼”ç¨®é¡ã‚’ä½œæˆã™ã‚‹ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ã€ä¾‹ãˆã°8æ–‡å­—ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ CREATE USER \"{ ãƒ¦ãƒ¼ã‚¶å }\" IDENTIFIED BY \"{ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ }\"; ãƒ¦ãƒ¼ã‚¶ã®ç¨®é¡ ä¾‹ è£œè¶³ ãƒ«ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶ root DBã®æ§‹ç¯‰æ™‚ã«rootãƒ¦ãƒ¼ã‚¶ãŒè‡ªå‹•ä½œæˆã•ã‚Œã‚‹å ´åˆã¯ä¸è¦ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ foo_app èª­ã¿å‡ºã—ï¼æ›¸ãè¾¼ã¿ãƒ¦ãƒ¼ã‚¶ foo_user èª­ã¿å‡ºã—ã®ã¿ãƒ¦ãƒ¼ã‚¶ foo_readonly_user 2. ãƒ¦ãƒ¼ã‚¶ã¸ã®æ¨©é™ä»˜ä¸ ãƒ»ãƒ«ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶ ãƒ«ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶ã«ã¯ã€æœ€åˆã‹ã‚‰å…¨ã¦ã®DBã«å¯¾ã—ã¦æ¨©é™ã‚’ä»˜ä¸ã•ã‚Œã¦ãŠã‚Šä¸è¦ã€‚ ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ç”¨ã„ã‚‹DBã«å¯¾ã™ã‚‹å…¨æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ã€‚ -- DBåã‚’ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã†å¿…è¦ã¯ãªã„ GRANT ALL PRIVILEGES ON {DBå}.* TO '{ ãƒ¦ãƒ¼ã‚¶ãƒ¼å }' ãƒ»èª­ã¿å‡ºã—ï¼æ›¸ãè¾¼ã¿ãƒ¦ãƒ¼ã‚¶ ç”¨ã„ã‚‹DBã«å¯¾ã™ã‚‹å…¨æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ã€‚ -- DBåã‚’ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã†å¿…è¦ã¯ãªã„ GRANT ALL PRIVILEGES ON {DBå}.* TO '{ ãƒ¦ãƒ¼ã‚¶ãƒ¼å }' ãƒ»èª­ã¿å‡ºã—ã®ã¿ãƒ¦ãƒ¼ã‚¶ ç”¨ã„ã‚‹DBã«å¯¾ã™ã‚‹SELECTæ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ã€‚ -- DBåã‚’ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã†å¿…è¦ã¯ãªã„ GRANT SELECT ON {DBå}.* TO '{ ãƒ¦ãƒ¼ã‚¶å }'; 05. ãƒ¬ã‚³ãƒ¼ãƒ‰ã®èª­ã¿å‡ºã—ï¼šREAD ã¯ã˜ã‚ã« ãƒ»å¥ã®å‡¦ç†ã®é †ç•ª FROM ---> JOIN ---> WHERE ---> GROUP BY ---> HAVING ---> SELECT ---> ORDER BY SELECTå¥ ãƒ»ãªã— æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã‚’å–å¾—ã™ã‚‹ã€‚MySQLã§ã¯ã€å–å¾—çµæœã«æ¨™æº–ã®ä¸¦ã³é †ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æ˜‡é †ã§å–å¾—ã—ãŸã„å ´åˆã¯ã€ORDER BYå¥ã‚’ç”¨ã„ã¦ã€æ˜ç¤ºçš„ã«ä¸¦ã³æ›¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.quora.com/What-is-the-default-order-of-records-for-a-SELECT-statement-in-MySQL SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; ãƒ»SUMé–¢æ•° æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã®åˆè¨ˆã‚’å–å¾—ã™ã‚‹ã€‚ SELECT SUM({ ã‚«ãƒ©ãƒ å }) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; ãƒ»AVGé–¢æ•° æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã®å¹³å‡å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT AVG({ ã‚«ãƒ©ãƒ å }) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; ãƒ»MINé–¢æ•° æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã®æœ€å°å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT MIN({ ã‚«ãƒ©ãƒ å }) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; ãƒ»MAXé–¢æ•° æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã®æœ€å¤§å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT MAX({ ã‚«ãƒ©ãƒ å }) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; ãƒ»COUNTé–¢æ•° æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã®å€‹æ•°ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT { ã‚«ãƒ©ãƒ å } COUNT(*) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; â€»æ¶ˆå»æ³•ã®å°æŠ€ï¼šé›†åˆé–¢æ•°ã‚’å…¥ã‚Œå­çŠ¶ã«ã¯ã§ããªã„ ï¼Šå®Ÿè£…ä¾‹ï¼Š é›†åˆé–¢æ•°ã‚’é›†åˆé–¢æ•°ã®ä¸­ã«å…¥ã‚Œå­çŠ¶ã«ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚ -- SELECT AVG(SUM({ ã‚«ãƒ©ãƒ å })) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€å€¤ç„¡ã—ã‚‚å«ã‚€ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT { ã‚«ãƒ©ãƒ å } COUNT(*) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å }; æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€å€¤ç„¡ã—ã‚’é™¤ã„ãŸã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT { ã‚«ãƒ©ãƒ å } COUNT(*); ãƒ»LAST_INSERT_IDé–¢æ•° ä»»æ„ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æœ€å¾Œã«æŒ¿å…¥ã•ã‚ŒãŸIDã‚’èª­ã¿å‡ºã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æŒ‡å®šã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ SELECT LAST_INSERT_ID(); ãƒ»MD5é–¢æ•° æ–‡å­—åˆ—ã‚’ãƒãƒƒã‚·ãƒ¥åŒ– SELECT MD5(\"xxxxx\"); CASEå¥ ã‚«ãƒ©ãƒ 1ãŒtrueã ã£ãŸã‚‰ã€ã‚«ãƒ©ãƒ 2ã‚’å–å¾—ã™ã‚‹ã€‚falseã§ã‚ã£ãŸã‚‰ã€ã‚«ãƒ©ãƒ 3ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT CASE WHEN { ã‚¨ã‚¤ãƒªã‚¢ã‚¹ }.{ ã‚«ãƒ©ãƒ å1 } = 1 THEN { ã‚¨ã‚¤ãƒªã‚¢ã‚¹ }.{ ã‚«ãƒ©ãƒ å2 } ELSE { ã‚¨ã‚¤ãƒªã‚¢ã‚¹ }.{ ã‚«ãƒ©ãƒ å3 } END AS name FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } AS { ã‚¨ã‚¤ãƒªã‚¢ã‚¹ }; FROMå¥ ãƒ»JOINå¥ã®ç¨®é¡ ãƒ»LEFT JOINï¼ˆå·¦å¤–éƒ¨çµåˆï¼‰ ã€usersã€ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã€itemsã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®å•†å“IDãŒä¸€è‡´ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã¨ã€å…ƒã¨ãªã‚‹ã€usersã€ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã—ã‹å­˜åœ¨ã—ãªã„ãƒ‡ãƒ¼ã‚¿ãŒã€ã‚»ãƒƒãƒˆã§å–å¾—ã•ã‚Œã‚‹ã€‚ ãƒ»INNER JOINï¼ˆå†…éƒ¨çµåˆï¼‰ åŸºæœ¬æƒ…å ±æŠ€è¡“è€…è©¦é¨“ã§ã¯ã€å†…éƒ¨çµåˆï¼ˆAâˆ©Bï¼‰ã—ã‹å‡ºé¡Œã•ã‚Œãªã„ã€‚ ãƒ»å†…éƒ¨çµåˆã«WHEREã‚’ç”¨ã„ã‚‹å ´åˆ 2ã¤ã®WHEREæ–‡ãŒã€ANDã§çµã³ã¤ã‘ã‚‰ã‚Œã¦ã„ã‚‹æ™‚ã€ã¾ãšä¸€ã¤ç›®ã®WHEREã‚’æº€ãŸã™ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ãŸå¾Œã€å–å¾—ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä¸­ã‹ã‚‰ã€äºŒã¤ç›®ã®WHEREã‚’æº€ãŸã™ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š -- ã€ã‚«ãƒ©ãƒ ã€ã ã‘ã§ãªãã€ã©ã®ã€è¡¨ã€ãªã®ç‰©ãªã®ã‹ã‚‚æŒ‡å®š SELECT { ãƒ†ãƒ¼ãƒ–ãƒ«å1 }.{ ã‚«ãƒ©ãƒ å1 }, -- è¤‡æ•°ã®è¡¨ã‚’æŒ‡å®š FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å1 }, { ãƒ†ãƒ¼ãƒ–ãƒ«å2 }, -- ã¾ãšã€1ã¤ç›®ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨2ã¤ç›®ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒåŒã˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã€‚ WHERE -- æ¬¡ã«ã€ä¸Šè¨˜ã§å–å¾—ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã†ã¡ã€æ¬¡ã®æ¡ä»¶ã‚‚æº€ãŸã™ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿ã‚’å–å¾—ã™ã‚‹ã€‚ { ãƒ¬ã‚³ãƒ¼ãƒ‰å1 } = { ãƒ¬ã‚³ãƒ¼ãƒ‰å2 } AND { ãƒ¬ã‚³ãƒ¼ãƒ‰å2 } = { ãƒ¬ã‚³ãƒ¼ãƒ‰å3 } ãƒ»å†…éƒ¨çµåˆã«INNER JOIN ONã‚’ç”¨ã„ã‚‹å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š -- ã€ã‚«ãƒ©ãƒ ã€ã ã‘ã§ãªãã€ã©ã®ã€è¡¨ã€ãªã®ç‰©ãªã®ã‹ã‚‚æŒ‡å®š SELECT { ãƒ†ãƒ¼ãƒ–ãƒ«å1 }.{ ã‚«ãƒ©ãƒ å1 }, -- è¤‡æ•°ã®è¡¨ã‚’æŒ‡å®š FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å1 } -- 2ã¤ç›®ã®è¡¨ã®ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã€ã¨ç…§åˆ INNER JOIN { ãƒ†ãƒ¼ãƒ–ãƒ«å2 } ON { ãƒ†ãƒ¼ãƒ–ãƒ«å1 }.{ ã‚«ãƒ©ãƒ å1 } = { ãƒ†ãƒ¼ãƒ–ãƒ«å2 }.{ ã‚«ãƒ©ãƒ å2 } -- 3ã¤ç›®ã®è¡¨ã®ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã€ã¨ç…§åˆ INNER JOIN { ãƒ†ãƒ¼ãƒ–ãƒ«å3 } ON { ãƒ†ãƒ¼ãƒ–ãƒ«å1 }.{ ã‚«ãƒ©ãƒ å1 } = { ãƒ†ãƒ¼ãƒ–ãƒ«å3 }.{ ã‚«ãƒ©ãƒ å3 } ORDER BYå¥ ãƒ»ä½¿ã„æ–¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š $order) { switch ($key) { case \"id\": return sprintf(\"ss.id %s\", $order); } } } // INå¥é †ã®å ´åˆ return sprintf(\"FIELD(ss.id, %s)\", $idList); }); $sql = INå¥ã€ANYå¥ã®é•ã„ ãƒ»INå¥ã®ä½¿ã„æ–¹ æŒ‡å®šã—ãŸå€¤ã¨åŒã˜ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€æŒ‡å®šã—ãŸå€¤ã®ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ã‚«ãƒ©ãƒ å } in (xxx, xxx,...); æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€æŒ‡å®šã—ãŸå€¤ä»¥å¤–ã®ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ã‚«ãƒ©ãƒ å } not in ({ ãƒ¬ã‚³ãƒ¼ãƒ‰å1 }, { ãƒ¬ã‚³ãƒ¼ãƒ‰å2 },...); æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€SELECTã§èª­ã¿å‡ºã—ãŸå€¤ä»¥å¤–ã®ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ã‚«ãƒ©ãƒ å } not in ( -- SELECT { ã‚«ãƒ©ãƒ å } FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ãƒ¬ã‚³ãƒ¼ãƒ‰å } >= 160 ); ã€INå¥ã‚’ä½¿ç”¨ã—ãªã‹ã£ãŸå ´åˆã€‘ SELECT * FROM fruit WHERE name = \"ã¿ã‹ã‚“\" OR name = \"ã‚Šã‚“ã”\"; ã€INå¥ã‚’ç”¨ã„ãŸå ´åˆã€‘ SELECT * FROM fruit WHERE name IN(\"ã¿ã‹ã‚“\", \"ã‚Šã‚“ã”\"); ãƒ»ANYå¥ã®ä½¿ã„æ–¹ æ›¸ãæ–¹ãŒç•°ãªã‚‹ã ã‘ã§ã€inã¨åŒã˜å‡ºåŠ› SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ã‚«ãƒ©ãƒ å } = ANY(xxx, xxx, xxx); GROUP BYå¥ ãƒ»ä½¿ã„æ–¹ ã‚«ãƒ©ãƒ ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã€é›†åˆé–¢æ•°ã‚’ç”¨ã„ã¦ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã‚’è¨ˆç®—ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã®å¹³å‡å€¤ã‚’ç®—å‡ºã™ã‚‹ã€‚ SELECT { ã‚«ãƒ©ãƒ å1 }, AVG({ ã‚«ãƒ©ãƒ å2 }) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } GROUP BY { ã‚«ãƒ©ãƒ å1 }; HAVINGå¥ ãƒ»ä½¿ã„æ–¹ å„å¥ã®å‡¦ç†ã®é †ç•ªã‹ã‚‰è€ƒæ…®ã—ã¦ã€GROUP BYã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãŸçµæœã‹ã‚‰ã€HAVINGã§ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚SELECTã«ãŠã‘ã‚‹é›†è¨ˆé–¢æ•°ãŒã€HAVINGã«ãŠã‘ã‚‹é›†è¨ˆé–¢æ•°ã®çµæœã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã›ã‚ˆã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š -- HAVINGã«ã‚ˆã‚‹é›†è¨ˆçµæœã‚’æŒ‡å®šã—ã¦å‡ºåŠ›ã€‚ SELECT { ã‚«ãƒ©ãƒ å1 }, COUNT({ ã‚«ãƒ©ãƒ å2 }) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } GROUP BY -- ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãŸçµæœã‚’é›†è¨ˆã—ã€ï¼’å€‹ä»¥ä¸Šã®ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ { ã‚«ãƒ©ãƒ å1 } HAVING COUNT(*) >= 2; â€»ä»¥ä¸‹ã®å ´åˆã€GROUP BY + HAVINGã‚’ä½¿ã£ã¦ã‚‚ã€WHEREã‚’ä½¿ã£ã¦ã‚‚ã€åŒã˜å‡ºåŠ›çµæœã«ãªã‚‹ã€‚ SELECT { ã‚«ãƒ©ãƒ å } FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } GROUP BY { ã‚«ãƒ©ãƒ å } HAVING { ãƒ¬ã‚³ãƒ¼ãƒ‰å }; SELECT { ã‚«ãƒ©ãƒ å } FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ãƒ¬ã‚³ãƒ¼ãƒ‰å } GROUP BY { ã‚«ãƒ©ãƒ å }; WILDCARDå¥ ãƒ»ä½¿ã„æ–¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ã‚«ãƒ©ãƒ å } LIKE \"%å–¶æ¥­\"; SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ã‚«ãƒ©ãƒ å } LIKE \"_å–¶æ¥­\"; BETWEENå¥ ãƒ»ä½¿ã„æ–¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã§ã€1ä»¥ä¸Š10ä»¥ä¸‹ã®ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’å–å¾—ã™ã‚‹ã€‚ SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } BETWEEN 1 AND 10; SETå¥ ãƒ»ä½¿ã„æ–¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š SET @A = { ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ }; SET @B = { ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ }; UPDATE { ãƒ†ãƒ¼ãƒ–ãƒ«å } SET { ã‚«ãƒ©ãƒ å } = @A, WHERE { ã‚«ãƒ©ãƒ å } = @B; ã‚µãƒ–ã‚¯ã‚¨ãƒª ãƒ»ä½¿ã„æ–¹ æ›ã‘ç®—ã¨åŒæ§˜ã«ã€æ‹¬å¼§å†…ã‹ã‚‰å…ˆã«å‡¦ç†ã‚’è¡Œã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š -- Main-query SELECT * FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } WHERE { ã‚«ãƒ©ãƒ å } != ( -- Sub-query SELECT max({ ã‚«ãƒ©ãƒ å }) FROM { ãƒ†ãƒ¼ãƒ–ãƒ«å } ); ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã¯ ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ç‰¹å®šã®ã‚«ãƒ©ãƒ ã ã‘ã‚’æŠœãå‡ºã—ã€æ¤œç´¢ã—ã‚„ã™ã„ã‚ˆã†ã«ä¸¦ã³æ›¿ãˆã€åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã—ã¦ãŠã„ãŸã‚‚ã®ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ä¿å­˜ã•ã‚ŒãŸã‚«ãƒ©ãƒ ã‹ã‚‰ç‰¹å®šã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç›´æ¥å–å¾—ã§ãã‚‹ãŸã‚ã€SQLã®å®Ÿè¡Œæ™‚é–“ãŒã‚«ãƒ©ãƒ æ•°ã«ä¾å­˜ã—ãªããªã‚‹ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€SQLã®å®Ÿè¡Œæ™‚ã«å…¨ã¦ã‚«ãƒ©ãƒ ã‚’å–å¾—ã™ã‚‹ãŸã‚ã€å®Ÿè¡Œæ™‚é–“ãŒãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ æ•°ã«ä¾å­˜ã—ã¦ã—ã¾ã†ã€‚ å‚è€ƒï¼šhttps://qiita.com/towtow/items/4089dad004b7c25985e3 ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚ã‚‹ã„ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼ã®ã‚«ãƒ©ãƒ ã‚’åŸºæº–ã«ã—ã¦ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã‚’ä¸¦ã³æ›¿ãˆãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã“ã¨ã€‚ CREATE INDEX foo_index ON foo_table (id) ãƒ»ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚ã‚‹ã„ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼ã§ã¯ãªã„ã‚«ãƒ©ãƒ ã‚’åŸºæº–ã«ã—ã¦ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã‚’ä¸¦ã³æ›¿ãˆãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã“ã¨ã€‚ CREATE INDEX foo_index ON foo_table (foo_column) ãƒ»è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ è¤‡æ•°ã®ã‚«ãƒ©ãƒ ã‚’åŸºæº–ã«ã—ã¦ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä¸¦ã³æ›¿ãˆãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã“ã¨ã€‚å¯¾è±¡ã¨ã—ãŸã‚«ãƒ©ãƒ ã”ã¨ã«ç•°ãªã‚‹å€¤ã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãŒè¨ˆæ¸¬ã•ã‚Œã€ã“ã®æ•°ãŒå°‘ãªã„ï¼ˆä¸€æ„ã®å€¤ã®å¤šã„ï¼‰ã‚«ãƒ©ãƒ ãŒæ¤œå‡ºã•ã‚Œã‚‹ã€‚ãã—ã¦ã€ã‚«ãƒ©ãƒ ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ˜‡é †ã§ä¸¦ã³æ›¿ãˆã‚‰ã‚Œã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ä¿å­˜ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/towtow/items/4089dad004b7c25985e3 CREATE INDEX foo_index ON foo_table (foo_column, bar_column, ...) ï¼Šä¾‹ï¼Š ä»¥ä¸‹ã®ã‚ˆã†ãªfooãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚Šã€nameã‚«ãƒ©ãƒ ã¨addressã‚«ãƒ©ãƒ ã‚’åŸºæº–ã«ä¸¦ã³æ›¿ãˆãŸfoo_indexã¨ã„ã†è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åã‚’ä½œæˆã™ã‚‹ã€‚ CREATE INDEX foo_index ON foo_table (name, address) id name address old 1 Suzuki Tokyo 24 2 Yamada Osaka 18 3 Takahashi Nagoya 18 4 Honda Tokyo 16 5 Endou Tokyo 24 å„ã‚«ãƒ©ãƒ ã§å€¤ã®ç•°ãªã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãŒè¨ˆæ¸¬ã•ã‚Œã€nameã‚«ãƒ©ãƒ ã¯addressã‚«ãƒ©ãƒ ã‚ˆã‚Šã‚‚ä¸€æ„ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå¤šã„ãŸã‚ã€nameã‚«ãƒ©ãƒ ã®æ˜‡é †ï¼ˆã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ï¼‰ã«ä¸¦ã³æ›¿ãˆã‚‰ã‚Œã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ä¿å­˜ã•ã‚Œã‚‹ã€‚ id name address old 5 Endou Tokyo 24 4 Honda Tokyo 18 1 Suzuki Tokyo 24 3 Takahashi Nagoya 18 2 Yamada Osaka 18 EXPLAINå¥ ãƒ»ä½¿ã„æ–¹ è¨­å®šã—ãŸSELECTå¥ãŒä»®ã«å®Ÿè¡Œã•ã‚ŒãŸå ´åˆã€ã„ãšã‚Œã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã„ãšã‚Œã®ã‚«ãƒ©ãƒ ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ãªã‚‹ã‹ï¼ˆå®Ÿè¡Œè¨ˆç”»ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ã¾ãŸã€æƒ³å®šå®Ÿè¡Œæ™‚é–“ã‚‚æ¤œå‡ºã§ãã‚‹ãŸã‚ã€ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã®æ¤œå‡ºã«å½¹ç«‹ã¤ã€‚ å‚è€ƒï¼šhttps://dev.mysql.com/doc/refman/5.7/en/explain-output.html EXPLAIN SELECT * FROM t1, t2 WHERE t1.c1 = 1 AND t1.c2 = t2.c3 *************************** 1. row *************************** id: 1 select_type: SIMPLE table: t1 type: ref possible_keys: index_t1_on_c1_and_c2 key: index_t1_on_c1_and_c2 key_len: 5 ref: const rows: 10 Extra: Using where; Using index *************************** 2. row *************************** id: 1 select_type: SIMPLE table: t2 type: ref possible_keys: index_t2_on_c3 key: index_t2_on_c3 key_len: 5 ref: sample.t1.c2 rows: 1 Extra: Using index ãƒ»select_type SQLã®ç¨®é¡ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ã‚µãƒ–ã‚¯ã‚¨ãƒªã‚’å«ã¾ãªã„SQLã¯SIMPLEã¨ãªã‚Šã€ã‚µãƒ–ã‚¯ã‚¨ãƒªã‚’å«ã‚€ã¨ã€ã‚µãƒ–ã‚¯ã‚¨ãƒªã®ç¨®é¡ã«å¿œã˜ã¦ã€PRIMARYã€SUBQUERYã€DEPENDENT SUBQUERYã€UNCACHEABLE SUBQUERYã€DERIVEDã€ã®ã„ãšã‚Œã‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ ãƒ»table è¨­å®šã—ãŸSELECTå¥ãŒã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«åãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ ãƒ»type è¨­å®šã—ãŸSELECTå¥ãŒãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ™‚ã«ã€ã©ã®ç¨‹åº¦ã®æ•°ã®ã‚«ãƒ©ãƒ ã‚’æ¤œç´¢ã™ã‚‹ã®ã‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚æ¤œç´¢ã™ã‚‹ã‚«ãƒ©ãƒ ãŒå¤šã„SQLã»ã©ã€æƒ³å®šå®Ÿè¡Œæ™‚é–“ãŒé•·ããªã‚‹ã€‚ ç¨®é¡ æ¡ä»¶ æ¤œç´¢ã™ã‚‹ã‚«ãƒ©ãƒ æ•° è£œè¶³ ALL ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã¦ã„ãªã„ã€‚ å…¨ã¦ã®ã‚«ãƒ©ãƒ  å…¨ã¦ã®ã‚«ãƒ©ãƒ ã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã€å®Ÿè¡Œæ™‚é–“ãŒæœ€ã‚‚é•·ãã€æ”¹å–„ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ index ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã¦ã„ãªã„ã€‚ å…¨ã¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚«ãƒ©ãƒ  range ãƒ»ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ãƒ»WHEREå¥ã«é‡è¤‡ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã€INå¥ã€BETWEENå¥ã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ ç‰¹å®šã®è¤‡æ•°ã‚«ãƒ©ãƒ  ref ãƒ»ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ãƒ»WHEREå¥ã«é‡è¤‡ã—ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ ç‰¹å®šã®è¤‡æ•°ã‚«ãƒ©ãƒ  eq_ref ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ ä¸€ã¤ã®ã‚«ãƒ©ãƒ  ä¸€ã¤ã®ã‚«ãƒ©ãƒ ã—ã‹fetchã—ãªã„ãŸã‚ã€JOINå¥ã‚’ç”¨ã„ãŸã‚¢ã‚¯ã‚»ã‚¹ã®ä¸­ã§ã€å®Ÿè¡Œæ™‚é–“ãŒæœ€ã‚‚çŸ­ã„ã€‚ const ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ãƒ»JOINå¥ã‚’ç”¨ã„ã¦ã„ãªã„ã€‚ ä¸€ã¤ã®ã‚«ãƒ©ãƒ  ä¸€ã¤ã®ã‚«ãƒ©ãƒ ã—ã‹fetchã—ãªã„ãŸã‚ã€å®Ÿè¡Œæ™‚é–“ãŒæœ€ã‚‚çŸ­ã„ã€‚ ãƒ»possible_keys ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦è¨­å®šã•ã‚ŒãŸã‚«ãƒ©ãƒ ã®ã†ã¡ã§ã€å®Ÿéš›ã«åˆ©ç”¨å¯èƒ½ãªã‚‚ã®ã®ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ Tips ãƒ»å„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®¹é‡ã®ç¢ºèª SELECT table_schema, sum(data_length) / 1024 / 1024 AS mb FROM information_schema.tables GROUP BY table_schema ORDER BY sum(data_length + index_length) DESC; ãƒ»ã‚«ãƒ©ãƒ ã®æ¤œç´¢ SELECT table_name, column_name FROM information_schema.columns WHERE column_name = { æ¤œç´¢ã—ãŸã„ã‚«ãƒ©ãƒ å } AND table_schema = { æ¤œç´¢å¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å } ãƒ»æœ€é©ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œå‡º ãƒ¬ã‚³ãƒ¼ãƒ‰ã®çªãåˆã‚ã›å‡¦ç†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ãƒ»çªãåˆã‚ã›å‡¦ç†ã¨ã¯ ãƒ“ã‚¸ãƒã‚¹ã®åŸºç›¤ã¨ãªã‚‹ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆå•†å“ãƒ‡ãƒ¼ã‚¿ã€å–å¼•å…ˆãƒ‡ãƒ¼ã‚¿ãªã©ï¼‰ã¨ã€æ—¥ã€…æ›´æ–°ã•ã‚Œã‚‹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆè²©å£²å±¥æ­´ã€å…¥é‡‘å±¥æ­´ãªã©ï¼‰ã‚’çªãåˆã‚ã›ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹å‡¦ç†ã®ã“ã¨ã€‚ ãƒ»ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ãƒ»å…·ä½“ä¾‹ ã¨ã‚ã‚‹ç”Ÿå‘½ä¿é™ºä¼šç¤¾ã§ã¯ã€é¡§å®¢ã®ä¿é™ºå¥‘ç´„ãƒ‡ãƒ¼ã‚¿ã‚’å¥‘ç´„ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã€ã¾ãŸãã‚Œã¨ã¯åˆ¥ã«ã€ä¿é™ºå¥‘ç´„ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ç‚¹ï¼ˆç•°å‹•äº‹ç”±ï¼‰ã‚’ç•°å‹•ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã€ç®¡ç†ã—ã¦ã„ã‚‹ã€‚æ¯æ—¥ã€å¥‘ç´„ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ç•°å‹•ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹å‰æ—¥ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’çªãåˆã‚ã›ã€å„å¥‘ç´„ã®ç•°å‹•äº‹ç”±ã«å¿œã˜ã¦ã€å¤‰æ›´å¾Œå¥‘ç´„ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã€æ–°å¥‘ç´„ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒ¿å…¥ã™ã‚‹ã€‚ å‰å‡¦ç†ã¨ã—ã¦ã€å¥‘ç´„ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨ç•°å‹•ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã«å…±é€šã™ã‚‹è­˜åˆ¥å­ãŒåŒã˜é †ç•ªã§ä¸¦ã‚“ã§ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å¥‘ç´„ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã®1è¡Œç›®ã¨ã€ç•°å‹•ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®1è¡Œç›®ã®è­˜åˆ¥å­ã‚’çªãåˆã‚ã›ã‚‹ã€‚ã€å¥‘ç´„ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ = ç•°å‹•ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã€ã®æ™‚ã€ç•°å‹•ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«å¥‘ç´„ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã€ãã‚Œã‚’æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å¤‰æ›´å¾Œå¥‘ç´„ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã«æŒ¿å…¥ã™ã‚‹ã€‚ å¥‘ç´„ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã®2è¡Œç›®ã¨ã€ç•°å‹•ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®2è¡Œç›®ã®è­˜åˆ¥å­ã‚’çªãåˆã‚ã›ã‚‹ã€‚ã€ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã®3è¡Œç›®ã¨ã€å›ºå®šã—ãŸã¾ã¾ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®2è¡Œç›®ã®è­˜åˆ¥å­ã‚’çªãåˆã‚ã›ã‚‹ã€‚ã€ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ = ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã€ã®æ™‚ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã€ãã‚Œã‚’å¤‰æ›´å¾Œãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å¤‰æ›´å¾Œãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒ¿å…¥ã™ã‚‹ã€‚ ã€å¥‘ç´„ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ æœ€çµ‚çš„ã«ã€å¤‰æ›´å¾Œãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä»¥ä¸‹ã®é€šã‚Šã«ãªã‚‹ã€‚ "},"public/software/software_application_architecture_object_oriented_analysis_and_design.html":{"url":"public/software/software_application_architecture_object_oriented_analysis_and_design.html","title":"ğŸ“– ï¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆ","keywords":"","body":"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01 ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã‚’å–ã‚Šå·»ãæ­´å² å‚è€ƒï¼šhttps://umtp-japan.org/event-seminar/4233 ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã¨ã¯ äº’ã„ã«å¯†æ¥ã«é–¢é€£ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¨æ‰‹ç¶šãï¼ˆå‡¦ç†æ‰‹é †ï¼‰ã‚’ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨å‘¼ã°ã‚Œã‚‹ä¸€ã¤ã®ã¾ã¨ã¾ã‚Šã¨ã—ã¦æ‰ãˆã‚‹ã“ã¨ã€‚ 01-02. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆã®æ‰‹é †ä¾‹ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æã®æ‰‹é †ä¾‹ 1. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã®ä½œæˆ è¦ä»¶å®šç¾©ã«åŸºã¥ã„ã¦ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å…·ä½“çš„ãªæ©Ÿèƒ½ã‚’æ˜ç¢ºåŒ–ã•ã›ã‚‹ã€‚ 2. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã®ä½œæˆ è¦ä»¶å®šç¾©ã¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã«åŸºã¥ã„ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã‚’ä½œæˆã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã«å«ã¾ã‚Œã‚‹åè©ã«ç€ç›®ã—ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŠ½å‡ºã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å…·ä½“çš„ãªé™çš„æ§‹é€ ã‚’æ˜ç¢ºåŒ–ã•ã›ã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.wikipedia.org/wiki/%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%8C%87%E5%90%91%E5%88%86%E6%9E%90%E8%A8%AD%E8%A8%88#%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%8C%87%E5%90%91%E5%88%86%E6%9E%90 ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆã®æ‰‹é †ä¾‹ 1. ã‚¯ãƒ©ã‚¹å›³ã®ä½œæˆã€å¤šé‡åº¦ã®ä»˜è¨˜ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã®é–¢ä¿‚æ€§ã‚’å‚è€ƒã«ã—ã¦ã€ã‚¯ãƒ©ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ã¾ãŸã€ã‚¯ãƒ©ã‚¹é–“ãŒãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹é–¢ä¿‚æ€§ã«ã‚ã‚‹æ™‚ã«ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã®ãƒªãƒ³ã‚¯è¨˜å·æ•°ã‚’å‚è€ƒã«ã—ã¦ã€å¤šé‡åº¦ã‚’ä»˜è¨˜ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æŠ½è±¡çš„ãªé™çš„æ§‹é€ ã‚’æ˜ç¢ºåŒ–ã•ã›ã‚‹ã€‚ã‚¯ãƒ©ã‚¹å›³ã§ã¯ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€æŒ¯èˆã€ã‚’è¨­è¨ˆã§ããªã„ãŸã‚ã€ã“ã‚Œã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã«è¨—ã™ã€‚ 2. ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã®ä½œæˆ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã‚’å‚è€ƒã«ã—ã¤ã¤ã€ã“ã‚Œã«æ™‚ç³»åˆ—ã‚’å–ã‚Šå…¥ã‚Œã€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã§ã¯ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€æ§‹é€ ã€ã‚’è¨­è¨ˆã§ããªã„ãŸã‚ã€ã“ã‚Œã¯ã‚¯ãƒ©ã‚¹å›³ã«è¨—ã™ã€‚ã‚·ã‚¹ãƒ†ãƒ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã¨ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã®é•ã„ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/16889028/difference-between-sequence-diagram-sd-and-a-system-sequence-diagram-ssd https://en.wikipedia.org/wiki/Sequence_diagram 3. è¨­è¨ˆã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®é™çš„æ§‹é€ ã‚’è¨­è¨ˆã™ã‚‹ã‚¯ãƒ©ã‚¹å›³ã¨ã€å‹•çš„ãªæŒ¯èˆã‚’è¨­è¨ˆã™ã‚‹ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã®é–“ã®æ•´åˆæ€§ã‹ã‚‰ã€è¨­è¨ˆã‚’å¦¥å½“æ€§ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.sparxsystems.jp/bin/docs/ClassAndSeq.pdf 4. ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å°å…¥ ã‚¯ãƒ©ã‚¹å›³ã«ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åŸºã«ã—ãŸã‚¯ãƒ©ã‚¹ã‚’å°å…¥ã™ã‚‹ã€‚ 5. ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å°å…¥ ã‚¯ãƒ©ã‚¹å›³ã«ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å°å…¥ã™ã‚‹ã€‚ 01-03. ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆã«ãŠã„ã¦ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã®å›³ã®ã“ã¨ã€‚ ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã®ç¨®é¡ UMLã€æ¦‚å¿µãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã€æ§‹é€ åŒ–åˆ†æã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æã€ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://home.jeita.or.jp/page_file/20151221161211_Pkr0lJhRIV.pd è¦–ç‚¹ã«ã‚ˆã‚‹åˆ†é¡ ãƒ»æ©Ÿèƒ½ã®è¦–ç‚¹ ãƒ¦ãƒ¼ã‚¶ã®è¦æ±‚ã«å¯¾ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ©Ÿèƒ½ã«æ³¨ç›®ã™ã‚‹ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ãŒå±ã™ã‚‹ã€‚ ãƒ»æŒ¯èˆã®è¦–ç‚¹ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ™‚ç³»åˆ—çš„ãªæŒ¯èˆã«æ³¨ç›®ã™ã‚‹ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ãŒå±ã™ã‚‹ã€‚ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã«ã¯ã€åˆ†æã«ç”¨ã„ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã¨ã€è¨­è¨ˆã«ç”¨ã„ã‚‹ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ ãƒ»æ§‹é€ ã®è¦–ç‚¹ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ§‹æˆè¦ç´ ã¨ãã‚Œãã‚Œã®é–¢ä¿‚ã«æ³¨ç›®ã™ã‚‹ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ãŒå±ã™ã‚‹ã€‚ã‚¯ãƒ©ã‚¹å›³ã¯è¨­è¨ˆã®ãŸã‚ã«ç”¨ã„ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ 02. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æ æ©Ÿèƒ½ã®è¦–ç‚¹ DFDã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å›³ã€ãªã©ãŒã‚ã‚‹ã€‚ æŒ¯èˆã®è¦–ç‚¹ ã‚·ã‚¹ãƒ†ãƒ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã€çŠ¶æ…‹é·ç§»å›³ã€ãªã©ãŒã‚ã‚‹ã€‚ 02-02. DFDï¼šData Flow Diagramï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³ï¼‰ DFDã¨ã¯ 02-03. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã¨ã¯ ã‚¢ã‚¯ã‚¿ãƒ¼ã¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¨é–¢ä¿‚æ€§ã«åŸºã¥ã„ã¦ã€ã‚¢ã‚¯ã‚¿ãƒ¼ã®è¦æ±‚ã«å¯¾ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å…·ä½“çš„ãªã€æ©Ÿèƒ½ã€ã‚’è¡¨ç¾ã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã¯ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ§‹é€ ã‚’è¡¨ç¾ã§ããªã„ãŸã‚ã€è¨­è¨ˆã®å‰æ®µéšã¨ã—ã¦ã¯ã‚ã¾ã‚Šå½¹ç«‹ãŸãªã„ã€‚ãã®ãŸã‚ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã®å‰æ®µéšã¨ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å…·ä½“ä¾‹ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã«ã¨ã©ã‚ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã®æ–¹ãŒã€è¨­è¨ˆã®å‰æ®µéšã®å‚è€ƒè³‡æ–™ã¨ã—ã¦é©ã—ã¦ã„ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹åã¯ã€ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€ãƒ¦ãƒ¼ã‚¶ãŒã€‡ã€‡ã‚’â–³â–³ã™ã‚‹æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã€‚ã€ã¨è€ƒãˆã€ã€‡ã€‡ï¼ˆåè©ï¼‰ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã«åæ˜ ã•ã›ã‚‹ã€‚ è¨˜æ³• å‚è€ƒï¼š https://it-koala.com/usecasediagrams-1832 https://www.itsenka.com/contents/development/uml/usecase.html è¨˜å·å èª¬æ˜ è£œè¶³ ã‚¢ã‚¯ã‚¿ãƒ¼ï¼š ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’åˆ©ç”¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ã‚„ã€é€£æºã™ã‚‹ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’è¡¨ç¾ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼š ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å…·ä½“çš„ãªæ©Ÿèƒ½ã‚’è¡¨ç¾ã™ã‚‹ã€‚ ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼š ã‚¢ã‚¯ã‚¿ãƒ¼ã¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å¢ƒç•Œç·šã‚’è¡¨ç¾ã™ã‚‹ã€‚ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼š ã‚¢ã‚¯ã‚¿ãƒ¼ã«ã‚ˆã£ã¦æä¾›ã™ã‚‹æ©Ÿèƒ½ã«é•ã„ãŒã‚ã‚‹å ´åˆã€ã“ã‚Œã®å¢ƒç•Œç·šã‚’è¡¨ç¾ã™ã‚‹ã€‚ é–¢é€£ï¼š ã‚¢ã‚¯ã‚¿ãƒ¼ã¨æ©Ÿèƒ½ã‚’çµã¶ã“ã¨ã§ã€æ©Ÿèƒ½ãŒã‚¢ã‚¯ã‚¿ãƒ¼ã«æä¾›ã•ã‚Œã‚‹ã“ã¨ã‚’è¡¨ç¾ã™ã‚‹ã€‚ æ±åŒ–ï¼š ã‚¢ã‚¯ã‚¿ãƒ¼é–“ã¾ãŸã¯ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹é–“ã«ã€is-a-kind-ofãªé–¢ä¿‚ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ¡ãƒ³ãƒãƒ¼ã®é–¢ä¿‚æ€§ï¼‰ãŒã‚ã‚‹ã“ã¨ã‚’è¡¨ç¾ã™ã‚‹ã€‚ åŒ…å«ï¼š çŸ¢å°å…ƒã®æ©Ÿèƒ½ã‚’ç´°åˆ†åŒ–ã™ã‚‹ã¨ã€çŸ¢å°å…ˆã®æ©Ÿèƒ½ã‚‚å«ã¾ã‚Œã‚‹ã“ã¨ã‚’è¡¨ç¾ã™ã‚‹ã€‚ >ã‚‚åŒã˜ã§ã‚ã‚‹ã€‚ å…ˆè¡Œï¼š> çŸ¢å°å…ƒã®æ©Ÿèƒ½ãŒå¿…ãšå…ˆã«ä½¿ç”¨ã•ã‚Œã¦ã‹ã‚‰ã€çŸ¢å°å…ˆã®æ©Ÿèƒ½ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ã‚’è¡¨ç¾ã™ã‚‹ã€‚ æ‹¡å¼µï¼š çŸ¢å°å…ƒã®æ©Ÿèƒ½ã¯çŸ¢å°å…ˆã®æ©Ÿèƒ½ã®è¿½åŠ æ©Ÿèƒ½ã§ã‚ã‚Šã€å ´åˆã«ã‚ˆã£ã¦ã¯ã“ã‚ŒãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ã‚’è¡¨ç¾ã™ã‚‹ã€‚ ãƒãƒ¼ãƒˆï¼š æ©Ÿèƒ½ã®å‰æäº‹é …ã‚„è€ƒæ…®äº‹é …ã‚’è¨˜è¼‰ã™ã‚‹ã€‚èªè¨¼èªå¯ã¯å…¨ã¦ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«é–¢ä¿‚ã™ã‚‹ãŸã‚ã€ãƒãƒ¼ãƒˆã«è¨˜è¼‰ã™ã‚‹ã€‚å‚è€ƒï¼šhttps://stackoverflow.com/questions/49530596/suggested-way-of-creating-use-case-diagram-where-some-use-cases-requires-authent ï¼Šä¾‹ï¼Š ã¨ã‚ã‚‹æ˜ ç”»ãƒã‚±ãƒƒãƒˆæ–™é‡‘ã‚’é¡Œæã«ã€ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ãƒã‚±ãƒƒãƒˆæ–™é‡‘ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã¨ã—ã¦ã€è‰²ã€…ãªæ–¹ãŒãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã¨ã‚¯ãƒ©ã‚¹å›³ã‚’ä½œæˆã•ã‚Œã¦ã„ã‚‹ã€‚ã„ãšã‚Œã®æ–¹ã‚‚éå¸¸ã«å‚è€ƒã«ãªã‚‹ å‚è€ƒï¼šhttps://github.com/tooppoo/ticket-modeling ï¼ˆï¼‘ï¼‰æ˜ ç”»ãƒã‚±ãƒƒãƒˆè³¼å…¥è€…ã®å—æ³¨ç®¡ç†ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’é–‹ç™ºã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ ï¼ˆï¼’ï¼‰è¦ä»¶å®šç¾©ãŒçµ‚ãˆãŸæƒ³å®šã§ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã¯çœç•¥ã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰ã‚¯ãƒ©ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‹ã‚‰ä»¥ä¸‹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŠ½å‡ºã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ æŠ½å‡ºã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ æ˜ ç”»ã‚’é¸ã¶ æ˜ ç”»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¿ã‚¤ãƒˆãƒ«ã‚’é¸ã¶ ã‚¿ã‚¤ãƒˆãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ æ˜ ç”»ã®å½¢å¼ã‚’é¸ã¶ æ˜ ç”»å½¢å¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸Šæ˜ å½¢æ…‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ä¸Šæ˜ å›ã‚’é¸ã¶ ä¸Šæ˜ å›ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸Šæ˜ æ—¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸Šæ˜ é–‹å§‹æ™‚åˆ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ 02-04. ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å›³ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å›³ã¨ã¯ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚„æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã‚’æ‰‹ç¶šãçš„ã«è¡¨è¨˜ã™ã‚‹æ–¹æ³•ã€‚ ï¼Šä¾‹ï¼Š 02-05. ã‚·ã‚¹ãƒ†ãƒ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ ã‚·ã‚¹ãƒ†ãƒ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã¨ã¯ ã‚¢ã‚¯ã‚¿ãƒ¼ã¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å‡ºå…¥åŠ›ã«åŸºã¥ã„ã¦ã€ãƒ¦ãƒ¼ã‚¶ã®è¦æ±‚ã«å¯¾ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€å‹•çš„ãªæŒ¯èˆã€ã‚’è¡¨ç¾ã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã®é–¢ä¿‚æ€§ã«åŸºã¥ãã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã¨ã¯ç•°ãªã‚Šã€å›³å¼åŒ–ã®ç›®çš„ã¨ã—ã¦ã¯ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã¨ä¼¼ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/16889028/difference-between-sequence-diagram-sd-and-a-system-sequence-diagram-ssd https://digitalgyan.org/difference-between-sequence-diagram-and-a-system-sequence-diagram/ https://katzn.hatenablog.com/entry/2013/05/08/235531 02-06. çŠ¶æ…‹é·ç§»å›³ çŠ¶æ…‹é·ç§»å›³ã¨ã¯ çŠ¶æ…‹ï¼ˆä¸¸ï¼‰ã¨â é·ç§»ï¼ˆçŸ¢å°ï¼‰ã®é–¢ä¿‚æ€§ã«åŸºã¥ã„ã¦ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€å‹•çš„ãªæŒ¯èˆã€ã‚’è¡¨ç¾ã™ã‚‹ã€‚çŸ¢å°ã®æ¨ªã®èª¬æ˜ã¯ã€é·ç§»ã®ãã£ã‹ã‘ã¨ãªã‚‹ã€ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆå…¥åŠ›ï¼‰â ï¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå‡ºåŠ›ï¼‰â ã€ã‚’è¡¨ç¾ã™ã‚‹ã€‚ çŠ¶æ…‹é·ç§»è¡¨ã¨ã¯ çŠ¶æ…‹é·ç§»å›³ã‹ã‚‰ä½œæˆã—ãŸè¡¨ã€‚çŠ¶æ…‹é·ç§»è¡¨ã‚’ä½œæˆã—ã¦ã¿ã‚‹ã¨ã€çŠ¶æ…‹é·ç§»å›³ã§ã¯ã€9ã¤ã‚ã‚‹ã‚»ãƒ«ã®ã†ã¡4ã¤ã®ã‚»ãƒ«ã—ã‹è¡¨ç¾ã§ãã¦ãŠã‚‰ãšã€æ®‹ã‚Š5ã¤ã®ã‚»ãƒ«ã¯è¡¨ç¾ã•ã‚Œã¦ã„ãªã„ã“ã¨ã«æ°—ã¥ãã“ã¨ãŒã§ãã‚‹ã€‚ ï¼Šä¾‹é¡Œï¼Š 12.2 ã¨ã„ã†çŠ¶æ…‹ åˆæœŸã®çŠ¶æ…‹ã‚’ã€aã€ã¨ã—ã¦ã€æœ€åˆãŒæ•°å­—ãªã®ã§ã€aè¡Œã®ã€bã€ã¸ç§»å‹•ã€‚ ç¾åœ¨ã®çŠ¶æ…‹ã€bã€ã‹ã‚‰ã€æ¬¡ã¯æ•°å­—ãªã®ã§ã€bè¡Œã®ã€bã€ã¸ç§»å‹•ã€‚ ç¾åœ¨ã®çŠ¶æ…‹ã€bã€ã‹ã‚‰ã€æ¬¡ã¯å°æ•°ç‚¹ãªã®ã§ã€bè¡Œã®ã€dã€ã¸ç§»å‹•ã€‚ ç¾åœ¨ã®çŠ¶æ…‹ã€dã€ã‹ã‚‰ã€æ¬¡ã¯æ•°å­—ãªã®ã§ã€bè¡Œã®ã€eã€ã¸ç§»å‹•ã€‚ 02-07. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å›³ï¼‰ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã¨ã¯ ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å›³ã€ã¨ã‚‚ã„ã†ã€‚ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹å…·ä½“çš„ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã®é–¢ä¿‚æ€§ã«åŸºã¥ã„ã¦ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€é™çš„æ§‹é€ ã€ã‚’è¡¨ç¾ã™ã‚‹ã€‚ è¨˜æ³• è¨˜å·å èª¬æ˜ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æŒ‡å®š ç‰¹å®šã®çŠ¶æ…‹ã«ã‚ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼‰ã®å…·ä½“ä¾‹ã‚’è¡¨ç¾ã™ã‚‹ã€‚ã€:ã€ã®ã‚ˆã†ã«ä¸‹ç·šä»˜ãã§è¡¨è¨˜ã™ã‚‹ã€‚ ã‚¹ãƒ­ãƒƒãƒˆ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä¿æŒã™ã‚‹å…·ä½“çš„ãªãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¾ã™ã‚‹ã€‚ã€: = ã€ã§è¡¨è¨˜ã™ã‚‹ã€‚ ãƒªãƒ³ã‚¯ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã®é–¢ä¿‚æ€§ã‚’è¡¨ç¾ã™ã‚‹ã€‚ä½•ã‹ã—ã‚‰ã®é–¢ä¿‚æ€§ãŒã‚ã‚Œã°ã€å…¨ã¦ãƒªãƒ³ã‚¯ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼š https://thinkit.co.jp/article/40/3/3.html https://www.itsenka.com/contents/development/uml/object.html 03. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆ æ§‹é€ ã®è¦–ç‚¹ ã‚¯ãƒ©ã‚¹å›³ã€ERå›³ã€ãªã©ãŒã‚ã‚‹ã€‚ æŒ¯èˆã®è¦–ç‚¹ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ãªã©ãŒã‚ã‚‹ã€‚ æ§‹é€ ã¨ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼åˆ¶ç´„ã®è¦–ç‚¹ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design.html 03-02. ã‚¯ãƒ©ã‚¹å›³ ã‚¯ãƒ©ã‚¹å›³ã¨ã¯ ã‚¯ãƒ©ã‚¹é–“ã®é–¢ä¿‚æ€§ã«åŸºã¥ã„ã¦ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€é™çš„æ§‹é€ ã€ã‚’è¡¨ç¾ã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã®é–¢ä¿‚æ€§ã‚’å‚è€ƒã«ã—ã¦ã€ã‚¯ãƒ©ã‚¹é–“ã®é–¢ä¿‚æ€§ã®ç¨®é¡ã‚’åˆ¤æ–­ã™ã‚‹ã€‚ è¨˜æ³•ã®ç¨®é¡ ãƒ»has-oneã€has-manyï¼ˆãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹é–¢ä¿‚æ€§ï¼‰ ã€has-oneã€ã€has-manyã€ãªé–¢ä¿‚ã¨è¡¨ç¾ã•ã‚Œã€ã‚ˆã‚Šå…·ä½“çš„ã«èª¬æ˜ã™ã‚‹ã¨ã€ã¨ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹é–¢ä¿‚æ€§ã§ã‚ã‚‹ã€‚Associationï¼ˆé–¢é€£ï¼‰ã€Aggregationï¼ˆé›†ç´„ï¼‰ã€Compositionï¼ˆåˆæˆï¼‰ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ã€Association ï¼ Aggregation ï¼ Compositionã€ã®é †ã§ã€ä¾å­˜æ€§ãŒä½ããªã‚‹ã€‚å®Ÿè£…ä¾‹ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based.html ãƒ»is-a-kind-ofï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ¡ãƒ³ãƒãƒ¼ã®é–¢ä¿‚æ€§ï¼‰ ã€is-a-kind-ofã€ãªé–¢ä¿‚ã¨è¡¨ç¾ã•ã‚Œã€ã‚ˆã‚Šå…·ä½“çš„ã«èª¬æ˜ã™ã‚‹ã¨ã€ã¨ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ¡ãƒ³ãƒãƒ¼ã®é–¢ä¿‚æ€§ã§ã‚ã‚‹ã€‚Generalizationï¼ˆæ±åŒ–ï¼‰ã€Realizationï¼ˆå®Ÿç¾ï¼‰ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚å®Ÿè£…ä¾‹ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based.html ãƒ»useï¼ˆå¼•æ•°å‹ï¼è¿”å´å€¤å‹ã¨ã—ã¦ç”¨ã„ã‚‹é–¢ä¿‚æ€§ï¼‰ ã€useã€ãªé–¢ä¿‚ã¨è¡¨ç¾ã•ã‚Œã€ã‚ˆã‚Šå…·ä½“çš„ã«èª¬æ˜ã™ã‚‹ã¨ã€ã¨å¼•æ•°å‹ï¼è¿”å´å€¤å‹ã¨ã—ã¦ç”¨ã„ã‚‹é–¢ä¿‚æ€§ã§ã‚ã‚‹ã€‚Dependencyï¼ˆä¾å­˜ï¼‰ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚å®Ÿè£…ä¾‹ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based.html ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹é–¢ä¿‚æ€§ã®å¤šé‡åº¦ ãƒ»multiplicityï¼ˆå¤šé‡åº¦ï¼‰ã¨ã¯ ã‚¯ãƒ©ã‚¹é–“ãŒãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹é–¢ä¿‚æ€§ã«ã‚ã‚‹æ™‚ã«ã€ä¿æŒã•ã‚Œã‚‹å´ã‚¯ãƒ©ã‚¹ãŒä½•å€‹ã®ã‚¯ãƒ©ã‚¹ã«ä¿æŒã•ã‚Œã‚‹ã‹ã€ã¾ãŸåå¯¾ã«ä¿æŒã™ã‚‹å´ã‚¯ãƒ©ã‚¹ãŒä¿æŒã•ã‚Œã‚‹å´ã‚¯ãƒ©ã‚¹ã‚’ä½•å€‹ä¿æŒã™ã‚‹ã‹ã€ã‚’è¡¨ç¾ã™ã‚‹ã€‚ã“ã®ã‚ˆã†ã«ï¼’ã¤ã®è¦‹æ–¹ãŒã‚ã‚‹ã“ã¨ãŒæ··ä¹±ã™ã‚‹ã®ã§æ³¨æ„ã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã®ãƒªãƒ³ã‚¯è¨˜å·æ•°ã‚’å‚è€ƒã«ã—ã¦å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://atmarkit.itmedia.co.jp/ait/articles/0105/02/news002.html ãƒ»è¨˜æ³• ä¿æŒã™ã‚‹ï¼ä¿æŒã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ã®å€‹æ•° è¨˜æ³• 1 1 0ä»¥ä¸Š1ä»¥ä¸‹ï¼ˆã¤ã¾ã‚Šã€0ã¾ãŸã¯1ï¼‰ 0..1 0ä»¥ä¸Šnä»¥ä¸‹ 0..n mä»¥ä¸Šnä»¥ä¸‹ m..n 0ä»¥ä¸Šç„¡é™å¤§ä»¥ä¸‹ï¼ˆã¤ã¾ã‚Šã€0ä»¥ä¸Šï¼‰ * 0ä»¥ä¸Šç„¡é™å¤§ä»¥ä¸‹ï¼ˆã¤ã¾ã‚Šã€0ä»¥ä¸Šï¼‰ 0..* ï¼Šä¾‹ï¼Š ç¤¾å“¡ã¯ï¼‘ã¤ã®ä¼šç¤¾ã«ã—ã‹æ‰€å±ã§ããªã„ã¨ã™ã‚‹ã€‚ã€ç¤¾å“¡ã‚¯ãƒ©ã‚¹ã€ã‹ã‚‰è¦‹ãŸã¨ãã«ã€ä¸€ã¤ã®ã€ä¼šç¤¾ã‚¯ãƒ©ã‚¹ã€ã«ã—ã‹ä¿æŒã•ã‚Œãªã„ã€‚ã‚ˆã£ã¦ã€ä¼šç¤¾ã‚¯ãƒ©ã‚¹ã«ã€1ã€ã‚’ä»˜è¨˜ã™ã‚‹ã€‚ä¸€æ–¹ã§ã€ä¼šç¤¾ã‚¯ãƒ©ã‚¹ã€ã‹ã‚‰è¦‹ãŸã¨ãã«ã€0ä»¥ä¸Šã®ã€ç¤¾å“¡ã‚¯ãƒ©ã‚¹ã€ã‚’ä¿æŒã™ã‚‹ã€‚ã‚ˆã£ã¦ã€ä¼šç¤¾ã‚¯ãƒ©ã‚¹ã«ã€0..*ã€ã‚’ä»˜è¨˜ã™ã‚‹ã€‚ 03-03. ERå›³ï¼šEntity Relation Diagram ERå›³ã¨ã¯ DBãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ é–“ã®é–¢ä¿‚æ€§ã«åŸºã¥ã„ã¦ã€DBã®æ§‹é€ ã‚’è¡¨ç¾ã™ã‚‹ã€‚ã€IE è¨˜æ³•ã€ã¨ã€IDEF1X è¨˜æ³•ã€ãŒä¸€èˆ¬çš„ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ IEè¨˜æ³• ãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€å±æ€§ ãƒ»ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–“ã®é–¢ä¿‚ã‚’è¡¨ç¾ã™ã‚‹ã€‚ ãƒ»1ï¼š1 ãƒ»1ï¼šå¤šï¼ˆãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ›–æ˜§ãªçŠ¶æ…‹ï¼‰ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æãŒé€²ã‚€ã«ã¤ã‚Œã€ã€1ï¼š0 ä»¥ä¸Šã®é–¢ä¿‚ã€ã€1ï¼š1 ä»¥ä¸Šã®é–¢ä¿‚ã€ã®ã‚ˆã†ã«å…·ä½“åŒ–ã—ãã€‚ ãƒ»1ï¼š1 ä»¥ä¸Š 03-04. ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã®æ™‚ç³»åˆ—çš„ãªé–¢ä¿‚æ€§ã«åŸºã¥ã„ã¦ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€å‹•çš„ãªæŒ¯èˆã€ã‚’è¡¨ç¾ã™ã‚‹ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š 5ã¤ã®ãƒ©ã‚¤ãƒ•ãƒ©ã‚¤ãƒ³ï¼ˆåº—å“¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ç®¡ç†ç”»é¢ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€æ¤œç´¢ç”»é¢ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€å•†å“DBã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€å•†å“è©³ç´°ç”»é¢ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã‚’è¨­å®šã™ã‚‹ã€‚ å„ãƒ©ã‚¤ãƒ•ãƒ©ã‚¤ãƒ³ã§å®Ÿè¡Œã•ã‚Œã‚‹å®Ÿè¡Œä»•æ§˜é–“ã®å‘½ä»¤å†…å®¹ã‚’ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„è¤‡åˆãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã§ç¤ºã™ã€‚ ï¼Šä¾‹ï¼Š 3ã¤ã®ãƒ©ã‚¤ãƒ•ãƒ©ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ å„ãƒ©ã‚¤ãƒ•ãƒ©ã‚¤ãƒ³ã§å®Ÿè¡Œã•ã‚Œã‚‹å®Ÿè¡Œä»•æ§˜é–“ã®å‘½ä»¤å†…å®¹ã‚’ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„è¤‡åˆãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã§ç¤ºã™ã€‚ "},"public/software/software_application_architecture_backend_microservices.html":{"url":"public/software/software_application_architecture_backend_microservices.html","title":"ğŸ“– ï¸ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£","keywords":"","body":"ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚¤ãƒ³ãƒˆãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ­´å² ãƒ»ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å–ã‚Šå·»ãç’°å¢ƒ å‚è€ƒï¼›https://tech-blog.rakus.co.jp/entry/20201218/architecture å¹´ä»£ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ èª¬æ˜ 1999 ï½ ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ 1999å¹´å°ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã—ã¦ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãŒå°é ­ã—ã¦ã„ãŸã€‚ã—ã‹ã—ã€ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ç„¡ç§©åºã§ã¤ãã¯ãã ã‚‰ã‘ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãªã‚‹ã“ã¨ãŒè«–æ–‡ï¼ˆã€å¤§ããªæ³¥ã ã‚“ã”ã€ï¼‰ã§æŒ‡æ‘˜ã•ã‚ŒãŸã€‚å‚è€ƒï¼šhttps://ja.wikipedia.org/wiki/%E5%A4%A7%E3%81%8D%E3%81%AA%E6%B3%A5%E3%81%A0%E3%82%93%E3%81%94 2014 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ 2014å¹´ã«ThoughtWorksç¤¾ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹æŒ‡å‘ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã‚’çµ±åˆã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç‹¬ç«‹ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®é›†ã¾ã‚Šã«åˆ†å‰²ã™ã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è€ƒæ¡ˆã—ãŸã€‚å‚è€ƒï¼šãƒ»https://martinfowler.com/articles/microservices.htmlãƒ»https://atmarkit.itmedia.co.jp/ait/articles/2110/22/news006.html 2017 ãƒŸãƒ‹ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚µãƒ¼ãƒ“ã‚¹è‡ªä½“ã‚’ç‹¬ç«‹ã—ãŸãƒ¢ãƒãƒªã‚¹ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨æ‰ãˆã‚‹ã¨ã€ãã®åˆ†ã ã‘é–‹ç™ºãƒãƒ¼ãƒ ï¼ˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ï¼‰ãŒå¿…è¦ã«ãªã£ã¦ã—ã¾ã†ã€‚2017å¹´ã«Cloud Elementsç¤¾ã¯ã€ã“ã‚Œã«å¯¾å‡¦ã™ã‚‹ãŸã‚ã«ãƒŸãƒ‹ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è€ƒæ¡ˆã—ãŸã€‚ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ãƒ¢ãƒãƒªã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®é–“ã‚’ã¨ã£ãŸç²’åº¦ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ã«åˆ†å‰²ã™ã‚‹ã€‚ã“ã®ç²’åº¦ã‚’ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾æŠ—ã—ã¦ã€ãƒŸãƒ‹ã‚µãƒ¼ãƒ“ã‚¹ã€ã¾ãŸã¯ã€MASAã€ã¨ã‚ˆã¶ã€‚å‚è€ƒï¼šãƒ»https://blog.cloud-elements.com/pragmatic-microservices-architectureãƒ»https://atmarkit.itmedia.co.jp/ait/articles/2110/22/news006.html 2018 ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ãƒ¢ãƒãƒªã‚¹ ãƒŸãƒ‹ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ã‚µãƒ¼ãƒ“ã‚¹ã®ç²’åº¦ãŒå¤§ãããªã£ãŸã‚‚ã®ã®ã€è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ã¯å¤‰ã‚ã‚‰ãšã€ãã®åˆ†ã ã‘é–‹ç™ºãƒãƒ¼ãƒ ãŒå¿…è¦ã«ãªã‚‹å•é¡Œã¯è§£æ¶ˆã•ã‚Œãªã‹ã£ãŸã€‚ãã“ã§ã€Root Insuranceç¤¾ã¯ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¢ãƒãƒªã‚¹ã‚’è€ƒæ¡ˆã—ãŸã€‚ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¢ãƒãƒªã‚¹ã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã®æ¦‚å¿µã‚’å–ã‚Šå…¥ã‚Œãšã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç´°ã‹ã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†å‰²ã™ã‚‹ã€‚å‚è€ƒï¼šhttps://medium.com/@dan_manges/the-modular-monolith-rails-architecture-fb1023826fc4 ãƒ»ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ã‚µãƒ¼ãƒ“ã‚¹ã®ç²’åº¦ã®æ¯”è¼ƒ å‚è€ƒï¼šhttps://tech-blog.rakus.co.jp/entry/20201218/architecture ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å¤§ãã• ç¨®é¡ èª¬æ˜ ä¸€ç•ªå¤§ãã„ ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒåˆ†å‰²ã•ã‚Œã¦ãŠã‚‰ãšã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã®å˜ä½ã¨ã™ã‚‹ã€‚ ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†å‰²ã•ã‚Œã¦ãŠã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã®å˜ä½ã¨ã™ã‚‹ã€‚ ãƒŸãƒ‹ã‚µãƒ¼ãƒ“ã‚¹ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆã¾ãŸã¯å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’å˜ä½ã¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã«åˆ†å‰²ã•ã‚Œã¦ãŠã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹æˆã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚ã‚‹ç¨‹åº¦ã®ã¾ã¨ã¾ã‚Šã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã®å˜ä½ã¨ã™ã‚‹ã€‚ã¾ãŸã€DBã‚’å„ã‚µãƒ¼ãƒ“ã‚¹ã§å…±æœ‰ã™ã‚‹ã€‚ ä¸€ç•ªå°ã•ã„ ãƒã‚¤ã‚¯ãƒ­ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆã¾ãŸã¯å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’å˜ä½ã¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã¾ãŸã¯ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«åˆ†å‰²ã•ã‚Œã¦ãŠã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹æˆã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãã‚Œãã‚Œã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã®å˜ä½ã¨ã™ã‚‹ã€‚ã¾ãŸã€DBã‚’å„ã‚µãƒ¼ãƒ“ã‚¹ã§å…±æœ‰ã›ãšã«ã€ã‚µãƒ¼ãƒ“ã‚¹ã”ã¨ã«è¨­ç½®ã™ã‚‹ã€‚ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç‰¹å¾´ ãƒ»ãƒ“ã‚¸ãƒã‚¹ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«å¼·ã„ ãƒ“ã‚¸ãƒã‚¹ãŒã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹æ™‚ã€ã‚µãƒ¼ãƒ“ã‚¹ã®æ–°è¦å®Ÿè£…ã¾ãŸã¯å‰Šé™¤ã‚’è¡Œãˆã°è‰¯ã„ãŸã‚ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®æ¿€ã—ã„å¤‰åŒ–ã«å¼·ã„ã€‚ ãƒ»ã‚³ãƒ³ã‚¦ã‚§ã‚¤ã®æ³•å‰‡ãŒåƒã ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚Šã€çµ„ç¹”æ§‹é€ ãŒå°ã•ãªãƒãƒ¼ãƒ ã®é›†ã¾ã‚Šã«å¤‰åŒ–ã™ã‚‹ã“ã¨ã‚’æœŸå¾…ã§ãã‚‹ã€‚ ãƒ»é«˜é »åº¦ã§ãƒªãƒªãƒ¼ã‚¹å¯èƒ½ å„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç‹¬ç«‹ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹ãŸã‚ã€é«˜é »åº¦ã§ãƒªãƒªãƒ¼ã‚¹ã§ãã‚‹ã€‚ ãƒ»éšœå®³ã®å½±éŸ¿ãŒéƒ¨åˆ†çš„ ã„ãšã‚Œã‹ã®ã‚µãƒ¼ãƒ“ã‚¹ã«éšœå®³ãŒèµ·ã“ã£ãŸã¨ã—ã¦ã€ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ã‚¤ã‚«ãƒ¼ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ä¸Šæµã‚µãƒ¼ãƒ“ã‚¹ã¸ã®éšœå®³ã®æ³¢åŠã‚’é£Ÿã„æ­¢ã‚ã‚‰ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€éšœå®³ã®å½±éŸ¿ãŒéƒ¨åˆ†çš„ã¨ãªã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ãŒè½ã¡ã¦ã—ã¾ã†ã“ã¨ãŒãªã„ã€‚ ãƒ»è¤‡æ•°ã®é–‹ç™ºè¨€èªã‚’ä½¿ç”¨å¯èƒ½ ã‚µãƒ¼ãƒ“ã‚¹é–“ã§ã€å…±é€šã®ãƒ‡ãƒ¼ã‚¿è¨˜è¿°è¨€èªã‚’ç”¨ã„ã¦ãƒ‡ãƒ¼ã‚¿é€šä¿¡ã‚’è¡Œãˆã°ã€å„ã‚µãƒ¼ãƒ“ã‚¹ã®é–‹ç™ºè¨€èªãŒç•°ãªã£ã¦ã„ã¦ã‚‚å•é¡Œãªã„ã€‚ ãƒªãƒã‚¸ãƒˆãƒªã®ç²’åº¦ ãƒ»ãƒ¢ãƒãƒªãƒã‚¸ãƒˆãƒª å…¨ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä¸€ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªã§ç®¡ç†ã™ã‚‹ã€‚Googleã§ã¯ãƒ¢ãƒãƒªãƒã‚¸ãƒˆãƒªã«ã‚ˆã‚‹ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãŒæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.fourtheorem.com/blog/monorepo ãƒ»ãƒãƒªãƒ¬ãƒã‚¸ãƒˆãƒª å„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç•°ãªã‚‹ãƒªãƒã‚¸ãƒˆãƒªã§ç®¡ç†ã™ã‚‹ã€‚ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ ãƒ»dapr å‚è€ƒï¼š https://www.publickey1.jp/blog/19/dapr.html https://github.com/dapr/dapr 02. å„åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã®ç²’åº¦ ã‚µãƒ¼ãƒ“ã‚¹ ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã¨ã¯ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã“ã¨ã€‚ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ãŒä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ä¾µé£Ÿã•ã‚Œã€ã‚µãƒ¼ãƒ“ã‚¹ã®å‡é›†åº¦ãŒä½ããªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€ACLï¼šAnti Corruption Layerï¼ˆè…é£Ÿé˜²æ­¢ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰ã‚’è¨­ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚è…é£Ÿé˜²æ­¢ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€ç•°ãªã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰å—ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€ãã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ã‚ã£ãŸãƒ‡ãƒ¼ã‚¿å½¢å¼ã«å¤‰æ›ã™ã‚‹è²¬å‹™ã‚’æŒã¤ã€‚CQRSã§ã¯ã€ã“ã‚Œã¯ãƒ—ãƒ­ã‚»ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ä¸€æ–¹ã§Sagaãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ãŒã€åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚‚åŒä¸€ã®ç”¨èªãŒã‚ã‚‹ãŸã‚ã€æ··ä¹±ã‚’é¿ã‘ã‚‹ãŸã‚ã«ãƒ—ãƒ­ã‚»ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã™ã‚‹ã€‚ å‚è€ƒï¼š https://github.com/czeslavo/process-manager https://www.oreilly.com/library/view/what-is-domain-driven/9781492057802/ch04.html https://docs.microsoft.com/ja-jp/previous-versions/msp-n-p/jj591569(v=pandp.10)?redirectedfrom=MSDN ãƒ»å„ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ å„ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯è‡ªç”±ã§ã‚ã‚‹ã€‚ã“ã®æ™‚ã€ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«åŸºã¥ã„ã¦å®Ÿè£…ã§ãã‚‹ã€‚ ï¼Šä¾‹ï¼Š å‚è€ƒï¼šhttps://little-hands.hatenablog.com/entry/2017/12/07/bouded-context-implementation ECã‚µã‚¤ãƒˆãŒã‚ã‚Šã€ã“ã‚Œã®å•†å“è²©å£²ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è²©å£²ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨é…é€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åˆ†å‰²ã§ãã‚‹ã¨ã™ã‚‹ã€‚ã“ã®æ™‚ã€ãã‚Œãã‚Œã®ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹è²©å£²ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨é…é€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚µãƒ¼ãƒ“ã‚¹ã®ç²’åº¦ã¨ãªã‚Šã€ã‚ªãƒ‹ã‚ªãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã§åŒæœŸé€šä¿¡ï¼éåŒæœŸé€šä¿¡ã‚’è¡Œã†ã€‚ ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ†å‰²æ‰‹æ³• ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ†å‰²ä¾‹ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒªãƒ³ã‚¯ åˆ†å‰²æ–¹æ³• ã‚µãƒ¼ãƒ“ã‚¹ã®ç¨®é¡ Eã‚³ãƒãƒ¼ã‚¹ https://github.com/GoogleCloudPlatform/microservices-demo ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ ã‚«ãƒ¼ãƒˆã€å•†å“æ¤œç´¢ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€é€šè²¨ã®å¤‰æ›ã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã€é€æ–™ã¨ç™ºé€ã€æ³¨æ–‡ç¢ºèªãƒ¡ãƒ¼ãƒ«ã€æ³¨æ–‡ãƒ•ãƒ­ãƒ¼ã€ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ã€åºƒå‘Šã€åˆæˆç›£è¦– Eã‚³ãƒãƒ¼ã‚¹ https://github.com/DataDog/ecommerce-workshop ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ åºƒå‘Šã€å‰²å¼• ãƒ»ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å˜ä½ã¨ã—ãŸåˆ†å‰² ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ã‚µãƒ¼ãƒ“ã‚¹ã®ç²’åº¦ã¨ã™ã‚‹ã€‚ã“ã“ã§ã¯ã€è§£æ±ºé ˜åŸŸã¨ãªã‚‹å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ä¸­ã«ä¸€ã¤ã—ã‹å«ã¾ã‚Œã¦ã„ãªã„å ´åˆã‚’æŒ‡ã—ã¦ãŠã‚Šã€ä»£ã‚ã‚Šã«ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚µãƒ¼ãƒ“ã‚¹ã®ç²’åº¦ã—ã¦è€ƒãˆã¦ã‚‚è‰¯ã„ã€‚ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ç²’åº¦ã¨ã™ã‚‹ã“ã¨ã‚’ç¬¬ä¸€æ®µéšã¨ã—ã¦ã€ã•ã‚‰ã«å°ã•ãªç²’åº¦ã«åˆ†å‰²ã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®æ®µéšã¨ã—ã¦ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç²’åº¦ã¨ã™ã‚‹ã¨ã‚ˆã„ã€‚ å‚è€ƒï¼š https://microservices.io/patterns/decomposition/decompose-by-subdomain.html https://www.amazon.co.jp/dp/4873119316/ref=cm_sw_em_r_mt_dp_PVDKB4F74K7S07E4CTFF ãƒ»ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å˜ä½ã¨ã—ãŸåˆ†å‰² ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ã‚µãƒ¼ãƒ“ã‚¹ã®å˜ä½ã¨ã™ã‚‹ã€‚ãŸã ã—ã€ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•æ–¹å¼ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€£æºã—ãŸå ´åˆã«é™ã‚Šã€å¾“æ¥ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ–¹å¼ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€£æºã™ã‚‹å ´åˆã®ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç”¨ã„ã‚‹ã“ã¨ã¯ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã‚ã‚‹ã€‚æœ€è‰¯ãªè§£æ±ºç­–ã¨ã—ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®çŠ¶æ…‹ç®¡ç†æ–¹å¼ã¨ã—ã¦ã€å¾“æ¥ã®ãƒ‡ãƒ¼ã‚¿ã«ç€ç›®ã—ãŸã‚¹ãƒ†ãƒ¼ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã§ã¯ãªãã€æŒ¯èˆã«ç€ç›®ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã¾ãŸã€å„ã‚µãƒ¼ãƒ“ã‚¹ã‚’åè©ã§ã¯ãªãå‹•è©ã§å‘½åã™ã‚‹ã¨ã‚ˆã„ã€‚ãã®ä»–ã€å„ã‚µãƒ¼ãƒ“ã‚¹ã§DBã‚’å®Œå…¨ã«ç‹¬ç«‹ã•ã›ã‚‹ã“ã¨ã‚„ã€SAGAãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç”¨ã„ã‚‹ã“ã¨ã€ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼š https://github.com/GoogleCloudPlatform/microservices-demo https://www.koslib.com/posts/entity-services-anti-pattern/ https://www.michaelnygard.com/blog/2018/01/services-by-lifecycle/ https://medium.com/transferwise-engineering/how-to-avoid-entity-services-58bacbe3ee0b 03. åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ é–“ã®é€£æº Orchestrationï¼ˆã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ ãƒ»ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ ä¸­å¤®é›†æ¨©å‹ã‚·ã‚¹ãƒ†ãƒ ã¨ã‚‚è¨€ã†ã€‚å…¨ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ¶å¾¡ã™ã‚‹è²¬å‹™ã‚’æŒã£ãŸã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è¨­ç½®ã™ã‚‹è¨­è¨ˆæ–¹æ³•ã€‚ä¸€ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚ŒãŸæ™‚ã«ã€ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯å„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚³ãƒ¼ãƒ«ã—ãªãŒã‚‰å‡¦ç†ã®çµæœã‚’ç¹‹ã„ã§ã„ãã€‚ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã ã‘ã§ãªãã€ã‚µãƒ¼ãƒ“ã‚¹æŒ‡å‘ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã‚‚ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://news.mynavi.jp/itsearch/article/devsoft/1598 https://blogs.itmedia.co.jp/itsolutionjuku/2019/08/post_729.html https://www.fiorano.com/jp/blog/integration/integration-architecture/%E3%82%B3%E3%83%AC%E3%82%AA%E3%82%B0%E3%83%A9%E3%83%95%E3%82%A3-vs-%E3%82%AA%E3%83%BC%E3%82%B1%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3/ ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒªãƒ—ãƒ©ã‚¤æ–¹å¼ ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€å€‹ã€…ã®ã‚µãƒ¼ãƒ“ã‚¹é–“ã®é€£æºæ–¹å¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒªãƒ—ãƒ©ã‚¤æ–¹å¼ã‚’æ¡ç”¨ã™ã‚‹ã€‚ã“ã®æ–¹å¼ã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹é–“ã§RESTfulAPIã‚’ç”¨ã„ãŸåŒæœŸé€šä¿¡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ Choreographyï¼ˆã‚³ãƒ¬ã‚ªã‚°ãƒ©ãƒ•ã‚£ï¼‰ ãƒ»ã‚³ãƒ¬ã‚ªã‚°ãƒ©ãƒ•ã‚£ã¨ã¯ åˆ†æ•£å‹ã‚·ã‚¹ãƒ†ãƒ ã¨ã‚‚è¨€ã†ã€‚ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯å­˜åœ¨ã›ãšã€å„ã‚µãƒ¼ãƒ“ã‚¹ã§ä¸‹æµã‚µãƒ¼ãƒ“ã‚¹ã«é€£æºã™ã‚‹è²¬å‹™ã‚’æŒãŸã›ã‚‹è¨­è¨ˆæ–¹æ³•ã§ã‚ã‚‹ã€‚å€‹ã€…ã®ã‚µãƒ¼ãƒ“ã‚¹é–“ã®é€£æºæ–¹å¼ã§ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•æ–¹å¼ã‚’æ¡ç”¨ã™ã‚‹ã€‚ä¸€ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚ŒãŸæ™‚ã«ã€ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ã‚µãƒ¼ãƒ“ã‚¹ã«å‡¦ç†ãŒç¹‹ãŒã£ã¦ã„ãã€‚ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ã€ã‚³ãƒ¬ã‚ªã‚°ãƒ©ãƒ•ã‚£ã«ã‚ˆã‚‹é€£æºãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://blogs.itmedia.co.jp/itsolutionjuku/2019/08/post_729.html https://www.fiorano.com/jp/blog/integration/integration-architecture/%E3%82%B3%E3%83%AC%E3%82%AA%E3%82%B0%E3%83%A9%E3%83%95%E3%82%A3-vs-%E3%82%AA%E3%83%BC%E3%82%B1%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3/ ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•æ–¹å¼ ã‚³ãƒ¬ã‚ªã‚°ãƒ©ãƒ•ã‚£ã§ã¯ã€ä¸Šæµï¼ä¸‹æµã®ã‚µãƒ¼ãƒ“ã‚¹é–“ã®é€£æºæ–¹å¼ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒ‰ãƒªãƒ–ãƒ³æ–¹å¼ã‚’æ¡ç”¨ã™ã‚‹ã€‚ã“ã®æ–¹å¼ã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹é–“ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã‚’ç”¨ã„ãŸéåŒæœŸé€šä¿¡ã‚’è¡Œã†ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã§ã¯å—ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸€æ–¹å‘ã«ã—ã‹é…ä¿¡ã§ããªã„ãŸã‚ã€ã‚‚ã—ã‚µãƒ¼ãƒ“ã‚¹é–“åŒæ–¹å‘ã«é€ä¿¡ã—ãŸã„å ´åˆã¯ã€ä¸Šæµã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã¨ã€‚ä¸‹æµã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰å—ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã‚’åˆ¥ã€…ã«è¨­ç½®ã™ã‚‹ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã¯Pubï¼Subãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Ÿè£…ã™ã‚‹ã‹ã€ã¾ãŸã¯AWS-SQSãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ç”¨ã„ã‚‹ã€‚ ãƒ»å®Ÿè£…ä¾‹ ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://github.com/fedeoliv/microservices-transactions 04. ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–æ–¹å¼ ãƒ­ãƒ¼ã‚«ãƒ«ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ å„ã‚µãƒ¼ãƒ“ã‚¹ã«ç‹¬ç«‹ã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ãŒå­˜åœ¨ã—ã¦ãŠã‚Šã€ä¸€ã¤ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã«ã‚ˆã£ã¦ã€ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã¿ã‚’æ“ä½œã™ã‚‹è¨­è¨ˆæ–¹æ³•ã€‚æ¨å¥¨ã§ã‚ã‚‹ã€‚ã“ã®ãƒãƒ¼ãƒˆã§ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ãŸã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã®é€£æºã‚’èª¬æ˜ã™ã‚‹ã€‚ ãƒ»Sagaãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ãƒ­ãƒ¼ã‚«ãƒ«ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®æ™‚ã«ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã‚’å®Ÿç¾ã™ã‚‹è¨­è¨ˆæ–¹æ³•ã€‚ä¸Šæµã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ“ä½œå®Œäº†ã‚’ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ã€ä¸‹æµã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ“ä½œå‡¦ç†ã‚’é€£ç¶šçš„ã«ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ™‚ã«ã¯è£œå„Ÿãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã€é€†é †ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ãŒå…ƒã«æˆ»ã•ã‚Œã‚‹ã€‚ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¨ã‚‚è¨€ã†ã€‚ä¸€ã¤ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ãŒå„ã‚µãƒ¼ãƒ“ã‚¹ã«åˆ†æ•£ã—ã¦ãŠã‚Šã€ä¸€ã¤ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã«ã‚ˆã¦ã€å„ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é€£ç¶šçš„ã«æ“ä½œã™ã‚‹è¨­è¨ˆæ–¹æ³•ã€‚éæ¨å¥¨ã§ã‚ã‚‹ã€‚ 05. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°æ–¹å¼ ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚° ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã¨ã¯ ãƒ“ã‚¸ãƒã‚¹ã®å‡ºæ¥äº‹ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã€ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ°¸ç¶šåŒ–ã™ã‚‹ã€‚ç¾åœ¨ã®çŠ¶æ…‹ã‚’å–å¾—ã™ã‚‹å ´åˆã¯ã€åˆæœŸã®ãƒ‡ãƒ¼ã‚¿ã«å…¨ã¦ã®å‡ºæ¥äº‹ã‚’é©ç”¨ã™ã‚‹ã€‚CQRSã¨ç›¸æ€§ãŒè‰¯ã„ã€‚ å‚è€ƒï¼š https://qiita.com/suin/items/f559e3dcde7c811ed4e1 https://martinfowler.com/articles/201701-event-driven.html ã‚¹ãƒ†ãƒ¼ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚° ãƒ»ã‚¹ãƒ†ãƒ¼ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã¨ã¯ ãƒ“ã‚¸ãƒã‚¹ã®ç¾åœ¨ã®çŠ¶æ…‹ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã€ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ°¸ç¶šåŒ–ã™ã‚‹ã€‚éå»ã®çŠ¶æ…‹ã¯ä¸Šæ›¸ãã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttp://masuda220.jugem.jp/?eid=435 06. åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹ãƒ†ã‚¹ãƒˆ CDCãƒ†ã‚¹ãƒˆï¼šConsumer Drive Contract ãƒ»CDCãƒ†ã‚¹ãƒˆã¨ã¯ ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã¦ã‹ã‚‰ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ“ä½œãŒå®Œäº†ã™ã‚‹ã¾ã§ã‚’ã€ãƒ†ã‚¹ãƒˆã™ã‚‹ã€‚ä¸‹æµã‚µãƒ¼ãƒ“ã‚¹ã®ã‚³ãƒ¼ãƒ«ã¯ãƒ¢ãƒƒã‚¯åŒ–ã¾ãŸã¯ã‚¹ã‚¿ãƒ–åŒ–ã™ã‚‹ã€‚ ã‚«ã‚ªã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚° ãƒ»ã‚«ã‚ªã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚° å®Ÿé¨“çš„ã«ã€æœ¬ç•ªç’°å¢ƒã®åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã«ã€ã‚«ã‚ªã‚¹ã€ã‚’æŒ¿å…¥ã—ã€é«˜è² è·ãªçŠ¶æ…‹ã«è‡³ã‚‰ã›ã‚‹ã€‚ãã®çµæœã‹ã‚‰ã€åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã«æ½œã‚€æƒ³å®šå¤–ã®å•é¡Œã‚’è¡¨é¢åŒ–ã•ã›ã‚‹ã€‚ã‚«ã‚ªã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã¯ã€ä»Šã¾ã•ã«å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãŒç”¨ã„ã¦ã„ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«å¯¾ã—ã¦å®Ÿæ–½ã™ã‚‹ã“ã¨ã«ãªã‚‹ãŸã‚ã€ãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ã®ç†è§£ãŒå¿…è¦ã«ãªã‚‹ã€‚æœ¬æ ¼çš„ãªåˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã‚’æ¡ç”¨ã—ã¦ã„ã‚‹æ—¥ç³»ä¼æ¥­ã¯å°‘ãªãã€å›½å†…äº‹ä¾‹ã¯ã¾ã å°‘ãªã„ã€‚ å‚è€ƒï¼š https://principlesofchaos.org/ https://codezine.jp/article/detail/14526 ãƒ»æ‰‹é † å‚è€ƒï¼šhttps://zenn.dev/hodagi/articles/3ce6ccdb00538c æœ¬ç•ªç’°å¢ƒã®åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰æ§˜ã€…ãªãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã‚’åé›†ã—ã€å®‰å®šã—ã¦ã„ã‚‹é€šå¸¸çŠ¶æ…‹ï¼ˆå®šå¸¸çŠ¶æ…‹ï¼‰ã‚’å®šç¾©ã™ã‚‹ã€‚ å®šå¸¸çŠ¶æ…‹ã‚’å¯¾ç…§ç¾¤ã€ã¾ãŸã‚«ã‚ªã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãŒå®Ÿæ–½ã•ã‚ŒãŸçŠ¶æ…‹ã‚’å®Ÿé¨“ç¾¤ã¨ã™ã‚‹ã€‚ã€å®Ÿé¨“ç¾¤ã§ã¯éšœå®³ãŒèµ·ã“ã‚‹ã€ã¨ã„ã†ä»®èª¬ã®ä¸‹ã€ã“ã‚Œã‚’åè¨¼ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã™ã€‚ å®Ÿé¨“ç¾¤ã§ã‚«ã‚ªã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã‚’å®Ÿæ–½ã™ã‚‹ã€‚ å¯¾ç…§ç¾¤ã¨æ¯”è¼ƒã—ã€ã€éšœå®³ã¯èµ·ã“ã‚‹ã€ã¨ã„ã†ä»®èª¬ã‚’åè¨¼ã™ã‚‹ã€‚ 07. é‹ç”¨ éšœå®³å¯¾ç­– ãƒ»ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ã‚¤ã‚«ãƒ¼ã¨ã¯ ã‚µãƒ¼ãƒ“ã‚¹é–“ã«è¨­ç½®ã•ã‚Œã€ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«é€£é–ã™ã‚‹éšœå®³ã‚’å¸åã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ä¸‹æµã‚µãƒ¼ãƒ“ã‚¹ã«éšœå®³ãŒèµ·ã“ã£ãŸæ™‚ã«ã€ä¸Šæµã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ã¦ã—ã¾ã‚ãªã„ã‚ˆã†ã€ç›´è¿‘ã®æˆåŠŸæ™‚ã®å‡¦ç†çµæœã‚’è¿”ä¿¡ã™ã‚‹ã€‚ æ¨ªæ–­çš„ãªç›£è¦– ãƒ»åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã¨ã¯ ã‚µãƒ¼ãƒ“ã‚¹é–“ã§åˆ†æ•£ã—ã¦ã—ã¾ã†å„ãƒ­ã‚°ã‚’ã€ä¸€æ„ãªIDã§ç´ä»˜ã‘ã‚‹æ–¹æ³•ã€‚ ãƒ»ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ Datadogã«ã‚ˆã‚‹åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ç›£è¦–ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability_datadog_metrics.html "},"public/software/software_application_architecture_backend_domain_driven_design.html":{"url":"public/software/software_application_architecture_backend_domain_driven_design.html","title":"ğŸ“– ï¸ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆ","keywords":"","body":"ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆã‹ã‚‰æ´¾ç”Ÿã—ãŸåˆ†æè¨­è¨ˆã®æ‰‹æ³•ã®ä¸€ã¤ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆã‚’ã‚ˆã‚Šå¼·åŒ–ã™ã‚‹ãŸã‚ã«è€ƒæ¡ˆã•ã‚Œã€ç‰¹ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«æœ‰åŠ¹ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://www.ogis-ri.co.jp/otc/hiroba/technical/DDDEssence/chap1.html https://ja.wikipedia.org/wiki/%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E9%A7%86%E5%8B%95%E8%A8%AD%E8%A8%88 02. ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®æ‰‹é †ä¾‹ æˆ¦ç•¥çš„è¨­è¨ˆã®æ‰‹é †ä¾‹ æˆ¦ç•¥çš„è¨­è¨ˆã§ã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å…¨ä½“ã‹ã‚‰å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æ˜ç¢ºã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/crossroad0201/items/875c5f76ed3794ed56c4 ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¨è©±ã—åˆã„ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å…¨ä½“ã®ä¸­ã‹ã‚‰ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’åˆ‡ã‚Šåˆ†ã‘ã‚‹ã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã®éƒ¨ç½²ã‚„æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã®ç«‹ã¡ä½ç½®ã«ã‚ˆã£ã¦ã¯ã€åŒã˜ã€å˜èªã€ã‚„ã€å‹•è©ã€ã§ã‚ã£ã¦ã‚‚ã€æ„å‘³åˆã„ï¼å®šç¾©ã¥ã‘ãŒç•°ãªã‚‹å ´åˆãŒã‚ã‚‹ã€‚ã“ã®æ™‚ã€ãã‚Œãã‚Œã‚’åˆ¥ã€…ã®åå‰ã‹ã‚‰ãªã‚‹ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã¨ã—ã¦å®šç¾©ã¥ã‘ã‚‹ã€‚ ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã‚’å…ƒã«ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å®šç¾©ã¥ã‘ã‚‹ã€‚ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒ—ã‚’ä½œæˆã—ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé–“ã®é–¢ä¿‚ã‚’æ˜ã‚‰ã‹ã«ã™ã‚‹ã€‚ æˆ¦è¡“çš„è¨­è¨ˆã®æ‰‹é †ä¾‹ æˆ¦è¡“çš„è¨­è¨ˆã§ã¯ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚„ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«è½ã¨ã—è¾¼ã‚€ã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¨è©±ã—åˆã„ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹è¦ä»¶ã‚’ãƒ’ã‚¢ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚ã“ã®æ™‚ã€ãƒ“ã‚¸ãƒã‚¹ã®ãƒ«ãƒ¼ãƒ«ï¼åˆ¶ç´„ã‚’ååˆ†ã«ãƒ’ã‚¢ãƒªãƒ³ã‚°ã™ã‚‹ã€‚ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å…·ä½“åŒ–ã®ãŸã‚ã«ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€æŠ½è±¡åŒ–ã®ãŸã‚ã«ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚‚ä½œæˆã™ã‚‹ã€‚ å¿…è¦ã§ã‚ã‚Œã°ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã«å†ãƒ’ã‚¢ãƒªãƒ³ã‚°ã‚’è¡Œã„ã€ç‰¹ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’æ”¹å–„ã™ã‚‹ã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’å…ƒã«ã€ã‚¯ãƒ©ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ã“ã®æ™‚ã€ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ‡ã‚Šåˆ†ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰å‹ã€ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«å‹ã€ã‚ªãƒ‹ã‚ªãƒ³å‹ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼‰ã‚’æ±ºã‚ã€ã‚¯ãƒ©ã‚¹å›³ã‚’å…ƒã«ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã‚’å®Ÿè£…ã™ã‚‹ã€‚ é‹ç”¨å¾Œã«å•é¡ŒãŒèµ·ã“ã£ãŸå ´åˆã€ç‰¹ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’ä¿®æ­£ã™ã‚‹ã€‚å ´åˆã«ã‚ˆã£ã¦ã¯ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ‡ã‚Šåˆ†ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://booth.pm/ja/items/3363104 03. æˆ¦ç•¥çš„è¨­è¨ˆ ãƒ‰ãƒ¡ã‚¤ãƒ³ ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã¯ ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«å…¨ä½“ã§è¦‹ãŸæ™‚ã«ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢åŒ–ã®å¯¾è±¡ã¨ãªã‚‹æ¥­å‹™é ˜åŸŸã®ã“ã¨ã€‚æ¥­å‹™é ˜åŸŸã®å¢ƒç›®ã‚’è¦‹åˆ†ã‘ã‚‹æ–¹æ³•ã¨ã—ã¦ã€ä¸€é€£ã®æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã®ä¸­ã§ã€æ¥­å‹™ã®æ‹…å½“è€…ã®å±æ€§ãŒå¤‰åŒ–ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ç€ç›®ã™ã‚‹ã¨è‰¯ã„ã€‚æ‹…å½“è€…ãŒå¤‰ã‚ã‚Œã°ã€çµŒç†æ¥­å‹™ã€ä¼šè¨ˆæ¥­å‹™ã€ã‚³ãƒ¼ãƒ«ã‚»ãƒ³ã‚¿ãƒ¼æ¥­å‹™ã€ãªã©ãŒæŠ½å‡ºã§ãã‚‹ã¯ãšã§ã‚ã‚‹ã€‚ ï¼Šä¾‹ï¼Š ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆåºƒå‘Šä»£ç†åº—ã®ä¾‹ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ãè¤‡æ•°ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã®æ‹…å½“è€…ã®å¤‰åŒ–ã¨ã—ã¦ã€ã¾ãšå•ã„åˆã‚ã›ã§æ³¨æ–‡ã‚’å—ã‘ã¦åºƒå‘Šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã€å–¶æ¥­æ‹…å½“è€…ã€ã€åˆ¶ä½œã—ãŸåºƒå‘Šã‚’ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«å…¥ç¨¿ã™ã‚‹ã€åˆ¶ä½œæ‹…å½“è€…ã€ã€å…¥ç¨¿ã•ã‚ŒãŸåºƒå‘Šã‚’é‹ç”¨ã—ã¦åºƒå‘ŠåŠ¹æœã‚’é«˜ã‚ã‚‹ã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æ‹…å½“è€…ã€ã€æœ€å¾Œã«åºƒå‘Šã®ä¾é ¼è€…ã«æ–™é‡‘ã‚’è«‹æ±‚ã™ã‚‹ã€çµŒç†æ‹…å½“è€…ã€ãŒæŒ™ã’ã‚‰ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆåºƒå‘Šä»£ç†åº—ã®ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã¯ã€å„æ‹…å½“è€…ã«å¯¾å¿œã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åˆ†å‰²ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://labs.septeni.co.jp/entry/2021/04/15/130000 ï¼Šä¾‹ï¼Š å®Œå…¨å€‹å®¤ã‚¸ãƒ ã‚’é‹å–¶ã™ã‚‹ãƒã‚³ã‚¸ãƒ ã®ä¾‹ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ãè¤‡æ•°ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã®æ‹…å½“è€…ã®å¤‰åŒ–ã¨ã—ã¦ã€ã¾ãšå€‹å®¤ã‚¸ãƒ ã«é©ã™ã‚‹ç‰©ä»¶ã‚’æ¢ã™ã€ç‰©ä»¶æ‹…å½“è€…ã€ã€ã‚¸ãƒ ã®ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ã‚’æ¡ç”¨ã—ã¦ä¼šå“¡ã«ç´¹ä»‹ã™ã‚‹ã€æ¡ç”¨æ‹…å½“è€…ã€ã€å€‹å®¤ã‚¸ãƒ ã®åˆ©ç”¨ä¼šå“¡ã‚’ç²å¾—ã™ã‚‹ã€å–¶æ¥­æ‹…å½“è€…ã€ãŒæŒ™ã’ã‚‰ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒã‚³ã‚¸ãƒ ã®ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã¯ã€å„æ‹…å½“è€…ã«å¯¾å¿œã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åˆ†å‰²ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://hacogym.jp/ https://zenn.dev/hsshss/articles/e11efefc7011ab ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ ãƒ»ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¨ã¯ å„ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã«è©³ã—ã„äººï¼‰ã¨ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒè©±ã—åˆã„ãªãŒã‚‰ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å†…ã®ä¸»è¦æ¥­å‹™ã‚’ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã€è£œåŠ©çš„ãªæ¥­å‹™ã‚’ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åˆ†é¡ã™ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç¤¾å†…å‘ã‘ï¼ç¤¾å¤–å‘ã‘ã«é–¢ã‚ã‚‰ãšã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç”¨è€…è‡ªä½“ã€ã¾ãŸã¯ãã®åˆ©ç”¨è€…ã«è©³ã—ã„äººãŒãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã«ãªã‚‹ã“ã¨ãŒå¤šã„ã€‚ å‚è€ƒï¼š https://qiita.com/crossroad0201/items/875c5f76ed3794ed56c4 https://labs.septeni.co.jp/entry/2021/04/15/130000 ãƒ»è¨˜æ³• ï¼Šä¾‹ï¼Š å®Œå…¨å€‹å®¤ã‚¸ãƒ ã‚’é‹å–¶ã™ã‚‹ãƒã‚³ã‚¸ãƒ ã®ä¾‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã†ã¡ã§ã€å€‹å®¤ã‚¸ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åŸºã¥ãã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯äºˆç´„ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ãã‚Œä»¥å¤–ã¯ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã—ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://hacogym.jp/ https://zenn.dev/hsshss/articles/e11efefc7011ab ï¼Šä¾‹ï¼Š ECã‚µã‚¤ãƒˆã‚’é‹å–¶ã™ã‚‹ã‚¢ã‚¹ã‚¯ãƒ«ã®ä¾‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã†ã¡ã§ã€å€‹äººå‘ã‘è²©å£²ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆã‚µã‚¤ãƒˆåã¯LOHACOï¼‰ã«åŸºã¥ãã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚é…é€ï¼æ³¨æ–‡ï¼å•†å“ï¼ãƒ¦ãƒ¼ã‚¶ç®¡ç†ï¼åœ¨åº«ï¼å—æ³¨ã‚’ãã‚Œãã‚Œã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã—ã¦ã„ã‚‹ï¼ˆã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯æ˜è¨€ã•ã‚Œã¦ã„ãªã„ï¼‰ã€‚ å‚è€ƒï¼šhttps://speakerdeck.com/askul/ddd-and-clean-architecture-at-lohaco?slide=28 ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª ãƒ»ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã¨ã¯ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆé–“ã§ã€ç‰¹å®šã®ã€å˜èªã€ã‚„ã€å‹•è©ã€ã®æ„å‘³åˆã„ï¼å®šç¾©ã¥ã‘ãŒç•°ãªã‚‹å ´åˆã€ã“ã‚Œã‚’åˆ¥ã€…ã®åå‰ã‹ã‚‰ãªã‚‹ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã¨ã—ã¦å®šç¾©ã¥ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/kmdsbng/items/bf415afbeec239a7fd63 å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ ãƒ»å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã¯ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã®æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã®ç«‹ã¡ä½ç½®ãŒç•°ãªã‚Œã°ã€åŒã˜ã€å˜èªã€ã‚„ã€å‹•è©ã€ã§ã‚ã£ã¦ã‚‚ã€ç•°ãªã‚‹æ„å‘³åˆã„ï¼å®šç¾©ã¥ã‘ã®ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ç•°ãªã‚‹ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã‚’å…ƒã«ã—ã¦ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã®æ™‚ã€ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã¯ã€ä»–ã®å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã¯é€šã˜ãªã„ã‚‚ã®ã§ã‚ã‚Œã°ã‚ã‚‹ã»ã©ã‚ˆã„ã€‚å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãã‚Œãã‚Œã®ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã«åˆã‚ã›ã¦ã€ç•°ãªã‚‹åå‰ã§ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã¦ã„ãã€‚å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å®šç¾©ã—ãªã„å ´åˆã€ç•°ãªã‚‹ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã‚’ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚„ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³é–“ã§å…±æœ‰ã™ã‚‹ã“ã¨ã¨ãªã‚Šã€ãã‚Œãã‚Œã®é–¢å¿ƒã«ç„¡é–¢ä¿‚ãªãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ã“ã¨ã«ãªã£ã¦ã—ã¾ã†ã€‚ ãƒ»è¨˜æ³• ï¼Šä¾‹ï¼Š æœ¬ã‚’è²©å£²ã™ã‚‹ECã‚µã‚¤ãƒˆã®ä¾‹ã€‚ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åŸºã¥ã„ãŸãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã¨å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ãƒã‚¤ãƒ¤ãƒ¼ï¼ˆä»•å…¥ã‚Œï¼‰éƒ¨ã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨ã€åœ¨åº«ç®¡ç†éƒ¨ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¯ã€ã€æœ¬ï¼ˆå•†å“ï¼‰ã€ã¨ã„ã†å˜èªã«å¯¾ã™ã‚‹æ„å‘³åˆã„ï¼å®šç¾©ã¥ã‘ãŒç•°ãªã‚‹ã€‚ãã®ãŸã‚ã€ãã‚Œãã‚Œã‚’ã€æœ¬ã€ã€ã‚¯ãƒ¼ãƒãƒ³ã€ã€åœ¨åº«ã€ã¨ã„ã†ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã¨ã—ã¦å®šç¾©ã§ãã€ãƒ¢ãƒ‡ãƒ«åï¼ãƒ‡ãƒ¼ã‚¿åã¯ãã‚Œãã‚Œã®ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã«åˆã‚ã›ãŸåå‰ã«ãªã‚‹ã€‚ä¾‹ãˆã°ã€ãƒãƒ¼ã‚±ã®å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã¯ã€ãƒ¢ãƒ‡ãƒ«åã¯Couponã¨ãªã‚Šã€å‰²å¼•æœŸé–“ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŒã€ä»•å…¥éƒ¨ã‚„åœ¨åº«éƒ¨ã§ã¯ã“ã®ãƒ‡ãƒ¼ã‚¿ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ä¸€æ–¹ã€ISBNã¯å…¨ã¦ã®å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ¢ãƒ‡ãƒ«ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å®šç¾©ã—ãªã„å ´åˆã€ä¸€ã¤ã®å•†å“ãƒ¢ãƒ‡ãƒ«ãŒå…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ã“ã¨ã¨ãªã‚Šã€ãã‚Œãã‚Œã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆãŒé–¢å¿ƒã‚’æŒãŸãªã„ãƒ‡ãƒ¼ã‚¿ã‚‚ä¿æŒã™ã‚‹ã“ã¨ã«ãªã£ã¦ã—ã¾ã†ã€‚ å‚è€ƒï¼šhttps://kenta-kosugi.medium.com/%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%AE%E4%B8%8A%E6%89%8B%E3%81%AA%E5%88%86%E5%89%B2-ff5bb01d1062 ï¼Šä¾‹ï¼Š å®Œå…¨å€‹å®¤ã‚¸ãƒ ã‚’é‹å–¶ã™ã‚‹ãƒã‚³ã‚¸ãƒ ã®ä¾‹ã€‚å€‹å®¤ã‚¸ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åŸºã¥ãå¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€‚èªè¨¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€äºˆç´„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€é¡§å®¢ç®¡ç†ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€éŠ€è¡Œæ”¯æ‰•ã„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æ”¯æ‰•ã„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚‹ã€‚ å‚è€ƒï¼š https://hacogym.jp/ https://zenn.dev/hsshss/articles/e11efefc7011ab ï¼Šä¾‹ï¼Š å¥‘ç´„è«‹æ±‚ç®¡ç†ã‚¢ãƒ—ãƒªã‚’æä¾›ã™ã‚‹ã‚¢ãƒ«ãƒ—ã®ä¾‹ã€‚ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«åŸºã¥ã„ãŸãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã¨å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚å¥‘ç´„ç®¡ç†ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€å•†å“ç®¡ç†ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€è«‹æ±‚ç®¡ç†ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€ãŒã‚ã‚‹ã€‚å–ã‚Šçµ„ã¿ã¨ã—ã¦ã€é€±æ¬¡ã§ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã®æ›´æ–°ã‚’è¡Œã£ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://note.com/alpinc/n/nab47ab9273c6 https://thealp.co.jp/ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒ— ãƒ»ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒ—ã¨ã¯ åºƒç¾©ã®ãƒ‰ãƒ¡ã‚¤ãƒ³å…¨ä½“ã®ä¿¯ç°ã™ã‚‹å›³ã®ã“ã¨ã€‚ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å®šç¾©ã—ãŸå¾Œã€ã“ã‚Œã‚‰ã®é–¢ä¿‚æ€§ã‚’è¦–è¦šåŒ–ã™ã‚‹ã€‚ç•°ãªã‚‹ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®é–“ã§ç•°ãªã‚‹ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã‚’ç”¨ã„ã‚‹å ´åˆã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ã¾ãŸãŒãªã„ã€‚ä¸€æ–¹ã§ã€åŒã˜ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã‚’ç”¨ã„ã‚‹å ´åˆã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯è¤‡æ•°ã®ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã¾ãŸãŒã‚‹ã€‚å¯èƒ½ãªé™ã‚Šã€å„å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã¯ç•°ãªã‚‹ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã‚’ä½¿ç”¨ã—ã€å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒè¤‡æ•°ã®ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã¾ãŸãŒãªã„ã‚ˆã†ã«ã—ãŸæ–¹ãŒè‰¯ã„ï¼ˆã“ã‚Œé‡è¦ï¼‰ã€‚ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯å†…è£½ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ãŒã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯å¤–è£½ï¼å†…è£½ã®ã„ãšã‚Œã§ã‚‚å•é¡Œãªã„ã€‚ å‚è€ƒï¼šhttps://qiita.com/crossroad0201/items/875c5f76ed3794ed56c4 ãƒ»è¨˜æ³• ï¼Šä¾‹ï¼Š å®Œå…¨å€‹å®¤ã‚¸ãƒ ã‚’é‹å–¶ã™ã‚‹ãƒã‚³ã‚¸ãƒ ã®ä¾‹ã€‚å€‹å®¤ã‚¸ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãã‚Œãã‚Œã®å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«åŸºã¥ããƒ¢ãƒ‡ãƒªãƒ³ã‚°ã€‚ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã®äºˆç´„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã‚¹ãƒãƒ¼ãƒˆãƒ­ãƒƒã‚¯ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯ã€ä¸€ã¤ã®ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å†…è£½åŒ–ã—ã¦ã„ã‚‹ã€‚ä¸€æ–¹ã§ã€ãã‚Œä»¥å¤–ã®å¢ƒç•Œä»˜ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯å¤–è£½åŒ–ã—ã¦ã„ã‚‹ã€‚ 04. æˆ¦è¡“çš„è¨­è¨ˆ MVCã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¸ã®å¤‰é· ãƒ»MVCã¨å•é¡Œç‚¹ ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆãŒè€ƒæ¡ˆã•ã‚Œã‚‹ä»¥å‰ã€MVCã®è€ƒãˆæ–¹ãŒä¸»æµã§ã‚ã£ãŸã€‚ã—ã‹ã—ã€ç‰¹ã«Modelã®å½¹å‰²ãŒæŠ½è±¡çš„éããŸãŸã‚ã€é–‹ç™ºè¦æ¨¡ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ã€Modelã«å½¹å‰²ã‚’é›†ä¸­ã•ã›éãã¦ã—ã¾ã†ã“ã¨ãŒã‚ã£ãŸã€‚ ãƒ»MVCã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¸ã®ç§»è¡Œ ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆãŒç™»å ´ã—ãŸã“ã¨ã«ã‚ˆã£ã¦ã€MVCã¯ç™ºå±•ã—ã€Mãƒ»Vãƒ»Cãã‚Œãã‚Œã®å½¹å‰²ãŒã‚ˆã‚Šå…·ä½“çš„ã§ç²¾å¯†ã«ãªã£ãŸã€‚Modelã®è‚¥å¤§åŒ–ã¯ã€ModelãŒã‚‚ã¤ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã€ã¾ãŸCRUDå‡¦ç†ã‚’ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã¨ã—ã¦åˆ†å‰²ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å¯¾å‡¦ã•ã‚ŒãŸã€‚ DDDã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ãƒ»ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ æœ€åˆã«è€ƒæ¡ˆã•ã‚ŒãŸå®Ÿç¾æ–¹æ³•ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/4798121967/ref=cm_sw_r_tw_dp_ZD0VGXSNQMNZF7K1ME8J?_encoding=UTF8&psc=1 ãƒ»ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ åˆ¥åã€ãƒãƒ¼ãƒˆã‚¢ãƒ³ãƒ‰ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã¨ã„ã†ã€‚ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã«å¯¾ã—ã¦ã€ä¾å­˜æ€§é€†è»¢ã‚’çµ„ã¿è¾¼ã‚“ã ã‚‚ã®ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¾å­˜ã™ã‚‹ä»¥å¤–ã€ä½•ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚‚ä¾å­˜ã—ãªã„ã€‚é€†ã«è€ƒãˆã‚Œã°ã€ã“ã‚Œã‚‰ã«ä¾å­˜ã™ã‚‹ã‚‚ã®ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ç½®ãã¹ãã§ã¯ãªã„ã¨åˆ¤æ–­ã§ãã‚‹ã€‚æœ¬è³ªçš„ã«ã¯ã€ä»–ã®ã€ã‚ªãƒ‹ã‚ªãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã«åŒã˜ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/B00UX9VJGW/ref=cm_sw_r_tw_dp_S20HJ24MHWTSED7T0ZCP ãƒ»ã‚ªãƒ‹ã‚ªãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã«å¯¾ã—ã¦ã€ä¾å­˜æ€§é€†è»¢ã‚’çµ„ã¿è¾¼ã‚“ã ã‚‚ã®ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¾å­˜ã™ã‚‹ä»¥å¤–ã€ä½•ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚‚ä¾å­˜ã—ãªã„ã€‚é€†ã«è€ƒãˆã‚Œã°ã€ã“ã‚Œã‚‰ã«ä¾å­˜ã™ã‚‹ã‚‚ã®ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ç½®ãã¹ãã§ã¯ãªã„ã¨åˆ¤æ–­ã§ãã‚‹ã€‚æœ¬è³ªçš„ã«ã¯ã€ä»–ã®ã€ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã«åŒã˜ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://jeffreypalermo.com/2008/07/the-onion-architecture-part-1/ https://little-hands.hatenablog.com/entry/2017/10/11/075634 ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã«å¯¾ã—ã¦ã€ä¾å­˜æ€§é€†è»¢ã‚’çµ„ã¿è¾¼ã‚“ã ã‚‚ã®ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¾å­˜ã™ã‚‹ä»¥å¤–ã€ä½•ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚‚ä¾å­˜ã—ãªã„ã€‚é€†ã«è€ƒãˆã‚Œã°ã€ã“ã‚Œã‚‰ã«ä¾å­˜ã™ã‚‹ã‚‚ã®ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ç½®ãã¹ãã§ã¯ãªã„ã¨åˆ¤æ–­ã§ãã‚‹ã€‚æœ¬è³ªçš„ã«ã¯ã€ä»–ã®ã€ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã€ã‚ªãƒ‹ã‚ªãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã«åŒã˜ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html DDDãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ»DDDãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³é›† å‚è€ƒï¼šhttps://www.ogis-ri.co.jp/otc/hiroba/technical/DDDEssence/chap1.html ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã¨ã¯ åŸºæœ¬çš„ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘åˆ†æè¨­è¨ˆã§ã¯ã€åˆ†æã®ãŸã‚ã«ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã‚’ä½œæˆã—ã€ãã®å¾Œã«è¨­è¨ˆã®ãŸã‚ã«ã‚¯ãƒ©ã‚¹å›³ã‚„ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ä¸€æ–¹ã§ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®åˆ†æã§ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å…·ä½“åŒ–ã®ãŸã‚ã«ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€æŠ½è±¡åŒ–ã®ãŸã‚ã«ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚‚ä½œæˆã™ã‚‹ã€‚ã“ã®å…·ä½“ä¾‹ã‹ã‚‰æŠ½è±¡ã‚’å°ãã¨ã„ã†ä½œæ¥­ã«ã‚ˆã‚Šã€ã‚ˆã‚Šç¾å®Ÿã«æ²¿ã£ãŸãƒ¢ãƒ‡ãƒªãƒ³ã‚°ãŒå¯èƒ½ã«ãªã‚‹ã€‚ å‚è€ƒï¼š https://booth.pm/ja/items/3363104 https://qiita.com/little_hand_s/items/dfa4b156f533ba1a1491 ãƒ»ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚° ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã«åŸºã¥ã„ã¦ã€ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://qiita.com/crossroad0201/items/875c5f76ed3794ed56c4 ãƒ»è¨˜æ³• ã‚¯ãƒ©ã‚¹å›³ã¨åŒæ§˜ã«ã—ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã®é–¢ä¿‚æ€§ã‚’å‚è€ƒã«ã—ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«é–“ã®é–¢ä¿‚æ€§ã‚’å®šç¾©ã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ãŒIDã®ã¿ã‚’ç”¨ã„ã‚‹é–¢ä¿‚ã§ã‚ã‚Œã°ã€ç‚¹ç·šçŸ¢å°ã€ã¨ã—ã€ã¾ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’ç”¨ã„ã‚‹é–¢ä¿‚ã§ã‚ã‚Œã°ã€ç™½å¡—ã‚Šã®è±å½¢ã€ã¨ã™ã‚‹ï¼ˆè¨˜å·ã®è¡¨è¨˜æ–¹æ³•ã¯å€‹äººå·®ãŒã‚ã‚‹ï¼‰ã€‚ã“ã®æ™‚ã€ç‚¹ç·šçŸ¢å°ã®é–¢ä¿‚æ€§ã§ã‚ã‚Œã°ç•°ãªã‚‹é›†ç´„ã«å±ã—ã€ã¾ãŸç™½å¡—ã‚Šã®è±å½¢ã§ã‚ã‚Œã°åŒã˜é›†ç´„ã«å±ã—ã¦ã„ã‚‹ãŸã‚ã€ã“ã‚Œã‚‰ã‹ã‚‰é›†ç´„ã®å¢ƒç•Œã‚’å®šç¾©ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã®ãƒªãƒ³ã‚¯è¨˜å·æ•°ã‚’å‚è€ƒã«ã—ã¦ã€å¤šé‡åº¦ã‚’ä»˜è¨˜ã™ã‚‹ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼åˆ¶ç´„ã‚’å¹ãå‡ºã—ã«æ›¸ãè¾¼ã‚€ã“ã¨ã«ã‚ˆã‚Šã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ§‹é€ ã ã‘ã§ãªããƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼åˆ¶ç´„ã‚‚è¡¨ç¾ã™ã‚‹ã€‚ å‚è€ƒï¼š https://booth.pm/ja/items/3363104 https://www.eureka-moments-blog.com/entry/2018/12/29/145802 https://github.com/ShisatoYano/PlantUML/blob/master/DomainModelDiagram/DomainModelDiagram.pdf ï¼Šä¾‹ï¼Š ã¨ã‚ã‚‹æ˜ ç”»ãƒã‚±ãƒƒãƒˆæ–™é‡‘ã‚’é¡Œæã«ã€ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ãƒã‚±ãƒƒãƒˆæ–™é‡‘ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã¨ã—ã¦ã€è‰²ã€…ãªæ–¹ãŒãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’ä½œæˆã•ã‚Œã¦ã„ã‚‹ã€‚ã„ãšã‚Œã®æ–¹ã‚‚éå¸¸ã«å‚è€ƒã«ãªã‚‹ï¼ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã¯é›£ã—ã„ï¼‰ã€‚ å‚è€ƒï¼š https://cinemacity.co.jp/ticket/ https://twitter.com/little_hand_s/status/1150763962062913536?lang=ar https://github.com/bookreadking/ddd-modeling-impplementation-guilde/tree/master/ticket-modeling/eichisanden ï¼ˆï¼‘ï¼‰æ˜ ç”»ãƒã‚±ãƒƒãƒˆè³¼å…¥è€…ã®å—æ³¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹ç™ºã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ ï¼ˆï¼’ï¼‰ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¸ã®è¦ä»¶å®šç¾©ãŒçµ‚ãˆãŸæƒ³å®šã§ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚’ä½œæˆã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå›³ã¯çœç•¥ã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰æš«å®šçš„ãªãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’ä½œæˆã™ã‚‹ã€‚little_hands_sã•ã‚“ã¯ã€IDã®ã¿ã‚’ç”¨ã„ã‚‹é–¢ä¿‚ã§ã‚ã‚Œã°ã€å®Ÿç·šçŸ¢å°ã€ã¨ã—ã€ã¾ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’ç”¨ã„ã‚‹é–¢ä¿‚ã§ã‚ã‚Œã°ã€é»’å¡—ã‚Šã®è±å½¢ã€ã¨ã—ã¦ã„ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‹ã‚‰ä»¥ä¸‹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŠ½å‡ºã™ã‚‹ã€‚ã“ã®æ™‚ã€å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãŠãŠã¾ã‹ã«äºˆæƒ³ã—ã¦ãŠãã€‚ã¾ãŸã€çŸ¢å°ã¨è±å½¢ã®é–¢ä¿‚æ€§ã‹ã‚‰ã€é›†ç´„ã®å¢ƒç•Œã‚’å®šç¾©ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ æŠ½å‡ºã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä¾‹ å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ æŠ½å‡ºã•ã‚ŒãŸé›†ç´„ æ˜ ç”»ã€ä¸Šæ˜ æ—¥æ™‚ã€æšæ•°ã‚’é¸æŠã™ã‚‹ ä¸Šæ˜ æ™‚é–“å¸¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸Šæ˜ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€æ˜ ç”»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ä¸Šæ˜ é›†ç´„ã€æ˜ ç”»é›†ç´„ ï¼ˆï¼“ï¼‰ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’æ›´æ–°ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ æŠ½å‡ºã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä¾‹ å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ æŠ½å‡ºã•ã‚ŒãŸé›†ç´„ æ˜ ç”»ã€ä¸Šæ˜ æ—¥æ™‚ã€æšæ•°ã‚’é¸æŠã™ã‚‹ ä¸Šæ˜ æ™‚é–“å¸¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸Šæ˜ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€æ˜ ç”»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ä¸Šæ˜ é›†ç´„ã€æ˜ ç”»é›†ç´„ ã€ƒ äºˆç´„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ äºˆç´„é›†ç´„ å‰²å¼•ã‚’é¸æŠã™ã‚‹ é©ç”¨å‰²å¼•ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ äºˆç´„é›†ç´„ æ”¯æ‰•ã„é‡‘é¡ã‚’ç¢ºèªã™ã‚‹ æ”¯æ‰•æ–™é‡‘ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ æ”¯æ‰•ã„æ–™é‡‘é›†ç´„ ï¼ˆï¼”ï¼‰ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’æ›´æ–°ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ æŠ½å‡ºã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä¾‹ å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ æŠ½å‡ºã•ã‚ŒãŸé›†ç´„ æ˜ ç”»ã€ä¸Šæ˜ æ—¥æ™‚ã€æšæ•°ã‚’é¸æŠã™ã‚‹ ä¸Šæ˜ æ™‚é–“å¸¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸Šæ˜ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€æ˜ ç”»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ä¸Šæ˜ é›†ç´„ã€æ˜ ç”»é›†ç´„ ã€ƒ äºˆç´„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ äºˆç´„é›†ç´„ å‰²å¼•ã‚’é¸æŠã™ã‚‹ é©ç”¨å‰²å¼•ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ äºˆç´„é›†ç´„ æ”¯æ‰•ã„é‡‘é¡ã‚’ç¢ºèªã™ã‚‹ æ”¯æ‰•æ–™é‡‘ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ æ”¯æ‰•ã„æ–™é‡‘é›†ç´„ ã€ƒ æ–™é‡‘åŒºåˆ†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¿ã‚¤ãƒ—ã‚³ãƒ¼ãƒ‰ï¼ˆEnumï¼‰ æ–™é‡‘è¨­å®šé›†ç´„ å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚ºã«å…¥ã£ã¦ã‹ã‚‰ã®è©±ã«ãªã‚‹ãŒã€æ–™é‡‘åŒºåˆ†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯Enumã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã«ãªã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚ ï¼ˆï¼•ï¼‰ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å›³ã‚’æ›´æ–°ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ æŠ½å‡ºã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä¾‹ å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ æŠ½å‡ºã•ã‚ŒãŸé›†ç´„ æ˜ ç”»ã€ä¸Šæ˜ æ—¥æ™‚ã€æšæ•°ã‚’é¸æŠã™ã‚‹ ä¸Šæ˜ æ™‚é–“å¸¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ä¸Šæ˜ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€æ˜ ç”»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ä¸Šæ˜ é›†ç´„ã€æ˜ ç”»é›†ç´„ ã€ƒ äºˆç´„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ äºˆç´„é›†ç´„ å‰²å¼•ã‚’é¸æŠã™ã‚‹ é©ç”¨å‰²å¼•ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ äºˆç´„é›†ç´„ æ”¯æ‰•ã„é‡‘é¡ã‚’ç¢ºèªã™ã‚‹ æ”¯æ‰•æ–™é‡‘ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ æ”¯æ‰•ã„æ–™é‡‘é›†ç´„ ã€ƒ æ–™é‡‘åŒºåˆ†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¿ã‚¤ãƒ—ã‚³ãƒ¼ãƒ‰ï¼ˆEnumï¼‰ æ–™é‡‘è¨­å®šé›†ç´„ ã€ƒ æ–™é‡‘åŒºåˆ†è¨ˆç®—ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ æ–™é‡‘åŒºåˆ†è¨ˆç®—é›†ç´„ ï¼ˆï¼–ï¼‰é›†ç´„é–“ã®é–¢ä¿‚æ€§ã®ã¿ã«ç€ç›®ã™ã‚‹ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã®é–¢ä¿‚æ€§ã¯è¤‡é›‘ã§ã‚ã‚‹ãŒã€é›†ç´„é–“ã¯å˜ç´”ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚ "},"public/software/software_application_architecture_backend_domain_driven_design_clean_architecture.html":{"url":"public/software/software_application_architecture_backend_domain_driven_design_clean_architecture.html","title":"ğŸ“– ï¸ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£","keywords":"","body":"ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦ ãƒ»æ€æƒ³ DDDãŒé©ã™ã‚‹æ©Ÿèƒ½è¦ä»¶ã®å¤šã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã ã‘ã§ãªãã€ã‚ã‚‰ã‚†ã‚‹ç¨®é¡ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«é©ç”¨ã§ãã‚‹ã€‚ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åŸè‘—ã®åºæ–‡ã«ã¦ã€è‘—è€…ã¯ã€ç§ã¯ã€ä»Šã¾ã§è‰²ã€…ãªç¨®é¡ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã£ã¦ããŸãŒã€ã©ã®ã‚·ã‚¹ãƒ†ãƒ ã‚‚ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚‚ãƒ«ãƒ¼ãƒ«ã¯åŒã˜ã ã£ãŸã€‚ç•°ãªã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã‚‚åŒã˜ãƒ«ãƒ¼ãƒ«ã‚’å…±æœ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€ã¨ã„ã†ã‚ˆã†ãªã“ã¨ã‚’è¿°ã¹ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/B07FSBHS2V ãƒ»æ§‹æˆ å‚è€ƒï¼šhttps://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html 02. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆé»„ç·‘ï¼‰ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ© ãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¨ã¯ å…¥åŠ›ï¼å‡ºåŠ›ã®å‡¦ç†æ™‚ã§ã€è²¬å‹™ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«åˆ†é¡ã§ãã‚‹ã€‚ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®è²¬å‹™ã‚’ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ‡ã‚Šåˆ†ã‘ã¦ã‚‚è‰¯ã„ã€‚ å…¥åŠ›æ™‚ï¼å‡ºåŠ›æ™‚ è²¬å‹™ è£œè¶³ å…¥åŠ› ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ãƒ«ãƒ¼ã‚¿ã‹ã‚‰å…¥åŠ›ã•ã‚Œã‚‹èªè¨¼æƒ…å ±ã‚’ç…§åˆã—ã€èªè¨¼ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ èªè¨¼ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã‚ã‚‹ã„ã¯ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«å®Ÿè£…ã™ã‚‹ã€‚å‚è€ƒï¼šãƒ»https://github.com/little-hands/ddd-q-and-a/issues/173 ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã‹ã‚‰å…¥åŠ›ã•ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’APIä»•æ§˜ï¼ˆå¿…é ˆã€æ›¸å¼ã€ãªã©ï¼‰ã¨ç…§ã‚‰ã—åˆã‚ã›ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿ã®å€¤ãŒAPIä»•æ§˜ã¨æ¯”è¼ƒã—ã¦æ­£ã—ã„ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã“ã¨ã«æ­¢ã¾ã‚Šã€ãƒ‡ãƒ¼ã‚¿ã®å€¤ãŒæ­£ã—ã„ã‹ã©ã†ã‹ã®æ¤œè¨¼ã¯ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã‚„ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«å®Ÿè£…ã™ã‚‹ã€‚ ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã‹ã‚‰å…¥åŠ›ã•ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã—ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã«å…¥åŠ›ã™ã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ç”Ÿæˆå‡¦ç†ã§ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¸ã®ä¾å­˜ãŒå¿…è¦ã«ãªã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ç”Ÿæˆå‡¦ç†ã‚’åˆ‡ã‚Šåˆ†ã‘ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«ç½®ãã¨ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãŒãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ä¾å­˜ã™ã‚‹ã“ã¨ã‚’é˜²ã’ã‚‹ã€‚ å‡ºåŠ› ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’ã€JSONãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã«è¿”ä¿¡ã™ã‚‹ã€‚ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’APIã¨ã—ã¦ç”¨ã„ã‚‹å ´åˆã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã‚’ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«å‡ºåŠ›ã™ã‚‹ã€‚ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ç”¨ã„ã¦HTMLã‚’ç”Ÿæˆã™ã‚‹å ´åˆã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ ãƒ»ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã¨ã¯ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã€ã€‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’æŒã¤ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®æ™‚ã«ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ä¸€æ–¹ã§ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’å®Œå…¨ã«åˆ†é›¢ã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒJSONãƒ‡ãƒ¼ã‚¿ã‚’è¿”ä¿¡ã™ã‚‹APIã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹å ´åˆã‚„ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’çµ„ã¿è¾¼ã‚€å ´åˆã¯ã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã‚’ç”¨ã„ãªã„ã€‚è£œè¶³ã¨ã—ã¦ã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒªã¯ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãŸã‚ã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã‚’ç”¨ã„ãªã‘ã‚Œã°ã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒªã‚‚ç”¨ã„ãªã„ã€‚ å‚è€ƒï¼š https://izumisy.work/entry/2019/12/12/000521 https://codezine.jp/article/detail/9749 ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€ã¤ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®å¿…é ˆã‚„æ›¸å¼ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ—¥æ™‚ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ¤œè¨¼ã™ã‚‹ã€‚ validate($dateTime)) { return false; } return true; } } 03. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ï¼ˆèµ¤ï¼‰ å‡¦ç†ãƒ•ãƒ­ãƒ¼ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã‹ã‚‰ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã¾ã§ã®å‡¦ç†ã®æµã‚Œã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ å‚è€ƒï¼šhttp://www.plainionist.net/Implementing-Clean-Architecture-Controller-Presenter/ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã¨ã¯ å…¥åŠ›ï¼å‡ºåŠ›ã®å‡¦ç†æ™‚ã§ã€è²¬å‹™ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«åˆ†é¡ã§ãã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã”ã¨ã«ç•°ãªã‚‹Interactorã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã™ã‚‹æ–¹æ³•ã¨ã€å…¨ã¦ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’è²¬å‹™ã¨ã—ã¦ã‚‚ã¤Interactorã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã€‚ã¾ãŸã€Interactorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ç”¨æ„ã—ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¯ã“ã‚Œã‚’çµŒç”±ã—ã¦ã€å®Ÿè£…Interactorã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å…¥åŠ›æ™‚ï¼å‡ºåŠ›æ™‚ è²¬å‹™ è£œè¶³ å…¥åŠ› ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰å…¥åŠ›ã•ã‚Œã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ä¸Šã®ãƒ«ãƒ¼ãƒ«ã¨ç…§ã‚‰ã—åˆã‚ã›ã¦ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿ã®å€¤ãŒã‚·ã‚¹ãƒ†ãƒ ä¸Šã‚ã‚Šå¾—ãªã„ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ãƒ“ã‚¸ãƒã‚¹ä¸Šã‚ã‚Šå¾—ãªã„å€¤ã‹ã©ã†ã‹ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«Specificationãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ãƒ¦ãƒ¼ã‚¶ã®è¦æ±‚ã«å¯¾ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æŒ¯èˆï¼ˆãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼‰ã‚’å…·ç¾åŒ–ã™ã‚‹ã€‚ ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰å…¥åŠ›ã•ã‚Œã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã«æ¸¡ã›ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã™ã‚‹ã€‚ å‡ºåŠ› ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã—ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«å‡ºåŠ›ã™ã‚‹ã€‚ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’APIã¨ã—ã¦ç”¨ã„ã‚‹å ´åˆã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’çµŒã¦ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã«å¤‰æ›ã—ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«å‡ºåŠ›ã™ã‚‹ã€‚ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ç”¨ã„ã¦HTMLã‚’ç”Ÿæˆã™ã‚‹å ´åˆã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ ãƒ»ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¨ãƒ¡ã‚½ãƒƒãƒ‰å ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã§ã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã‚’çµ„ã¿åˆã‚ã›ã¦ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æŒ¯èˆï¼ˆãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼‰ã‚’å…·ç¾åŒ–ã™ã‚‹ã€‚ãã®ãŸã‚ã€ãƒ¡ã‚½ãƒƒãƒ‰åã¯ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’é©åˆ‡ã«è¡¨ç¾ã—ãŸè‡ªç”±ãªè‹±å˜èªã‚’ç”¨ã„ã‚‹ã€‚Laravelã®åŸºæœ¬çš„ãªãƒ¡ã‚½ãƒƒãƒ‰åï¼ˆindexã€storeã€createã€showã€updateã€ï¼‰ãŒå‚è€ƒã«ãªã‚‹ã€‚CREATEå‡¦ç†ã¨UPDATEå‡¦ç†ã‚’SAVEå‡¦ç†ã¨ã—ã¦ã¾ã¨ã‚ã¦ã‚‚ã‚ˆã„ã€‚ ãƒ¡ã‚½ãƒƒãƒ‰å å¼•æ•°å‹ è¿”å´å€¤å‹ å‡¦ç†å†…å®¹ indexFoo indexFooRequest indexFooResponse showFoo showFooRequest showFooResponse createFoo createFooRequest createFooResponse updateFoo updateFooRequest updateFooResponse saveFooï¼ˆupsertFooï¼‰ saveFooRequestï¼ˆupsertFooRequestï¼‰ saveFooResponseï¼ˆupsertFooResponseï¼‰ ãƒªãƒã‚¸ãƒˆãƒªã®findãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ã¦é‡è¤‡ç¢ºèªã‚’å®Ÿè¡Œã—ã€ãã®çµæœã«å¿œã˜ã¦createãƒ¡ã‚½ãƒƒãƒ‰ã¾ãŸã¯updateãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚å‚è€ƒï¼šhttps://github.com/little-hands/ddd-q-and-a/issues/241 deleteFoo deleteFooRequest deleteFooResponse ãƒ»ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_object_oriented_analysis_and_design.html ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’APIã¨ã—ã¦ç”¨ã„ã‚‹å ´åˆã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã¯ä¸è¦ã¨ãªã‚‹ã€‚ã“ã®å ´åˆã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ fooRepository = $fooRepository; } /** * @param CreateFooRequest $createFooRequest * @return CreateFooResponse */ public function createFoo(CreateFooRequest $createFooRequest): CreateFooResponse { $foo = $this->fooRepository->create( new Bar($createFooRequest->bar), new Baz($createFooRequest->baz) ); // ä½•ã‚‰ã‹ã®å‡¦ç† } } fooRepository = $fooRepository; } /** * @param CreateFooRequest $createFooRequest * @return CreateFooResponse */ public function createFoo(CreateFooRequest $createFooRequest): CreateFooResponse { $foo = $this->fooRepository->create( new Bar($createFooRequest->bar), new Baz($createFooRequest->baz) ); // ä½•ã‚‰ã‹ã®å‡¦ç† } /** * @param GetFooRequest $getFooRequest * @return GetFooResponse */ public function getFoo(GetFooRequest $getFooRequest): GetFooResponse { $foo = $this->fooRepository->findById( new FooId($getFooRequest->id) ); // ä½•ã‚‰ã‹ã®å‡¦ç† } /** * @param UpdateFooRequest $updateFooRequest * @return UpdateFooResponse */ public function updateFoo(UpdateFooRequest $updateFooRequest): UpdateFooResponse { $foo = $this->fooRepository->update( new FooId($updateFooRequest->id), new Bar($updateFooRequest->bar), new Baz($updateFooRequest->baz) ); // ä½•ã‚‰ã‹ã®å‡¦ç† } /** * @param DeleteFooRequest $deleteFooRequest * @return DeleteFooResponse */ public function deleteFoo(DeleteFooRequest $deleteFooRequest): DeleteFooResponse { $foo = $this->fooRepository->delete( new FooId($deleteFooRequest->id) ); // ä½•ã‚‰ã‹ã®å‡¦ç† } } ã‚¤ãƒ³ãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒª ãƒ»ã‚¤ãƒ³ãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒªã¨ã¯ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã“ã¨ã€‚ä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã‚ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒª ãƒ»ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒªã¨ã¯ ä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã“ã¨ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã§ã¯ãªãã€‚ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒªã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã«å‡ºåŠ›ã™ã‚‹ã€‚ãŸã ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’APIã¨ã—ã¦ç”¨ã„ã‚‹å ´åˆã¯ã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã¨ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãƒã‚¦ãƒ³ãƒ€ãƒªãŒä¸è¦ã«ãªã‚Šã€ã“ã‚Œã«ä¼´ã„ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’è¿”å´ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ï¼ˆã‚¤ãƒ³ãƒ—ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ï¼‰ ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã¨ã¯ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰å…¥åŠ›ã•ã‚Œã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«å…¥åŠ›ã™ã‚‹æ™‚ã«ã€ãã®å…¥åŠ›æ§‹é€ ã‚’å®šç¾©ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã®ãƒ¡ã‚½ãƒƒãƒ‰ã”ã¨ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’ç”¨æ„ã™ã‚‹ã¨ã‚ˆã„ã€‚ fooId = $fooId; $this->fooName = $fooName; } } ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ï¼ˆã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ï¼‰ ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã¨ã¯ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã«å‡ºåŠ›ã™ã‚‹æ™‚ã«ã€ãã®å‡ºåŠ›æ§‹é€ ã‚’å®šç¾©ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã®ãƒ¡ã‚½ãƒƒãƒ‰ã”ã¨ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨æ„ã™ã‚‹ã¨ã‚ˆã„ã€‚ã¾ãŸã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã¦ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ä¾å­˜ã®JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’æ¸¡ã›ã‚‹ã‚ˆã†ã€ã‚¯ãƒ©ã‚¹è‡ªèº«ã®æ§‹é€ ã‚’å¤‰æ›ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒãŸã›ã‚‹ã¨ã‚ˆã„ã€‚ã‚‚ã—ã€ã‚¯ãƒ©ã‚¹è‡ªèº«ã‚’æ¸¡ã—ã¦å•é¡Œãªã„JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚ã‚Œã°ã€ã“ã‚Œã¯ä¸è¦ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®indexãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾å¿œã™ã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã€‚JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ãŒé…åˆ—æ§‹é€ ã‚’å¼•æ•°ã«å—ã‘ä»˜ã‘ã‚‹ãŸã‚ã€ã“ã‚Œã«æ¸¡ã›ã‚‹ã‚ˆã†ã€è‡ªèº«ã‚’é…åˆ—æ§‹é€ ã«å¤‰æ›ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒãŸã›ã‚‹ã€‚ foos = $foos; } /** * @return array */ public function toArray(): array { return [ \"foos\" => $this->foos ]; } } ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®createãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾å¿œã™ã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã€‚ fooId = $fooId; $this->fooName = $fooName; } /** * @return array */ public function toArray(): array { return [ \"id\" => $this->fooId, \"name\" => $this->fooName ]; } } ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¨ã¯ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«ãŠã„ã¦ã€ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¯¾è±¡ã¨ã—ãŸæ±ç”¨çš„ãªæŒ¯èˆãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ‡ã‚Šåˆ†ã‘ãŸã‚‚ã®ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦æä¾›ã™ã‚‹ã ã‘ã§ã€è‡ªèº«ã®çŠ¶æ…‹ã‚’å¤‰åŒ–ã•ã›ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯æŒãŸã›ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã¡ãªã¿ã«ã€ã€ã‚µãƒ¼ãƒ“ã‚¹ã€ã®æ¦‚å¿µã¯å…¨ã¦ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å­˜åœ¨ã™ã‚‹ã€‚ç‰¹å®šã®æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒ¼ãƒ“ã‚¹ã¨ã¿ãªã—ã¦é€£æºã™ã‚Œã°ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚‚ãªã‚‹ã€‚ ãƒ»é€šçŸ¥å‡¦ç† ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¸ã®é€šçŸ¥å‡¦ç†ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦åˆ‡ã‚Šåˆ†ã‘ã‚‹ã€‚ message = $message; } public function notify() { // Slackã®APIã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹å‡¦ç† } } ã“ã‚Œã‚’ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã§ã‚³ãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ notify(); } } 04. ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆé»„ï¼‰ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ ãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã¯ å¾Œè¿°ã®èª¬æ˜ã‚’å‚ç…§ã›ã‚ˆã€‚ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ»å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯ å¾Œè¿°ã®èª¬æ˜ã‚’å‚ç…§ã›ã‚ˆã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã¨ã¯ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ä¸­ã§ã€ãƒ“ã‚¸ãƒã‚¹çš„ãªã€å‡ºæ¥äº‹ã€ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ãŸã‚‚ã®ã€‚ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ç‰©ã€ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã€ç€çœ¼ç‚¹ãŒç•°ãªã‚‹ã€‚ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€ã¤ã§ã‚ã‚‹ã€Pubï¼Subãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã®æ¦‚å¿µã‚’ç”¨ã„ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼‰ã®é–¢é€£ã‚’è¡¨ç¾ã™ã‚‹ã€‚ Type Codeï¼ˆæ¨™æº–å‹ï¼‰ ãƒ»Type Codeã¨ã¯ Type Codeã¯æ¦‚å¿µçš„ãªå‘¼ã³åã§ã€å®Ÿéš›ã¯ã€æ¨™æº–çš„ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦åˆ©ç”¨ã§ãã‚‹Enumã‚¯ãƒ©ã‚¹ã«ç›¸å½“ã™ã‚‹ã€‚ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹å¿…è¦ãŒãªã„ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã®ä¸­ã§ã‚‚ã€ç‰¹ã«ã€åŒºåˆ†ã€ã‚„ã€ç¨®é¡ã€ãªã©ã¯ã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã§ã¯ãªãã€Enumã‚¯ãƒ©ã‚¹ã¨ã—ã¦ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ï¼å®Ÿè£…ã™ã‚‹ã€‚ãŸã ã—ã€é¡ä¼¼ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«é…ç½®ã—ã¦ã‚‚è‰¯ã„ã€‚ ãƒ»è‰² ï¼Šå®Ÿè£…ä¾‹ï¼Š [\"name\" => \"ãƒ¬ãƒƒãƒ‰\"], self::BLUE => [\"name\" => \"ãƒ–ãƒ«ãƒ¼\"] ]; /** * å€¤ */ private $value; /** * è‰²å */ private $name; // ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã®æ™‚ã«ã€ã€è‰²ã®åŒºåˆ†å€¤ã€ã‚’å—ã‘å–ã‚‹ã€‚ public function __construct(string $value) { // $kbnValueã«å¿œã˜ã¦ã€è‰²åã‚’nameãƒ‡ãƒ¼ã‚¿ã«ã‚»ãƒƒãƒˆã™ã‚‹ã€‚ $this->value = $value; $this->name = static::$set[$value][\"name\"]; } /** * å€¤ã‚’è¿”å´ã—ã¾ã™ã€‚ */ public function value(): int { return $this->value; } /** * è‰²åã‚’è¿”å´ã—ã¾ã™ã€‚ */ public function name(): string { return $this->name; } } ãƒ»æ€§åˆ¥ ï¼Šå®Ÿè£…ä¾‹ï¼Š [\"name\" => \"ç”·æ€§\"], self::WOMAN => [\"name\" => \"å¥³æ€§\"], self::UNKNOWN => [\"name\" => \"ä¸æ˜\"], ]; /** * å€¤ */ private $value; /** * åå‰ */ private $name; public function __construct($value) { $this->value = $value; $this->name = static::$set[$value][\"name\"]; } /** * å€¤ã‚’è¿”å´ã—ã¾ã™ã€‚ */ public function value(): int { return $this->value; } /** * åå‰ã‚’è¿”å´ã—ã¾ã™ã€‚ */ public function name() { return $this->name; } } ãƒ»å¹´å· ï¼Šå®Ÿè£…ä¾‹ï¼Š [\"name\" => \"æ˜æ²»\"], self::TAISHO => [\"name\" => \"å¤§æ­£\"], self::SHOWA => [\"name\" => \"æ˜­å’Œ\"], self::HEISEI => [\"name\" => \"å¹³æˆ\"], self::REIWA => [\"name\" => \"ä»¤å’Œ\"], self::SEIREKI => [\"name\" => \"è¥¿æš¦\"], ]; private static $ymd = [ self::MEIJI => [ \"start\" => [ \"year\" => 1868, \"month\" => 1, \"day\" => 25, ], \"end\" => [ \"year\" => 1912, \"month\" => 7, \"day\" => 29, ], ], self::TAISHO => [ \"start\" => [ \"year\" => 1912, \"month\" => 7, \"day\" => 30, ], \"end\" => [ \"year\" => 1926, \"month\" => 12, \"day\" => 24, ], ], self::SHOWA => [ \"start\" => [ \"year\" => 1926, \"month\" => 12, \"day\" => 25, ], \"end\" => [ \"year\" => 1989, \"month\" => 1, \"day\" => 7, ], ], self::HEISEI => [ \"start\" => [ \"year\" => 1989, \"month\" => 1, \"day\" => 8, ], \"end\" => [ \"year\" => 2019, \"month\" => 4, \"day\" => 30, ], ], self::REIWA => [ \"start\" => [ \"year\" => 2019, \"month\" => 5, \"day\" => 1, ], \"end\" => [ \"year\" => 9999, \"month\" => 12, \"day\" => 31, ], ], ]; /** * å€¤ * * @var string */ private $value; /** * å¹´å·å * * @var string */ private $name; /** * å€¤ã‚’è¿”å´ã—ã¾ã™ * * @return string */ public function value(): string { return $this->value; } /** * @param $value */ public function __construct($value) { $this->value = $value; $this->name = static::$set[$value][\"name\"]; } /** * å¹´å·åã‚’è¿”å´ã—ã¾ã™ * * @return string */ public function name() { return $this->name; } } ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¨ã¯ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«æŒãŸã›ã‚‹ã¨ã‚„ã‚„ä¸è‡ªç„¶ã§ã€ä»–ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¯¾è±¡ã¨ã—ãŸæŒ¯èˆãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ‡ã‚Šåˆ†ã‘ãŸã‚‚ã®ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ä»–ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦æä¾›ã™ã‚‹ã ã‘ã§ã€è‡ªèº«ã®çŠ¶æ…‹ã‚’å¤‰åŒ–ã•ã›ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯æŒãŸã›ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚å…¨ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¸€ã¤ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã«ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ã‚ˆã‚Šã‚‚ã€å‹•ä½œã®ç¨®é¡ã”ã¨ã«åˆ†ã‘ã¦ç®¡ç†ã—ãŸæ–¹ãŒè‰¯ã„ã€‚ã“ã®æ™‚ã€ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã«å®Ÿè£…ã•ã‚Œã™ããªã„ã‚ˆã†ã«æ³¨æ„ã™ã‚‹ã€‚ã¡ãªã¿ã«ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã§ãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã‚‹ã“ã¨ã‚’å«Œã£ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®å‡¦ç†ã‚’ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã§å®šç¾©ã—ã¦ã‚‚å•é¡Œãªã„ã€‚ å‚è€ƒï¼š https://github.com/little-hands/ddd-q-and-a/issues/159 https://www.amazon.co.jp/dp/B082WXZVPC https://codezine.jp/article/detail/10318 ãƒ»é‡è¤‡ç¢ºèª ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã¦ã€è©²å½“ã®åå‰ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒDBã«å­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ãªãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®šç¾©ã—ã¦ã‚‚è‰¯ã„ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/45007667/cqrs-ddd-how-to-validate-products-existence-before-adding-them-to-order https://www.amazon.co.jp/dp/B082WXZVPC https://github.com/little-hands/ddd-q-and-a/issues/573 ï¼Šå®Ÿè£…ä¾‹ï¼Š fooRepositoy = $fooRepositoy; } /** * ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒã™ã§ã«å­˜åœ¨ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚ * * @param Foo $foo * @return bool */ public function exists(Foo $foo): bool { $foo = $this->fooRepository ->findByName($foo->name()); return $foo !== null; } } ãƒ»èªå¯ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã¦ã€è©²å½“ã®IDã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å¯¾ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ãªãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®šç¾©ã—ã¦ã‚‚è‰¯ã„ã€‚ å‚è€ƒï¼š https://lessthan12ms.com/authorization-and-authentication-in-clean-architecture.html https://medium.com/@martinezdelariva/authentication-and-authorization-in-ddd-671f7a5596ac https://github.com/lezhnev74/ema/blob/master/src/Domain/Note/Commands/ModifyNote/ModifyNoteAuthorizer.php https://github.com/little-hands/ddd-q-and-a/issues/121 ï¼Šå®Ÿè£…ä¾‹ï¼Š fooRepositoy = $fooRepositoy; } /** * æ›´æ–°å‡¦ç†ã‚’å®Ÿè¡Œå¯èƒ½ã‹ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚ * * @param FooId $fooId * @param UserId $userId * @return bool */ public function canUpdateById(FooId $fooId, UserId $userId): bool { return $this->fooRepository ->findById($fooId) ->userId ->equals($userId); } } ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ä¾‹å¤– ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ä¾‹å¤–å‡¦ç†ã‚’ã¾ã¨ã‚ãŸä¾‹å¤–ã‚¯ãƒ©ã‚¹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Specificationãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ»Specificationãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€ã¤ã€‚è²¬å‹™ã¨ã—ã¦ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€æ¤œç´¢æ¡ä»¶å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’æŒã¤ã€‚ã“ã‚Œã‚‰ã‚’ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰å†…éƒ¨ã«æŒãŸã›ãŸå ´åˆã€è‚¥å¤§åŒ–ã®åŸå› ã¨ãªã‚Šã€ã¾ãŸåŸ‹ã‚‚ã‚Œã¦ã—ã¾ã†ãŸã‚ã€å¯èª­æ€§ã¨ä¿å®ˆæ€§ãŒæ‚ªã„ã€‚ãã“ã§ã€ã“ã†ã„ã£ãŸãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’Specificationã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦åˆ‡ã‚Šåˆ†ã‘ã¦ãŠãã€‚ ãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ çœŸå½å€¤ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆisFooãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã®ã‚ˆã†ã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ã—ã¦ã€ä»•æ§˜ã‚’è¦æ±‚ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹ã€ä½•ã‚‰ã‹ã®ç›®çš„ã®ãŸã‚ã®ç”¨æ„ãŒã§ãã¦ã„ã‚‹ã‹ã‚’èª¿ã¹ã‚‹å‡¦ç†ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š isX) return false; if (!$entity->isY) return false; if (!$entity->isZ) return false; return true; } } ãƒ»æ¤œç´¢æ¡ä»¶å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¼•æ•°ã¨ã—ã¦ã€æ¤œç´¢æ¡ä»¶ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†Specificationã‚¯ãƒ©ã‚¹ã¨åŒºåˆ¥ã™ã‚‹ãŸã‚ã«ã€Criteriaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã„ã†åå‰ã¨ã—ã¦ã‚‚ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š id = $array[\"id\"]; } if (isset($array[\"name\"])) { $criteria->id = $array[\"name\"]; } if (isset($array[\"email\"])) { $criteria->id = $array[\"email\"]; } return $criteria; } } 04-02. ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ­ã‚¸ãƒƒã‚¯ã®æµå‡º ãƒ‰ãƒ¡ã‚¤ãƒ³è²§è¡€ç—‡ ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³è²§è¡€ç—‡ã¨ã¯ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã»ã¨ã‚“ã©æŒãŸãªã„çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒã‚²ãƒƒã‚¿ãƒ¼ã¨ã‚»ãƒƒã‚¿ãƒ¼ã—ã‹æŒã£ã¦ã„ãªã„ã€‚ã“ã‚Œã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³è²§è¡€ç—‡ã§ã‚ã‚‹ã€‚ userId = $userId; $this->userName = $userName; } /** * @return UserId */ public function id() { return $this->userId; } /** * @return UserName */ public function userName() { return $this->userName; } } ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®æµå‡º ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã«åˆ‡ã‚Šåˆ†ã‘ã™ãã‚‹ã¨ã€åŒã˜ããƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å®Ÿè£…ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ãŒãªããªã£ã¦ã—ã¾ã„ã€ãƒ‰ãƒ¡ã‚¤ãƒ³è²§è¡€ç—‡ã«ãªã‚‹ã€‚ãã®ãŸã‚ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹å±¤ã®æ§‹ç¯‰ã¯æ§ãˆã‚ã«ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®æµå‡º ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«å®Ÿè£…ã—ã¦ã—ã¾ã†ã¨ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å®Ÿè£…ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ãŒãªããªã£ã¦ã—ã¾ã„ã€ãƒ‰ãƒ¡ã‚¤ãƒ³è²§è¡€ç—‡ã«ãªã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®ã„ãšã‚Œã«å®Ÿè£…ã™ã‚‹ã¹ãã‹ã¯ã€ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®å¯¾è±¡ãŒãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã«åŸºã¥ãã‚‚ã®ãªã®ã‹ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢åˆ©ç”¨è€…ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«åŸºã¥ãã‚‚ã®ãªã®ã‹ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/B082WXZVPC 05-02. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã¯ è²¬å‹™ã¨ã—ã¦ã€ãƒ“ã‚¸ãƒã‚¹ã®ãƒ«ãƒ¼ãƒ«ã‚„åˆ¶ç´„ã®å®šç¾©ã‚’æŒã¡ã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯åŒºåˆ¥ã•ã‚Œã‚‹ã€‚ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®è²¬å‹™ã‚’ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ‡ã‚Šåˆ†ã‘ã¦ã‚‚è‰¯ã„ã€‚ è­˜åˆ¥å¯èƒ½ ãƒ»è­˜åˆ¥å¯èƒ½ã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè­˜åˆ¥å­ï¼ˆä¾‹ï¼šIDãªã©ï¼‰ã‚’æŒã¡ã€ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨åŒã˜å±æ€§ã‚’ã‚‚ã£ã¦ã„ã¦ã‚‚ã€åŒºåˆ¥ã•ã‚Œã‚‹ã€‚ã“ã®è­˜åˆ¥å­ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚ type = $type; $this->name = $name; $this->number = $number; $this->priceVO = $priceVO; $this->colorVO = $colorVO; } /** * çŠ¬ç”¨ãŠã‚‚ã¡ã‚ƒåï¼ˆè‰²ï¼‰ã‚’è¿”å´ã—ã¾ã™ã€‚ * * @return string */ public function nameWithColor() { return sprintf( \"%sï¼ˆ%sï¼‰\", $this->name->value(), $this->colorVO->name() ); } } è­˜åˆ¥å­ã«ã‚ˆã‚‹ç­‰ä¾¡æ€§æ¤œè¨¼ ãƒ»è­˜åˆ¥å­ã«ã‚ˆã‚‹ç­‰ä¾¡æ€§æ¤œè¨¼ã¨ã¯ ç­‰ä¾¡æ€§æ¤œè¨¼ç”¨ã®equalsãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤ã€‚ä¿æŒã™ã‚‹è­˜åˆ¥å­ãŒã€å¯¾è±¡ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨åŒã˜å ´åˆã€åŒä¸€ã®ã‚‚ã®ã¨è¦‹ãªã•ã‚Œã‚‹ã€‚ ãƒ»ç­‰ä¾¡æ€§ã®æ¤œè¨¼æ–¹æ³• å…¨ã¦ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«ç­‰ä¾¡æ€§ã®æ¤œè¨¼ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒãŸã›ã‚‹ã¨å¯èª­æ€§ãŒä½ã„ã€‚ãã“ã§ã€å…¨ã¦ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«ç­‰ä¾¡æ€§æ¤œè¨¼ç”¨ã®equalsãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒãŸã›ã‚‹ã“ã¨ã‚’ã‚„ã‚ã€ç¶™æ‰¿å…ƒã®æŠ½è±¡ã‚¯ãƒ©ã‚¹ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«ã“ã‚Œã‚’å®šç¾©ã™ã‚‹ã¨ã‚ˆã„ã€‚ id->equals($entity->id()); // IDã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç­‰ä¾¡æ€§ } /** * IDã‚¯ãƒ©ã‚¹ã‚’è¿”å´ã—ã¾ã™ã€‚ */ public function id(): Id { return $this->id; } } ãƒ»è¤‡åˆä¸»ã‚­ãƒ¼ã¸ã®å¯¾å¿œï¼ˆPHPã§ã¯ä¸è¦ï¼‰ ä»¥é™ã®èª¬æ˜ã¯Javaã«ã¤ã„ã¦é©ç”¨ã•ã‚Œã‚‹ãŸã‚ã€PHPã§ã¯ä¸è¦ã§ã‚ã‚‹ã€‚è¤‡åˆä¸»ã‚­ãƒ¼ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾å¿œã™ã‚‹ãŸã‚ã«ã€ä¸»ã‚­ãƒ¼ã¨ãªã‚‹æ–¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå´ã«ã€equalsãƒ¡ã‚½ãƒƒãƒ‰ã¨hashãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¨€èªæ¨™æº–æ­è¼‰ã®equalsãƒ¡ã‚½ãƒƒãƒ‰ã¨hashãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã€ç•°ãªã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«æ¸¡ã£ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¯”è¼ƒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã‚Œã‚‰ã‚’å®šç¾©ã—ãªã„ã¨ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã•ã‚Œãšã«æ¨™æº–æ­è¼‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚æ¨™æº–æ­è¼‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€ç•°ãªã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«æ¸¡ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ¯”è¼ƒã§ã¯ã€å¿…ãšç•°ãªã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã¨åˆ¤å®šã—ã¦ã—ã¾ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š PHPã§ã¯ä¸è¦ã§ã‚ã‚‹ãŒã€å‚è€ƒã¾ã§ã«ã€PHPã§å®Ÿè£…ã—ãŸã€‚ id = $id; } /** * ãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¿”å´ã—ã¾ã™ã€‚ * * NOTE: è¤‡åˆä¸»ã‚­ãƒ¼ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç­‰ä¾¡æ€§ã‚’æ­£ã—ãæ¤œè¨¼ã™ã‚‹ãŸã‚ã«ã€æ¨™æº–ã®é–¢æ•°ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¾ã™ã€‚ * * @return string */ public function hash(): string { return $this->id; } /** * ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç­‰ä¾¡æ€§ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚ * * NOTE: è¤‡åˆä¸»ã‚­ãƒ¼ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç­‰ä¾¡æ€§ã‚’æ­£ã—ãæ¤œè¨¼ã™ã‚‹ãŸã‚ã«ã€æ¨™æº–ã®é–¢æ•°ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¾ã™ã€‚ * * @param Id $id * @return bool */ public function equals(Id $id): bool { return ($id instanceof $this || $this instanceof $id) // IDã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿å‹ã®ç­‰ä¾¡æ€§ && $this->hash() == $id->hash(); // ãƒãƒƒã‚·ãƒ¥å€¤ã®ç­‰ä¾¡æ€§ } } ãƒ‡ãƒ¼ã‚¿ã®å¯å¤‰æ€§ï¼ä¸å¤‰æ€§ ãƒ»å¯å¤‰æ€§ï¼ä¸å¤‰æ€§ã®å®Ÿç¾æ–¹æ³•ï¼ˆMutableï¼Immutableï¼‰ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‡ãƒ¼ã‚¿ã¯å¯å¤‰ï¼ä¸å¤‰ãƒ‡ãƒ¼ã‚¿ã®ã„ãšã‚Œã§ã‚ã£ã¦ã‚‚ã‚ˆã„ã€‚ãŸã ã—ã€ãã‚‚ãã‚‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä¸å¤‰ã§ã‚ã‚‹æ–¹ãŒæœ›ã¾ã—ã„ãŸã‚ã€å¯å¤‰çš„ãªãƒ‡ãƒ¼ã‚¿ã¯æœ€å°é™ã«ã™ã‚‹ã€‚å¤‰åŒ–ã•ã›ã¦ã‚‚å•é¡Œãªã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å¯¾ã—ã¦ã¯ã‚»ãƒƒã‚¿ãƒ¼ã‚’å®šç¾©ã—ã€ä¸å¤‰çš„ãªãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã¯ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ã‚’è¨±å¯ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚‚ã¡ã‚ã‚“ã€ã‚»ãƒƒã‚¿ãƒ¼å†…ã§ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ä¸å¤‰æ€§ã®å®Ÿç¾æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ 05-03. å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯ è²¬å‹™ã¨ã—ã¦ã€ãƒ“ã‚¸ãƒã‚¹ã®ãƒ«ãƒ¼ãƒ«ã‚„åˆ¶ç´„ã®å®šç¾©ã‚’æŒã¡ã€ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨åŒºåˆ¥ã•ã‚Œã‚‹ã€‚é‡‘é¡ã€æ•°å­—ã€é›»è©±ç•ªå·ã€æ–‡å­—åˆ—ã€æ—¥ä»˜ã€æ°åã€è‰²ãªã©ã®ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¨ã€ä¸€æ„ã§è­˜åˆ¥ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ï¼ˆä¾‹ãˆã°ã€$idãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’æŒã¤ã€‚ è­˜åˆ¥ä¸å¯èƒ½ ãƒ»è­˜åˆ¥ä¸å¯èƒ½ã¨ã¯ ä¸€æ„ã«è­˜åˆ¥ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ãŸãšã€å¯¾è±¡ã®ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤ ãƒ»é‡‘é¡ é‡‘é¡ãƒ‡ãƒ¼ã‚¿ã®è¨ˆç®—ã‚’Interactorå†…å‡¦ç†ã‚„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å†…ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œã†ã®ã§ã¯ãªãã€é‡‘é¡è¨ˆç®—ã‚’è¡Œã†å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦åˆ†å‰²ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š amount = (float) $amount; } /** * é‡‘é¡ã‚’è¿”å´ã—ã¾ã™ * * @return float */ public function amount() { return $this->amount; } /** * å˜ä½ã‚’è¿”å´ã—ã¾ã™ * * @return string */ public function unit() { return \"å††\"; } /** * è¶³ã—ç®—ã®çµæœã‚’è¿”å´ã—ã¾ã™ * * @param Money $price * @return $this */ public function add(Money $price) { return new static($this->amount + $price->amount); } /** * å¼•ãç®—ã®çµæœã‚’è¿”å´ã—ã¾ã™ * * @param Money $price * @return $this */ public function substract(Money $price) { return new static($this->amount - $price->amount); } /** * æ›ã‘ç®—ã®çµæœã‚’è¿”å´ã—ã¾ã™ * * @param Money $price * @return $this */ public function multiply(Money $price) { return new static($this->amount * $price); } } ãƒ»æ‰€è¦æ™‚é–“ æ‰€è¦æ™‚é–“ãƒ‡ãƒ¼ã‚¿ã®è¨ˆç®—ã‚’Interactorã‚¯ãƒ©ã‚¹å†…å‡¦ç†ã‚„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å†…ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œã†ã®ã§ã¯ãªãã€æ‰€è¦æ™‚é–“è¨ˆç®—ã‚’è¡Œã†å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦åˆ†å‰²ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š distance = $distance; } /** * å¾’æ­©ã¾ãŸã¯è»Šã®ã©ã¡ã‚‰ã‚’ç”¨ã„ã‚‹ã‹ã‚’åˆ¤å®šã—ã¾ã™ * * @return bool */ public function isMinuteByWalking(): bool { if ($this->distance * 1000 / self::WALKING_SPEED_PER_MINUTE distance * 1000 / self::WALKING_SPEED_PER_MINUTE; return ceil($minute); } /** * è»Šã§ã®æ‰€ç”¨æ™‚é–“ã‚’è¨ˆç®—ã—ã¾ã™ * * @return float */ public function minuteByCar(): float { $minute = $this->distance * 1000 / self::CAR_SPEED_PER_MINUTE; return ceil($minute); } } ãƒ»ä½æ‰€ éƒµä¾¿ç•ªå·ãƒ‡ãƒ¼ã‚¿ã¨ãã®å‡¦ç†ã‚’å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦åˆ†å‰²ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š city = $city; $this->zip = $zip; $this->address = $address; } /** * éƒµä¾¿ç•ªå·ã‚’ç”Ÿæˆã—ã€è¿”å´ã—ã¾ã™ * * @return string */ public function zip() { return sprintf( \"ã€’%s-%s\", substr($this->zip, 0, 3), substr($this->zip, 3) ); } /** * ä½æ‰€ã‚’ç”Ÿæˆã—ã€è¿”å´ã—ã¾ã™ * * @return string */ public function address(): string { return sprintf( \"%s%s%s\", $this->city->prefecture->name ?? '', $this->city->name ?? '', $this->address ?? '' ); } } ãƒ»æ°å æ°åã€æ€§åˆ¥ã€ãƒ‡ãƒ¼ã‚¿ã¨ãã®å‡¦ç†ã‚’å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦åˆ†å‰²ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š lastName = $lastName; $this->firstName = $firstName; $this->lastKanaName = $lastKanaName; $this->firstKanaName = $firstKanaName; } /** * æ°åã‚’ä½œæˆã—ã¾ã™ã€‚ */ public function fullName(): string { return $this->lastName . $this->firstName; } /** * ã‚«ãƒŠæ°åã‚’ä½œæˆã—ã¾ã™ã€‚ */ public function fullKanaName(): string { return $this->lastKanaName . $this->firstKanaName; } } ãƒ‡ãƒ¼ã‚¿ã®ä¸å¤‰æ€§ï¼ˆImmutableï¼‰ ãƒ»ä¸å¤‰æ€§ã®å®Ÿç¾æ–¹æ³• å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä¸å¤‰çš„ã§ã‚ã‚Šã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦ç”Ÿæˆã•ã‚Œã¦ä»¥é™ã€ãƒ‡ãƒ¼ã‚¿ã¯å¤‰æ›´ã•ã‚Œãªã„ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸å¤‰æ€§ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚»ãƒƒã‚¿ãƒ¼ã‚’å®šç¾©ã—ãªã„ã‚ˆã†ã«ã—ã€ãƒ‡ãƒ¼ã‚¿ã®è¨­å®šã«ã¯constructãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š propertyA = $propertyA; $this->propertyB = $propertyB; $this->propertyC = $propertyC; } } ãƒ»ã‚»ãƒƒã‚¿ãƒ¼ã§ã¯ä¸å¤‰çš„ã«ãªã‚‰ãªã„ç†ç”± ï¼Šå®Ÿè£…ä¾‹ï¼Š Test01ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property01ãƒ‡ãƒ¼ã‚¿ã«å€¤ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ã‚»ãƒƒã‚¿ãƒ¼ã‚’å‘¼ã³å‡ºã™ã€‚ã‚»ãƒƒã‚¿ãƒ¼ã¯ä½•åº¦ã§ã‚‚å‘¼ã³å‡ºã›ã€ãã®åº¦ã«ãƒ‡ãƒ¼ã‚¿ã®å€¤ã‚’ä¸Šæ›¸ãã§ãã¦ã—ã¾ã†ã€‚ setProperty01(\"ãƒ‡ãƒ¼ã‚¿01ã®å€¤\"); $test01->setProperty01(\"æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿01ã®å€¤\"); Test02ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property02ãƒ‡ãƒ¼ã‚¿ã«å€¤ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚Šç›´ã•ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã¤ã¾ã‚Šã€ä»¥å‰ã«ä½œã£ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property02ã®å€¤ã¯ä¸Šæ›¸ãã§ããªã„ã€‚ã‚»ãƒƒã‚¿ãƒ¼ã‚’æŒãŸã›ãšã«ã€constructãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã‚’æŒãŸã›ã‚Œã°ã€ä¸å¤‰çš„ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ãªã‚‹ã€‚ ãƒ»éå‰°ãªã‚²ãƒƒã‚¿ãƒ¼ã¸ã®å¯¾å‡¦æ³• ä¸å¤‰çš„ãªãƒ‡ãƒ¼ã‚¿ã¯ã‚²ãƒƒã‚¿ãƒ¼ã‚’ç”¨ã„ãªã‘ã‚Œã°ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã€‚ãã®ãŸã‚ã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ã‚’è¿”å´ã™ã‚‹ã ã‘ã®ã‚²ãƒƒã‚¿ãƒ¼ãŒé‡ç”£ã•ã‚Œã€ãƒ•ã‚¡ã‚¤ãƒ«ã®è¦‹é€šã—ãŒæ‚ªããªã£ã¦ã—ã¾ã†ã€‚ãã“ã§ã€ä¾‹ãˆã°PHPã§ã¯ã€ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã®__getãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ã‚²ãƒƒã‚¿ãƒ¼ã®å®Ÿè£…ã‚’çœç•¥ã§ãã‚‹ã€‚å…¨ã¦ã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åŸºåº•ã‚¯ãƒ©ã‚¹ã«ã€ã€ã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸã‚²ãƒƒã‚¿ãƒ¼ãŒã‚¯ãƒ©ã‚¹å†…ã«å­˜åœ¨ã—ã¦ã„ãªã‘ã‚Œã°ã€å‹•çš„ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦è¿”å´ã™ã‚‹ã€å‡¦ç†ã‚’æŒã£ãŸ__getãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¦ãŠãã€‚ã™ã‚‹ã¨ã€ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰æ©Ÿèƒ½ã«ã‚ˆã‚Šã€è‡ªèº«ã§å®šç¾©ã—ãŸ__getãƒ¡ã‚½ãƒƒãƒ‰ãŒä»£ã‚ã‚Šã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã€ã‚²ãƒƒã‚¿ãƒ¼ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒãªããªã‚‹ã€‚ {$name}; } } class Foo { use ImmutableTrait; private $bar; public function __constructor($bar) { $this->bar = $bar } } $foo = new Foo() $foo->bar // __getãƒ¡ã‚½ãƒƒãƒ‰ãŒä»£ã‚ã‚Šã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ãŒè¿”å´ã•ã‚Œã‚‹ã€‚ æ¦‚å¿µçš„ãªçµ±ä¸€ä½“ äº¤æ›å¯èƒ½æ€§ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ–°ã—ãã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã•ã‚ŒãŸå ´åˆã€ä»¥å‰ã«åŒä¸€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰æ–°ã—ãç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å±æ€§ã«ã‚ˆã‚‹ç­‰ä¾¡æ€§ ãƒ»å±æ€§ã«ã‚ˆã‚‹ç­‰ä¾¡æ€§æ¤œè¨¼ã¨ã¯ ç­‰ä¾¡æ€§ã‚’æ¤œè¨¼ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤ã€‚ä¿æŒã™ã‚‹å…¨ã¦ã®å±æ€§ãŒã€å¯¾è±¡ã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨åŒã˜å ´åˆã€åŒä¸€ã®ã‚‚ã®ã¨è¦‹ãªã•ã‚Œã‚‹ã€‚ ãƒ»ç­‰ä¾¡æ€§ã®æ¤œè¨¼æ–¹æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š å±æ€§ã‚’ä¸€ã¤ã ã‘ä¿æŒã™ã‚‹å ´åˆã€ä¸€ã¤ã®å±æ€§ã®ã¿ã‚’æ¤œè¨¼ã™ã‚Œã°è‰¯ã„ãŸã‚ã€ä»¥ä¸‹ã®é€šã‚Šã¨ãªã‚‹ã€‚ value = $value; } /** * @return string */ public function value(): string { return $this->value; } /** * å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç­‰ä¾¡æ€§ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚ * * @param ValueObject $VO * @return bool */ public function equals(ValueObject $VO): bool { // å˜ä¸€ã®å±æ€§ã‚’å¯¾è±¡ã¨ã™ã‚‹ã€‚ return $this->value() === $VO->value(); } } å±æ€§ã‚’è¤‡æ•°ä¿æŒã™ã‚‹å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆã€å…¨ã¦ã®å±æ€§ã‚’æ¤œè¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®é€šã‚Šã¨ãªã‚‹ã€‚ paymentType = $paymentType; $this->contactMail = $contactMail; $this->price = $price; } /** * å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç­‰ä¾¡æ€§ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚ * * @param ValueObject $VO * @return bool */ public function equals(ValueObject $VO): bool { // è¤‡æ•°ã®å±æ€§ã‚’å¯¾è±¡ã¨ã™ã‚‹ã€‚ return $this->paymentType->value() === $VO->paymentType->value() && $this->contactMail->value() === $VO->contactMail->value() && $this->price->value() === $VO->price->value(); } } å…¨ã¦ã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ç­‰ä¾¡æ€§ã®æ¤œè¨¼ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒãŸã›ã‚‹ã¨å¯èª­æ€§ãŒä½ã„ã€‚ãã“ã§ã€ç¶™æ‰¿å…ƒã®æŠ½è±¡ã‚¯ãƒ©ã‚¹ã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å®šç¾©ã™ã‚‹ã¨ã‚ˆã„ã€‚ãã®æ™‚ã¯ã€ä¿æŒã—ã¦ã„ã‚‹å±æ€§ã‚’åå¾©çš„ã«æ¤œè¨¼ã§ãã‚‹ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹ã¨ã‚ˆã„ã€‚ $value) { if ($this->__get($key) !== $VO->__get($key)) { return false; } } return true; } } 05-04. ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ ãƒ»ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã¯ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãªã‚‹é›†ç´„ã®ä¸­ã§ã€æœ€çµ‚çš„ã«ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã¸ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã‚‹é›†ç´„ã‚’ã€ã€ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€ã¨ã„ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š dogToy = $dogToy; $this->dogFood = $dogFood; } /** * çŠ¬ç”¨ãŠã‚‚ã¡ã‚ƒã‚’è¿”å´ã—ã¾ã™ã€‚ * * @return DogToy */ public function getDogToy(): DogToy { return $this->dogToy; } /** * çŠ¬ãˆã•ã‚’è¿”å´ã—ã¾ã™ã€‚ * * @return DogFood */ public function getDogFood(): DogFood { return $this->dogFood; } } ãƒ»é›†ç´„ã¨ã¯ ãƒ‡ãƒ¼ã‚¿ã‚’ã‚»ãƒƒãƒˆã§æ‰±ã†å¿…è¦ãŒã‚ã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ã¾ã¨ã¾ã‚Šã®ã“ã¨ã€‚ä¾å­˜é–¢ä¿‚ã®è¦³ç‚¹ã‹ã‚‰ã¿ãŸé›†ç´„ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based.html ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¨ã®é–¢ä¿‚æ€§ ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ã€ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å˜ä½ã§ã€ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãè¾¼ã¿ï¼èª­ã¿å‡ºã—ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å®šç¾©ã¥ã‘ã‚‹æ™‚ã®æ³¨æ„ç‚¹ã¨ã—ã¦ã€é›†ç´„ã®å˜ä½ãŒå¤§ãéãã‚‹ã¨ã€ä¸€éƒ¨åˆ†ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ã¿ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å¯¾è±¡ã¨ã™ã‚Œã°è‰¯ã„å‡¦ç†ã§ã‚ã‚‹ã®ã«ã‚‚é–¢ã‚ã‚‰ãšã€ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å…¨ä½“ã¾ã§å¯¾è±¡ã¨ã—ãªã‘ã‚Œã°ãªã‚‰ãªããªã‚‹ã€‚ãã®ãŸã‚ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨ã—ã¦ã®ã¾ã¨ã¾ã‚Šã¨ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã®ã¾ã¨ã¾ã‚Šã®ä¸¡æ–¹ã‹ã‚‰ã€ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å˜ä½ã‚’å®šç¾©ã¥ã‘ã‚‹ã¨ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://qiita.com/mikesorae/items/ff8192fb9cf106262dbf#%E5%AF%BE%E7%AD%96-1 06. ã‚¤ãƒ³ãƒ•ãƒ©å±¤ï¼ˆé’ï¼‰ ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ä¾å­˜æ€§é€†è»¢ ãƒ»DIPï¼ˆä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼‰ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/?q=%E4%BE%9D%E5%AD%98%E6%80%A7%E9%80%86%E8%BB%A2 ãƒ»ç™ºè¡¨ã‚¹ãƒ©ã‚¤ãƒ‰ ãƒªãƒã‚¸ãƒˆãƒª ãƒ»ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€ã¤ã€‚ä¸€ä¾‹ã¨ã—ã¦ã€ä»¥ä¸‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤ã€‚å…·ä½“çš„ãªå®Ÿè£…ã«ã¤ã„ã¦ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã®å®Ÿè£…ã‚’å‚è€ƒã«ã›ã‚ˆã€‚CREATEå‡¦ç†ã¨UPDATEå‡¦ç†ã‚’SAVEå‡¦ç†ã¨ã—ã¦ã¾ã¨ã‚ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼š https://codewithshadman.com/repository-pattern-csharp/ https://sf9v.github.io/posts/generating-the-repository-pattern-in-go/#introduction https://terasolunaorg.github.io/guideline/public_review/ImplementationAtEachLayer/DomainLayer.html#repository-interface-label ãƒ¡ã‚½ãƒƒãƒ‰å å¼•æ•°å‹ è¿”å´å€¤å‹ å‡¦ç†å†…å®¹ findById Idå‹ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å‹ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’å–å¾—ã™ã‚‹ã€‚ findAll ãªã— ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å‹ã‚’æŒã¤é…åˆ— å…¨ã¦ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’å–å¾—ã™ã‚‹ã€‚ findAllByCriteria Criteriaå‹ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å‹ã‚’æŒã¤é…åˆ— æ¡ä»¶ã«åˆè‡´ã—ãŸå…¨ã¦ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’å–å¾—ã™ã‚‹ã€‚ create ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å‹ voidå‹ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ update ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å‹ voidå‹ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’æ›´æ–°ã™ã‚‹ã€‚ saveï¼ˆupsertï¼‰ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å‹ voidå‹ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆï¼æ›´æ–°ã™ã‚‹ã€‚SELECTæ–‡ã®INå¥ã‚’ç”¨ã„ã¦ã€åŒã˜è­˜åˆ¥å­ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’DBã‹ã‚‰å–å¾—ã§ãã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚å–å¾—ã§ããªã„å ´åˆã¯ã€æ›´æ–°å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚å‚è€ƒï¼šãƒ»https://github.com/little-hands/ddd-q-and-a/issues/241ãƒ»https://github.com/little-hands/ddd-q-and-a/issues/129 delete Idå‹ voidå‹ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ ãƒ»ä»–ã®é¡ä¼¼ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã®æ¯”è¼ƒ ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ é§†å‹•ã®ç¨®é¡ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®é–¢é€£åº¦åˆã„ æ¡ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¾‹ é©æ‰€ è£œè¶³ Active Record ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é§†å‹• ãƒ»éå¸¸ã«å¼·ã„ã€‚ãƒ»æ‰‹é †ã¨ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆãŒå…ˆã«ã‚ã‚Šã€ä¸€ã¤ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ãŒä¸€ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ã«ã‚ˆã£ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ãŒæ±ºã¾ã‚‹ã€‚ ãƒ»Eloquentï¼ˆPHPï¼‰ãƒ»Active Recordï¼ˆRubyï¼‰ãƒ»Hibernateï¼ˆJavaï¼‰ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ã§ãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‚è€ƒï¼šhttps://www.informit.com/articles/article.aspx?p=1398618&seqNum=3 DataMapperãƒ‘ã‚¿ãƒ¼ãƒ³ã¨åŒã˜ãã€ORMã®å®Ÿè£…æ–¹æ³•ã®ä¸€ã¤ã§ã‚ã‚‹ã€‚å‚è€ƒï¼šhttps://culttt.com/2014/06/18/whats-difference-active-record-data-mapper/ Data Mapper ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹• ãƒ»å¼±ã„ãƒ»Entityãƒãƒãƒ¼ã‚¸ãƒ£ã‚’ç”¨ã„ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’DBã«æ°¸ç¶šåŒ–ã™ã‚‹ã€‚ Doctrine ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‚è€ƒï¼šhttps://www.informit.com/articles/article.aspx?p=1398618&seqNum=3 ActiveRecordãƒ‘ã‚¿ãƒ¼ãƒ³ã¨åŒã˜ãã€ORMã®å®Ÿè£…æ–¹æ³•ã®ä¸€ã¤ã§ã‚ã‚‹ã€‚å‚è€ƒï¼šhttps://culttt.com/2014/06/18/whats-difference-active-record-data-mapper/ Repository ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹• ãƒ»å¼±ã„ãƒ»æ‰‹é †ã¨ã—ã¦ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®ä¾å­˜é–¢ä¿‚ã®è¨­è¨ˆãŒå…ˆã«ã‚ã‚Šã€ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®é–¢ä¿‚æ€§ã¯è‡ªç”±ã§ã‚ã‚‹ã€‚ä¸€ã¤ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ãŒè¤‡æ•°ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‚ç…§ã—ã¦ã‚‚ã‚ˆã„ã€‚ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ DBã€RDMSã€NoSQLã€ãªã‚“ã§ã‚‚ã§ã‚‚ã‚ˆã„ã€‚ ãªã— ãªã— éå¸¸ã«å¼±ã„ DBãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ ãƒ»å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒª ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç”¨ã„ã‚‹ã€‚è²¬å‹™ã¨ã—ã¦ã€DBã«å¯¾ã—ã¦ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãè¾¼ã¿ï¼èª­ã¿å‡ºã—ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å˜ä½ã¨ã—ã¦å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãƒªãƒã‚¸ãƒˆãƒªã‚‚åŒã˜ããƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å˜ä½ã¨ã—ã¦å®šç¾©ã¥ã‘ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ãã®ãŸã‚ã€å¼•æ•°ã®å‹ã¯ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å‹ã«ãªã‚‹ã€‚ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’æ„è­˜ã—ã¦å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ä¸€æ–¹ã§ã€DBã®ã©ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã‹ã‚’å•ã‚ãªã„ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨DBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆ¥ã€…ã«è¨­è¨ˆã§ãã‚‹ã€‚ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®é–¢ä¿‚æ€§ã«ã¤ã„ã¦ã¯ã€å‰è¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚DBãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_database.html ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒª ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ã‚’å°å…¥ã™ã‚‹å ´åˆã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã‚’é…ç½®ã™ã‚‹ã€‚ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ©ã‚¹ã¨å¯¾å¿œé–¢ä¿‚ã«ã‚ã‚‹ã€‚å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã«ã¤ã„ã¦ã¯ã€å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»DBã«å¯¾ã™ã‚‹æ›¸ãè¾¼ã¿è²¬å‹™ï¼ˆCreateã€Updateã€Deleteï¼‰ DBã«å¯¾ã™ã‚‹æ›¸ãè¾¼ã¿æ“ä½œã‚’è¡Œã†ã€‚ GETï¼POSTã«ã‚ˆã£ã¦ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã‹ã‚‰å€¤ãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ ãƒ•ã‚¡ã‚¯ãƒˆãƒªã«ã‚ˆã£ã¦ã€é€ä¿¡ã•ã‚ŒãŸå€¤ã‹ã‚‰ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ã•ã‚‰ã«ã€ãã‚Œã‚‰ã‹ã‚‰ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ä½œæˆã™ã‚‹ã€‚ ãƒªãƒã‚¸ãƒˆãƒªã«ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’æ¸¡ã™ã€‚ ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦DBã«æŒ¿å…¥ã™ã‚‹ã€‚ å‚è€ƒï¼š https://www.doctrine-project.org/projects/doctrine-orm/en/2.8/reference/query-builder.htm https://github.com/doctrine/dbal/blob/2.12.x/lib/Doctrine/DBAL/Query/QueryBuilder.php ï¼Šå®Ÿè£…ä¾‹ï¼Š CREATEå‡¦ç†ã®ãŸã‚ã€Doctrineã®QueryBuilderã‚¯ãƒ©ã‚¹ã®insertãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ createQueryBuilder(); // SQLã‚’å®šç¾©ã™ã‚‹ã€‚ $query->insert(\"dog_toy_table\") ->values([ // ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®è¦ç´ ã‚’ã‚«ãƒ©ãƒ å€¤ã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚ï¼ˆIDã¯AutoIncrementï¼‰ \"name\" => $dogToy->getName()->value(), \"type\" => $dogToy->getType()->value(), \"price\" => $dogToy->getPriceVO()->value(), \"color\" => $dogToy->getColorVO()->value(), ]); } } UPDATEå‡¦ç†ã®ãŸã‚ã€Doctrineã®QueryBuilderã‚¯ãƒ©ã‚¹ã®updateãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ createQueryBuilder(); // SQLã‚’å®šç¾©ã™ã‚‹ã€‚ $query->update(\"dog_toy_table\", \"dog_toy\") // ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®è¦ç´ ã‚’ã‚«ãƒ©ãƒ å€¤ã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚ ->set(\"dog_toy.name\", $dogToy->getName()->value()) ->set(\"dog_toy.type\", $dogToy->getType()->value()) ->set(\"dog_toy.price\", $dogToy->getPriceVO()->value()) ->set(\"dog_toy.color\", $dogToy->getColorVO()->value()) ->where(\"dog_toy.id\", $dogToy->getId()->value(); return $query->getResult(); } } DELETEå‡¦ç†ï¼ˆè«–ç†å‰Šé™¤ï¼‰ã®ãŸã‚ã€Doctrineã®QueryBuilderã‚¯ãƒ©ã‚¹ã®updateãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ createQueryBuilder(); // SQLã‚’å®šç¾©ã™ã‚‹ã€‚ $query->update(\"dog_toy_table\", \"dog_toy\") // è«–ç†å‰Šé™¤ ->set(\"dog_toy.is_deleted\", FlagConstant::IS_ON) ->where(\"dog_toy.id\", $dogToy->getId()->value(); return $query->getResult(); } } ãƒ»DBã«å¯¾ã™ã‚‹èª­ã¿å‡ºã—è²¬å‹™ï¼ˆReadï¼‰ DBã«å¯¾ã™ã‚‹æ›¸ãè¾¼ã¿æ“ä½œã‚’è¡Œã†ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã‹ã‚‰é›†ç´„ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚Œã‚‹ã€‚ DBã‹ã‚‰ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã€‚ ãƒ•ã‚¡ã‚¯ãƒˆãƒªã«ã‚ˆã£ã¦ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’è¿”å´ã—ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«æ¸¡ã™ã€‚ å‚è€ƒï¼š https://www.doctrine-project.org/projects/doctrine-orm/en/2.8/reference/query-builder.htm https://github.com/doctrine/dbal/blob/2.12.x/lib/Doctrine/DBAL/Query/QueryBuilder.php ï¼Šå®Ÿè£…ä¾‹ï¼Š READå‡¦ç†ã®ãŸã‚ã€Doctrineã®QueryBuilderã‚¯ãƒ©ã‚¹ã®selectãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ createQueryBuilder(); // SQLã‚’è¨­å®šã™ã‚‹ã€‚ $query->select( \"dog_toy.id AS dog_toy_id\", \"dog_toy.name AS dog_toy_name\", \"dog_toy.type AS dog_toy_type\", \"dog_toy.price AS dog_toy_price\", \"dog_toy.color AS dog_toy_color\" ) ->from(\"dog_toy_table\", \"dog_toy\") // è«–ç†å‰Šé™¤ã•ã‚Œã¦ã„ãªã„ã‚‚ã®ã®ã¿ ->where(\"dog_toy.is_deleted\", FlagConstant::IS_OFF) ->getQuery(); // SQLã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $entities = $query->getResult(); $dogToys = []; foreach($entities as $entity){ // å–å¾—ã—ãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã™ã‚‹ã€‚ $dogToys[] = $this->toDogToy($entity); } return $dogToys; } /** * ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã—ã¾ã™ã€‚ */ private function toDogToy(array $entity): DogToy { $dogToy = new DogToy( new DogId($entity[\"dog_toy_id\"]), new DogName($entity[\"dog_toy_name\"]), new DogToyType($entity[\"dog_toy_type\"]), new PriceVO($entity[\"dog_toy_price\"], new ColorVO($entity[\"dog_toy_color\"] ); return $dogToy; } } ãƒ•ã‚¡ã‚¯ãƒˆãƒª ãƒ»ãƒ•ã‚¡ã‚¯ãƒˆãƒªã¨ã¯ è²¬å‹™ã¨ã—ã¦ã€æ–°ãŸãªé›†ç´„ã®ä½œæˆã‚„ã€æ—¢å­˜ã®é›†ç´„ã®å†ä½œæˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ«ãƒ¼ã‚¿ ãƒ»ãƒ«ãƒ¼ã‚¿ã¨ã¯ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã€‚ ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ ãƒ»ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã¯ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å¾Œã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¡ã‚½ãƒƒãƒ‰ã®å‰ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹BeforeMiddleã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å®Ÿè¡Œæ™‚ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹AfterMiddlewareãŒã‚ã‚‹ã€‚æœ€è¿‘ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã‚‚æ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã€‚ ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼‰ ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã¨ã¯ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸå ´åˆã€ãã‚Œã«ç´ä»˜ãå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®æ©Ÿèƒ½ã«ä¾å­˜ã™ã‚‹ã“ã¨ã«ãªã‚‹ãŸã‚ã€å®Ÿè£…ã®è©³ç´°ã‚’ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã«ãŠãã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/67148194/domain-driven-design-ddd-domain-event-handlers-where-to-place-them https://zenn.dev/fuuuuumin65/articles/2c96e8f0b29c01 ãƒ»å‘½åè¦å‰‡ ã‚¤ãƒ™ãƒ³ãƒˆã§ãƒªã‚¹ãƒŠãƒ¼ã‚’ä½¿ã„å›ã•ãšã«ã€å„ã‚¤ãƒ™ãƒ³ãƒˆã”ã¨ã«ãƒªã‚¹ãƒŠãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚ãã®ãŸã‚ã€åå‰ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆåã€ï¼‹Listenerï¼ˆHandlerï¼‰ã¨ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.microsoft.com/ja-jp/dynamicsax-2012/developer/naming-conventions-delegates-and-event-handlers#event-handler-naming-conventions ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚µãƒ¼ãƒ“ã‚¹ ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚µãƒ¼ãƒ“ã‚¹ã¨ã¯ ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ä¸­ã§ã€æ±ç”¨çš„ãªãƒ­ã‚¸ãƒƒã‚¯ãŒåˆ‡ã‚Šåˆ†ã‘ã‚‰ã‚ŒãŸã‚‚ã®ã€‚å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã¨åŒæ§˜ã«ã—ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¨­ã‘ã€ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ã‚’æº€ãŸã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»ãƒ­ã‚®ãƒ³ã‚° ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ› ãƒ»ãƒãƒƒã‚·ãƒ¥åŒ– ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥åŒ–ã€‚ å‚è€ƒï¼šhttps://dev.to/stevensunflash/using-domain-driven-design-ddd-in-golang-3ee5 07. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¥ã®ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ ã‚¹ãƒ­ãƒ¼ã•ã‚ŒãŸä¾‹å¤–ã®æ‰±ã„ å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã¯ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã ã‘ã«ç•™ã¾ã‚Šã€ã‚¹ãƒ­ãƒ¼ã•ã‚ŒãŸä¾‹å¤–ã‚’å¯¾å‡¦ã™ã‚‹è²¬å‹™ã¯ã€ã‚ˆã‚Šä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«æŒãŸã›ã‚‹ã€‚ã‚ˆã‚Šä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã¯ã€ãã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«åˆã£ãŸä¾‹å¤–ã«è©°ã‚æ›¿ãˆã¦ã€ã“ã‚Œã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã€‚æœ€çµ‚çš„ã«ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã¾ã§æŒã¡ä¸Šã’ã€ç”»é¢ä¸Šã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã§è­¦å‘Šæ–‡ã¨ã—ã¦ã“ã‚Œã‚’è¡¨ç¤ºã™ã‚‹ã€‚ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã®æ„ç¾©ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_logic_error_and_error_handling.html ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ ãƒ»ä¾‹å¤– final class PresentationException extends Exception { } ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ ãƒ»ä¾‹å¤– final class InteractorException extends Exception { } ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ ãƒ»ä¾‹å¤– final class DomainException extends Exception { } ã‚¤ãƒ³ãƒ•ãƒ©å±¤ ãƒ»ä¾‹å¤– final class InfrastructureException extends Exception { } "},"public/software/software_application_architecture_backend_cqrs.html":{"url":"public/software/software_application_architecture_backend_cqrs.html","title":"ğŸ“– ï¸CQRS","keywords":"","body":"CQRSï¼šCommand Query Responsibility Segregation ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. CQRS CQRSã¨ã¯ ã€Command Query Responsibility Segregationï¼ˆã‚³ãƒãƒ³ãƒ‰ã‚¯ã‚¨ãƒªè²¬å‹™åˆ†é›¢ï¼‰ã€ã®ç•¥ã€‚ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãŠã‘ã‚‹æ›´æ–°ç³»ã¨å‚ç…§ç³»ã®å‡¦ç†ã‚’åˆ†é›¢ã™ã‚‹è¨­è¨ˆã®ã“ã¨ã€‚æ›´æ–°ç³»ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ãã®ã¾ã¾ãƒªãƒã‚¸ãƒˆãƒªã¨ã—ã¦ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã«ç½®ãã€‚ä¸€æ–¹ã§å‚ç…§ç³»ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å‚ç…§ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¿œã˜ã¦ã€QueryServiceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã¨ã—ã¦è¨­è¨ˆã—ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«ç½®ãï¼ˆã“ã‚Œé‡è¦ï¼‰ã€‚ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«éƒ¨åˆ†çš„ã«çµ„ã¿è¾¼ã‚ã‚‹ã€‚N+1å•é¡Œã«ã‚‚å¯¾å‡¦ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://vaadin.com/learn/tutorials/ddd/tactical_domain_driven_design https://little-hands.hatenablog.com/entry/2019/12/02/cqrs ãƒ¡ãƒªãƒƒãƒˆ ä¸€è¦§ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯è¤‡æ•°ã®é›†ç´„ã‹ã‚‰ãªã‚‹ãŸã‚ã€ãã‚Œãã‚Œã®é›†ç´„ã«å¯¾å¿œã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã®å‚ç…§ç³»å‡¦ç†ã‚’é †ã€…ã«ã‚³ãƒ¼ãƒ«ã—ã€å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’çµ„ã¿åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãã®ãŸã‚ã€ä¸€è¦§è¡¨ç¤ºã®åº¦ã«è¤‡æ•°ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã¨ãªã‚Šã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«æ‚ªå½±éŸ¿ãŒå‡ºã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ã¾ãŸã€ç•°ãªã‚‹ãƒªãƒã‚¸ãƒˆãƒªã‚’ã¾ãŸã„ã§WHEREå¥ã‚’ç”¨ã„ã‚‹ã“ã¨ã¯ã§ããªã„ãŸã‚ã€è¤‡æ•°ã®é›†ç´„ã«æ¸¡ã‚‹çµã‚Šè¾¼ã¿æ¤œç´¢ã‚’å®Ÿè£…ã§ããªã„ã€‚ã—ã‹ã—CQRSã‚’ç”¨ã„ã‚‹ã¨ã€æ›´æ–°ç³»ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ãƒªãƒã‚¸ãƒˆãƒªã€ä¸€æ–¹ã§å‚ç…§ç³»ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¿œã˜ãŸQueryServiceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦è¨­è¨ˆã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ãã®ãŸã‚ã€æ›´æ–°ç³»ã§ã¯é›†ç´„ã®å˜ä½ã‚’ãã®ã¾ã¾ã«ã—ã¦ã€é›†ç´„ã¨ã¯ç„¡é–¢ä¿‚ãªå‚ç…§ç³»å‡¦ç†ã‚’è¨­è¨ˆã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://little-hands.hatenablog.com/entry/2019/12/02/cqrs 01-02. å‡¦ç†ç³»ã®ç¨®é¡ Commandï¼ˆæ›´æ–°ç³»ï¼‰ ãƒ»Commandã¨ã¯ CREATEã€UPDATEã€DELETEå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®ã“ã¨ã€‚ä»Šå›ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å‰æã¨ã—ã¦CQRSã‚’èª¬æ˜ã™ã‚‹ã€‚æ¦‚å¿µã‚„å®Ÿè£…æ–¹æ³•ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design_clean_architecture.html https://github.com/hiroki-it/ddd-api-with-laravel#ddd-api-with-laravel ãƒ»å‡¦ç†é †åº ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã«ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ã“ã‚Œã‚’ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ãƒªãƒã‚¸ãƒˆãƒªã«æ¸¡ã™ã€‚ ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®æ›¸ãè¾¼ã¿ï¼èª­ã¿å‡ºã—ãƒªãƒã‚¸ãƒˆãƒªã«ã¦ã€IDãƒ¢ãƒ‡ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ã€èª­ã¿å‡ºã—ï¼æ›¸ãè¾¼ã¿ãƒªãƒã‚¸ãƒˆãƒªã§SELECTæ–‡ã‚’å®Ÿè¡Œã—ã€DBã‹ã‚‰ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’é…åˆ—ã¨ã—ã¦å–å¾—ã™ã‚‹ã€‚ç¶šã‘ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã€é…åˆ—ã®å€¤ã‚’ä¸Šæ›¸ãã™ã‚‹ã€‚ã“ã®é…åˆ—ã§INSERTï¼UPDATEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®å®Ÿè£…ã¯ã€å…¨ã¦ã‚’è‡ªå‰ã§å®Ÿè£…ã›ãšã«ORMã§ä»£ç”¨ã§ãã‚‹ã€‚voidå‹ã‚’ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã«æ¸¡ã™ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã«ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ä½œæˆã—ãŸæ™‚ã«ç”¨ã„ãŸãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«æ¸¡ã™ã€‚ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’JSONã«å¤‰æ›ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ Queryï¼ˆå‚ç…§ç³»ï¼‰ ãƒ»Queryã¨ã¯ READå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã“ã¨ã€‚ä»Šå›ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å‰æã¨ã—ã¦CQRSã‚’èª¬æ˜ã™ã‚‹ã€‚Queryã§ã¯æ¦‚å¿µã‚„å®Ÿè£…æ–¹æ³•ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design_clean_architecture.html https://github.com/hiroki-it/ddd-api-with-laravel#ddd-api-with-laravel ãƒ»å‡¦ç†é †åº ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¯ã‚¿ãƒ¼ã«ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã€QueryCriteriaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆå‚ç…§ç³»æ¤œç´¢æ¡ä»¶ï¼‰ã‚’ä½œæˆã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¿œã˜ãŸQueryServiceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã„ã¦ã€QueryCriteriaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”¨ã„ã¦ã€DBã‹ã‚‰ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’é…åˆ—ã¨ã—ã¦å–å¾—ã™ã‚‹ã€‚ã“ã®é…åˆ—ã‹ã‚‰ãã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¯¾å¿œã™ã‚‹DTOã‚’ä½œæˆã™ã‚‹ã€‚DTOã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«ã¨è¦‹ãªã—ã€ãã®ã¾ã¾ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«æ¸¡ã™ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/19620404/entity-vs-dto-in-cqrs https://softwareengineering.stackexchange.com/questions/378909/in-what-layer-are-the-dtos-stored-with-cqrs ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã¦ã€DTOã‚’JSONã«å¤‰æ›ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ 02. CQRSã«åŸºã¥ãã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ CQRSã¨ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã®é–¢ä¿‚ ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã®å®Ÿè£…æ–¹æ³•ã¯æ§˜ã€…ã‚ã‚‹ã€‚ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã§ã¯DBã‚¢ã‚¯ã‚»ã‚¹ã®å‡¦ç†ã‚’æ›´æ–°ç³»ã¨å‚ç…§ç³»ã«åˆ†é›¢ã™ã‚‹ã“ã¨ã«ãªã‚‹ãŸã‚ã€CQRSã®æ–¹æ³•è«–ã¨ç›¸æ€§ãŒè‰¯ã„ã€‚ å‚è€ƒï¼š https://little-hands.hatenablog.com/entry/2019/12/02/cqrs https://postd.cc/using-cqrs-with-event-sourcing/ "},"public/software/software_application_architecture_frontend.html":{"url":"public/software/software_application_architecture_frontend.html","title":"ğŸ“– ï¸ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£","keywords":"","body":"ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. SPAï¼šSingle Page Application SPAã¨ã¯ ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ã‚¹ãƒ†ãƒƒãƒ— å®Ÿè¡Œè€… Loading ãƒ–ãƒ©ã‚¦ã‚¶ Scripting ãƒ–ãƒ©ã‚¦ã‚¶ Rendering ãƒ–ãƒ©ã‚¦ã‚¶ Paiting ãƒ–ãƒ©ã‚¦ã‚¶ 1ã¤ã®Webãƒšãƒ¼ã‚¸ã®ä¸­ã§ã€ã‚µãƒ¼ãƒã¨ãƒ‡ãƒ¼ã‚¿ã‚’éåŒæœŸé€šä¿¡ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶å´ã§éƒ¨åˆ†çš„ã«é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’è¡Œã†ãŸã‚ã€SSRã¨æ¯”è¼ƒã—ã¦CSRï¼šClient Server side Renderingã¨ã‚‚ã„ã†ã€‚éåŒæœŸé€šä¿¡ã¯ã€Ajaxã®æ‰‹æ³•ã‚’ç”¨ã„ã¦å®Ÿç¾ã•ã‚Œã‚‹ã€‚ã¾ãŸã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®éƒ¨åˆ†çš„ãªç”Ÿæˆã¯ã€MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã£ã¦å®Ÿç¾ã™ã‚‹ã€‚SPAã§ã¯ã€ãƒšãƒ¼ã‚¸å…¨ä½“ã®é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã®ã¯æœ€åˆã®ã¿ã§ã€ãã‚Œä»¥é™ã¯ãƒšãƒ¼ã‚¸å…¨ä½“ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã“ã¨ã¯ãªã„ã€‚ï¼’å›ç›®ä»¥é™ã¯ã€ãƒšãƒ¼ã‚¸éƒ¨åˆ†çš„ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã€ã‚µãƒ¼ãƒå´ã‹ã‚‰JSONã‚’å—ã‘å–ã£ã¦ã„ãã€‚ å‚è€ƒï¼šhttps://developers.google.com/analytics/devguides/collection/analyticsjs/single-page-applications?hl=ja SPAã®å®Ÿè£…æ–¹æ³• ãƒ»MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ Viewå±¤ã¨Modelå±¤ã®é–“ã«ViewModelå±¤ã‚’ç½®ãã€Viewå±¤ã¨ViewModelå±¤ã®é–“ã§åŒæ–¹å‘ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚„ã‚Šå–ã‚Šï¼ˆåŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€Viewå±¤ã¨Modelå±¤ã®é–“ã‚’ç–çµåˆã«ã™ã‚‹ãŸã‚ã®è¨­è¨ˆæ‰‹æ³•ã®ä¸€ã¤ã€‚Vue.jsã§ã¯ã€æ„è­˜ã›ãšã«MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚è©³ã—ãã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_framework_vuejs.html SPAã¨å¾“æ¥MPAã®æ¯”è¼ƒ ãƒ»å‡¦ç†é€Ÿåº¦ MPAã¨æ¯”è¼ƒã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’éåŒæœŸçš„ã«é€šä¿¡ã§ãã‚‹ãŸã‚ã€1ã¤ã®Webãƒšãƒ¼ã‚¸ã®ä¸­ã§å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã ã‘ã‚’é€šä¿¡ã™ã‚Œã°ã‚ˆãã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒé€Ÿã„ã€‚ 02. SSRï¼šServer Side Rendering åºƒç¾©ã®SSRã¨ã¯ ãƒ–ãƒ©ã‚¦ã‚¶å´ã§ã¯ãªãã‚µãƒ¼ãƒå´ã§JavaScriptã‚’å®Ÿè¡Œã—ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚„CGIã‚’ç”¨ã„ã¦ã€ã‚µãƒ¼ãƒå´ã§é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã€ã‚‚å«ã¾ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://tadtadya.com/summary-of-the-web-site-display-process-flow/#index-list-8 https://ja.nuxtjs.org/docs/2.x/concepts/server-side-rendering ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ã‚¹ãƒ†ãƒƒãƒ— å®Ÿè¡Œè€… Loading ã‚µãƒ¼ãƒ Scripting ã‚µãƒ¼ãƒ Rendering ã‚µãƒ¼ãƒ Paiting ãƒ–ãƒ©ã‚¦ã‚¶ ç‹­ç¾©ã®SSRã¨ã¯ åºƒç¾©ã®SSRã«SPAã‚’å–ã‚Šå…¥ã‚ŒãŸæ–¹æ³•ã®ã“ã¨ã€‚ãƒ–ãƒ©ã‚¦ã‚¶å´ã§ã¯ãªãã‚µãƒ¼ãƒå´ã§JavaScriptã‚’å®Ÿè¡Œã—ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ã€‚ãƒ–ãƒ©ã‚¦ã‚¶å´ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸå¾Œã€ã‚¢ã‚¤ã‚½ãƒ¢ãƒ¼ãƒ•ã‚£ãƒƒã‚¯JavaScriptã¨ã„ã†ä»•çµ„ã¿ã§SPAã¨ã—ã¦å‹•ä½œã™ã‚‹ã€‚ å‚è€ƒï¼š https://qiita.com/rita0222/items/66fec6e7be5987bace3c https://qiita.com/kyrieleison/items/4ac5bcc331aee6394440#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%82%B5%E3%82%A4%E3%83%89%E3%81%A8%E3%82%B5%E3%83%BC%E3%83%90%E3%82%B5%E3%82%A4%E3%83%89%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89%E5%85%B1%E6%9C%89 03. SSGï¼šStatic Site Generation SSGã¨ã¯ äº‹å‰ã«ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã£ã¦é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ãŠãã€‚ãã—ã¦ã€ã“ã‚Œã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã€é™çš„ã‚µã‚¤ãƒˆã¨ã—ã¦ç¨¼åƒã•ã›ã‚‹ã€‚å‹•çš„ãªè¦ç´ ï¼ˆä¾‹ï¼šãƒ©ãƒ³ãƒ€ãƒ è¡¨ç¤ºï¼‰ã‚’å«ã‚€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ã¯ã€è©²å½“ã®éƒ¨åˆ†ã§Ajaxã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã€‚ 04. ISRï¼šIncremental Static Regeneration ISRã¨ã¯ SSGã®ç™ºå±•å‹ã€‚SSGã¨ã¯ç•°ãªã‚Šã€äº‹å‰ã«ãƒ“ãƒ«ãƒ‰ã›ãšã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ãªã„ã€‚ãã®ä»£ã‚ã‚Šã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã£ã¦åˆã‚ã¦ã€ãã®ãƒšãƒ¼ã‚¸ã®ã¿ãƒ“ãƒ«ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ä¸€å›ã§ã‚‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã£ãŸãƒšãƒ¼ã‚¸ã§ã¯ã€åˆå›æ™‚ã«ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ãŒãã®éƒ½åº¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://nextjs.org/docs/basic-features/data-fetching#incremental-static-regeneration 05. ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ UIéƒ¨å“åˆæˆ ãƒ»UIéƒ¨å“åˆæˆã¨ã¯ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã€å„ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾å¿œã™ã‚‹ã‚ˆã†ã«åˆ†å‰²ã™ã‚‹è¨­è¨ˆæ–¹æ³•ã€‚ BFFãƒ‘ã‚¿ãƒ¼ãƒ³ï¼šBackends For Frontends ãƒ»BFFãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç¨®é¡ï¼ˆãƒ¢ãƒã‚¤ãƒ«ã€Webã€ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼‰ã«å¿œã˜ãŸAPIã‚’æ§‹ç¯‰ã—ã€ã“ã®APIã‹ã‚‰å„ã‚µãƒ¼ãƒ“ã‚¹ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹è¨­è¨ˆæ–¹æ³•ã€‚BFFãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã¯å¯èƒ½ã§ã‚ã‚‹ãŒã€AWSã§ã„ã†API Gatewayã§ä»£ç”¨ã™ã‚‹ã¨ã‚ˆã‚Šç°¡å˜ã«å®Ÿç¾ã§ãã‚‹ã€‚ "},"public/software/software_application_collaboration_json.html":{"url":"public/software/software_application_collaboration_json.html","title":"ğŸ“– ï¸JSON","keywords":"","body":"JSON ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ‡ãƒ¼ã‚¿è¨˜è¿°è¨€èª ãƒ‡ãƒ¼ã‚¿è¨˜è¿°è¨€èªã®ç¨®é¡ ãƒ»JSONï¼šJavaScript Object Notation ä¸€ç•ªå¤–å´ã‚’æ³¢æ‹¬å¼§ã§å›²ã†ã€‚ { \"account\": 200, \"fruit\": [ \"banana\", \"apple\" ] } ãƒ»YAMLï¼šYAML Ain\"t a Markup Language account: 200 fruit: - \"banana\" - \"apple\" ãƒ»ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èª è©³ã—ãã¯ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_browser_rendering.html ãƒ»CSVï¼šComma Separated Vector ãƒ‡ãƒ¼ã‚¿è§£æã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã‚ˆãä½¿ã†ã‚„ã¤ã€‚ 02-01. JSå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€JSONã€PHPå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ JSå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ»å®šç¾©æ–¹æ³• ã‚­ãƒ¼ã¯ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã†å¿…è¦ãŒç„¡ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const object = { \"account\": 200, \"fruit\": [ \"banana\", \"apple\" ] }; class Foo { constructor(fruit, account) { this.fruit = fruit; this.account = account; } } JSON ãƒ»å®šç¾©æ–¹æ³• ã‚­ãƒ¼ã‚’ã€ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãªãã€ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã†å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const json = { \"account\": 200, \"fruit\": [ \"banana\", \"apple\" ] }; ãƒ»ã‚­ãƒ¼ã¨å€¤ã®å¤‰æ›´æ–¹æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š // ã©ã‚“ãªãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€JSONãªã®ã‹ã‚ã‹ã‚Šã‚„ã™ã„æ–¹æ³• const json = { \"age\": null, \"name\": null, \"tel\": null } json.age = 30; json.name = \"taro\"; json.tel = \"090-0123-4567\"; ï¼Šå®Ÿè£…ä¾‹ï¼Š const json = {} // areaã¨ã„ã†ã‚­ãƒ¼ã®å€¤ã‚’è¿½åŠ  json.prefecture = \"Tokyo\"; // ã‚‚ã—ãã¯ã€ json[\"prefecture\"] = \"Tokyo\"; // ä»¥ä¸‹ã¯ã€‚undefined ã«ãªã‚‹ã€‚äºŒæ®µéšã®å®šç¾©ã¯ã§ããªã„ã€‚ //// json.prefecture.area = \"Shibuya\"; ï¼Šå®Ÿè£…ä¾‹ï¼Š const json = { \"age\": 30, \"name\": \"taro\", \"tel\": \"090-0123-4567\" } // areaã¨ã„ã†ã‚­ãƒ¼ã®å€¤ã‚’è¿½åŠ  json.prefecture = \"Tokyo\"; // ã‚‚ã—ãã¯ã€ json[\"prefecture\"] = \"Tokyo\"; ãƒ»ã‚­ãƒ¼ã®ä¸¦ã³é † ã‚­ãƒ¼ã¯ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ä¸¦ã¹ã‚‹ã¨è‰¯ã„ã€‚ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã§ä¸¦ã³æ›¿ãˆã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://r37r0m0d3l.github.io/json_sort/ PHPå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ»å®šç¾©æ–¹æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š fruit = $fruit; $this->account = $account; } } 02-02. ç›¸äº’ãƒ‘ãƒ¼ã‚¹ï¼ˆã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼‹ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼‰ ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã€ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã¨ã¯ ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–“ ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã®ãŸã‚ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆJSå‹ã€PHPå‹ï¼‰ã‚’JSONã«å¤‰æ›ã™ã‚‹å‡¦ç†ã¯ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ã‚ã‚‹ã€‚ä¸€æ–¹ã§ã€é€ä¿¡ã®ãŸã‚ã«JSONã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆJSå‹ã€PHPå‹ï¼‰ã«å¤‰æ›ã™ã‚‹å‡¦ç†ã¯ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ã‚ã‚‹ã€‚ ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–“ ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã®ãŸã‚ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆPHPå‹ï¼‰ã‚’JSONã«å¤‰æ›ã™ã‚‹å‡¦ç†ã¯ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ã‚ã‚‹ã€‚ä¸€æ–¹ã§ã€é€ä¿¡ã®ãŸã‚ã«JSONã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆPHPå‹ï¼‰ã«å¤‰æ›ã™ã‚‹å‡¦ç†ã¯ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ã‚ã‚‹ã€‚ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ ãƒ»ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼šJSå‹ã‹ã‚‰JSON JSå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰JSONã¸ã®å¤‰æ›ã«ã¯ã€JSON.stringfyãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const object = { fruit: [\"banana\", \"apple\"], account: 200 }; // ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º const json = JSON.stringify(object); console.log(json); // {\"fruit\":[\"banana\",\"apple\"],\"account\":200} ãƒ»ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼šJSONã‹ã‚‰JSå‹ JSONã‹ã‚‰JSå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å¤‰æ›ã«ã¯ã€JSON.parseãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸJSONã¯ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const escapedJson = \"{\\\"fruit\\\":[\\\"banana\\\",\\\"apple\\\"],\\\"account\\\":200}\" console.log(escapedJson); // {\"fruit\":[\"banana\",\"apple\"],\"account\":200} // ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º const object = JSON.parse(escapedJson); console.log(object); // { fruit: [ 'banana', 'apple' ], account: 200 } ãƒ»ç›¸äº’ãƒ‘ãƒ¼ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤ã‚¯ãƒ©ã‚¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã¨ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã‚’è¡Œã†ã‚¯ãƒ©ã‚¹ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ class StaffParser { // ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã«ã‚ˆã‚‹JSå‹ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªèº«ã«è¨­å®š constructor(properties) { this.id = properties.id; this.name = properties.name; } //-- ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆJSONã‹ã‚‰JavaScriptã¸ï¼‰ --// static deserializeStaff(json) { // JSå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å®šç¾©æ–¹æ³• return new StaffParser({ id: json.id, name: json.name }); } //-- ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆJavaScriptã‹ã‚‰JSONã¸ï¼‰ --// static serializeCriteria(criteria) { // JSONã®å®šç¾© const json = { \"id\" : null, \"name\" : null } // ID if (criteria.id) { // JSONãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚ json.id = _.trim(criteria.id); } // æ°å if (criteria.name) { json.name = _.trim(criteria.name); } } } ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ ãƒ»ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼šJSONã‹ã‚‰PHPå‹ JSONã‹ã‚‰PHPå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å¤‰æ›ã«ã¯ã€‚json_decodeãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ç¬¬äºŒå¼•æ•°ãŒfalseã®å ´åˆã€objectå½¢å¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã™ã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§é€ä¿¡ã™ã‚‹JSONã¯ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ // array(2) { // [0]=> // string(9) \"banana\" // [1]=> // string(9) \"apple\" // } // [\"account\"]=> // int(200) // } ç¬¬äºŒå¼•æ•°ãŒtrueã®å ´åˆã€é€£æƒ³é…åˆ—å½¢å¼ã«å¤‰æ›ã™ã‚‹ã€‚ // array(2) { // [0]=> // string(9) \"banana\" // [1]=> // string(9) \"apple\" // } // [\"account\"]=> // int(200) // } ãƒ»ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼šPHPå‹ã‹ã‚‰JSON 03. JSONã®ã‚¯ã‚¨ãƒªè¨€èª ã‚¯ã‚¨ãƒªè¨€èªã®ç¨®é¡ ãƒ»JMESPath ï¼Šå®Ÿè£…ä¾‹ï¼Š // ã“ã“ã«å®Ÿè£…ä¾‹ "},"public/software/software_application_collaboration_communication.html":{"url":"public/software/software_application_collaboration_communication.html","title":"ğŸ“– ï¸ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“é€šä¿¡","keywords":"","body":"ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“é€šä¿¡ 01. åŒæœŸé€šä¿¡ 02. éåŒæœŸé€šä¿¡ éåŒæœŸé€šä¿¡ã¨ã¯ éåŒæœŸå‡¦ç†ã®ä¸€ç¨®ã§ã‚ã‚‹ã€‚ãã®ãŸã‚ã€é€šä¿¡ã®å®Œäº†ã‚’å¾…ãŸãšã«å¾Œç¶šã®å‡¦ç†ãŒå§‹ã¾ã‚‹ã€‚å¾Œç¶šã®å…¨å‡¦ç†ãŒéåŒæœŸé€šä¿¡ã¨ç„¡é–¢ä¿‚ã§ã‚ã‚Œã°ã€ãã®ã¾ã¾ã§å•é¡Œã¯èµ·ã“ã‚‰ãªã„ã€‚ã—ã‹ã—ã€å¾Œç¶šã®å‡¦ç†ã«éåŒæœŸé€šä¿¡ã®çµæœã‚’ç”¨ã„ã‚‹ã‚‚ã®ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ã“ã®å‡¦ç†ã ã‘ã¯éåŒæœŸé€šä¿¡ã®å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ç‰¹å®šã®å‡¦ç†ãŒéåŒæœŸé€šä¿¡ã®å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«å®šç¾©ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_logic_asynchronous_process.html 03. JavaScriptã«ãŠã‘ã‚‹éåŒæœŸé€šä¿¡ Ajaxï¼šAsynchronous JavaScript + XML ãƒ»Ajaxã¨ã¯ JavaScriptã§éåŒæœŸé€šä¿¡ã‚’å®Ÿç¾ã™ã‚‹æ‰‹æ³•ã®ã“ã¨ã€‚JavaScriptã€HTMLã€XHTMLã€CSSã€DOMã€XMLã€XSLTã€ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã€‚ ãƒ»Ajaxã®ä»•çµ„ã¿ urlã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã‚µãƒ¼ãƒã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã‚‹ã€‚ DOMã®ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã®è§£æã«ã‚ˆã‚Šã€Webãƒšãƒ¼ã‚¸ãŒæ§‹æˆã•ã‚Œã‚‹ã€‚ ãƒšãƒ¼ã‚¸ä¸Šã§ä»»æ„ã®ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒšãƒ¼ã‚¸ãƒ³ã‚°æ“ä½œã€ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ãªã©ï¼‰ãŒç™ºç«ã—ã€ç´ä»˜ããƒãƒ³ãƒ‰ãƒ©é–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ JavaScriptå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒJSONã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ éåŒæœŸé€šä¿¡ã«ã‚ˆã‚Šã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¯ã€JSONå‹ãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã—ã€ã¾ãŸãã‚Œã‚’å…ƒã«DBã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’Readã™ã‚‹ã€‚ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¯ã€PHPå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’JSONã«å¤‰æ›ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ éåŒæœŸé€šä¿¡ãƒ¡ã‚½ãƒƒãƒ‰ãŒãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ã™ã‚‹ã€‚ JSONãŒJavaScriptå‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚ DOMã‚’ç”¨ã„ã¦ã€Webãƒšãƒ¼ã‚¸ã‚’å†ã³æ§‹æˆã™ã‚‹ã€‚ ãƒ»å®Ÿè£…æ–¹æ³•ã®ç¨®é¡ æ­´å²çš„ã«ã€Ajaxã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®æ–¹æ³•ãŒã„ãã¤ã‹ã‚ã‚‹ã€‚ ç¨®é¡ æä¾› èª¬æ˜ è£œè¶³ xhrã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ä»Šã§ã¯ä½¿ã†ã“ã¨ã¯å°‘ãªã„ãŒã€AjaxãŒç™»å ´ã—ãŸåˆæœŸã®é ƒã«ã‚ˆãä½¿ã‚ã‚ŒãŸã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest fetchãƒ¡ã‚½ãƒƒãƒ‰ ãƒ“ãƒ«ãƒˆã‚¤ãƒ³é–¢æ•° å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/API/Fetch_API/Using_Fetch JQueryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ JQueryãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ å‚è€ƒï¼šãƒ»https://api.jquery.com/category/ajax/shorthand-methods/ãƒ»https://api.jquery.com/jquery.ajax axiosã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Axiosãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ å‚è€ƒï¼šhttps://github.com/axios/axios#request-method-aliases 03-02. å®Ÿè£… xhrã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ ãƒ»GETé€ä¿¡ å‚è€ƒï¼šhttps://blog.capilano-fw.com/?p=6920#Ajax ï¼Šå®Ÿè£…ä¾‹ï¼Š // URL const url = 'https://example.co.jp/'; const xhr = new XMLHttpRequest(); // HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒ‡å®š xhr.open('GET', url); // ãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡å¾Œã®å‡¦ç† xhr.onload = () => { if(xhr.status === 200) { const data = JSON.parse(xhr.responseText); console.log(data); } }; // æœ€å¾Œã«é€ä¿¡ã‚’å®Ÿè¡Œ xhr.send(); ãƒ»POSTé€ä¿¡ å‚è€ƒï¼šhttps://blog.capilano-fw.com/?p=6920#Ajax ï¼Šå®Ÿè£…ä¾‹ï¼Š // URL const url = 'https://example.co.jp/'; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ const body = { name: 'Hiroki', email: 'example@gmail.com', password: 'password' }; const queries = []; for(const key in body) { const query = key +'='+ encodeURIComponent(params[key]); queries.push(query); } const queryString = queries.join('&'); const xhr = new XMLHttpRequest(); // HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒ‡å®š xhr.open('POST', url); // é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); // ãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡å¾Œã®å‡¦ç† xhr.onload = () => { if(xhr.status === 200) { const data = JSON.parse(xhr.responseText); console.log(data); } }; // æœ€å¾Œã«é€ä¿¡ã‚’å®Ÿè¡Œ xhr.send(queryString); JQueryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ ãƒ»GETé€ä¿¡ ï¼Šå®Ÿè£…ä¾‹ï¼Š const url = 'https://example.co.jp/'; $.get(url); ãƒ»POSTé€ä¿¡ ï¼Šå®Ÿè£…ä¾‹ï¼Š const url = 'https://example.co.jp/'; const body = { name: 'Hiroki', email: 'example@gmail.com', password: 'password' }; $.post(url, params); ãƒ»ä»»æ„ã®HTTPãƒ¡ã‚½ãƒƒãƒ‰ ä»»æ„ã®HTTPãƒ¡ã‚½ãƒƒãƒ‰ã€URLã€ãƒ˜ãƒƒãƒ€ãƒ¼ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ãªã©ã‚’è¨­å®šã—ã€éåŒæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€å—ä¿¡ã™ã‚‹ã€‚Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”å´ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://api.jquery.com/jquery.ajax ï¼Šå®Ÿè£…ä¾‹ï¼Š const id = 1; $.ajax({ // ################### // ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ // ################### // HTTPãƒ¡ã‚½ãƒƒãƒ‰ type: 'POST', // URL url: '/xxx/xxx/' + id + '/', // é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ contentType: 'application/json', // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ data: { name: 'Hiroki', email: 'example@gmail.com', password: 'password' }, // ################### // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ // ################### // å—ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ dataType: 'json', }) Axiosã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ ãƒ»GETé€ä¿¡ ï¼Šå®Ÿè£…ä¾‹ï¼Š const url = 'https://example.co.jp/'; axios.get(url); ãƒ»POSTé€ä¿¡ ï¼Šå®Ÿè£…ä¾‹ï¼Š const url = 'https://example.co.jp/'; const body = { name: 'Hiroki', email: 'example@gmail.com', password: 'password' }; axios.post(url, params); "},"public/software/software_application_collaboration_authentication_authorization.html":{"url":"public/software/software_application_collaboration_authentication_authorization.html","title":"ğŸ“– ï¸èªè¨¼ï¼èªå¯","keywords":"","body":"Authenticateï¼ˆèªè¨¼ï¼‰ï¼Authorizationï¼ˆèªå¯ï¼‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. HTTPèªè¨¼ HTTPèªè¨¼ã¨ã¯ èªè¨¼æ™‚ã«HTTPé€šä¿¡ã®ä¸­ã§èªè¨¼ã‚’è¡Œã†ã“ã¨ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®WWW-Authenticateãƒ˜ãƒƒãƒ€ãƒ¼ã§èªè¨¼ã‚¹ã‚­ãƒ¼ãƒ ã‚’æŒ‡å®šã™ã‚‹ã€‚èªè¨¼ã‚¹ã‚­ãƒ¼ãƒ ã®ç¨®é¡ã«ã¯ã€ã€Basicèªè¨¼ã€ã€ã€Digestèªè¨¼ã€ã€ã€Bearerèªè¨¼ã€ãªã©ãŒã‚ã‚‹ã€‚èªè¨¼æƒ…å ±ã®ä¸€æ™‚çš„ãªä¿å­˜ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®WebStoregeã§è¡Œã†ãŸã‚ã€èªè¨¼è§£é™¤ï¼ˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆï¼‰ã‚’ã‚µãƒ¼ãƒå´ã§å®Œå…¨ã«åˆ¶å¾¡ã§ããªã„ã€‚ å‚è€ƒï¼š https://www.iana.org/assignments/http-authschemes/http-authschemes.xhtml https://architecting.hateblo.jp/entry/2020/03/27/130535 https://developer.mozilla.org/ja/docs/Web/HTTP/Authentication#authentication_schemes Basicèªè¨¼ ãƒ»Basicèªè¨¼ã®ä»•çµ„ã¿ å½¹å‰² èª¬æ˜ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡å…ƒã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã“ã¨ã€‚æ–‡è„ˆã«ã‚ˆã£ã¦ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã‚ã‚‹å ´åˆã¨ãã†ã§ãªã„å ´åˆï¼ˆä¾‹ï¼šOAuthèªè¨¼ï¼‰ãŒã‚ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¶ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã„ã‚‹äººç‰©ã®ã“ã¨ã€‚ ã‚µãƒ¼ãƒ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã“ã¨ã€‚ æœ€åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€èªè¨¼å¾Œã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒšãƒ¼ã‚¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã€‚ GET https://example.co.jp/foo-form HTTP/2 ã‚µãƒ¼ãƒã¯ã€ã“ã‚Œæ‹’å¦ã—ã€401ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§èªè¨¼é ˜åŸŸã‚’è¨­å®šã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€èªè¨¼é ˜åŸŸã®å€¤ã‚’ãƒ¦ãƒ¼ã‚¶ã«ç¤ºã—ã¦ã€ãƒ¦ãƒ¼ã‚¶åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å…¥åŠ›ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶ã«è¡¨ç¤ºã™ã‚‹ãŸã‚ã®èªè¨¼é ˜åŸŸã«ã¯ã€ä»»æ„ã®å€¤ã‚’æŒãŸã›ã‚‹ã“ã¨ãŒã§ãã€ã‚µã‚¤ãƒˆåãŒè¨­å®šã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚ 401 Unauthorized WWW-Authenticate: Basic realm=\"\", charaset=\"UTF-8\" ã€:ã€ã‚’Base64ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸå€¤ã‚’authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ POST https://example.co.jp/foo-form HTTP/2 authorization: Basic bG9naW46cGFzc3dvcmQ= ã‚µãƒ¼ãƒã¯ã€ãƒ¦ãƒ¼ã‚¶åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç…§åˆã—ã€åˆè‡´ã—ã¦ã„ã‚Œã°ã€èªè¨¼å¾Œãƒšãƒ¼ã‚¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ã¾ãŸã€èªè¨¼æƒ…å ±ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã®Webã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹ã€‚ 200 OK WWW-Authenticate: Basic realm=\"\" èªè¨¼ã®è§£é™¤æ™‚ã¯ã€èª¤ã£ãŸèªè¨¼æƒ…å ±ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«æ„å›³çš„ã«é€ä¿¡ã•ã›ã¦èªè¨¼ã‚’å¤±æ•—ã•ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://stackoverflow.com/questions/4163122/http-basic-authentication-log-out POST https://example.co.jp/foo-form/logout HTTP/2 authorization: Basic ã‚µãƒ¼ãƒã¯ã€401ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã—ã€èªè¨¼ãŒè§£é™¤ã•ã‚Œã‚‹ã€‚ 401 Unauthorized WWW-Authenticate: Basic realm=\"\", charaset=\"UTF-8\" Digestèªè¨¼ ãƒ»Digestèªè¨¼ã®ä»•çµ„ã¿ 200 OK WWW-Authenticate: Basic realm=\"\", charaset=\"UTF-8\" POST https://example.co.jp/foo-form HTTP/2 authorization: Digest realm=\"\" nonce=\"\" algorithm=\"\" qoq=\"auth\" Bearerèªè¨¼ ãƒ»Bearerèªè¨¼ã¨ã¯ èªè¨¼æ™‚ã«Bearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”¨ã„ã‚‹èªè¨¼ã‚¹ã‚­ãƒ¼ãƒ ã®ã“ã¨ã€‚ ãƒ»Bearerãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆç½²åãªã—ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã¨ã¯ å˜ãªã‚‹æ–‡å­—åˆ—ã§å®šç¾©ã•ã‚ŒãŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€‚Bearerèªè¨¼ã«ã¦ã€ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦ç”¨ã„ã‚‹ã€‚ç½²åãªã—ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã‚‚å‘¼ã°ã‚Œã€å®Ÿéš›ã«èªè¨¼ã•ã‚ŒãŸæœ¬äººã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹æ©Ÿèƒ½ã¯ç„¡ãã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æŒã£ã¦ã„ã‚Œã°ãã‚Œã‚’æœ¬äººã¨ã—ã¦èªå¯ã™ã‚‹ã€‚ãã®ãŸã‚ã€ãƒˆãƒ¼ã‚¯ãƒ³ã®æ–‡å­—åˆ—ãŒæµå‡ºã—ã¦ã—ã¾ã‚ãªã„ã‚ˆã†ã€å³é‡ã«ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚Bearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”¨ã„ã‚‹Bearerèªè¨¼ã«ã¤ã„ã¦ã¯ã€åˆ¥é …ç›®ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://openid-foundation-japan.github.io/rfc6750.ja.html#anchor3 ãƒ»Bearerèªè¨¼ã®ä»•çµ„ã¿ æŒ‡å®šã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã—ã¦ã€POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã®æ™‚ã€Content-Typeãƒ˜ãƒƒãƒ€ãƒ¼ã‚’application/x-www-form-urlencodedã¨ã™ã‚‹ã€‚å¿…è¦ãªãƒœãƒ‡ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯APIã®æä¾›å…ƒã«ã‚ˆã£ã¦ç•°ãªã‚‹ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã€ä»˜ä¸ã‚¿ã‚¤ãƒ—ã€ãªã©ãŒå¿…è¦ãªã“ã¨ãŒå¤šã„ã€‚ å‚è€ƒï¼š https://developer.amazon.com/ja/docs/adm/request-access-token.html#request-format https://ja.developer.box.com/reference/post-oauth2-token/#request POST https://example.co.jp/foo HTTP/2 Content-Type: application/x-www-form-urlencoded # ãƒœãƒ‡ã‚£ client_id=*****&grant_type=client_credentials&scope=messaging:push ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã«Bearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ä¿¡ã•ã‚Œã‚‹ã€‚ä»–ã«ã€æœ‰åŠ¹æœŸé™ã€æ¨©é™ã®ã‚¹ã‚³ãƒ¼ãƒ—ã€æŒ‡å®šå¯èƒ½ãªèªè¨¼ã‚¹ã‚­ãƒ¼ãƒã€ãªã©ãŒæä¾›ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚ å‚è€ƒï¼š https://developer.amazon.com/ja/docs/adm/request-access-token.html#request-format https://ja.developer.box.com/reference/resources/access-token/ 200 OK X-Amzn-RequestId: d917ceac-2245-11e2-a270-0bc161cb589d Content-Type: application/json { \"access_token\":\"*****\", \"expires_in\":3600, \"scope\":\"messaging:push\", \"token_type\":\"Bearer\" } ç™ºè¡Œã•ã‚ŒãŸBearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’æŒ‡å®šã•ã‚ŒãŸèªè¨¼ã‚¹ã‚­ãƒ¼ãƒã§Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã“ã§ã¯è©³ã—ãè¨€åŠã—ãªã„ãŒã€Bearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’Formèªè¨¼ã®ã‚ˆã†ã«Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/34817617/should-jwt-be-stored-in-localstorage-or-cookie https://ja.developer.box.com/reference/post-oauth2-token/#response POST https://example.co.jp/foo HTTP/2 authorization: Bearer ã‚µãƒ¼ãƒã¯ã€Bearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç…§åˆã—ã€åˆè‡´ã—ã¦ã„ã‚Œã°ã€èªè¨¼å¾Œãƒšãƒ¼ã‚¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ç„¡åŠ¹ãªBearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã¨ã—ã¦Redisï¼DBã§ç®¡ç†ã—ã¦ãŠãã€‚DBã§ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ç®¡ç†ã™ã‚‹ã¨ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®åº¦ã«DBã‚¢ã‚¯ã‚»ã‚¹å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ãªã£ã¦ã—ã¾ã†ãŸã‚ã€Redisã§ã“ã‚Œã‚’ç®¡ç†ã—ãŸæ–¹ãŒè‰¯ã„ã€‚ 200 OK WWW-Authenticate: Bearer realm=\"\" èªè¨¼ã®è§£é™¤æ™‚ã¯ã€Redisï¼DBã§Bearerãƒˆãƒ¼ã‚¯ãƒ³ã®çŠ¶æ…‹ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚ã¾ãŸã‚µãƒ¼ãƒã¯ã€401ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã—ã€èªè¨¼ãŒè§£é™¤ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/21978658/invalidating-json-web-tokens https://medium.com/devgorilla/how-to-log-out-when-using-jwt-a8c7823e8a6 401 Unauthorized WWW-Authenticate: Basic realm=\"\", charaset=\"UTF-8\" ãƒ»æ­£å¸¸ç³»ï¼ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ å‚è€ƒï¼šhttps://qiita.com/h_tyokinuhata/items/ab8e0337085997be04b1 æˆåŠŸã®å ´åˆã¯ã€realmå±æ€§ã‚’ç©ºã«ã—ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ 200 OK WWW-Authenticate: Bearer realm=\"\" å¤±æ•—ã®å ´åˆã¯ã€errorå±æ€§ã«ã‚¨ãƒ©ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰²ã‚Šå½“ã¦ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ 400 Bad Request WWW-Authenticate: Bearer error=\"invalid_request\" 401 Unauthorized WWW-Authenticate: Bearer realm=\"token_required\" 403 Forbidden WWW-Authenticate: Bearer error=\"insufficient_scope\" ãƒ»Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒˆãƒ¼ã‚¯ãƒ³ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä¿æŒ ä¸ä¾¿ã§ã¯ã‚ã‚‹ãŒã€Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã¯Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã¯ç•°ãªã‚Šã€ãƒ­ãƒ¼ã‚«ãƒ«PCã«ä¿å­˜ã§ããªã„ã€‚ãã®ä»£ã‚ã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã«ã‚ˆã£ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®WebStorageã§ã‚‚ä¿æŒã§ãã‚‹ã€‚Chromeã§ã¯ã€LocalStorageï¼SessionStorageã«ä¿æŒã•ã‚Œã‚‹ã€‚LocalStorageã¯SessionStorageã¨æ¯”ã¹ã¦ä¿å­˜æœŸé–“ãŒé•·ã„ãŸã‚ã€XSSã®å±é™ºæ€§ãŒã‚ˆã‚Šé«˜ã„ã€‚ã“ã‚Œã‚‰ã®ç¢ºèªæ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆ å‚è€ƒï¼š https://developer.chrome.com/docs/devtools/storage/localstorage/ https://developer.chrome.com/docs/devtools/storage/sessionstorage/ https://stackoverflow.com/questions/5523140/html5-local-storage-vs-session-storage OAuthèªè¨¼ ãƒ»OAuthèªè¨¼ã¨ã¯ OAuthã®é …ç›®ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ 01-02. HTTPèªè¨¼ä»¥å¤–ã®èªè¨¼æ–¹æ³• Formèªè¨¼ï¼ˆCookieãƒ™ãƒ¼ã‚¹ã®èªè¨¼ï¼‰ ãƒ»Formèªè¨¼ã¨ã¯ èªè¨¼æ™‚ã«Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®å€¤ã‚’ç”¨ã„ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ã€`Cookieãƒ™ãƒ¼ã‚¹ã®èªè¨¼ã€ã¨ã‚‚ã„ã†ã€‚StatefulåŒ–ã‚’è¡Œã†ãŸã‚ã€HTTPèªè¨¼ã«ã¯å±ã—ã¦ã„ãªã„ã€‚èªè¨¼æƒ…å ±ã®ä¸€æ™‚çš„ãªä¿å­˜ã¯ã€ã‚µãƒ¼ãƒã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã§è¡Œã†ãŸã‚ã€èªè¨¼è§£é™¤ï¼ˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆï¼‰ã‚’ã‚µãƒ¼ãƒå´ã§åˆ¶å¾¡ã§ãã‚‹ã€‚Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚ˆã‚‹é€å—ä¿¡ã§ã¯ã€CSRFã®å±é™ºæ€§ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼š https://h50146.www5.hpe.com/products/software/security/icewall/iwsoftware/report/certification.html https://auth0.com/docs/sessions/cookies#cookie-based-authentication ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ãŸFormèªè¨¼ã®å ´åˆï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹ï¼‰ ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ æœ€åˆã€ãƒ¦ãƒ¼ã‚¶ä½œæˆã®æ®µéšã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒèªè¨¼æƒ…å ±ã‚’ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã€‚ã‚µãƒ¼ãƒã¯ã€èªè¨¼æƒ…å ±ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã™ã‚‹ã€‚ POST https://example.co.jp/users HTTP/2 { \"email_address\": \"foo@gmail.com\", \"password\": \"foo\" } æ¬¡å›ã®èªè¨¼æ™‚ã«ã€å†ã³ãƒ¦ãƒ¼ã‚¶ãŒèªè¨¼æƒ…å ±ã‚’é€ä¿¡ã™ã‚‹ã€‚ POST https://example.co.jp/foo-form HTTP/2 { \"email_address\": \"foo@gmail.com\", \"password\": \"foo\" } ã‚µãƒ¼ãƒã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®èªè¨¼æƒ…å ±ã‚’ç…§åˆã—ã€ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¨±å¯ã™ã‚‹ã€‚ã‚µãƒ¼ãƒã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”Ÿæˆã—ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€ã€‚ # ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ« { sessionid: ***** } ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã™ã‚‹ã€‚ 200 OK Set-Cookie: sessionid= ã‚µãƒ¼ãƒã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã¨ãƒ¦ãƒ¼ã‚¶IDã‚’ç´ä»˜ã‘ã¦ã‚µãƒ¼ãƒå†…ã«ä¿å­˜ã™ã‚‹ã€‚ã•ã‚‰ã«æ¬¡å›ã®ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã™ã‚‹ã€‚ã‚µãƒ¼ãƒã¯ã€ä¿å­˜ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ç´ä»˜ããƒ¦ãƒ¼ã‚¶IDã‹ã‚‰ã€ãƒ¦ãƒ¼ã‚¶ã‚’ç‰¹å®šã—ã€ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¨±å¯ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”¹ã‚ã¦èªè¨¼æƒ…å ±ã‚’é€ä¿¡ã›ãšã«ã€ç´ æ—©ããƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ POST https://example.co.jp/foo-form HTTP/2 cookie: sessionid= èªè¨¼è§£é™¤æ™‚ã€ã‚µãƒ¼ãƒã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://blog.tokumaru.org/2013/02/purpose-and-implementation-of-the-logout-function.html ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”¨ã„ãŸFormèªè¨¼ã®å ´åˆï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ãƒ™ãƒ¼ã‚¹ï¼‰ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã®æ™‚ã®ãƒˆãƒ¼ã‚¯ãƒ³ã®é¸æŠè‚¢ã¨ã—ã¦ã€å˜ãªã‚‹ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ã‚„JWTãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://scrapbox.io/fendo181/JWT(JSON_Web_Token)%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B%E3%80%82 ãƒ»Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®å€¤ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä¿æŒ å†åˆ©ç”¨ã®ãŸã‚ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‹ãŸã‚ã®å€¤ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³IDã€ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é€šã—ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã«æœ‰åŠ¹æœŸé™ã«å¿œã˜ãŸé–“ã ã‘ä¿æŒã§ãã‚‹ã€‚ã¾ãŸã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã«ã‚ˆã£ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®Webã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã§ã‚‚ä¿æŒã§ãã‚‹ã€‚Chromeã®å ´åˆã¯ã€Cookieã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿æŒã•ã‚Œã‚‹ã€‚ç¢ºèªæ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://developer.chrome.com/docs/devtools/storage/cookies/ https://qiita.com/cobachan/items/05fa537a4ffcb189d001 APIã‚­ãƒ¼èªè¨¼ ãƒ»APIã‚­ãƒ¼èªè¨¼ã¨ã¯ äº‹å‰ã«APIã‚­ãƒ¼ã¨ãªã‚‹æ–‡å­—åˆ—ã‚’é…å¸ƒã—ã€èªè¨¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯è¡Œã‚ãšã«èªå¯ãƒ•ã‚§ãƒ¼ã‚ºã®ã¿ã§ãƒ¦ãƒ¼ã‚¶ã‚’ç…§åˆã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚API Gatewayã«ãŠã‘ã‚‹APIã‚­ãƒ¼èªè¨¼ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws.html ãƒ»ç…§åˆæƒ…å ±ã®é€ä¿¡æ–¹æ³• ç‹¬è‡ªãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã—ã¦ã€x-api-keyãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã‚Œã«APIã‚­ãƒ¼ã‚’å‰²ã‚Šå½“ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ã¸ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‰²ã‚Šå½“ã¦ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html GET https://example.co.jp/bar.php HTTP/2 x-api-key: Personal Access Tokenã«ã‚ˆã‚‹èªè¨¼ï¼šPAT ãƒ»PATã«ã‚ˆã‚‹èªè¨¼ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒPersonal Access Tokenï¼ˆå€‹äººç”¨ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã®ä»˜ä¸ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã€èªè¨¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯è¡Œã‚ãšã«èªå¯ãƒ•ã‚§ãƒ¼ã‚ºã®ã¿ã§ãƒ¦ãƒ¼ã‚¶ã‚’ç…§åˆã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã«PATã‚’å‰²ã‚Šã‚ã¦ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ä½œæˆæ™‚ä»¥é™ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç¢ºèªã§ããªããªã‚‹ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.contentful.com/help/personal-access-tokens/ GET https://example.co.jp/bar.php HTTP/2 authorization: ã‚µãƒ¼ãƒ“ã‚¹ä¾‹ ãƒˆãƒ¼ã‚¯ãƒ³å èª¬æ˜ GitHub Personal access Token HTTPSã‚’ç”¨ã„ã¦ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«å¿…è¦ã€‚HTTPSã‚’ç”¨ã„ã‚‹å ´é¢ã¨ã—ã¦ã€ã‚¢ãƒ—ãƒªã®æ‹¡å¼µæ©Ÿèƒ½ã®GitHubé€£æºã€ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåŒ–ã€ãªã©ãŒã‚ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.github.com/ja/github/authenticating-to-github/creating-a-personal-access-token 01-03. è¤‡æ•°ã®èªè¨¼ã®çµ„ã¿åˆã‚ã› Two Step Verificationï¼ˆäºŒæ®µéšèªè¨¼ï¼‰ ãƒ»Two Step Verificationã¨ã¯ èªè¨¼æ™‚ã«æ®µéšçš„ã«äºŒã¤ã®æ–¹æ³•ã‚’è¨­å®šã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç…§åˆã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ ä¸€æ®µéšç›®ã®èªè¨¼ä¾‹ äºŒæ®µéšç›®ã®èªè¨¼ä¾‹ èª¬æ˜ å‚™è€ƒ IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹æ–¹æ³•ã®å¾Œã€åˆ¥ã®IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚ ç§˜å¯†ã®è³ªå• IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹æ–¹æ³•ã®å¾Œã€è³ªå•ã«å¯¾ã—ã¦ã‚ã‚‰ã‹ã˜ã‚è¨­å®šã—ãŸå›ç­”ã«ã‚ˆã‚‹æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚ SMS IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹æ–¹æ³•ã®å¾Œã€SMSå®›ã«é€ä¿¡ã—ãŸèªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚ ç•°ãªã‚‹è¦ç´ ã®ãŸã‚ã€ã“ã‚Œã¯äºŒè¦ç´ èªè¨¼ã§ã‚‚ã‚ã‚‹ã€‚ æŒ‡ç´‹ IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹æ–¹æ³•ã®å¾Œã€æŒ‡ç´‹ã®è§£æçµæœã«ã‚ˆã‚‹æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚ ç•°ãªã‚‹è¦ç´ ã®ãŸã‚ã€ã“ã‚Œã¯äºŒè¦ç´ èªè¨¼ã§ã‚‚ã‚ã‚‹ã€‚ Two Factor Authorizationï¼ˆäºŒè¦ç´ èªè¨¼ï¼‰ ãƒ»Two Factor Authorizationã¨ã¯ äºŒæ®µéšèªè¨¼ã®ã†ã¡ã§ç‰¹ã«ã€èªè¨¼æ™‚ã«ç•°ãªã‚‹è¦ç´ ã®æ–¹æ³•ã‚’ç”¨ã„ã¦ã€æ®µéšçš„ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç…§åˆã™ã‚‹ã“ã¨æ–¹æ³•ã®ã“ã¨ã€‚å¾Œè¿°ã™ã‚‹OAuthèªè¨¼ã‚’çµ„ã¿è¾¼ã‚“ã§ã‚‚è‰¯ã„ã€‚ ä¸€è¦ç´ ç›®ã®èªè¨¼ä¾‹ äºŒè¦ç´ ç›®ã®èªè¨¼ä¾‹ IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆçŸ¥è­˜ï¼‰ äº‹å‰ç™»éŒ²ã•ã‚ŒãŸé›»è©±ç•ªå·ã®SMSã§å—ä¿¡ã—ãŸãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆæ‰€æŒï¼‰ äº‹å‰ç™»éŒ²ã•ã‚ŒãŸé›»è©±ç•ªå·ã®SMSã§å—ä¿¡ã—ãŸèªè¨¼ã‚³ãƒ¼ãƒ‰ï¼ˆæ‰€æŒï¼‰ OAuthèªè¨¼ï¼ˆæ‰€æŒï¼‰ æŒ‡ç´‹ï¼ˆç”Ÿä½“ï¼‰ æš—è¨¼ç•ªå·ï¼ˆçŸ¥è­˜ï¼‰ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ï¼ˆæ‰€æŒï¼‰ 02. èªå¯ãƒ•ã‚§ãƒ¼ã‚º èªè¨¼ãƒ•ã‚§ãƒ¼ã‚ºã¨èªå¯ãƒ•ã‚§ãƒ¼ã‚º ãƒ»å‡¦ç†ã®é•ã„ èªè¨¼ãƒ•ã‚§ãƒ¼ã‚ºã¨èªå¯ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ã€ä»•çµ„ã¿ã®ä¸­ã«ã€ï¼“ã¤ã®å½¹å‰²ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã«IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ IdPï¼šIdentity ProviderãŒã€IDã‚’ã€èªè¨¼ã€ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®šã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒã€èªå¯ã€ã•ã‚Œã‚Œã°ã€APIå´ãŒãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã€‚ å½¹å‰² èª¬æ˜ ä¾‹ APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ APIã«å¯¾ã—ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ãŸã„ã‚µãƒ¼ãƒã®ã“ã¨ã€‚ Ouathèªè¨¼ã®ä»•çµ„ã¿ã«ãŠã‘ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€‚ Identity Provider ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ã‚µãƒ¼ãƒã®ã“ã¨ã€‚ Ouathèªè¨¼ã®ä»•çµ„ã¿ã«ãŠã‘ã‚‹èªå¯ã‚µãƒ¼ãƒã€‚ APIã‚µãƒ¼ãƒ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã—ã¦ã€ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã‚µãƒ¼ãƒã®ã“ã¨ã€‚ Ouathèªè¨¼ã®ä»•çµ„ã¿ã«ãŠã‘ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚µãƒ¼ãƒã€‚ ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®é•ã„ èªè¨¼ãƒ•ã‚§ãƒ¼ã‚ºã«ã¦ã€èª¤ã£ãŸãƒˆãƒ¼ã‚¯ãƒ³ãŒç™ºè¡Œã•ã‚ŒãŸã“ã¨ã‚’è¡¨ç¾ã—ãŸã„å ´åˆã€401ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç”¨ã„ã‚‹ã€‚èªå¯ãƒ•ã‚§ãƒ¼ã‚ºã«ã¦ã€æ­£ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ãŒç™ºè¡Œã•ã‚ŒãŸãŒã€ãƒˆãƒ¼ã‚¯ãƒ³ã®æ‰€æœ‰è€…ã«é–²è¦§æ¨©é™ãŒãªã„ã“ã¨ã‚’è¡¨ç¾ã—ãŸã„å ´åˆã€403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç”¨ã„ã‚‹ã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html OAuthãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€OAuthèªè¨¼ ãƒ»OAuthãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€OAuthèªè¨¼ã¨ã¯ èªè¨¼èªå¯ãƒ•ã‚§ãƒ¼ã‚ºå…¨ä½“ã®ä¸­ã§ã€èªå¯ãƒ•ã‚§ãƒ¼ã‚ºã«OAuthãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç…§åˆæ–¹æ³•ã‚’ã€OAuthèªè¨¼ã€ã¨å‘¼ã¶ã€‚èªè¨¼ãƒ•ã‚§ãƒ¼ã‚ºã¨èªå¯ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ã€ï¼“ã¤ã®å½¹å‰²ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’èª¬æ˜ã—ãŸãŒã€OAuthãƒ—ãƒ­ãƒˆã‚³ãƒ«2.0ã§ã¯ã€ã‚ˆã‚Šå…·ä½“çš„ã«ï¼”ã¤ã®å½¹å‰²ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚ å½¹å‰² åç§° èª¬æ˜ è£œè¶³ APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒª ãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ¼ãƒŠã«å¯¾ã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’æŒã¤ã‚µãƒ¼ãƒã®ã“ã¨ã€‚ OAuthã®æ–‡è„ˆã§ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨å‘¼ã°ã‚Œãªã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ã¾ãŸã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªã¨ãƒªã‚½ãƒ¼ã‚¹é–“ã®ãƒ‡ãƒ¼ã‚¿é€šä¿¡ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ä»‹ã—ãŸãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã«ã‚ˆã£ã¦å®Ÿç¾ã™ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ ãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ¼ãƒŠãƒ¼ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ã®ã“ã¨ã€‚ Identity Provider èªå¯ã‚µãƒ¼ãƒ ãƒªã‚½ãƒ¼ã‚¹ã‚µãƒ¼ãƒãŒãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ¼ãƒŠãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ã‚µãƒ¼ãƒã®ã“ã¨ã€‚ èªå¯ã‚µãƒ¼ãƒãŒãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªã®URLã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªã®é–‹ç™ºè€…ãŒURLã‚’äº‹å‰ç™»éŒ²ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚èªå¯ã‚µãƒ¼ãƒã‚’åˆ©ç”¨ã™ã‚‹é–‹ç™ºè€…ç”¨ã«ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ã€‚å‚è€ƒï¼šhttps://qiita.com/TakahikoKawasaki/items/8567c80528da43c7e844 APIã‚µãƒ¼ãƒ ãƒªã‚½ãƒ¼ã‚¹ã‚µãƒ¼ãƒ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’æŒã£ã¦ã„ã‚‹ã‚µãƒ¼ãƒã®ã“ã¨ã€‚ ãƒ¦ãƒ¼ã‚¶ã¯ã€Facebookã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”¨ã„ã¦Instagramã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã‚ˆã†ã¨ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯Facebookã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚Facebookã¯Instagramã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æºã®æ‰¿èªãƒœã‚¿ãƒ³ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¶ãŒè¡¨ç¤ºã•ã‚ŒãŸæ‰¿èªãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯Facebookã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ã¦ã‚‚ã‚‰ã†ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯Instagramèªå¯ã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚Instagramã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã™ã‚‹ã€‚ã¾ãŸã€Facebookã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ãã‚‹ã‚ˆã†ã«ã€Locationãƒ˜ãƒƒãƒ€ãƒ¼ã«URLã¨èªå¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã¯Facebookã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å†é€ä¿¡ã—ã€Facebookã¯èªå¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚‹ã€‚ 302 Found Location: https://example.com/foo.php?code=123&state=abc Facebookã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰²ã‚Šå½“ã¦ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’Instagramã®ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã€‚ Instagramã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’èªè¨¼ã—ã€ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã€‚ã¾ãŸã€Facebookã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ãã‚‹ã‚ˆã†ã«ã€Locationãƒ˜ãƒƒãƒ€ãƒ¼ã«URLã‚’å‰²ã‚Šå½“ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰Facebookã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã¯Facebookã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å†é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼š https://boxil.jp/mag/a3207/ https://qiita.com/TakahikoKawasaki/items/8567c80528da43c7e844 ãƒ»ç”¨ã„ã‚‰ã‚Œã‚‹èªè¨¼ã‚¹ã‚­ãƒ¼ãƒ  OAuthèªè¨¼ã§ã¯ã€èªè¨¼ã‚¹ã‚­ãƒ¼ãƒã¨ã—ã¦Bearerèªè¨¼ãŒé¸ã°ã‚Œã‚‹ã“ã¨ãŒå¤šãã€AWSã‚„GitHubã¯ã€ç‹¬è‡ªã®èªè¨¼ã‚¹ã‚­ãƒ¼ãƒ ã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ãªãŠã€èªå¯ã‚µãƒ¼ãƒã«ã‚ˆã£ã¦ç™ºè¡Œã•ã‚ŒãŸBearerãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã€ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã„ãšã‚Œã‹ã«å‰²ã‚Šå½“ã¦ã¦é€ä¿¡ã§ãã‚‹ã€‚ ãƒ»ä»˜ä¸ã‚¿ã‚¤ãƒ— OAuthèªè¨¼ã®ãƒˆãƒ¼ã‚¯ãƒ³ã®ä»˜ä¸æ–¹æ³•ã«ã¯ç¨®é¡ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://oauth.net/2/grant-types/ ä»˜ä¸ã‚¿ã‚¤ãƒ—å èª¬æ˜ ä½¿ç”¨ä¾‹ Authorization Code Grant ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»–ã®APIã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã«ç”¨ã„ã‚‹ã€‚æ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://oauth.net/2/grant-types/authorization-code/ ä»–ã®SNSã‚¢ãƒ—ãƒªã¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æº Client Credentials Grant æ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://oauth.net/2/grant-types/client-credentials/ Device Code æ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://oauth.net/2/grant-types/device-code/ Implicit Grant éæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://oauth.net/2/grant-types/implicit/ Password Grant ãƒ¦ãƒ¼ã‚¶åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…ƒã«ã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä»˜ä¸ã™ã‚‹ã€‚éæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚å‚è€ƒï¼šãƒ»https://oauth.net/2/grant-types/password/ãƒ»https://developer.okta.com/blog/2018/06/29/what-is-the-oauth2-password-grant#the-oauth-20-password-grant OpenID Connect ãƒ»OpenID Connectã¨ã¯ è¦å‹‰å¼·ã€‚ ãƒ»ç”¨ã„ã‚‰ã‚Œã‚‹èªè¨¼ã‚¹ã‚­ãƒ¼ãƒ  è¦å‹‰å¼· 03. JWTï¼šJSON Web Token JWTã¨ã¯ ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã€ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã€ã€ç½²åã€ã®ãã‚Œãã‚Œã®JSONãƒ‡ãƒ¼ã‚¿ã‚’Base64urlã«ã‚ˆã£ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã€ãƒ‰ãƒƒãƒˆã§ã¤ãªã„ã ãƒˆãƒ¼ã‚¯ãƒ³ã€‚Bearèªè¨¼ã‚„Oauthèªè¨¼ã®ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ã‚’ã“ã‚Œã‚‰èªè¨¼ã®ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã™ã‚‹ã‚ˆã‚Šã€JWTã‚’ç”¨ã„ãŸæ–¹ãŒã‚ˆã‚Šå®‰å…¨ã§ã‚ã‚‹ã€‚ GET https://example.co.jp/bar.php HTTP/2 authorization: Bearer .. JWTã‚’Bearerãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦ç”¨ã„ã‚‹Bearerèªè¨¼ã«ã¤ã„ã¦ã¯ã€åˆ¥é …ç›®ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://meetup-jp.toast.com/3511 https://dev.classmethod.jp/articles/json-signing-jws-jwt-usecase/ JWTã®ç”Ÿæˆ ãƒ»JWTç”Ÿæˆã®å…¨ä½“åƒ JWTã¯ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã‹ã‚‰å–å¾—ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://jwt.io/ JWTã®ç”Ÿæˆæ™‚ã«ã€ä¾‹ãˆã°JavaScriptã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã€‚ // .. const token = base64urlEncoding(header) + \".\" + base64urlEncoding(payload) + \".\" + base64urlEncoding(signature) ãƒ»ãƒ˜ãƒƒãƒ€ãƒ¼ã®JSONãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ ãƒ˜ãƒƒãƒ€ãƒ¼ã¯ä»¥ä¸‹ã®JSONãƒ‡ãƒ¼ã‚¿ã§å®šç¾©ã•ã‚Œã‚‹ã€‚ç½²åã®ãŸã‚ã®æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ã€ã€HS256ã€ã€RS256ã€ã€ES256ã€ã€noneã€ã‹ã‚‰é¸æŠã§ãã‚‹ã€‚ const header = { \"typ\" : \"JWT\" // JWTã®ä½¿ç”¨ \"alg\" : \"HS256\", // ç½²åã®ãŸã‚ã®æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  } ãƒ»ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®JSONãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®JSONãƒ‡ãƒ¼ã‚¿ã§å®šç¾©ã•ã‚Œã‚‹ã€‚ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã«ã¯ã€å®Ÿéš›ã«é€ä¿¡ã—ãŸã„JSONã‚’è¨­å®šã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚å¿…ãšè¨­å®šã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€äºˆç´„æ¸ˆã¿ã‚¯ãƒ¬ãƒ¼ãƒ ã€ã¨ã€ãƒ¦ãƒ¼ã‚¶å´ãŒè‡ªç”±ã«å®šç¾©ã§ãã‚‹ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¯ãƒ¬ãƒ¼ãƒ ã€ãŒã‚ã‚‹ã€‚ äºˆç´„æ¸ˆã¿ã‚¯ãƒ¬ãƒ¼ãƒ å å½¹å‰² ä¾‹ subï¼šSubject ä¸€æ„ãªè­˜åˆ¥å­ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¶ID issï¼šIssuer audï¼šAudience expï¼šExpiration Time JWTã®æœ‰åŠ¹æœŸé™ã‚’è¨­å®šã™ã‚‹ã€‚ jtiï¼šJWT ID const payload = { \"sub\": \"foo\", \"aud\": \"foo\", \"iss\": \"https://example.com\", \"exp\": 1452565628, \"iat\": 1452565568 } ãƒ»ç½²åã®JSONãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ ä¾‹ãˆã°JavaScriptã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã€‚ const signature = HMACSHA256( base64urlEncoding(header) + \".\" + base64urlEncoding(payload), secret ) JWTã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä¿æŒ ãƒ» ä¿æŒæ–¹æ³•ã¨å®‰å…¨åº¦ã®æ¯”è¼ƒ å‚è€ƒï¼šhttps://qiita.com/Hiro-mi/items/18e00060a0f8654f49d6#%E6%97%A9%E8%A6%8B%E8%A1%A8 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä¿æŒæ–¹æ³• çµ„ã¿åˆã‚ã› ãŠã™ã™ã‚åº¦ ã‚³ãƒ¡ãƒ³ãƒˆ localStorage â–³ã€œÃ— XSSã§JWTãŒç›—ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ Cookieãƒ˜ãƒƒãƒ€ãƒ¼ ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ â–³ Access-Control-Max-Ageã®æœŸé–“å†…ã ã¨CSRFã§JWTãŒç›—ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ Cookieãƒ˜ãƒƒãƒ€ãƒ¼ CSRFãƒˆãƒ¼ã‚¯ãƒ³ â—¯ SameSiteCookie â—¯ SPAã¨APIãŒåŒä¸€ã‚ªãƒªã‚¸ãƒ³ã®å¿…è¦ãŒã‚ã‚‹ã€‚ "},"public/software/software_application_collaboration_api_restful.html":{"url":"public/software/software_application_collaboration_api_restful.html","title":"ğŸ“– ï¸RESTful-API","keywords":"","body":"RESTful-API ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ 01. RESTã¨RESTfulã¨ã¯ REST ãƒ»RESTã¨ã¯ åˆ†æ•£å‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹æ™‚ã«ã€ãã‚Œãã‚Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€£æºã•ã›ã‚‹ã®ã«é©ã—ãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚¹ã‚¿ã‚¤ãƒ«ã‚’RESTã¨ã„ã†ã€‚RESTã¯ã€ä»¥ä¸‹ã®ç‰¹å¾´ã‚’æŒã¤ã€‚ ãƒ»RESTfulã¨RESTful APIã¨ã¯ RESTã«åŸºã¥ã„ãŸè¨­è¨ˆã‚’RESTfulã¨ã„ã†ã€‚RESTfulè¨­è¨ˆãŒç”¨ã„ã‚‰ã‚ŒãŸWebAPIã‚’RESTful APIã¨ã„ã†ã€‚ä¾‹ãˆã°ã€RESTful APIã®å ´åˆã€DBã«ãŠã‘ã‚‹UserInfoã®CRUDã«å¯¾ã—ã¦ã€ä¸€ã¤ã®ã€/UserInfoã€ã¨ã„ã†URIã‚’å¯¾å¿œã¥ã‘ã¦ã„ã‚‹ã€‚ RESTã®ï¼”åŸå‰‡ ãƒ»Stateless ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã—ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã—ãŸå¾Œã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æƒ…å ±ã‚’ä¿æŒã›ãšã«ç ´æ£„ã™ã‚‹ä»•çµ„ã¿ã®ã“ã¨ã€‚æ“¬ä¼¼çš„ã«Statefulãªé€šä¿¡ã‚’è¡Œã†æ™‚ã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€Cookieã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æƒ…å ±ã‚’ä¿æŒã™ã‚‹ã€‚ Statelessãƒ—ãƒ­ãƒˆã‚³ãƒ« Statefulãƒ—ãƒ­ãƒˆã‚³ãƒ« HTTP SSH HTTPS TLS/SSL - SFTP ãƒ»Connectability ãƒ»Uniform Interface HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€ã€ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹æ“ä½œã€ã¨ã‚‰ãˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¯¾å¿œã¥ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»Addressability ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã‚ˆã£ã¦ã€ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã‚’æ“ä½œã§ãã‚‹ã“ã¨ã€‚ 02. ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã¯ ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®å›ºæœ‰ã®URIã®ã“ã¨ã€‚ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ã¯ã€ãƒªã‚½ãƒ¼ã‚¹1ã¤ã”ã¨ã€ã‚ã‚‹ã„ã¯ã¾ã¨ã¾ã‚Šã”ã¨ã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹ã€‚ HTTPãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®é–¢ä¿‚ RESTfulAPIã§ã¯ã€å…¨ã¦ã®HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®å†…ã€ä¸»ã«ä»¥ä¸‹ã®4ã¤ã‚’ç”¨ã„ã¦ã€ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®æ–¹æ³•ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã€‚ãã‚Œãã‚ŒãŒã€APIã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¯¾å¿œã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã”ã¨ã®ãƒ¡ã‚½ãƒƒãƒ‰åã«ã¤ã„ã¦ã¯ã€Laravelã‚’å‚è€ƒã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://noumenon-th.net/programming/2020/01/30/laravel-crud/ HTTPãƒ¡ã‚½ãƒƒãƒ‰ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ ãƒ¡ã‚½ãƒƒãƒ‰åã®ä¾‹ GET https://example.co.jp/users ãƒ»å…¨ãƒ‡ãƒ¼ã‚¿ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å–å¾—ãƒ»æ¡ä»¶ã«åŸºã¥ããƒ‡ãƒ¼ã‚¿ã®å–å¾— index https://example.co.jp/users/{id} IDã«åŸºã¥ããƒ‡ãƒ¼ã‚¿ã®å–å¾— show POST https://example.co.jp/users ãƒ»ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãƒ»PDFã®ä½œæˆãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ï¼ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ createã€store PUT` https://example.co.jp/users/{id} ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ï¼ˆç½®æ›ï¼‰ update DELETE https://example.co.jp/users/{id} ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ deleteã€destroy POSTé€ä¿¡ã¨PUTé€ä¿¡ã®é‡è¦ãªé•ã„ã«ã¤ã„ã¦ã¾ã¨ã‚ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®æ™‚ã¯POSTé€ä¿¡ã€ã¾ãŸã¯æ›´æ–°ã™ã‚‹æ™‚ã¯PUTé€ä¿¡ã‚’ç”¨ã„ã‚‹ã€‚ãŸã ã—ã‚‚ã£ã¨æ­£ç¢ºã«ã¯ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒã€ä½œæˆã€orã€æ›´æ–°ã€ã§ã¯ãªãã€ã€éå†ªç­‰ã€orã€å†ªç­‰ã€ã§åˆ¤æ–­ã—ãŸã»ã†ãŒè‰¯ã„ã€‚ å‚è€ƒï¼š https://stackoverflow.com/a/2691891/12771072 https://restfulapi.net/rest-put-vs-post/ POSTé€ä¿¡ PUTé€ä¿¡ ãƒ‡ãƒ¼ã‚¿ä½œæˆã®å†ªç­‰æ€§ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ1ã¤ã«ã¤ãã€1ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆï¼ˆéå†ªç­‰çš„ï¼‰ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã«é™ã‚‰ãšã€1ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ï¼ˆå†ªç­‰çš„ï¼‰ã€‚å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã«ç½®æ›ã™ã‚‹è¡Œç‚ºã«è¿‘ã„ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å ´æ‰€ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«JSONãƒ‡ãƒ¼ã‚¿ãªã©ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«idãªã©ã€ã¾ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«JSONãƒ‡ãƒ¼ã‚¿ãªã©ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å‘½å ãƒ»å‹•è©ã‚’ä½¿ç”¨ã—ãªã„ã“ã¨ ã™ã§ã«HTTPãƒ¡ã‚½ãƒƒãƒ‰è‡ªä½“ã«å‹•è©ã®æ„å‘³åˆã„ãŒå«ã¾ã‚Œã‚‹ãŸã‚ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å‹•è©ã‚’å«ã‚ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã®æ™‚ã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹åãŒã‚ã‹ã‚Šã‚„ã™ã„ã‚ˆã†ãªåè©ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼š https://cloud.google.com/blog/products/api-management/restful-api-design-nouns-are-good-verbs-are-bad https://stackoverflow.blog/2020/03/02/best-practices-for-rest-api-design/#h-use-nouns-instead-of-verbs-in-endpoint-paths ãŸã ã—æ…£ä¾‹ã¨ã—ã¦ã€èªè¨¼ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå‹•è©ï¼ˆloginã€logoutã€registerï¼‰ã«ãªã‚‹ã“ã¨ã¯è¨±å®¹ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/7140074/restfully-design-login-or-register-resources https://www.developer.com/web-services/best-practices-restful-api ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/show-user/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users/12345 GET https://example.co.jp/users/hiroki_hasegawa ï¼Šèªè¨¼ã®å ´åˆï¼Š å‹•è©ã‚’è¨±å®¹ã™ã‚‹ã®ã§ã‚ã‚Œã°loginã‚„logoutã¨ã—ã€åè©ã‚’æ¡ç”¨ã™ã‚‹ã®ã§ã‚ã‚Œã°sessionã¨ã™ã‚‹ã€‚ GET https://example.co.jp/login GET https://example.co.jp/session ãƒ»çŸ­ãã™ã‚‹ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š ã“ã“ã§ã€serviceã€apiã€ã¨ã„ã£ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã€ãªãã¦ã‚‚å•é¡Œãªã„ã€‚ GET https://example.co.jp/service/api/users/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users/12345 ãƒ»ç•¥ç§°ã‚’ä½¿ã‚ãªã„ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š ã“ã“ã§ã€Usersã‚’æ„å‘³ã™ã‚‹ã€uã€ã¨ã„ã£ãŸç•¥ç§°ã¯ã€å½“æ™‚ã®è¨­è¨ˆè€…ã—ã‹ã‚ã‹ã‚‰ãªã„ãŸã‚ã€ä¸è¦ã§ã‚ã‚‹ã€‚ GET https://example.co.jp/u/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š ç•¥ç§°ã‚’ä½¿ã‚ãšã«ã€ã€usersã€ã¨ã™ã‚‹ã€‚ GET https://example.co.jp/users/12345 ãƒ»å°æ–‡å­—ã‚’ä½¿ã†ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/Users/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users/12345 ãƒ»ã‚±ãƒãƒ–ã‚±ãƒ¼ã‚¹ã‚’ä½¿ã†ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users_id/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã‚„ã‚­ãƒ£ãƒ¡ã‚±ãƒ¼ã‚¹ã‚’ä½¿ã‚ãšã«ã€ã‚±ãƒãƒ–ã‚±ãƒ¼ã‚¹ã‚’ç”¨ã„ã‚‹ã€‚ GET https://example.co.jp/users-id/12345 ãŸã ã€ãã‚‚ãã‚‚ã‚±ãƒãƒ–æ–¹å¼ã‚‚åˆ©ç”¨ã›ãšã«ã€ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§åŒºåˆ‡ã£ã¦ã—ã¾ã†ã®ã‚‚æ‰‹ã§ã‚ã‚‹ GET https://example.co.jp/users/id/12345 ãƒ»è¤‡æ•°å½¢ã‚’ç”¨ã„ã‚‹ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š Usersã¨ã„ã†é›†åˆã®ä¸­ã«ã€IdãŒå­˜åœ¨ã—ã¦ã„ã‚‹ãŸã‚ã€å˜æ•°å½¢ã¯ä½¿ã‚ãªã„ã€‚ GET https://example.co.jp/user/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users/12345 ãƒ»ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆæ–¹æ³•ãŒãƒãƒ¬ãªã„URIã«ã™ã‚‹ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š æ‚ªæ„ã®ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ã«ã€è„†å¼±æ€§ã‚’ç‹™ã‚ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®è¨­è¨ˆæ–¹æ³•ãŒã°ã‚Œãªã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã™ã‚‹ã“ã¨ã€‚ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«CGIãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚„ã€phpã‚’ç”¨ã„ã¦ã„ã‚‹ã“ã¨ãŒã°ã‚Œã¦ã—ã¾ã†ã€‚ GET https://example.co.jp/cgi-bin/get_users.php ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users/12345 ãƒ»HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®åå‰ã‚’ä½¿ç”¨ã—ãªã„ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰ã€å‡¦ç†ã®ç›®çš„ã¯ã‚ã‹ã‚‹ã®ã§ã€URIã«å¯¾å¿œã™ã‚‹å‹•è©åã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ GET https://example.co.jp/users/get/12345 POST https://example.co.jp/users/create/12345 PUT https://example.co.jp/users/update/12345 DELETE https://example.co.jp/users/delete/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users/{id} POST https://example.co.jp/users PUT https://example.co.jp/users/{id} DELETE https://example.co.jp/users/{id} ãƒ»æ•°å­—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’å¯èƒ½ãªé™ã‚Šä½¿ç”¨ã—ãªã„ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š ã“ã“ã§ã€alphaã€v2ã€ã¨ã„ã£ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã€å½“æ™‚ã®è¨­è¨ˆè€…ã—ã‹ã‚ã‹ã‚‰ãªã„ãŸã‚ã€ã‚ã¾ã‚Šè‰¯ããªã„ã€‚ãŸã ã—ã€åˆ©ä¾¿ä¸Šã€ä½¿ã†å ´åˆã‚‚ã‚ã‚‹ã€‚ GET https://example.co.jp/v2/users/12345 ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š GET https://example.co.jp/users/12345 URLã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨è¨˜ã—ãªã„ä»£ã‚ã‚Šã«ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã®X-api-Versionã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’æ ¼ç´ã™ã‚‹æ–¹æ³•ãŒã‚ˆã‚Šè‰¯ã„ã€‚ X-Api-Version: 1 ãƒ»ç•°ãªã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®é–“ã§ãƒ«ãƒ¼ãƒ«ã‚’çµ±ä¸€ã™ã‚‹ã“ã¨ ï¼Šæ‚ªã„å®Ÿè£…ä¾‹ï¼Š GETé€ä¿¡ã¨POSTé€ä¿¡ã®é–“ã§ã€IDãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®HTTPãƒ¡ã‚½ãƒƒãƒ‰ãŒçµ±ä¸€ã•ã‚Œã¦ã„ãªã„ã€‚ GET https://example.co.jp/users/?id=12345 POST https://example.co.jp/users/12345/messages ï¼Šè‰¯ã„å®Ÿè£…ä¾‹ï¼Š ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ç•°ãªã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®é–“ã§ã‚‚çµ±ä¸€ã™ã‚‹ã€‚ GET https://example.co.jp/users/12345 POST https://example.co.jp/users/12345/messages ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ãƒ»ãƒ‘ã‚¹ã€ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã¸ã®å‰²ã‚Šå½“ã¦ URIã®æ§‹é€ ã®ã†ã¡ã€ãƒ‘ã‚¹ã¾ãŸã¯ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã¦é€ä¿¡ã™ã‚‹ã€‚ãã‚Œãã‚Œã€ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¾ãŸã¯ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã„ã†ã€‚ GET https://example.co.jp:80/users/777?text1=a&text2=b å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³å é€ä¿¡å…ˆã®ãƒãƒ¼ãƒˆç•ªå·ï¼ˆ80ã®å ´åˆã¯çœç•¥å¯ï¼‰ ãƒ«ãƒ¼ãƒˆ ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ï¼Ÿ ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆGETé€ä¿¡æ™‚ã®ã¿ï¼‰ https://example.co.jp 80 users {id} ? text1=a&text2=b ãƒ»ä½¿ã„åˆ†ã‘ï¼ˆå†æ²ï¼‰ ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡å¯¾è±¡ ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ å˜ä¸€æ¡ä»¶ã§æ±ºã¾ã‚‹æ¤œç´¢å‡¦ç† â—¯ â–³ è¤‡æ•°æ¡ä»¶ã§æ±ºã¾ã‚‹æ¤œç´¢å‡¦ç† âœ• â—¯ ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç† âœ• â—¯ ã‚½ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç† âœ• â—¯ ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã¸ã®å‰²ã‚Šå½“ã¦ JSONå‹ãƒ‡ãƒ¼ã‚¿å†…ã«å®šç¾©ã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã¦é€ä¿¡ã™ã‚‹ã€‚ POST https://example.co.jp HTTP/2 # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ { \"id\": 1, \"name\": \"foo\", } ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã¸ã®å‰²ã‚Šå½“ã¦ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã¦é€ä¿¡ã™ã‚‹ã€‚é€ä¿¡æ™‚ã®ãƒ˜ãƒƒãƒ€ãƒ¼åã¯å¤§æ–‡å­—ã§ã‚‚å°æ–‡å­—ã§ã‚‚ã„ãšã‚Œã§ã‚‚å•é¡Œãªã„ãŒã€å†…éƒ¨çš„ã«å°æ–‡å­—ã«å¤‰æ›ã•ã‚Œã‚‹ãŸã‚ã€å°æ–‡å­—ãŒæ¨å¥¨ã§ã‚ã‚‹ã€‚APIã‚­ãƒ¼ã®ãƒ˜ãƒƒãƒ€ãƒ¼åã®é ­æ–‡å­—ã«ã€Xã€ã‚’ä»˜ã‘ã‚‹ã®ã¯ã€ç‹¬è‡ªãƒ˜ãƒƒãƒ€ãƒ¼ã®é ­æ–‡å­—ã«ã€Xã€ã‚’ä»˜ã‘ã‚‹æ…£ç¿’ãŒã‚ã£ãŸãŸã‚ã§ã‚ã‚‹ã€‚ãŸã ã—ã€ç¾åœ¨ã¯éæ¨å¥¨ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/HTTP/Headers POST https://example.co.jp HTTP/2 # Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ authorization: Bearer ${Token} # APIã‚­ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ x-api-key: ***** ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã—ã¦ã€æ¦‚è¦ãŒã‚ã‹ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ä»¥å¤–ã«é–¢ã—ã¦ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã®ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ã®å…·ä½“çš„ãªå†…å®¹ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®try-catchã‚„ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã§åˆ¥ã®è¨€è‘‰ã«ç½®ãæ›ãˆã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/unsoluble_sugar/items/b080a16701946fcfce70 ã‚³ãƒ¼ãƒ‰ æ¦‚è¦ èª¬æ˜ 200 æˆåŠŸ æ­£ã—ã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚ 401 èªè¨¼ã‚¨ãƒ©ãƒ¼ èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚èªè¨¼ãƒ—ãƒ­ã‚»ã‚¹ã§æ­£ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ãŒç™ºè¡Œã•ã‚Œãšã€èªå¯ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã“ã®èª¤ã£ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’é€ä¿¡ã—ãŸã“ã¨ã‚’è¡¨ã™ã€‚èªå¯ã®å¤±æ•—ã§ã¯ãªãã€èªè¨¼ã®å¤±æ•—ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ 403 èªå¯ã‚¨ãƒ©ãƒ¼ã«ã‚ˆã‚‹ãƒˆãƒ¼ã‚¯ãƒ³æ‰€æœ‰è€…ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—å¤– èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚APIã«èªè¨¼ãƒ—ãƒ­ã‚»ã‚¹ãŒå­˜åœ¨ã—ã€ãƒˆãƒ¼ã‚¯ãƒ³ã®ç™ºè¡ŒãŒå¿…è¦ã ã¨ã™ã‚‹ã€‚èªè¨¼ãƒ—ãƒ­ã‚»ã‚¹ã«ã¦æ­£ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ãŒç™ºè¡Œã•ã‚ŒãŸãŒã€èªå¯ãƒ—ãƒ­ã‚»ã‚¹ã«ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã®æ‰€æœ‰è€…ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã¨åˆ¤å®šã•ã‚ŒãŸã“ã¨ã‚’è¡¨ã™ã€‚ ã€ƒ é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®é–²è¦§ç¦æ­¢ èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚APIã«èªè¨¼èªå¯ãƒ—ãƒ­ã‚»ã‚¹ãŒå­˜åœ¨ã›ãšã€ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œã¨é–²è¦§æ¨©é™æ¤œè¨¼ãŒä¸è¦ã ã¨ã™ã‚‹ã€‚é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã«é–²è¦§æ¨©é™ãŒãªã„ã¨åˆ¤å®šã•ã‚Œã¦ã“ã¨ã‚’è¡¨ã™ã€‚ 404 ãƒšãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚‰ãªã„ èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚å­˜åœ¨ã—ãªã„ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ 405 è¨±å¯ã•ã‚Œã¦ã„ãªã„HTTPãƒ¡ã‚½ãƒƒãƒ‰ èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ‘ã‚¹ã¯æ­£ã—ã„ãŒã€HTTPãƒ¡ã‚½ãƒƒãƒ‰ã¯èª¤ã£ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ 409 ç«¶åˆã‚¨ãƒ©ãƒ¼ èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚CREATEå‡¦ç†ã‚„UPDATEå‡¦ç†ã«ã‚ˆã£ã¦ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã¨ç¾åœ¨ã®DBã®ãƒ‡ãƒ¼ã‚¿ã®é–“ã§ç«¶åˆãŒèµ·ã“ã£ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ä¸€æ„ãªè­˜åˆ¥å­ã¨ã—ã¦ç”¨ã„ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®é‡è¤‡ã‚„ã€æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ã«ã‚ˆã‚‹æ’ä»–åˆ¶å¾¡ãŒèµ·ã“ã‚‹å ´åˆã«ç”¨ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_database.html 412 ãƒªã‚½ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼ èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚ãƒªã‚½ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«å¤±æ•—ã—ãŸã“ã¨ã‚’è¡¨ã™ã€‚ 422 ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ èª¤ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã€‚é€ä¿¡ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒèª¤ã£ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ 500 ã‚µãƒ¼ãƒã‚¨ãƒ©ãƒ¼ ã‚µãƒ¼ãƒãƒ¼ã®å‡¦ç†ã§ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html 503 ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ ã‚¨ãƒ©ãƒ¼ã¯èµ·ã“ã‚‰ãªã„ãŒã€ãƒ“ã‚¸ãƒã‚¹ä¸Šã‚ã‚Šãˆãªã„ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ ãƒ»ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¨ãƒªãƒ©ã‚¤ãƒˆã®é•ã„ ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸURLã‚’ã‚µãƒ¼ãƒå´ã§æ–°ã—ã„URLã«æ›¸ãæ›ãˆã¦ãƒ–ãƒ©ã‚¦ã‚¶ã«è¿”ä¿¡ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å†é€ä¿¡ã™ã‚‹ã€‚ãã®ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã¯æ–°ã—ã„URLã§æ”¹ã‚ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ä¸€æ–¹ã§ã€ãƒªãƒ©ã‚¤ãƒˆã§ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸURLã‚’ã‚µãƒ¼ãƒå´ã§ç•°ãªã‚‹URLã«æ›¸ãæ›ãˆã€ã‚µãƒ¼ãƒãŒãã®ã¾ã¾ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ãã®ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã¯å¤ã„URLã®ã¾ã¾ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ãã®ä»–ã®é•ã„ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://blogs.iis.net/owscott/url-rewrite-vs-redirect-what-s-the-difference ãƒ»ãƒªãƒ©ã‚¤ãƒˆã¨ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã®é•ã„ ãƒªãƒ©ã‚¤ãƒˆã§ã¯ç•°ãªã‚‹ã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã§ãã‚‹ãŒã€ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã§ã¯åŒä¸€ã‚µãƒ¼ãƒå†…ã®ç•°ãªã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã—ã‹ã§ããªã„ã€‚ 03. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã§ç”Ÿæˆã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã„ã†ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ç”Ÿæˆã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«ã‚µãƒ¼ãƒå´ã§ç”Ÿæˆã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã„ã†ã€‚ HTTPã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ ãƒ»HTTPã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ ç‰¹å®šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é–¢ã™ã‚‹ã‚ã‚‰ã‚†ã‚‹æƒ…å ±ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ãã®ä»–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯å›ºæœ‰ã®æƒ…å ±ãªã©ï¼‰ã‚’æ‰±ã†ãŸã‚ã®ä»•çµ„ã¿ã®ã“ã¨ã€‚ç‰¹ã«ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ãŠã„ã¦ã‚ˆãä½¿ã‚ã‚Œã‚‹ç”¨èªã§ã‚ã‚‹ã€‚ ãƒ».NET Frameworkã®å ´åˆ .NETã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.microsoft.com/en-us/dotnet/api/system.web.routing.requestcontext?view=netframework-4.8 ãƒ»Ginã®å ´åˆ Goã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ§‹é€ ä½“ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/gin-gonic/gin#Context ãƒ»Nuxt.jsã®å ´åˆ JavaScriptã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://nuxtjs.org/ja/docs/internals-glossary/context/ ãƒ»Lambdaã®å ´åˆ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ãªã¯ã„ãŒã€Lambdaã®å ´åˆã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ 03-02. ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ æ§‹é€  ãƒ»GETé€ä¿¡ã®å ´åˆ ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’è¨˜è¿°ã™ã‚‹æ–¹æ³•ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ä»¥ä¸‹ã®è¦ç´ ã«åˆ†é¡ã§ãã‚‹ã€‚ä»¥ä¸‹ã§ã¯ã€Web APIã®ã†ã¡ã€ç‰¹ã«RESTfulAPIã«å¯¾ã—ã¦é€ä¿¡ã™ã‚‹ãŸã‚ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ§‹é€ ã‚’èª¬æ˜ã™ã‚‹ã€‚ GET https://example.co.jp/bar-form.php?text1=a&text2=b HTTP/2 # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³å Host: example.co.jp Connection: keep-alive Upgrade-Insecure-Requests: 1 # ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€å¤§æœ‰åŠ¹æœŸé™ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸¡æ–¹ã§å®šç¾©å¯èƒ½ï¼‰ Cache-Control: max-age=31536000 # ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ç­‰ User-Agent: Mozzila/5.0 (Windows NT 10.0; Win64; x64) Ch # ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”ä¿¡ã—ã¦ã»ã—ã„MIMEã‚¿ã‚¤ãƒ— Accept: text/html, application/xhtml+xml, application/xml; q=0 # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ä¿¡ã—ã¦ã»ã—ã„ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å½¢å¼ Accept-Encondig: gzip, deflate, br # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ä¿¡ã—ã¦ã»ã—ã„è¨€èª Accept-Language: ja, en-US; q=0.9, en; q=0.8 # é·ç§»å…ƒã®ãƒšãƒ¼ã‚¸ Referer: https://foo.co.jp/ # é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ # â€»ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆALBã‚„CloudFrontãªã©ã‚‚å«ã‚€ï¼‰ã‚’çµŒç”±ã—ã¦ã„ã‚‹å ´åˆã€ãã‚Œã‚‰å…¨ã¦ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚é †ã«è¨­å®šã•ã‚Œã‚‹ X-Forwarded-For: , , ãƒ»POSTé€ä¿¡ã®å ´åˆ ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã€URLã«è¨˜è¿°ã›ãšã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«è¨˜è¿°ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹æ–¹æ³•ã€‚ä»¥ä¸‹ã§ã¯ã€Web APIã®ã†ã¡ã€ç‰¹ã«RESTfulAPIã«å¯¾ã—ã¦é€ä¿¡ã™ã‚‹ãŸã‚ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ§‹é€ ã‚’èª¬æ˜ã™ã‚‹ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«æƒ…å ±ãŒè¨˜è¿°ã•ã‚Œã‚‹ãŸã‚ã€å±¥æ­´ã§ã¯ç¢ºèªã§ããªã„ã€‚ã¾ãŸã€SSLã«ã‚ˆã£ã¦æš—å·åŒ–ã•ã‚Œã‚‹ãŸã‚ã€å‚å—ã§ããªã„ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ä»¥ä¸‹ã®è¦ç´ ã«åˆ†é¡ã§ãã‚‹ã€‚ POST https://example.co.jp/bar-form.php HTTP/2 # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³å Host: example.co.jp Connection: keep-alive Content-Length: 15 # ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€å¤§æœ‰åŠ¹æœŸé™ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸¡æ–¹ã§å®šç¾©å¯èƒ½ï¼‰ Cache-Control: no-store # ã‚ªãƒªã‚¸ãƒ³ï¼ˆãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼‹ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‹ãƒãƒ¼ãƒˆç•ªå·ï¼‰ Origin: https://example.co.jp Upgrade-Insecure-Requests: 1 # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§é€ä¿¡ã™ã‚‹MIMEã‚¿ã‚¤ãƒ— Content-Type: application/x-www-firm-urlencoded # ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ç­‰ User-Agent: Mozzila/5.0 (Windows NT 10.0; Win64; x64) Ap # ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”ä¿¡ã—ã¦ã»ã—ã„MIMEã‚¿ã‚¤ãƒ— Accept: text/html, application/xhtml+xml, application/xml; q=0 # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ä¿¡ã—ã¦ã»ã—ã„ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å½¢å¼ Accept-Encondig: gzip, deflate, br # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ä¿¡ã—ã¦ã»ã—ã„è¨€èª Accept-Language: ja, en-US; q=0.9, en; q=0.8 # é·ç§»å…ƒã®ãƒšãƒ¼ã‚¸ Referer: https://foo.co.jp/ # å„Cookieã®å€¤ï¼ˆäºŒå›ç›®ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«è¨­å®šã•ã‚Œã‚‹ï¼‰ Cookie: sessionid=; csrftoken=; _gat=1 # é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ # â€»ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆALBã‚„CloudFrontãªã©ã‚‚å«ã‚€ï¼‰ã‚’çµŒç”±ã—ã¦ã„ã‚‹å ´åˆã€ãã‚Œã‚‰å…¨ã¦ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚é †ã«è¨­å®šã•ã‚Œã‚‹ X-Forwarded-For: , , # ãƒœãƒ‡ã‚£ã€‚ï¼ˆSSLã«ã‚ˆã£ã¦æš—å·åŒ–ã•ã‚Œã‚‹ãŸã‚é–²è¦§ä¸å¯ï¼‰ text=a&text2=b ãƒ»ä¾‹å¤–ã¨ã—ã¦ã€ãƒœãƒ‡ã‚£ã‚’æŒã¤GETé€ä¿¡ã®å ´åˆ GETé€ä¿¡ã§ã¯ã‚ã‚‹ãŒã€ãƒœãƒ‡ã‚£ã«ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨˜è¿°ã—ã¦é€ä¿¡ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã€‚ POSTMANã§ã€GETé€ä¿¡ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã‚’å«ã‚ã‚‹ã“ã¨ã«ã¤ã„ã¦ï¼š https://github.com/postmanlabs/postman-app-support/issues/131 é€ä¿¡ä¾‹ ãƒ»PHPã®å ´åˆ URL, // HTTPãƒ¡ã‚½ãƒƒãƒ‰ CURLOPT_CUSTOMREQUEST => \"GET\", // SSLè¨¼æ˜æ›¸ã®æ¤œè¨¼ CURLOPT_SSL_VERIFYPEER => false, // æ–‡å­—åˆ—å‹ã§å—ä¿¡ CURLOPT_RETURNTRANSFER => true ] ); // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å®Ÿè¡Œ $messageBody = (curl_exec($curl)) ? curl_exec($curl) : []; // curlã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‰ã˜ã‚‹ curl_close($curl); 03-03. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ æ§‹é€  ï¼Šä¾‹ï¼Š 200 OK # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§é€ä¿¡ã™ã‚‹MIMEã‚¿ã‚¤ãƒ— Content-Type: text/html;charset=UTF-8 Transfer-Encoding: chunked Connection: close # Webã‚µãƒ¼ãƒï¼ˆnginxã€apacheã€AmazonS3ãªã©ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼‰ Server: nginx Date: Sat, 26 Sep 2020 04:25:08 GMT # ãƒªãƒ•ã‚¡ãƒ©ãƒãƒªã‚·ãƒ¼ï¼ˆnginxã€apacheã€ãªã©ã§å®Ÿè£…å¯èƒ½ï¼‰ Referrer-Policy: no-referrer-when-downgrade x-amz-rid: ***** # ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’å«ã‚€Cookieæƒ…å ± Set-Cookie: session-id=*****; Domain=.amazon.co.jp; Expires=Sun, 26-Sep-2021 04:25:08 GMT; Path=/ Set-Cookie: session-id-time=*****; Domain=.amazon.co.jp; Expires=Sun, 26-Sep-2021 04:25:08 GMT; Path=/ Set-Cookie: i18n-prefs=JPY; Domain=.amazon.co.jp; Expires=Sun, 26-Sep-2021 04:25:08 GMT; Path=/ Set-Cookie: skin=noskin; path=/; domain=.amazon.co.jp Accept-CH: ect,rtt,downlink Accept-CH-Lifetime: 86400 X-UA-Compatible: IE=edge Content-Language: ja-JP # ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€å¤§æœ‰åŠ¹æœŸé™ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸¡æ–¹ã§å®šç¾©å¯èƒ½ï¼‰ Cache-Control: no-cache # ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€å¤§æœ‰åŠ¹æœŸé™ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã¿ã§å®šç¾©å¯èƒ½ï¼‰ Expires: Wed, 21 Oct 2015 07:28:00 GMT Pragma: no-cache X-XSS-Protection: 1; X-Content-Type-Options: nosniff Vary: Accept-Encoding,User-Agent,Content-Type,Accept-Encoding,X-Amzn-CDN-Cache,X-Amzn-AX-Treatment,User-Agent Strict-Transport-Security: max-age=*****; includeSubDomains; preload X-Frame-Options: SAMEORIGIN # CloudFrontã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ãƒ’ãƒƒãƒˆã—ãŸã‹ã©ã†ã‹ X-Cache: Miss from cloudfront Via: 1.1 *****.cloudfront.net (CloudFront) X-Amz-Cf-Pop: SEA19-C2 X-Amz-Cf-Id: *****== # è¨€èªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆâ€» php.ini ã«ã¦ã€expose_php = Off ã¨è¨­å®šã™ã‚‹ã“ã¨ã§éè¡¨ç¤ºã«ã§ãã‚‹ï¼‰ X-Powered-By: PHP/7.3.22 # ãƒœãƒ‡ã‚£ ã“ã“ã«ã‚µã‚¤ãƒˆã®HTMLã®ã‚³ãƒ¼ãƒ‰ 04. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã¨ã¯ ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆPOSTï¼‰ï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«å‰²ã‚Šå½“ã¦ã¦é€ä¿¡ï¼è¿”ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã“ã¨ã€‚ ãƒ»MIME typeï¼ˆContent typeï¼‰ POSTï¼PUTé€ä¿¡ã«ãŠã„ã¦ã€ãƒœãƒ‡ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã‚’è¡¨ç¾ã™ã‚‹è­˜åˆ¥å­ã®ã“ã¨ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®Content-Typeãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‹ã¨ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã§ãã‚‹ã€‚GETé€ä¿¡ã«ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://stackoverflow.com/questions/5661596/do-i-need-a-content-type-header-for-http-get-requests ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã‚¿ã‚¤ãƒ— ã‚µãƒ–ãƒ¬ãƒ™ãƒ«ã‚¿ã‚¤ãƒ— æ„å‘³ application octet-stream ä»»æ„ã®MIME typeï¼ˆæŒ‡å®šãªã—ï¼‰ã‚’ç¤ºã™ã€‚ javascript json x-www-form-urlencoded POSTé€ä¿¡ã®ãƒ‡ãƒ¼ã‚¿ zip text html HTMLãƒ†ã‚­ã‚¹ãƒˆ css CSSãƒ†ã‚­ã‚¹ãƒˆ plane ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ image png jpeg gif ãƒ»ãƒ‡ãƒ¼ã‚¿å‹ã®æŒ‡å®šæ–¹æ³• æœ€ã‚‚è‰¯ã„æ–¹æ³•ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®Content-Typeãƒ˜ãƒƒãƒ€ãƒ¼ã«ã€ã€application/jsonã€ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚ POST https://example.co.jp/users/12345 # ãƒ˜ãƒƒãƒ€ãƒ¼ Content-Type: application/json ä»–ã«ã€URIã§ãƒ‡ãƒ¼ã‚¿å‹ã‚’è¨˜è¿°ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã€‚ POST https://example.co.jp/users/12345?format=json ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆPOSTã€PUTï¼‰ æ­£å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ä¿¡ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã¨åŒã˜ã€‚ æ­£å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å ´åˆ ãƒ»POSTï¼PUTã§ã¯å‡¦ç†å¾Œãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ POSTï¼PUTãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€å‡¦ç†å¾Œã®ãƒ‡ãƒ¼ã‚¿ã‚’200ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚ã‚‚ã—å‡¦ç†å¾Œã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ä¿¡ã—ãªã„å ´åˆã€æ”¹ã‚ã¦GETãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ä½™åˆ†ãªAPIã‚³ãƒ¼ãƒ«ãŒå¿…è¦ã«ãªã£ã¦ã—ã¾ã†ã€‚ å‚è€ƒï¼š https://developer.ntt.com/ja/blog/741a176b-372f-4666-b649-b677dd23e3f3 https://qiita.com/wim/items/dbb6def4e207f6048735 ãƒ»DELETEã§ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ DELETEãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’200ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚ç©ºãƒœãƒ‡ã‚£204ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã—ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/25970523/restful-what-should-a-delete-response-body-contain/50792918 https://qiita.com/fukuma_biz/items/a9e8d18467fe3e04068e#4-delete---%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E5%89%8A%E9%99%A4 ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ä¸è¦ æ­£å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å ´åˆã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®å‰²ã‚Šå½“ã¦ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ { \"name\": \"Taro Yamada\" } ãƒ»ãƒ•ãƒ©ãƒƒãƒˆãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«ã™ã‚‹ã“ã¨ JSONã®å ´åˆã€éšå±¤æ§‹é€ ã«ã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿å®¹é‡ãŒå¢—ãˆã¦ã—ã¾ã†ã€‚ ï¼Šä¾‹ï¼Š { \"name\": \"Taro Yamada\", \"age\": 10, \"interest\": { \"sports\":[\"soccer\", \"baseball\"], \"subjects\": \"math\" } } ãã“ã§ã€ã§ãã‚‹ã ã‘ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ãƒ•ãƒ©ãƒƒãƒˆã«ã™ã‚‹ã€‚ãŸã ã—ã€è¦‹ã‚„ã™ã•ã«ã‚ˆã£ã¦ã¯éšå±¤æ§‹é€ ã‚‚è¨±å®¹ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/Web-API-The-Good-Parts/dp/4873116864 ï¼Šä¾‹ï¼Š { \"name\": \"Taro Yamada\", \"age\": 10, \"sports\":[\"soccer\", \"baseball\"], \"subjects\": \"math\" } ã‚ã‚‹ã„ã¯ã€Content-Typeãƒ˜ãƒƒãƒ€ãƒ¼ã«ã€application/hal+jsonã€ã€application/vnd.api+jsonã€ã€application/vnd.collection+jsonã€ã¨ã„ã£ãŸã‚ˆã‚ŠJSONãƒ™ãƒ¼ã‚¹ã®å¼·ã„åˆ¶ç´„ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’åˆ©ç”¨ã™ã‚‹ã€‚ ãƒ»æ—¥ä»˜ãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ã«æ°—ã‚’ã¤ã‘ã‚‹ã“ã¨ RFC3339ï¼ˆW3C-DTFï¼‰å½¢å¼ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã«å«ã‚ã¦é€å—ä¿¡ã™ã‚‹ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š 2020-07-07T12:00:00+09:00 ãŸã ã—ã€æ—¥ä»˜ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§é€å—ä¿¡ã™ã‚‹æ™‚ã€RFC3339ï¼ˆW3C-DTFï¼‰å½¢å¼ã‚’æ­£è¦è¡¨ç¾ã§è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§æ³¨æ„ã€‚ ï¼Šä¾‹ï¼Š GET https://example.co.jp/users/12345?date=2020-07-07T12:00:00%2B09:00 ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å ´åˆ { \"code\": 400 \"errors\": [ \"ã€‡ã€‡ã¯å¿…ãšå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\", \"â–¡â–¡ã¯å¿…ãšå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\" ] \"url\" : \"https://example-api-doc.co.jp\" } å‚è€ƒï¼šhttps://qiita.com/suin/items/f7ac4de914e9f3f35884#%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9%E3%81%A7%E8%80%83%E6%85%AE%E3%81%97%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8 ç¨®é¡ å¿…è¦æ€§ ãƒ‡ãƒ¼ã‚¿å‹ èª¬æ˜ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ å¿…é ˆ æ–‡å­—åˆ—å‹ è¤‡æ•°ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ä¿¡ã§ãã‚‹ã‚ˆã†ã«ã€é…åˆ—ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ ä»»æ„ æ•´æ•°å‹ ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ãŒã‚ã‹ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹å¤–ã‚³ãƒ¼ãƒ‰ï¼‰ ä»»æ„ æ–‡å­—åˆ—å‹ APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚¨ãƒ©ãƒ¼ã®è­˜åˆ¥å­ã¨ã—ã¦ã€ã‚¨ãƒ©ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹å¤–ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®URL ä»»æ„ æ–‡å­—åˆ—å‹ å¤–éƒ¨ã«å…¬é–‹ã™ã‚‹APIã®å ´åˆã€ã‚¨ãƒ©ãƒ¼ã®è§£æ±ºç­–ãŒã‚ã‹ã‚‹APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®URLã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ 05. Statelessãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«ãŠã‘ã‚‹æ“¬ä¼¼StatefulåŒ– Cookieã€Cookieæƒ…å ±ï¼ˆã‚­ãƒ¼åï¼å€¤ï¼‰ ãƒ»Cookieã€Cookieæƒ…å ±ã¨ã¯ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®æ¬¡å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã§ã‚‚ã€Cookieæƒ…å ±ï¼ˆã‚­ãƒ¼åï¼å€¤ã®ã‚»ãƒƒãƒˆï¼‰ã‚’ç”¨ã„ã¦ã€åŒä¸€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨èªè­˜ã§ãã‚‹ä»•çµ„ã¿ã‚’Cookieã¨ã„ã†ã€‚HTTPã¯Statelessãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ã‚‹ãŒã€Cookieæƒ…å ±ã«ã‚ˆã‚Šæ“¬ä¼¼çš„ã«Statefulãªé€šä¿¡ã‚’è¡Œãˆã‚‹ã€‚ ãƒ»Cookieæƒ…å ±ã«é–¢ã‚ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼ æœ€åˆã€ã‚µãƒ¼ãƒã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã€Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”¨ã„ã¦é€ä¿¡ã•ã‚Œã‚‹ã€‚åå¯¾ã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã€Cookieæƒ…å ±ã¯ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”¨ã„ã¦é€ä¿¡ã•ã‚Œã‚‹ã€‚ HTTPãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç¨®é¡ ãƒ˜ãƒƒãƒ€ãƒ¼å å±æ€§ å†…å®¹ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ Set-Cookie Name Cookieåã¨å€¤ Expires Cookieã®æœ‰åŠ¹æœŸé™ï¼ˆæ—¥æ•°ï¼‰ Max-Age Cookieã®æœ‰åŠ¹æœŸé™ï¼ˆç§’æ•°ï¼‰ Domain ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹æ™‚ã®Cookieé€ä¿¡å…ˆãƒ‰ãƒ¡ã‚¤ãƒ³åã€‚ Path ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹æ™‚ã®Cookieé€ä¿¡å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª Secure ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§SSLãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹æ™‚ã®ã¿ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ HttpOnly ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã€JavaScriptãŒCookieã‚’ä½¿ç”¨ã§ããªã„ã‚ˆã†ã«ã™ã‚‹ã€‚XSSæ”»æ’ƒã®å¯¾ç­–ã«ãªã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ Cookie ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãªã©ã®Cookieæƒ…å ± ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ããŸãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®å†…å®¹ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ \"å€¤\"] ãƒ»ä»•çµ„ã¿ æœ€åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã€‚ ã‚µãƒ¼ãƒã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«Cookieæƒ…å ±ã‚’åŸ‹ã‚è¾¼ã‚“ã§é€ä¿¡ã™ã‚‹ã€‚ ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ãã®Cookieæƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ã€‚ 2å›ç›®ä»¥é™ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã®Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«Cookieæƒ…å ±ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã€‚ã‚µãƒ¼ãƒã¯ã€Cookieæƒ…å ±ã«ç´ä»˜ãã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’Readã™ã‚‹ã€‚ ã‚»ãƒƒã‚·ãƒ§ãƒ³ ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã¨ã¯ ç‰¹å®šã®ã‚µã‚¤ãƒˆã‚’è¨ªå•ã—ã¦ã‹ã‚‰ã€é›¢è„±ã™ã‚‹ã¾ã§ã®ä¸€é€£ã®ãƒ¦ãƒ¼ã‚¶æ“ä½œã‚’ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ã¨ã„ã†ã€‚ã“ã®æ™‚ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ã‚‹ã¨ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡å…ƒã‚’åŒä¸€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã—ã¦è­˜åˆ¥ã§ãã‚‹ã€‚HTTPã¯Statelessãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ã‚‹ãŒã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ã‚ˆã‚Šæ“¬ä¼¼çš„ã«Statefulãªé€šä¿¡ã‚’è¡Œãˆã‚‹ã€‚ä¾‹ãˆã°ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ã‚ˆã‚Šã€ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«ãƒšãƒ¼ã‚¸é·ç§»ã‚’è¡Œã£ã¦ã‚‚ã€ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’ä¿æŒã§ãã€åŒä¸€ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ã—ã¦èªè­˜ã§ãã‚‹ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã¯ã€Cookieæƒ…å ±ã®ä¸€ã¤ã¨ã—ã¦ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã¨Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”¨ã„ã¦é€å—ä¿¡ã•ã‚Œã‚‹ã€‚ # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã®å ´åˆ Cookie: sessionid=; csrftoken=u32t4o3tb3gg43; _gat=1 # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®å ´åˆ Set-Cookie: sessionId= ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ã¯Googleã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªã§ãã‚‹ã€‚GoogleConsoleã«ãŠã‘ã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://support.google.com/analytics/answer/6086069?hl=ja ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã®ç™ºè¡Œã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ã€session_startãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã“ã¨ã§é–‹å§‹ã•ã‚Œã‚‹ã€‚ã¾ãŸåŒæ™‚ã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç™ºè¡Œã™ã‚‹ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä»£å…¥ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã®è¨˜è¼‰ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ç´ä»˜ããã®ä»–ã®ãƒ‡ãƒ¼ã‚¿ã¯ã“ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¾ã‚Œã¦ã„ãã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã¯ã€sess_*****ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãªã£ã¦ãŠã‚Šã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…ƒã«ã—ã¦ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ç´ä»˜ããƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ã™ã‚‹ã€‚ã‚‚ã—ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æ—¢ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒç™ºè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å ´æ‰€ ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å ´æ‰€ã¯/etc/php.iniãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã§ãã‚‹ã€‚ # /etc/php.ini ### ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ session.save_handler = files ### ä¿å­˜å ´æ‰€ session.save_path = \"/tmp\" ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã‚µãƒ¼ãƒå¤–ï¼ˆPHP Redisã€ElastiCache Redisãªã©ï¼‰ã«ä¿å­˜ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚/etc/php-fpm.d/www.confãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãªãã€/etc/php.iniãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ä¿å­˜å…ˆã®æŒ‡å®šãŒå¿…è¦ã§ã‚ã‚‹ã€‚ElastiCache Redisã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws.html # /etc/php.ini ## Rediså½¢å¼ session.save_handler = redis ## Amazon Redisã®Origin session.save_path = \"tcp://foo-redis.*****.ng.0001.apne1.cache.amazonaws.com:6379\" ãªãŠã€PHP-FPMã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã¯ã€/etc/php-fpm.d/www.confãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å…ˆã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ # /etc/php-fpm.d/www.conf ## Rediså½¢å¼ php_value[session.save_handler] = redis ## Amazon Redisã®Origin php_value[session.save_path] = \"tcp://foo-redis.*****.ng.0001.apne1.cache.amazonaws.com:6379\" ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æœŸé™ã¨åˆæœŸåŒ–ç¢ºç‡ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æœŸé™ã‚’è¨­å®šã§ãã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç”»é¢é·ç§»æ™‚ã«ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’ä¿æŒã§ãã‚‹ç§’æ•°ã‚’å®šç¾©ã§ãã‚‹ã€‚ # 24æ™‚é–“ session.gc_maxlifetime = 86400 ãŸã ã—ã€æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸå¾Œã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆæœŸåŒ–ã™ã‚‹ã‹ã©ã†ã‹ã¯ç¢ºç‡ã«ã‚ˆã£ã¦å®šã‚ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ç¢ºç‡ã¯ã€ ã€gc_probabilityÃ·gc_divisorã€ ã§è¨ˆç®—ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://www.php.net/manual/ja/session.configuration.php#ini.session.gc-divisor # æœ‰åŠ¹æœŸé™å¾Œã«100%åˆæœŸåŒ–ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ session.gc_probability = 1 session.gc_divisor = 1 ãƒ»ä»•çµ„ã¿ æœ€åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç™ºè¡Œã—ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã”ã¨ã«sess_*****ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã€‚ ã‚µãƒ¼ãƒã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€æƒ…å ±ã®Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’é€ä¿¡ã™ã‚‹ã€‚ ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ãã®ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä¿å­˜ã™ã‚‹ã€‚ 2å›ç›®ä»¥é™ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€æƒ…å ±ã®Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã€‚ã‚µãƒ¼ãƒã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ç´ä»˜ãã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’Readã™ã‚‹ã€‚ "},"public/software/software_application_collaboration_api_restful_api_specification.html":{"url":"public/software/software_application_collaboration_api_restful_api_specification.html","title":"ğŸ“– ï¸APIä»•æ§˜æ›¸","keywords":"","body":"APIä»•æ§˜æ›¸ 01. OpenAPIä»•æ§˜ OpenAPIä»•æ§˜ã¨ã¯ RESTful APIã®ä»•æ§˜ã‚’å®Ÿè£…ã«ã‚ˆã‚Šèª¬æ˜ã™ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ã“ã¨ã€‚JSONå‹ã¾ãŸã¯YAMLå‹ã§å®Ÿè£…ã§ãã‚‹ã€‚ã„ãã¤ã‹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://spec.openapis.org/oas/v3.1.0#fixed-fields openapi: # openapiãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ info: # infoãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ servers: # serversãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ paths: # pathsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ webhooks: # webhooksãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ components: # componentsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ security: # securityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ tags: # tagsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ externalDocs: # externalDocsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ API Gatewayã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒãƒ¼ãƒˆ API Gatewayã«ã‚ˆã‚‹OpenAPIä»•æ§˜ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws_api_gateway_import.html ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ ãƒ»openapiãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆå¿…é ˆï¼‰ OpenAPIä»•æ§˜ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š openapi: 3.0.0 ãƒ»infoãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆå¿…é ˆï¼‰ APIåã€ä½œæˆè€…åã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã€ãªã©ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š info: title: Foo API # APIå description: The API for Foo. # APIã®èª¬æ˜ termsOfService: https://www.foo.com/terms/ # åˆ©ç”¨è¦ç´„ contact: name: API support # é€£çµ¡å…ˆå url: https://www.foo.com/support # é€£çµ¡å…ˆã«é–¢ã™ã‚‹URL email: support@foo.com # ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ license: name: Apache 2.0 # ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ url: https://www.apache.org/licenses/LICENSE-2.0.html # URL version: 1.0.0 # APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ãƒ»serversãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ APIè‡ªä½“ã®URLã€ãªã©ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š servers: - url: https://{env}.foo.com/api/v1 description: | variables: env: default: stg description: API environment enum: - stg - www ãƒ»pathsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆå¿…é ˆï¼‰ APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€HTTPãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã€ãªã©ã‚’å®šç¾©ã™ã‚‹ã€‚ paths: #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: # GETãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚ tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: å…¨ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== parameters: [] #=========================== # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ Users: User: userId: 1 name: Hiroki schema: $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== post: # POSTãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚ tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆ description: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’ä½œæˆã™ã‚‹ã€‚ #=========================== # ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== parameters: [] requestBody: # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ description: ãƒ¦ãƒ¼ã‚¶ID content: application/json: # MIME type foo: # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: $ref: \"#/components/schemas/normal\" # ã‚¹ã‚­ãƒ¼ãƒã¨ã—ã¦ã€æ­£å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ã‚¹ã‚­ãƒ¼ãƒã¨ã—ã¦ã€ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users/{userId}: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string foo: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== put: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±æ›´æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æ›´æ–° description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã€‚ #=========================== # ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string foo: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # Content-Type foo: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # Content-Type foo: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # Content-Type foo: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ ãƒ»componentsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆå¿…é ˆï¼‰ ã‚¹ã‚­ãƒ¼ãƒãªã©ã€ä»–ã®é …ç›®ã§å…±é€šã—ã¦åˆ©ç”¨ã™ã‚‹ã‚‚ã®ã‚’å®šç¾©ã™ã‚‹ã€‚ components: #=========================== # callbackã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== callbacks: { } #=========================== # linkã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== links: { } #=========================== # responseã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== responses: unauthorized: description: Unauthorized ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type foo: # ãƒœãƒ‡ã‚£ä¾‹ status: 401 title: Unauthorized errors: messages: [ \"APIã‚­ãƒ¼ã®èªå¯ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # schemaã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== schemas: # ãƒ¦ãƒ¼ã‚¶ user: type: object properties: userId: type: string name: type: string # æ­£å¸¸ç³» normal: type: object properties: userId: type: string # ç•°å¸¸ç³» error: type: object properties: messages: type: array items: type: string #=========================== # securityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å…±é€šåŒ– #=========================== securitySchemes: # Basicèªè¨¼ basicAuth: description: Basicèªè¨¼ type: http scheme: basic # Bearerèªè¨¼ bearerAuth: description: Bearerèªè¨¼ type: http scheme: bearer # APIã‚­ãƒ¼èªè¨¼ apiKeyAuth: description: APIã‚­ãƒ¼èªè¨¼ type: apiKey name: x-api-key # ãƒ˜ãƒƒãƒ€åã¯ã€x-api-keyã€ã¨ã™ã‚‹ã€‚å°æ–‡å­—ãŒæ¨å¥¨ã§ã‚ã‚‹ã€‚ in: header ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»securityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ componentsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§å®šç¾©ã—ãŸèªè¨¼æ–¹æ³•ã‚’å®£è¨€ã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒˆã§å®£è¨€ã™ã‚‹ã¨ã€å…¨ã¦ã®ãƒ‘ã‚¹ã«é©ç”¨ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š security: - apiKeyAuth: [] ãƒ»tagsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ å„é …ç›®ã«ä»˜ã‘ã‚‹ã‚¿ã‚°ã‚’å®šç¾©ã™ã‚‹ã€‚åŒåã®ã‚¿ã‚°ã‚’ã¤ã‘ã‚‹ã¨ã€è‡ªå‹•çš„ã«ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š tags: - name: ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ description: | ãƒ»externalDocsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ APIã‚’èª¬æ˜ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒªãƒ³ã‚¯ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š externalDocs: description: è£œè¶³æƒ…å ±ã¯ã“ã¡ã‚‰ url: https://foo.com ã‚¹ã‚­ãƒ¼ãƒ ãƒ»ã‚¹ã‚­ãƒ¼ãƒã¨ã¯ APIã«å¯¾ã—ã¦é€ä¿¡ã•ã‚Œã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿ã€ã¾ãŸã¯APIã‹ã‚‰è¿”ä¿¡ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã€ãƒ‡ãƒ¼ã‚¿å‹ã‚„å¿…é ˆãƒ‡ãƒ¼ã‚¿ã‚’ã€JSONå‹ã¾ãŸã¯YAMLå‹ã§å®Ÿè£…ã—ã¦ãŠã„ãŸã‚‚ã®ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã®ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ç”¨ã„ã‚‹ã€‚ ãƒ»ã‚¹ã‚­ãƒ¼ãƒã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ‡ãƒ¼ã‚¿å‹ã‚„å¿…é ˆãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚Šã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://spec.openapis.org/oas/v3.1.0#data-types ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ãˆã°ã€APIãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«ä»¥ä¸‹ã®ã‚ˆã†ãªJSONå‹ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ { \"id\": 1, \"name\": \"Taro Yamada\", \"age\": 10, \"sports\":[\"soccer\", \"baseball\"], \"subjects\": \"math\" } ã“ã“ã§ã€ã‚¹ã‚­ãƒ¼ãƒã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¦ãŠãã€APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹æ™‚ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚ { \"$schema\": \"https://json-schema.org/draft-04/schema#\", \"type\": \"object\", \"properties\": { \"id\": { \"type\": \"integer\", \"minimum\": 1 }, \"name\": { \"type\": \"string\" }, \"age\": { \"type\": \"integer\", \"minimum\": 0 }, \"sports\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }, \"subjects\": { \"type\": \"string\" } }, \"required\": [\"id\"] } ãƒ»API Gatewayã«ãŠã‘ã‚‹ã‚¹ã‚­ãƒ¼ãƒè¨­å®š API Gatewayã«ã¦ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«ã‚¹ã‚­ãƒ¼ãƒã‚’è¨­å®šã§ãã‚‹ã€‚è©³ã—ãã¯ã€ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws.html "},"public/software/software_application_object_oriented_language_php_command_and_configuration.html":{"url":"public/software/software_application_object_oriented_language_php_command_and_configuration.html","title":"ğŸ“– PHPã‚³ãƒãƒ³ãƒ‰ã¨è¨­å®š","keywords":"","body":"PHPã‚³ãƒãƒ³ãƒ‰ã¨è¨­å®š ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒãƒ³ãƒ‰ -i PHPã®è¨­å®šã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ php -i phpinfo() PHP Version => 7.4 ... å‡ºåŠ›é‡ãŒå¤šã„ãŸã‚ã€grepã‚’ç”¨ã„ã¦ã€ç‰¹å®šã®é …ç›®ã®ã¿ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨è‰¯ã„ã€‚ # PHPã®ãƒ—ãƒ­ã‚»ã‚¹ãŒä½¿ç”¨å¯èƒ½ãªã‚ã‚‚ã‚Šã® $ php -i | grep memory_limit memory_limit => 2048M => 2048M --ini Configuration Fileã®é …ç›®ã§ã€php.iniãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ php --ini Configuration File (php.ini) Path: /usr/local/etc/php # iniãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª Loaded Configuration File: (none) Scan for additional .ini files in: /usr/local/etc/php/conf.d Additional .ini files parsed: /usr/local/etc/php/conf.d/docker-php-ext-bcmath.ini, /usr/local/etc/php/conf.d/docker-php-ext-pdo_mysql.ini, /usr/local/etc/php/conf.d/docker-php-ext-sodium.ini $ ls -la /usr/local/etc/php total 164 drwxr-xr-x 1 root root 4096 Sep 1 2020 . drwxr-xr-x 1 root root 4096 Sep 1 2020 .. drwxr-xr-x 1 root root 4096 Sep 25 12:22 conf.d -rw-r--r-- 1 root root 72278 Sep 1 2020 php.ini-development # é–‹ç™ºç’°å¢ƒç”¨iniãƒ•ã‚¡ã‚¤ãƒ« -rw-r--r-- 1 root root 72582 Sep 1 2020 php.ini-production # æœ¬ç•ªç’°å¢ƒç”¨iniãƒ•ã‚¡ã‚¤ãƒ« --ri æ‹¡å¼µãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è¨­å®šå€¤ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ php --ri= $ php --ri=Core Core PHP Version => 7.4.9 Directive => Local Value => Master Value highlight.comment => #FF8000 => #FF8000 highlight.default => #0000BB => #0000BB highlight.html => #000000 => #000000 highlight.keyword => #007700 => #007700 highlight.string => #DD0000 => #DD0000 display_errors => STDOUT => STDOUT display_startup_errors => Off => Off enable_dl => On => On ... zend.detect_unicode => On => On zend.signal_check => Off => Off zend.exception_ignore_args => Off => Off 02. è¨­å®š php.iniãƒ•ã‚¡ã‚¤ãƒ« ãƒ»php.iniãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ PHPã®è¨­å®šã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://www.php.net/manual/ja/configuration.file.php ãƒ»é–‹ç™ºç’°å¢ƒç”¨php.iniãƒ•ã‚¡ã‚¤ãƒ« ã‚ã‚‰ã‹ã˜ã‚ç”¨æ„ã•ã‚Œã¦ã„ã‚‹php.ini-developmentãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚è€ƒã«è¨­å®šã™ã‚‹ã€‚å…ƒã€…ã®å€¤ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã§ç¤ºã™ã€‚ å‚è€ƒï¼šhttps://qiita.com/ucan-lab/items/0d74378e1b9ba81699a9 # é–‹ç™ºç’°å¢ƒã§ã¯ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¡¨ç¤º zend.exception_ignore_args = off # on expose_php = on max_execution_time = 30 max_input_vars = 1000 upload_max_filesize = 64M # 2M post_max_size = 128M # 8M memory_limit = 256M # 128M # é–‹ç™ºç’°å¢ƒã§ã¯ã€å…¨ã¦ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’å‡ºåŠ› error_reporting = E_ALL # NULL display_errors = on display_startup_errors = on # é–‹ç™ºç’°å¢ƒã§ã¯ã€ãƒ­ã‚°ã‚’error_logå€¤ã®å ´æ‰€ã«å‡ºåŠ› log_errors = on # 0(off) # é–‹ç™ºç’°å¢ƒã§ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ› error_log = /var/log/php/php-error.log # NULL default_charset = UTF-8 [Date] date.timezone = Asia/Tokyo # GMT [mysqlnd] # é–‹ç™ºç’°å¢ƒã§ã¯ã€ãƒ¡ãƒ¢ãƒªã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›† mysqlnd.collect_memory_statistics = on # off [Assertion] zend.assertions = 1 [mbstring] mbstring.language = Japanese ãƒ»æœ¬ç•ªç’°å¢ƒç”¨php.iniãƒ•ã‚¡ã‚¤ãƒ« ã‚ã‚‰ã‹ã˜ã‚ç”¨æ„ã•ã‚Œã¦ã„ã‚‹php.ini-productionãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚è€ƒã«è¨­å®šã™ã‚‹ã€‚å…ƒã€…ã®å€¤ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã§ç¤ºã™ã€‚ å‚è€ƒï¼šhttps://qiita.com/ucan-lab/items/0d74378e1b9ba81699a9 zend.exception_ignore_args = on # æœ¬ç•ªç’°å¢ƒã§ã¯ã€X-Powered-Byãƒ˜ãƒƒãƒ€ãƒ¼ã®PHPãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’éè¡¨ç¤º expose_php = off # on max_execution_time = 30 max_input_vars = 1000 upload_max_filesize = 64M post_max_size = 128M memory_limit = 256M # æœ¬ç•ªç’°å¢ƒã§ã¯ã€ç‰¹å®šã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’å‡ºåŠ› error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT # NULL # æœ¬ç•ªç’°å¢ƒã§ã¯ã€ã‚¨ãƒ©ãƒ¼ã‚’ç”»é¢ã«éè¡¨ç¤º display_errors = off # on display_startup_errors = off # æœ¬ç•ªç’°å¢ƒã§ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’error_logå€¤ã®å ´æ‰€ã«å‡ºåŠ› log_errors = on # 0(off) # æœ¬ç•ªç’°å¢ƒã§ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ› error_log = /dev/stderr # NULL default_charset = UTF-8 [Date] date.timezone = Asia/Tokyo [mysqlnd] mysqlnd.collect_memory_statistics = off [Assertion] zend.assertions = -1 [mbstring] mbstring.language = Japanese # æœ¬ç•ªç’°å¢ƒã§ã¯ã€Opcacheæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ– [opcache] opcache.enable = 1 opcache.memory_consumption = 128 opcache.interned_strings_buffer = 8 opcache.max_accelerated_files = 4000 opcache.validate_timestamps = 0 opcache.huge_code_pages = 0 opcache.preload = /var/www/preload.php opcache.preload_user = www-data 03. å½¹ç«‹ã¤æ©Ÿèƒ½ OPcache ãƒ»OPcacheã¨ã¯ é€šå¸¸ã€PHPã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯å®Ÿè¡Œã®åº¦ã«ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ã‚³ãƒ¼ãƒ‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆã—ã¦ãŠãã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã ã‘å¤‰æ›ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€PHPã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡ŒãŒé«˜é€ŸåŒ–ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://weblabo.oscasierra.net/php-opcache/ "},"public/software/software_application_object_oriented_language_php_class_based.html":{"url":"public/software/software_application_object_oriented_language_php_class_based.html","title":"ğŸ“– ï¸ã‚¯ãƒ©ã‚¹","keywords":"","body":"ã‚¯ãƒ©ã‚¹ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ 01. has-oneã€has-manyï¼ˆãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹é–¢ä¿‚æ€§ï¼‰ has-oneã€has-manyãªé–¢ä¿‚æ€§ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_object_oriented_analysis_and_design.html Associationï¼ˆé–¢é€£ï¼‰ ãƒ»Associationã¨ã¯ ã‚¯ãƒ©ã‚¹ï¼¡ãŒã‚¯ãƒ©ã‚¹ï¼¢ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹é–¢ä¿‚æ€§ã®ã“ã¨ã€‚å¼•æ•°å‹ï¼è¿”å´å€¤å‹ã¨ã—ã¦ç”¨ã„ã‚‹ã€ä¾å­˜ã€ã¨ã¯åŒºåˆ¥ã™ã‚‹ã€‚ ãƒ»Associationã®ç¨®é¡ ä¿æŒã•ã‚Œã‚‹å´ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã€ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹å´ã®ã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ã‹å¦ã‹ã«ã‚ˆã£ã¦ã€ã€Aggregationã€ã¾ãŸã¯ã€Compositionã€ã«åˆ†é¡ã§ãã‚‹ã€‚ Aggregationï¼ˆé›†ç´„ï¼‰ ãƒ»Aggregationã¨ã¯ ä¿æŒã•ã‚Œã‚‹å´ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã€ä¿æŒã™ã‚‹å´ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œãšã«å¤–å´ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹æ™‚ã€ã‚¯ãƒ©ã‚¹é–“ãŒã€Aggregationã€ã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ ãƒ»ä¾‹ Userã¯UserNameã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹ã€‚ name = $name; } } ã¾ãŸã€UserNameã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã€Userã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œãšã«å¤–å´ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€Userã‚¯ãƒ©ã‚¹ã¨UserNameã‚¯ãƒ©ã‚¹ã¯ã€Aggregationã€ã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š tire1 = $t1; $this->tire2 = $t2; $this->tire3 = $t3; $this->tire4 = $t4; } } ã¾ãŸã€Tireã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã€Carã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œãšã«å¤–å´ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€Carã‚¯ãƒ©ã‚¹ã¨Tireã‚¯ãƒ©ã‚¹ã¯ã€Aggregationã€ã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ Compositionï¼ˆåˆæˆï¼‰ ãƒ»Compositionã¨ã¯ ä¿æŒã•ã‚Œã‚‹å´ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã€ä¿æŒã™ã‚‹å´ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹æ™‚ã€ã‚¯ãƒ©ã‚¹é–“ãŒã€Compositionã€ã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ ãƒ»ä¾‹ ï¼Šå®Ÿè£…ä¾‹ï¼Š Userã‚¯ãƒ©ã‚¹ã¯UserNameã‚¯ãƒ©ã‚¹ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹ã€‚ getName(); } } ã¾ãŸã€UserNameã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã€Userã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€Userã‚¯ãƒ©ã‚¹ã¨UserNameã‚¯ãƒ©ã‚¹ã¯ã€Compositionã€ã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Carã‚¯ãƒ©ã‚¹ã¯Lockã‚¯ãƒ©ã‚¹ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹ã€‚ lock = new Lock(); } } ã¾ãŸã€Lockã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã€Carã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€Carã‚¯ãƒ©ã‚¹ã¨Lockã‚¯ãƒ©ã‚¹ã¯ã€Compositionã€ã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ 02. is-a-kind-ofï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ¡ãƒ³ãƒãƒ¼ã®é–¢ä¿‚æ€§ï¼‰ is-a-kind-ofãªé–¢ä¿‚æ€§ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_object_oriented_analysis_and_design.html Generalizationï¼ˆæ±åŒ–ï¼‰ ãƒ»æ±åŒ–ã«ãŠã‘ã‚‹Override æ±åŒ–ã®æ™‚ã€å­ã‚¯ãƒ©ã‚¹ã§ãƒ¡ã‚½ãƒƒãƒ‰ã®å‡¦ç†å†…å®¹ã‚’å†ã³å®Ÿè£…ã™ã‚‹ã¨ã€å‡¦ç†å†…å®¹ã¯ä¸Šæ›¸ãã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š name = $name; $this->price = $price; } // â˜…â˜…â˜…â˜…â˜…â˜…æ³¨ç›®â˜…â˜…â˜…â˜…â˜…â˜… // å•†å“åã¨ä¾¡æ ¼ã‚’è¡¨ç¤ºã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ public function printPrice(): void { print($this->name.\"ã®ä¾¡æ ¼: ï¿¥\".$this->price.\"\"); } // å•†å“åã®ã‚²ãƒƒã‚¿ãƒ¼ public function getName(): string { return $this->name; } // å•†å“ä¾¡æ ¼ã®ã‚²ãƒƒã‚¿ãƒ¼ public function getPrice(): int { return $this->price; } } getPrice() * 1.08); // ï¼ˆ1ï¼‰ print($this->getName().\"ã®ç¨è¾¼ã¿ä¾¡æ ¼: ï¿¥\".$priceWithTax.\"\"); // ï¼ˆ2ï¼‰ } } ãƒ»æŠ½è±¡ã‚¯ãƒ©ã‚¹ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨ã—ã¦ç”¨ã„ã‚‹ã€‚å¤šé‡ç¶™æ‰¿ã§ããªã„ã€‚ ï¼Šä¾‹ï¼Š ä»¥ä¸‹ã®æ¡ä»¶ã®ç¤¾å“¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®Ÿè£…ã—ãŸã„ã¨ã™ã‚‹ã€‚ åˆå‰ï¼™æ™‚ã«å‡ºç¤¾ å–¶æ¥­éƒ¨ãƒ»é–‹ç™ºéƒ¨ãƒ»ç·å‹™éƒ¨ãŒã‚ã‚Šã€ãã‚Œãã‚ŒãŒç•°ãªã‚‹ä»•äº‹ã‚’è¡Œã† åˆå¾Œï¼–æ™‚ã«é€€ç¤¾ ã“ã®æ™‚ã€ã€åƒããƒ¡ã‚½ãƒƒãƒ‰ã€ã¯éƒ¨ç½²ã”ã¨ã«ç•°ãªã£ã¦ã—ã¾ã†ãŒã€ã©ã†å®Ÿè£…ã—ãŸã‚‰è‰¯ã„ã®ã‹â€¦ ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€ä¾‹ãˆã°ã€æ¬¡ã®ï¼’ã¤ãŒå®Ÿè£…æ–¹æ³•ãŒè€ƒãˆã‚‰ã‚Œã‚‹ã€‚ å–¶æ¥­éƒ¨ç¤¾å“¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€é–‹ç™ºéƒ¨ç¤¾å“¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ç·å‹™éƒ¨ç¤¾å“¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ¥ã€…ã«å®Ÿè£… â‡’ãƒ¡ãƒªãƒƒãƒˆï¼šåŒã˜éƒ¨ç½²ã®ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å½±éŸ¿ã‚’ä¸ãˆã‚‰ã‚Œã‚‹ã€‚ â‡’ãƒ‡ãƒ¡ãƒªãƒƒãƒˆï¼šå„ç¤¾å“¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§å…±é€šã®å‡¦ç†ã‚’å€‹åˆ¥ã«å®Ÿè£…ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚å…±é€šã®å‡¦ç†ãŒåŒã˜ã‚³ãƒ¼ãƒ‰ã§æ›¸ã‹ã‚Œã‚‹ä¿è¨¼ãŒãªã„ã€‚ ä¸€ã¤ã®ç¤¾å“¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­ã§ã€åƒããƒ¡ã‚½ãƒƒãƒ‰ã«éƒ¨ç½²ã”ã¨ã§å¤‰åŒ–ã™ã‚‹å¼•æ•°ã‚’è¨­å®š â‡’ãƒ¡ãƒªãƒƒãƒˆï¼šå…¨éƒ¨ç½²ã®ç¤¾å“¡ã‚’ä¸€ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§å‘¼ã³å‡ºã›ã‚‹ã€‚ â‡’ãƒ‡ãƒ¡ãƒªãƒƒãƒˆï¼šä¸€ã¤ã®ä¿®æ­£ãŒã€å…¨éƒ¨ç½²ã®ç¤¾å“¡ã®å‡¦ç†ã«å½±éŸ¿ã‚’ä¸ãˆã¦ã—ã¾ã†ã€‚ æŠ½è±¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨æŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã¨ã€2ã¤ã®ãƒ¡ãƒªãƒƒãƒˆã‚’ç”Ÿã‹ã—ã¤ã¤ã€ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’è§£æ¶ˆå¯èƒ½ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š self::TIME_TO_ARRIVE){ return sprintf( \"%s ã®é…åˆ»ã§ã™ã€‚\", date(\"Hæ™‚iåˆ†sç§’\", $nowTime - self::TIME_TO_ARRIVE) ); } return sprintf( \"%s ã«å‡ºå‹¤ã—ã¾ã—ãŸã€‚\", date(\"Hæ™‚iåˆ†sç§’\", $nowTime) ); } // å…·è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã€‚é€€ç¤¾æ™‚é–“ã¨æ®‹æ¥­æ™‚é–“ã‚’è¡¨ç¤ºã€‚ // å­ã‚¯ãƒ©ã‚¹ã¸ãã®ã¾ã¾ç¶™æ‰¿ã•ã‚Œã‚‹ã€‚å­ã‚¯ãƒ©ã‚¹ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ãªãã¦ã‚‚è‰¯ã„ã€‚ public function toLeave() { $nowTime = strtotime( date(\"H:i:s\") ); return sprintf( \"%sã«é€€ç¤¾ã—ã¾ã—ãŸã€‚%s ã®æ®‹æ¥­ã§ã™ã€‚\", date(\"Hæ™‚iåˆ†sç§’\", $nowTime), date(\"Hæ™‚iåˆ†sç§’\", $nowTime - self::TIME_TO_LEAVE) ); } } ï¼Šä¾‹ï¼Š ãƒ—ãƒªã‚¦ã‚¹ã¨å„ä¸–ä»£ãƒ—ãƒªã‚¦ã‚¹ãŒã€æŠ½è±¡ã‚¯ãƒ©ã‚¹ã¨å­ã‚¯ãƒ©ã‚¹ã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ Realizationï¼ˆå®Ÿç¾ï¼‰ ãƒ»Realizationã¨ã¯ å®Ÿè£…ã‚¯ãƒ©ã‚¹ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã™ã‚‹ãŸã‚ã«æœ€ä½é™å¿…è¦ãªãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ã‚’å¼·åˆ¶ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€å¿…ãšå®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’æ­£å¸¸ã«åƒã‹ã›ã‚‰ã‚Œã‚‹ã€‚ ï¼Šä¾‹ï¼Š ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ãƒ¦ãƒ¼ã‚¶ãŒå®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’è‡ªèº«ã§è¿½åŠ å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚è€ƒæ…®ã—ã¦ã€RealizationãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ ï¼Šä¾‹ï¼Š å„è»Šã¯ã€ãƒ¢ãƒ¼ã‚¿ãƒ¼æ©Ÿèƒ½ã‚’å¿…ãšæŒã£ã¦ã„ãªã‘ã‚Œã°ã€æ­£å¸¸ã«åƒãã“ã¨ãŒã§ããªã„ã€‚ãã“ã§ã€ãƒ¢ãƒ¼ã‚¿æ©Ÿèƒ½ã«æœ€ä½é™å¿…è¦ãªãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ã‚’å¼·åˆ¶ã™ã‚‹ã€‚ å®Ÿè£…ã‚¯ãƒ©ã‚¹ã«å‡¦ç†å†…å®¹ã‚’è¨˜è¿°ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã™ãªã‚ã¡ã€æŠ½è±¡ã‚¯ãƒ©ã‚¹ã«ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹ã®ã¿å®šç¾©ã—ãŸå ´åˆã¨åŒã˜ã§ã‚ã‚‹ã€‚å¤šé‡ç¶™æ‰¿ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š é€šå¸¸ã‚¯ãƒ©ã‚¹ã€æŠ½è±¡ã‚¯ãƒ©ã‚¹ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®é•ã„ é€šå¸¸ã‚¯ãƒ©ã‚¹ æŠ½è±¡ã‚¯ãƒ©ã‚¹ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ å½¹å‰² å°‚ç”¨å‡¦ç†ã®éƒ¨å“åŒ– é€šå¸¸ã‚¯ãƒ©ã‚¹ã®å…±é€šå‡¦ç†ã®éƒ¨å“åŒ– ãƒ»é€šå¸¸ã‚¯ãƒ©ã‚¹ã®ã‚¯ãƒ©ã‚¹å‹ã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ»å®Ÿè£…ã‚¯ãƒ©ã‚¹ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã™ã‚‹ãŸã‚ã«æœ€ä½é™å¿…è¦ãªãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ã‚’å¼·åˆ¶ã™ã‚‹ã€‚ å­ã‚¯ãƒ©ã‚¹ã§ã®ç¶™æ‰¿å…ˆæ•° å˜ä¸€ç¶™æ‰¿ å˜ä¸€ç¶™æ‰¿ å˜ä¸€ç¶™æ‰¿ï½œå¤šé‡ç¶™æ‰¿ ãƒ¡ãƒ³ãƒå¤‰æ•°ã®ã‚³ãƒ¼ãƒ« è‡ªèº«ã¨ç¶™æ‰¿å…ˆ ç¶™æ‰¿å…ˆã®ã¿ å®Ÿè£…å…ˆã®ã¿ å®šæ•°ã®å®šç¾© ã€‡ ã€‡ ã€‡ æŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã®å®šç¾© âœ• ã€‡ ã€‡ï¼ˆabstractã¯çœç•¥ï¼‰ å…·è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã®å®šç¾© ã€‡ ã€‡ âœ• construct() ã®å®šç¾© ã€‡ ã€‡ âœ• ï¼Šä¾‹ï¼Š ç¨®ã€…ã®è»Šã‚¯ãƒ©ã‚¹ã®å…±é€šå‡¦ç†ã®ã‚’æŒã¤æŠ½è±¡ã‚¯ãƒ©ã‚¹ã¨ã—ã¦ã€Carã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã€‚ å„è»Šã¯ã€ã‚¨ãƒ³ã‚¸ãƒ³æ©Ÿèƒ½ã‚’å¿…ãšæŒã£ã¦ã„ãªã‘ã‚Œã°ã€æ­£å¸¸ã«åƒãã“ã¨ãŒã§ããªã„ã€‚ãã“ã§ã€æŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ã€ã‚¨ãƒ³ã‚¸ãƒ³æ©Ÿèƒ½ã«æœ€ä½é™å¿…è¦ãªãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ã‚’å¼·åˆ¶ã™ã‚‹ã€‚ 02-02. ç¶™æ‰¿ ç¶™æ‰¿ã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¹ãƒã‚§ãƒ¼ãƒ³ ãƒ»ã‚¯ãƒ©ã‚¹ãƒã‚§ãƒ¼ãƒ³ã¨ã¯ ã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ãŸæ™‚ã€ãã®ã‚¯ãƒ©ã‚¹ã«ã“ã‚Œã‚‰ãŒå­˜åœ¨ã—ãªã‘ã‚Œã°ã€ç¶™æ‰¿å…ƒã¾ã§å‚ç…§ã—ã«ã„ãä»•çµ„ã¿ã‚’ã€ã‚¯ãƒ©ã‚¹ãƒã‚§ãƒ¼ãƒ³ã€ã¨ã„ã†ã€‚é¡ä¼¼ã™ã‚‹ã‚‚ã®ã¨ã—ã¦ã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ã¯ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_prototype_based.html https://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_prototype_based_method_data.html ï¼Šå®Ÿè£…ä¾‹ï¼Š value1; } } subValue; } } getValue(); ç¶™æ‰¿å…ƒã®é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‚ç…§ ï¼Šå®Ÿè£…ä¾‹ï¼Š Trait ãƒ»Traitã¨ã¯ å†åˆ©ç”¨ã—ãŸã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ãƒ‡ãƒ¼ã‚¿ã‚’éƒ¨å“åŒ–ã—ã€åˆ©ç”¨ã—ãŸã„æ™‚ã«ã‚¯ãƒ©ã‚¹ã«å–ã‚Šè¾¼ã‚€ã€‚Traitã‚’ç”¨ã„ã‚‹ã¨ãã¯ã€ã‚¯ãƒ©ã‚¹å†…ã§Traitã‚’useå®£è¨€ã™ã‚‹ã€‚Traitè‡ªä½“ã¯ä¸å®Œå…¨ãªã‚¯ãƒ©ã‚¹ã§ã‚ã‚Šã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ããªã„ã€‚ã¾ãŸã€è¦ªã‚¯ãƒ©ã‚¹ã§ãƒˆãƒ¬ã‚¤ãƒˆã‚’èª­ã¿è¾¼ã‚€ã¨ã€å­ã‚¯ãƒ©ã‚¹ã§ã‚‚ãƒˆãƒ¬ã‚¤ãƒˆã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š foo(); // Hello World class Bar extends Foo {} $bar = new Bar(); $bar->foo(); // Hello World ãƒ»ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç¦æ­¢ã™ã‚‹Trait ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã¨ã€å‡¦ç†ãŒå¤šããªã‚‹ãŸã‚ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªããªã‚‹ã€‚ãã“ã§ã€å„ã‚¯ãƒ©ã‚¹ã§traitã‚’ä½¿ç”¨ã—ã€ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ãŸæ™‚ã«ã€é–‹ç™ºè€…å‘ã‘ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã•ã›ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒã‚¸ãƒƒã‚¯ã‚²ãƒƒã‚¿ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒã‚¸ãƒƒã‚¯ã‚»ãƒƒã‚¿ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã“ã¨ã‚’ç¦æ­¢ã™ã‚‹ã€‚ 02-03. å§”è­² å§”è­²ã«ã‚ˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ« ãƒ»å§”è­²ã¨ã¯ å‡¦ç†ã®ä¸€éƒ¨ã¾ãŸã¯å…¨ã¦ã‚’ä»–ã®ã‚¯ãƒ©ã‚¹ã«è¨—ã™ã“ã¨ã€‚PHPã§ã¯ã€é›†ç´„ã‚„åˆæˆã®é–¢ä¿‚æ€§ã‚’ä½œã‚Šã€å§”è­²å…ˆã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯å§”è­²å…ƒã®ã‚³ãƒ¼ãƒ«ã—ã¦ã€å‡¦ç†ã‚’è¿½åŠ å®Ÿè£…ã™ã‚‹ã“ã¨ã«ç›¸å½“ã™ã‚‹ã€‚ä»–ã«ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã‚ˆã‚‹Realizationã®é–¢ä¿‚æ€§ã§ã‚‚å®Ÿç¾ã§ãã‚‹ã€‚ ãƒ»ç¶™æ‰¿ã‚ˆã‚Šã‚‚å„ªã‚ŒãŸç‚¹ å‚è€ƒï¼šhttps://qiita.com/sonatard/items/2b4b70694fd680f6297c#3-%E3%81%9D%E3%82%82%E3%81%9D%E3%82%82%E4%BD%95%E6%95%85go%E3%81%AF%E7%B6%99%E6%89%BF%E3%82%92%E5%BB%83%E6%AD%A2%E3%81%97%E3%81%A6%E5%A7%94%E8%AD%B2%E3%82%92%E6%8E%A8%E5%A5%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%81%AE%E3%81%8B 02-04. å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ require_onceãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹ã€ã‚¯ãƒ©ã‚¹ã€éã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®èª­ã¿è¾¼ã¿ ãƒ»require_onceãƒ¡ã‚½ãƒƒãƒ‰ã¨ã¯ å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å®šç¾©ã•ã‚ŒãŸã€ã‚¯ãƒ©ã‚¹ã€éã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚’ä¸€åº¦ã ã‘èª­ã¿è¾¼ã‚ã‚‹ã€‚å‹•çš„ãªå€¤ã¯æŒãŸãšã€é™çš„ã«èª­ã¿è¾¼ã‚€ã“ã¨ã«æ³¨æ„ã€‚ãŸã ã—ã€ãƒãƒ¼ãƒ ã®å„ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒå¥½ããªç‰©ã‚’èª­ã¿è¾¼ã‚“ã§ã„ãŸã‚‰ã€ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã‹ã­ãªã„ã€‚ãã“ã§ã€ãƒãƒ¼ãƒ ã§ã®é–‹ç™ºã§ã¯ã€è¨˜è¿°ãƒ«ãƒ¼ãƒ«ã‚’è¨­ã‘ã¦ã€require_onceãƒ¡ã‚½ãƒƒãƒ‰ã§èª­ã¿è¾¼ã‚“ã§è‰¯ã„ã‚‚ã®ã‚’æ±ºã‚ã¦ãŠãã¨è‰¯ã„ã€‚ ãƒ»ã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ« className(); } } ãƒ»ã‚¯ãƒ©ã‚¹ã‹ã‚‰å®šæ•°ã‚’ã‚³ãƒ¼ãƒ« ãƒ»éã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ« useã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¹ã®èª­ã¿è¾¼ã¿ ãƒ»useã¨ã¯ composerã®ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–ã—ãŸä¸Šã§ã€å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒ©ã‚¹ã®namespaceã‚’useã§æŒ‡å®šã™ã‚‹ã ã‘ã§ã€ãã®ã‚¯ãƒ©ã‚¹ã®ã¿ã‚’èª­ã¿è¾¼ã‚ã‚‹ã€‚éã‚¯ãƒ©ã‚¹ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã¯ã§ããªã„ã€‚å‹•çš„ãªå€¤ã¯æŒãŸãšã€é™çš„ã«èª­ã¿è¾¼ã‚€ã“ã¨ã«æ³¨æ„ã€‚ãŸã ã—ã€ãƒãƒ¼ãƒ ã®å„ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒå¥½ããªç‰©ã‚’èª­ã¿è¾¼ã‚“ã§ã„ãŸã‚‰ã€ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã‹ã­ãªã„ã€‚ãã“ã§ã€ãƒãƒ¼ãƒ ã§ã®é–‹ç™ºã§ã¯ã€è¨˜è¿°ãƒ«ãƒ¼ãƒ«ã‚’è¨­ã‘ã¦ã€useã§èª­ã¿è¾¼ã‚“ã§è‰¯ã„ã‚‚ã®ã‚’æ±ºã‚ã¦ãŠãã¨è‰¯ã„ã€‚ãªãŠã€composerã®ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€requireé–¢æ•°ã¨useã®ä¸¡æ–¹ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://atmarkit.itmedia.co.jp/ait/articles/1808/01/news009_3.html ãƒ»å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ« ã‚¯ãƒ©ã‚¹ã®namespaceã‚’useæ–‡ã§æŒ‡å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š method1(); } } ãƒ»å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰å®šæ•°ã‚’ã‚³ãƒ¼ãƒ« ï¼Šå®Ÿè£…ä¾‹ï¼Š 03. useï¼ˆå¼•æ•°å‹ï¼è¿”å´å€¤å‹ã¨ã—ã¦ç”¨ã„ã‚‹é–¢ä¿‚æ€§ï¼‰ useãªé–¢ä¿‚ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_object_oriented_analysis_and_design.html ç™ºè¡¨ã‚¹ãƒ©ã‚¤ãƒ‰ Dependencyï¼ˆä¾å­˜ï¼‰ ãƒ»Dependencyã¨ã¯ ã‚¯ãƒ©ã‚¹ï¼¡ãŒã‚¯ãƒ©ã‚¹ï¼¢ã‚’å¼•æ•°å‹ï¼è¿”å´å€¤å‹ã¨ã—ã¦ç”¨ã„ã‚‹é–¢ä¿‚æ€§ã®ã“ã¨ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/1230889/difference-between-association-and-dependency https://stackoverflow.com/questions/41765798/difference-between-aggregation-and-dependency-injection ãƒ»ä¾‹ ï¼Šå®Ÿè£…ä¾‹ï¼Š Userã¯UserNameã‚’å¼•æ•°ã¨ã—ã¦ç”¨ã„ã‚‹ã€‚Userã¯UserNameã«ä¾å­˜ã—ã¦ã„ã‚‹ã€‚ getName(); } } çµåˆåº¦ ãƒ»çµåˆåº¦ã¨ã¯ ä¾å­˜ã«ã¯ã€å¼•æ•°ã®æ¸¡ã—æ–¹ã«ã‚ˆã£ã¦ã€ç¨‹åº¦ãŒã‚ã‚‹ã€‚ãã‚Œã«ã‚ˆã£ã¦ã€å‡¦ç†ã‚’ã€ã©ã®ã‚¯ãƒ©ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã¨æ“ä½œã«æŒ¯ã‚Šåˆ†ã‘ã¦ã„ãã‹ãŒæ±ºã¾ã‚‹ã€‚çµåˆåº¦ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®ä¾å­˜åº¦åˆã„ã«ã¤ã„ã¦ç”¨ã„ã‚‰ã‚Œã‚‹ç”¨èªã§ã‚ã‚‹ãŒã€ã‚ˆã‚Šç†è§£ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã«ã€ç‰¹ã«ã‚¯ãƒ©ã‚¹ã‚’ç”¨ã„ã¦èª¬æ˜ã™ã‚‹ã€‚ ãƒ»ãƒ‡ãƒ¼ã‚¿çµåˆã¨ã¯ æœ€ã‚‚ç†æƒ³çš„ãªçµåˆã€‚ã‚¹ã‚«ãƒ©å‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã¨ã—ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã‚ˆã†ãªé–¢ä¿‚ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ModuleAã¨ModuleBã¯ã€ãƒ‡ãƒ¼ã‚¿çµåˆã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ methodA(1, 2, \"ã§ã™.\"); // ã‚¹ã‚«ãƒ©å‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã ã‘ } } ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®Factoryã‚¯ãƒ©ã‚¹ã§ã¯ã€ã‚¹ã‚«ãƒ©å‹ãƒ‡ãƒ¼ã‚¿ã®å€¤ã«å¿œã˜ã¦ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚Šåˆ†ã‘ã‚‹ã€‚Factoryã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã€ã“ã‚Œã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ä»–ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ã¯ã€ãƒ‡ãƒ¼ã‚¿çµåˆã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ needsWalking()) { return $walking; } return $car; } } ãƒ»ã‚¹ã‚¿ãƒ³ãƒ—çµåˆã¨ã¯ objectå‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã¨ã—ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å¼•æ•°ã¨ã—ã¦æ¸¡ã™é–¢ä¿‚ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ModuleAã¨ModuleBã¯ã€ã‚¹ã‚¿ãƒ³ãƒ—çµåˆã®é–¢ä¿‚ã«ã‚ã‚‹ã€‚ value = $value; } public function getValue() { return $this->value; } } methodB($common); // 1 } } getValue(); // 1 } } å‡é›†åº¦ ãƒ»å‡é›†åº¦ã¨ã¯ å‡é›†åº¦ã¯ã€ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã®è²¬å‹™ã®çµ±ä¸€åº¦åˆã„ã€ã«ã¤ã„ã¦ç”¨ã„ã‚‰ã‚Œã‚‹ç”¨èªã§ã‚ã‚‹ãŒã€ã‚ˆã‚Šç†è§£ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã«ã€ç‰¹ã«ã‚¯ãƒ©ã‚¹ã‚’ç”¨ã„ã¦èª¬æ˜ã™ã‚‹ã€‚ ãƒ»æ©Ÿèƒ½çš„å¼·åº¦ æœ€ã‚‚ç†æƒ³çš„ãªå‡é›†ã€‚ã‚¯ãƒ©ã‚¹ã®è²¬å‹™ãŒæ©Ÿèƒ½å˜ä½ã«ãªã‚‹ã‚ˆã†ã«ã€ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒ¯ã‚Šåˆ†ã‘ã‚‹ã€‚ ãƒ»LCOMï¼šLack Of Conhension of Methods å‡é›†åº¦ã®ç¨‹åº¦ã‚’è¡¨ã™æŒ‡æ¨™ã®ã“ã¨ã€‚LCOMã®è¨ˆæ¸¬æ–¹æ³•ã«ã¯ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚‹ã€‚LCOM4ã¯ã€ã‚¯ãƒ©ã‚¹ã®å„ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ã€ä¿æŒã™ã‚‹å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ã»ã©ã€å‡é›†åº¦ãŒé«˜ã„ã¨è¦‹ãªã™æ–¹æ³•ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://www.amazon.co.jp/dp/B082WXZVPC https://qiita.com/fujiharuka/items/65125592bd31e2a1c16d ä½çµåˆã¨é«˜å‡é›† å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã€çµåˆåº¦ãŒä½ãã€å‡é›†åº¦ãŒé«˜ã„ã»ã©ã‚ˆã„ã€‚ä¾‹ã¨ã—ã¦ã€ä»¥ä¸‹ã®ç”»åƒã§ã¯ã€é“å…·ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã€ã‚­ãƒƒãƒãƒ³å¼•ãå‡ºã—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã‚¬ãƒ¬ãƒ¼ã‚¸å·¥å…·ç®±ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†ã‘ã€å„ã‚¯ãƒ©ã‚¹ã®çµåˆåº¦ã‚’ä½ãã€å‡é›†åº¦ã‚’é«˜ãã™ã‚‹ã‚ˆã†ã«å¯¾å¿œã—ã¦ã„ã‚‹ãƒ» DIï¼šDependency Injectionï¼ˆä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ³¨å…¥ï¼‰ ãƒ»DIã¨ã¯ ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ï¼ˆä¾å­˜å¯¾è±¡ï¼‰ã®ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã€ã‚’ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å¤–éƒ¨ã‹ã‚‰ã€å¼•æ•°ã¨ã—ã¦ã€æ³¨å…¥ã™ã‚‹å®Ÿè£…æ–¹æ³•ã€‚ã€ä¾å­˜æ€§æ³¨å…¥ã€ã¨è¨³ã™ã®ã¯æ··ä¹±ã‚’æ‹›ããŸã‚ã€ã€ä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ³¨å…¥ã€ã¨è¨³ã™ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼š https://en.wikipedia.org/wiki/Dependency_injection#Types_of_dependency_injection https://little-hands.hatenablog.com/entry/2018/05/27/dependency-injection ãƒ»Constructor Injectionã¨ã¯ ãƒ¡ã‚½ãƒƒãƒ‰ã®ç‰¹ã«ã€constructãƒ¡ã‚½ãƒƒãƒ‰ ã®å¼•æ•°ã¨ã—ã¦ã€ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ³¨å…¥ã™ã‚‹æ–¹æ³•ã€‚ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã•ã›ã€Aggregationã®é–¢ä¿‚æ€§ã‚’ä½œã‚‰ã‚Œã‚‹ã€‚Constructor Injectionã®ã¿ãŒã€constructãƒ¡ã‚½ãƒƒãƒ‰ ã«ã‚ˆã£ã¦ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆã®ãŸã‚ã«ä¾å­˜é–¢ä¿‚ã®è¦ä»¶ã‚’å¼·åˆ¶ã§ãã‚‹ã€‚ã¾ãŸã€ã‚»ãƒƒã‚¿ãƒ¼ã‚’å®Œå…¨ã«ãªãã—ãŸå ´åˆã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆå¾Œã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®çŠ¶æ…‹ã‚’å¤‰æ›´ä¸å¯èƒ½ã«ãªã‚‹ã€‚ãã®ãŸã‚ã€ãƒ“ã‚¸ãƒã‚¹ä¸Šã‚ã‚Šãˆãªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã§ããªããªã‚Šã€ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸­ã§ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®‰å…¨æ€§ã®ãŸã‚ã«æœ€ã‚‚å„ªã‚Œã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾å­˜å¯¾è±¡ã®Supplierã‚¯ãƒ©ã‚¹ã‚’ã€constructãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã¨ã—ã¦ã€Clientã‚¯ãƒ©ã‚¹ã«æ³¨å…¥ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾å­˜å¯¾è±¡ã®UserNameã‚¯ãƒ©ã‚¹ã‚’ã€constructãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã¨ã—ã¦ã€Userã‚¯ãƒ©ã‚¹ã«æ³¨å…¥ã™ã‚‹ã€‚ name = $name; } } ãƒ»Setter Injectionã¨ã¯ ãƒ¡ã‚½ãƒƒãƒ‰ã®ç‰¹ã«ã€ã‚»ãƒƒã‚¿ãƒ¼ã®å¼•æ•°ã¨ã—ã¦ã€ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ³¨å…¥ã™ã‚‹æ–¹æ³•ã€‚ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã•ã›ã€Aggregationã®é–¢ä¿‚æ€§ã‚’ä½œã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾å­˜å¯¾è±¡ã®Supplierã‚¯ãƒ©ã‚¹ã‚’ã€ã‚»ãƒƒã‚¿ãƒ¼ã®å¼•æ•°ã¨ã—ã¦ã€Clientã‚¯ãƒ©ã‚¹ã«æ³¨å…¥ã™ã‚‹ã€‚ setSupplier($supplier) ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾å­˜å¯¾è±¡ã®UserNameã‚¯ãƒ©ã‚¹ã‚’ã€ã‚»ãƒƒã‚¿ãƒ¼ã®å¼•æ•°ã¨ã—ã¦ã€Userã‚¯ãƒ©ã‚¹ã«æ³¨å…¥ã™ã‚‹ã€‚ name = $name; } } setUserName($name); // ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»Method Injectionã¨ã¯ ä¸Šè¨˜äºŒã¤ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã¨ã—ã¦ã€ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ³¨å…¥ã™ã‚‹æ–¹æ³•ã€‚ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã›ãšã€èª­ã¿è¾¼ã‚“ã§ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾å­˜å¯¾è±¡ã®UserNameã‚¯ãƒ©ã‚¹ã‚’ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã¨ã—ã¦ã€Userã‚¯ãƒ©ã‚¹ã«æ³¨å…¥ã™ã‚‹ã€‚ getName(); // ä½•ã‚‰ã‹ã®å‡¦ç† } } method($name); // ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ DI Containerï¼ˆä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ³¨å…¥ã‚³ãƒ³ãƒ†ãƒŠï¼‰ã€Service Container ãƒ»DI Containerï¼ˆä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ³¨å…¥ã‚³ãƒ³ãƒ†ãƒŠï¼‰ã€Service Containerã¨ã¯ ä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ³¨å…¥ã®è²¬å‹™ã«ç‰¹åŒ–ã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã€Service Containerã€ã¨ã„ã†ã€‚ã‚ã‚‰ã‹ã˜ã‚ã‚¯ãƒ©ã‚¹ã‚’ç™»éŒ²ï¼ˆãƒã‚¤ãƒ³ãƒ‰ï¼‰ã—ã¦ãŠãã€å¿…è¦ãªæ™‚ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆï¼ˆãƒªã‚¾ãƒ«ãƒ–ï¼‰ã—ã¦ãã‚Œã‚‹ã€‚ãªãŠã€ ï¼Šå®Ÿè£…ä¾‹ï¼Š Pimpleãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç”¨ã„ãŸå ´åˆ ãƒ»ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã®Service Locater Pattern ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®ã‚³ãƒ³ãƒ†ãƒŠæ¸¡ã—ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè£…ã›ãšã€ã‚³ãƒ³ãƒ†ãƒŠè‡ªä½“ã‚’æ³¨å…¥ã—ã¦ã„ã¾ã†èª¤ã£ãŸå®Ÿè£…æ–¹æ³•ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š logger = $container[\"foo.logger\"]; $this->notification = $container[\"bar.notification\"]; } } 03-02. Dependency Inversion Principleï¼ˆä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼‰ DIP ãƒ»DIPã¨ã¯ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹æ–¹æ³•ã€‚ã€é€†è»¢ã€ã¨ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ç”¨ã„ãŸå ´åˆã€ã‚ˆã‚Šä¸‹ä½å±¤ã®å®Ÿè£…ã‚¯ãƒ©ã‚¹ãŒä¸Šä½å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã«ä¾å­˜ã—ã¦ã„ã‚‹ã“ã¨ã‚’æŒ‡ã—ã¦è¨€ã†ã€‚äºŒã¤ã®åŸå‰‡ã‹ã‚‰ãªã‚‹ã€‚ ãƒ»åŸå‰‡1 ä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ä¸‹ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ä¾å­˜ã—ã¦ã¯ãªã‚‰ãªã„ã€‚ã©ã¡ã‚‰ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚‚ã€æŠ½è±¡ã€ã«ä¾å­˜ã™ã¹ãã§ã‚ã‚‹ã€‚ ãƒ»åŸå‰‡2 ã€æŠ½è±¡ã€ã¯ã€å®Ÿè£…ã€ã«ä¾å­˜ã—ã¦ã¯ãªã‚‰ãªã„ã€‚ã€å®Ÿè£…ã€ãŒã€æŠ½è±¡ã€ã«ä¾å­˜ã™ã¹ãã§ã‚ã‚‹ã€‚ DIPã‚’æº€ãŸã™å®Ÿè£… ãƒ»DIPã‚’æº€ãŸã•ãªã„å®Ÿè£…ã®å ´åˆï¼ˆå¾“æ¥ï¼‰ ã‚ˆã‚Šä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚³ãƒ¼ãƒ«å‡¦ç†ã‚’é…ç½®ã—ã€ã‚ˆã‚Šä¸‹ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹å´ã®å®šç¾©ã‚’è¡Œã†ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€ä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¯ãƒ©ã‚¹ãŒã€ä¸‹ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¯ãƒ©ã‚¹ã«ä¾å­˜ã™ã‚‹é–¢ä¿‚æ€§ã«ãªã‚‹ã€‚ ãƒ»DIPã‚’æº€ãŸã™å®Ÿè£…ã®å ´åˆ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆã¾ãŸã¯æŠ½è±¡ã‚¯ãƒ©ã‚¹ï¼‰ã§æŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å®Ÿè£…ã‚¯ãƒ©ã‚¹ã§ã®å®Ÿè£…ãŒå¼·åˆ¶ã•ã‚Œã‚‹ã€‚ã¤ã¾ã‚Šã€å®Ÿè£…ã‚¯ãƒ©ã‚¹ã¯æŠ½è±¡ã‚¯ãƒ©ã‚¹ã«ä¾å­˜ã—ã¦ã„ã‚‹ã€‚ã‚ˆã‚Šä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’é…ç½®ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ä¸‹ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¯ãƒ©ã‚¹ãŒä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¯ãƒ©ã‚¹ã«ä¾å­˜ã—ã¦ã„ã‚‹ã‚ˆã†ãªé€†è»¢é–¢ä¿‚ã‚’ä½œã‚‰ã‚Œã‚‹ï¼ˆåŸå‰‡ï¼’ï¼‰ã€‚åŸå‰‡ï¼’ã§ã„ã†ä¾å­˜ã¯ã€å¼•æ•°å‹ï¼è¿”å´å€¤å‹ã¨ã—ã¦ç”¨ã„ã‚‹é–¢ä¿‚æ€§ã®æ–‡è„ˆã§ã„ã†ã€ä¾å­˜ã€ã§ã¯ãªã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ã¾ãŸã€å®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã¨ã—ã¦ã‚³ãƒ¼ãƒ«ã§ããã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨ã€å®Ÿè£…ã‚¯ãƒ©ã‚¹ã«ä¾å­˜ã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ä»£ã‚ã‚Šã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã‚ˆã£ã¦ã€å…¨ã¦ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ï¼ˆåŸå‰‡ï¼‘ï¼‰ã€‚ å‚è€ƒï¼šhttps://speakerdeck.com/hiroki_hasegawa/domeinqu-dong-she-ji-falseakitekutiyabian-qian-toyi-cun-xing-ni-zhuan-falseyuan-ze ãƒ»DIPã«åŸºã¥ããƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®å ´åˆ Repositoryã‚¯ãƒ©ã‚¹ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨å®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’ç”¨æ„ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åŸå‰‡ï¼’ã‚’æº€ãŸã™ã€‚ Repositoryã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆæŠ½è±¡ã‚¯ãƒ©ã‚¹ï¼‰ã‚’ã€ã‚ˆã‚Šä¸Šä½ã®ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«é…ç½®ã™ã‚‹ã€‚ã¾ãŸã€Repositoryã®å®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’ã€ã‚ˆã‚Šä¸‹ä½ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã«é…ç½®ã™ã‚‹ã€‚ ä¸¡æ–¹ã®ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦ã€ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆç´ä»˜ã‘ï¼‰ã‚’è¡Œã„ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆæŠ½è±¡ã‚¯ãƒ©ã‚¹ï¼‰ã‚’ã‚³ãƒ¼ãƒ«ã—ãŸæ™‚ã«ã€å®Ÿéš›ã«ã¯å®Ÿè£…ã‚¯ãƒ©ã‚¹ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼’ã¨ï¼“ã«ã‚ˆã‚Šã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ã¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã®ä¸¡æ–¹ãŒã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆæŠ½è±¡ã‚¯ãƒ©ã‚¹ï¼‰ã«ä¾å­˜ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã“ã‚Œã¯ã€åŸå‰‡ï¼‘ã‚’æº€ãŸã™ã€‚ DIPã®ãƒ¡ãƒªãƒƒãƒˆ ãƒ»å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã®å·®ã—æ›¿ãˆãŒç°¡å˜ å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã—ã€ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ãŒå¼·åˆ¶ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã“ã§å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã‚’ç•°ãªã‚‹ã‚‚ã®ã«å·®ã—æ›¿ãˆãŸã¨ã—ã¦ã‚‚ã€ã‚‚ã†ä¸€æ–¹ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ¼ãƒ«æ–¹æ³•ã‚’å¤‰ãˆã‚‹å¿…è¦ãŒãªã„ã€‚ã¤ã¾ã‚Šã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ãªãã€å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚„æ–°ã—ã„å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã¸ã®ç§»è¡ŒãŒè¡Œãˆã‚‹ã€‚ ãƒ»ãƒªãƒã‚¸ãƒˆãƒªãŒå¯¾è±¡ã¨ã™ã‚‹é›†ç´„ã®å˜ä½ãŒã‚ã‹ã‚Šã‚„ã™ã„ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã‚’é…ç½®ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã¯ã€å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã‚ˆã‚Šã‚‚å®šç¾©ãŒç°¡æ½”ã§ã‚ã‚‹ã€‚ãã®ãŸã‚ã€å®Ÿè£…ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ãªãã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ã€ãã®ãƒªãƒã‚¸ãƒˆãƒªãŒã©ã®é›†ç´„ã«å¯¾ã—ã¦CRUDå‡¦ç†ã‚’è¡Œã†ã®ã‹ã‚’èªè­˜ã—ã‚„ã™ã„ã€‚ "},"public/software/software_application_object_oriented_language_php_class_based_method_data.html":{"url":"public/software/software_application_object_oriented_language_php_class_based_method_data.html","title":"ğŸ“– ï¸ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿","keywords":"","body":"ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰ æœ¬è³‡æ–™ã®ä»¥é™ã§ã¯ã€å¤§ããã€æ“ä½œï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã¨ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰ã«åˆ†ã‘ã¦ã€èª¬æ˜ã—ã¦ã„ãã€‚ ãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã¯ ã‚¯ãƒ©ã‚¹ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’æ“ä½œã™ã‚‹ã€‚ã“ã®æ“ä½œã™ã‚‹ãŸã‚ã®å‡¦ç†ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã„ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š data; } } ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰ ãƒ» ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰ã¨ã¯ ã‚¯ãƒ©ã‚¹ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’æŒã¤ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã¯ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ã€‚æœ¬ãƒãƒ¼ãƒˆã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚‹ã“ã¨ã‚’æ„è­˜ã™ã‚‹ãŸã‚ã«ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã„ã†è¨€è‘‰ã‚’ä½¿ã‚ãªã„ã‚‚ã®ã¨ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š data; } } 02. ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ã®ã‚«ãƒ—ã‚»ãƒ«åŒ– public ãƒ»publicã¨ã¯ ã©ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚å‘¼ã³å‡ºã›ã‚‹ã€‚ ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š data = $data; } public function data() { return $this->data; } } ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ãªã„å ´åˆ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒpublicã§ã‚ã‚‹ãªã‚‰ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã«ãŠã‘ã‚‹éš è”½ã®ãƒ¡ãƒªãƒƒãƒˆã¯ã€ç‰¹ã«ãªã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š protected ãƒ»protectedã¨ã¯ åŒã˜ã‚¯ãƒ©ã‚¹å†…ã¨ã€ãã®å­ã‚¯ãƒ©ã‚¹ã€ãã®è¦ªã‚¯ãƒ©ã‚¹ã§ã®ã¿å‘¼ã³å‡ºã›ã‚‹ã€‚ https://qiita.com/miyapei/items/6c43e8b38317afb5fdce ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®å ´åˆ è¦ªã‚¯ãƒ©ã‚¹æ¬¡ç¬¬ã§ã¯ã‚ã‚‹ãŒã€å‡¦ç†ã«ãŠã„ã¦ã€$dataã®ä¸­èº«ã‚’éš è”½ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š data = $data; } public function foo() { // dataã¯è¦ªã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ return $this->data; } } ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ãªã„å ´åˆ å‡¦ç†ã«ãŠã„ã¦ã€$dataã®ä¸­èº«ã‚’éš è”½ã§ããªã„ãŸã‚ã€å±é™ºã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š private ãƒ»privateã¨ã¯ åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ã®ã¿å‘¼ã³å‡ºã›ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®ãƒ¡ãƒªãƒƒãƒˆã‚’æœ€å¤§é™ã«å¾—ã‚‰ã‚Œã‚‹æ©Ÿèƒ½ã§ã‚ã‚‹ã€‚ ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®å ´åˆ å‡¦ç†ã«ãŠã„ã¦ã€$dataã®ä¸­èº«ã‚’éš è”½ã§ãã‚‹ã€‚ã‚«ãƒ—ã‚»ãƒ«åŒ–ã‚’å‚ç…§ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š data = $data; } public function foo() { return $this->data.$this->Desu(); } // ã‚¯ãƒ©ã‚¹å†…ã‹ã‚‰ã—ã‹ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ private function Desu() { return \"ã§ã™ã€‚\"; } } ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ãªã„å ´åˆ å‡¦ç†ã«ãŠã„ã¦ã€$dataã®ä¸­èº«ã‚’éš è”½ã§ããªã„ãŸã‚ã€å±é™ºã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»Encapsulationï¼ˆã‚«ãƒ—ã‚»ãƒ«åŒ–ï¼‰ ã‚«ãƒ—ã‚»ãƒ«åŒ–ã¨ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®Ÿè£…æ–¹æ³•ã‚’å¤–éƒ¨ã‹ã‚‰éš ã™ã“ã¨ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ç›´æ¥ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†äº‹ã¯ã§ããšã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ã€ã‚¢ã‚¯ã‚»ã‚¹ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ static ãƒ»staticã¨ã¯ åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã—ã«ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã—ã‹ã—ã€staticä¿®é£¾å­ã‚’ã¤ã‘ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãªãã¨ã‚‚ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿å€¤ã¯ç”¨ã„ãšï¼ˆé™çš„ï¼‰ã€å¼•æ•°ã®å€¤ã®ã¿ã‚’ç”¨ã„ã¦å‡¦ç†ã‚’è¡Œã†ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooFee); } } ãƒ»self:: // ã“ã“ã«å®Ÿè£…ä¾‹ ãƒ»static:: // ã“ã“ã«å®Ÿè£…ä¾‹ 02-02. ãƒ¡ã‚½ãƒƒãƒ‰ ã¾ãšèª­ã‚€ã¹ãè¨˜äº‹ ãƒ»ã‚²ãƒƒã‚¿ãƒ¼ã¨ã‚»ãƒƒã‚¿ãƒ¼ã‚’ãƒ¡ã‚½ãƒƒãƒ‰åã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã™ã‚‹ã“ã¨ã¯æ‚ª å’Œè¨³ï¼šhttps://www.kaitoy.xyz/2015/07/22/getters-setters-evil/ åŸå…¸ï¼šhttps://www.yegor256.com/2014/09/16/getters-and-setters-are-evil.html ãƒ»ã‚»ãƒƒã‚¿ãƒ¼ã«ã‚ˆã‚‹ä¾å­˜æ€§æ³¨å…¥ã¯æ‚ª åŸå…¸ï¼šhttps://www.yegor256.com/2014/10/03/di-containers-are-evil.html å€¤ã‚’å–å¾—ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚µãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£… ãƒ»Getter Getterã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã ã‘ã§ã¯ãªãã€ä½•ã‹ã—ã‚‰ã®å‡¦ç†ã‚’åŠ ãˆãŸã†ãˆã§å–å¾—ã™ã‚‹ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š property)){ throw new ErrorException(\"ãƒ‡ãƒ¼ã‚¿ã«å€¤ãŒã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\"); } return $this->property; } } å€¤ã‚’è¨­å®šã™ã‚‹ã‚¢ã‚¯ã‚»ã‚µãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£… ãƒ»Setter ã€Mutableã€ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®Ÿç¾ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š property01 = $property01; } } ãƒ»ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã®__constructãƒ¡ã‚½ãƒƒãƒ‰ ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã®__constructãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒãŸã›ã‚‹ã“ã¨ã§ã€ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŒã£ã¦ã„ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„åˆ¶ç´„ã‚’æ˜ç¤ºã§ãã‚‹ã€‚Setterã‚’æŒãŸã›ãšã«ã€__constructãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã‚’æŒãŸã›ã‚Œã°ã€ValueObjectã®ã‚ˆã†ãªã€ã€Immutableã€ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®Ÿç¾ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š property02 = $property02; } } ãƒ»ã€Mutableã€ã¨ã€Immutableã€ã‚’å®Ÿç¾ã§ãã‚‹ç†ç”± Test01ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property01ã«å€¤ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰Setterã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚Setterã¯ä½•åº¦ã§ã‚‚å‘¼ã³å‡ºã›ã€ãã®åº¦ã«ãƒ‡ãƒ¼ã‚¿ã®å€¤ã‚’ä¸Šæ›¸ãã§ãã‚‹ã€‚ setProperty01(\"ãƒ‡ãƒ¼ã‚¿01ã®å€¤\"); $test01->setProperty01(\"æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿01ã®å€¤\"); ä¸€æ–¹ã§ã€Test02ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property02ã«å€¤ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚Šç›´ã•ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã¤ã¾ã‚Šã€ä»¥å‰ã«ä½œã£ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property02ã®å€¤ã¯ä¸Šæ›¸ãã§ããªã„ã€‚Setterã‚’æŒãŸã›ãšã«ã€__constructãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã‚’æŒãŸã›ã‚Œã°ã€ã€Immutableã€ãªã‚¯ãƒ©ã‚¹ã¨ãªã‚‹ã€‚ Entityã¯ã€Mutableã§ã‚ã‚‹ãŸã‚ã€Setterã¨__constructãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸¡æ–¹ã‚’æŒã¦ã‚‹ã€‚ValueObjectã¯ã€Immutableã®ãŸã‚ã€__constructãƒ¡ã‚½ãƒƒãƒ‰ã—ã‹æŒã¤ã“ã¨ãŒã§ããªã„ã€‚ ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆGetterç³»ï¼‰ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ç‰¹å®šã®æ“ä½œãŒè¡Œã‚ã‚ŒãŸæ™‚ã«è‡ªå‹•çš„ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ç‰¹æ®Šãªãƒ¡ã‚½ãƒƒãƒ‰ã®ã“ã¨ã€‚è‡ªå‹•çš„ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ä»•çµ„ã¿ã¯è¬ã€‚å…±é€šã®å‡¦ç†ã‚’è¡Œã†Getterï¼ˆä¾‹ãˆã°ã€å€¤ã‚’å–å¾—ã™ã‚‹ã ã‘ã®Getterãªã©ï¼‰ã‚’ç„¡é—‡ã«å¢—ã‚„ã—ãŸããªã„å ´åˆã«ç”¨ã„ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰é‡ã®è‚¥å¤§åŒ–ã‚’é˜²ã’ã‚‹ã€‚PHPã«ã¯æœ€åˆã‹ã‚‰ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã¯çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ãŒã€è‡ªèº«ã§å®Ÿè£…ã—ãŸå ´åˆã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã•ã‚Œã¦ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ ãƒ»__getãƒ¡ã‚½ãƒƒãƒ‰ å®šç¾©ã•ã‚Œã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ã‚„ã€ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã®ãªã„ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ãŸæ™‚ã«ã€ä»£ã‚ã‚Šã«å‘¼ã³å‡ºã•ã‚Œã‚‹ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã¯å®šç¾©ã—ã¦ã„ã‚‹ãŒã€ãƒ‡ãƒ¼ã‚¿ã¯å®šç¾©ã—ã¦ã„ãªã„ã‚ˆã†ãªçŠ¶æ³ã§ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š hoge; // çµæœ // hogeãƒ‡ãƒ¼ã‚¿ã¯å­˜åœ¨ã—ãªã„ãŸã‚ã€å€¤ã‚’å‘¼ã³å‡ºã›ã¾ã›ã‚“ã€‚ ãƒ»__callãƒ¡ã‚½ãƒƒãƒ‰ å®šç¾©ã•ã‚Œã¦ã„ãªã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã€ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã®ãªã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ãŸæ™‚ã«ã€ä»£ã‚ã‚Šã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ã¯å®šç¾©ã—ã¦ã„ã‚‹ãŒã€ãƒ¡ã‚½ãƒƒãƒ‰ã¯å®šç¾©ã—ã¦ã„ãªã„ã‚ˆã†ãªçŠ¶æ³ã§ç”¨ã„ã‚‹ã€‚ ãƒ»__callStaticãƒ¡ã‚½ãƒƒãƒ‰ ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆSetterç³»ï¼‰ å®šç¾©ã•ã‚Œã¦ã„ãªã„é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã€ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã®ãªã„é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ãŸæ™‚ã«ã€ä»£ã‚ã‚Šã«å‘¼ã³å‡ºã•ã‚Œã‚‹ã€‚è‡ªå‹•çš„ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ä»•çµ„ã¿ã¯è¬ã€‚å…±é€šã®å‡¦ç†ã‚’è¡Œã†Setterï¼ˆä¾‹ãˆã°ã€å€¤ã‚’è¨­å®šã™ã‚‹ã ã‘ã®Setterãªã©ï¼‰ã‚’ç„¡é—‡ã«å¢—ã‚„ã—ãŸããªã„å ´åˆã«ç”¨ã„ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰é‡ã®è‚¥å¤§åŒ–ã‚’é˜²ã’ã‚‹ã€‚PHPã«ã¯æœ€åˆã‹ã‚‰ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã¯çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ãŒã€è‡ªèº«ã§å®Ÿè£…ã—ãŸå ´åˆã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã•ã‚Œã¦å‘¼ã³å‡ºã•ã‚Œã‚‹ã€‚ ãƒ»__setãƒ¡ã‚½ãƒƒãƒ‰ å®šç¾©ã•ã‚Œã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ã‚„ã€ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã®ãªã„ãƒ‡ãƒ¼ã‚¿ã«å€¤ã‚’è¨­å®šã—ã‚ˆã†ã¨ã—ãŸæ™‚ã«ã€ä»£ã‚ã‚Šã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸å¤‰æ€§ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸å¤‰æ€§ã¯ã€ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design.html ï¼Šå®Ÿè£…ä¾‹ï¼Š class Foo { // ä¸­èº«ã¯çœç•¥ } // å­˜åœ¨ã—ãªã„ãƒ‡ãƒ¼ã‚¿ã«å€¤ã‚’ã‚»ãƒƒãƒˆã€‚ $foo = new Foo(); $foo->hoge = \"HOGE\"; // çµæœ // hogeãƒ‡ãƒ¼ã‚¿ã¯å­˜åœ¨ã—ãªã„ãŸã‚ã€HOGEã‚’è¨­å®šã§ãã¾ã›ã‚“ã€‚ ãƒ»ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã®__constructãƒ¡ã‚½ãƒƒãƒ‰ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–æ™‚ã«è‡ªå‹•çš„ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–æ™‚ã«å®Ÿè¡Œã—ãŸã„å‡¦ç†ã‚’è¨˜è¿°ã§ãã‚‹ã€‚Setterã‚’æŒãŸã›ãšã«ã€__constructãƒ¡ã‚½ãƒƒãƒ‰ã§ã®ã¿å€¤ã®è¨­å®šã‚’è¡Œãˆã°ã€ValueObjectã®ã‚ˆã†ãªã€ã€Immutableã€ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®Ÿç¾ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š property02 = $property02; } } ãƒ»ã€Mutableã€ã¨ã€Immutableã€ã‚’å®Ÿç¾ã§ãã‚‹ç†ç”±ã€‘ Test01ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property01ã«å€¤ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰Setterã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚Setterã¯ä½•åº¦ã§ã‚‚ã‚³ãƒ¼ãƒ«ã§ãã€ãã®åº¦ã«ãƒ‡ãƒ¼ã‚¿ã®å€¤ã‚’ä¸Šæ›¸ãã§ãã‚‹ã€‚ setProperty01(\"ãƒ‡ãƒ¼ã‚¿01ã®å€¤\"); $test01->setProperty01(\"æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿01ã®å€¤\"); ä¸€æ–¹ã§ã€Test02ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property02ã«å€¤ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚Šç›´ã•ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã¤ã¾ã‚Šã€ä»¥å‰ã«ä½œã£ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®$property02ã®å€¤ã¯ä¸Šæ›¸ãã§ããªã„ã€‚Setterã‚’æŒãŸã›ãšã«ã€__constructãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã‚’æŒãŸã›ã‚Œã°ã€ã€Immutableã€ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ãªã‚‹ã€‚ ãƒã‚¸ãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆãã®ä»–ï¼‰ ãƒ»__invokeãƒ¡ã‚½ãƒƒãƒ‰ å®šç¾©ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã‚’ã€é–¢æ•°ã®ã‚ˆã†ã«æ‰±ãˆã‚‹ã€‚__invokeãƒ¡ã‚½ãƒƒãƒ‰è‡ªä½“ã¯ç„¡åé–¢æ•°ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ã€‚ 1 // [1] => 2 // [2] => 3 // ) ãƒ»__cloneãƒ¡ã‚½ãƒƒãƒ‰ // ã“ã“ã«å®Ÿè£…ä¾‹ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»staticãƒ¡ã‚½ãƒƒãƒ‰ ã¨ selfãƒ¡ã‚½ãƒƒãƒ‰ã®é•ã„ ã©ã¡ã‚‰ã‚‚ã€newæ¼”ç®—å­ã¨çµ„ã¿åˆã‚ã›ã¦ã€è‡ªèº«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”å´ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚ã‚‹ãŒã€ç”Ÿæˆã®å¯¾è±¡ã«ãªã‚‹ã‚¯ãƒ©ã‚¹ãŒç•°ãªã‚‹ã€‚ ä»¥ä¸‹ã®é€šã‚Šã€selfãƒ¡ã‚½ãƒƒãƒ‰ã¯å®šç¾©ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã™ã‚‹ã€‚ä¸€æ–¹ã§ã€staticãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã™ã‚‹ã€‚è‡ªèº«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–å‡¦ç†ãŒç¶™æ‰¿ã•ã‚Œã‚‹å ´åˆã¯ã€staticãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ãŸæ–¹ãŒè‰¯ã„ã€‚ ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ¼ãƒ« ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ ä»¥ä¸‹ã®ã‚ˆã†ãªã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆAã‚’æœ€å¤–å±¤ã¨ã—ãŸé–¢ä¿‚ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã¨ã™ã‚‹ã€‚ ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆAï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆBã‚’ãƒ‡ãƒ¼ã‚¿ã«æŒã¤ï¼‰ã€‘ objB; } } ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆBï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆCã‚’ãƒ‡ãƒ¼ã‚¿ã«æŒã¤ï¼‰ã€‘ objC; } } ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆCï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆDã‚’ãƒ‡ãƒ¼ã‚¿ã«æŒã¤ï¼‰ã€‘ objD; } } ä»¥ä¸‹ã®ã‚ˆã†ã«ã€è¿”å´å€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”¨ã„ã¦ã€ã‚ˆã‚Šæ·±ã„å±¤ã«é€£ç¶šã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ãå ´åˆâ€¦ objB(); $ObjC = $ObjB->objB(); $ObjD = $ObjC->objD(); ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã¨ã„ã†æ›¸ãæ–¹ãŒå¯èƒ½ã€‚ objC()->objC(); // $D ã«ã¯ ObjD ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»Recursive callï¼šå†å¸°çš„ãƒ—ãƒ­ã‚°ãƒ©ãƒ  è‡ªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰è‡ªèº«è‡ªèº«ã‚’ã‚³ãƒ¼ãƒ«ã—ã€å®Ÿè¡Œã§ãã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š ã‚ã‚‹é–¢æ•° fã®å®šç¾©ã®ä¸­ã« fè‡ªèº«ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ç®‡æ‰€ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚‚å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_logic_algorithm.html é©å½“ãªå€¤ã‚’åŸºæº–å€¤ï¼ˆPivotï¼‰ã¨ã™ã‚‹ ï¼ˆâ€»ã§ãã‚Œã°ä¸­å¤®å€¤ãŒæœ›ã¾ã—ã„ï¼‰ Pivotã‚ˆã‚Šå°ã•ã„æ•°ã‚’å‰æ–¹ã€å¤§ãã„æ•°ã‚’å¾Œæ–¹ã«åˆ†å‰²ã™ã‚‹ã€‚ äºŒåˆ†å‰²ã•ã‚ŒãŸå„ã€…ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã€ãã‚Œãã‚Œã‚½ãƒ¼ãƒˆã™ã‚‹ã€‚ ã‚½ãƒ¼ãƒˆã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å¼•æ•° ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•° å¼•æ•°ãŒä¸ãˆã‚‰ã‚Œãªã‘ã‚Œã°ã€æŒ‡å®šã®å€¤ã‚’æ¸¡ã™æ–¹æ³• // ã“ã“ã«å®Ÿè£…ä¾‹ å€¤ã‚’è¿”å´ã™ã‚‹å‰ã®é€”ä¸­çµ‚äº† ãƒ»return; ï¼Šå®Ÿè£…ä¾‹ï¼Š returnMethod(); // returnMethod()ã§ã™ã€‚ // å‡¦ç†ã¯ç¶šãã€‚ ãƒ»exit; ï¼Šå®Ÿè£…ä¾‹ï¼Š exitMethod(); // exitMethod()ã§ã™ã€‚ // ã“ã“ã§ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢å…¨ä½“ã®å‡¦ç†ãŒçµ‚äº†ã™ã‚‹ã€‚ å€¤ã®è¿”å´ ãƒ»return ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸå ´æ‰€ã«å€¤ã‚’è¿”å´ã—ãŸå¾Œã€ãã®å‡¦ç†ãŒçµ‚ã‚ã‚‹ã€‚ ãƒ»yield ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸå ´æ‰€ã«å€¤ã‚’è¿”å´ã—ãŸå¾Œã€ãã“ã§çµ‚ã‚ã‚‰ãšã€yieldã®æ¬¡ã®å‡¦ç†ãŒç¶šãã€‚è¿”å´å€¤ã¯ã€arrayå‹ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š oneToThree(); foreach ($oneToThree as $value) { echo \"{$value}\\n\"; } // 1 // 2 // 3 Dispatcher ãƒ»Dispatcherã¨ã¯ ç‰¹å®šã®åå‰ã¨é–¢æ•°ã‚’ç´ä»˜ã‘ã€åå‰ã‚’æ¸¡ã™ã“ã¨ã§é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’Dispatcherã¨ã„ã†ã€‚ addListener($name, $listener); // æ–‡å­—åˆ—ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã€‚ã¤ã„ã§ã«ã€å¼•æ•°ã‚’æ¸¡ã™ã€‚ $dispatcher->dispatch(\"foo\", \"test\"); ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆåã¨é–¢æ•°ã®ç´ä»˜ã‘ åå‰ã¨ã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆåã‚’å®šç¾©ã—ã€ã“ã‚Œã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ç‰¹å®šã®ã‚¤ãƒ™ãƒ³ãƒˆåãŒæ¸¡ã•ã‚ŒãŸæ™‚ã«ã€ãã‚Œã«å¯¾å¿œã¥ã‘ã‚‰ã‚ŒãŸé–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®EventDispatcherã‚¯ãƒ©ã‚¹ãŒç°¡å˜ã§ã‚ã‚‹ã€‚ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_framework_symfony.html ãƒ»è¨ˆç®—å‡¦ç†ã®è¿”å´å€¤ã‚’ä¿æŒã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã™ã‚‹ã¯ã€ãã®å‡¦ç†ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚ãã“ã§ã€ãã®ã‚ˆã†ãªãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€ä¸€åº¦ã‚³ãƒ¼ãƒ«ã•ã‚Œã¦é›†è¨ˆã‚’è¡Œã£ãŸå¾Œã€ãƒ‡ãƒ¼ã‚¿ã«è¿”å´å€¤ã‚’ä¿æŒã—ã¦ãŠãã€‚ãã—ã¦ã€å†ã³ã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸæ™‚ã«ã¯ã€è¿”å´å€¤ã‚’ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å–ã‚Šå‡ºã™ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š funcCollection = $this->addListener(); } /** * é›†è¨ˆãƒ¡ã‚½ãƒƒãƒ‰ */ public function computeRevenue() { // æ™‚é–“ã®ã‹ã‹ã‚‹é›†è¨ˆå‡¦ç†; } /** * @param string $funcName * @return false|mixed */ public function funcNameListener(string $funcName) { // è¿”å´å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ãªã‹ã£ãŸå ´åˆã€å€¤ã‚’è¨­å®š. if (!isset($this->resultCollection[$funcName])) { // ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ã‚’Collectionã«è¨­å®šã€‚ $this->resultCollection[$funcName] = $this->dispatch($funcName); } // è¿”å´å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ãŸå ´åˆ,ãã®ã¾ã¾ä½¿ã†ã€‚ return $this->resultCollection[$funcName]; } /** * è¿”å´å€¤ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ãŸã„ãƒ¡ã‚½ãƒƒãƒ‰åã‚’ç™»éŒ²ã—ã¦ãŠã * * @return array[] */ private function addListener() { return [ \"computeRevenue\" => [$this, \"computeRevenue\"] ]; } /** * @param string $funcName * @return false|mixed */ private function dispatch(string $funcName) { // call_user_funcã§ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œ return call_user_func( // ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰åã‹ã‚‰ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’Dispatch. $this->funcCollection[$funcName] ); } } 02-03. Closureï¼ˆç„¡åé–¢æ•°ï¼‰ Closureï¼ˆç„¡åé–¢æ•°ï¼‰ã®å®šç¾©ã€å¤‰æ•°æ ¼ç´å¾Œã®ã‚³ãƒ¼ãƒ« ãƒ»use()ã®ã¿ã«å¼•æ•°ã‚’æ¸¡ã™å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š optionName(); }; // function()ã«ã¯å¼•æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ã®ã§ã€ã‚³ãƒ¼ãƒ«æ™‚ã«å¼•æ•°ã¯ä¸è¦ã€‚ echo $optionName; // å‡ºåŠ›çµæœ // ã‚ªãƒ—ã‚·ãƒ§ãƒ³A ãƒ»function()ã¨use()ã«å¼•æ•°ã‚’æ¸¡ã™å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š optionName() . $para; }; // ã‚³ãƒ¼ãƒ«æ™‚ã«ã€$paramã‚’function()ã«æ¸¡ã™ã€‚ echo $optionName(\"BC\"); // å‡ºåŠ›çµæœ // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ABC ãƒ»ãƒ‡ãƒ¼ã‚¿ã®å€¤ã¨ã—ã¦ã€ç„¡åé–¢æ•°ã‚’æ ¼ç´ã—ã¦ãŠãè£æŠ€ ï¼Šå®Ÿè£…ä¾‹ï¼Š name = function ($para) use ($item) { $item->optionName() . $para; }; // ã‚³ãƒ¼ãƒ«æ™‚ã«ã€$paramã‚’function()ã«æ¸¡ã™ã€‚ echo $option->name(\"BC\"); // å‡ºåŠ›çµæœ // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ABC Closureï¼ˆç„¡åé–¢æ•°ï¼‰ã®å®šç¾©ã¨å³ã‚³ãƒ¼ãƒ« å®šç¾©ã—ãŸãã®å ´ã§ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ç„¡åé–¢æ•°ã‚’ã€å³æ™‚é–¢æ•°ã€ã¨å‘¼ã¶ã€‚ç„¡åé–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã—ãŸã„æ™‚ã¯ã€call_user_funcãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š optionName() . $param; }); // $paramã¯ã™ã§ã«å³ã‚³ãƒ¼ãƒ«æ™‚ã«æ¸¡ã•ã‚Œã¦ã„ã‚‹ã€‚ // ã“ã‚Œã¯ã‚³ãƒ¼ãƒ«ã§ã¯ãªãã€å³ã‚³ãƒ¼ãƒ«æ™‚ã«æ ¼ç´ã•ã‚ŒãŸè¿”å´å€¤ã®å‡ºåŠ›ã€‚ echo $optionName; // å‡ºåŠ›çµæœ // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ABC é«˜éšé–¢æ•°ã¨Closureï¼ˆç„¡åé–¢æ•°ï¼‰ã®çµ„ã¿åˆã‚ã› é–¢æ•°ã‚’å¼•æ•°ã¨ã—ã¦å—ã‘å–ã£ãŸã‚Šã€é–¢æ•°è‡ªä½“ã‚’è¿”ã—ãŸã‚Šã™ã‚‹é–¢æ•°ã‚’ã€é«˜éšé–¢æ•°ã€ã¨å‘¼ã¶ã€‚ ãƒ»ç„¡åé–¢æ•°ã‚’ç”¨ã„ãªã„å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š test(\"callbackMethod\"); // å‡ºåŠ›çµæœ // å‡ºåŠ›ã«æˆåŠŸã—ã¾ã—ãŸã€‚ higherOrder(\"ç¬¬ä¸€å¼•æ•°\", \"callbackMethod\"); // å‡ºåŠ›çµæœ // ç¬¬ä¸€å¼•æ•°ã®å‡ºåŠ›ã«æˆåŠŸã—ã¾ã—ãŸã€‚ ãƒ»ç„¡åé–¢æ•°ã‚’ç”¨ã„ã‚‹å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š higherOrder($parentVar, function () use ($parentVar) { return $parentVar . \"ã®å‡ºåŠ›ã«æˆåŠŸã—ã¾ã—ãŸã€‚\"; }); // å‡ºåŠ›çµæœ // è¦ªãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¹ã‚³ãƒ¼ãƒ—ã®å¤‰æ•°ã®å‡ºåŠ›ã«æˆåŠŸã—ã¾ã—ãŸã€‚ é«˜éšé–¢æ•°ã‚’ä½¿ã„ã“ãªã™ï¼ ï¼Šå®Ÿè£…ä¾‹ï¼Š properties as $property) { // å¼•æ•°ã®ç„¡åé–¢æ•°ã«ã‚ˆã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹åŠ å·¥æ–¹æ³•ãŒç•°ãªã‚‹ã€‚ // ä¾‹ãˆã°ã€åˆ¤å®šã§trueã®ã‚‚ã®ã®ã¿ã‚’è¿”ã™ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¸¡ã™ã¨ã€è‡ªãƒ‡ãƒ¼ã‚¿ã‚’çµã‚Šè¾¼ã‚€ã‚ˆã†ãªå‡¦ç†ã‚’è¡Œãˆã‚‹ã€‚ $returned = call_user_func($property, $callback); if ($returned) { // å†æ ¼ç´ã€‚ $properties[] = $returned; } } // ä»–ã®ãƒ‡ãƒ¼ã‚¿ã¯é™çš„ã«æ‰±ã£ãŸã†ãˆã§ã€è‡ªèº«ã‚’è¿”ã™ã€‚ return new static($properties); } } 03. å®šæ•° å®šæ•°ãŒå½¹ã«ç«‹ã¤å ´é¢ ãƒ»ãƒ•ãƒ©ã‚°ON/OFF ãƒ»åŒºåˆ†å€¤ åŒºåˆ†å€¤ã‚’æ•´æ•°å‹ã®å®šæ•°ã¨ã—ã¦æ‰±ã†ã€‚åŒºåˆ†å€¤ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦ã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design.html ãƒ»æ•°å€¤è¨ˆç®—ã€æ•°å€¤æ¯”è¼ƒ è¨ˆç®—å‡¦ç†ã‚„æ•°å€¤æ¯”è¼ƒå‡¦ç†ã§ã¯ã€å¯èª­æ€§ã®è¦³ç‚¹ã‹ã‚‰ã€ã§ãã‚‹ã ã‘æ•°å€¤ã‚’ç›´æ›¸ãã—ãªã„ã€‚æ•°å€¤ã«æ„å‘³åˆã„ã‚’æŒãŸã›ã€å®šæ•°ã¨ã—ã¦æ‰±ã†ã¨å¯èª­æ€§ãŒé«˜ããªã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design.html ãƒ»URL URLã‚’æ–‡å­—åˆ—ã‚’å®šæ•°ã¨ã—ã¦æ‰±ã†ã€‚ å ´é¢ã«å¿œã˜ãŸå‘½å æ„å‘³ã¥ã‘ åå‰ å‹ å€‹æ•°ã€å›æ•° NUM_*** int æœ€å¤§æ•°ã€æœ€å°æ•° MAX_NUM_*****ã€MIN_NUM_***** int URL URL_***** string ãƒã‚¸ã‚«ãƒ«å®šæ•° è‡ªå‹•çš„ã«å€¤ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹å®šæ•°ã€‚ ãƒ»__DIR__ ã“ã®å®šæ•°ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¨­ç½®ã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹ãŒã€ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåŸºæº–ã§æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä»¥ä¸‹ã®å®Ÿè£…ã‚’æŒã¤ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ã€/var/www/appã€ä¸‹ã«ç½®ã„ã¦ãŠãã€ã€/vendor/autoload.phpã€ã¨çµåˆã—ã¦ãƒ‘ã‚¹ã‚’é€šã™ã€‚ ãƒ»__FUNCTION__ ã“ã®å®šæ•°ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰åãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š foo(); // foo ãŒè¿”å´ã•ã‚Œã‚‹ã€‚ ãƒ»__METHOD__ ã“ã®å®šæ•°ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹åã¨ãƒ¡ã‚½ãƒƒãƒ‰åãŒã€{ã‚¯ãƒ©ã‚¹å}::{ãƒ¡ã‚½ãƒƒãƒ‰å}ã®å½¢å¼ã§æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š foo(); // Foo::foo ãŒè¿”å´ã•ã‚Œã‚‹ã€‚ 04. å¤‰æ•° å¤‰æ•°å±•é–‹ æ–‡å­—åˆ—ã®ä¸­ã§ã€å¤‰æ•°ã®ä¸­èº«ã‚’å–ã‚Šå‡ºã™ã“ã¨ã‚’ã€å¤‰æ•°å±•é–‹ã€ã¨å‘¼ã¶ã€‚ â€»Paizaã§æ¤œè¨¼æ¸ˆã¿ã€‚ ãƒ»ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¤‰æ•°å±•é–‹ ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­èº«ã¯å…¨ã¦æ–‡å­—åˆ—ã¨ã—ã¦èªè­˜ã•ã‚Œã€å¤‰æ•°ã¯å±•é–‹ã•ã‚Œãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨æ³¢æ‹¬å¼§ã«ã‚ˆã‚‹å¤‰æ•°å±•é–‹ ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­èº«ã¯å…¨ã¦æ–‡å­—åˆ—ã¨ã—ã¦èªè­˜ã•ã‚Œã€å¤‰æ•°ã¯å±•é–‹ã•ã‚Œãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¤‰æ•°å±•é–‹ å¤‰æ•°ã®å‰å¾Œã«åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç½®ã„ãŸå ´åˆã«ã®ã¿ã€å¤‰æ•°ã¯å±•é–‹ã•ã‚Œã‚‹ã€‚ï¼ˆâ€»åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ãŒãªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ï¼‰ ãƒ»ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨æ³¢æ‹¬å¼§ã«ã‚ˆã‚‹å¤‰æ•°å±•é–‹ æ³¢æ‹¬å¼§ã‚’ç”¨ã„ã‚‹ã¨ã€æ˜ç¤ºçš„ã«å¤‰æ•°ã¨ã—ã¦æ‰±ãˆã‚‹ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€å¤‰æ•°ã®å‰å¾Œã«åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç½®ã‹ãªãã¨ã‚‚ã€å¤‰æ•°ã¯å±•é–‹ã•ã‚Œã‚‹ã€‚ å‚ç…§æ¸¡ã—ã¨å€¤æ¸¡ã— ãƒ»å‚ç…§æ¸¡ã— ã€å‚ç…§æ¸¡ã—ã€ã¨ã¯ã€å¤‰æ•°ã«ä»£å…¥ã—ãŸå€¤ã®å‚ç…§å…ˆï¼ˆãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’æ¸¡ã™ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å¤‰æ•°ã®$bã«ã¯ã€$aã®å‚ç…§ã«ã‚ˆã£ã¦10ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ ãƒ»å€¤æ¸¡ã— ã€å€¤æ¸¡ã—ã€ã¨ã¯ã€å¤‰æ•°ã«ä»£å…¥ã—ãŸå€¤ã®ã‚³ãƒ”ãƒ¼ã‚’æ¸¡ã™ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å¤‰æ•°ã®$bã«ã¯ã€$aã®ä¸€è¡Œç›®ã®æ ¼ç´ã«ã‚ˆã£ã¦2ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ 05. çµ„ã¿è¾¼ã¿ãƒ©ãƒƒãƒ‘ãƒ¼é–¢æ•° å…¥å‡ºåŠ›ã‚¹ãƒˆãƒªãƒ¼ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ ãƒ»å…¥å‡ºåŠ›ã‚¹ãƒˆãƒªãƒ¼ãƒ ã¨ã¯ ä¸€åº¦ã«å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¥å‡ºåŠ›ã™ã‚‹ã®ã§ã¯ãªãã€å°‘ã—ãšã¤å…¥å‡ºåŠ›ã™ã‚‹å‡¦ç†ã®ã“ã¨ã€‚ ãƒ»php://stdin stdinï¼šstandard inï¼ˆæ¨™æº–å…¥åŠ›ï¼‰ã‚’æ„å‘³ã™ã‚‹ã€‚PHPã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã€æ¨™æº–å…¥åŠ›ã«å¯¾ã—ã¦ã€èª­ã¿å‡ºã—å‡¦ç†ã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ãƒ»php://stdout stdoutï¼šstandard outï¼ˆæ¨™æº–å‡ºåŠ›ï¼‰ã‚’æ„å‘³ã™ã‚‹ã€‚PHPã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã€æ¨™æº–å‡ºåŠ›ã«å¯¾ã—ã¦ã€æ›¸ãè¾¼ã¿å‡¦ç†ã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ãƒ»php://stderr stderrï¼šstandard errorï¼ˆæ¨™æº–å‡ºåŠ›ã‚¨ãƒ©ãƒ¼ï¼‰ã‚’æ„å‘³ã™ã‚‹ã€‚PHPã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã€æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å¯¾ã—ã¦ã€æ›¸ãè¾¼ã¿å‡¦ç†ã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ 06. ãã®ä»–ã®é–¢æ•° ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ é–¢æ•° ãƒ»file_put_contents ãƒ•ã‚¡ã‚¤ãƒ«ã«æ–‡å­—åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 07. æ­£è¦è¡¨ç¾ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³æ¼”ç®—å­ æ­£è¦è¡¨ç¾ ãƒ»æ­£è¦è¡¨ç¾ã¨ã¯ æ•°å€¤ã€è¨˜å·ã€æ–‡å­—åˆ—ãªã©ã®ç¨®é¡ã‚’ç°¡å˜ã«è¡¨ç¾ã™ã‚‹æ–‡å­—åˆ—ã®ã“ã¨ã€‚ preg_matché–¢æ•° ãƒ»æ•°å­— ï¼Šå®Ÿè£…ä¾‹ï¼Š ã€0ã‹ã‚‰9ã®ã„ãšã‚Œã‹ã€ã®æ•°å­—ã‚’æ„å‘³ã™ã‚‹ã€‚ ãƒ»ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã€aã‹ã‚‰zã®ã„ãšã‚Œã‹ã€ã¾ãŸã¯ã€Aã‹ã‚‰Zã®ã„ãšã‚Œã‹ã€ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã‚’æ„å‘³ã™ã‚‹ã€‚ ãƒ»ãƒ¡ã‚¿æ–‡å­— ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã®ãŸã‚ã«ã€å¿…ãšãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’ä»˜ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www-creators.com/archives/3102 ï¼Šå®Ÿè£…ä¾‹ï¼Š ã€?ã€ã€.ã€ã€*ã€ã€$ã€ã®ã„ãšã‚Œã‹ã®ãƒ¡ã‚¿æ–‡å­—ã‚’æ„å‘³ã™ã‚‹ã€‚ ãƒ»ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã¯ã€.*ã€ã§è¡¨ç¾ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/whisky-shusuky/items/d719c92c566c133f51b1 ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ¼”ç®—å­ ï¼Šå®Ÿè£…ä¾‹ï¼Š "},"public/software/software_application_object_oriented_language_php_class_based_data_structure.html":{"url":"public/software/software_application_object_oriented_language_php_class_based_data_structure.html","title":"ğŸ“– ï¸ãƒ‡ãƒ¼ã‚¿æ§‹é€ ","keywords":"","body":"ãƒ‡ãƒ¼ã‚¿æ§‹é€  ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å®Ÿè£…æ–¹æ³• ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŒå‡¦ç†ã‚’è¡Œã†æ™‚ã«ã€ãƒ‡ãƒ¼ã‚¿ã®é›†åˆã‚’åŠ¹ç‡çš„ã«æ‰±ã†ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿æ ¼ç´å½¢å¼ã‚’ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨ã„ã†ã€‚ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®PHPã«ã‚ˆã‚‹å®Ÿè£…æ–¹æ³•ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ é…åˆ—å‹ åŒã˜ãƒ‡ãƒ¼ã‚¿å‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸¦ã¹ãŸãƒ‡ãƒ¼ã‚¿æ ¼ç´æ§˜å¼ã®ã“ã¨ã€‚ ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹é…åˆ— ç•ªå·ã‚­ãƒ¼ã”ã¨ã«å€¤ãŒæ ¼ç´ã•ã‚ŒãŸé…åˆ—å‹ã®ã“ã¨ã€‚ Array ( [0] => A [1] => B [2] => C ) ãƒ»å¤šæ¬¡å…ƒé…åˆ— é…åˆ—ã®ä¸­ã«é…åˆ—ã‚’æŒã¤é…åˆ—å‹ã®ã“ã¨ã€‚é…åˆ—ã®å…¥ã‚Œå­æ§‹é€ ãŒï¼’æ®µã®å ´åˆã€ã€äºŒæ¬¡å…ƒé…åˆ—ã€ã¨å‘¼ã¶ã€‚ ( [0] => Array ( [0] => ãƒªãƒ³ã‚´ [1] => ã‚¤ãƒã‚´ [2] => ãƒˆãƒãƒˆ ) [1] => Array ( [0] => ãƒ¡ãƒ­ãƒ³ [1] => ã‚­ãƒ¥ã‚¦ãƒª [2] => ãƒ”ãƒ¼ãƒãƒ³ ) ) ãƒ»é€£æƒ³é…åˆ— ã‚­ãƒ¼åï¼ˆèµ¤ã€ç·‘ã€é»„ã€æœç‰©ã€é‡èœï¼‰ã”ã¨ã«å€¤ãŒæ ¼ç´ã•ã‚ŒãŸé…åˆ—å‹ã®ã“ã¨ã€‚ä¸‹ã®ä¾‹ã¯ã€äºŒæ¬¡å…ƒé…åˆ—ã‹ã¤é€£æƒ³é…åˆ—ã§ã‚ã‚‹ã€‚ Array ( [èµ¤] => Array ( [æœç‰©] => ãƒªãƒ³ã‚´ [æœç‰©] => ã‚¤ãƒã‚´ [é‡èœ] => ãƒˆãƒãƒˆ ) [ç·‘] => Array ( [æœç‰©] => ãƒ¡ãƒ­ãƒ³ [é‡èœ] => ã‚­ãƒ¥ã‚¦ãƒª [é‡èœ] => ãƒ”ãƒ¼ãƒãƒ³ ) ) LinkedListå‹ PHPã§ç”¨ã„ã‚‹ã“ã¨ã¯ã‚ã¾ã‚Šãªã„ãƒ‡ãƒ¼ã‚¿æ ¼ç´æ§˜å¼ã€‚è©³ã—ãã¯ã€Javaã«ãŠã‘ã‚‹LinkedListå‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ãƒ»PHPã®listãƒ¡ã‚½ãƒƒãƒ‰ã¨ã¯ä½•ãªã®ã‹ PHPã®listãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€Listå‹ã¨ã¯æ„å‘³åˆã„ãŒç•°ãªã‚‹ã€‚é…åˆ—ã®è¦ç´ ä¸€ã¤ä¸€ã¤ã‚’å¤‰æ•°ã«æ ¼ç´ã—ãŸã„å ´åˆã€Listå‹ã‚’ä½¿ã‚ãªã‘ã‚Œã°ã€å†—é•·ã§ã¯ã‚ã‚‹ãŒã€ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã—ã‹ã—ã€ä»¥ä¸‹ã®æ§˜ã«ã€listãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†ã“ã¨ã«ã‚ˆã£ã¦ã€è¤‡æ•°ã®å¤‰æ•°ã¸ã®æ ¼ç´ã‚’ä¸€è¡Œã§å®Ÿè£…ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Queueå‹ PHPã§ã¯ã€array_pushãƒ¡ã‚½ãƒƒãƒ‰ã¨array_shiftãƒ¡ã‚½ãƒƒãƒ‰ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§å®Ÿè£…ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Blue // [1] => Green // [2] => Red // ) // é…åˆ—ã®æœ€åˆã®è¦ç´ ã‚’å–ã‚Šå‡ºã™ã€‚ $theFirst= array_shift($array); print_r($array); // å‡ºåŠ›çµæœ // Array // ( // [0] => Green // [1] => Red // ) // å–ã‚Šå‡ºã•ã‚ŒãŸå€¤ã®ç¢ºèª echo $theFirst; // Blue ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸Queue é€ä¿¡å´ã®å¥½ããªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸Queueã«è¿½åŠ ã§ãã‚‹ã€‚ã¾ãŸã€å—ä¿¡å´ã®å¥½ããªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–ã‚Šå‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚ Stackå‹ PHPã§ã¯ã€array_pushãƒ¡ã‚½ãƒƒãƒ‰ã¨array_popãƒ¡ã‚½ãƒƒãƒ‰ã§å®Ÿè£…å¯èƒ½ã€‚ Treeå‹ ãƒ»äºŒåˆ†æ¢ç´¢æœ¨ å„ãƒãƒ¼ãƒ‰ã«ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»ãƒ’ãƒ¼ãƒ— Priority Queueã‚’å®Ÿç¾ã™ã‚‹ã¨ãã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚å„ãƒãƒ¼ãƒ‰ã«ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ 01-02. Javaã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å®Ÿè£…æ–¹æ³• ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®Javaã«ã‚ˆã‚‹å®Ÿè£…æ–¹æ³•ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ é…åˆ—å‹ ãƒ»ArrayList ArrayListã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹é…åˆ—å‹ã€‚PHPã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹é…åˆ—ã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»HashMap HashMapã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹é…åˆ—å‹ã€‚PHPã®é€£æƒ³é…åˆ—ã«ç›¸å½“ã™ã‚‹ã€‚ LinkedListå‹ å€¤ã‚’ãƒã‚¤ãƒ³ã‚¿ã«ã‚ˆã£ã¦é †åºé€šã‚Šä¸¦ã¹ãŸãƒ‡ãƒ¼ã‚¿æ ¼ç´å½¢å¼ã®ã“ã¨ã€‚ ãƒ»å˜æ–¹å‘List ãƒ»åŒæ–¹å‘List ãƒ»å¾ªç’°List Queueå‹ Stackå‹ Treeå‹ 02. ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿å‹ ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ ãƒ»ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã¨ã¯ ã‚¹ã‚«ãƒ©ãƒ¼å‹ã€è¤‡åˆå‹ã€ãã®ä»–ã€ã«åˆ†é¡ã§ãã‚‹ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://www.php.net/manual/ja/language.types.intro.php ã‚¹ã‚«ãƒ©ãƒ¼å‹ ãƒ»bool Tï¼F ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡ èª¬æ˜ FALSE $var = ä½•ã‚‚æ ¼ç´ã•ã‚Œã¦ã„ãªã„å¤‰æ•° False æ–‡å­—ã¨ã—ã¦ã®False 0 æ•°å­—ã€æ–‡å­—åˆ— \"\" ç©ºæ–‡å­— array() è¦ç´ æ•°ãŒ0å€‹ã®é…åˆ— NULL NULLå€¤ TRUE ä¸Šè¨˜ä»¥å¤–ã®å€¤ ãƒ»float ãƒ»int ãƒ»string è¤‡åˆå‹ ãƒ»array ãƒ»callable ãƒ»iterable ãƒ»object name, \"Hello World!\" ); } } $a = new A; var_dump($a); // object(A)#1 (1) { // [\"name\":\"A\":private]=> // string(6) \"Hiroki\" //} print_r($a); // A Object // ( // [name:A:private] => Hiroki // ) ãã®ä»–ã®ãƒ‡ãƒ¼ã‚¿å‹ ãƒ»date å³å¯†ã«ã¯ãƒ‡ãƒ¼ã‚¿å‹ã§ã¯ãªã„ãŒã€ä¾¿å®œä¸Šã€ãƒ‡ãƒ¼ã‚¿å‹ã¨ã™ã‚‹ã€‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¨ã¯ã€å”å®šä¸–ç•Œæ™‚(UTC)ã‚’åŸºæº–ã«ã—ãŸ1970å¹´1æœˆ1æ—¥ã®0æ™‚0åˆ†0ç§’ã‹ã‚‰ã®çµŒéç§’æ•°ã‚’è¡¨ã—ãŸã‚‚ã®ã€‚ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ å®Ÿè£…æ–¹æ³• å‚™è€ƒ æ—¥ä»˜ 2019-07-07 åŒºåˆ‡ã‚Šè¨˜å·ãªã—ã€ãƒ‰ãƒƒãƒˆã€ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ãªã©ã‚‚å¯èƒ½ æ™‚é–“ 19:07:07 åŒºåˆ‡ã‚Šè¨˜å·ãªã—ã€ã‚‚å¯èƒ½ æ—¥ä»˜ã¨æ™‚é–“ 2019-07-07 19:07:07 åŒä¸Š ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆç§’ï¼‰ 1562494027 1970å¹´1æœˆ1æ—¥ã®0æ™‚0åˆ†0ç§’ã‹ã‚‰2019-07-07 19:07:07 ã¾ã§ã®çµŒéç§’æ•° ãƒ»null ãƒ»resource 02-02. ãƒ‡ãƒ¼ã‚¿å‹ã®åˆ¤å®šï¼å¤‰æ› åˆ¤å®šé–¢æ•° ãƒ»is_scalar ã‚¹ã‚«ãƒ©ãƒ¼å‹ï¼ˆboolã€floatã€intã€stringï¼‰ã‚’åˆ¤å®šã™ã‚‹ã€‚ ã‚­ãƒ£ã‚¹ãƒˆæ¼”ç®—å­ ãƒ»(string) ãƒ»(int) ãƒ»(bool) ãƒ»(float) ãƒ»(array) ãƒ»(object) "},"public/software/software_application_object_oriented_language_php_logic_validation.html":{"url":"public/software/software_application_object_oriented_language_php_logic_validation.html","title":"ğŸ“– ï¸æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯","keywords":"","body":"æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. æ¤œè¨¼ æ¤œè¨¼ã®å¿…è¦æ€§ã®æœ‰ç„¡ ãƒ»ä¸è¦ãªå ´åˆ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã—ãŸå¾Œã«ç›´æ¥è¡¨ç¤ºã™ã‚‹å€¤ã®å ´åˆã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§Nullã«ãªã‚‰ãªã„ã‚ˆã†ã«åˆ¶ç´„ã‚’ã‹ã‘ã‚‰ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€å€¤ãŒæƒ³å®šé€šã‚Šã®çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã‹ã‚’æ”¹ã‚ã¦æ¤œè¨¼ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ ãƒ»å¿…è¦ãªå ´åˆ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®å€¤ã‚’ç›´æ¥è¡¨ç¤ºã™ã‚‹å ´åˆã¨ç•°ãªã‚Šã€æ–°ã—ãä½œã‚‰ã‚Œã‚‹å€¤ã‚’ç”¨ã„ã‚‹å ´åˆã€ãã®å€¤ãŒæƒ³å®šå¤–ã®çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ãã®ãŸã‚ã€å€¤ãŒæƒ³å®šé€šã‚Šã®çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚æ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦ã¯ã€å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ æ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨æ¤œè¨¼ãƒ¡ã‚½ãƒƒãƒ‰ã®å¯¾å¿œ ã€‡ï¼šTRUE âœ•ï¼šFALSE ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®æ¤œè¨¼ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_logic_validation.html æ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ isset($var)ã€!is_null($var) if($var)ã€!empty($var) null âœ• âœ• 0 ã€‡ âœ• 1 ã€‡ ã€‡ \"\"ï¼ˆç©ºæ–‡å­—ï¼‰ ã€‡ âœ• \"ã‚\" ã€‡ ã€‡ array(0) ã€‡ âœ• array(1) ã€‡ ã€‡ ä½¿ã„ã©ã“ã‚ nullã ã‘ã‚’æ¤œè¨¼ã—ãŸã„å ´åˆ nullã€0ã€\"\"ã€[]ã‚’æ¤œè¨¼ã—ãŸã„å ´åˆ 02. æ¡ä»¶å¼ if-elseif-else ã€switch-case-break ï¼Šå®Ÿè£…ä¾‹ï¼Š æ›œæ—¥ã‚’æ¤œè¨¼ã—ã€æ–‡å­—åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ãƒ»if-elseif-else ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»switch-case-break å®šæ•°ã”ã¨ã«å‡¦ç†ãŒå¤‰ã‚ã‚‹æ™‚ã€ã“ã¡ã‚‰ã®æ–¹ãŒå¯èª­æ€§ãŒé«˜ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š if-elseã®å›é¿æ–¹æ³• ãƒ»if-elseã‚’ç”¨ã„ãŸå ´åˆ å¯èª­æ€§ãŒæ‚ªã„ãŸã‚ã€é¿ã‘ã‚‹ã¹ãã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š routeEntity->options)) { foreach ($this->routeEntity->options as $option) { // ifæ–‡ã‚’é€šéã—ãŸå ´åˆã€ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ // é€šéã—ãªã„å ´åˆã€å®šæ•°ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ if ($option->isOptionItemA()) { $result[\"optionItemA\"] = $option->optionItemA(); } else { $result[\"optionItemA\"] = self::noOptionItem; } if ($option->isOptionItemB()) { $result[\"optionItemB\"] = $option->optionItemB(); } else { $result[\"optionItemB\"] = self::noOptionItem; } if ($option->isOptionItemC()) { $result[\"optionItemC\"] = $option->optionItemC(); } else { $result[\"optionItemC\"] = self::noOptionItem; } } } return $result; } } ãƒ»ä¸‰é …æ¼”ç®—å­ã‚’ç”¨ã„ãŸå ´åˆ ã‚ˆã‚Šã™ã£ãã‚Šã—ãŸæ›¸ãæ–¹ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š routeEntity->options)) { foreach ($this->routeEntity->options as $option) { // ifæ–‡ã‚’é€šéã—ãŸå ´åˆã€ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ // é€šéã—ãªã„å ´åˆã€å®šæ•°ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ $result[\"optionItemA\"] = ($option->isOptionItemA()) ? $option->optionItemA() : self::noOptionItem; $result[\"optionItemB\"] = ($option->isOptionItemB()) ? $option->optionItemB() : self::noOptionItem; $result[\"optionItemC\"] = ($option->isOptionItemC()) ? $option->optionItemC() : self::noOptionItem; }; } return $result; } } ãƒ»åˆæœŸå€¤ã¨ä¸Šæ›¸ãã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç”¨ã„ãŸå ´åˆ ã‚ˆã‚Šã™ã£ãã‚Šã—ãŸæ›¸ãæ–¹ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š routeEntity->options)) { foreach ($this->routeEntity->options as $option) { // ifæ–‡ã‚’é€šéã—ãŸå ´åˆã€ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ã«ã‚ˆã£ã¦åˆæœŸå€¤0ãŒä¸Šæ›¸ãã•ã‚Œã‚‹ã€‚ // é€šéã—ãªã„å ´åˆã€åˆæœŸå€¤0ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ if ($option->isOptionItemA()) { $result[\"optionItemA\"] = $option->optionItemA(); } if ($option->isOptionItemB()) { $result[\"optionItemB\"] = $option->optionItemB(); } if ($option->isOptionItemC()) { $result[\"optionItemC\"] = $option->optionItemC(); } }; } return $result; } } if-elseif-elseã®å›é¿æ–¹æ³• ãƒ»æ±ºå®šè¡¨ã‚’ç”¨ã„ãŸæ¡ä»¶åˆ†å²ã®æ•´ç† ï¼Šå®Ÿè£…ä¾‹ï¼Š ã†ã‚‹ã†å¹´ã§ã‚ã‚‹ã‹ã‚’æ¤œè¨¼ã—ã€æ–‡å­—åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§è¨­è¨ˆã¨å®Ÿè£…ã‚’è¡Œã†ã€‚ æ¡ä»¶åˆ†å²ã®å‡¦ç†é †åºã®æ¦‚è¦ã‚’æ—¥æœ¬ã§è¨˜è¿°ã™ã‚‹ã€‚ è¨˜è¿°å†…å®¹ã‚’ã€æ¡ä»¶éƒ¨ã¨å‹•ä½œéƒ¨ã«åˆ†è§£ã—ã€æ±ºå®šè¡¨ã§è¡¨ã™ã€‚ æ±ºå®šè¡¨ã‚’ã€æµã‚Œå›³ã§è¡¨ã™ã€‚ ãƒ»if-elseif-elseã¯ç”¨ã„ãªã„ å¯èª­æ€§ãŒæ‚ªã„ãŸã‚ã€é¿ã‘ã‚‹ã¹ãã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ifã¨returnã‚’ç”¨ã„ãŸæ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ å„ifæ–‡ã§returnã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ifãŒå…¥ã‚Œå­çŠ¶ã«ãªã‚‹ã“ã¨ã‚’é˜²ã’ã‚‹ã€‚ã“ã‚Œã‚’ã€æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã¨ã‚‚ã„ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»switch-case-breakã‚’ç”¨ã„ãŸæ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ ifæ–‡ã®ä»£ã‚ã‚Šã«ã€switch-case-breakã«ã‚ˆã£ã¦ã€å®Ÿè£…ã«ã€ã€â—¯â—¯ã®å ´åˆã«åˆ‡ã‚Šæ›ãˆã‚‹ã€ã¨ã„ã†æ„å‘³åˆã„ã‚’æŒãŸã›ã‚‰ã‚Œã‚‹ã€‚ã“ã“ã§ã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã€breakã§ã¯ãªãreturnã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ã‚¬ãƒ¼ãƒ‰ç¯€ã‚’ç”¨ã„ãŸæ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã®ifæ–‡ã®æ³¢æ‹¬å¼§ã‚’çœç•¥ã—ãŸè¨˜æ³•ã‚’ã€ã‚¬ãƒ¼ãƒ‰ç¯€ã¨ã„ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 02-02. ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ¤œè¨¼ ç­‰ä¾¡æ¼”ç®—å­ ãƒ»ã‚¤ã‚³ãƒ¼ãƒ«ãŒ2ã¤ã®å ´åˆ åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰åˆ¥ã€…ã«ä½œã‚‰ã‚ŒãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚ã£ã¦ã‚‚ã€ã€åŒã˜ã‚‚ã®ã€ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ã‚¤ã‚³ãƒ¼ãƒ«ãŒ3ã¤ã®å ´åˆ åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰åˆ¥ã€…ã«ä½œã‚‰ã‚ŒãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚ã£ã¦ã‚‚ã€ã€ç•°ãªã‚‹ã‚‚ã®ã€ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š åŒä¸€ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å ´åˆã®ã¿ã€ã€åŒã˜ã‚‚ã®ã€ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š "},"public/software/software_application_object_oriented_language_php_logic_error_and_error_handling.html":{"url":"public/software/software_application_object_oriented_language_php_logic_error_and_error_handling.html","title":"ğŸ“– ï¸ã‚¨ãƒ©ãƒ¼ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°","keywords":"","body":"ã‚¨ãƒ©ãƒ¼ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚¨ãƒ©ãƒ¼ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° ã‚¨ãƒ©ãƒ¼ã¨ã¯ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡ŒãŒå¼·åˆ¶åœæ­¢ã•ã‚Œã‚‹ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ï¼ˆå®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ï¼‰ã€åœæ­¢ã›ãšã«ç¶šè¡Œã•ã‚Œã‚‹éãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã€ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã¯ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ä»¥ä¸‹ã®ï¼”ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰ãªã‚‹ã€‚ ã‚¨ãƒ©ãƒ¼æ¤œå‡º ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒ ãƒ­ã‚®ãƒ³ã‚° 01-02. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ„ç¾© ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¨ã£ã¦ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°ç³»ã®å‡¦ç†ã®é€”ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒä¸­é€”åŠç«¯ãªæ›´æ–°çŠ¶æ…‹ã«ãªã£ã¦ã—ã¾ã†ã€‚ãã®ãŸã‚ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã—ãŸã‚¯ãƒ©ã‚¹ã§ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºã—ã€ã“ã‚Œã‚’ãã£ã‹ã‘ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãªãŠã€ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã®ã‚¨ãƒ©ãƒ¼ã®å†…å®¹è‡ªä½“ã¯æ¡ã‚Šã¤ã¶ã•ãšã«ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ã—ã¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã—ãŸã‚¯ãƒ©ã‚¹ã§ãƒ­ã‚®ãƒ³ã‚°ã—ã¦ãŠãã€‚ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…ã«ã¨ã£ã¦ ã‚¨ãƒ©ãƒ¼ãŒç”»é¢ä¸Šã«è¿”å´ã•ã‚ŒãŸã¨ã—ã¦ã‚‚ã€ã“ã‚Œã¯ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…ã«ã¨ã£ã¦ã‚ã‹ã‚Šã«ãã„ã€‚ãã®ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã—ãŸã‚¯ãƒ©ã‚¹ã§æ¤œå‡ºã—ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…ã«ã‚ã‹ã‚‹è¨€è‘‰ã«å¤‰æ›ã—ãŸä¾‹å¤–ã¨ã—ã¦ã‚¹ãƒ­ãƒ¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãªãŠã€ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã®ã‚¨ãƒ©ãƒ¼è‡ªä½“ã¯æ¡ã‚Šã¤ã¶ã•ãšã«ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ã—ã¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã—ãŸã‚¯ãƒ©ã‚¹ã§ãƒ­ã‚®ãƒ³ã‚°ã—ã¦ãŠãã€‚ ãƒ¦ãƒ¼ã‚¶ã«ã¨ã£ã¦ ã‚¨ãƒ©ãƒ¼ãŒç”»é¢ä¸Šã«è¿”å´ã•ã‚ŒãŸã¨ã—ã¦ã‚‚ã€ãƒ¦ãƒ¼ã‚¶ã«ã¨ã£ã¦ã¯ä½•ãŒèµ·ãã¦ã„ã‚‹ã®ã‹ã‚ã‹ã‚‰ãªã„ã€‚ã¾ãŸã€ã‚¨ãƒ©ãƒ¼ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã—ãŸã‚¯ãƒ©ã‚¹ã§æ¤œå‡ºã—ã€ä¾‹å¤–ã¨ã—ã¦ã‚¹ãƒ­ãƒ¼ã—ãŸã¨ã—ã¦ã‚‚ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…ã«ã¨ã£ã¦ã¯ç†è§£ã§ãã‚‹ãŒã€ãƒ¦ãƒ¼ã‚¶ã«ã¨ã£ã¦ã¯ç†è§£ã§ããªã„ã€‚ãã®ãŸã‚ã€ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã‚’åˆ¥ã®è­˜åˆ¥å­ï¼ˆä¾‹ãˆã°çœŸå½å€¤ï¼‰ã«å¤‰ãˆã¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã—ãŸã‚¯ãƒ©ã‚¹ã«æŒã¡ä¸Šã’ã€æœ€çµ‚çš„ã«ã¯ã€ã“ã‚Œã‚’ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãªã©ã§ã‚ã‹ã‚Šã‚„ã™ãé€šçŸ¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã‚Œã‚‰ã¯ã€ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã®try-catch-finallyæ–‡ã‚„ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—å‡¦ç†ã§å®Ÿç¾ã™ã‚‹ã€‚ãªãŠã€ä¸‹æµã‚¯ãƒ©ã‚¹ã®ã‚¨ãƒ©ãƒ¼è‡ªä½“ã¯æ¡ã‚Šã¤ã¶ã•ãšã«ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ã—ã¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã—ãŸã‚¯ãƒ©ã‚¹ã§ãƒ­ã‚®ãƒ³ã‚°ã—ã¦ãŠãã€‚ 01-03. ä¾‹å¤–ã®å®šç¾© æ¨™æº–ä¾‹å¤–ã‚¯ãƒ©ã‚¹ ã„ãšã‚Œã‚‚Throwableã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã€‚ä»¥ä¸‹ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://www.php.net/manual/ja/reserved.exceptions.php ç‹¬è‡ªä¾‹å¤–ã‚¯ãƒ©ã‚¹ ãƒ»å®šç¾© ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã«åˆã‚ã›ã¦ã€Exceptionã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ãŸç‹¬è‡ªä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ã€ä½¿ã„åˆ†ã‘ã‚‹ã¨ã‚ˆã„ã€‚__constructãƒ¡ã‚½ãƒƒãƒ‰ã«ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹å¤–ã‚³ãƒ¼ãƒ‰ï¼‰ãªã©ã‚’æ¸¡ã›ã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã®æ¨™æº–å€¤ã¯ã‚¼ãƒ­ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.php.net/manual/ja/exception.construct.php ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ç•°ãªã‚Šã€ä¾‹å¤–ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã‚ã‚‹ã€‚ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚æ··ä¹±ã‚’é¿ã‘ã‚‹ãŸã‚ã€ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã®ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å€¤ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å‰²ã‚Šå½“ã¦ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ãŠã‘ã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‡¦ç†ã§å‰²ã‚Šå½“ã¦ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html ï¼Šå®Ÿè£…ä¾‹ï¼Š ã€Fooå¤‰æ•°ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã«å¯¾å¿œã™ã‚‹ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚ ãƒ»å‘½åè¦å‰‡ ä½•ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã‹ã‚’åˆ¤æ–­ã§ãã‚‹ã‚ˆã†ã«ã€åå‰ã¯ã€Exceptionã€ã¨ã™ã‚‹ã€‚ã¾ãŸã€é–‹ç™ºè€…ã«ã¨ã£ã¦è©³ã—ãç†è§£ã§ãã‚‹ã‚ˆã†ã«ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¸¡ã™ã€‚ ï¼ˆä¾‹ï¼‰InvalidArgumentExceptionã€ å‚è€ƒï¼šhttps://bartlomiej-kielbasa.medium.com/how-to-name-exceptions-its-not-so-obvious-df104014166a 02. ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã¨ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã¨ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã®ç¨®é¡ ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®æ¨™æº–æ©Ÿèƒ½ å¤šãã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã¯ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã‚„éãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã¨ã€ãã‚Œã‚’æ¤œçŸ¥ã—ã¦ã€ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã—ã¦ãã‚Œã‚‹ã€‚ ãƒ»ç‹¬è‡ªå®šç¾© if-throwæ–‡ã‚’ç”¨ã„ã¦ã€ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã¨ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã¯æ¤œå‡ºã§ããªã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ç‰¹å®šã®å‡¦ç†ã®ä¸­ã«ã€æƒ³å®šã§ãã‚‹ä¾‹å¤–ãŒã‚ã‚Šã€ãã‚Œã‚’ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã¨ã—ã¦ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ã“ã“ã§ã¯ã€å…¨ã¦ã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã®è¦ªã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹Exceptionã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æŠ•ã’ã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãŸã ã—ã€if-throwã§ã¯ã€éƒ½åº¦ä¾‹å¤–ã‚’æ¤œè¨¼ã™ã‚‹ãŒã‚ã‚Šã€æ§˜ã€…ãªå¯èƒ½æ€§ã‚’è€ƒæ…®ã—ãªã‘ã‚Œã°ã„ã‘ãªããªã‚‹ã€‚ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹å±¤åˆ¥ã®ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ å±¤åˆ¥ã®ä¾‹å¤–ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design.html 03. ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒ ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒã®æ–¹æ³• ãƒ»try-catch-finallyæ–‡ã¨ã¯ try-catch-finallyæ–‡ã§ã¯ã€ç‰¹å®šã®å‡¦ç†ã®ä¸­ã§èµ·ã“ã‚‹æƒ³å®šã§ããªã„ä¾‹å¤–ã‚’æ‰ãˆã‚‰ã‚Œã‚‹ã€‚å®šç¾©ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼æ–‡ã¯ã€ãƒ‡ãƒãƒƒã‚¯ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š finallyå¥ã¯ã€tryå¥ã‚„catchå¥ã®è¿”å´å‡¦ç†ãŒè¡Œã‚ã‚Œã‚‹ç›´å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€finallyå¥ã§ã¯ã€returnã‚„continueã‚’ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼ˆï¼‘ï¼‰ï½ï¼ˆï¼”ï¼‰ã®ã„ãšã‚Œã‹ã§è¿”å´ã•ã‚Œã‚‹æ™‚ã€è¿”å´ã®ç›´å‰ã«finallyå¥ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ // ï¼ˆï¼‘ï¼‰ã®å ´åˆ // Aã®ç›´å‰ã§ã™ã€‚ // Eã§ã™ã€‚ // Aã§ã™ã€‚ // ï¼ˆï¼’ï¼‰ã®å ´åˆ // Bã®ç›´å‰ã§ã™ã€‚ // Eã§ã™ã€‚ // Bã§ã™ã€‚ // ï¼ˆï¼“ï¼‰ã®å ´åˆ // Cã®ç›´å‰ã§ã™ã€‚ // Eã§ã™ã€‚ // Cã§ã™ã€‚ // ï¼ˆï¼”ï¼‰ã®å ´åˆ // Dã®ç›´å‰ã§ã™ã€‚ // Eã§ã™ã€‚ // Dã§ã™ã€‚ æ–°ãŸãªä¾‹å¤–ã®ã‚¹ãƒ­ãƒ¼ã—ç›´ã— ä¾‹å¤–ã‚’try-catchæ–‡ã§ã‚­ãƒ£ãƒƒãƒã—ãŸå¾Œã€åˆ¥ã®æ–°ã—ã„ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã—ã¦ã‚‚ã‚ˆã„ã€‚ãã®å ´åˆã¯ã€ä¾‹å¤–ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ç¬¬ä¸‰å¼•æ•°ï¼ˆpreviousï¼‰ã‚’ç”¨ã„ã¦ã€å…ƒã€…ã‚­ãƒ£ãƒƒãƒã•ã‚Œã¦ã„ãŸä¾‹å¤–ã‚‚æ¤œçŸ¥ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã¡ãªã¿ã«ã€ã“ã®ä¾‹å¤–ã‚’ãƒ­ã‚®ãƒ³ã‚°ã™ã‚‹å ´åˆã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ­ã‚°ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š http://blog.tojiru.net/article/455279557.html https://www.php.net/manual/ja/exception.construct.php ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ ãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ï¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢æ´¾ æƒ³å®šå¤–ã®ã‚¨ãƒ©ãƒ¼ã‚‚å«ã‚ã¦ã€å…¨ã¦ã®ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºã§ãã‚‹ã‚ˆã†ã«ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¾ãŸã¯ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«try-catchæ–‡ã‚’å®Ÿè£…ã™ã‚‹ã€‚ å‚è€ƒï¼š https://www.reddit.com/r/dotnet/comments/kyoe83/web_api_trycatch_in_controller_or_not/ https://softwareengineering.stackexchange.com/questions/393307/where-would-you-handle-exceptions-controller-service-repository ãƒ»ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹æ´¾ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®å®Ÿè£…ã‚’ã‚ˆã‚Šå˜ç´”ã«ã™ã‚‹ã¹ãã€ã‚ˆã‚Šä¸‹ä½ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«try-catchæ–‡ã‚’å®Ÿè£…ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.reddit.com/r/dotnet/comments/kyoe83/web_api_trycatch_in_controller_or_not/ 04. ãƒ­ã‚®ãƒ³ã‚° ãƒ­ã‚®ãƒ³ã‚°é–¢æ•° ãƒ»error_logé–¢æ•° å‚è€ƒï¼šhttps://www.php.net/manual/ja/function.error-log.php error_log( \"\", \"\", \"\" ) ï¼Šå®Ÿè£…ä¾‹ï¼Š getMessage(), $exception->getFile(), $exception->getLine() ), 3, __DIR__ . \"/error.log\" ); } } } ä»–ã«ã€Loggerã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ç”¨ã„ã‚‹ã“ã¨ã‚‚å¤šã„ã€‚ å‚è€ƒï¼šhttps://github.com/php-fig/log logger = $logger; } public function sendMessage() { try { // ä¸‹æµã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã‚’å«ã‚€å‡¦ç† } catch (\\exception $exception) { $this->logger->error(sprintf( \"ERROR: %s at %s line %s\", $exception->getMessage(), $exception->getFile(), $exception->getLine() )); } } } ãƒ­ã‚®ãƒ³ã‚°ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ try-catchæ–‡ã«ä¼´ã†ãƒ­ã‚®ãƒ³ã‚°ã®å ´åˆã€catchå¥ã®ä¸­ã§ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãã®ãŸã‚ã€ãƒ­ã‚®ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯tray-catchæ–‡ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨åŒã˜ã«ãªã‚‹ã€‚ ç¨®é¡åˆ¥ã®æŒ¯ã‚Šåˆ†ã‘ ãƒ»ä¾‹å¤–ã”ã¨ã®ãƒ­ã‚®ãƒ³ã‚° ä¾‹ãˆã°ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¢ãƒ—ãƒªã®APIã«å¯¾ã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹æ™‚ã€ä¾‹å¤–ã®ç¨®é¡ã«åˆã‚ã›ã¦ã€å¤–éƒ¨APIã¨ã®æ¥ç¶šå¤±æ•—ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç”Ÿæˆã¨ã€è‡ªç¤¾ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãªã©ãã®ä»–åŸå› ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç”Ÿæˆã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š logger->error(sprintf( \"ERROR: %s at %s line %s\", $exception->getMessage(), $exception->getFile(), $exception->getLine() )); } catch (\\ExternalApiErrorException $exception) { // ä¸‹æµã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã‚’å«ã‚€å‡¦ç† // å¤–éƒ¨APIã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¨ãƒ©ãƒ¼ã‚’ãƒ­ã‚®ãƒ³ã‚° $this->logger->error(sprintf( \"ERROR: %s at %s line %s\", $exception->getMessage(), $exception->getFile(), $exception->getLine() )); } catch (\\Exception $exception) { // ä¸‹æµã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã‚’å«ã‚€å‡¦ç† // ãã®ä»–ï¼ˆè‡ªç¤¾ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãªã©ï¼‰ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ã‚’ãƒ­ã‚®ãƒ³ã‚° $this->logger->error(sprintf( \"ERROR: %s at %s line %s\", $exception->getMessage(), $exception->getFile(), $exception->getLine() )); } // å•é¡Œãªã‘ã‚Œã°TRUEã‚’è¿”å´ã€‚ return true; } } "},"public/software/software_application_object_oriented_language_php_logic_iteration.html":{"url":"public/software/software_application_object_oriented_language_php_logic_iteration.html","title":"ğŸ“– ï¸åå¾©ãƒ­ã‚¸ãƒƒã‚¯","keywords":"","body":"åå¾©ãƒ­ã‚¸ãƒƒã‚¯ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. åå¾©å¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ é…åˆ— ãƒ»èµ°æŸ»ï¼ˆã‚¹ã‚­ãƒ£ãƒ³ï¼‰ é…åˆ—å†…ã®è¦ç´ ã‚’é †ã«èª¿ã¹ã¦ã„ãã“ã¨ã‚’ã€èµ°æŸ»ï¼ˆã‚¹ã‚­ãƒ£ãƒ³ï¼‰ã€ã¨ã„ã†ã€‚ä¾‹ãˆã°ã€foreachã¯ã€é…åˆ—å†…ã®å…¨ã¦ã®è¦ç´ ã‚’èµ°æŸ»ã™ã‚‹å‡¦ç†ã§ã‚ã‚‹ã€‚ä¸‹å›³ã§ã¯ã€é€£æƒ³é…åˆ—ãŒè¡¨ç¾ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»å†…éƒ¨ãƒã‚¤ãƒ³ã‚¿ã¨é…åˆ—ã®é–¢ä¿‚ ã€å†…éƒ¨ãƒã‚¤ãƒ³ã‚¿ã€ã¨ã¯ã€PHPã®é…åˆ—ã«ãŠã„ã¦ã€å‚ç…§ã—ãŸã„è¦ç´ ã‚’ä½ç½®ã§æŒ‡å®šã™ã‚‹ãŸã‚ã®ã‚«ãƒ¼ã‚½ãƒ«ã®ã“ã¨ã€‚Goã«ãŠã‘ã‚‹ãƒã‚¤ãƒ³ã‚¿ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_procedural_language_go_logic_method_data.html ï¼Šå®Ÿè£…ä¾‹ï¼Š 02. foreach æ–‡æ³• ãƒ»åŸºæœ¬ é…åˆ—ã‚’èµ°æŸ»ã™ã‚‹ã€‚ ãƒ»åˆ¶å¾¡æ–‡ 0) { $sum += $x; } } ä¸€æ¬¡å…ƒé…åˆ—ã®èµ°æŸ» ãƒ»é…åˆ—é–¢æ•° è¤‡é›‘ãªèµ°æŸ»ã‚’è¡Œã†ãŸã‚ã«ã€çµ„ã¿è¾¼ã¿é–¢æ•°ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ https://www.php.net/manual/ja/ref.array.php ãƒ»é…åˆ—ã®å€¤ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ å˜ã«é…åˆ—ã‚’ä½œã‚‹ã ã‘ã§ãªãã€è¦ç´ ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ã‚ã‚Œã‚‹ã€‚ name() == 'ã‚ªãƒ—ã‚·ãƒ§ãƒ³A') { $result = 'ã‚ªãƒ—ã‚·ãƒ§ãƒ³AãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚'; } if ($option->name() == 'ã‚ªãƒ—ã‚·ãƒ§ãƒ³B') { $result = 'ã‚ªãƒ—ã‚·ãƒ§ãƒ³BãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚'; } if ($option->name() == 'ã‚ªãƒ—ã‚·ãƒ§ãƒ³C') { $result = 'ã‚ªãƒ—ã‚·ãƒ§ãƒ³CãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚'; } return $result; } return $result; } } ãƒ»é…åˆ—ã®å„å€¤ã‚’åŠ ç®—ä»£å…¥ = $K) { // åŠ ç®—ä»£å…¥ $topesNumber++; // é•·ã•ã‚’å…ƒã«æˆ»ã™ã€‚ $currentLength = 0; } } } ãƒ»é…åˆ—ã®å€¤ã‚’å›ºå®š $value) { // vã‚’å›ºå®šã—ã¦ã€ä»¥é™ã®vã¨æ¯”è¼ƒã™ã‚‹ã€‚ for ($i = $key; $i å¤šæ¬¡å…ƒé…åˆ—ã®èµ°æŸ» ãƒ»äºŒæ¬¡å…ƒé…åˆ—ã‚’ä¸€æ¬¡å…ƒé…åˆ—ã«å¤‰æ› ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®ä½¿ç”¨ãŒå¿…è¦ã«ãªã‚‹ã€‚call_user_func_arrayãƒ¡ã‚½ãƒƒãƒ‰ã®ç¬¬ä¸€å¼•æ•°ã«ã€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®array_mergeãƒ¡ã‚½ãƒƒãƒ‰ã®æ–‡å­—åˆ—ã‚’æ¸¡ã—ã€ç¬¬äºŒå¼•æ•°ã«äºŒæ¬¡å…ƒé…åˆ—ã‚’æ¸¡ã™ã€‚ãã®çµæœã€å¹³å¦ã«ãªã£ã¦ä¸€æ¬¡å…ƒé…åˆ—ã«ãªã‚‹ã€‚ä¾‹ãˆã°ã€ä¸è¦ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ0ï¼‰ã§å…¥ã‚Œå­ã«ãªã£ã¦ã„ã‚‹å ´åˆã«å½¹ã«ç«‹ã¤ã€‚ '2015/11/1', 'score' => 100, 'color' => 'red', ], [ 'date' => '2015/11/2', 'score' => 75, 'color' => 'blue', ] ]; $oneDimension = call_user_func_array( 'array_merge', // äºŒæ¬¡å…ƒé…åˆ— $twoDimension ); ãƒ»å¤šæ¬¡å…ƒé…åˆ—ã§ã‚­ãƒ¼åã‹ã‚‰å€¤ã‚’å–å¾— ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå¤šæ¬¡å…ƒé…åˆ—ãŒã‚ã£ãŸã¨ã™ã‚‹ã€‚é…åˆ—ã®scoreã‚­ãƒ¼ã‹ã‚‰å€¤ã‚’å–ã‚Šå‡ºã—ã€ä¸€æ¬¡å…ƒé…åˆ—ã‚’ç”Ÿæˆã™ã‚‹ã€‚ '2015/11/1', 'score' => 100, 'color' => 'red', ], [ 'date' => '2015/11/2', 'score' => 75, 'color' => 'blue', ] ]; // ã“ã®é…åˆ—ã®scoreã‚­ãƒ¼ã‹ã‚‰å€¤ã‚’å–ã‚Šå‡ºã—ã€ä¸€æ¬¡å…ƒé…åˆ—ã‚’ç”Ÿæˆã™ã‚‹ã€‚ $oneDimension = array_column($twoDimension, 'score'); // Array // ( // [0] => 100 // [1] => 75 // ) 03. while æ–‡æ³• ãƒ»åŸºæœ¬ é…åˆ—ã®èµ°æŸ»ã‚’å«ã‚€åå¾©å‡¦ç†ã‚’è¡Œã†ã€‚ãŸã ã—ã€é…åˆ—ã®èµ°æŸ»ã¯ã€whileã§ã¯ãªãforeachã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã¾ãŸã€forã¨ã¯ç•°ãªã‚Šã€åå¾©å›æ•°ãŒæ±ºã¾ã£ã¦ã„ãªã„å ´åˆã«ç”¨ã„ã‚‹ã€‚ ãƒ»åˆ¶å¾¡æ–‡ 0) { $sum += $x; } // ä»£å…¥åŠ ç®— $count ++; } ç„¡é™ãƒ«ãƒ¼ãƒ— ãƒ»ç„¡é™ãƒ«ãƒ¼ãƒ—ã¨ã¯ åå¾©å‡¦ç†ã§ã¯ã€ä½•ã‚‰ã‹ã®çŠ¶æ…‹ã«ãªã£ãŸæ™‚ã«åå¾©å‡¦ç†ã‚’çµ‚ãˆãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã—ã‹ã—ã€çµ‚ãˆã‚‰ã‚Œãªã„ã¨ã€ç„¡é™ãƒ«ãƒ¼ãƒ—ãŒç™ºç”Ÿã—ã¦ã—ã¾ã†ã€‚ 04. for æ–‡æ³• ãƒ»åŸºæœ¬ é…åˆ—ã®èµ°æŸ»ã‚’å«ã‚€åå¾©å‡¦ç†ã‚’è¡Œã†ã€‚ãŸã ã—ã€é…åˆ—ã®èµ°æŸ»ã¯ã€forã§ã¯ãªãforeachã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã¾ãŸã€whileã¨ã¯ç•°ãªã‚Šã€åå¾©å›æ•°ãŒæ±ºã¾ã£ã¦ã„ã‚‹å ´åˆã«ç”¨ã„ã‚‹ã€‚ ãƒ»åˆ¶å¾¡æ–‡ 0) { $sum += $x; } } echo $sum; // 1 05. åå¾©å›æ•°ã®å¤‰æ›´ continue ãƒ»continueã¨ã¯ åå¾©å‡¦ç†ã®ç¾åœ¨ã®ãƒ«ãƒ¼ãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã€æ¬¡ã®ãƒ«ãƒ¼ãƒ—ã‚’é–‹å§‹ã™ã‚‹ã€‚ $value) { // ã‚­ãƒ¼ãŒå¶æ•°ã®çµ„ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã€‚ if (!($key % 2 == 0)) { continue; } echo $value . 'ã¯å¥‡æ•°ã§ã™' . \"\\n\"; } // 1ã¯å¥‡æ•°ã§ã™ // 3ã¯å¥‡æ•°ã§ã™ // 5ã¯å¥‡æ•°ã§ã™ ãƒ»array_walkã‚’ç”¨ã„ãŸä»£æ›¿æ³• åå¾©å‡¦ç†ã®ãƒ«ãƒ¼ãƒ—ã‚’continueã§ã‚¹ã‚­ãƒƒãƒ—ã¨åŒã˜å‹•ä½œã‚’ã€é…åˆ—ã‚’æ‰±ã†é–¢æ•°ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã§å®Ÿç¾ã§ãã‚‹ã€‚continueã‚’ç”¨ã„ã‚‹ã‚ˆã‚Šã€ã“ã¡ã‚‰ã®æ–¹ãŒè‰¯ã„ã€‚ break ãƒ»breakã¨ã¯ åå¾©å‡¦ç†ã®ç¾åœ¨ã®ãƒ«ãƒ¼ãƒ—ã‚’åœæ­¢ã—ã€ä»¥é™ã®ãƒ«ãƒ¼ãƒ—ã‚‚å®Ÿè¡Œã—ãªã„ã€‚ "},"public/software/software_application_object_oriented_language_php_logic_algorithm.html":{"url":"public/software/software_application_object_oriented_language_php_logic_algorithm.html","title":"ğŸ“– ï¸ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ","keywords":"","body":"ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒ­ã‚¸ãƒƒã‚¯ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ä¸¦ã³æ›¿ãˆã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ä¾‹ãˆã°ã€æ¬¡ã®ã‚ˆã†ãªè¡¨ã§ã¯ã€ã©ã®ã‚ˆã†ãªä»•çµ„ã¿ã§ã€æ˜‡é †ã€ã€é™é †ã€ã¸ã®ä¸¦ã³æ›¿ãˆãŒè¡Œã‚ã‚Œã‚‹ã®ã ã‚ã†ã‹ã€‚ åŸºæœ¬é¸æŠæ³•ï¼ˆé¸æŠã‚½ãƒ¼ãƒˆï¼‰ ãƒ»æœ€å°é¸æŠæ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¯”è¼ƒåŸºæº–å€¤ã‚’æ±ºã‚ã‚‹ã€‚ æœ€åˆã®æ•°å€¤ã‚’æ¯”è¼ƒåŸºæº–å€¤ã¨ã—ã€nå€‹ã®ä¸­ã‹ã‚‰æœ€ã‚‚å°ã•ã„æ•°å­—ã‚’æ¢ã—ã€ãã‚Œã¨å…¥ã‚Œæ›¿ãˆã‚‹ã€‚ æ¬¡ã«ã€æ®‹ã‚Šã®n-1å€‹ã®ä¸­ã‹ã‚‰æœ€ã‚‚å°ã•ã„æ•°å­—ã‚’æ¢ã—ã€ãã‚Œã‚’2ç•ªç›®ã®æ•°å­—ã¨å…¥ã‚Œæ›¿ãˆã‚‹ã€‚ ã“ã®å‡¦ç†ã‚’n-1å›ç¹°ã‚Šè¿”ã™ã€‚ $array[$j]){ $position = $j; $min = $array[$j]; } } // æ¯”è¼ƒåŸºæº–å€¤ã®ä½ç½®ãŒæ›´æ–°ã•ã‚Œã¦ã„ãªã‹ã£ãŸå ´åˆã€è¦ªã®foræ–‡ã‹ã‚‰æŠœã‘ã‚‹ã€‚ if($i == $position){ break; } // è¦ªã®foræ–‡ã®æœ€å°å€¤ã‚’æ›´æ–°ã€‚ $array[$i] = $min; // æ¬¡ã«2ç•ªç›®ã‚’æ¯”è¼ƒåŸºæº–å€¤ã¨ã—ã€åŒã˜å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ãã€‚ } return $array; } ï¼Šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è§£èª¬ï¼Š ãƒ‡ãƒ¼ã‚¿ä¸­ã®æœ€å°å€¤ã‚’æ±‚ã‚ã€æ¬¡ã«ãã‚Œã‚’é™¤ã„ãŸéƒ¨åˆ†ã®ä¸­ã‹ã‚‰æœ€å°å€¤ã‚’æ±‚ã‚ã‚‹ã€‚ã“ã®æ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ãã€‚ ã‚¯ã‚¤ãƒƒã‚¯ã‚½ãƒ¼ãƒˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š é©å½“ãªå€¤ã‚’åŸºæº–å€¤ï¼ˆPivotï¼‰ã¨ã™ã‚‹ ï¼ˆâ€»ã§ãã‚Œã°ä¸­å¤®å€¤ãŒæœ›ã¾ã—ã„ï¼‰ Pivotã‚ˆã‚Šå°ã•ã„æ•°ã‚’å‰æ–¹ã€å¤§ãã„æ•°ã‚’å¾Œæ–¹ã«åˆ†å‰²ã™ã‚‹ã€‚ äºŒåˆ†å‰²ã•ã‚ŒãŸå„ã€…ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã€ãã‚Œãã‚Œã‚½ãƒ¼ãƒˆã™ã‚‹ã€‚ ã‚½ãƒ¼ãƒˆã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è§£èª¬ï¼Š é©å½“ãªå€¤ã‚’åŸºæº–å€¤ï¼ˆPivotï¼‰ã¨ã—ã€ãã‚Œã‚ˆã‚Šå°ã•ãªå€¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã¨å¤§ããªå€¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†å‰²ã™ã‚‹ã€‚åŒæ§˜ã«ã—ã¦ã€ä¸¡ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸­ã§Pivotã‚’é¸ã³ã€äºŒã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†å‰²ã™ã‚‹ã€‚ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®å€¤ãŒä¸€ã¤ã«ãªã‚‹ã¾ã§ã€ã“ã®å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ãã€‚ åŸºæœ¬äº¤æ›æ³•ï¼ˆãƒãƒ–ãƒ«ã‚½ãƒ¼ãƒˆï¼‰ éš£ã‚Šåˆã£ãŸãƒ‡ãƒ¼ã‚¿ã®æ¯”è¼ƒã¨å…¥æ›¿ãˆã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ã«ã‚ˆã£ã¦ã€å°ã•ãªå€¤ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¬¡ç¬¬ã«ç«¯ã®ã»ã†ã«ç§»ã—ã¦ã„ãæ–¹æ³•ã€‚ åŸºæœ¬æŒ¿å…¥æ³•ï¼ˆæŒ¿å…¥ã‚½ãƒ¼ãƒˆï¼‰ æ—¢ã«æ•´åˆ—æ¸ˆã¿ã®ãƒ‡ãƒ¼ã‚¿åˆ—ã®æ­£ã—ã„ä½ç½®ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã™ã‚‹æ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ãæ–¹æ³•ã€‚ ãƒ’ãƒ¼ãƒ—ã‚½ãƒ¼ãƒˆ ã‚·ã‚§ãƒ«ã‚½ãƒ¼ãƒˆ 02. é…åˆ—å†…æ¢ç´¢ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ç·šå½¢æ¢ç´¢æ³• ä»Šå›ã¯ã€é…åˆ—å†…ã§ã€ï¼–ã€ã‚’æ¢ã™ã€‚ äºŒåˆ†æ¢ç´¢æ³• å‰æã¨ã—ã¦ã€ã‚½ãƒ¼ãƒˆã«ã‚ˆã£ã¦ã€ã™ã§ã«ãƒ‡ãƒ¼ã‚¿ãŒæ•´åˆ—ã•ã›ã‚‰ã‚Œã¦ã„ã‚‹ã¨ã™ã‚‹ã€‚ä»Šå›ã¯ã€é…åˆ—å†…ã§ã€ï¼–ã€ã‚’æ¢ã™ã€‚ 03. ã‚°ãƒ©ãƒ•æ¢ç´¢ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆé›£ã—éãã§è¨˜å…¥é€”ä¸­ï¼‰ ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã«ã‚ˆã‚‹æœ€è‰¯å„ªå…ˆæ¢ç´¢ ï¼Šå®Ÿè£…ä¾‹ï¼Š åœ°ç‚¹é–“ã®è·é›¢ã‚’è¡¨ã§è¡¨ã™ã€‚ãŸã ã—ã€åŒåœ°ç‚¹é–“ã®è·é›¢ã¯ã€0ã€ã€éš£ã‚Šåˆã‚ãªã„åœ°ç‚¹é–“ã®è·é›¢ã¯ã€-1ã€ã¨ã™ã‚‹ã€‚ array(0, 2, 8, 4, -1, -1, -1), \"P1\" => array(2, 0, -1, -1, 3, -1, -1), \"P2\" => array(8, -1, 0, -1, 2, 3, -1), \"P3\" => array(4, -1, -1, 0, -1, 8, -1), \"P4\" => array(-1, 3, 2, -1, 0, -1, 9), \"P5\" => array(-1, -1, 3, 8, -1, 0, 3), \"P6\" => array(-1, -1, -1, -1, 9, 3, 0) ); ï¼Šæœ€çŸ­çµŒè·¯æ¢ç´¢å‡¦ç†ã®è§£èª¬ï¼Š $startPoint = 0 $goalPoint = 6 ã¨ã—ãŸæ™‚ã€å‡ºç™ºåœ°ç‚¹ï¼ˆ0ï¼‰ã‹ã‚‰1ã‚¹ãƒ†ãƒƒãƒ—è¡Œã‘ã‚‹åœ°ç‚¹ã¾ã§ã®è·é›¢ï¼ˆpDistï¼‰ã‚’å–å¾—ã—ã€ç¢ºå®šã•ã›ã‚‹ã€‚ ï¼Šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è§£èª¬ï¼Š æ­£ã®ã‚³ã‚¹ãƒˆã®çµŒè·¯ã®ã¿ã®å ´åˆã€ç”¨ã„ã‚‰ã‚Œã‚‹æ–¹æ³•ã€‚ 04. èª¤ã‚Šæ¤œå‡ºã¨è¨‚æ­£ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  Check Digit Check ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚„ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ãªã©ã®èª­ã¿å–ã‚Šãƒã‚§ãƒƒã‚¯ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹èª¤ã‚Šæ¤œå‡ºæ–¹æ³•ã€‚ Check Digitã‚’ç®—å‡ºã™ã‚‹ã€‚ ç®—å‡ºã•ã‚ŒãŸCheck DigitãŒæ­£ã—ã„ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ Parity Check CRCï¼šCyclic Redundancy Checkï¼ˆå·¡å›å†—é•·æ¤œæŸ»ï¼‰ "},"public/software/software_application_object_oriented_language_php_framework_laravel.html":{"url":"public/software/software_application_object_oriented_language_php_framework_laravel.html","title":"ğŸ“– ï¸Laravel","keywords":"","body":"Laravel ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Laravelã®å…¨ä½“åƒ ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« å¤§ã¾ã‹ãªå‡¦ç†ãƒ•ãƒ­ãƒ¼ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://blog.albert-chen.com/the-integration-of-laravel-with-swoole-part-1/ ç”¨èª èª¬æ˜ 1 ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ã€‚ 2 index.phpãƒ•ã‚¡ã‚¤ãƒ« ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‹ã‚‰å‡¦ç†ãŒå§‹ã¾ã‚‹ã€‚ 3 Autoload autoload.phpãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è‡ªå‹•ã§ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚ 4 Load App bootstrap/app.phpãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ServiceContainerï¼ˆIlluminate\\Foundation\\Application.phpï¼‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ 5 Http Kernel Kernelã‚’å®Ÿè¡Œã™ã‚‹ã€‚ 6 ãƒ»Register ServiceProvidersãƒ»Boot Service Providers ServiceProviderã®registerãƒ¡ã‚½ãƒƒãƒ‰ã‚„bootãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ServiceContainerã«ã‚¯ãƒ©ã‚¹ãŒãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ã€‚ 7 Middleware BeforeMiddlewareã‚’å®Ÿè¡Œã™ã‚‹ã€‚ 8 ãƒ»Dispatch by Routerãƒ»Routes Match web.phpãƒ•ã‚¡ã‚¤ãƒ«ã€app.phpãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å®šç¾©ã‚’å…ƒã«ã€RouterãŒå®Ÿè¡Œã™ã‚‹ã€‚ 9 FormRequest ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ 10 Controller Controllerã‚’åŸºç‚¹ã¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¾ã§å‡¦ç†ãŒèµ°ã‚‹ã€‚ 11 Resource ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã—ãŸã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å‹ãƒ‡ãƒ¼ã‚¿ã‚’é…åˆ—å‹ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ã€‚ 12 Response Responseã‚’å®Ÿè¡Œã™ã‚‹ã€‚é…åˆ—å‹ãƒ‡ãƒ¼ã‚¿ã‚’JSONãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ã€‚ 13 Terminate Middleware AfterMiddlewareãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ 14 View bladeãƒ•ã‚¡ã‚¤ãƒ«ã«åŸºã¥ã„ã¦é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ 15 ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ Laravelã®å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã¯ã€ä¼¼ãŸã‚ˆã†ãªåå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå¤šãå†…è”µã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€åŒæ§˜ã®æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€å„ã€…ãŒç•°ãªã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ãŒã¡ã«ãªã‚‹ã€‚ãã®æ™‚ã€å„ãƒ¡ã‚½ãƒƒãƒ‰ãŒãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã€å‡¦ç†ã®é•ã„ã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate.html 02. Application App ãƒ»è¨­å®šæ–¹æ³• APP_NAME= APP_ENV= APP_KEY= APP_DEBUG= APP_URL= ãƒ»app.phpãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬è¨­å®š env(\"APP_NAME\", \"Laravel\"), // å®Ÿè¡Œç’°å¢ƒå \"env\" => env(\"APP_ENV\", \"production\"), // ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ‡ãƒãƒƒã‚°ç”»é¢ã®æœ‰åŠ¹åŒ– \"debug\" => (bool)env(\"APP_DEBUG\", false), // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®URL \"url\" => env(\"APP_URL\", \"http://localhost\"), // assetãƒ˜ãƒ«ãƒ‘ãƒ¼ã§ä»˜ä¸ã™ã‚‹URL \"asset_url\" => env(\"ASSET_URL\", null), // ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ \"timezone\" => \"UTC\", // è¨€èªè¨­å®š \"locale\" => \"ja\", \"fallback_locale\" => \"en\", \"faker_locale\" => \"ja_JP\", // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä½œæˆã‚„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æš—å·åŒ–ã«ä½¿ã†èªè¨¼ã‚­ãƒ¼ \"key\" => env(\"APP_KEY\"), // æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  \"cipher\" => \"AES-256-CBC\", // ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ \"providers\" => [ ], // ã‚¯ãƒ©ã‚¹åã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ \"aliases\" => [ ], ]; 03. Console Command artisanã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œå¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/artisan.html#writing-commands argument('bar'); // ä½•ã‚‰ã‹ã®ã‚³ãƒãƒ³ãƒ‰å‡¦ç† Log::info('END: artisan do-foo'); } } å®šç¾©ã—ãŸCommandã‚¯ãƒ©ã‚¹ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè¡Œã§ãã‚‹ã€‚ $ php artisan command:do-foo 04. Database ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š ãƒ»è¨­å®šæ–¹æ³• ç’°å¢ƒå¤‰æ•°ã‚’.envãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã™ã‚‹ã€‚database.phpãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€æŒ‡å®šã•ã‚ŒãŸè¨­å®šãŒé¸æŠã•ã‚Œã‚‹ã€‚ DB_CONNECTION= DB_HOST= DB_PORT= DB_DATABASE= DB_USERNAME= DB_PASSWORD= ãƒ»RDBã¨Redisã®é¸æŠ env(\"DB_CONNECTION\", \"mysql\"), \"connections\" => [ // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ï¼ˆSQLiteï¼‰ \"sqlite\" => [ ], // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ï¼ˆMySQLï¼‰ \"mysql\" => [ ], // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ï¼ˆpgSQLï¼‰ \"pgsql\" => [ ], // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ï¼ˆSQLSRVï¼‰ \"sqlsrv\" => [ ], ], // ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª \"migrations\" => \"migrations\", // Redisæ¥ç¶šæƒ…å ± \"redis\" => [ ], ]; Redis ãƒ»ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç† ç’°å¢ƒå¤‰æ•°ã‚’.envãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ CACHE_DRIVER=redis REDIS_HOST= REDIS_PASSWORD= REDIS_PORT= 05. Eloquentãƒ¢ãƒ‡ãƒ« artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»ã‚¯ãƒ©ã‚¹ã®è‡ªå‹•ç”Ÿæˆ $ php artisan make:model Active Recordãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ»Active Recordãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ãƒ¢ãƒ‡ãƒ«ãŒä¸€å¯¾ä¸€ã®é–¢ä¿‚ã«ãªã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã“ã¨ã€‚ã•ã‚‰ã«ã€ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ãŒãã®ã¾ã¾ãƒ¢ãƒ‡ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ã«ã‚‚åæ˜ ã•ã‚Œã‚‹ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ã§ãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹ç™ºã«é©ã—ã¦ã„ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã®ä¾å­˜é–¢ä¿‚ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based.html ãƒ»ãƒ¡ãƒªãƒƒãƒˆï¼ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ é …ç›® ãƒ¡ãƒªãƒƒãƒˆ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ ä¿å®ˆæ€§ ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒã€ãã®ã¾ã¾ãƒ¢ãƒ‡ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ã«ãªã‚‹ãŸã‚ã€ãƒ¢ãƒ‡ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ã‚’è€ƒãˆã‚‹å¿…è¦ãŒãªãã€é–‹ç™ºãŒæ—©ã„ã€‚ãã®ãŸã‚ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ã§ãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹ç™ºã«é©ã—ã¦ã„ã‚‹ã€‚ ãƒ»åå¯¾ã«ã€ãƒ¢ãƒ‡ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ã«ã‚ˆã£ã¦ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ±ºã¾ã‚‹ã€‚ãã®ãŸã‚ã€è¤‡é›‘ãªæ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ã§ãƒ¢ãƒ‡ãƒ«é–“ãŒè¤‡é›‘ãªä¾å­˜é–¢ä¿‚ã‚’æŒã¤ã¨ã€ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚è¤‡é›‘ã«ãªã£ã¦ã„ã£ã¦ã—ã¾ã†ã€‚ãƒ»ãƒ¢ãƒ‡ãƒ«ã«å¯¾å¿œã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã«é–¢ã—ã¦ã€å¿…è¦ãªã‚«ãƒ©ãƒ ã ã‘ã§ãªãã€å…¨ã¦ã®ã‚«ãƒ©ãƒ ã‹ã‚‰å–å¾—ã™ã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ä½™åˆ†ãªè² è·ãŒã‹ã‹ã‚‹ã€‚ æ‹¡å¼µæ€§ ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ¢ãƒ‡ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ã«ã‚ˆã£ã¦å®šç¾©ã•ã‚Œã¦ãŠã‚Šã€JOINå¥ã‚’ä½¿ç”¨ã›ãšã«ã€å„ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å¿…è¦ãªãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã§ãã‚‹ã€‚ãã®ãŸã‚ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å¢—ã‚„ã™ã‚„ã™ã„ã€‚ å¯èª­æ€§ ãƒ»ãƒ¢ãƒ‡ãƒ«ã¨ã“ã‚Œã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒãã®ã¾ã¾ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãªã‚‹ãŸã‚ã€ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã©ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã®ã‹ã‚’æ¨æ¸¬ã—ã‚„ã™ã„ã€‚ï¼ˆUserãƒ¢ãƒ‡ãƒ« â‡„ usersãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ãƒ»ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã¾ã‚Šãªãã€è¤‡æ•°ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã—ã¦ç„¡ç§©åºã«SQLã‚’ç™ºè¡Œã™ã‚‹ã‚ˆã†ãªè¨­è¨ˆå®Ÿè£…ã«ãªã‚Šã«ãã„ã€‚ ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆã‚’å…ƒã«ã—ãŸEloquentãƒ¢ãƒ‡ãƒ« ãƒ»Eloquentãƒ¢ãƒ‡ãƒ«ã®ç¶™æ‰¿ Eloquentãƒ¢ãƒ‡ãƒ«ã‚’ç¶™æ‰¿ã—ãŸã‚¯ãƒ©ã‚¹ã¯ã€INSERTæ–‡ã‚„UPDATEæ–‡ãªã©ã®ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®šç¾© ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã€tableãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ãŸã ã—ã€tableãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ä»£å…¥ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚EloquentãŒã‚¯ãƒ©ã‚¹åã®è¤‡æ•°å½¢ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«åã¨è¦‹ãªã—ã€ã“ã‚Œã‚’ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã«ã—ãŸæ–‡å­—åˆ—ã‚’tableãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è‡ªå‹•çš„ã«ä»£å…¥ã™ã‚‹ã€‚ã¾ãŸã€ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ç‹¬è‡ªã§å‘½åã—ãŸã„å ´åˆã¯ã€ä»£å…¥ã«ã‚ˆã‚‹Overrideã‚’è¡Œã£ã¦ã‚‚è‰¯ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«é–“ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ã®å®šç¾© ERå›³ã«ãŠã‘ã‚‹å„ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ã‚’å…ƒã«ã€ãƒ¢ãƒ‡ãƒ«é–“ã®é–¢é€£æ€§ã‚’å®šç¾©ã™ã‚‹ã€‚hasOneãƒ¡ã‚½ãƒƒãƒ‰ã€hasManyãƒ¡ã‚½ãƒƒãƒ‰ã€belongsToãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦è¡¨ç¾ã™ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/eloquent-relationships.html#one-to-one https://readouble.com/laravel/8.x/ja/eloquent-relationships.html#one-to-many https://readouble.com/laravel/8.x/ja/eloquent-relationships.html#one-to-many-inverse ERå›³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_object_oriented_analysis_and_design.html ï¼Šå®Ÿè£…ä¾‹ï¼Š Departmentãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦ã€hasManyãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€Departmentãƒ¢ãƒ‡ãƒ«ï¼ˆè¦ªï¼‰ã¨Employeesãƒ¢ãƒ‡ãƒ«ï¼ˆå­ï¼‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«é–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹ã€‚ hasMany(Employee::class); } } ã¾ãŸã€Employeesãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦ã¯ã€belongsToãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€Departmentãƒ¢ãƒ‡ãƒ«ï¼ˆè¦ªï¼‰ã¨Employeesãƒ¢ãƒ‡ãƒ«ï¼ˆå­ï¼‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«é–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹ã€‚ belongsTo(Department::class); } } ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«åŸºã¥ã„ã¦JOINå¥ã®SQLã‚’ç™ºè¡Œã™ã‚‹ãŸã‚ã«ã€Departmentãƒ¢ãƒ‡ãƒ«ï¼ˆè¦ªï¼‰ã®hasManyãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Departmentãƒ¢ãƒ‡ãƒ«ã®IDã«ç´ä»˜ãEmployeesãƒ¢ãƒ‡ãƒ«ï¼ˆå­ï¼‰ã‚’é…åˆ—ã§å‚ç…§ã§ãã‚‹ã€‚ employees() ãƒ»ä¸»ã‚­ãƒ¼ã‚«ãƒ©ãƒ ã®å®šç¾© Eloquentã¯ã€primaryKeyãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã‚’ä¸»ã‚­ãƒ¼ã®ã‚«ãƒ©ãƒ åã¨è¦‹ãªã™ã€‚keyTypeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ä¸»ã‚­ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿å‹ã€ã¾ãŸincrementingãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ä¸»ã‚­ãƒ¼ã®AutoIncrementã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã‹å¦ã‹ã€ã‚’è¨­å®šã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»TIMESTAMPå‹ã‚«ãƒ©ãƒ ã®å®šç¾© Eloquentã¯ã€timestampsãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ãŒtrueã®æ™‚ã«ã€Eloquentãƒ¢ãƒ‡ãƒ«ã«ç´ä»˜ããƒ†ãƒ¼ãƒ–ãƒ«ã®created_atã‚«ãƒ©ãƒ ã¨updated_atã‚«ãƒ©ãƒ ã‚’è‡ªå‹•çš„ã«æ›´æ–°ã™ã‚‹ã€‚ã¾ãŸã€TIMESTAMPå‹ã‚«ãƒ©ãƒ åã‚’ç‹¬è‡ªã§å‘½åã—ãŸã„å ´åˆã¯ã€ä»£å…¥ã«ã‚ˆã‚‹Overideã‚’è¡Œã£ã¦ã‚‚è‰¯ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»TIMESTAMPå‹ã‚«ãƒ©ãƒ èª­ã¿å‡ºã—æ™‚ã®ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ› ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—å‹ã‚«ãƒ©ãƒ ã‚’èª­ã¿å‡ºã™ã¨åŒæ™‚ã«ã€Carbonã®DateTimeã‚¯ãƒ©ã‚¹ã«å¤‰æ›ã—ãŸã„å ´åˆã€dataãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¦ã€ã‚«ãƒ©ãƒ åã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ã‚«ãƒ©ãƒ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®å®šç¾© ç‰¹å®šã®ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šã—ãŸã„å ´åˆã€attributesãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¦ã€ã‚«ãƒ©ãƒ åã¨å€¤ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š false, ]; } ãƒ»å¤‰æ›´å¯èƒ½ï¼ä¸å¯èƒ½ãªã‚«ãƒ©ãƒ ã®å®šç¾© å¤‰æ›´å¯èƒ½ãªã‚«ãƒ©ãƒ åã‚’fillableãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç”¨ã„ã¦å®šç¾©ã™ã‚‹ã€‚ã‚«ãƒ©ãƒ ãŒå¢—ãˆã‚‹ãŸã³ã«ã€å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚‚ã—ãã¯ã€å¤‰æ›´ä¸å¯èƒ½ãªã‚«ãƒ©ãƒ åã‚’guardedãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§å®šç¾©ã™ã‚‹ã€‚ã“ã‚Œã‚‰ã®ã„ãšã‚Œã‹ã®è¨­å®šã¯ã€Eloquentãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦å¿…é ˆã§ã‚ã‚‹ã€‚ ä½¿ç”¨ã«æ³¨æ„ã™ã‚‹æ©Ÿèƒ½ ãƒ»ã‚»ãƒƒã‚¿ãƒ¼ Laravelã§ã¯ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®šç¾©ã—ãªãã¦ã‚‚ã€Eloquentãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚Œã°ã€å‡¦ç†ã®åº¦ã«å‹•çš„ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®šç¾©ã§ãã‚‹ã€‚ã—ã‹ã—ã€ã“ã®æ©Ÿèƒ½ã¯ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒpublicã‚¢ã‚¯ã‚»ã‚¹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ©Ÿèƒ½ã®ãƒ¡ãƒªãƒƒãƒˆã‚’äº«å—ã§ããªã„ã€‚ãã®ãŸã‚ã€ã“ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã›ãšã«ã€constructorãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ãŸã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã€ã¾ãŸã¯ã‚»ãƒƒã‚¿ãƒ¼ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooName = $fooName; } } ãƒ»ã‚²ãƒƒã‚¿ãƒ¼ Laravelã§ã¯ã€getXxxxYyyyAttributeã¨ã„ã†åå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã€xxx_yyyã¨ã„ã†åå‰ã§ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ä¸€è¦‹ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ã‚³ãƒ¼ãƒ«ã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ãŸã‚ã€æ³¨æ„ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooName . \"ã§ã™ã€‚\"; } } name; ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ› ãƒ»ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“ã€ã¾ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–“ã®ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã®ãŸã‚ã«ã€é…åˆ—å‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’JSONã«å¤‰æ›ã™ã‚‹å‡¦ç†ã¯ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 1, \"name\" => \"ä½è—¤å¤ªéƒ\", ], [ \"user_id\" => 2, \"name\" => \"å±±ç”°æ¬¡éƒ\", ], ]); // Arrayå‹ã«å¤‰æ›ã™ã‚‹ $collection->toArray(); toArray(); ãƒ»ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“ã€ã¾ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–“ã®ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã®ãŸã‚ã«ã€JSONã‚’é…åˆ—å‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã™ã‚‹å‡¦ç†ã¯ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ã‚ã‚‹ã€‚ ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° ãƒ»filterãƒ¡ã‚½ãƒƒãƒ‰ ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®è¿”å´å€¤ãŒtrueã§ã‚ã£ãŸè¦ç´ ã‚’å…¨ã¦æŠ½å‡ºã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š $collection = collect([1, 2, 3, 4]); // trueã‚’è¿”å´ã—ãŸè¦ç´ ã‚’å…¨ã¦æŠ½å‡ºã™ã‚‹ $filtered = $collection->filter(function ($value, $key) { return $value > 2; }); $filtered->all(); // [3, 4] ã¡ãªã¿ã«ã€è¤‡æ•°ã®æ¡ä»¶ã‚’è¨­å®šã—ãŸã„ã¨ãã¯ã€æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š $collection = collect([1, 2, 3, 4, \"yes\"]); // è¤‡æ•°ã®æ¡ä»¶ã§æŠ½å‡ºã™ã‚‹ã€‚ $filtered = $collection->filter(function ($value, $key) { // ã¾ãšã¯yesã‚’æ¤œè¨¼ã™ã‚‹ã€‚ if($value == \"yes\") { return true; } return $value > 2; }); $filtered->all(); // [3, 4, \"yes\"] ãƒ»firstãƒ¡ã‚½ãƒƒãƒ‰ ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®è¿”å´å€¤ãŒtrueã§ã‚ã£ãŸæœ€åˆã®è¦ç´ ã®ã¿ã‚’æŠ½å‡ºã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š $collection = collect([1, 2, 3, 4]); // trueã‚’è¿”å´ã—ãŸè¦ç´ ã®ã¿æŠ½å‡ºã™ã‚‹ $filtered = $collection->first(function ($value, $key) { return $value > 2; }); // 3 05-02. Eloquentãƒ¢ãƒ‡ãƒ«ï¼ãƒ“ãƒ«ãƒ€ãƒ¼ã«ã‚ˆã‚‹CRUD CRUDãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤å‹ã¨è¿”å´å€¤ ãƒ»CRUDãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤ã‚¯ãƒ©ã‚¹ Eloquentãƒ¢ãƒ‡ãƒ«ã‚’ç¶™æ‰¿ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã«ã¯ã‚ˆã‚Šä¸Šä½ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„ã“ã¨ãŒã‚ã‚Šã€ã‚‚ã—å®šç¾©ã•ã‚Œã¦ã„ãªã„ã‚‚ã®ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸå ´åˆã€__callStaticãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆé™çš„ã‚³ãƒ¼ãƒ«ã«ã‚ˆã‚‹ï¼‰ã‚„__callãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆéé™çš„ã‚³ãƒ¼ãƒ«ã«ã‚ˆã‚‹ï¼‰ãŒä»£ã‚ã‚Šã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã€ã‚ˆã‚Šä¸Šä½ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ã©ã¡ã‚‰ã®æ–¹æ³•ã§ã‚³ãƒ¼ãƒ«ã—ã¦ã‚‚åŒã˜ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://www.php.net/manual/ja/language.oop5.overloading.php#object.call https://qiita.com/mpyw/items/7c7e8dc665584122a275 ã‚¯ãƒ©ã‚¹ åå‰ç©ºé–“ __callãƒ¡ã‚½ãƒƒãƒ‰ã‚’çµŒç”±ã—ã¦ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚¯ãƒ©ã‚¹ Queryãƒ“ãƒ«ãƒ€ãƒ¼ Illuminate\\Database\\Query\\Builder ãªã— Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ Illuminate\\Database\\Eloquent\\Builder Queryãƒ“ãƒ«ãƒ€ãƒ¼ã€ Eloquentãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ Illuminate\\Database\\Eloquent\\Relations\\Relation Queryãƒ“ãƒ«ãƒ€ãƒ¼ã€Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ã€ Eloquentãƒ¢ãƒ‡ãƒ« Illuminate\\Database\\Eloquent\\Model Queryãƒ“ãƒ«ãƒ€ãƒ¼ã€Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ã€Eloquentãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ»Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ãŒæŒã¤crudã‚’å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤å‹ã¨è¿”å´å€¤ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚ãã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Database/Eloquent/Builder.html CRUDãƒ¡ã‚½ãƒƒãƒ‰ã®ç¨®é¡ è¿”å´å€¤å‹ è¿”å´å€¤ è¿”å´å€¤ã®èª¬æ˜ create collectionï¼$this {id:1, name: ãƒ†ã‚¹ãƒˆ} ä½œæˆã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ find collectionï¼Builderï¼Model {id:1, name:ãƒ†ã‚¹ãƒˆ} å–å¾—ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ update mixed 0ã€1ã€2ã€3 å¤‰æ›´ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰æ•° delete mixed 0ã€1ã€2ã€3 å¤‰æ›´ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰æ•° ãƒ»Eloquentãƒ¢ãƒ‡ãƒ« Eloquentãƒ¢ãƒ‡ãƒ«ãŒæŒã¤crudã‚’å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤å‹ã¨è¿”å´å€¤ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚ãã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Database/Eloquent/Model.html CRUDãƒ¡ã‚½ãƒƒãƒ‰ã®ç¨®é¡ è¿”å´å€¤å‹ è¿”å´å€¤ è¿”å´å€¤ã®èª¬æ˜ update bool trueã€false çµæœã®çœŸå½å€¤ save bool trueã€false çµæœã®çœŸå½å€¤ delete bool trueã€false çµæœã®çœŸå½å€¤ CREATE ãƒ»createãƒ¡ã‚½ãƒƒãƒ‰ INSERTæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã«ã¯createãƒ¡ã‚½ãƒƒãƒ‰ãŒãªã„ãŸã‚ã€ä»£ã‚ã‚Šã«Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ãŒæŒã¤createãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚createãƒ¡ã‚½ãƒƒãƒ‰ã«æŒ¿å…¥å¯¾è±¡ã®ã‚«ãƒ©ãƒ ã¨å€¤ã‚’æ¸¡ã—ã€ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã€‚åˆ¥ã®æ–¹æ³•ã¨ã—ã¦ã€Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ã®fillãƒ¡ã‚½ãƒƒãƒ‰ã§æŒ¿å…¥å¯¾è±¡ã®ã‚«ãƒ©ãƒ ã¨å€¤ã‚’è¨­å®šã—ã€saveãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã‚‚ã‚ˆã„ã€‚saveãƒ¡ã‚½ãƒƒãƒ‰ã¯UPDATEå‡¦ç†ã‚‚å®Ÿè¡Œã§ãã‚‹ãŒã€fillãƒ¡ã‚½ãƒƒãƒ‰ã§IDå€¤ã‚’å‰²ã‚Šå½“ã¦ãªã„å ´åˆã¯ã€CREATEå‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚createãƒ¡ã‚½ãƒƒãƒ‰ã¾ãŸã¯saveãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹CREATEå‡¦ç†ã§ã¯ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æŒ¿å…¥å¾Œã«ã€lastInsertIdãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“ã™ã‚‹å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æŒ¿å…¥ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ãŒå–å¾—ã•ã‚Œã€Eloquentãƒ¢ãƒ‡ãƒ«ã®IDå€¤ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä¿æŒã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://codelikes.com/laravel-eloquent-basic/#toc9 https://qiita.com/henriquebremenkanp/items/cd13944b0281297217a9 ï¼Šå®Ÿè£…ä¾‹ï¼Š create($request->all()); // ä»¥ä¸‹ã®å®Ÿè£…ã§ã‚‚ã‚ˆã„ // $foo->fill($request->all())->save(); // å‡¦ç†å¾Œã«ã¯Eloquentãƒ¢ãƒ‡ãƒ«ã«IDå€¤ãŒä¿æŒã•ã‚Œã¦ã„ã‚‹ã€‚ $foo->id(); // ç¶šãã®å‡¦ç† } } Eloquentãƒ¢ãƒ‡ãƒ«ã«ã¯fillableãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¦ãŠãã€‚ READ ãƒ»allãƒ¡ã‚½ãƒƒãƒ‰ ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å…¨ã¦å–å¾—ã™ã‚‹SELECTå¥ã‚’ç™ºè¡Œã™ã‚‹ã€‚MySQLã‚’å«ã‚€DBã‚¨ãƒ³ã‚¸ãƒ³ã§ã¯ã€å–å¾—çµæœã«æ¨™æº–ã®ä¸¦ã³é †ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æ˜‡é †ã§å–å¾—ã—ãŸã„å ´åˆã¯ã€orderByãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€æ˜ç¤ºçš„ã«ä¸¦ã³æ›¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã«ã¯allãƒ¡ã‚½ãƒƒãƒ‰ãŒãªã„ãŸã‚ã€ä»£ã‚ã‚Šã«Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ãŒæŒã¤allãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚å…¨ã¦ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®Collectionå‹ã‚’é…åˆ—å‹ã¨ã—ã¦è¿”å´ã™ã‚‹ã€‚toArrayãƒ¡ã‚½ãƒƒãƒ‰ã§é…åˆ—å‹ã«å†å¸°çš„ã«å¤‰æ›ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/54526479/what-is-the-dafault-ordering-in-laravel-eloquent-modelall-function https://laravel.com/api/8.x/Illuminate/Support/Collection.html#method_all https://readouble.com/laravel/8.x/ja/eloquent.html#retrieving-models ï¼Šå®Ÿè£…ä¾‹ï¼Š all(); } } ãƒ»findãƒ¡ã‚½ãƒƒãƒ‰ ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¸€ã¤å–å¾—ã™ã‚‹SELECTå¥ã‚’ç™ºè¡Œã™ã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã«ã¯findãƒ¡ã‚½ãƒƒãƒ‰ãŒãªã„ãŸã‚ã€ä»£ã‚ã‚Šã«Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ãŒæŒã¤findãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚å¼•æ•°ã¨ã—ã¦ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’æ¸¡ã—ãŸå ´åˆã€æŒ‡å®šã—ãŸãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’æŒã¤Eloquentãƒ¢ãƒ‡ãƒ«ã‚’è¿”å´ã™ã‚‹ã€‚toArrayãƒ¡ã‚½ãƒƒãƒ‰ã§é…åˆ—å‹ã«å¤‰æ›ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://laravel.com/api/8.x/Illuminate/Database/Query/Builder.html#method_find https://readouble.com/laravel/8.x/ja/eloquent.html#retrieving-single-models ï¼Šå®Ÿè£…ä¾‹ï¼Š find($id); } } ãƒ»firstãƒ¡ã‚½ãƒƒãƒ‰ å–å¾—ã•ã‚ŒãŸã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å‹ãƒ‡ãƒ¼ã‚¿ã®ä¸€ã¤ç›®ã®è¦ç´ ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ã®èª²ã›ã‚‰ã‚ŒãŸã‚«ãƒ©ãƒ ã‚’whereãƒ¡ã‚½ãƒƒãƒ‰ã®å¯¾è±¡ã¨ã™ã‚‹å ´åˆã€ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦å–å¾—ã•ã‚Œã‚‹ãŒã€ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãŒæŒã¤Eloquentãƒ¢ãƒ‡ãƒ«ã¯ä¸€ã¤ã§ã‚ã‚‹ã€‚foreachã‚’ç”¨ã„ã¦ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰Eloquentãƒ¢ãƒ‡ãƒ«ã‚’å–ã‚Šå‡ºã—ã¦ã‚‚ã‚ˆã„ãŒã€ç„¡é§„ãŒå¤šã„ã€‚ãã“ã§ã€firstãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€Eloquentãƒ¢ãƒ‡ãƒ«ã‚’ç›´æ¥å–å¾—ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š where('foo_email', $emailAddress)->first(); } } ãƒ»limitãƒ¡ã‚½ãƒƒãƒ‰ã€offsetãƒ¡ã‚½ãƒƒãƒ‰ é–‹å§‹åœ°ç‚¹ã‹ã‚‰æŒ‡å®šã—ãŸä»¶æ•°ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å…¨ã¦å–å¾—ã™ã‚‹SELECTå¥ã‚’ç™ºè¡Œã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ï¼‘ãƒšãƒ¼ã‚¸å½“ãŸã‚Šã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ï¼ˆlimitï¼‰ã¨ã€æ¬¡ã®ãƒšãƒ¼ã‚¸ã®é–‹å§‹ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼ˆoffsetï¼‰ã‚’å®šç¾©ã§ãã‚‹ã€‚ã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã™ã¨ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/queries.html#ordering-grouping-limit-and-offset ï¼Šå®Ÿè£…ä¾‹ï¼Š offset($request->offset) ->limit($request->limit) ->get(); } } ãƒ»orderByãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã®æ˜‡é †ï¼é™é †ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¸¦ã³æ›¿ãˆã‚‹SELECTå¥ã‚’ç™ºè¡Œã™ã‚‹ã€‚ä¸¦ã³æ›¿ãˆãŸçµæœã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã€getãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æ˜‡é †ã§å–å¾—ã™ã‚‹å ´åˆã€allãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ãªãã€orderByãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æ˜‡é †ã‚’æ˜ç¤ºçš„ã«è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/queries.html#ordering-grouping-limit-and-offset ï¼Šå®Ÿè£…ä¾‹ï¼Š orderBy('foo_id', 'asc')->get(); } /** * @return Collection */ public function findAllByDesc(): Collection { $foo = new Foo(); // é™é † return $foo->orderBy('foo_id', 'desc')->get(); } } ãƒ»sortByãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã®æ˜‡é †ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¸¦ã³æ›¿ãˆã‚‹SELECTå¥ã‚’ç™ºè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/collections.html#method-sortby ï¼Šå®Ÿè£…ä¾‹ï¼Š all()->sortBy('foo_id'); } } ãƒ»sortByDescãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã®é™é †ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¸¦ã³æ›¿ãˆã‚‹SELECTå¥ã‚’ç™ºè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/collections.html#method-sortbydesc all()->sortByDesc('foo_id'); } } ãƒ»withãƒ¡ã‚½ãƒƒãƒ‰ è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®Eloquentãƒ¢ãƒ‡ãƒ«ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¿æŒã™ã‚‹ã€‚ã“ã®ä»•çµ„ã¿ã‚’Eagerãƒ­ãƒ¼ãƒ‰ã¨ã„ã†ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã«ã¯withãƒ¡ã‚½ãƒƒãƒ‰ãŒãªã„ãŸã‚ã€ä»£ã‚ã‚Šã«Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ãŒæŒã¤withãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã«ä¸€å¯¾å¤šï¼ˆè¦ªå­ï¼‰ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ãŒã‚ã‚‹å ´åˆã«ç”¨ã„ã‚‹ã€‚N+1å•é¡Œã‚’é˜²ã’ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/eloquent-relationships.html#eager-loading ãŸã ã—ã€withãƒ¡ã‚½ãƒƒãƒ‰ã«ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒã‚§ãƒ¼ãƒ³ã—ã¦ã—ã¾ã†ã¨ã€Eagerãƒ­ãƒ¼ãƒ‰ã®å¾Œã«SQLã‚’ç™ºè¡Œã•ã‚Œã¦ã—ã¾ã†ãŸã‚ã€Eagerãƒ­ãƒ¼ãƒ‰ã®æ©æµã‚’å¾—ã‚‰ã‚Œãªããªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/shosho/items/abf6423283f761703d01#%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%A1%E3%82%BD%E3%83%89%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%97%E3%81%BE%E3%81%86%E3%81%A8-eager-loading-%E3%81%AB%E3%81%97%E3%81%A6%E3%81%A6%E3%82%82%E6%84%8F%E5%91%B3%E3%81%8C%E3%81%AA%E3%81%84%E3%81%AE%E3%81%A7%E6%B3%A8%E6%84%8F ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã¦ã€Departmentï¼ˆè¦ªï¼‰ã¨ã€ã“ã‚Œã«ç´ä»˜ãEmployeeï¼ˆå­ï¼‰ã‚’èª­ã¿å‡ºã™ã€‚ã“ã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã®é–“ã§ã¯ã€hasManyãƒ¡ã‚½ãƒƒãƒ‰ã¨belongsToãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹ä¸€å¯¾å¤šã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã—ã¦ãŠãã€‚ with(\"employees\")->get(); foreach ($employees as $employee) { // ã“ã“ã§ã¯DBã‚¢ã‚¯ã‚»ã‚¹ã¯ã›ãšã«ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä¿æŒã•ã‚ŒãŸå€¤ã‚’å–å¾—ã™ã‚‹ã ã‘ã€‚ $name = $employee->name; } // ç¶šãã®å‡¦ç† } } Departmentï¼ˆè¦ªï¼‰ã«ã€departmentsãƒ†ãƒ¼ãƒ–ãƒ«ã¨employeesãƒ†ãƒ¼ãƒ–ãƒ«ã®é–“ã«ã€ä¸€å¯¾å¤šã®é–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹ã€‚ hasMany(Employee::class); } } ã¾ãŸã€Employeeï¼ˆå­ï¼‰ã«ã€åå¯¾ã®å¤šå¯¾ä¸€ã®é–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹ã€‚ belongsTo(Department::class); } } UPDATE ãƒ»saveãƒ¡ã‚½ãƒƒãƒ‰ UPDATEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ã®fillãƒ¡ã‚½ãƒƒãƒ‰ã§æŒ¿å…¥å¯¾è±¡ã®ã‚«ãƒ©ãƒ ã¨å€¤ã‚’è¨­å®šã—ã€saveãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚saveãƒ¡ã‚½ãƒƒãƒ‰ã¯CREATEå‡¦ç†ã‚‚å®Ÿè¡Œã§ãã‚‹ãŒã€fillãƒ¡ã‚½ãƒƒãƒ‰ã§IDå€¤ã‚’å‰²ã‚Šå½“ã¦ãŸå ´åˆã¯ã€UPDATEå‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://codelikes.com/laravel-eloquent-basic/#toc9 https://qiita.com/henriquebremenkanp/items/cd13944b0281297217a9 ï¼Šå®Ÿè£…ä¾‹ï¼Š fill($request->all())->save(); // ç¶šãã®å‡¦ç† } } Eloquentãƒ¢ãƒ‡ãƒ«ã«ã¯fillableãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¦ãŠãã€‚ DELETE ãƒ»destroyï¼deleteãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆç‰©ç†å‰Šé™¤ï¼‰ DELETEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã®destroyï¼deleteãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚æ‰‹é †ã¨ã—ã¦ã€Eloquentãƒ“ãƒ«ãƒ€ãƒ¼ã®findãƒ¡ã‚½ãƒƒãƒ‰ã§å‰Šé™¤å¯¾è±¡ã®Modelã‚’æ¤œç´¢ã™ã‚‹ã€‚è¿”å´ã•ã‚ŒãŸEloquentãƒ“ãƒ«ãƒ€ãƒ¼ã®destroyï¼deleteãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ã€è‡ªèº«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ ãƒ»SoftDeletesã®æœ‰åŠ¹åŒ–ï¼ˆè«–ç†å‰Šé™¤ï¼‰ å‰Šé™¤ãƒ•ãƒ©ã‚°ã‚’æ›´æ–°ã™ã‚‹UPDATEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã®destroyï¼deleteãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚æ‰‹é †ã¨ã—ã¦ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾å¿œã™ã‚‹Modelã«ã¦ã€SoftDeletesã®Traitã‚’èª­ã¿è¾¼ã‚€ã€‚ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã«è¿½åŠ ã•ã‚Œã‚‹delete_atã‚«ãƒ©ãƒ ã‚’SQLã§å–å¾—ã™ã‚‹æ™‚ã«ã€DataTimeã‚¯ãƒ©ã‚¹ã«å¤‰æ›ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦softDeletesãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã¨ã€å‰Šé™¤ãƒ•ãƒ©ã‚°ã¨ã—ã¦deleted_atã‚«ãƒ©ãƒ ãŒè¿½åŠ ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚deleted_atã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯NULLã§ã‚ã‚‹ã€‚ softDeletes(); // ï½ ä¸­ç•¥ ï½ }); } /** * ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ * * @return void */ public function down() { Schema::drop(\"foo\"); } } ä¸Šè¨˜ã®çŠ¶æ…‹ã§ã€åŒæ§˜ã«destroyï¼deleteãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€è‡ªèº«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ç‰©ç†å‰Šé™¤ã§ã¯ãªãã€deleled_atã‚«ãƒ©ãƒ ãŒæ›´æ–°ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚findãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€deleled_atã‚«ãƒ©ãƒ ãŒNULLã§ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å‡ºã•ãªã„ãŸã‚ã€è«–ç†å‰Šé™¤ã‚’å®Ÿç¾ã§ãã‚‹ã€‚ N+1å•é¡Œã®è§£æ±º ãƒ»N+1å•é¡Œã¨ã¯ è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã‚’çµŒç”±ã—ã¦å­ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ™‚ã«ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°åˆ†ã®SQLã‚’ç™ºè¡Œã—ã¦ã—ã¾ã†ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã“ã¨ã€‚ ãƒ»å•é¡ŒãŒèµ·ã“ã‚‹å®Ÿè£… åå¾©å‡¦ç†ã®ä¸­ã§å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã—ã¾ã†å ´åˆã€N+1å•é¡ŒãŒèµ·ã“ã‚‹ã€‚å†…éƒ¨çš„ã«ã¯ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®SQLã¨ã€Whereå¥ã‚’æŒã¤SQLãŒè¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°åˆ†ã ã‘ç™ºè¡Œã•ã‚Œã‚‹ã€‚ employees; // è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°åˆ†ã®Whereå¥SQLãŒç™ºè¡Œã•ã‚Œã‚‹ï¼ˆNå›ï¼‰ } # 1å› select * from `departments` # Nå› select * from `employees` where `department_id` = 1 select * from `employees` where `department_id` = 2 select * from `employees` where `department_id` = 3 ... ãƒ»è§£æ±ºæ–¹æ³• åå¾©å‡¦ç†ã®å‰ã«å°ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãŠãã€‚ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«withãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†ã¨ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«åŠ ãˆã¦ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã®Eloquentãƒ¢ãƒ‡ãƒ«ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å­ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¿æŒã™ã‚‹ã‚ˆã†ã«å‡¦ç†ã™ã‚‹ã€‚ãã®ãŸã‚ã€åå¾©å‡¦ç†ã§ã¯ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã™ã ã‘ã«ãªã‚‹ã€‚å†…éƒ¨çš„ã«ã¯ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®SQLã¨ã€Inå¥ã‚’ç”¨ã„ãŸSQLãŒç™ºè¡Œã•ã‚Œã‚‹ã€‚ get(); // SQLç™ºè¡Œï¼ˆ2å›ï¼‰ foreach($departments as $department) { $department->employees; // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ã†ã®ã§SQLã®ç™ºè¡Œã¯ã•ã‚Œãªã„ï¼ˆ0å›ï¼‰ } # 2å› select * from `departments` select * from `employees` where `department_id` in (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 ... 100) 05-03. Laravelã¸ã®ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥ èƒŒæ™¯ Laravelã¯Active Recordãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¡ç”¨ã—ã¦ãŠã‚Šã€ã“ã‚Œã¯ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ã§ãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é©ã—ã¦ã„ã‚‹ã€‚ãŸã ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ã‚‚ã€Laravelã‚’ç”¨ã„ãŸã„å ´é¢ãŒã‚ã‚‹ã€‚ãã®å ´åˆã€Laravelã«ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å°å…¥ã™ã‚‹ã“ã¨ãŒé¸æŠè‚¢ã®ä¸€ã¤ã«ãªã‚‹ã€‚ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_backend_domain_driven_design_clean_architecture.html å·¥å¤« ãƒ»DTOã‚¯ãƒ©ã‚¹ã®å°å…¥ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ç”¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨ã€Eloquentãƒ¢ãƒ‡ãƒ«ã‚’ç¶™æ‰¿ã—ãŸè©°ã‚æ›¿ãˆãƒ¢ãƒ‡ãƒ«ï¼ˆä¾‹ï¼šDTOã‚¯ãƒ©ã‚¹ï¼‰ã‚’ç”¨æ„ã™ã‚‹ã€‚è©°ã‚æ›¿ãˆãƒ¢ãƒ‡ãƒ«ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã™ã‚‹å‡¦ç†ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦åˆ‡ã‚Šåˆ†ã‘ã¦ãŠãã¨ä¾¿åˆ©ã§ã‚ã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨DTOã‚¯ãƒ©ã‚¹ã®é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’è©°ã‚æ›¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨ã€DTOã‚¯ãƒ©ã‚¹ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é–“ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã‚„ã‚Šå–ã‚Šã‚’ä»²ä»‹ã—ã€ã“ã‚Œã‚‰ã‚’ç–çµåˆã«ã—ã¦ãã‚Œã‚‹ã€‚ãã®ãŸã‚ã€Repositoryãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿç¾ã§ãã‚‹ã€‚ id), new FooName($this->name), new FooAge($this->age), ); } } CREATE ãƒ»createãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooDTO = $fooDTO; } /** * @param Foo $foo * @return void */ public function create(Foo $foo): void { $this->fooDTO // INSERTæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ->create([ // ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’DTOã«è©°ã‚æ›¿ãˆã‚‹ã€‚ \"name\" => $foo->name(), \"age\" => $foo->age(), ]); // ä»¥ä¸‹ã®å®Ÿè£…ã§ã‚‚ã‚ˆã„ã€‚ // $this->fooDTO // ->fill([ // \"name\" => $foo->name(), // \"age\" => $foo->age(), // ]) // ->save(); } } READ ãƒ»findãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooDTO = $fooDTO; } /** * @param FooId $fooId * @return Foo */ public function findById(FooId $fooId): Foo { $fooDTO = $this->fooDTO ->find($fooId->id()); // DBã‚¢ã‚¯ã‚»ã‚¹å‡¦ç†å¾Œã®DTOã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã™ã‚‹ã€‚ return new Foo( $fooDTO->id(), $fooDTO->name(), $fooDTO->age(), $fooDTO->email() ); } } ãƒ»allãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooDTO = $fooDTO; } /** * @return array */ public function findAll(): array { $fooDTOs = $this->fooDTO ->all(); $foos = []; foreach ($fooDTOs as $fooDTO) // DBã‚¢ã‚¯ã‚»ã‚¹å¾Œã®DTOã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã™ã‚‹ã€‚ $foos = new Foo( $fooDTO->id(), $fooDTO->name(), $fooDTO->age(), $fooDTO->email(), ); return $foos; } } ãƒ»withãƒ¡ã‚½ãƒƒãƒ‰ UPDATE ãƒ»saveãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooDTO = $fooDTO; } /** * @param Foo $foo * @return void */ public function save(Foo $foo): void { $this->fooDTO // ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’DTOã«è©°ã‚æ›¿ãˆã‚‹ã€‚ ->fill([ \"name\" => $foo->name(), \"age\" => $foo->age(), ]) // UPDATEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ->save(); } } DELETE ãƒ»destroyï¼deleteãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooDTO = $fooDTO; } /** * @param FooId $fooId * @return void */ public function delete(FooId $fooId): void { // destroyãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $this->fooDTO->destroy($fooId->id()); // deleteãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã‚‚è‰¯ã„ã€‚ // $this->fooDTO->find($fooId->id())->delete(); } } fooRepository = $fooRepository; } /** * @param FooId $fooId * @return mixed */ public function delete(FooId $fooId) { $this->fooRepository ->delete($fooId); return response()->view(\"foo\") ->setStatusCode(200); } } 06. Eventï¼Listener Event ãƒ»Eventã¨ã¯ ãƒ“ã‚¸ãƒã‚¹ã®å‡ºæ¥äº‹ãŒãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã€‚ ãƒ»æ§‹æˆ ã‚¤ãƒ™ãƒ³ãƒˆã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ã ã‘ã§ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒãŸãªã„æ§‹æˆã¨ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/events.html#defining-events ï¼Šå®Ÿè£…ä¾‹ï¼Š user = $user; } } ä»»æ„ã®å ´æ‰€ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã§ãã‚‹ã€‚ ãƒ»Eloquentãƒ¢ãƒ‡ãƒ«ã®CRUDã‚¤ãƒ™ãƒ³ãƒˆ Eloquentãƒ¢ãƒ‡ãƒ«ã§ã¯ã€DBã‚¢ã‚¯ã‚»ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œé–‹å§‹ã‚„çµ‚äº†ã®å‡¦ç†ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ã‚¤ãƒ™ãƒ³ãƒˆã‚¯ãƒ©ã‚¹ã«ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ç´ä»˜ã‘ã‚‹ãŸã‚ã«ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§å®šç¾©ã™ã‚‹ã‹ã€ã‚ã‚‹ã„ã¯å„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ãƒ¼ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç”Ÿã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/eloquent.html#events ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¦ã€CREATEå‡¦ç†ã¨DELETEå‡¦ç†ã«ç‹¬è‡ªã‚¤ãƒ™ãƒ³ãƒˆã‚¯ãƒ©ã‚¹ã«ç´ä»˜ã‘ã‚‹ã€‚ UserSaved::class, 'deleted' => UserDeleted::class, ]; } ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ãƒ¼ã«ã¦ã€CREATEå‡¦ç†ã«ç‹¬è‡ªã‚¤ãƒ™ãƒ³ãƒˆã‚¯ãƒ©ã‚¹ã«ç´ä»˜ã‘ã‚‹ã€‚ Listener ãƒ»Listenerã¨ã¯ ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸæ™‚ã«ã€ã“ã‚Œã«ç´ä»˜ã„ã¦ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã“ã¨ã€‚ ãƒ»æ§‹æˆ Listenerã‚¯ãƒ©ã‚¹ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸæ™‚ã«å®Ÿè¡Œã™ã‚‹å‡¦ç†ã‚’handleé–¢æ•°ã«å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã•ã‚ŒãŸæ™‚ã«ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ã€‚ user->userEmailAddress->emailAddress) ->notify(new UserCreatedEventNotification($userEvent->user)); } } ä»»æ„ã®å ´æ‰€ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã™ã‚‹ã¨ã€ãƒªã‚¹ãƒŠãƒ¼ãŒè‡ªå‹•ã§ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã¨ãƒªã‚¹ãƒŠãƒ¼ã®ç´ä»˜ã‘ EventServiceProviderã‚¯ãƒ©ã‚¹ã«ã¦ã€Eventã‚¯ãƒ©ã‚¹ã«ç´ä»˜ã‘ã‚‹ä¸€ã¤ä»¥ä¸Šã®Listenerã‚¯ãƒ©ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [ UserCreatedEventListener::class, ], ]; /** * @return void */ public function boot() { parent::boot(); // } } ãƒ»ä»»æ„ã®Eloquentãƒ¢ãƒ‡ãƒ«CRUDã‚¤ãƒ™ãƒ³ãƒˆã®æ¤œçŸ¥ Laravelã®å¤šãã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã€bootãƒ¡ã‚½ãƒƒãƒ‰ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã§ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆæ™‚ã«bootãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€ã“ã‚Œã«ã‚ˆã‚Šã«bootTraitsãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚Traitã«boot+ã¨ã„ã†åå‰ã®é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã¨ã€bootTraitsãƒ¡ã‚½ãƒƒãƒ‰ã¯ã“ã‚Œã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚bootTraitsãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­ã§Eloquentãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç”Ÿã•ã›ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å…¨ã¦ã®Eloquentãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä¸€æ‹¬ã§ç™ºç«ã•ã›ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/laravel/framework/blob/9362a29ce298428591369be8d101d51876406fc8/src/Illuminate/Database/Eloquent/Model.php#L255-L285 ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚ã‚‰ã‹ã˜ã‚Traitã‚’å®šç¾©ã™ã‚‹ã€‚savedãƒ¡ã‚½ãƒƒãƒ‰ã«Eloquentãƒ¢ãƒ‡ãƒ«ã®æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™»éŒ²ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ save($options); }); } } ã‚¤ãƒ™ãƒ³ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ $updatedModel = $updatedModel; } } Modelæ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã¦ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ãƒªã‚¹ãƒŠãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚create_byã‚«ãƒ©ãƒ ã¾ãŸã¯updated_byã‚«ãƒ©ãƒ ã‚’æŒ‡å®šã—ãŸæ›´æ–°è€…åã«æ›´æ–°ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ãªãŠã€ã‚¤ãƒ™ãƒ³ãƒˆã¨ãƒªã‚¹ãƒŠãƒ¼ã®å¯¾å¿œé–¢ä¿‚ã¯ã€EventServiceProviderã§ç™»éŒ²ã™ã‚‹ã€‚ getModelUpdater(); // create_byãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’åˆ¤å®šã€‚ if (is_null($updatedModelEvent->updatedModel->created_by)) { $updatedModelEvent->updatedModel->created_by = $by; } $updatedModelEvent->updatedModel->updated_by = $by; $updatedModelEvent->updatedModel->saveWithoutEvents(); } /** * æ›´æ–°å‡¦ç†ã®å®Ÿè¡Œè€…ã‚’å–å¾—ã—ã¾ã™ã€‚ * * @return string */ private function getModelUpdater(): string { // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«çµŒç”±ã§å®Ÿè¡Œã•ã‚ŒãŸã‹ã‚’åˆ¤å®šã€‚ if (app()->runningInConsole()) { return ExecutorConstant::ARTISAN_COMMAND; } // APIèªè¨¼ã«æˆåŠŸã—ãŸã‹ã‚’åˆ¤å®šã€‚ if (auth()->check()) { return ExecutorConstant::STAFF . \":\" . auth()->id(); } return ExecutorConstant::GUEST; } } å®Ÿè¡Œè€…åã¯ã€å®šæ•°ã¨ã—ã¦ç®¡ç†ã—ã¦ãŠãã¨ã‚ˆã„ã€‚ 07. Exception Laravelã«ãŠã‘ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ï¼”ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰ãªã‚‹ã€‚Laravelã§ã¯æ¨™æº–ã§Handlerã‚¯ãƒ©ã‚¹ãŒå…¨ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ã‚«ãƒãƒ¼ã—ã¦ã„ã‚‹ã€‚ã¾ãŸåŠ ãˆã¦ã€ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è‡ªå‹•ã§è¿”ä¿¡ã—ã¦ãã‚Œã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ã‚¹ãƒ†ãƒƒãƒ—ã®ã†ã¡ã€ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã«ã¤ã„ã¦ã¯è¨€åŠã—ãªã„ã“ã¨ã¨ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_logic_error_and_error_handling.html ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ ãƒ»ä¾‹å¤– ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ãªã„ãŒã€æ¨™æº–ã§æ§˜ã€…ãªä¾‹å¤–ãŒå‚™ã‚ã£ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/search.html?search=exception ãƒ»ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ Laravelã¯ã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹ä¾‹å¤–ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã§ç”Ÿæˆã™ã‚‹ã€‚ã¾ãŸã€Laravelå†…éƒ¨ã§ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒã¨æ–°ãŸãªä¾‹å¤–ã®æŠ•ã’ç›´ã—ãŒè¡Œã‚ã‚Œã‚‹ãŸã‚ã€[previous exception]ã«ã‚ˆã£ã¦ä¾‹å¤–ãŒçµåˆã•ã‚Œã‚‹ã€‚ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã«ã¯æ©Ÿå¯†æ€§ã®é«˜ã„æƒ…å ±ãŒå«ã¾ã‚Œã‚‹ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯å‰²ã‚Šå½“ã¦ãšã«ã€ãƒ­ã‚®ãƒ³ã‚°ã ã‘ã—ã¦ãŠãã€‚ã‚¨ãƒ©ãƒ¼ãŒè¤‡æ•°è¡Œã«ã¾ãŸãŒã‚‹ãŸã‚ã€CloudWatchã‚„FluentBitãªã©ã®ãƒ­ã‚°åé›†ãƒ„ãƒ¼ãƒ«ã§ã¯ã€å„è¡Œã‚’ç¹‹ã’ã¦æ‰±ãˆã‚‹ã‚ˆã†ã«è¨­å®šãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã¡ãªã¿ã«ã€ãƒ­ã‚°ã®è©³ç´°åº¦ã¯APP_DEBUGç’°å¢ƒå¤‰æ•°ã§åˆ¶å¾¡ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/errors.html#configuration [2021-09-00 00:00:00] local.ERROR: *****ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ [stacktrace] #0 /var/www/foo-app/framework/src/Illuminate/Database/Connection.php(652): Illuminate\\\\Database\\\\Connection->runQueryCallback('insert into `us...', Array, Object(Closure)) #1 /var/www/foo-app/framework/src/Illuminate/Database/Connection.php(486): Illuminate\\\\Database\\\\Connection->run('insert into `us...', Array, Object(Closure)) #2 /var/www/foo-app/framework/src/Illuminate/Database/Connection.php(438): Illuminate\\\\Database\\\\Connection->statement('insert into `us...', Array) ... #60 /var/www/foo-app/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure)) #61 /var/www/foo-app/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter(Object(Illuminate\\\\Http\\\\Request)) #62 /var/www/foo-app/public/index.php(55): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle(Object(Illuminate\\\\Http\\\\Request)) #63 {main} [previous exception] [object] *****ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ [stacktrace] #0 /var/www/foo-app/vendor/doctrine/dbal/lib/Doctrine/DBAL/Driver/PDOStatement.php(114): Doctrine\\\\DBAL\\\\Driver\\\\PDO\\\\Exception::new(Object(PDOException)) #1 /var/www/foo-app/framework/src/Illuminate/Database/Connection.php(485): Doctrine\\\\DBAL\\\\Driver\\\\PDOStatement->execute() #2 /var/www/foo-app/framework/src/Illuminate/Database/Connection.php(685): Illuminate\\\\Database\\\\Connection->Illuminate\\\\Database\\\\{closure}('insert into `us...', Array) ... #63 /var/www/foo-app/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure)) #64 /var/www/foo-app/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter(Object(Illuminate\\\\Http\\\\Request)) #65 /var/www/foo-app/public/index.php(55): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle(Object(Illuminate\\\\Http\\\\Request)) #66 {main} [previous exception] [object] *****ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ [stacktrace] #0 /var/www/foo-app/vendor/doctrine/dbal/lib/Doctrine/DBAL/Driver/PDOStatement.php(112): PDOStatement->execute(NULL) #1 /var/www/foo-app/framework/src/Illuminate/Database/Connection.php(485): Doctrine\\\\DBAL\\\\Driver\\\\PDOStatement->execute() #2 /var/www/foo-app/framework/src/Illuminate/Database/Connection.php(685): Illuminate\\\\Database\\\\Connection->Illuminate\\\\Database\\\\{closure}('insert into `us...', Array) ... #63 /var/www/foo-app/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline->then(Object(Closure)) #64 /var/www/foo-app/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter(Object(Illuminate\\\\Http\\\\Request)) #65 /var/www/foo-app/public/index.php(55): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle(Object(Illuminate\\\\Http\\\\Request)) #66 {main} \"} ãƒ­ã‚®ãƒ³ã‚° ãƒ»reportãƒ¡ã‚½ãƒƒãƒ‰ Laravelå†…éƒ¨ã§ã‚­ãƒ£ãƒƒãƒã•ã‚ŒãŸä¾‹å¤–ã«åŸºã¥ã„ã¦ã€ãƒ­ã‚®ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://cpoint-lab.co.jp/article/201905/9841/ ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è¿”ä¿¡ ãƒ»renderãƒ¡ã‚½ãƒƒãƒ‰ Laravelå†…éƒ¨ã§ã‚­ãƒ£ãƒƒãƒã•ã‚ŒãŸä¾‹å¤–ã«åŸºã¥ã„ã¦ã€ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è‡ªå‹•ã§è¿”ä¿¡ã™ã‚‹ã€‚ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è¿”ä¿¡å‡¦ç†ã‚’ã“ã‚Œã«è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ãŒã€ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹é–“ãŒå¯†çµåˆã«ãªã‚‹ãŸã‚ã€ã§ãã‚‹ã ã‘ã„ã˜ã‚‰ãªã„ã€‚ãã®ä»£ã‚ã‚Šã«ã€å„ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«try-catchã¨ç•°å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è¿”ä¿¡å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://cpoint-lab.co.jp/article/201905/9841/ 08. Facade Facade ãƒ»Facadeã¨ã¯ Facadeã«ç™»éŒ²ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ï¼ˆFacadeã‚¯ãƒ©ã‚¹ï¼‰ã¨ServiceContainerã‚’ç¹‹ãé™çš„ãƒ—ãƒ­ã‚­ã‚·ã¨ã—ã¦åƒãã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ãƒ»Facadeã‚’ä½¿ç”¨ã—ãªã„å ´åˆ newæ¼”ç®—å­ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š method(); ãƒ»Facadeã®é™çš„ãƒ—ãƒ­ã‚­ã‚·æ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹å ´åˆ é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã®è¨˜æ³•ã§ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ãŸã ã—ã€è‡ªä½œã‚¯ãƒ©ã‚¹ã‚’Facadeã®æ©Ÿèƒ½ã‚’ç”¨ã„ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã™ã‚‹ã¨ã€ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£ãªã€Compositionï¼ˆåˆæˆï¼‰ã€ã®ä¾å­˜é–¢ä¿‚ã‚’ç”Ÿã˜ã•ã›ã¦ã—ã¾ã†ã€‚ä¾‹ãˆã°ã€Facadeã®ä¸­ã§ã‚‚ã€Routeã®ã‚ˆã†ãªã€ä»£æ›¿ã™ã‚‹ã‚ˆã‚Šã‚‚Facadeã‚’ä½¿ã£ãŸã»ã†ãŒæ–­ç„¶ä¾¿åˆ©ã§ã‚ã‚‹éƒ¨åˆ†ä»¥å¤–ã¯ã€ä½¿ç”¨ã—ãªã„ã»ã†ãŒã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Facadeã¨ã—ã¦ç”¨ã„ãŸã„ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚ ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã¨ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã‚’config/app.phpãƒ•ã‚¡ã‚¤ãƒ«ã‚’aliasesã‚­ãƒ¼ã«ç™»éŒ²ã™ã‚‹ã¨ã€ãã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ [ \"Foo\" => App\\Models\\Foo::class, ] ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã‚³ãƒ¼ãƒ«ã‚’è¡Œã†ã€‚ ãƒ»Facadeã‚’ç”¨ã„ãŸæ–¹ãŒè‰¯ã„å ´åˆ FacadeãŒãƒˆãƒ¬ã‚¤ãƒˆã®ä»£ã‚ã‚Šã«ãªã‚‹å ´åˆã€Facadeã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€è²¬å‹™ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«é›†ä¸­ã›ãšã«ã™ã‚€ã€‚ ï¼Šä¾‹ï¼Š Notifiableãƒˆãƒ¬ã‚¤ãƒˆã‚’Userã‚¯ãƒ©ã‚¹ã§ä½¿ç”¨ã›ãšã«ã€Notificationãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã«ã‚ˆã‚‹ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰é€šçŸ¥ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€Userã‚¯ãƒ©ã‚¹ãŒé€šçŸ¥å‡¦ç†ã®è²¬å‹™ã‚’æŒãŸãšã«æ¸ˆã‚€ã€‚è©³ã—ãã¯ã€ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰é€šçŸ¥ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ãƒ»æ¨™æº–ç™»éŒ²ã•ã‚ŒãŸFacadeã‚¯ãƒ©ã‚¹ã®ç¨®é¡ ä»¥ä¸‹ã®ã‚¯ãƒ©ã‚¹ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹Facadeã§ã‚ã‚‹ã€‚ ã‚¨ã‚¤ãƒªã‚¢ã‚¹å ã‚¯ãƒ©ã‚¹å ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠçµåˆã‚­ãƒ¼ App Illuminate\\Foundation\\Application app Artisan Illuminate\\Contracts\\Console\\Kernel artisan Auth Illuminate\\Auth\\AuthManager auth Auth (Instance) Illuminate\\Contracts\\Auth\\Guard auth.driver Blade Illuminate\\View\\Compilers\\BladeCompiler blade.compiler Broadcast Illuminate\\Contracts\\Broadcasting\\Factory Broadcast (Instance) Illuminate\\Contracts\\Broadcasting\\Broadcaster Bus Illuminate\\Contracts\\Bus\\Dispatcher Cache Illuminate\\Cache\\CacheManager cache Cache (Instance) Illuminate\\Cache\\Repository cache.store Config Illuminate\\Config\\Repository config Cookie Illuminate\\Cookie\\CookieJar cookie Crypt Illuminate\\Encryption\\Encrypter encrypter DB Illuminate\\Database\\DatabaseManager db DB (Instance) Illuminate\\Database\\Connection db.connection Event Illuminate\\Events\\Dispatcher events File Illuminate\\Filesystem\\Filesystem files Gate Illuminate\\Contracts\\Auth\\Access\\Gate Hash Illuminate\\Contracts\\Hashing\\Hasher hash Lang Illuminate\\Translation\\Translator translator Log Illuminate\\Log\\LogManager log Mail Illuminate\\Mail\\Mailer mailer Notification Illuminate\\Notifications\\ChannelManager Password Illuminate\\Auth\\Passwords\\PasswordBrokerManager auth.password Password (Instance) Illuminate\\Auth\\Passwords\\PasswordBroker auth.password.broker Queue Illuminate\\Queue\\QueueManager queue Queue (Instance) Illuminate\\Contracts\\Queue\\Queue queue.connection Queue (Base Class) Illuminate\\Queue\\Queue Redirect Illuminate\\Routing\\Redirector redirect Redis Illuminate\\Redis\\RedisManager redis Redis (Instance) Illuminate\\Redis\\Connections\\Connection redis.connection Request Illuminate\\Http\\Request request Response Illuminate\\Contracts\\Routing\\ResponseFactory Response (Instance) Illuminate\\Http\\Response Route Illuminate\\Routing\\Router router Schema Illuminate\\Database\\Schema\\Builder Session Illuminate\\Session\\SessionManager session Session (Instance) Illuminate\\Session\\Store session.store Storage Illuminate\\Filesystem\\FilesystemManager filesystem Storage (Instance) Illuminate\\Contracts\\Filesystem\\Filesystem filesystem.disk URL Illuminate\\Routing\\UrlGenerator url Validator Illuminate\\Validation\\Factory validator Validator (Instance) Illuminate\\Validation\\Validator View Illuminate\\View\\Factory view View (Instance) Illuminate\\View\\View Authãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ ãƒ»Authãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã¨ã¯ èªè¨¼ã«é–¢ã™ã‚‹å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚Laravelã‹ã‚‰ã‚ã‚‰ã‹ã˜ã‚æä¾›ã•ã‚Œã¦ã„ã‚‹èªè¨¼ã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€Authãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã€èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã§ãã‚‹ã€‚ DBãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ ãƒ»DBãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã¨ã¯ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ“ä½œå‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚Eloquentã®ä»£ã‚ã‚Šã«ã€DBãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã‚‚è‰¯ã„ã€‚Active Recordã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒãŸãªã„ãŸã‚ã€Repositoryãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ­ã‚¸ãƒƒã‚¯ã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ ãƒ»transactionãƒ¡ã‚½ãƒƒãƒ‰ ä¸€é€£ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚å¼•æ•°ã¨ã—ã¦æ¸¡ã—ãŸç„¡åé–¢æ•°ãŒä¾‹å¤–ã‚’è¿”å´ã—ãŸå ´åˆã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã€‚ä¾‹å¤–ãŒç™ºç”Ÿã—ãªã‹ã£ãŸå ´åˆã€ç„¡åé–¢æ•°ã®è¿”å´å€¤ãŒã€ãã®ã¾ã¾transactionãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ã«ãªã‚‹ã€‚ã•ã‚‰ã«transactionãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ã‚’è¿”å´ã™ã‚‹ã‚ˆã†ã«ã™ã‚Œã°ã€ç„¡åé–¢æ•°ã®è¿”å´å€¤ã‚’ãã®ã¾ã¾ä½¿ç”¨ã§ãã‚‹ã€‚ã¡ãªã¿ã«ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã¯å¿…é ˆã§ã¯ãªãã€ç”¨ã„ã‚‹ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹ãŸã‚ã«è¦ã™ã‚‹æ™‚é–“ãŒå¢—ãˆã‚‹ãŸã‚ã€ä½¿ç”¨ã—ãªãã¦ã‚‚è‰¯ã„ã€‚å‚è€ƒãƒªãƒ³ã‚¯ã«ã‚ˆã‚‹ã¨ã€MongoDBã«å¯¾ã—ã¦ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’è¡Œã†ï¼è¡Œã‚ãªã„å ´åˆã‚’æ¯”è¼ƒã—ã¦ã€å‡¦ç†æ™‚é–“ãŒ17%å¼±é•·ããªã£ãŸã¨ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://rightcode.co.jp/blog/information-technology/node-js-mongodb-transaction-function-use#i-5 ï¼Šå®Ÿè£…ä¾‹ï¼Š fooDTO = $fooDTO; } /** * @param Foo $foo * @throws Throwable */ public function save(Foo $foo): void { // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’é–‹å§‹ã™ã‚‹ã€‚ DB::beginTransaction(); try { $this->fooDTO->fill([ \"name\" => $foo->name(), \"age\" => $foo->age(), ]) ->save(); // ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚ DB::commit(); } catch (Exception $e) { // ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ DB::rollback(); } } } ãƒ»beginTransactionãƒ¡ã‚½ãƒƒãƒ‰ã€commitãƒ¡ã‚½ãƒƒãƒ‰ã€rollbackãƒ¡ã‚½ãƒƒãƒ‰ã€ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã®å„æ“ä½œã‚’åˆ†å‰²ã—ã¦å®Ÿè¡Œã™ã‚‹ã€‚åŸºæœ¬çš„ã«ã¯ã€transactionãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚Œã°è‰¯ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š fooDTO = $fooDTO; } /** * Fooã‚’æ›´æ–°ã—ã¾ã™ã€‚ * * @param Foo $foo */ public function save(Foo $foo) { // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’é–‹å§‹ã™ã‚‹ã€‚ DB::beginTransaction(); try { $this->fooDTO // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚ ->fill([ \"name\" => $foo->name(), \"age\" => $foo->age(), \"email\" => $foo->email() ]) // updateæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ->save(); // ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚ DB::commit(); } catch (\\Exception $e) { // ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ DB::rollback(); } } } Routeãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ ãƒ»Routeãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã¨ã¯ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚ ãƒ»ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã¸ã®å¯¾å¿œ ALBã‚„Global Acceleratorã‹ã‚‰ã€/healthcheckã€ã«å¯¾ã—ã¦ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’è¨­å®šã—ãŸä¸Šã§ã€200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚Nginxã§ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ãŒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­»æ´»ç®¡ç†ã¨ã—ã¦ã¯ã€Laravelã«å®Ÿè£…ã™ã‚‹æ–¹ãŒé©åˆ‡ã§ã‚ã‚‹ã€‚RouteServiceProviderã‚‚å‚ç…§ã›ã‚ˆã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»middlewareãƒ¡ã‚½ãƒƒãƒ‰ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«å®Ÿè¡Œã™ã‚‹Middlewareã‚¯ãƒ©ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚å¼•æ•°ã¨ã—ã¦ã€App\\Http\\Kernel.phpãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã•ã‚ŒãŸMiddlewareã‚¯ãƒ©ã‚¹ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š èªè¨¼æ–¹æ³•ã¨ã—ã¦Webã‚¬ãƒ¼ãƒ‰ã‚’ç”¨ã„ã‚‹å ´åˆã€authã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ group(function () { Route::get(\"/foos\", [FooController::class, \"getFoo\"]); Route::get(\"/foos/{fooId}\", [FooController::class, \"index\"]); Route::post(\"/foos\", [FooController::class, \"createFoo\"]); Route::put(\"/foos/{fooId}\", [FooController::class, \"updateFoo\"]); Route::delete(\"/foos/{fooId}\", [FooController::class, \"deleteFoo\"]); }); ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€App\\Http\\Kernel.phpãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€authã‚¨ã‚¤ãƒªã‚¢ã‚¹ã«\\App\\Http\\Middleware\\Authenticateã‚¯ãƒ©ã‚¹ãŒç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ \\App\\Http\\Middleware\\Authenticate::class, ]; // ï½ ä¸­ç•¥ ï½ } ä¸€æ–¹ã§ã€èªè¨¼æ–¹æ³•ã¨ã—ã¦APIã‚¬ãƒ¼ãƒ‰ã‚’ç”¨ã„ã‚‹å ´åˆã€auth:apiã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ group(function () { // ä½•ã‚‰ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° }); ãƒ»prefixãƒ¡ã‚½ãƒƒãƒ‰ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå…±é€šã¨ã—ã¦æŒã¤æœ€åˆã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ã€ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æœ€åˆã®ã€foosã€ã‚’ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚ group(function () { Route::get(\"/\", [FooController::class, \"getFoo\"]); Route::get(\"/{fooId}\", [FooController::class, \"index\"]); Route::post(\"/\", [FooController::class, \"createFoo\"]); Route::put(\"/{fooId}\", [FooController::class, \"updateFoo\"]); Route::delete(\"/{fooId}\", [FooController::class, \"deleteFoo\"]); }); ãƒ»whereãƒ¡ã‚½ãƒƒãƒ‰ã€patternãƒ¡ã‚½ãƒƒãƒ‰ ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’æ­£è¦è¡¨ç¾ã§å®šç¾©ã—ã€ã¾ãŸå®Ÿè¡Œã™ã‚‹ã€‚RouteServiceProviderã®bootãƒ¡ã‚½ãƒƒãƒ‰ã«ã¦ã€patternãƒ¡ã‚½ãƒƒãƒ‰ã§åˆ¶ç´„ã‚’è¨­å®šã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«whereã‚’ç”¨ã„ã‚‹å¿…è¦ãŒãªããªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š userIdã®å½¢å¼ã‚’ã€0ã€œ9ãŒä¸€ã¤ä»¥ä¸Šã€ã«è¨­å®šã—ã¦ã„ã‚‹ã€‚ group(function () { Route::get(\"/\", [FooController::class, \"getFoo\"]); Route::get(\"/{fooId}\", [FooController::class, \"index\"]) // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ« ->where(\"fooId\", \"[0-9]+\"); Route::post(\"/\", [FooController::class, \"createFoo\"]); Route::put(\"/{fooId}\", [FooController::class, \"updateFoo\"]) ->where(\"fooId\", \"[0-9]+\"); Route::delete(\"/{fooId}\", [FooController::class, \"deleteFoo\"]) ->where(\"fooId\", \"[0-9]+\"); }); ã¾ãŸã¯ã€RouteServiceProviderã‚¯ãƒ©ã‚¹ã«patternãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã™ã‚‹ã¨ã€å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã™ã‚‹æ­£è¦è¡¨ç¾ã‚’ä¸€æ‹¬ã§å®Ÿè¡Œã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/routing.html#parameters-global-constraints ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»groupãƒ¡ã‚½ãƒƒãƒ‰ è¤‡æ•°ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’çµ„ã¿åˆã‚ã›ã‚‹å ´åˆã€groupãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã¨ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®æŒ‡å®šã‚’å®šç¾©ã™ã‚‹ã€‚ \"foo\" , \"middleware\" => \"auth\"], (function () { Route::get(\"/\", [FooController::class, \"getFoo\"]); Route::get(\"/{fooId}\", [FooController::class, \"index\"]); Route::post(\"/\", [FooController::class, \"createFoo\"]); Route::put(\"/{fooId}\", [FooController::class, \"updateFoo\"]); Route::delete(\"/{fooId}\", [FooController::class, \"deleteFoo\"]); }); Storageãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ ãƒ»Storageãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã¨ã¯ ãƒ•ã‚¡ã‚¤ãƒ«ã®å…¥å‡ºåŠ›å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚ ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆéå…¬é–‹ï¼‰ã®å ´åˆ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’/storage/appãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã™ã‚‹ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯éå…¬é–‹ã§ã‚ã‚Šã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã‚ˆã£ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã€‚äº‹å‰ã«ã€ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹ã€ã¾ãŸã€filesystems.phpãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®šãŒå¿…è¦ã§ã‚ã‚‹ã€‚ $ php artisan storage:link return [ \"default\" => env(\"FILESYSTEM_DRIVER\", \"local\"), // ï½ ä¸­ç•¥ ï½ \"disks\" => [ \"local\" => [ \"driver\" => \"local\", \"root\" => storage_path(\"app\"), ], // ï½ ä¸­ç•¥ ï½ // ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã®é–¢ä¿‚ã‚’å®šç¾© \"links\" => [ // ã€/var/www/project/public/storageã€ã‹ã‚‰ã€/var/www/project/storage/app/publicã€ã¸ã®ãƒªãƒ³ã‚¯ public_path(\"storage\") => storage_path(\"app/public\"), ], ]; ï¼Šå®Ÿè£…ä¾‹ï¼Š Storageãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®diskãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦localãƒ‡ã‚£ã‚¹ã‚¯ã‚’æŒ‡å®šã™ã‚‹ã€‚file.txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’storage/app/file.txtã¨ã—ã¦ä¿å­˜ã™ã‚‹ã€‚ Storage::disk(\"local\")->put(\"file.txt\", \"file.txt\"); ãŸã ã—ã€filesytems.phpãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ã‚¹ã‚¯ã¯localã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€putãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›´æ¥ä½¿ç”¨ã§ãã‚‹ã€‚ Storage::put(\"file.txt\", \"file.txt\"); ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆå…¬é–‹ï¼‰ã®å ´åˆ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’storage/app/publicãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã™ã‚‹ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å…¬é–‹ã§ã‚ã‚Šã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã‚ˆã£ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚äº‹å‰ã«ã€filesystems.phpãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®šãŒå¿…è¦ã§ã‚ã‚‹ã€‚ return [ \"default\" => env(\"FILESYSTEM_DRIVER\", \"local\"), // ï½ ä¸­ç•¥ ï½ \"disks\" => [ // ï½ ä¸­ç•¥ ï½ \"public\" => [ \"driver\" => \"local\", \"root\" => storage_path(\"app/public\"), \"url\" => env(\"APP_URL\") . \"/storage\", \"visibility\" => \"public\", ], // ï½ ä¸­ç•¥ ï½ ], ]; ï¼Šå®Ÿè£…ä¾‹ï¼Š Storageãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®diskãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦publicãƒ‡ã‚£ã‚¹ã‚¯ã‚’æŒ‡å®šã™ã‚‹ã€‚ã¾ãŸã€file.txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’storage/app/public/file.txtã¨ã—ã¦ä¿å­˜ã™ã‚‹ã€‚ Storage::disk(\"s3\")->put(\"file.txt\", \"file.txt\"); ãŸã ã—ã€ç’°å¢ƒå¤‰æ•°ã‚’ç”¨ã„ã¦ã€filesytems.phpãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ã‚¹ã‚¯ã‚’s3ã«å¤‰æ›´ã™ã‚‹ã¨ã€putãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›´æ¥ä½¿ç”¨ã§ãã‚‹ã€‚ FILESYSTEM_DRIVER=s3 Storage::put(\"file.txt\", \"file.txt\"); ï¼Šå®Ÿè£…ä¾‹ï¼Š put($saved_file_path, $contents); } } ãƒ»ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å ´åˆ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’S3ãƒã‚±ãƒƒãƒˆå†…ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã™ã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã‚’.envãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚filesystems.phpãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€æŒ‡å®šã•ã‚ŒãŸè¨­å®šãŒé¸æŠã•ã‚Œã‚‹ã€‚AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®èªè¨¼æƒ…å ±ã‚’ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦è¨­å®šã™ã‚‹ã‹ã€ã¾ãŸã¯S3ã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼ã‚’EC2ã‚„ECSã‚¿ã‚¹ã‚¯ã«ä»˜ä¸ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€S3ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚äº‹å‰ã«ã€filesystems.phpãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®šãŒå¿…è¦ã§ã‚ã‚‹ã€‚ # S3ã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼ã‚’EC2ã‚„ECSã‚¿ã‚¹ã‚¯ã«ä»˜ä¸ã—ã¦ã‚‚ã‚ˆã„ AWS_ACCESS_KEY_ID= AWS_SECRET_ACCESS_KEY= AWS_DEFAULT_REGION= # å¿…é ˆ AWS_BUCKET= return [ \"default\" => env(\"FILESYSTEM_DRIVER\", \"local\"), // ï½ ä¸­ç•¥ ï½ \"disks\" => [ // ï½ ä¸­ç•¥ ï½ \"s3\" => [ \"driver\" => \"s3\", \"key\" => env(\"AWS_ACCESS_KEY_ID\"), \"secret\" => env(\"AWS_SECRET_ACCESS_KEY\"), \"region\" => env(\"AWS_DEFAULT_REGION\"), \"bucket\" => env(\"AWS_BUCKET\"), \"url\" => env(\"AWS_URL\"), \"endpoint\" => env(\"AWS_ENDPOINT\"), ], ], ]; ï¼Šå®Ÿè£…ä¾‹ï¼Š Storageãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®diskãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦s3ãƒ‡ã‚£ã‚¹ã‚¯ã‚’æŒ‡å®šã™ã‚‹ã€‚ã¾ãŸã€file.txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’S3ãƒã‚±ãƒƒãƒˆã®ãƒ«ãƒ¼ãƒˆã«file.txtã¨ã—ã¦ä¿å­˜ã™ã‚‹ã€‚ Storage::disk(\"s3\")->put(\"file.txt\", \"file.txt\"); ä»–ã®å®Ÿè£…æ–¹æ³•ã¨ã—ã¦ã€ç’°å¢ƒå¤‰æ•°ã‚’ç”¨ã„ã¦ã€filesytems.phpãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ã‚¹ã‚¯ã‚’s3ã«å¤‰æ›´ã™ã‚‹ã¨ã€putãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›´æ¥ä½¿ç”¨ã§ãã‚‹ã€‚ FILESYSTEM_DRIVER=s3 Storage::put(\"file.txt\", \"file.txt\"); Validatorãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ ãƒ»Validatorãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã¨ã¯ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚FormRequestã‚¯ãƒ©ã‚¹ã®validatedãƒ¡ã‚½ãƒƒãƒ‰ã‚„validateãƒ¡ã‚½ãƒƒãƒ‰ã®ä»£ã‚ã‚Šã«ã€Validatorãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã‚‚è‰¯ã„ã€‚ ãƒ»Validatorã‚¯ãƒ©ã‚¹ã€failsãƒ¡ã‚½ãƒƒãƒ‰ Validateãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®makeãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã®æ™‚ã€ç¬¬ä¸€å¼•æ•°ã§ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã€‚ãƒ«ãƒ¼ãƒ«ã«åã™ã‚‹ã¨ã€ä¸€ã¤ç›®ã®ãƒ«ãƒ¼ãƒ«åï¼ˆä¾‹ãˆã°requiredï¼‰ã«åŸºã¥ãã€validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¯¾å¿œã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•çš„ã«é¸æŠã™ã‚‹ã€‚æ¬¡ã«ã€failsãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆã®å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š all(), [ \"title\" => \"required|unique:posts|max:255\", \"body\" => \"required\", ]); // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆ if ($validator->fails()) { // æŒ‡å®šã—ãŸãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ // validatorã‚’æ¸¡ã™ã“ã¨ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Viewã«æ¸¡ã›ã‚‹ã€‚ return redirect(\"error\")->withErrors($validator) ->withInput(); } // ç¶šãã®å‡¦ç† } } ãƒ»validateãƒ¡ã‚½ãƒƒãƒ‰ Validatorã‚¯ãƒ©ã‚¹ã®validateãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã¨ã€FormRequestã‚¯ãƒ©ã‚¹ã®validateãƒ¡ã‚½ãƒƒãƒ‰ã¨åŒæ§˜ã®å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆã€Handlerã‚¯ãƒ©ã‚¹ã®invalidãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€å…ƒã€…ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã€‚ all(), [ \"title\" => \"required|unique:posts|max:255\", \"body\" => \"required\", ])->validate(); // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆ if ($validator->fails()) { // æŒ‡å®šã—ãŸãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ // validatorã‚’æ¸¡ã™ã“ã¨ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Viewã«æ¸¡ã›ã‚‹ã€‚ return redirect(\"error\")->withErrors($validator) ->withInput(); } // ç¶šãã®å‡¦ç† } } 08-02. ã‚ˆãä½¿ã†ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•° ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•° ãƒ»ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã¨ã¯ ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚³ãƒ¼ãƒ«ã§ãã‚‹Laravelå°‚ç”¨ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®ã“ã¨ã€‚åŸºæœ¬çš„ã«ã¯ã€ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã§å®Ÿè¡Œã•ã‚Œã‚‹å‡¦ç†ã¯ã€Facadeã®å†…éƒ¨ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚‚ã®ã¨åŒã˜ã§ã‚ã‚‹ã€‚ã©ã¡ã‚‰ã‚’ç”¨ã„ã‚‹ã‹ã¯å¥½ã¿ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://stackoverflow.com/questions/31324226/laravel-performance-of-facades-vs-helper-methods ãƒ»ä¸€è¦§ ä»¥ä¸‹ãƒªãƒ³ã‚¯ã‚’å‚ç…§ã›ã‚ˆã€‚ https://readouble.com/laravel/8.x/ja/helpers.html#method-view authãƒ˜ãƒ«ãƒ‘ãƒ¼ ãƒ»AuthManagerã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®è¿”å´ èªè¨¼å‡¦ç†ã‚’æŒã¤AuthManagerã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”å´ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Auth/AuthManager.html configãƒ˜ãƒ«ãƒ‘ãƒ¼ ãƒ»ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«åã¨ã‚­ãƒ¼åã‚’ãƒ‰ãƒƒãƒˆã§æŒ‡å®šã—ã€äº‹å‰ã«è¨­å®šã•ã‚ŒãŸå€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¨™æº–ã§æ­è¼‰ã•ã‚Œã¦ã„ã‚‹app.phpãƒ•ã‚¡ã‚¤ãƒ«ã®timezoneã‚­ãƒ¼ã®å€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ãƒ»ç‹¬è‡ªç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã¨èª­ã¿è¾¼ã¿ configãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä»»æ„ã®åå‰ã®phpå½¢å¼ã‚’ä½œæˆã—ã¦ãŠãã€‚ã“ã‚Œã¯ã€configãƒ˜ãƒ«ãƒ‘ãƒ¼ã§èª­ã¿è¾¼ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [ \"endpoint_url\" => env(\"ENDPOINT_URL\", \"\"), \"api_key\" => env(\"API_KEY\"), ], \"bar\" => [ \"endpoint_url\" => env(\"ENDPOINT_URL\", \"\"), \"api_key\" => env(\"API_KEY\"), ] ]; bcryptãƒ˜ãƒ«ãƒ‘ãƒ¼ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/helpers.html#method-bcrypt redirectãƒ˜ãƒ«ãƒ‘ãƒ¼ å‚è€ƒï¼šhttps://blog.capilano-fw.com/?p=566 responseãƒ˜ãƒ«ãƒ‘ãƒ¼ ãƒ»JSONãƒ‡ãƒ¼ã‚¿ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ è¿”å´ã•ã‚Œã‚‹ResponseFactoryã‚¯ãƒ©ã‚¹ã®jsonãƒ¡ã‚½ãƒƒãƒ‰ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ãŸã„JSONãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚responseãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯åˆæœŸå€¤ã¨ã—ã¦200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãŒã€viewãƒ¡ã‚½ãƒƒãƒ‰ã‚„setStatusCodeãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€æ˜ç¤ºçš„ã«è¨­å®šã—ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://github.com/laravel/framework/blob/8.x/src/Illuminate/Contracts/Routing/ResponseFactory.php ï¼Šå®Ÿè£…ä¾‹ï¼Š json([ \"name\" => \"Abigail\", \"state\" => \"CA\" ], 200); } } ãƒ»Viewãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ è¿”å´ã•ã‚Œã‚‹ResponseFactoryã‚¯ãƒ©ã‚¹ã®viewãƒ¡ã‚½ãƒƒãƒ‰ã«ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€arrayå‹ãƒ‡ãƒ¼ã‚¿ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ãªã©ï¼‰ã‚’è¨­å®šã™ã‚‹ã€‚ã¾ãŸã€Viewã‚¯ãƒ©ã‚¹ã®headerãƒ¡ã‚½ãƒƒãƒ‰ã«HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã®å€¤ã‚’è¨­å®šã™ã‚‹ã€‚responseãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯åˆæœŸå€¤ã¨ã—ã¦200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãŒã€viewãƒ¡ã‚½ãƒƒãƒ‰ã‚„setStatusCodeãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€æ˜ç¤ºçš„ã«è¨­å®šã—ã¦ã‚‚ã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š view( \"foo\", $data, 200 )->header( \"Content-Type\", $type ); } } view(\"foo\") ->setStatusCode(200); } } routeãƒ˜ãƒ«ãƒ‘ãƒ¼ ãƒ»ãƒ«ãƒ¼ãƒˆã‚¨ã‚¤ãƒªã‚¢ã‚¹ã«åŸºã¥ã„ã¦URLç”Ÿæˆ ãƒ«ãƒ¼ãƒˆã«ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãŒã¤ã„ã¦ã„ã‚‹å ´åˆã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã«å¿œã˜ã¦URLã‚’ç”Ÿæˆã™ã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯è‡ªå‹•ã§è£œå®Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/helpers.html#method-route name('foos_index'); // https://example.co.jp/foos $url = route('foos_index'); pathç³»ãƒ˜ãƒ«ãƒ‘ãƒ¼ ãƒ»base_pathãƒ˜ãƒ«ãƒ‘ãƒ¼ å¼•æ•°ã‚’è¨­å®šã—ãªã„å ´åˆã€projectãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã€‚ã¾ãŸã€projectãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã‚’å¼•æ•°ã¨ã—ã¦ã€çµ¶å¯¾ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã€‚ ãƒ»public_pathãƒ˜ãƒ«ãƒ‘ãƒ¼ å¼•æ•°ã‚’è¨­å®šã—ãªã„å ´åˆã€publicãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã€‚ã¾ãŸã€publicãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã‚’å¼•æ•°ã¨ã—ã¦ã€çµ¶å¯¾ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã€‚ ãƒ»storage_pathãƒ˜ãƒ«ãƒ‘ãƒ¼ å¼•æ•°ã‚’è¨­å®šã—ãªã„å ´åˆã€storageãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã€‚ã¾ã‚ã€storageãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã‚’å¼•æ•°ã¨ã—ã¦ã€çµ¶å¯¾ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã€‚ urlãƒ˜ãƒ«ãƒ‘ãƒ¼ ãƒ»ãƒ‘ã‚¹ã«åŸºã¥ã„ã¦URLç”Ÿæˆ æŒ‡å®šã—ãŸãƒ‘ã‚¹ã«å¿œã˜ã¦URLã‚’ç”Ÿæˆã™ã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯è‡ªå‹•ã§è£œå®Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/5.7/ja/urls.html 09. Factory artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»Factoryã®ç”Ÿæˆ $ php artisan make:factory --model= åˆæœŸå€¤ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å®šç¾© ãƒ»Fakerã«ã‚ˆã‚‹ãƒ©ãƒ³ãƒ€ãƒ å€¤ç”Ÿæˆ Fakerã¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å€¤ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã™ã‚‹ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã‚ã‚‹ã€‚Farkerã‚¯ãƒ©ã‚¹ã¯ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã—ã¦ã„ã‚‹ã€‚ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç‰¹ã«ã€Formattersã¨ã„ã†ã€‚ å‚è€ƒï¼šhttps://fwhy.github.io/faker-docs/ ãƒ»Factoryã«ã‚ˆã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰å®šç¾© ï¼Šå®Ÿè£…ä¾‹ï¼Š $this->faker->name, 'email_address' => $this->faker->unique()->safeEmail, 'password' => 'password', ]; } } ãƒ»HasFactoryãƒˆãƒ¬ã‚¤ãƒˆ Factoryã«å¯¾å¿œã™ã‚‹Eloquentãƒ¢ãƒ‡ãƒ«ã§ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/database-testing.html#creating-models-using-factories class Foo { use HasFactory; } åˆæœŸãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®é‡ç”£ ãƒ»Seederã«ã‚ˆã‚‹ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿é‡ç”£ Factoryã«ãŠã‘ã‚‹å®šç¾©ã‚’åŸºã«ã—ã¦ã€æŒ‡å®šã—ãŸæ•°ã ã‘ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’é‡ç”£ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š FooSeederã‚’å®šç¾©ã—ã€50å€‹ã®ãƒ€ãƒŸãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ‡ãƒ¼ã‚¿ã‚’é‡ç”£ã™ã‚‹ã€‚ count(self::NUM_TEST_DATA)->create(); } } ã¾ãŸã€BarSeederã‚’å®šç¾©ã—ã€50å€‹ã®ãƒ€ãƒŸãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ‡ãƒ¼ã‚¿ã‚’é‡ç”£ã™ã‚‹ã€‚ count(self::NUM_TEST_DATA)->create(); } } DatabaseSeederã«ã¦ã€å…¨ã¦ã®Seederã‚’ã¾ã¨ã‚ã¦å®Ÿè¡Œã™ã‚‹ã€‚ environment(\"dev\")) { $this->call([ // ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ FooSeeder::class, BarSeeder::class ]); } // ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒç”¨ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ if (app()->environment(\"stg\")) { $this->call([ // ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ ]); } // æœ¬ç•ªç’°å¢ƒç”¨ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ if (app()->environment(\"prd\")) { $this->call([ // ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ ]); } } } 10. HTTPï½œController artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»ã‚¯ãƒ©ã‚¹ã®è‡ªå‹•ç”Ÿæˆ # ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ä½œæˆ $ php artisan make:controller ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å–å¾— ãƒ»ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã®ä¸¡æ–¹ã‚’å–å¾—ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/requests.html#retrieving-input ï¼Šå®Ÿè£…ä¾‹ï¼Š all(); // å…¨ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é€£æƒ³é…åˆ—ã§å–å¾—ã™ã‚‹ã€‚ $foo = $request->input('foo'); // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ $qux = $request->input('foo.qux'); // ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ $params = $request->only(['foo', 'bar']); // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é€£æƒ³é…åˆ—ã§å–å¾—ã™ã‚‹ã€‚ $params = $request->except(['baz']); // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»¥å¤–ã‚’é€£æƒ³é…åˆ—ã§å–å¾—ã™ã‚‹ã€‚ $foo = $request->foo; // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ $foo = request('foo'); // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ } } ãƒ»ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/requests.html#retrieving-input ï¼Šå®Ÿè£…ä¾‹ï¼Š query(); // å…¨ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é€£æƒ³é…åˆ—ã§å–å¾—ã™ã‚‹ã€‚ $foo = $request->query('foo'); // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ } } ãƒ»ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€‚ å‚è€ƒï¼š https://laravel.com/api/8.x/Illuminate/Http/Request.html#method_route https://laravel.com/api/8.x/Illuminate/Routing/Route.html#method_parameter ï¼Šå®Ÿè£…ä¾‹ï¼Š route(); // å…¨ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é€£æƒ³é…åˆ—ã§å–å¾—ã™ã‚‹ã€‚ $fooId = $request->route('fooId'); // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ $fooId = $request->route->parameter('fooId'); // æŒ‡å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ } } ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ç¬¬äºŒå¼•æ•°ã«ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ã§ã€ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã‚’å–å¾—ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 10-02. HTTPï½œMiddleware artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»ã‚¯ãƒ©ã‚¹ã®è‡ªå‹•ç”Ÿæˆ Middlewareã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã€‚ $ php artisan make:middleware Middlewareã®ä»•çµ„ã¿ ãƒ»Middlewareã®ç¨®é¡ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å¾Œã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¡ã‚½ãƒƒãƒ‰ã®å‰ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹BeforeMiddleã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å®Ÿè¡Œæ™‚ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹AfterMiddlewareãŒã‚ã‚‹ ãƒ»BeforeMiddleware ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ¼ãƒ«å‰ã«å®Ÿè¡Œã™ã‚‹å‡¦ç†ã‚’è¨­å®šã§ãã‚‹ã€‚ä¸€é€£ã®å‡¦ç†ã‚’çµ‚ãˆãŸå¾Œã€FormRequestã‚¯ãƒ©ã‚¹ã‚’ã€æ¬¡ã®Middlewareã‚¯ãƒ©ã‚¹ã‚„Controllerã‚¯ãƒ©ã‚¹ã«æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã‚Œã‚‰ã®ã‚¯ãƒ©ã‚¹ã¯Closureï¼ˆç„¡åé–¢æ•°ï¼‰ã¨ã—ã¦ã€nextå¤‰æ•°ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»AfterMiddleware ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å®Ÿè¡Œå¾Œï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’å«ã‚€ï¼‰ã«å®Ÿè¡Œã™ã‚‹å‡¦ç†ã‚’è¨­å®šã§ãã‚‹ã€‚ã‚ã‚‰ã‹ã˜ã‚ã€FormRequestã‚¯ãƒ©ã‚¹ã‚’ã€å‰ã®Middlewareã‚¯ãƒ©ã‚¹ã‚„Controllerã‚¯ãƒ©ã‚¹ã‹ã‚‰å—ã‘å–ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã‚Œã‚‰ã®ã‚¯ãƒ©ã‚¹ã¯Closureï¼ˆç„¡åé–¢æ•°ï¼‰ã¨ã—ã¦ã€nextå¤‰æ•°ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¨™æº–ã®Middleware ãƒ»EncryptCookies ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®å…¨ã¦ã®å€¤ã‚’æš—å·åŒ–ã™ã‚‹ã€‚æš—å·åŒ–ã—ãŸããªã„å ´åˆã¯ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚­ãƒ¼åã‚’exceptãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://reffect.co.jp/laravel/laravel-sessions-understand#cookie-2 ãƒ»StartSession ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®é–‹å§‹ã®èµ·ç‚¹ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/wim/items/b1db5202cce6b38bc47b ã¾ãŸã€åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ä¸€æ„ãªCSRFãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ã€‚CSRFãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚ˆã‚‹CSRFã®é˜²å¾¡ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/security/security_cyber_attacks.html ãƒ»VerifyCsrfToken ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ã‹ã‚ŒãŸCSRFãƒˆãƒ¼ã‚¯ãƒ³ã¨ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¯”è¼ƒã™ã‚‹ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã¯storage/framework/sessionsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã€‚ä¸€èˆ¬çš„ã«ã€CSRFãƒˆãƒ¼ã‚¯ãƒ³ã¯Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ãŒã€Laravelã§ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/csrf.html#preventing-csrf-requests ã‚³ãƒ¼ãƒ«æ–¹æ³•ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º ãƒ»Kernel Middlewareã‚¯ãƒ©ã‚¹ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹æ™‚ã®æ–¹æ³•ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [ ], 'api' => [ 'throttle:60,1', \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, ], ]; /** * ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã¨å€‹åˆ¥ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’å®šç¾©ã—ã¾ã™ã€‚ * * @var array */ protected $routeMiddleware = [ 'auth' => \\App\\Http\\Middleware\\Auth\\Authenticate::class, 'auth.basic' => \\Illuminate\\Auth\\Middleware\\AuthenticateWithBasicAuth::class, 'bindings' => \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, 'cache.headers' => \\Illuminate\\Http\\Middleware\\SetCacheHeaders::class, 'can' => \\Illuminate\\Auth\\Middleware\\Authorize::class, 'guest' => \\App\\Http\\Middleware\\Auth\\RedirectIfAuthenticated::class, 'password.confirm' => \\Illuminate\\Auth\\Middleware\\RequirePassword::class, 'signed' => \\Illuminate\\Routing\\Middleware\\ValidateSignature::class, 'throttle' => \\Illuminate\\Routing\\Middleware\\ThrottleRequests::class, 'verified' => \\Illuminate\\Auth\\Middleware\\EnsureEmailIsVerified::class, // FooãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚¯ãƒ©ã‚¹ 'foo' => \\App\\Http\\Middleware\\Before\\FooMiddleware::class ]; /** * ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹é †ç•ªã‚’å®šç¾©ã—ã¾ã™ã€‚ * * @var string[] */ protected $middlewarePriority = [ \\Illuminate\\Session\\Middleware\\StartSession::class, \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class, \\App\\Http\\Middleware\\Auth\\Authenticate::class, \\Illuminate\\Routing\\Middleware\\ThrottleRequests::class, \\Illuminate\\Session\\Middleware\\AuthenticateSession::class, \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, \\Illuminate\\Auth\\Middleware\\Authorize::class, ]; } 10-03. HTTPï½œFormRequest artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»ã‚¯ãƒ©ã‚¹ã®è‡ªå‹•ç”Ÿæˆ FormRequestã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ä½œæˆã™ã‚‹ã€‚ $ php artisan make:request ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ»ãƒ«ãƒ¼ãƒ«å®šç¾© ï¼† ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹å‹•å®Ÿè¡Œ åŒã˜ãFormRequestã‚¯ãƒ©ã‚¹ã®validateãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã€ã•ã‚‰ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚validatedãƒ¡ã‚½ãƒƒãƒ‰ã¨é–“é•ã‚ãªã„ã‚ˆã†ã«æ³¨æ„ã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒ«ã«åã™ã‚‹ã¨ã€ä¸€ã¤ç›®ã®ãƒ«ãƒ¼ãƒ«åï¼ˆä¾‹ãˆã°requiredï¼‰ã«åŸºã¥ãã€validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¯¾å¿œã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•çš„ã«é¸æŠã™ã‚‹ã€‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆã€Handlerã‚¯ãƒ©ã‚¹ã®invalidãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€å…ƒã€…ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/7.x/ja/validation.html#creating-form-requests https://laravel.com/api/8.x/Illuminate/Http/Request.html#method_validate ï¼Šå®Ÿè£…ä¾‹ï¼Š validate([ \"limit\" => [\"required\", Rule::in([25, 50, 100])], \"order\" => [\"required\", Rule::in([\"ascend\", \"descend\"])], ]); // ç¶šãã®å‡¦ç† } /** * @param Request $request */ public function update(Request $request) { // ãƒ«ãƒ¼ãƒ«ã®å®šç¾©ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ // ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆã¯å…ƒã€…ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ $validated = $request->validate([ \"title\" => [\"required\", \"string\", \"max:255\"], \"body\" => [\"required\", \"string\", \"max:255\"], \"date\" => [\"required\", \"date\"], ]); // ç¶šãã®å‡¦ç† } } ãªãŠã€ãƒ«ãƒ¼ãƒ«ã«ã‚ˆã£ã¦ã¯ã€é…åˆ—ã‚’ä½¿ç”¨ã›ãšã¨ã‚‚å®šç¾©ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š validate([ \"title\" => \"required|string|max:5255\", \"body\" => \"required|string|max:255\", \"date\" => \"required|date\", ]); // ç¶šãã®å‡¦ç† } } ãƒ»ãƒ«ãƒ¼ãƒ«å®šç¾© & ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è‡ªå‹•å®Ÿè¡Œ Controllerã§ã€FormRequestã‚¯ãƒ©ã‚¹ã‚’å¼•æ•°ã«æŒ‡å®šã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹å‰ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã€‚ãã®ãŸã‚ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ä¸­ã§ã¯ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ä»£ã‚ã‚Šã«ã€ãƒ«ãƒ¼ãƒ«ã‚’FormRequestã‚¯ãƒ©ã‚¹ã®ruleãƒ¡ã‚½ãƒƒãƒ‰ã«å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚FormRequestã‚¯ãƒ©ã‚¹ã®validatedãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¸ˆã¿ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹ã€‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆã€Handlerã‚¯ãƒ©ã‚¹ã®invalidãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€å…ƒã€…ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š validated(); // ç¶šãã®å‡¦ç† } /** * @param Request $request */ public function update(Request $request) { // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ // ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆã¯å…ƒã€…ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ $validated = $request->validated(); // ç¶šãã®å‡¦ç† } } FormRequestã‚¯ãƒ©ã‚¹ã®rulesãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒ«ã«åã™ã‚‹ã¨ã€ä¸€ã¤ç›®ã®ãƒ«ãƒ¼ãƒ«åï¼ˆä¾‹ãˆã°requiredï¼‰ã«åŸºã¥ãã€validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¯¾å¿œã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•çš„ã«é¸æŠã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [\"required\", \"string\", \"max:255\"], \"body\" => [\"required\", \"string\", \"max:255\"], \"type\" => [\"required\", Rule::in([1, 2, 3])], \"author\" => [\"required\", \"string\", new UppercaseRule()], \"date\" => [\"required\", \"date\"], ]; } } ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ»ãƒ«ãƒ¼ãƒ«ã®å®šç¾© ï¼† ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è‡ªå‹•å®Ÿè¡Œ Routeãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®patternãƒ¡ã‚½ãƒƒãƒ‰ã¾ãŸã¯whereãƒ¡ã‚½ãƒƒãƒ‰ã§å®šç¾©ã™ã‚‹ã€‚Routeãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ãƒ»æ¨™æº–ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ æ¨™æº–ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€resources/lang/ja/validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã§ãã‚‹ã€‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã£ã¦ã€validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‡ªå‹•çš„ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé¸æŠã•ã‚Œã‚‹ã€‚ä¾‹ãˆã°ãƒ«ãƒ¼ãƒ«ã¨ã—ã¦æœ€å¤§å€¤ã‚’è¨­å®šã—ãŸå ´åˆã¯ã€ãƒ‡ãƒ¼ã‚¿å‹ã«åˆã‚ã›ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé¸æŠã•ã‚Œã‚‹ã€‚æ—¥æœ¬èªç¿»è¨³validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/validation-php.html ':attributeã¯å¿…é ˆã§ã™', 'string' => ':attribute ã¯æ–‡å­—åˆ—ã®ã¿æœ‰åŠ¹ã§ã™', 'max' => [ 'numeric' => ':attributeã«ã¯ã€:maxä»¥ä¸‹ã®æ•°å­—ã‚’æŒ‡å®šã—ã¦ãã ã•ã„', 'file' => ':attributeã«ã¯ã€:max kBä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦ãã ã•ã„', 'string' => ':attributeã¯ã€:maxæ–‡å­—ä»¥ä¸‹ã§æŒ‡å®šã—ã¦ãã ã•ã„', 'array' => ':attributeã¯:maxå€‹ä»¥ä¸‹æŒ‡å®šã—ã¦ãã ã•ã„', ], 'date' => ':attribute ã‚’æœ‰åŠ¹ãªæ—¥ä»˜å½¢å¼ã«ã—ã¦ãã ã•ã„', 'attributes' => [ 'title' => 'ã‚¿ã‚¤ãƒˆãƒ«', 'body' => 'æœ¬æ–‡', 'date' => 'ä½œæˆæ—¥', ], # ã€œ ä¸­ç•¥ ã€œ ]; ãªãŠã€è¨€èªè¨­å®šã‚’è¡Œã‚ãªã„å ´åˆã€æ¨™æº–ã§ã¯/resources/lang/en/validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦å‚ç…§ã™ã‚‹ãŸã‚ã€app.phpãƒ•ã‚¡ã‚¤ãƒ«ã§è¨€èªã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã¨ã€æ—¥æœ¬èªç¿»è¨³validation.phpãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ 'ja' # ã€œ ä¸­ç•¥ ã€œ ]; ãƒ»ç”»é¢ä¸Šã§ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡ºåŠ› ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒã‚ã£ãŸå ´åˆã€Handlerã‚¯ãƒ©ã‚¹ã®invalidãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€MessageBagã‚¯ãƒ©ã‚¹ãŒViewã«æ¸¡ã•ã‚Œã‚‹ã€‚é¸æŠã•ã‚ŒãŸãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé…åˆ—å‹ã§MessageBagã‚¯ãƒ©ã‚¹ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://laravel.com/api/8.x/Illuminate/Foundation/Exceptions/Handler.html#method_invalid https://laravel.com/api/8.x/Illuminate/Support/MessageBag.html ( [title] => Array ( [0] => ã‚¿ã‚¤ãƒˆãƒ«ã®å…¥åŠ›ã¯å¿…é ˆã§ã™ [1] => ã‚¿ã‚¤ãƒˆãƒ«ã¯ã€æœ€å¤§255æ–‡å­—ä»¥ä¸‹ã§æŒ‡å®šã—ã¦ãã ã•ã„ ) [body] => Array ( [0] => æœ¬æ–‡ã®å…¥åŠ›ã¯å¿…é ˆã§ã™ [1] => æœ¬æ–‡ã¯ã€æœ€å¤§255æ–‡å­—ä»¥ä¸‹ã§æŒ‡å®šã—ã¦ãã ã•ã„ ) [data] => Array ( [0] => ä½œæˆæ—¥ã®å…¥åŠ›ã¯å¿…é ˆã§ã™ [1] => ä½œæˆæ—¥ã‚’æœ‰åŠ¹ãªæ—¥ä»˜å½¢å¼ã«ã—ã¦ãã ã•ã„ ) ) Rule ãƒ»existsãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã«å€¤ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Validation/Rule.html#method_exists [\"nullable\", \"integer\", Rule::exists(\"prefectures\", \"id\")], \"cityId\" => [\"nullable\", \"integer\", Rule::exists(\"cities\", \"id\")] ]; } } ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚«ãƒ©ãƒ æ•°ãŒå¤šã„å ´åˆã¯ã€Whereå¥ã‚’ã¤ã‘ã‚‹ã“ã¨ã§ã€ç‰¹å®šã®ã‚«ãƒ©ãƒ ã®ã¿æ¤œè¨¼ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ [\"nullable\", \"integer\", Rule::exists(\"prefectures\", \"id\")], \"cityId\" => [\"nullable\", \"integer\", Rule::exists(\"cities\", \"id\")->whereNull(\"deleted_at\")], ]; } } ãƒ»inãƒ¡ã‚½ãƒƒãƒ‰ æ±ºã‚ã‚‰ã‚ŒãŸè¤‡æ•°ã®å€¤ã«åˆè‡´ã™ã‚‹å€¤ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Validation/Rule.html#method_in [\"required\", Rule::in([1, 2, 3])], ]; } } ãƒ»ç‹¬è‡ªãƒ«ãƒ¼ãƒ«ï¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ç‹¬è‡ªãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹å ´åˆã¯ã€Ruleã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ãŸã‚¯ãƒ©ã‚¹ã‚’ç”¨æ„ã—ã€ruleãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ç‹¬è‡ªRuleã‚¯ãƒ©ã‚¹ã§ã¯ã€passesãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ã¾ãŸã€messagesãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å®šç¾©ã™ã‚‹ã€‚validation.phpãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å®šç¾©ã—ã€ã“ã‚Œã‚’å‚ç…§ã—ã¦ã‚‚è‰¯ã„ã€‚ å‚è€ƒï¼šhttps://laravel.com/docs/8.x/validation#custom-validation-rules ï¼Šå®Ÿè£…ä¾‹ï¼Š [\"required\", \"string\", new UppercaseRule()] ]; } } ã‚»ãƒƒã‚·ãƒ§ãƒ³ ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ•°ã®å–å¾— FormRequestã‚¯ãƒ©ã‚¹ã®sessionãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ•°ã‚’å–å¾—ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š session() ->get(\"key\"); } } å…¨ã¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ•°ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ $session = $request->session()->all(); ãƒ»ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿ã®è¨­å®š ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ä»Šå›ã¨æ¬¡å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã ã‘ã§æœ‰åŠ¹ãªä¸€æ™‚ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã§ãã‚‹ã€‚ $request->session() ->flash(\"status\", \"Task was successful!\"); Requestã®èªè¨¼ ãƒ»authorizeãƒ¡ã‚½ãƒƒãƒ‰ ãƒ¦ãƒ¼ã‚¶ãŒãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦CRUDæ“ä½œã‚’è¡Œã†æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‹ã‚’ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€åˆ¤å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š /** * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‹ã‚’åˆ¤æ–­ã™ã‚‹ * * @return bool */ public function authorize() { $comment = Comment::find($this->route(\"comment\")); return $comment&& $this->user()->can(\"update\", $comment); } ãƒ»Authãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ Authãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ 11. Logging ãƒ­ã‚°ã®å‡ºåŠ›å…ˆ ãƒ»è¨­å®šæ–¹æ³• ç’°å¢ƒå¤‰æ•°ã‚’.envãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã™ã‚‹ã€‚logging.phpãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€æŒ‡å®šã•ã‚ŒãŸè¨­å®šãŒé¸æŠã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/logging.html#available-channel-drivers LOG_CHANNEL= ãƒ»stackã‚­ãƒ¼ ä»–ã®å˜ä¸€ï¼è¤‡æ•°ã®ãƒãƒ£ãƒ³ãƒãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ãƒãƒ£ãƒ³ãƒãƒ«ã€‚ return [ // ï½ ä¸­ç•¥ ï½ \"default\" => env(\"LOG_CHANNEL\", \"stack\"), \"channels\" => [ \"stack\" => [ \"driver\" => \"stack\", // è¤‡æ•°ãƒãƒ£ãƒ³ãƒãƒ«ã‚’è¨­å®šå¯èƒ½ã€‚ï¼ˆä¾‹ï¼‰[\"single\", \"stack\"] \"channels\" => [\"single\"], \"ignore_exceptions\" => false, ], // ï½ ä¸­ç•¥ ï½ ] ]; ãƒ»singleã‚­ãƒ¼ å…¨ã¦ã®ãƒ­ã‚°ã‚’/storage/logs/laravel.logãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚ return [ // ï½ ä¸­ç•¥ ï½ \"default\" => env(\"LOG_CHANNEL\", \"stack\"), \"channels\" => [ \"daily\" => [ \"driver\" => \"daily\", \"path\" => storage_path(\"logs/laravel.log\"), \"level\" => env(\"LOG_LEVEL\", \"debug\"), \"days\" => 14, ], // ï½ ä¸­ç•¥ ï½ ] ]; ãƒ»dailyã‚­ãƒ¼ å…¨ã¦ã®ãƒ­ã‚°ã‚’/storage/logs/laravel-.logãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚ return [ // ï½ ä¸­ç•¥ ï½ \"default\" => env(\"LOG_CHANNEL\", \"stack\"), \"channels\" => [ \"stderr\" => [ \"driver\" => \"monolog\", \"handler\" => StreamHandler::class, \"formatter\" => env(\"LOG_STDERR_FORMATTER\"), \"with\" => [ \"stream\" => \"php://stderr\", ], ], // ï½ ä¸­ç•¥ ï½ ] ]; ãƒ»stderrã‚­ãƒ¼ å…¨ã¦ã®ãƒ­ã‚°ã‚’æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å¯¾ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚Dockerä¸Šã§Laravelã‚’ç¨¼åƒã•ã›ã‚‹å ´åˆã¯ã€ç”Ÿæˆã•ã‚Œã‚‹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚³ãƒ³ãƒ†ãƒŠã®å®¹é‡ãŒè‚¥å¤§åŒ–ã™ã‚‹ã“ã¨ã‚’é˜²ããŸã‚ã«ã€ã“ã‚Œã‚’é¸æŠã™ã‚‹ã€‚ãªãŠã€ç‹¬è‡ªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã¨ã—ã¦ã€streamã‚­ãƒ¼ã‚’stdoutå¤‰æ›´ã™ã‚Œã°ã€æ¨™æº–å‡ºåŠ›ã«ãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ return [ // ï½ ä¸­ç•¥ ï½ \"default\" => env(\"LOG_CHANNEL\", \"stack\"), \"channels\" => [ \"stderr\" => [ \"driver\" => \"monolog\", \"handler\" => StreamHandler::class, \"formatter\" => env(\"LOG_STDERR_FORMATTER\"), \"with\" => [ \"stream\" => \"php://stderr\", ], ], // ï½ ä¸­ç•¥ ï½ ] ]; ãƒ­ã‚°ã®å‡ºåŠ› ãƒ»errorãƒ¡ã‚½ãƒƒãƒ‰ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å®šç¾©ã™ã‚‹æ™‚ã€sprintfãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã¨ä¾¿åˆ©ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å¤–éƒ¨ã®APIã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€‚å–å¾—ã—ãŸJSONãƒ‡ãƒ¼ã‚¿ã‚’ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã€‚ã“ã®æ™‚ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ã®ãŸã‚ã«ã€Guzzleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ request( \"GET\", $requestUrl, [ \"headers\" => [ \"Content-Type\" => \"application/json\", \"X-API-Key\" => \"api.foo.api_key\", ] ] ); // JSONã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ return $response->getBody() ->getContents(); } catch (GuzzleException $e) { Log::error(sprintf( \"%s : %s at %s line %s\", get_class($e), $e->getMessage(), $e->getFile(), $e->getLine()) ); return response()->json( [], $e->getCode() ); } } } [ \"endpoint_url\" => env(\"ENDPOINT_URL\", \"\"), \"api_key\" => env(\"API_KEY\"), ], \"bar\" => [ \"endpoint_url\" => env(\"ENDPOINT_URL\", \"\"), \"api_key\" => env(\"API_KEY\"), ] ]; ãƒ»infoãƒ¡ã‚½ãƒƒãƒ‰ 12. Migration artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ $ php artisan make:migrate create__table ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ $ php artisan migrate ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã€ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«åã®ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã§ã€ã“ã‚ŒãŒã‚¯ãƒ©ã‚¹åã®ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã¨å¯¾å¿œã¥ã‘ã‚‰ã‚Œã¦ãŠã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«åã¨ã‚¯ãƒ©ã‚¹åã®é–¢ä¿‚ãŒæ­£ã—ããªã„ãŸã‚ã«èµ·ã“ã‚‹ã‚¨ãƒ©ãƒ¼ã§ã‚ã‚‹ã€‚ Symfony\\Component\\Debug\\Exception\\FatalThrowableError : Class \"CreateXxxxxTable\" not found ãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®çµæœã‚’ç¢ºèª $ php artisan migrate:status ãƒ»æŒ‡å®šã—ãŸå±¥æ­´æ•°ã ã‘ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å…ƒã«æˆ»ã™ æŒ‡å®šã—ãŸå±¥æ­´æ•°ã ã‘ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/migrations.html#rolling-back-migrations $ php artisan migrate:rollback --step= å®Ÿéš›ã®ä½¿ç”¨å ´é¢ã¨ã—ã¦ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤±æ•—ã—ãŸå ´åˆã€ä¸€ã¤å‰ã®çŠ¶æ…‹ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ã¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ãŸå¾Œã€å†ã³ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚ # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤±æ•—ã—ãŸã®ã§ã€ä¸€ã¤å‰ã®çŠ¶æ…‹ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€‚ $ php artisan migrate:rollback --step=1 # ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£å¾Œã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ $ php artisan migrate ãƒ»åˆæœŸã®çŠ¶æ…‹ã¾ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å…ƒã«æˆ»ã™ åˆæœŸã®çŠ¶æ…‹ã¾ã§ã€å…¨ã¦ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/migrations.html#rolling-back-migrations $ php artisan migrate:reset ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å…ƒã«æˆ»ã—ã¦ã‹ã‚‰å†ä½œæˆ å…¨ã¦ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆmigrate:resetï¼‰ã‚’å®Ÿè¡Œã—ã€æ¬¡ã„ã§migrateã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/migrations.html#roll-back-migrate-using-a-single-command $ php artisan migrate:refresh ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰å†ä½œæˆ å…¨ã¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ã¨migrateã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã‚ãšã«ã€å¼·åˆ¶çš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/migrations.html#drop-all-tables-migrate $ php artisan migrate:fresh ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã€ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã™ã§ã«å­˜åœ¨ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ã“ã®å ´åˆã€ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹å‰ã¾ã§ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒæœ€é©ã§ã‚ã‚‹ã€‚ã—ã‹ã—ãã‚ŒãŒé›£ã—ã‘ã‚Œã°ã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ SQLSTATE[42S01]: table or view already exists ãƒ»ç¢ºèªç”»é¢ã®å…¥åŠ›ã‚’ã‚¹ã‚­ãƒƒãƒ— ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã€æœ¬å½“ã«å®Ÿè¡Œã—ã¦è‰¯ã„ã‹ç¢ºèªç”»é¢ï¼ˆYesï¼Noï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚CICDã«ãŠã„ã¦ã€ã“ã®ç¢ºèªç”»é¢ã§Yesï¼Noã‚’å…¥åŠ›ã§ããªã„ãŸã‚ã€ç¢ºèªç”»é¢ã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/migrations.html#forcing-migrations-to-run-in-production $ php artisan migrate --force ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆï¼å‰Šé™¤ ãƒ»upãƒ¡ã‚½ãƒƒãƒ‰ã€downãƒ¡ã‚½ãƒƒãƒ‰ ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚upãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã€ã‚«ãƒ©ãƒ ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®CREATEã‚’å®Ÿè¡Œã™ã‚‹ã€‚downãƒ¡ã‚½ãƒƒãƒ‰ã§CREATEã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š bigIncrements(\"foo_id\")->comment(\"ID\"); $table->string(\"name\")->comment(\"åå‰\"); // MigrationMacroServiceProviderã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ $table->systemColumns(); // deleted_atã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã™ã‚‹ã€‚ $table->softDeletes(); }); } /** * @return void */ public function down() { Schema::drop(\"foos\"); } } ã‚«ãƒ©ãƒ ã®è¿½åŠ ï¼å¤‰æ›´ï¼å‰Šé™¤ ãƒ»ãªã— æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã ã‘ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ $ php artisan make:migration add_column --table=foos è¿½åŠ ã—ãŸã„ã‚«ãƒ©ãƒ ã®ã¿ã‚’å®šç¾©ã™ã‚‹ã€‚ string('foo_name'); }); } } ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æŒ‡å®šã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚å®Ÿè¡Œå¾Œã¯ã€ä½œæˆã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ php artisan migrate ãƒ»renameColumnãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã®åå‰ã‚’å¤‰æ›´ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚«ãƒ©ãƒ åã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã ã‘ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ $ php artisan make:migration rename_column --table=foos ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ åã‚’å®šç¾©ã—ã€renameColumnãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚å¤‰æ›´å¾Œã§ã‚‚ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã€downãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å®šç¾©ã—ã¦ãŠãã€‚ renameColumn('id', 'foo_id'); }); } /** * @return void */ public function down() { // ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›´å¾Œã§ã‚‚ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã€‚ Schema::table('foos', function (Blueprint $table) { $table->renameColumn('foo_id', 'foo_id'); }); } } ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æŒ‡å®šã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ åãŒå¤‰æ›´ã•ã‚Œã‚‹ã€‚å®Ÿè¡Œå¾Œã¯ã€ä½œæˆã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ php artisan migrate ãƒ»changeãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å¤‰æ›´ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‡ãƒ¼ã‚¿å‹ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã ã‘ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ $ php artisan make:migration change_column_data_type --table=foos ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã—ã€changeãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚å¤‰æ›´å¾Œã§ã‚‚ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã€downãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å®šç¾©ã—ã¦ãŠãã€‚ integer('bar')->change(); }); } /** * @return void */ public function down() { // ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›´å¾Œã§ã‚‚ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã€‚ Schema::table('foos', function (Blueprint $table) { $table->string('bar')->change(); }); } } ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æŒ‡å®šã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿å‹ãŒå¤‰æ›´ã•ã‚Œã‚‹ã€‚å®Ÿè¡Œå¾Œã¯ã€ä½œæˆã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ php artisan migrate ãƒ»dropColumnãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã‚’å‰Šé™¤ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚«ãƒ©ãƒ ã‚’å‰Šé™¤ã™ã‚‹ãŸã‚ã ã‘ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ $ php artisan make:migration drop_column --table=foos å‰Šé™¤ã™ã‚‹ã‚«ãƒ©ãƒ ã‚’dropColumnãƒ¡ã‚½ãƒƒãƒ‰ã§æŒ‡å®šã™ã‚‹ã€‚å¤‰æ›´å¾Œã§ã‚‚ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã€downãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å®šç¾©ã—ã¦ãŠãã€‚ dropColumn('foo_name'); }); } /** * @return void */ public function down() { Schema::table('foos', function (Blueprint $table) { $table->string('foo_name'); }); } } ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æŒ‡å®šã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚å®Ÿè¡Œå¾Œã¯ã€ä½œæˆã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ php artisan migrate ã‚ˆãä½¿ã†ã‚«ãƒ©ãƒ ã‚¿ã‚¤ãƒ— ãƒ»bigIncrementsãƒ¡ã‚½ãƒƒãƒ‰ AutoIncrementã®INTå‹ã‚«ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Schema::create(\"foos\", function (Blueprint $table) { // ï½ ä¸­ç•¥ ï½ $table->bigIncrements(\"foo_id\"); // ï½ ä¸­ç•¥ ï½ }); ãƒ»stringãƒ¡ã‚½ãƒƒãƒ‰ VARCHARå‹ã‚«ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Schema::create(\"foos\", function (Blueprint $table) { // ï½ ä¸­ç•¥ ï½ $table->string(\"name\"); // ï½ ä¸­ç•¥ ï½ }); ãƒ»timestampãƒ¡ã‚½ãƒƒãƒ‰ TIMESTAMPå‹ã‚«ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Schema::create(\"foos\", function (Blueprint $table) { // ï½ ä¸­ç•¥ ï½ $table->timestamp(\"created_at\"); // ï½ ä¸­ç•¥ ï½ }); 13. Notification artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ é€šçŸ¥å†…å®¹ ãƒ»Notification é€šçŸ¥å†…å®¹ã‚’å®šç¾©ã™ã‚‹ã€‚viaãƒ¡ã‚½ãƒƒãƒ‰ã§å—ä¿¡ãƒãƒ£ãƒ³ãƒãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã®æ™‚ã€LaravelãŒæ¨™æº–ã§ç”¨æ„ã—ã¦ã„ã‚‹ãƒãƒ£ãƒ³ãƒãƒ«ï¼ˆMailã€SMSã€Slackãƒãƒ£ãƒ³ãƒãƒ«ã€Databaseãƒãƒ£ãƒ³ãƒãƒ«ï¼‰ä»¥å¤–ã«é€ä¿¡ã—ãŸã„å ´åˆã€Channelã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚è¤‡æ•°ã®å€¤ã‚’è¨­å®šã—ãŸå ´åˆã¯ã€ãã‚Œãã‚Œã«é€šä¿¡ãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚toMailãƒ¡ã‚½ãƒƒãƒ‰ã€toSmsãƒ¡ã‚½ãƒƒãƒ‰ã€toSlackãƒ¡ã‚½ãƒƒãƒ‰ã€toArrayãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚’ç”¨ã„ã¦ã€Laravelã®æ¨™æº–ã®ãƒãƒ£ãƒ³ãƒãƒ«ã«æ¸¡ã™é€šçŸ¥å†…å®¹ã‚’å®šç¾©ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»Eãƒ¡ãƒ¼ãƒ«é€šçŸ¥å†…å®¹ã®å®šç¾© MailMessageã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€Eãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã®å†…å®¹ã‚’ç”Ÿæˆã™ã‚‹ã€‚markdownãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å½¢å¼ã§å®šç¾©ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/notifications.html#writing-the-message https://laravel.com/api/8.x/Illuminate/Notifications/Messages/MailMessage.html#method_markdown prefers_sms ? [AwsSnsChannel::class] : [EmailChannel::class], // SMSã§ãªã„å ´åˆã¯ã€Eãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã¨ã—ã¾ã™ã€‚ 'database' ]; } /** * @param $notifiable * @return MailMessage */ public function toMail($notifiable) { // Emailã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’è¿”å´ã—ã¾ã™ã€‚ return (new MailMessage())->subject(\"ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã„ãŸã—ã¾ã—ãŸã€‚\") ->markdown(\"template.mail\", [ \"tfa_token\" => $notifiable->tfaToken() ]); } } @component(\"mail::message\") èªè¨¼ã‚³ãƒ¼ãƒ‰ã€{ $tfa_token }}ã€ã‚’å…¥åŠ›ã—ã¦ä¸‹ã•ã„ã€‚ +++++++++++++++++++++++++++++++++++++ æœ¬ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯é€ä¿¡å°‚ç”¨ã§ã™ã€‚ã”è¿”ä¿¡é ‚ã„ã¦ã‚‚ãŠç­”ãˆã§ãã¾ã›ã‚“ã®ã§ã€ã”äº†æ‰¿ãã ã•ã„ã€‚ @endcomponent ãƒ»SMSé€šçŸ¥å†…å®¹ã®å®šç¾© å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/notifications.html#formatting-sms-notifications prefers_sms ? [AwsSnsChannel::class] : [EmailChannel::class], // SMSã®å ´åˆã¯ã€AWS-SNSã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ 'database' ]; } /** * @param $notifiable * @return string */ public function toSms($notifiable) { // SMSã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’è¿”å´ã—ã¾ã™ã€‚ return view(\"template.sms\", [ \"subject\" => \"ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã„ãŸã—ã¾ã—ãŸã€‚\", \"tfa_token\" => $notifiable->tfaToken() ]); } } ãƒ»Slacké€šçŸ¥å†…å®¹ã®å®šç¾© å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/notifications.html#formatting-slack-notifications ãƒ»DBé€šçŸ¥å†…å®¹ã®å®šç¾© é…åˆ—ã§DBã«ä¿å­˜ã™ã‚‹å†…å®¹ã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/7.x/ja/notifications.html#database-notifications prefers_sms ? [AwsSnsChannel::class] : [EmailChannel::class], 'database' // DBå—ä¿¡ãƒãƒ£ãƒ³ãƒãƒ« ]; } /** * @param $notifiable * @return array */ public function toArray($notifiable) { // notificationsãƒ†ãƒ¼ãƒ–ãƒ«ã®dataã‚«ãƒ©ãƒ ã«ã€JSONã§ä¿å­˜ã•ã‚Œã¾ã™ã€‚ return [ \"tfa_token\" => $notifiable->tfaToken(), ]; } } å—ä¿¡ãƒãƒ£ãƒ³ãƒãƒ«ï¼ˆé€šçŸ¥æ–¹æ³•ï¼‰ ãƒ»Channel LaravelãŒæ¨™æº–ã§ç”¨æ„ã—ã¦ã„ã‚‹ãƒãƒ£ãƒ³ãƒãƒ«ä»¥å¤–ã«é€ä¿¡ã—ãŸã„å ´åˆã€ç‹¬è‡ªã®å—ä¿¡ãƒãƒ£ãƒ³ãƒãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã‚Œã¯ã€Notificationã‚¯ãƒ©ã‚¹ã®viaãƒ¡ã‚½ãƒƒãƒ‰ã§ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š AWS SNSã‚’å—ä¿¡ãƒãƒ£ãƒ³ãƒãƒ«ã¨ã™ã‚‹ã€‚AWSã‹ã‚‰é…å¸ƒã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ $ composer require aws/aws-sdk-php-laravel awsSnsClient = $awsSnsClient; } /** * @param $notifiable * @param Notification $notification */ public function send($notifiable, Notification $notification) { try { $message = $notification->toSms($notifiable); // AWS SNSã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ã€‚ $this->awsSnsClient->publish([ \"Message\" => $message, \"PhoneNumber\" => $this->toE164nizeInJapan( $notifiable->phoneNumber() ), ]); } catch (AwsException $e) { Log::error(sprintf( \"%s : %s at %s line %s\", get_class($e), $e->getMessage(), $e->getFile(), $e->getLine()) ); throw new AwsException($e->getMessage()); } } /** * @param string * @return string */ private function toE164nizeInJapan(string $phoneNumeber): string { // E.164å½¢å¼ã®æ—¥æœ¬é›»è©±ç•ªå·ã‚’è¿”å´ã—ã¾ã™ã€‚ return \"+81\" . substr($phoneNumeber, 1); } } é€šçŸ¥å¯¾è±¡ãƒ¢ãƒ‡ãƒ« ãƒ»Notifiableãƒˆãƒ¬ã‚¤ãƒˆã®notifyãƒ¡ã‚½ãƒƒãƒ‰ é€šçŸ¥å¯¾è±¡ã¨ãªã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚Notifiableãƒˆãƒ¬ã‚¤ãƒˆã‚’ç¶™æ‰¿ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€notifyãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Notifications/Notifiable.html é€šçŸ¥å¯¾è±¡ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰notifyãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ã€ä»»æ„ã®Notificationã‚¯ãƒ©ã‚¹ã‚’æ¸¡ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€é€šçŸ¥å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Notifications/RoutesNotifications.html#method_notify notify(new FooNotification()); ãƒ»Notificationãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ é€šçŸ¥å¯¾è±¡ã¨ãªã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚Notifiableãƒˆãƒ¬ã‚¤ãƒˆã‚’ç¶™æ‰¿ã™ã‚‹ã€‚ Notificationãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã«é€šçŸ¥å¯¾è±¡ã®ãƒ¢ãƒ‡ãƒ«ã¨é€šçŸ¥ã‚¯ãƒ©ã‚¹ã‚’æ¸¡ã™ã€‚ ãƒ»ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰é€šçŸ¥ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰é€šçŸ¥ã‚’ç”¨ã„ã‚‹ã¨ã€é€šçŸ¥å¯¾è±¡ã¨ãªã‚‹ãƒ¢ãƒ‡ãƒ«ãŒNotificableãƒˆãƒ¬ã‚¤ãƒˆã«ä¾å­˜ã›ãšã«é€šçŸ¥ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ å‚è€ƒï¼š https://laracasts.com/discuss/channels/laravel/notifications-without-eloquent-user-model https://readouble.com/laravel/8.x/ja/notifications.html#on-demand-notifications email_address) ->route('nexmo', $user->phone_number) ->route('slack', $slackMessage->usl) ->notify(new FooMotification()); 14. Resource artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»Resourceã®ç”Ÿæˆ Resourceã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã€‚ $ php artisan make:resource ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ä½œæˆå‰ã®ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ› ãƒ»ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ›ã®å¿…è¦æ€§ Eloquentãƒ¢ãƒ‡ãƒ«ã‚’JSONãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹æ™‚ã«ã€ä¸€æ—¦ã€é…åˆ—ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»å˜ä¸€ã®Eloquentãƒ¢ãƒ‡ãƒ«ã®é…åˆ—åŒ– å˜ä¸€ã®Eloquentãƒ¢ãƒ‡ãƒ«ã‚’é…åˆ—ã«å¤‰æ›ã™ã‚‹ã€‚Resourceã‚¯ãƒ©ã‚¹ã®toArrayãƒ¡ã‚½ãƒƒãƒ‰ã«ã¦ã€thiså¤‰æ•°ã¯è‡ªèº«ã§ã¯ãªãã€Resourceã‚¯ãƒ©ã‚¹åã«ã¤ãEloquentãƒ¢ãƒ‡ãƒ«åã«ãªã‚‹ã€‚ã¾ãŸã€thiså¤‰æ•°ã‹ã‚‰ã‚²ãƒƒã‚¿ãƒ¼ã‚’çµŒç”±ã›ãšã«ç›´æ¥ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚Controllerã«ã¦ã€Resouceã‚¯ãƒ©ã‚¹ã«Eloquentãƒ¢ãƒ‡ãƒ«ã‚’æ¸¡ã™ã‚ˆã†ã«ã™ã‚‹ã€‚Laravelã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®JSONãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã€ã¾ãštoArrayãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚Šé…åˆ—åŒ–ã—ã€ã•ã‚‰ã«ã“ã‚Œã‚’JSONãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Fooã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã€é…åˆ—åŒ–ã™ã‚‹ã€‚ $this->id, \"name\" => $this->name, ]; } }ã€‚ ãƒ»è¤‡æ•°ã®Eloquentãƒ¢ãƒ‡ãƒ«ï¼ˆCollectionå‹ï¼‰ã®é…åˆ—åŒ– è¤‡æ•°ã®Eloquentãƒ¢ãƒ‡ãƒ«ï¼ˆCollectionå‹ï¼‰ã‚’é…åˆ—ã«å¤‰æ›ã™ã‚‹ã€‚ // ã“ã“ã«å®Ÿè£…ä¾‹ 15. Routing artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ä¸€è¦§ # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ä¸€è¦§ã§è¡¨ç¤º $ php artisan route:list ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤ # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ $ php artisan route:clear # å…¨ã¦ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ $ php artisan optimize:clear api.phpãƒ•ã‚¡ã‚¤ãƒ« ãƒ»Middlewareã®é©ç”¨ APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦åƒããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚å®Ÿè£…ã—ãŸãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†æ™‚ã«ã¯ã€Kernelã‚¯ãƒ©ã‚¹ã®middlewareGroupsãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®apiã‚­ãƒ¼ã§è¨­å®šã—ãŸãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯å¤–éƒ¨å…¬é–‹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€webã‚­ãƒ¼ã¨æ¯”è¼ƒã—ã¦ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ã€‚ [ \"throttle:60,1\", \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, ], ]; // ã€œ ä¸­ç•¥ ã€œ } web.phpãƒ•ã‚¡ã‚¤ãƒ« ãƒ»Middlewareã®é©ç”¨ APIä»¥å¤–ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚å®Ÿè£…ã—ãŸãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†æ™‚ã«ã¯ã€Kernelã‚¯ãƒ©ã‚¹ã®middlewareGroupsãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®webã‚­ãƒ¼ã§è¨­å®šã—ãŸãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚APIä»¥å¤–ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯å¤–éƒ¨å…¬é–‹ã™ã‚‹å¿…è¦ãŒãªã„ãŸã‚ã€apiã‚­ãƒ¼ã¨æ¯”è¼ƒã—ã¦ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒå¤šãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ä¾‹ãˆã°ã€CSRFå¯¾ç­–ã®ãŸã‚ã®VerifyCsrfTokenã‚¯ãƒ©ã‚¹ãŒã‚ã‚‹ã€‚ [ \\App\\Http\\Middleware\\EncryptCookies::class, \\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse::class, \\Illuminate\\Session\\Middleware\\StartSession::class, // \\Illuminate\\Session\\Middleware\\AuthenticateSession::class, \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class, \\App\\Http\\Middleware\\VerifyCsrfToken::class, \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, ], // ã€œ ä¸­ç•¥ ã€œ ]; // ã€œ ä¸­ç•¥ ã€œ } guest.phpãƒ•ã‚¡ã‚¤ãƒ« ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãªã©ã€APIèªè¨¼ãŒä¸è¦ãªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚ æš—é»™ã®ãƒ¢ãƒ‡ãƒ«çµåˆ ãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ä½¿ç”¨æ™‚ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«ç”¨ã„ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°å‹ã¨å¤‰æ•°åãŒåŒã˜ã§ã‚ã‚Šã€ã‹ã¤ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«æ•°å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸå ´åˆã€ãã®æ•°å€¤ã‚’IDã¨ã™ã‚‹Eloquentãƒ¢ãƒ‡ãƒ«ãŒè‡ªå‹•çš„ã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/routing.html#implicit-binding ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«ã€ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã‚’userã¨ã—ã¦ãŠãã€‚ ã‹ã¤ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°å‹ï¼å¤‰æ•°åã‚’Userï¼$userã¨ã™ã‚‹ã€‚ã¾ãŸã¯ã€‚ã“ã®æ™‚ã€ã€/users/1ã€ã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã‚‹ã¨ã€ãƒ¦ãƒ¼ã‚¶IDãŒ1ã®ãƒ¦ãƒ¼ã‚¶ãŒDBã‹ã‚‰èª­ã¿å‡ºã•ã‚Œã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹ã€‚ id; // ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®idã«ç´ä»˜ããƒ¦ãƒ¼ã‚¶ãŒè‡ªå‹•çš„ã«æ¸¡ã•ã‚Œã¦ã„ã‚‹ã€‚ } } 16. Seeder artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»Seederã®ç”Ÿæˆ Seederã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã€‚ $ php artisan make:seeder ãƒ»Seederã®å®Ÿè¡Œ Seederã‚’æ–°ã—ãä½œæˆã—ãŸæ™‚ã‚„Seederåã‚’å¤‰æ›´ã—ãŸæ™‚ã€Composerã®dump-autoloadã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ $ composer dump-autoload # ç‰¹å®šã®Seederã‚’å®Ÿè¡Œ $ php artisan db:seed --class= # DatabaseSeederã‚’æŒ‡å®šã—ã¦ã€å…¨ã¦ã®Seederã‚’å®Ÿè¡Œ $ php artisan db:seed --class= åˆæœŸãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã®å®šç¾© ãƒ»DBãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã«ã‚ˆã‚‹å®šç¾© insert([ \"product_name\" => \"ã‚·ãƒ£ãƒ¼ãƒ—ãƒšãƒ³ã‚·ãƒ«\", \"price\" => 300, \"product_type\" => 1, \"created_by\" => ExecutorConstant::ARTISAN_COMMAND, \"updated_by\" => ExecutorConstant::ARTISAN_COMMAND, \"created_at\" => NOW(), \"updated_at\" => NOW(), \"deleted_at\" => NULL ], [ \"product_name\" => \"ãƒãƒ¼ãƒˆ\", \"price\" => 200, \"product_type\" => 2, \"created_by\" => ExecutorConstant::ARTISAN_COMMAND, \"updated_by\" => ExecutorConstant::ARTISAN_COMMAND, \"created_at\" => NOW(), \"updated_at\" => NOW(), \"deleted_at\" => NULL ], [ \"product_name\" => \"æ¶ˆã—ã‚´ãƒ \", \"price\" => 100, \"product_type\" => 3, \"created_by\" => ExecutorConstant::ARTISAN_COMMAND, \"updated_by\" => ExecutorConstant::ARTISAN_COMMAND, \"created_at\" => NOW(), \"updated_at\" => NOW(), \"deleted_at\" => NULL ], // ï½ ä¸­ç•¥ ï½ ]); } } å®Ÿè¡Œè€…åã¯ã€å®šæ•°ã¨ã—ã¦ç®¡ç†ã—ã¦ãŠãã¨ã‚ˆã„ã€‚ ãƒ»CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹å®šç¾© // ã“ã“ã«å®Ÿè£…ä¾‹ Seederã®å®Ÿè¡Œ DatabaseSeederã«ã¦ã€å…¨ã¦ã®Seederã‚’ã¾ã¨ã‚ã¦å®Ÿè¡Œã™ã‚‹ã€‚ call([ // ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ ]); } // ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒç”¨ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ if (App::environment(\"staging\")) { $this->call([ // ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ ProductsSeeder::class ]); } // æœ¬ç•ªç’°å¢ƒç”¨ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ if (App::environment(\"production\")) { $this->call([ // ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ ProductsSeeder::class ]); } } } 17. ServiceProvider artisanã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹æ“ä½œ ãƒ»ã‚¯ãƒ©ã‚¹ã®è‡ªå‹•ç”Ÿæˆ $ php artisan make:provider ServiceProvider ãƒ»ServiceProviderã®ç”¨é€” ç”¨é€”ã®ç¨®é¡ èª¬æ˜ AppServiceProvider ãƒ»ServiceContainerã¸ã®ã‚¯ãƒ©ã‚¹ã®ãƒã‚¤ãƒ³ãƒ‰ï¼ˆç™»éŒ²ï¼‰ãƒ»ServiceContainerã‹ã‚‰ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒªã‚¾ãƒ«ãƒ–ï¼ˆç”Ÿæˆï¼‰ MacroServiceProvider ServiceContainerã¸ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒã‚¤ãƒ³ãƒ‰ï¼ˆç™»éŒ²ï¼‰ RouteServiceProviderï¼ˆapp.phpã€web.phpã‚‚ä½¿ç”¨ï¼‰ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®å¯¾å¿œé–¢ä¿‚ã®å®šç¾© EventServiceProvider EventListenerã¨Eventhandleré–¢æ•°ã®å¯¾å¿œé–¢ä¿‚ã®å®šç¾© ãƒ»ServiceProviderã®ã‚³ãƒ¼ãƒ« ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã‚’ã€config/app.phpãƒ•ã‚¡ã‚¤ãƒ«ã®providersé…åˆ—ã«ç™»éŒ²ã™ã‚‹ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•æ™‚ã«ServiceProviderã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ãŸã‚ã€ServiceContainerã¸ã®ã‚¯ãƒ©ã‚¹ã®ãƒã‚¤ãƒ³ãƒ‰ãŒè‡ªå‹•çš„ã«å®Œäº†ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [ // è¤‡æ•°ã®ServiceProviderãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ App\\Providers\\ComposerServiceProvider::class, ], ServiceContainer ãƒ»ServiceContainerã€ãƒã‚¤ãƒ³ãƒ‰ã€ãƒªã‚¾ãƒ«ãƒ–ã¨ã¯ ServiceContainerã€ãƒã‚¤ãƒ³ãƒ‰ã€ãƒªã‚¾ãƒ«ãƒ–ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based.html AppServiceProvider ãƒ»å˜ä¸€ã®ã‚¯ãƒ©ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ï¼ãƒªã‚¾ãƒ«ãƒ– AppSeriveProviderã«ã¦ã€ServiceContainerã«ã‚¯ãƒ©ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ServiceContainerãŒã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒªã‚¾ãƒ«ãƒ–ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã§ã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã—ã•ãˆã™ã‚Œã°ã€ãã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ¸¡ã•ã‚Œã‚‹ãŸã‚ã€è‡ªå‹•çš„ã«ä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ³¨å…¥ãŒå®Ÿè¡Œã•ã‚ŒãŸã“ã¨ã«ãªã‚‹ã€‚Laravelã§ã¯ã€ã‚¯ãƒ©ã‚¹ã¯ServiceContainerã«è‡ªå‹•çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã¦ãŠã‚Šã€å¼•æ•°ã§ã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€ä»¥ä¸‹ã®å®Ÿè£…ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ãŸã ã—ã€æ··åˆå‹ã®å ´åˆã¯å¼•æ•°ã®å‹ã‚’æŒ‡å®šã§ããªã„ãŸã‚ã€ãƒªã‚¾ãƒ«ãƒ–ã¯å®Ÿè¡Œã§ããªã„ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/container.html#automatic-injection ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ã€‚ãªãŠã€Laravelã§ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ app->bind(Foo::class, function ($app) { return new Foo(new Bar, new Baz); }); } } å¼•æ•°ã®å‹ã‚’å…ƒã«ã€ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒªã‚¾ãƒ«ãƒ–ã•ã‚Œã‚‹ã€‚ bar; $foo->baz; } } å¼•æ•°ã®å‹ã‚’æŒ‡å®šã—ãªã„å ´åˆã¯ã€æ‰‹å‹•ã§æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ bar; $foo->baz; } } $foo = new Foo(); $qux = new Qux($foo); // æ‰‹å‹•ã§æ¸¡ã™ æ··åˆå‹ã®å ´åˆã¯ã€å¼•æ•°ã®å‹ã‚’æŒ‡å®šã§ããªã„ãŸã‚ã€ãƒªã‚¾ãƒ«ãƒ–ã‚’å®Ÿè¡Œã§ããªã„ã€‚ bar; $mixed->baz; } } $foo1 = new Foo1(); $foo2 = new Foo2(); $foo3 = new Foo3(); $qux = new Qux($foo1); ãƒ»è¤‡æ•°ã®ã‚¯ãƒ©ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ï¼ãƒªã‚¾ãƒ«ãƒ– ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã§ã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã—ã•ãˆã™ã‚Œã°ã€ãã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ¸¡ã•ã‚Œã‚‹ãŸã‚ã€è‡ªå‹•çš„ã«ä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ³¨å…¥ãŒå®Ÿè¡Œã•ã‚ŒãŸã“ã¨ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š registerFoo(); $this->registerBar(); $this->registerBaz(); } /** * ä¸€ã¤ç›®ã®ã‚¯ãƒ©ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ */ private function registerFoo() { $this->app->bind(Foo::class, function ($app) { return new Foo(); }); } /** * äºŒã¤ç›®ã®ã‚¯ãƒ©ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ */ private function registerBar() { $this->app->bind(Bar::class, function ($app) { return new Bar(); }); } /** * ä¸‰ã¤ç›®ã®ã‚¯ãƒ©ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ */ private function registerBaz() { $this->app->bind(Baz::class, function ($app) { return new Baz(); }); } } ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ã—ã€å®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’ãƒªã‚¾ãƒ«ãƒ– Laravelã«ãŠã„ã¦ã¯ã‚¯ãƒ©ã‚¹ãŒè‡ªå‹•çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã€ã“ã‚Œã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒªã‚¾ãƒ«ãƒ–ã•ã‚Œã‚‹ã€ã—ã‹ã—ã€ãƒã‚¤ãƒ³ãƒ‰ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã¨ã¯åˆ¥ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒªã‚¾ãƒ«ãƒ–ã—ãŸã„å ´åˆã¯ã€ServiceProviderã«ãã‚Œã‚’å®šç¾©ã™ã‚Œã°ã€è‡ªå‹•çš„ãªãƒã‚¤ãƒ³ãƒ‰ã‚’ä¸Šæ›¸ãã§ãã‚‹ã€‚ã“ã‚Œã‚’ç”¨ã„ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒã‚¤ãƒ³ãƒ‰ã—ã€å®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’ãƒªã‚¾ãƒ«ãƒ–ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã®æ–¹æ³•ã¯ã€ä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæŠ½è±¡ã«ä¾å­˜ã™ã‚‹ã“ã¨ãŒå¿…è¦ãªå ´é¢ï¼ˆä¾‹ï¼šä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼‰ã§å½¹ç«‹ã¤ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š app->bind( \"App\\Domain\\Foo\\Repositories\\FooRepositoryInterface\", // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ \"App\\Infrastructure\\Doo\\Repositories\\FooRepository\" // å®Ÿè£…ã‚¯ãƒ©ã‚¹ ); } } fooRepository = $fooRepository; } } ãƒ»makeãƒ¡ã‚½ãƒƒãƒ‰ å¼•æ•°ã®å‹ã§ãƒªã‚¾ãƒ«ãƒ–ã‚’å®Ÿè¡Œã™ã‚‹ä»¥å¤–ã«ã€makeãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚makeãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã«ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã‚’æ¸¡ã™ã“ã¨ã§ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒªã‚¾ãƒ«ãƒ–ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/container.html#the-make-method ï¼Šå®Ÿè£…ä¾‹ï¼Š make(Foo::class) ->method(); // Fooã‚¯ãƒ©ã‚¹ã‚’ãƒªã‚¾ãƒ«ãƒ– $foo = App::make(Foo::class); $result = $foo->method(); ãƒ»registerãƒ¡ã‚½ãƒƒãƒ‰ã¨bootãƒ¡ã‚½ãƒƒãƒ‰ã®é•ã„ Laravelã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã«ãŠã„ã¦ã€ServiceContainerã¸ã®ã‚¯ãƒ©ã‚¹ã®ãƒã‚¤ãƒ³ãƒ‰ã®æ™‚ã«ã¯ã€ã¾ãšServiceProviderã®registerãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã€ãã®å¾Œã«bootãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ServiceProviderãŒä»–ã®ServiceProviderã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†ãªå‡¦ç†ã‚’å®Ÿè£…ã—ãŸã„ã¨ãã€ã“ã‚Œã¯bootãƒ¡ã‚½ãƒƒãƒ‰ã«å®Ÿè£…ã™ã‚‹ã“ã¨ãŒé©ã—ã¦ã„ã‚‹ã€‚ MigrationMacroServiceProvider è¤‡æ•°ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«å…±é€šã®ã‚«ãƒ©ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚ string(\"created_by\") ->comment(\"ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆè€…\") ->nullable(); $this->string(\"updated_by\") ->comment(\"ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æœ€çµ‚æ›´æ–°è€…\") ->nullable(); $this->timestamp(\"created_at\") ->comment(\"ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆæ—¥\") ->nullable(); $this->timestamp(\"updated_at\") ->comment(\"ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æœ€çµ‚æ›´æ–°æ—¥\") ->nullable(); $this->timestamp(\"deleted_at\") ->comment(\"ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤æ—¥\") ->nullable(); }); Blueprint::macro(\"dropSystemColumns\", function () { $this->dropColumn( \"created_by\", \"updated_by\", \"created_at\", \"updated_at\", \"deleted_at\" ); }); } } ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€å®šç¾©ã—ãŸsystemColumnãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ bigIncrements(\"foo_id\") ->comment(\"ID\"); $table->string(\"name\") ->comment(\"åå‰\"); // MigrationMacroServiceProviderã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ $table->systemColumns(); // deleted_atã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã™ã‚‹ã€‚ $table->softDeletes(); }); } /** * ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ * * @return void */ public function down() { Schema::drop(\"foos\"); } } RouteServiceProvider ãƒ»å…¨ã¦ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¸ã®å‡¦ç† ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ã¾ãŸã€å…¨ã¦ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«é©ç”¨ã™ã‚‹å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/routing.html#parameters-global-constraints ï¼Šå®Ÿè£…ä¾‹ï¼Š middleware('api') ->namespace($this->namespace) ->group(base_path('routes/healthcheck.php')); // API Route::prefix('api') ->middleware('api') ->namespace($this->namespace) ->group(base_path('routes/api.php')); } } ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°åˆ¶é™ ä¸€åˆ†é–“å½“ãŸã‚Šã«è¨±å®¹ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã¨ãã®åˆ¶é™åã‚’configureRateLimitingãƒ¡ã‚½ãƒƒãƒ‰ã§å®šç¾©ã™ã‚‹ã€‚ã•ã‚‰ã«ã€ThrottleãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«åˆ¶é™åã‚’æ¸¡ã—ã€æŒ‡å®šã—ãŸãƒ«ãƒ¼ãƒˆã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°åˆ¶é™ã‚’é©ç”¨ã•ã›ã‚‹ã€ã‚‚ã—åˆ¶é™ã‚’è¶…ãˆãŸå ´åˆã€configureRateLimitingãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ã€429ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ä¿¡ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/routing.html#rate-limiting ï¼Šå®Ÿè£…ä¾‹ï¼Š [ ], 'api' => [ // throttleãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’é©ç”¨ã™ã‚‹ã€‚ 'throttle:limit_per_minute', \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, ], ]; /** * @return void */ public function configureRateLimiting() { RateLimiter::for('limit_per_minute', function (Request $request) { // ä¸€åˆ†é–“å½“ãŸã‚Š1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§ã‚’è¨±å¯ã™ã‚‹ã€‚ return Limit::perMinute(1000); }); } } EventServiceProvider ãƒ»Eventã¨Listenerã®ç™»éŒ² Eventã¨Listenerã®å¯¾å¿œé–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹ã€‚ãªãŠã€Eventã‚’ç™ºç«ã•ã›ã¦Listenerã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã¯ã€Eventã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å‚ç…§ã›ã‚ˆã€‚ ãƒªã‚¹ãƒŠãƒ¼] * * @var array */ protected $listen = [ // Eloquentãƒ¢ãƒ‡ãƒ«æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆ UpdatedModelEvent::class => [ UpdatedModelListener::class, ], ]; /** * @return void */ public function boot() { } } ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ ãƒ»CSRFå¯¾ç­– ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«CSRFãƒˆãƒ¼ã‚¯ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚Bladeã‚’ç”¨ã„ã¦ã‚µãƒ¼ãƒå´ã®CSRFãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–ã‚Šå‡ºã—ã€inputã‚¿ã‚°ã®hiddenå±æ€§ã«CSRFãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰²ã‚Šå½“ã¦é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/csrf.html @csrf ... Bladeã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®Set-Cookieã«CSRFãƒˆãƒ¼ã‚¯ãƒ³ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ãŸã‚ã€ã“ã‚Œã‚’å–ã‚Šå‡ºã—ã¦X-CSRF-TOKENãƒ˜ãƒƒãƒ€ãƒ¼ã‚„X-XSRF-TOKENãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãŸã³ã«ç•°ãªã‚‹CSRFãƒˆãƒ¼ã‚¯ãƒ³ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã€ã“ã‚Œã‚’æ¬¡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/csrf.html#csrf-x-csrf-token https://readouble.com/laravel/8.x/ja/csrf.html#csrf-x-xsrf-token https://stackoverflow.com/questions/42408177/what-is-the-difference-between-x-xsrf-token-and-x-csrf-token ã¡ãªã¿ã«ã€Postmanãªã©ã®HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä»£ã‚ã‚Šã«ç”¨ã„ã‚‹å ´åˆã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ä¿¡ã•ã‚Œã‚‹CSRFãƒˆãƒ¼ã‚¯ã‚’æ‰±ãˆãªã„ã€ãã“ã§ã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§äº‹å‰ã«ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ã‚³ãƒ¼ãƒ«ã—ã€CSRFãƒˆãƒ¼ã‚¯ãƒ³ã‚’Postmanã®ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜ã™ã‚‹ã‚ˆã†ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨­å®šã—ã¦ãŠãã¨è‰¯ã„ã€‚ if (pm.request.method == 'GET') { return true; } return pm.sendRequest(\"http://127.0.0.1:8000\", (error, response, {cookies}) => { if (error) { console.error(error); return false; } const xsrfTokenHeader = cookies.one(\"XSRF-TOKEN\"); if (!xsrfTokenHeader) { console.log(\"ãƒˆãƒ¼ã‚¯ãƒ³ãŒã‚ã‚Šã¾ã›ã‚“\"); return false; } // laravelã«ã‚ˆã£ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã€‚ const xsrfToken = decodeURIComponent(xsrfTokenHeader['value']); // ç’°å¢ƒå¤‰æ•°ã‚’æŒ¿å…¥ã™ã‚‹ãŸã‚ã«ã€è©²å½“ã™ã‚‹ç’°å¢ƒåã‚’Collectionå…¨ä½“ã«é©ç”¨ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ pm.environment.set('XSRF_TOKEN', xsrfToken); console.log(xsrfToken); return true; }); ãƒ»XSSå¯¾ç­– ãƒ»å¸¸æ™‚HTTPSåŒ– MySQL ãƒ»å˜ä¸€ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å ´åˆ å˜ä¸€ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹å ´åˆã€DB_HOSTã‚’ä¸€ã¤ã ã‘è¨­å®šã™ã‚‹ã€‚ env(\"DB_CONNECTION\", \"mysql\"), \"connections\" => [ // ï½ ä¸­ç•¥ ï½ \"mysql\" => [ \"driver\" => \"mysql\", \"url\" => env(\"DATABASE_URL\"), \"host\" => env(\"DB_HOST\", \"127.0.0.1\"), \"port\" => env(\"DB_PORT\", 3306), \"database\" => env(\"DB_DATABASE\", \"forge\"), \"username\" => env(\"DB_USERNAME\", \"forge\"), \"password\" => env(\"DB_PASSWORD\", \"\"), \"unix_socket\" => env(\"DB_SOCKET\", \"\"), \"charset\" => \"utf8mb4\", \"collation\" => \"utf8mb4_unicode_ci\", \"prefix\" => \"\", \"prefix_indexes\" => true, \"strict\" => true, \"engine\" => null, \"options\" => extension_loaded(\"pdo_mysql\") ? array_filter([ PDO::MYSQL_ATTR_SSL_CA => env(\"MYSQL_ATTR_SSL_CA\"), ]) : [], ], ], // ï½ ä¸­ç•¥ ï½ ]; ãƒ»DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®å ´åˆ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«æ¥ç¶šã™ã‚‹å ´åˆã€æ›¸ãè¾¼ã¿å‡¦ç†ã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å‘ã‘ã€ã¾ãŸèª­ã¿å‡ºã—å‡¦ç†ã‚’ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã«å‘ã‘ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€è² è·ã‚’åˆ†æ•£ã§ãã‚‹ã€‚ã“ã®å ´åˆã€ç’°å¢ƒå¤‰æ•°ã«äºŒã¤ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ›ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/database.html#contentContainer:~:text=Read%EF%BC%8FWrite%E6%8E%A5%E7%B6%9A DB_HOST_PRIMARY= DB_HOST_READ= ãªãŠã€stickyã‚­ãƒ¼ã‚’æœ‰åŠ¹åŒ–ã—ã¦ãŠãã¨ã‚ˆã„ã€‚ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿æ›´æ–°ãŒãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã«åŒæœŸã•ã‚Œã‚‹å‰ã«ã€ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã«å¯¾ã—ã¦èª­ã¿å‡ºã—å‡¦ç†ãŒèµ·ã“ã‚‹ã‚ˆã†ãªå ´åˆã€ã“ã‚Œã‚’é˜²ã’ã‚‹ã€‚ env(\"DB_CONNECTION\", \"mysql\"), \"connections\" => [ // ï½ ä¸­ç•¥ ï½ \"mysql\" => [ \"driver\" => \"mysql\", \"url\" => env(\"DATABASE_URL\"), \"read\" => [ \"host\" => [ env(\"DB_HOST_PRIMARY\", \"127.0.0.1\"), ], ], \"write\" => [ \"host\" => [ env(\"DB_HOST_READ\", \"127.0.0.1\"), ], ], # stickyã‚­ãƒ¼ã¯æœ‰åŠ¹åŒ–ã—ã¦ãŠã„ãŸã»ã†ãŒã‚ˆã„ã€‚ \"sticky\" => true, \"port\" => env(\"DB_PORT\", 3306), \"database\" => env(\"DB_DATABASE\", \"forge\"), \"username\" => env(\"DB_USERNAME\", \"forge\"), \"password\" => env(\"DB_PASSWORD\", \"\"), \"unix_socket\" => env(\"DB_SOCKET\", \"\"), \"charset\" => \"utf8mb4\", \"collation\" => \"utf8mb4_unicode_ci\", \"prefix\" => \"\", \"prefix_indexes\" => true, \"strict\" => true, \"engine\" => null, \"options\" => extension_loaded(\"pdo_mysql\") ? array_filter([ PDO::MYSQL_ATTR_SSL_CA => env(\"MYSQL_ATTR_SSL_CA\"), ]) : [], ], ], // ï½ ä¸­ç•¥ ï½ ]; 18. Session ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ“ä½œ ãƒ»è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« env('SESSION_DRIVER', 'file'), 'lifetime' => env('SESSION_LIFETIME', 120), 'expire_on_close' => false, 'encrypt' => false, 'files' => storage_path('framework/sessions'), 'connection' => env('SESSION_CONNECTION', null), 'table' => 'sessions', 'store' => env('SESSION_STORE', null), 'lottery' => [2, 100], 'cookie' => env( 'SESSION_COOKIE', Str::slug(env('APP_NAME', 'laravel'), '_') . '_session' ), 'path' => '/', // Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®domainå±æ€§ã«å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ 'domain' => env('SESSION_DOMAIN', null), // Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®secureå±æ€§ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ 'secure' => env('SESSION_SECURE_COOKIE', false), // Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®HttpOnlyå±æ€§ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ 'http_only' => true, // Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®sameSiteå±æ€§ã«å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚nullã®å ´åˆã€Laxã¨ãªã‚‹ã€‚ 'same_site' => null, ]; ãƒ»ã‚ˆãä½¿ã†æ“ä½œãƒ¡ã‚½ãƒƒãƒ‰ FormRequestã‚¯ãƒ©ã‚¹ã®sessionãƒ¡ã‚½ãƒƒãƒ‰ã¯Storeã‚¯ãƒ©ã‚¹ã‚’è¿”å´ã™ã‚‹ã€‚ã“ã®ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æ“ä½œã§ãã‚‹ã€‚ ãƒ¡ã‚½ãƒƒãƒ‰å èª¬æ˜ get ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼åã‚’æŒ‡å®šã—ã¦ã€ä¸€ã¤ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ all ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å…¨ã¦ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ forget ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼åã‚’æŒ‡å®šã—ã¦ã€å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ã‚­ãƒ¼åã‚’é…åˆ—ã§æ¸¡ã—ã¦ã€è¤‡æ•°å€‹ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã€‚ flush ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å…¨ã¦ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ pull ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼åã‚’æŒ‡å®šã—ã¦ã€ä¸€ã¤ã®å€¤ã‚’å–å¾—ã—ã€å–å¾—å¾Œã«å‰Šé™¤ã™ã‚‹ã€‚ has ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼åã‚’æŒ‡å®šã—ã¦ã€å€¤ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚nullã¯falseã¨ã—ã¦åˆ¤å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Session/Store.html ï¼Šå®Ÿè£…ä¾‹ï¼Š session()->get(\"foo\"); // allãƒ¡ã‚½ãƒƒãƒ‰ $data = $request->session()->all(); // forgetãƒ¡ã‚½ãƒƒãƒ‰ $request->session()->forget(\"foo\"); $request->session()->forget([\"foo\", \"bar\"]); // flush $request->session()->flush(); // pullãƒ¡ã‚½ãƒƒãƒ‰ $data = $request->session()->pull(\"foo\"); // hasãƒ¡ã‚½ãƒƒãƒ‰ if ($request->session()->has(\"foo\")) { } } } ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒStoreã‚¯ãƒ©ã‚¹ã«è‡³ã‚‹ã¾ã§ å…¨ã¦ã‚’è¿½ã†ã“ã¨ã¯é›£ã—ã„ã®ã§ã€StartSessionã‚¯ãƒ©ã‚¹ã®handleãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨ã“ã‚ã‹ã‚‰å§‹ã‚ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚ã“ã“ã§ã€handleStatefulRequestãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­ã®startSessionãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Storeã‚¯ãƒ©ã‚¹ã®startãƒ¡ã‚½ãƒƒãƒ‰ã€loadSessionãƒ¡ã‚½ãƒƒãƒ‰ã€readFromHandlerãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã€SessionHandlerInterfaceã®å®Ÿè£…ã‚¯ãƒ©ã‚¹ã®readãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚readãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€storage/framework/sessionsã«ã‚ã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¾ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’èª­ã¿å‡ºã—ã€attributeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«æ ¼ç´ã™ã‚‹ã€‚Sessionã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€attributeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æ“ä½œã™ã‚‹ã€‚æœ€çµ‚çš„ã«,handleStatefulRequestã§ã¯ã€saveSessionãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­ã®saveãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«æ–°ã—ã„å€¤ãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://laravel.com/api/8.x/Illuminate/Session/Middleware/StartSession.html#method_handle https://laravel.com/api/8.x/Illuminate/Session/Middleware/StartSession.html#method_handleStatefulRequest https://laravel.com/api/8.x/Illuminate/Session/Middleware/StartSession.html#method_startSession https://laravel.com/api/8.x/Illuminate/Session/Store.html#method_start https://laravel.com/api/8.x/Illuminate/Session/Store.html#method_loadSession https://laravel.com/api/8.x/Illuminate/Session/Store.html#method_readFromHandler https://www.php.net/manual/ja/sessionhandlerinterface.read.php https://laravel.com/api/8.x/Illuminate/Session/Middleware/StartSession.html#method_saveSession https://laravel.com/api/8.x/Illuminate/Session/Store.html#method_save https://www.php.net/manual/ja/sessionhandlerinterface.write.php 19. Views arisanã«ã‚ˆã‚‹æ“ä½œ ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å‰Šé™¤ # ãƒ“ãƒ¥ãƒ¼ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ $ php artisan view:clear # å…¨ã¦ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ $ php artisan optimize:clear ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ› ãƒ»ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ› Controllerã‚¯ãƒ©ã‚¹ã‹ã‚‰è¿”å´ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¯ã€{{ å¤‰æ•°å }}ã§å–å¾—ã§ãã‚‹ã€‚` ï¼Šå®Ÿè£…ä¾‹ï¼Š Hello!! {{ $data }} ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡ºåŠ› ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸå ´åˆã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒã‚ã£ãŸå ´åˆã€Handlerã‚¯ãƒ©ã‚¹ã®invalidãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€MessageBagã‚¯ãƒ©ã‚¹ãŒViewã«æ¸¡ã•ã‚Œã‚‹ã€‚MessageBagã‚¯ãƒ©ã‚¹ã¯ã€Bladeä¸Šã§errorså¤‰æ•°ã«æ ¼ç´ã•ã‚Œã¦ãŠã‚Šã€å„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ã¦ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://laravel.com/api/8.x/Illuminate/Support/MessageBag.html ï¼Šå®Ÿè£…ä¾‹ï¼Š MessageBagã‚¯ãƒ©ã‚¹ã®allãƒ¡ã‚½ãƒƒãƒ‰ã§ã€å…¨ã¦ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ãƒã‚¹ãƒˆä½œæˆ @if ($errors->any()) @foreach ($errors->all() as $error) {{ $error }} @endforeach @endif @isset ($status) ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚ @endisset .errors { /* ä½•ã‚‰ã‹ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */ } .complete { /* ä½•ã‚‰ã‹ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */ } è¦ç´ ã®å…±é€šåŒ– ãƒ»@includeï¼ˆã‚µãƒ–ãƒ“ãƒ¥ãƒ¼ï¼‰ èª­ã¿è¾¼ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’å‡ºåŠ›ã™ã‚‹ã€‚èª­ã¿è¾¼ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ã€å¤‰æ•°ã‚’æ¸¡ã™ã“ã¨ã‚‚ã§ãã‚‹ã€‚@extentdsã¨ã®ä½¿ã„åˆ†ã‘ã¨ã—ã¦ã€è¦ªå­é–¢ä¿‚ã®ãªã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®é–“ã§ç”¨ã„ã‚‹ã®ãŒã‚ˆã„ã€‚ä¸¡è€…ã¯ã€PHPã§ã„ã†extendsï¼ˆã‚¯ãƒ©ã‚¹ãƒã‚§ãƒ¼ãƒ³ï¼‰ã¨requireï¼ˆå˜ãªã‚‹èª­ã¿è¾¼ã¿ï¼‰ã®é–¢ä¿‚ã«è¿‘ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š @include(\"shared.errors\") è¦ç´ ã®ç¶™æ‰¿ ãƒ»@yieldã€@extendsã€@sectionã€@endsection å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ã€å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§æ–°ã—ãå®šç¾©ã—ãŸHTMLã®è¦ç´ ã‚’ã€è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æŒ‡å®šã—ãŸå ´æ‰€ã«å‡ºåŠ›ã™ã‚‹ã€‚è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¦ã€@yield(\"foo\")ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ã‚¿ã‚¤ãƒˆãƒ« @yield(\"content\") ã“ã‚Œã‚’å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§@extendsã§ç¶™æ‰¿ã™ã‚‹ã¨ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ã€å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®@section(\"foo\")-@endsectionã§å®šç¾©ã—ãŸè¦ç´ ãŒã€è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®@yieid()éƒ¨åˆ†ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š @extends(\"layouts.parent\") @section(\"content\") å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ã€yieldã«å‡ºåŠ›ã•ã‚Œã‚‹è¦ç´  @endsection ã¡ãªã¿ã«ã€å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ä»¥ä¸‹ã®ã‚ˆã†ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ã‚¿ã‚¤ãƒˆãƒ« å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ã€yieldã«å‡ºåŠ›ã•ã‚Œã‚‹è¦ç´  ãƒ»@sectionã€@showã€@extendsã€@parent å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ã€è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãã‚Œãã‚Œã§æ–°ã—ãå®šç¾©ã—ãŸHTMLã®è¦ç´ ã‚’ã€è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æŒ‡å®šã—ãŸå ´æ‰€ã«å‡ºåŠ›ã™ã‚‹ã€‚è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¦ã€@section-@showã§è¦ç´ ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ã‚¿ã‚¤ãƒˆãƒ« @section(\"sidebar\") è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¨ãªã‚‹è¦ç´  @show å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®@sectionã«ã¦ã€@parentã‚’ç”¨ã„ã‚‹ã€‚è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãã‚Œãã‚Œã®è¦ç´ ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š @extends(\"layouts.app\") @section(\"sidebar\") @parent å­ãƒ†ãƒ³ãƒ¬ãƒ—ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¿½åŠ ã•ã‚Œã‚‹è¦ç´  @endsection ã¡ãªã¿ã«ã€å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ä»¥ä¸‹ã®ã‚ˆã†ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ã‚¿ã‚¤ãƒˆãƒ« è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¨ãªã‚‹è¦ç´  å­ãƒ†ãƒ³ãƒ¬ãƒ—ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¿½åŠ ã•ã‚Œã‚‹è¦ç´  ãƒ»@stackã€@push å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ã€CSSã¨JavaScriptã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‹•çš„ã«å‡ºåŠ›ã™ã‚‹å ´åˆã«ç”¨ã„ã‚‹ã€‚è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¦ã€@stack(\"foo\")ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã‚Œã‚’ç¶™æ‰¿ã—ãŸå­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ã€@push(\"foo\")-@endpushã§å®šç¾©ã—ãŸè¦ç´ ãŒã€@stack()éƒ¨åˆ†ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š @stack(\"scripts\") @push(\"scripts\") @endpush Twigã¨ã®äº’æ› ãƒ»Bladeã§å®Ÿè£…ã—ãŸå ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š @yield(\"title\") @section(\"sidebar\") è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¨ãªã‚‹è¦ç´  @show @yield(\"content\") @extends(\"layouts.master\") @section(\"title\", \"å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«ã«ãªã‚‹è¦ç´ \") @section(\"sidebar\") @parent å­ãƒ†ãƒ³ãƒ¬ãƒ—ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¿½åŠ ã•ã‚Œã‚‹è¦ç´  @endsection @section(\"content\") å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ãªã‚‹è¦ç´  @endsection ãƒ»Twigã§å®Ÿè£…ã—ãŸå ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š {% block title %}{% endblock %} {% block sidebar %} è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¨ãªã‚‹è¦ç´  {% endblock %} {% block content %} {% endblock %} {% extends \"layouts.master\" %} {% block title %} å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«ã«ãªã‚‹è¦ç´  {% endblock %} {% block sidebar %} {{ parent() }} å­ãƒ†ãƒ³ãƒ¬ãƒ—ãƒ¼ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¿½åŠ ã•ã‚Œã‚‹è¦ç´  {% endblock %} {% block content %} å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ãªã‚‹è¦ç´  {% endblock %} 20. èªè¨¼ ã‚¬ãƒ¼ãƒ‰ ãƒ»ã‚¬ãƒ¼ãƒ‰ã¨ã¯ ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/authentication.html#introduction ã‚¬ãƒ¼ãƒ‰ã®ç¨®é¡ èª¬æ˜ Webã‚¬ãƒ¼ãƒ‰ ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ãŸFormèªè¨¼ã®ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ APIã‚¬ãƒ¼ãƒ‰ Bearerèªè¨¼ã€APIã‚­ãƒ¼èªè¨¼ã€OAuthèªè¨¼ã€ãªã©ã®ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ãã‚Œãã‚Œã®èªè¨¼æ–¹æ³•ã«é•ã„ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html ãƒ»ã‚«ã‚¹ã‚¿ãƒ ã‚¬ãƒ¼ãƒ‰ LaravelãŒæ¨™æº–ã§æŒãŸãªã„ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’æŒã¤ã‚¬ãƒ¼ãƒ‰ã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/authentication.html#adding-custom-guards APIã‚¬ãƒ¼ãƒ‰ã®èªè¨¼ã§ç”¨ã„ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’JWTã«å¤‰æ›´ã—ãŸã„æ™‚ã«ã¯ã€ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒãŠã™ã™ã‚ã€‚ å‚è€ƒï¼šhttps://github.com/tymondesigns/jwt-auth ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ ãƒ»ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¨ã¯ ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®ç¨®é¡ èªè¨¼ã®ç¨®é¡ å®Ÿè£…ã‚¯ãƒ©ã‚¹ å‚™è€ƒ sessionãƒ‰ãƒ©ã‚¤ãƒãƒ¼ ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ãŸFormèªè¨¼ SessionGuardã‚¯ãƒ©ã‚¹ https://laravel.com/api/8.x/Illuminate/Auth/SessionGuard.html tokenãƒ‰ãƒ©ã‚¤ãƒãƒ¼ Bearerèªè¨¼ã€APIã‚­ãƒ¼èªè¨¼ã€OAuthèªè¨¼ TokenGuardã‚¯ãƒ©ã‚¹ https://laravel.com/api/8.x/Illuminate/Auth/TokenGuard.html ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®ç¨®é¡ã«å¿œã˜ã¦ã€AuthManagerã‚¯ãƒ©ã‚¹ãŒGuardã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…ã‚¯ãƒ©ã‚¹ã‚’è¿”å´ã™ã‚‹ã€‚auth.phpãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ä¾‹ãˆã°tokenãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’é¸ã‚“ã å ´åˆã¯ã€TokenGuardã‚¯ãƒ©ã‚¹ãŒè¿”å´ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://teratail.com/questions/171582 https://laravel.com/api/8.x/Illuminate/Auth/AuthManager.html https://laravel.com/api/8.x/Illuminate/Contracts/Auth/Guard.html#method_user https://laravel.com/api/8.x/Illuminate/Auth/TokenGuard.html#method_user [ 'web' => [ // ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ 'driver' => 'session', 'provider' => 'users', ], 'api' => [ // ãƒˆãƒ¼ã‚¯ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ¼ 'driver' => 'token', 'provider' => 'users', 'hash' => false, ], ], ]; ãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ä¿è­· BeforeMiddlwareã§èªè¨¼æ¸ˆã¿ã®ãƒ¦ãƒ¼ã‚¶ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã—ã€ã‚‚ã—æœªèªè¨¼ã®å ´åˆã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æœªèªè¨¼ã®ãƒ¦ãƒ¼ã‚¶ãŒã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’é˜²ãã€‚ å‚è€ƒï¼šhttps://qiita.com/yamotuki/items/b96978f8e379e285ecb6 ãƒ—ãƒ­ãƒã‚¤ãƒ€ ãƒ»ãƒ—ãƒ­ãƒã‚¤ãƒ€ã¨ã¯ èªè¨¼ãƒ‡ãƒ¼ã‚¿ã‚’DBã‹ã‚‰å–å¾—ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/authentication.html#introduction ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ãŸFormèªè¨¼ ãƒ»sessionãƒ‰ãƒ©ã‚¤ãƒãƒ¼ sessionãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’é¸æŠã™ã‚‹ã€‚ ãƒ»å…¨ã¦ã®ãƒ¦ãƒ¼ã‚¶ãŒåŒä¸€æ¨©é™ã‚’æŒã¤å ´åˆ SessionGuardã‚¯ãƒ©ã‚¹ã®attemptãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã€DBã®ãƒãƒƒã‚·ãƒ¥å€¤ã¨ç…§åˆã™ã‚‹ã€‚èªè¨¼ãŒæˆåŠŸã™ã‚‹ã¨ã€èªè¨¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹ã€‚redirectãƒ¡ã‚½ãƒƒãƒ‰ã§ã€èªè¨¼å¾Œã®åˆæœŸãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/authentication.html#authenticating-users validated(); if (Auth::attempt($validated)) { // ã‚»ãƒƒã‚·ãƒ§ãƒ³IDå›ºå®šåŒ–ã‚’é˜²ããŸã‚ã«ã€èªè¨¼å¾Œã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å†ä½œæˆã—ã¾ã™ã€‚ $authenticationRequest->session()->regenerate(); // èªè¨¼å¾Œãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ã€‚ return redirect(RouteServiceProvider::HOME); } // æœªèªè¨¼ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ã€‚ return redirect(RouteServiceProvider::UNAUTHORIZED); } } èªè¨¼å¾Œã®ãƒšãƒ¼ã‚¸ã¯RouteServiceProviderã‚¯ãƒ©ã‚¹ã§å®šç¾©ã—ã¦ãŠãã€‚ ãƒ»ä¸€éƒ¨ã®ãƒ¦ãƒ¼ã‚¶ãŒç•°ãªã‚‹æ¨©é™ã‚’æŒã¤å ´åˆ ãƒ¦ãƒ¼ã‚¶ã”ã¨ã«èªè¨¼æ–¹æ³•ã‚’åŒºåˆ¥ã—ã¤ã¤ã€åŒä¸€ã®èªè¨¼å¾Œãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://blog.capilano-fw.com/?p=8159 ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¨©é™ã®ç•°ãªã‚‹ãƒ¦ãƒ¼ã‚¶ã«å¿œã˜ãŸã‚¬ãƒ¼ãƒ‰ã€ã¾ãŸã‚¬ãƒ¼ãƒ‰ã«ç´ä»˜ã‘ã‚‹Eloquentãƒ¢ãƒ‡ãƒ«ã‚’ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’å®šç¾©ã—ã¦ãŠãã€‚ [ 'web' => [ 'driver' => 'session', 'provider' => 'users', ], 'api' => [ 'driver' => 'token', 'provider' => 'users', 'hash' => false, ], // ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ 'users' => [ 'driver' => 'session', 'provider' => 'users', ], // ç®¡ç†è€… 'administrators' => [ 'driver' => 'session', 'provider' => 'administrators', ], ], // ãƒ—ãƒ­ãƒã‚¤ãƒ€ 'providers' => [ // ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ 'users' => [ 'driver' => 'eloquent', 'model' => App\\Models\\User::class, ], // ç®¡ç†è€… 'administrators' => [ 'driver' => 'eloquent', 'model' => App\\Models\\Administrator::class, ] ], ]; Authãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®guardãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ã‚¬ãƒ¼ãƒ‰ã«å¿œã˜ãŸèªè¨¼ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åŒä¸€ã®èªè¨¼å¾Œãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ãŸå¾Œã«ã€ãƒ¦ãƒ¼ã‚¶ã®Eloquentãƒ¢ãƒ‡ãƒ«ã«å¿œã˜ãŸå‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ validated(); // guardã«å¿œã˜ãŸèªè¨¼ã‚’è¡Œã„ã¾ã™ã€‚ if (Auth::guard($authenticationRequest->guard)->attempt($validated)) { // ã‚»ãƒƒã‚·ãƒ§ãƒ³IDå›ºå®šåŒ–ã‚’é˜²ããŸã‚ã«ã€èªè¨¼å¾Œã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å†ä½œæˆã—ã¾ã™ã€‚ $authenticationRequest->session()->regenerate(); // ãƒ¦ãƒ¼ã‚¶ç”¨èªè¨¼å¾Œãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ã€‚ return redirect(RouteServiceProvider::HOME); } // æœªèªè¨¼ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ã€‚ return redirect(RouteServiceProvider::UNAUTHORIZED); } } èªè¨¼æ¸ˆã¿ã‹ã©ã†ã‹ã®åˆ¤å®š ãƒ»userãƒ¡ã‚½ãƒƒãƒ‰ ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãŒèªè¨¼æ¸ˆã¿ã§ã‚ã‚Œã°ã€ãƒ¦ãƒ¼ã‚¶ã®Eloquentãƒ¢ãƒ‡ãƒ«ã‚’å–å¾—ã™ã‚‹ã€‚ user(); ãƒ»checkãƒ¡ã‚½ãƒƒãƒ‰ ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãŒèªè¨¼æ¸ˆã¿ã§ã‚ã‚Œã°ã€trueã‚’è¿”å´ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š èªè¨¼æ¸ˆã¿ã®ãƒ¦ãƒ¼ã‚¶ãŒãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ãŸã¨ã—ã¦ã‚‚ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç¶šã„ã¦ã„ã‚‹ï¼ˆä¾‹ï¼šãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ãªã„ï¼‰é™ã‚Šã€èªè¨¼å‡¦ç†ã‚’æ”¹ã‚ã¦å®Ÿè¡Œã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ãã®ãŸã‚ã«ã€BeforeMiddlewareã‚’ç”¨ã„ã¦ã€èªè¨¼æ¸ˆã¿ã®ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’èªè¨¼æ¸ˆã¿ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ã‚‹ã€‚ guard($guard)->check()) { // ãƒ¦ãƒ¼ã‚¶ãŒèªè¨¼æ¸ˆã¿ã®å ´åˆã¯ã€èªè¨¼å¾Œã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ã€‚ return redirect(RouteServiceProvider::HOME); } } return $next($request); } } 20-02. èªå¯ ã‚²ãƒ¼ãƒˆ ãƒ»ã‚²ãƒ¼ãƒˆã¨ã¯ Eloquentãƒ¢ãƒ‡ãƒ«ãƒ¬ãƒ™ãƒ«ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å®šç¾©ã™ã‚‹ã€‚æŒ‡å®šã—ãŸEloquentãƒ¢ãƒ‡ãƒ«ã«ç´ä»˜ãå…¨ã¦ã®DBãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚‹ã€‚ ãƒãƒªã‚·ãƒ¼ ãƒ»ãƒãƒªã‚·ãƒ¼ã¨ã¯ DBãƒ¬ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å®šç¾©ã™ã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã«ç´ä»˜ãç‰¹å®šã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚‹ã€‚Policyã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸­ã®èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãŒè‡ªå‹•çš„ã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹ã€‚Eloquentãƒ¢ãƒ‡ãƒ«ã¨Policyã‚¯ãƒ©ã‚¹ã®ç´ä»˜ã‘ã¯AuthServiceProviderã‚¯ãƒ©ã‚¹ã§å®šç¾©ã™ã‚‹ å‚è€ƒï¼šhttps://qiita.com/mpyw/items/8c5413b99b8e299f7002#%E7%AC%AC1%E5%BC%95%E6%95%B0%E3%81%AF%E5%BF%85%E3%81%9A-authenticatable-%E3%81%AB%E3%81%AA%E3%82%8B%E4%BD%86%E3%81%97 id; // èªè¨¼ä¸­ã®ãƒ¦ãƒ¼ã‚¶ } /** * @param User $user * @param Foo $foo * @param int $barId * @return bool */ public function show(User $user, Foo $foo, int $barId): bool { $id = $foo->id; // ãƒ«ãƒ¼ã‚¿ãƒ¼ã¾ãŸã¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰æ¸¡ã•ã‚ŒãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ } /** * @param User $user * @param Foo $foo * @param int $barId * @return bool */ public function update(User $user, Foo $foo, int $barId): bool { // } /** * @param User $user * @param Foo $foo * @param int $barId * @return bool */ public function delete(User $user, Foo $foo, int $barId): bool { // } } FooPolicy::class, ]; /** * @return void */ public function boot() { $this->registerPolicies(); } } ãƒ»AuthorizeMiddlewareã«ã‚ˆã‚‹èªå¯ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«DBãƒ¬ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å®šç¾©ã™ã‚‹ã€‚AuthorizeMiddlewareã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã¯æ¨™æº–ã§canã§ã‚ã‚Šã€Kernelã‚¯ãƒ©ã‚¹ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚ç¬¬ä¸€å¼•æ•°ã«Policyã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰åã€ç¬¬äºŒå¼•æ•°ã«é–¢é€£ã™ã‚‹Eloquentãƒ¢ãƒ‡ãƒ«ã®ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã¾ãŸã¯ãã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¸¡ã™ã€‚åå‰ç©ºé–“ã‚’æ¸¡ã™å ´åˆã¯ã€ã“ã‚Œã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã›ãšã€é–¢æ•°ã§åå‰ç©ºé–“ã‚’å–å¾—ã—ã¦æ–‡å­—åˆ—ã¨çµåˆã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¸¡ã™å ´åˆã¯ã€æš—é»™ã®ãƒ¢ãƒ‡ãƒ«çµåˆã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚èªå¯ã«å¤±æ•—ã—ãŸå ´åˆã€403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/authorization.html#via-middleware ï¼Šå®Ÿè£…ä¾‹ï¼Š ['auth:web']], function () { Route::group(['prefix' => 'foos'], function () { Route::get('/{id}', [FooController::class, 'showFoo'])->middleware('can:show,'. Foo::class); Route::get('/', [FooController::class, 'indexFoo']); Route::post('/', [FooController::class, 'createFoo']); Route::put('/{id}', [FooController::class, 'updateFoo'])->middleware('can:update,'. Foo::class); Route::delete('/{id}', [FooController::class, 'deleteFoo'])->middleware('can:delete,'. Foo::class); }); }); ãƒ»authorizationãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹èªå¯ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©å®Ÿè¡Œæ™‚ã«DBãƒ¬ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å®šç¾©ã™ã‚‹ã€‚åŸºåº•ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚’ç¶™æ‰¿ã—ãŸã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã§ã¯authorizationãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã§ãã€ç¾åœ¨èªè¨¼ã•ã‚Œã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ã®DBã‚¢ã‚¯ã‚»ã‚¹ãŒèªå¯ã‚¹ã‚³ãƒ¼ãƒ—ã®ç¯„å›²å†…ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ç¬¬äºŒå¼•æ•°ã«ã€ãƒãƒªã‚·ãƒ¼ã«ç´ä»˜ãã‚¯ãƒ©ã‚¹åå‰ç©ºé–“ã‚ã‚‹ã„ã¯ãã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¸¡ã™ã€‚èªå¯ã«å¤±æ•—ã—ãŸå ´åˆã«AuthorizationExceptionã‚’æŠ•ã’ã‚‹ãŸã‚ã€ãã®å¾Œã¯è‡ªå‰ã§403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/authorization.html#via-controller-helpers https://readouble.com/laravel/8.x/ja/authorization.html#supplying-additional-context ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ¦ãƒ¼ã‚¶ãŒè©²å½“IDã®Fooãƒ¢ãƒ‡ãƒ«ã‚’æ›´æ–°ã™ã‚‹æ¨©é™ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ authorize('update', [$foo->find($id), $request->barId]); // Eloquentãƒ¢ãƒ‡ãƒ«ãŒä¸è¦ãªæ¤œè¨¼ã§ã‚ã‚Œã°åå‰ç©ºé–“ // $this->authorize('create', Foo::class); $foo->fill($request->all())->save(); } catch (Throwable $e) { // è‡ªå‰ã§403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ return response()->json(['error' => $e->getMessage()], 403); } // ç¶šãã®å‡¦ç† } } ãƒ»canãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹èªå¯ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©å®Ÿè¡Œæ™‚ã«DBãƒ¬ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å®šç¾©ã™ã‚‹ã€‚ç¾åœ¨èªè¨¼ã•ã‚Œã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰canãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ç¬¬äºŒå¼•æ•°ã¨ã—ã¦ã€ãƒãƒªã‚·ãƒ¼ã«ç´ä»˜ãã‚¯ãƒ©ã‚¹åå‰ç©ºé–“ã¾ãŸã¯ãã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¸¡ã™ã€‚DBã‚¢ã‚¯ã‚»ã‚¹ãŒã€ãã®ãƒ¦ãƒ¼ã‚¶ã®èªå¯ã‚¹ã‚³ãƒ¼ãƒ—ã®ç¯„å›²å†…ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚èªå¯ã«å¤±æ•—ã—ãŸå ´åˆã«falseã‚’è¿”å´ã™ã‚‹ãŸã‚ã€ãã®å¾Œã¯è‡ªå‰ã§403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/authorization.html#via-the-user-model https://readouble.com/laravel/8.x/ja/authorization.html#supplying-additional-context ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ¦ãƒ¼ã‚¶ãŒFooãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹æ¨©é™ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ user()->can('update', [$foo->find($id), $request->barId])) { // è‡ªå‰ã§403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ return response()->json(['error' => 'èªå¯ã‚¨ãƒ©ãƒ¼'], 403); } // Eloquentãƒ¢ãƒ‡ãƒ«ãŒä¸è¦ãªæ¤œè¨¼ã§ã‚ã‚Œã°åå‰ç©ºé–“ // if (!auth()->user()->can('update', Foo::class) {} $foo->fill($request->all())->save(); } } 20-03. Passportãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Passportãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ Ouathèªè¨¼ã‚’å®Ÿè£…ã§ãã‚‹ã€‚OAuthèªè¨¼ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html å°å…¥æ–¹æ³• ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« composerã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/passport.html $ composer require laravel/passport ãƒ»OAuthèªè¨¼ã®ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”Ÿæˆ äº‹å‰ã«ã€Passportã®ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ php artisan migrate Migrating: 2014_10_12_000000_create_users_table Migrated: 2014_10_12_000000_create_users_table (0.02 seconds) Migrating: 2014_10_12_100000_create_password_resets_table Migrated: 2014_10_12_100000_create_password_resets_table (0 seconds) Migrating: 2016_06_01_000001_create_oauth_auth_codes_table Migrated: 2016_06_01_000001_create_oauth_auth_codes_table (0 seconds) Migrating: 2016_06_01_000002_create_oauth_access_tokens_table Migrated: 2016_06_01_000002_create_oauth_access_tokens_table (0 seconds) Migrating: 2016_06_01_000003_create_oauth_refresh_tokens_table Migrated: 2016_06_01_000003_create_oauth_refresh_tokens_table (0 seconds) Migrating: 2016_06_01_000004_create_oauth_clients_table Migrated: 2016_06_01_000004_create_oauth_clients_table (0 seconds) Migrating: 2016_06_01_000005_create_oauth_personal_access_clients_table Migrated: 2016_06_01_000005_create_oauth_personal_access_clients_table ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã€ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã‚‹ã€‚ ãƒ†ãƒ¼ãƒ–ãƒ«å èª¬æ˜ oauth_access_tokens å…¨ã¦ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç®¡ç†ã™ã‚‹ã€‚ oauth_auth_codes Authorization Code Grantã‚¿ã‚¤ãƒ—ã®æƒ…å ±ã‚’ç®¡ç†ã™ã‚‹ã€‚ oauth_clients Passportã§ç”¨ã„ã¦ã„ã‚‹ä»˜ä¸ã‚¿ã‚¤ãƒ—ã‚’ç®¡ç†ã™ã‚‹ã€‚ oauth_personal_access_clients Personal Access Tokenã‚¿ã‚¤ãƒ—ã®æƒ…å ±ã‚’ç®¡ç†ã™ã‚‹ã€‚ oauth_refresh_tokens ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç®¡ç†ã™ã‚‹ã€‚ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸæ™‚ã«ã€å†ç”Ÿæˆã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://auth0.com/blog/jp-refresh-tokens-what-are-they-and-when-to-use-them/ ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆ ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã«ã‚ˆã‚Šã€/storage/oauthã‚­ãƒ¼ã€Personal Access Clientã€Password Grant Clientã‚’ç”Ÿæˆã™ã‚‹ã€‚ $ php artisan passport:install Personal access client created successfully. Client ID: 3 Client secret: xxxxxxxxxxxx Password grant client created successfully. Client ID: 4 Client secret: xxxxxxxxxxxx ãŸã ã—ã€ç”Ÿæˆã‚³ãƒãƒ³ãƒ‰ã‚’å€‹åˆ¥ã«å®Ÿè¡Œã—ã¦ã‚‚ã‚ˆã„ã€‚ # æš—å·ã‚­ãƒ¼ã‚’ç”Ÿæˆ $ php artisan passport:keys # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆ ## Persinal Access Tokenã®å ´åˆ $ php artisan passport:client --personal ## Password Grant Tokenã®å ´åˆ $ php artisan passport:client --password å®Ÿè£…å¯èƒ½ãªOAuthèªè¨¼ã®ç¨®é¡ ãƒ»OAuthèªè¨¼ OAuthèªè¨¼ã«é–¢ã—ã¦ã€ä»¥ä¸‹ã®ãƒˆãƒ¼ã‚¯ãƒ³ä»˜ä¸ã‚¿ã‚¤ãƒ—ã‚’å®Ÿè£…ã§ãã‚‹ã€‚ ä»˜ä¸ã‚¿ã‚¤ãƒ— èª¬æ˜ Authorization Code Grant å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html Client Credentials Grant å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html Implicit Grant å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html Password Grant å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html ãƒ»ãã®ä»– èªè¨¼æ–¹æ³• èª¬æ˜ Personal Access Token å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html Password Grant ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®å®Ÿè£… guardsã‚­ãƒ¼ã«ã¦ã€èªè¨¼æ–¹å¼ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã“ã§ã¯ã€apiã‚’è¨­å®šã™ã‚‹ã€‚ return [ // ï½ ä¸­ç•¥ ï½ \"defaults\" => [ \"guard\" => \"api\", \"passwords\" => \"users\", ], // ï½ ä¸­ç•¥ ï½ ]; OAuthèªè¨¼ï¼ˆèªè¨¼ãƒ•ã‚§ãƒ¼ã‚ºï¼‹èªå¯ãƒ•ã‚§ãƒ¼ã‚ºï¼‰ã‚’è¡Œã†ãŸã‚ã«ã€auth.phpãƒ•ã‚¡ã‚¤ãƒ«ã§ã€driverã‚­ãƒ¼ã«passportãƒ‰ãƒ©ã‚¤ãƒã‚’è¨­å®šã™ã‚‹ã€‚ã¾ãŸã€providerã‚­ãƒ¼ã§ã€usersã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š return [ // ï½ ä¸­ç•¥ ï½ \"guards\" => [ \"web\" => [ \"driver\" => \"session\", \"provider\" => \"users\", ], \"api\" => [ \"driver\" => \"passport\", \"provider\" => \"users\", \"hash\" => false, ], ], // ï½ ä¸­ç•¥ ï½ ]; auth.phpãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€driverã‚­ãƒ¼ã«eloquentãƒ‰ãƒ©ã‚¤ãƒã‚’è¨­å®šã™ã‚‹ã€‚ã¾ãŸã€modelã‚­ãƒ¼ã§èªè¨¼æƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾å¿œã™ã‚‹Eloquentã®Eloquentãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã“ã§ã¯ã€Userã‚¯ãƒ©ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚Laravelã§ã¯ã€Eloquentãƒ¢ãƒ‡ãƒ«ã«å¯¾å¿œã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«åã¯ã‚¯ãƒ©ã‚¹åã®è¤‡æ•°å½¢ã«ãªã‚‹ãŸã‚ã€usersãƒ†ãƒ¼ãƒ–ãƒ«ã«èªè¨¼æƒ…å ±ãŒæ ¼ç´ã•ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã‚‚ã—DBãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®ã‚¯ã‚¨ãƒªãƒ“ãƒ«ãƒ€ã‚’ç”¨ã„ãŸã„å ´åˆã¯ã€databaseãƒ‰ãƒ©ã‚¤ãƒã‚’è¨­å®šã™ã‚‹ã€‚ return [ // ï½ ä¸­ç•¥ ï½ \"providers\" => [ \"users\" => [ \"driver\" => \"eloquent\", // Eloquentãƒ¢ãƒ‡ãƒ«ã¯è‡ªç”±ã«æŒ‡å®šã§ãã‚‹ã€‚ \"model\" => App\\Models\\User::class, ], // \"users\" => [ // \"driver\" => \"database\", // \"table\" => \"users\", // ], ], // ï½ ä¸­ç•¥ ï½ ]; Userã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«ã€middlewareãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹èªè¨¼ã‚¬ãƒ¼ãƒ‰ã‚’è¡Œã†ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€OAuthèªè¨¼ã«æˆåŠŸã—ãŸãƒ¦ãƒ¼ã‚¶ã®ã¿ãŒãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Route::get(\"user\", \"UserController@index\")->middleware(\"auth:api\"); èªè¨¼ã‚¬ãƒ¼ãƒ‰ã‚’è¡Œã£ãŸEloquentãƒ¢ãƒ‡ãƒ«ã«å¯¾ã—ã¦ã€HasAPITokenã€Notifiableã®Traitã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Passportã®routesãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Passportã®èªè¨¼ãƒ•ã‚§ãƒ¼ã‚ºã«é–¢ã‚ã‚‹å…¨ã¦ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆ/oauth/xxxï¼‰ãŒæœ‰åŠ¹ã«ãªã‚‹ã€‚ã¾ãŸã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã§ãã‚‹ã‚ˆã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š registerPolicies(); Passport::routes(); } } æš—å·ã‚­ãƒ¼ã¨ãƒ¦ãƒ¼ã‚¶ã‚’ä½œæˆã™ã‚‹ã€‚ $ php artisan passport:keys $ php artisan passport:client --password ãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªå´ã®å®Ÿè£… ã€èªè¨¼ã€ã®ãŸã‚ã«ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶å´ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€/oauth/authorizeã¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã“ã§ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆGuzzleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š post(\"http://your-app.com/oauth/token\", [ \"form_params\" => [ \"grant_type\" => \"password\", \"client_id\" => \"client-id\", \"client_secret\" => \"client-secret\", \"username\" => \"taylor@laravel.com\", \"password\" => \"my-password\", \"scope\" => \"\", ], ]); ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚€JSONå‹ãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"token_type\":\"Bearer\", \"expires_in\":31536000, \"access_token\":\"xxxxx\" } ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚ã¦ã€èªè¨¼ã‚¬ãƒ¼ãƒ‰ã®è¨­å®šã•ã‚ŒãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«å¯¾ã—ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š request(\"GET\", \"/api/user\", [ \"headers\" => [ \"Accept\" => \"application/json\", \"Authorization\" => \"Bearer xxxxx\", ] ]); return (string)$response->getBody(); ãƒ»APIã‚¬ãƒ¼ãƒ‰ç”¨ã®ãƒ†ãƒ¼ãƒ–ãƒ« ï¼Šå®Ÿè£…ä¾‹ï¼Š bigIncrements(\"user_id\")->comment(\"ãƒ¦ãƒ¼ã‚¶ID\"); $table->string(\"name\")->comment(\"ãƒ¦ãƒ¼ã‚¶å\"); $table->string(\"api_token\")->unique()->comment(\"APIãƒˆãƒ¼ã‚¯ãƒ³\"); // MigrationMacroServiceProviderã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ $table->systemColumns(); // deleted_atã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã™ã‚‹ã€‚ $table->softDeletes(); }); } /** * @return void */ public function down() { Schema::drop(\"users\"); } } Personal Access Token ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®å®Ÿè£… æš—å·ã‚­ãƒ¼ã¨ãƒ¦ãƒ¼ã‚¶ã‚’ä½œæˆã™ã‚‹ã€‚ $ php artisan passport:keys $ php artisan passport:client --personal ä½œæˆã—ãŸãƒ¦ãƒ¼ã‚¶ã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã‚’ä»˜ä¸ã™ã‚‹ã€‚ /** * å…¨èªè¨¼ï¼èªå¯ã®ç™»éŒ² * * @return void */ public function boot() { $this->registerPolicies(); Passport::routes(); Passport::personalAccessClientId(\"client-id\"); } ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã‚’å…ƒã«ã€èªè¨¼ã€ã‚’è¡Œã„ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã€‚ createToken(\"Token Name\")->accessToken; // ã‚¹ã‚³ãƒ¼ãƒ—ä»˜ãã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½œæˆã™ã‚‹ $token = $user->createToken(\"My Token\", [\"place-orders\"])->accessToken; 20-04. Sanctumãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Sanctumãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ APIã‚­ãƒ¼èªè¨¼ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ãŸFormèªè¨¼æ©Ÿèƒ½ã®èªè¨¼å‡¦ç†ã®ã¿ã‚’æä¾›ã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨DBã‚¢ã‚¯ã‚»ã‚¹ã«é–¢ã™ã‚‹å‡¦ç†ã¯æä¾›ã—ãªã„ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/sanctum.html APIã‚­ãƒ¼èªè¨¼ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ãŸFormèªè¨¼ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html å°å…¥æ–¹æ³• ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« $ composer require laravel/sanctum APIãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆå¤–éƒ¨ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å«ã‚€ï¼‰ã¯ä»»æ„ã¨ã—ã€APIã®ã¿ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã€ä½¿ç”¨ãŒé©ã—ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/sanctum.html#api-token-authentication https://stackoverflow.com/questions/65550823/laravel-sanctum-api-token-security https://laracasts.com/discuss/channels/laravel/why-is-it-bad-to-use-sanctum-api-tokens-to-authenticate-your-own-first-party-spa SPAèªè¨¼ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒ‘ãƒ¼ãƒ†ã‚£ã®SPAï¼ˆè‡ªç¤¾ã®SPAï¼‰ã‚’ä½¿ç”¨ã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®APIã‚’å®Ÿè£…ã™ã‚‹å ´åˆã€ä½¿ç”¨ãŒé©ã—ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/sanctum.html#spa-authentication https://stackoverflow.com/questions/65550823/laravel-sanctum-api-token-security https://laracasts.com/discuss/channels/laravel/why-is-it-bad-to-use-sanctum-api-tokens-to-authenticate-your-own-first-party-spa 20-05. Fortifyãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Fortifyãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ LaravelãŒæŒã¤å…¨ã¦ã®èªè¨¼æ©Ÿèƒ½ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/fortify.html https://readouble.com/laravel/8.x/ja/fortify.html#laravel-fortify-and-laravel-sanctum 20-06. Breezeãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Breezeãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ LaravelãŒæŒã¤å…¨ã¦ã®èªè¨¼æ©Ÿèƒ½ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆèªè¨¼ï¼‹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‹DBã‚¢ã‚¯ã‚»ã‚¹ï¼‰å‡¦ç†ã¨ã€ã“ã‚Œã«å¯¾å¿œã™ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚ å‚è€ƒï¼š https://readouble.com/laravel/8.x/ja/starter-kits.html#laravel-breeze https://readouble.com/laravel/8.x/ja/fortify.html#laravel-fortify-and-laravel-sanctum å°å…¥æ–¹æ³• å‚è€ƒï¼šhttps://github.com/laravel/breeze ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ $ composer require laravel/breeze:^1.0 --dev ãƒ»èªè¨¼å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ç”Ÿæˆ èªè¨¼å‡¦ç†ã«é–¢é€£ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã€‚Bladeã«çµ„ã¿åˆã‚ã›ã‚‹JavaScriptã‚’é¸ã¹ã‚‹ã€‚ $ php artisan breeze:install 20-07. UIãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆLaravel 7ç³»ä»¥å‰ï¼‰ UIãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ LaravelãŒæŒã¤å…¨ã¦ã®èªè¨¼æ©Ÿèƒ½ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆèªè¨¼ï¼‹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‹DBã‚¢ã‚¯ã‚»ã‚¹ï¼‰å‡¦ç†ã¨ã€ã“ã‚Œã«å¯¾å¿œã™ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å‡¦ç†ã‚’æä¾›ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/7.x/ja/authentication.html å°å…¥æ–¹æ³• ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ $ composer require laravel/ui:^1.0 --dev ãƒ»èªè¨¼å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ç”Ÿæˆ èªè¨¼å‡¦ç†ã«é–¢é€£ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã€‚Bladeã«çµ„ã¿åˆã‚ã›ã‚‹JavaScriptã‚’é¸ã¹ã‚‹ã€‚ # Vuejsã‚’ç”¨ã„ã‚‹å ´åˆã€‚ $ php artisan ui vue --auth # Reactã‚’ç”¨ã„ã‚‹å ´åˆ $ php artisan ui react --auth # Bootstrapã‚’ç”¨ã„ã‚‹å ´åˆã€‚ $ php artisan ui bootstrap --auth 21. Laravel Mixãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Laravel Mixãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ Webpackã‚’Laravelã‚’ä»‹ã—ã¦æ“ä½œã§ãã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã“ã¨ã€‚Breezeãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚‚åŒæ¢±ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/mix.html Webpackã‚’æ“ä½œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ ãƒ»ã‚¢ã‚»ãƒƒãƒˆã®åˆæœŸã‚³ãƒ³ãƒ‘ã‚¤ãƒ« ã‚¢ã‚»ãƒƒãƒˆã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ npm run dev ãƒ»ã‚¢ã‚»ãƒƒãƒˆã®è‡ªå‹•å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« ã‚¢ã‚»ãƒƒãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã«ã€ã“ã‚Œã¨æ¤œçŸ¥ã—ã€è‡ªå‹•çš„ã«å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ npm run watch 22. éå…¬å¼ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ laravel-enum ãƒ»ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ å‚è€ƒï¼šhttps://github.com/BenSampo/laravel-enum ãƒ»Enumã‚¯ãƒ©ã‚¹ã®å®šç¾© BenSampoã®Enumã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ã€åŒºåˆ†å€¤ã¨åˆ¤å®šãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š is(self::CALL_ROLE); } /** * é–‹ç™ºè·ã®åŒºåˆ†å€¤ã‚’æŒã¤ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚ */ public function isDevelopmentRole() { return $this->is(self::DEVELOPMENT_ROLE); } /** * çµŒç†è·ã®åŒºåˆ†å€¤ã‚’æŒã¤ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚ */ public function isFinanceRole() { return $this->is(self::FINANCE_ROLE); } /** * ä¼ç”»è·ã®åŒºåˆ†å€¤ã‚’æŒã¤ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚ */ public function isPlanRole() { return $this->is(self::PLAN_ROLE); } /** * å–¶æ¥­è·ã®åŒºåˆ†å€¤ã‚’æŒã¤ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚ */ public function isSalesRole() { return $this->is(self::SALES_ROLE); } } ãƒ»Enumã‚¯ãƒ©ã‚¹ã®ä½¿ã„æ–¹ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰åŒºåˆ†å€¤ã‚’SELECTã—ãŸå¾Œã€ã“ã‚Œã‚’å…ƒã«Enumã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ roleType = new RoleType($fetched[\"role_type\"]); // ä»¥ä¸‹ã®æ–¹æ³•ã§ã‚‚ã‚ˆã„ã€‚ // $staff->roleType = RoleType::fromValue($fetched[\"role_type\"]); // StaffãŒã„ãšã‚Œã®RoleTypeã‚’æŒã¤ã‹ $staff->roleType->isDevelopmentRole(); // true $staff->roleType->isSalesRole(); // false ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ãŸå¾Œã€ã“ã‚Œã‚’å…ƒã«Enumã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ laravel-ide-helper ãƒ»laravel-ide-helperã¨ã¯ PHPStromã§Laravelã‚’é–‹ç™ºã™ã‚‹å ´åˆã€æ‹¡å¼µæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/barryvdh/laravel-ide-helper#phpstorm-meta-for-container-instances ãƒ»Facade $ php artisan ide-helper:generate ãƒ»ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ Laravelã®Eloquentãƒ¢ãƒ‡ãƒ«ã§ã€ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã€‚ $ php artisan ide-helper:models ãƒ»äºˆæ¸¬è¡¨ç¤º Laravelã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’äºˆæ¸¬è¡¨ç¤ºã™ã‚‹ãŸã‚ã€phpstorm.meta.phpãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ã€‚ $ php artisan ide-helper:meta "},"public/software/software_application_object_oriented_language_php_framework_symfony.html":{"url":"public/software/software_application_object_oriented_language_php_framework_symfony.html","title":"ğŸ“– ï¸Symfony","keywords":"","body":"Symfony ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. å‚è€ƒã«ãªã‚‹ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ å‚è€ƒï¼šhttps://symfony.com/doc/current/the-fast-track/ja/index.html 01-02. Symfonyã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ Symfony â”œâ”€â”€ configã€€# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚«ãƒ¼ãƒãƒ«ã®ãŸã‚ã®ãƒ«ãƒ¼ãƒˆå®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ç­‰ï¼‰ â”‚ â”œâ”€â”€ binã€€# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ« â”‚ â”œâ”€â”€ console #bin/consoleã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« â”‚ â””â”€â”€ symfony_requirements â”‚ â”œâ”€â”€ public | â”œâ”€â”€ index.php # æœ¬ç•ªç’°å¢ƒã§ã€ã‚«ãƒ¼ãƒãƒ«ã¨ã—ã¦å‹•ã | â””â”€â”€ index_dev.php # é–‹ç™ºç’°å¢ƒã§ã€ã‚«ãƒ¼ãƒãƒ«ã¨ã—ã¦å‹•ã â”‚ â”œâ”€â”€ srcã€€# ä¸»è¦ãªPHPãƒ•ã‚¡ã‚¤ãƒ« â”‚ â”œâ”€â”€ AppBundle # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ â”‚ â”‚ â”œâ”€â”€ Controllerã€€# UserCaseå±¤ â”‚ â”‚ â”œâ”€â”€ Entity # ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€€â‡’ã€€Domainå±¤ â”‚ â”‚ â”œâ”€â”€ Repository # ãƒªãƒã‚¸ãƒˆãƒª â‡’ Infrastructureå±¤ â”‚ â”‚ â”œâ”€â”€ Form # ãƒ•ã‚©ãƒ¼ãƒ  â”‚ â”‚ â””â”€â”€ Resources â”‚ â”‚ â””â”€â”€ views # ç”»é¢ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆâ€»æœ¬æ›¸ã§ã¯æ‰±ã‚ãªã„ï¼‰ â”‚ â”‚ â”‚ â””â”€â”€ ãã®ä»–ã®Bundle # æ±ç”¨çš„ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼ˆâ€»æœ¬æ›¸ã§ã¯æ‰±ã‚ãªã„ï¼‰ | â”œâ”€â”€ templatesã€€# UserInterfaceå±¤ â”‚ â”œâ”€â”€ test # è‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆUnit testsç­‰ï¼‰ â”‚ â”œâ”€â”€ var # è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ« â”‚ â”œâ”€â”€ cache # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ« â”‚ â”œâ”€â”€ logs # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« â”‚ â””â”€â”€ sessions â”‚ â”œâ”€â”€ vendor # å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª â”‚ â”œâ”€â”€ doctrine # ãƒ©ã‚¤ãƒ–ãƒ©ãƒª â”‚ â”œâ”€â”€ league # ãƒ©ã‚¤ãƒ–ãƒ©ãƒª â”‚ â”œâ”€â”€ sensio â”‚ â”œâ”€â”€ swiftmailer # ãƒ©ã‚¤ãƒ–ãƒ©ãƒª â”‚ â”œâ”€â”€ symfonyã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ # ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ â”‚ â””â”€â”€ twig # ãƒ©ã‚¤ãƒ–ãƒ©ãƒª â”‚ â””â”€â”€ asset #ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å…¬é–‹ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆcss, javascript, imageç­‰ï¼‰ â”œâ”€â”€ admin â”œâ”€â”€ bootstrap â”œâ”€â”€ css â”œâ”€â”€ fontawesome â”œâ”€â”€ img # ç”»åƒãƒ•ã‚¡ã‚¤ãƒ« â”œâ”€â”€ jquery # jqueryï¼ˆjavascriptãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼‰ â””â”€â”€ js # javascriptãƒ•ã‚¡ã‚¤ãƒ« 02. ç‰¹ã«æ±ç”¨çš„ãªSymfonyã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ Console HttpFoundation HttpKernel Pimple Security EventDispatcher Routing Cache 03. Console CLIï¼šCommand Line Interface ãƒ»CLIã¨ã¯ ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ.shï¼‰ã€ã¾ãŸã¯ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.batï¼‰ã«ãŠã‘ã‚‹ã‚³ãƒãƒ³ãƒ‰ã®å‡¦ç†å†…å®¹ã‚’å®šç¾©ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š setName(\"create:example\"); // ã‚³ãƒãƒ³ãƒ‰åã®å¾Œã«è¿½åŠ ã—ãŸã„å¼•æ•°å $this->addArgument( \"year-month\", InputArgument::REQUIRED, \"å‡¦ç†å¹´æœˆã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚\" ); } // ã‚³ãƒãƒ³ãƒ‰ã®å‡¦ç†å†…å®¹ protected function execute(InputeInterface $input, OutputInterface $output) { try { // æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰Carbonã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ $year_month = Carbon::createFromFormat( \"Y-m\", $input->getArgument(\"year-month\") ); } catch (\\Exception $e) { // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®æ–‡ç« ã‚’ä½œæˆ } } } CLIã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ« ãƒ»for # txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ•°fã«ç¹°ã‚Šè¿”ã—æ ¼ç´ã—ã€å‡¦ç†ã‚’è¡Œã†ã€‚ for f in *txt do echo $f; done; ãƒ»Cronã«ã‚ˆã‚‹ã‚³ãƒãƒ³ãƒ‰ã®è‡ªå‹•å®Ÿè¡Œ ï¼Šä¾‹ï¼Š 10ç§’ã”ã¨ã«ã€ã‚³ãƒãƒ³ãƒ‰ã‚’è‡ªå‹•å®Ÿè¡Œã™ã‚‹ã€‚ # 10ç§’ã”ã¨ã«ã€ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã‚’å®Ÿè¡Œã€‚ for f in `seq 0 10 59`; do (sleep {$f}; create:example) & done; # 15æ™‚ã”ã¨ã«ã€ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã‚’å®Ÿè¡Œã€‚ 0 15 * * * * create:example; 03-02. HttpFoundation AppKernel ãƒ»ã‚«ãƒ¼ãƒãƒ«ã«å¿…è¦ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Requestã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‹ã‚‰åé›†ã—ãŸæƒ…å ±ã‚„HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã‚„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æƒ…å ±ã‚’ä¿æŒ ã‚«ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®handle() é€ã‚‰ã‚Œã¦ããŸURLã‚’åŸºã«ã—ãŸã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ï¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¸ã®ãƒ«ãƒ¼ãƒˆã®ç‰¹å®šã€ç‰¹å®šã•ã‚ŒãŸã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ï¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° Responseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã‚„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æƒ…å ±ãªã©ã®æƒ…å ±ã‚’ä¿æŒ ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å–ã‚Šå‡ºã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã®å½¹å‰² ã‚«ãƒ¼ãƒãƒ«ãŒã€ã‚¯ãƒ©ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦å—ã‘å–ã‚‹ã€‚ ã‚«ãƒ¼ãƒãƒ«ãŒã€é€ã‚‰ã‚Œã¦ããŸURLã¨ãƒ«ãƒ¼ãƒˆå®šç¾©ã‚’åŸºã«ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾å¿œã™ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¢ã—ã€å®Ÿè¡Œã•ã›ã‚‹ã€‚ãã®å¾Œã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒURLã‚’ç”Ÿæˆã€‚ ã‚«ãƒ¼ãƒãƒ«ãŒã€ãã®çµæœã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã™ã€‚ ã“ã®ã‚«ãƒ¼ãƒãƒ«ã‚’ã€ç‰¹åˆ¥ã«ã€HTTPã‚«ãƒ¼ãƒãƒ«ã€ã¨å‘¼ã¶ã€‚ ã€app.phpã®å®Ÿè£…ä¾‹ã€‘ loadClassCache(); } $request = Request::createFromGlobals(); //ï¼ˆï¼‘ï¼‰ // ä»¥ä¸‹ã®å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‚ç…§ã›ã‚ˆã€‚ $response = $kernel->handle($request); //ï¼ˆï¼’ï¼‰ $response->send(); //ï¼ˆï¼“ï¼‰ $kernel->terminate($request, $response); ä¸Šè¨˜ã®handle()ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ã“ã“ã§å®šç¾©ã•ã‚ŒãŸhandle()ãŒã€C/Aã¸ã®ãƒ«ãƒ¼ãƒˆã®ç‰¹å®šã€ç‰¹å®šã•ã‚ŒãŸC/Aã®å®Ÿè¡Œã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚ boot(); ++$this->requestStackSize; $this->resetServices = true; try { return $this->getHttpKernel()->handle($request, $type, $catch); } finally { --$this->requestStackSize; } } Requestã€Response ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã€JSONå‹ãƒ‡ãƒ¼ã‚¿ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ Ajaxã«ã‚ˆã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã€JSONå‹ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã—ã€ã‹ã¤ãƒšãƒ¼ã‚¸ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã€‚ Ajaxã«ã‚ˆã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ãªã„å ´åˆã€ãƒšãƒ¼ã‚¸ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ã¿ headers->get(\"content-type\") === \"application/json\") { $xxxRepository = new XxxRepository; $entityObject = $xxxRepository->getEntity(); //-- entityã‚’Objectå‹ã‹ã‚‰Arrayå‹ã«å¤‰æ›ã™ã‚‹ä½•ã‚‰ã‹ã®å‡¦ç†ã€‚--// // Ajaxã«ãƒ¬ãƒ³ã‚¹ãƒãƒ³ã‚¹ã€‚ return new JsonResponse([ \"value\" => $entityArray ]); } return $this->render(\".../xxx.twig\")->setStatusCode(200); } } ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã®å–å¾— query->get('hoge'); // $_POST['hoge'] $request->request->get('hoge'); // ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ / ex) @Route('/{hoge}') $request->attributes->get('hoge'); // $_COOKIE['hoge'] $request->cookies->get('hoge'); // $_FILES['hoge'] $request->files->get('hoge'); // $_SERVER['SCRIPT_FILENAME'] $request->server->get('SCRIPT_FILENAME'); // $_SERVER['HTTP_USER_AGENT'] $request->headers->get('User-Agent'); // query > attribute > request ã®é †ã§æ¤œç´¢ $request->get('hoge'); 03-03. HttpKernel HttpKernelã«ã‚ˆã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ 03-04. Pimple Service Container Symfonyã‹ã‚‰æä¾›ã•ã‚Œã‚‹DIã‚³ãƒ³ãƒ†ãƒŠã®ã“ã¨ã€‚ 03-05. Routing RoutingConfigurator ãƒ»RoutingConfiguratorã¨ã¯ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¨­å®šã™ã‚‹ã€‚ add(\"api_post_show\", \"/api/posts/{id}\") ->controller([BlogApiController::class, \"show\"]) ->methods([\"GET\", \"HEAD\"]) ; $routes->add(\"api_post_edit\", \"/api/posts/{id}\") ->controller([BlogApiController::class, \"edit\"]) ->methods([\"PUT\"]) ; }; 03-06. Cache FilesystemAdapter ãƒ»FilesystemAdapterã¨ã¯ ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã§ãã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€åå‰ç©ºé–“ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥å­˜ç¶šæ™‚é–“ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã‚’æŒ‡å®šã§ãã‚‹ã€‚ getItem(\"stats.products_count\"); // ã‚­ãƒ£ãƒƒã‚·ãƒ¥IDã«ç´ä»˜ãã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¢ã‚¤ãƒ†ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã€ãƒ‡ãƒ¼ã‚¿ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆ if (!$cacheItemObj->isHit()) { // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¢ã‚¤ãƒ†ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š $cacheItemObj->set(777); // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¢ã‚¤ãƒ†ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç´ä»˜ã‘ã‚‹ã€‚ $cache->save($cacheItemObj); } // ã‚­ãƒ£ãƒƒã‚·ãƒ¥IDã«ç´ä»˜ããƒ‡ãƒ¼ã‚¿ãŒã‚ã£ãŸå ´åˆã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¢ã‚¤ãƒ†ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã€‚ $cacheItemObj = $cache->get(); "},"public/software/software_application_object_oriented_language_php_package_management.html":{"url":"public/software/software_application_object_oriented_language_php_package_management.html","title":"ğŸ“– ï¸ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†","keywords":"","body":"Composer ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ autoload åå‰ç©ºé–“ã¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®å¯¾å¿œé–¢ä¿‚ã‚’è¨­å®šã™ã‚‹ã€‚requireé–¢æ•°ã‚’ä½¿ç”¨ã›ãšã«ã€ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã‚’useã§æŒ‡å®šã™ã‚‹ã ã‘ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚ã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼š https://getcomposer.org/doc/04-schema.md#autoload https://atmarkit.itmedia.co.jp/ait/articles/1808/01/news009_3.html { \"autoload\": { \"psr-4\": { # \"\": \"\", \"App\\\\\": \"app/\", \"Database\\\\Factories\\\\Infrastructure\\\\DTO\\\\\": \"database/factories/production\", \"Database\\\\Seeders\\\\\": \"database/seeds/production\" }, \"classmap\": [ \"database/seeds\", \"database/factories\" ] } } require ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://getcomposer.org/doc/04-schema.md#package-links # å€‹äººçš„ã«ä¸€ç•ªãŠã™ã™ã‚ # ã‚­ãƒ£ãƒ¬ãƒƒãƒˆè¡¨è¨˜ { \"require\": { \"foo\": \"^1.1.1\", # >=1.1.1 and =1.1.0 and =0.0.1 and # ãƒãƒ«ãƒ€è¡¨è¨˜ { \"require\": { \"foo\": \"~1.1.1\", # >=1.1.1 and =1.1.0 and =1.1.0 and # ã‚¨ãƒƒã‚¯ã‚¹ã€ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯è¡¨è¨˜ { \"require\": { \"foo\": \"*\", # ã©ã‚“ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚‚OK \"bar\": \"1.1.x\", # >=1.1.0 and =1.0.0 and scripts ã‚³ãƒãƒ³ãƒ‰ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://getcomposer.org/doc/04-schema.md#scripts { \"scripts\": { # ã‚¨ã‚¤ãƒªã‚¢ã‚¹å \"post-autoload-dump\": [ # å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ \"Illuminate\\\\Foundation\\\\ComposerScripts::postAutoloadDump\", \"@php artisan package:discover --ansi\" ], \"post-root-package-install\": [ \"@php -r \\\"file_exists(\".env\") || copy(\".env.example\", \".env\");\\\"\" ], \"post-create-project-cmd\": [ \"@php artisan key:generate --ansi\" ] } } version composerã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹composerã¨é½Ÿé½¬ãŒãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://getcomposer.org/doc/04-schema.md#version { \"version\": \"1.10.23\" } 02. ã‚³ãƒãƒ³ãƒ‰ clear-cache ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ç”Ÿæˆã•ã‚ŒãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ composer clear-cache diagnose composerã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®æº–å‚™ãŒæƒã£ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $ composer diagnose You are running Composer with SSL/TLS protection disabled. Checking composer.json: OK Checking platform settings: OK Checking git settings: OK Checking http connectivity to packagist: OK Checking https connectivity to packagist: OK ... dump-autoload äº‹å‰ã«è¨­å®šã•ã‚ŒãŸautoloadãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«åŸºã¥ã„ã¦ã€ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®å¯¾å¿œé–¢ä¿‚ã‚’ç™»éŒ²ã™ã‚‹ã€‚ $ composer dump-autoload install ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¦ã€composer.lockãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å…¨ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚composer.lockãƒ•ã‚¡ã‚¤ãƒ«ã®ãŠã‹ã’ã§ã€ãƒªãƒã‚¸ãƒˆãƒªã®åˆ©ç”¨è€…ãŒã€composer installã®å®Ÿè¡Œæ™‚ã«ã€å…±é€šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã€‚ $ composer install ãƒ»-vvv ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ä¸­ã®ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ $ composer install -vvv ãƒ»--no-dev require-devã‚¿ã‚°å†…ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯é™¤ã„ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« $ composer install --no-dev ãƒ»--prefer-dist Composerã®é…å¸ƒã‚µã‚¤ãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚prefer-sourceã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã‚ˆã‚Šã‚‚é«˜é€Ÿã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§distã‚’ç”¨ã„ã‚‹ãŸã‚ã€å®Ÿéš›ã¯å®£è¨€ã—ãªãã¦ã‚‚å•é¡Œãªã„ã€‚ $ composer install --prefer-dist ãƒ»--prefer-source GitHubã®Composerãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚Composerã®é–‹ç™ºè€…ç”¨ã§ã‚ã‚‹ã€‚ $ composer install --prefer-source require ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã‚’composer.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ãè¾¼ã‚€ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯è¡Œã‚ãªã„ã€‚ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã›ãšã«è‡ªåˆ†ã§å®Ÿè£…ã—ã¦ã‚‚è‰¯ã„ã€‚ $ composer require :^x.x scripts äº‹å‰ã«è¨­å®šã•ã‚ŒãŸscriptsãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è¨­å®šã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ composer update ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¦ã€composer.jsonãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã†ã¡ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ã‚‚ã®ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ã¾ãŸã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æŒ‡å®šã‚’ã‚‚ã¨ã«æ›´æ–°å¯èƒ½ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ›´æ–°ã™ã‚‹ã€‚composer.lockãƒ•ã‚¡ã‚¤ãƒ«ã«å…¨ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±ã‚’æ›¸ãè¾¼ã‚€ã€‚ãƒªãƒã‚¸ãƒˆãƒªã®åˆ©ç”¨è€…ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚‚å½±éŸ¿ã‚’ä¸ãˆã‚‹ã€‚ $ composer update ãƒ»-vvv ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ä¸­ã®ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ $ composer install -vvv ãƒ»COMPOSER_MEMORY_LIMIT=-1 phpã®ãƒ¡ãƒ¢ãƒªä¸Šé™ã‚’ç„¡ã—ã«ã—ã¦ã€ä»»æ„ã®composerã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚phpãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨ã„ã‚‹ã€‚Dockerã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œã™ã‚‹å ´åˆã€è¨­å®šç”»é¢ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã®CPUã‚„ãƒ¡ãƒ¢ãƒªã‚’å¢—è¨­ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ $ COMPOSER_MEMORY_LIMIT=-1 composer update -vvv 03. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ autoload.phpãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã€vendorãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸‹ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã¨ä»®å®šã™ã‚‹ã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ãŸã³ã«ã€å„ã‚¯ãƒ©ã‚¹ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã¯æ‰‹é–“ãªã®ã§ã€ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆindex.phpï¼‰ã‚ã‚‹ã„ã¯bootstrap.phpã§ã€æœ€åˆã«èª­ã¿è¾¼ã‚“ã§ãŠãã€ã‚¯ãƒ©ã‚¹ã§ã¯èª­ã¿è¾¼ã¾ãªãã¦è‰¯ã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 04. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã®æ‰‹é † äº‹å‰ç¢ºèªã®é‡è¦æ€§ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°ã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã“ã‚Œã«é–¢ä¿‚ã™ã‚‹ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å½±éŸ¿ãŒèµ·ã“ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ãã®ãŸã‚ã€äºˆæƒ³å¤–ã®å½±éŸ¿ãŒèµ·ã“ã‚‰ãªã„ã‚ˆã†ã«ã€ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚„ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã«ã¦ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³é–“ã®å·®ç•°ã‚’å…¨ã¦ç¢ºèªã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ ãƒãƒ¼ã‚¸ãƒ§ãƒ³é–“ã®äº’æ›æ€§ã‚’ç¢ºèª ç ´å£Šçš„å¤‰æ›´ã®ãŸã‚ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³é–“ã§äº’æ›æ€§ãŒå…¨ããªãã€å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ä½¿ç”¨æ–¹æ³•ã‚„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒç•°ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ä¸€æ–¹ã§ã€äº’æ›æ€§ãŒã‚ã‚‹ã‚‚ã®ã®ã€å¤§ããªå¤‰æ›´ãŒãªã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ è¿½åŠ ã€å»ƒæ­¢ã€éæ¨å¥¨ã‚’ç¢ºèª ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã«ã‚ˆã‚Šã€æ–°ã—ã„æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ä¸€æ–¹ã§ã€ä»Šã¾ã§ã®æ–¹æ³•ãŒå»ƒæ­¢ã¾ãŸã¯éæ¨å¥¨ã«ç§»è¡Œã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ äºˆç´„èªã‚„é–¢æ•°ã‚’ç¢ºèª ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã«ã‚ˆã‚Šã€äºˆç´„èªã‚„é–¢æ•°ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚äºˆç´„èªã‚’è‡ªèº«ãŒç”¨ã„ã¦ã„ã‚‹ã¨ãƒãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã†ã€‚ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¿®æ­£ä½œæ¥­ã®è€ƒæ…® ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã«ä¼´ã£ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ãŒå¿…è¦ãªã“ã¨ãŒã‚ã‹ã£ãŸå ´åˆã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã®æ‰‹é †è‡ªä½“ã«ä¿®æ­£ä½œæ¥­ã‚’çµ„ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒšãƒ¼ã‚¸ã®è¡¨ç¤º ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã«ã‚ˆã‚Šãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹å ´åˆã€ãã®é–“ã¯ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€ä¾‹ãˆã°ã€ALBã«ã¯ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ãŒã‚ã‚‹ã€‚ æ›´æ–°ä½œæ¥­ã‚’ãƒªãƒãƒ¼ã‚µãƒ« ãƒ†ã‚¹ãƒˆç’°å¢ƒã§æ›´æ–°ä½œæ¥­ã‚’ãƒªãƒãƒ¼ã‚µãƒ«ã—ã€å•é¡Œãªãå®Œäº†ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ ãƒ†ã‚¹ãƒˆç’°å¢ƒã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—å¾Œã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã‚’æœ€åˆã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ åˆ‡ã‚Šæˆ»ã—ä½œæ¥­ã®è€ƒæ…® æœ¬ç•ªç’°å¢ƒã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—å¾Œã«æƒ³å®šå¤–ã®å•é¡ŒãŒèµ·ã“ã‚‹ã“ã¨ã‚‚è€ƒæ…®ã—ã¦ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã®æ‰‹é †è‡ªä½“ã«åˆ‡ã‚Šæˆ»ã—ä½œæ¥­ã‚’çµ„ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚‹ã€‚ "},"public/software/software_application_object_oriented_language_php_package_mysql.html":{"url":"public/software/software_application_object_oriented_language_php_package_mysql.html","title":"ğŸ“– ï¸MySQLãƒ‘ãƒƒã‚±ãƒ¼ã‚¸","keywords":"","body":"MySQLãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. èª­ã¿å‡ºã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã®å–å¾— ãƒ•ã‚§ãƒƒãƒ ãƒ»ãƒ•ã‚§ãƒƒãƒã¨ã¯ èª­ã¿å‡ºã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ã«ä¸€åº¦ã«å…¨ã¦å–å¾—ã—ã¦ã—ã¾ã†ã¨ã€ã‚µãƒ¼ãƒå´ã®ãƒ¡ãƒ¢ãƒªã‚’åœ§è¿«ã—ã¦ã—ã¾ã†ã€‚ãã“ã§ã€å°‘ã—ãšã¤å–å¾—ã™ã‚‹ã€‚ ãƒ»ãƒ•ã‚§ãƒƒãƒã®ãƒ¡ã‚½ãƒƒãƒ‰åã«é–¢ã™ã‚‹æ³¨æ„ç‚¹ æ³¨æ„ç‚¹ã¨ã—ã¦ã€FETCHé–¢æ•°ã¯ã€ãƒ™ãƒ³ãƒ€ãƒ¼ã«ã‚ˆã£ã¦åå‰ãŒç•°ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãã®ãŸã‚ã€åŒã˜åå‰ã§ã‚‚åŒã˜åˆ†ã ã‘ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã¨ã¯é™ã‚‰ãªã„ã€‚ 02. PDO èª­ã¿å‡ºã— ãƒ»prepareãƒ¡ã‚½ãƒƒãƒ‰ ãƒ—ãƒªãƒšã‚¢ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’ç”¨ã„ã¦SQLã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ—ãƒªã‚¢ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã«ã‚ˆã‚‹SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®é˜²å¾¡ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ãƒ»fetchãƒ¡ã‚½ãƒƒãƒ‰ èª­ã¿å‡ºã•ã‚ŒãŸå…¨ã¦ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã†ã¡ã€æœ€åˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å…¨ã¦ã®ã‚«ãƒ©ãƒ ã‚’å–å¾—ã—ã€ä¸€æ¬¡å…ƒã®é€£æƒ³é…åˆ—ã§è¿”å´ã™ã‚‹ã€‚ ãƒ»fetchAllãƒ¡ã‚½ãƒƒãƒ‰ èª­ã¿å‡ºã•ã‚ŒãŸå…¨ã¦ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã€å…¨ã¦ã®ã‚«ãƒ©ãƒ ã‚’å–å¾—ã—ã€äºŒæ¬¡å…ƒã®é€£æƒ³é…åˆ—ã§è¿”å´ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š prepare($sql); // ãƒ—ãƒªãƒšã‚¢ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’å®šç¾©ã€‚ $stmt->execute(); // å®Ÿè¡Œã€‚ // å…¨ã¦ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã€‚ $data = $stmt->fetchAll(); // å‡ºåŠ› print_r($data); // ã‚«ãƒ©ãƒ åã¨å€¤ã®é€£æƒ³é…åˆ—ã¨ã—ã¦å–å¾—ã§ãã‚‹ã€‚ // Array // ( // [0] => Array // ( // [id] => 1 // [name] => ã®ã³å¤ª // [gender] => man // [type] => human // ) // [1] => Array // ( // [id] => 2 // [name] => ãƒ‰ãƒ©ãˆã‚‚ã‚“ // [gender] => man // [type] => robot // ) // ) ãƒ»fetchColumnãƒ¡ã‚½ãƒƒãƒ‰ èª­ã¿å‡ºã•ã‚ŒãŸå…¨ã¦ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã†ã¡ã€æœ€åˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä¸€ç•ªå·¦ã®ã‚«ãƒ©ãƒ ã®ã¿ã‚’å–å¾—ã—ã€æ··åˆå‹ã§è¿”å´ã™ã‚‹ã€‚ä¸»ã«ã€COUNTé–¢æ•°ã®å ´åˆã«ç”¨ã„ã‚‹ ï¼Šå®Ÿè£…ä¾‹ï¼Š prepare($sql); // ãƒ—ãƒªãƒšã‚¢ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’å®šç¾©ã€‚ $stmt->execute(); // å®Ÿè¡Œã€‚ // ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã€‚ $data = $stmt->fetchColumn(); // å‡ºåŠ› print_r($data); // 10 (ä»¶) æ›¸ãè¾¼ã¿ ãƒ»INSERT ã€ãªã©ã®ç‰¹æ®Šæ–‡å­—ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆç„¡å®³åŒ–ï¼‰ $staff_name = htmlspecialchars($staff_name, ENT_QUOTES, \"UTF-8\"); $staff_pass = htmlspecialchars($staff_pass, ENT_QUOTES, \"UTF-8\"); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨æ¥ç¶šï¼ˆã‚¤ã‚³ãƒ¼ãƒ«ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ï¼‰ $dsn = \"mysql:dbname=kizukeba_pronami_php; host=kizukebapronamiphp charaset=UTF-8\"; $user = \"root\"; $password = \"\"; $dbh = new PDO($dsn, $user, $password); $dbh->setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION); // åˆ—åã¨å€¤ã‚’æŒ‡å®šã—ã¦INSERT $sql=\"INSERT INTO mst_staff (name,password) VALUES (?,?)\"; $stmt = $dbh->prepare($sql); // é…åˆ—ã«å€¤ã‚’æ ¼ç´ï¼ˆæ ¼ç´ã™ã‚‹å€¤ã®é †ç•ªã¨ã€SQLã§ã®å¼•æ•°ã®é †ç•ªã¯ã€åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰ $data[] = $staff_name; $data[] = $staff_pass; // SQLã‚’å®Ÿè¡Œ $stmt->execute($data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®æ¥ç¶šã‚’åˆ‡æ–­ $dbh = null; ãƒ»UPDATE ãƒ»DELETE 03. Doctrineãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Doctrineã¨ã¯ RDBã®èª­ã¿è¾¼ã¿ç³»ï¼æ›¸ãè¾¼ã¿ç³»ã®æ“ä½œã‚’è¡Œã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€‚ä»–ã®åŒæ§˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã€PDOãŒã‚ã‚‹ã€‚PDOã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_database.html SQLã®å®šç¾© ãƒ»createQueryBuilderãƒ¡ã‚½ãƒƒãƒ‰ CRUDå‡¦ç†ã«å¿…è¦ãªSQLã‚’ä¿æŒã—ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦SQLã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.doctrine-project.org/projects/doctrine-dbal/en/2.10/reference/query-builder.html ï¼Šå®Ÿè£…ä¾‹ï¼Š createQueryBuilder(); èª­ã¿å‡ºã— ãƒ»selectãƒ¡ã‚½ãƒƒãƒ‰ QueryBuilderã‚¯ãƒ©ã‚¹ã«ãŠã‘ã‚‹selectãƒ¡ã‚½ãƒƒãƒ‰ã«ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š select(\"id\", \"name\") ->from(\"mst_users\"); æ›¸ãè¾¼ã¿ ãƒ»insertãƒ¡ã‚½ãƒƒãƒ‰ QueryBuilderã‚¯ãƒ©ã‚¹ã«ãŠã‘ã‚‹insertãƒ¡ã‚½ãƒƒãƒ‰ã«ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š insert(\"mst_users\") ãƒ»updateãƒ¡ã‚½ãƒƒãƒ‰ QueryBuilderã‚¯ãƒ©ã‚¹ã«ãŠã‘ã‚‹updateãƒ¡ã‚½ãƒƒãƒ‰ã«ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š update(\"mst_users\"); ãƒ»deleteãƒ¡ã‚½ãƒƒãƒ‰ QueryBuilderã‚¯ãƒ©ã‚¹ã«ãŠã‘ã‚‹deleteãƒ¡ã‚½ãƒƒãƒ‰ã«ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š delete(\"mst_users\"); å®Ÿè¡Œ ãƒ» getConnectionãƒ¡ã‚½ãƒƒãƒ‰ã€executeQueryãƒ¡ã‚½ãƒƒãƒ‰ã€fetchAllãƒ¡ã‚½ãƒƒãƒ‰ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šã—ã€SQLã®å®Ÿè¡Œã™ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã«é–¢ã‚ã‚‹getConnectionãƒ¡ã‚½ãƒƒãƒ‰ã‚’èµ·ç‚¹ã¨ã—ã¦ã€è¿”ã‚Šå€¤ã‹ã‚‰ç¹°ã‚Šè¿”ã—ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å–å¾—ã—ã€fetchAllãƒ¡ã‚½ãƒƒãƒ‰ã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¯ã‚¨ãƒªåã‚’ã‚­ãƒ¼ã¨ã—ãŸé€£æƒ³é…åˆ—ãŒè¿”ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š getConnection() // SQLã‚’å®Ÿè¡Œã—ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å‡ºã™ã€‚ ->executeQuery($queryBuilder->getSQL(), $queryBuilder->getParameters() )->fetchAll(); èª­ã¿å‡ºã—ç³»ã®æ“ä½œ ãƒ»ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ ãƒ—ãƒªãƒšã‚¢ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®SQLä¸­ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã€å€¤ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«æ¸¡ã—ãŸä¸Šã§ã€SQLã¨ã—ã¦ç™ºè¡Œã™ã‚‹æ–¹æ³•ã€‚å‡¦ç†é€Ÿåº¦ãŒé€Ÿã„ã€‚ã¾ãŸã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«èª¤ã£ã¦SQLãŒæ¸¡ã•ã‚Œã¦ã‚‚ã€ã“ã‚Œã‚’å®Ÿè¡Œã§ããªããªã‚‹ãŸã‚ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å¯¾ç­–ã«ã‚‚ãªã‚‹ã€‚SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/security/security_cyber_attacks.html ï¼Šå®Ÿè£…ä¾‹ï¼Š createQueryBuilder(); // ãƒ—ãƒªãƒšã‚¢ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®å®šç¾© $queryBuilder->select([ \"dog_toy.type AS dog_toy_type\", \"dog_toy.name AS dog_toy_name\", \"dog_toy.number AS number\", \"dog_toy.price AS dog_toy_price\", \"dog_toy.color_value AS color_value\" ]) // FROMã‚’è¨­å®šã™ã‚‹ã€‚ ->from(\"mst_dog_toy\", \"dog_toy\") // WHEREã‚’è¨­å®šã™ã‚‹ã€‚ã“ã®æ™‚ã€å€¤ã¯ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã¨ã—ã¦ãŠãã€‚ ->where(\"dog_toy.type = :type\") // ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã«å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã“ã§ã¯ã€å¼•æ•°ã§æ¸¡ã™ã€$toyTypeã€ã¨ã™ã‚‹ã€‚ ->setParameter(\"type\", $toyType); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã€‚ return $queryBuilder->getConnection() // SQLã‚’å®Ÿè¡Œã—ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å‡ºã™ã€‚ ->executeQuery($queryBuilder->getSQL(), $queryBuilder->getParameters() )->fetchAll(); } } ãƒ»ãƒ‡ãƒ¼ã‚¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ èª­ã¿å‡ºã—ç³»ã§å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§ãã‚‹ã€‚ createQueryBuilder(); // ä½•ã‚‰ã‹ã®SQLã‚’å®šç¾© $query = $queryBuilder->select()->from() // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚ã‚‹å ´åˆã€ArrayStatementã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ ¼ç´ // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãªã„å ´åˆã€ResultCacheStatementã‚’æ ¼ç´ $statement = $this->connection->executeQuery( $query->getSQL(), $query->getParameters(), $queryParameterTypes(), new QueryCacheProfile() ); $result = $statement->fetchAll(); $statement->closeCursor(); return $result; } } æ›¸ãè¾¼ã¿ç³»ã®æ“ä½œ ãƒ»ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã€ã‚³ãƒŸãƒƒãƒˆã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ RDBã®å‡¦ç†ç”¨èªã«ç›¸å½“ã™ã‚‹beginTransactionãƒ¡ã‚½ãƒƒãƒ‰ã€commitãƒ¡ã‚½ãƒƒãƒ‰ã€rollBackãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€RDBã‚’æ“ä½œã™ã‚‹ã€‚ å‚ç…§ï¼šhttps://www.doctrine-project.org/projects/doctrine-dbal/en/2.10/reference/transactions.html ï¼Šå®Ÿè£…ä¾‹ï¼Š beginTransaction(); try{ // ã‚³ãƒŸãƒƒãƒˆ $conn->commit(); } catch (\\Exception $e) { // ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ $conn->rollBack(); throw $e; } 04. ãã®ä»– ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ DBã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã—ãŸã¾ã¾ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆã‚„ã‚«ãƒ©ãƒ ã®å¤‰æ›´ãªã©ã‚’è¡Œã†ãŸã‚ã®æ©Ÿèƒ½ã®ã“ã¨ã€‚ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã¨å‘¼ã°ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ–°è¦ä½œæˆã‚„ã‚«ãƒ©ãƒ ã®è¿½åŠ ã¯ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã—ã¦ã„ãã€‚ é‹ç”¨æ‰‹é † èª°ã‹ãŒä»¥ä¸‹ã®Migrationãƒ•ã‚¡ã‚¤ãƒ«ã‚’masteråˆ¥åã«Push Migrationãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«Pull ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°ãƒãƒƒãƒã‚’å®Ÿè¡Œã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–° ï¼Šå®Ÿè£…ä¾‹ï¼Š "},"public/software/software_application_object_oriented_language_php_package_others.html":{"url":"public/software/software_application_object_oriented_language_php_package_others.html","title":"ğŸ“– ï¸ãã®ä»–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸","keywords":"","body":"ãã®ä»–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Carbonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Dateå‹ å³å¯†ã«ã¯ãƒ‡ãƒ¼ã‚¿å‹ã§ã¯ãªã„ãŒã€ä¾¿å®œä¸Šã€ãƒ‡ãƒ¼ã‚¿å‹ã¨ã™ã‚‹ã€‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¨ã¯ã€å”å®šä¸–ç•Œæ™‚(UTC)ã‚’åŸºæº–ã«ã—ãŸ1970å¹´1æœˆ1æ—¥ã®0æ™‚0åˆ†0ç§’ã‹ã‚‰ã®çµŒéç§’æ•°ã‚’è¡¨ã—ãŸã‚‚ã®ã€‚ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ å®Ÿè£…æ–¹æ³• å‚™è€ƒ æ—¥ä»˜ 2019-07-07 åŒºåˆ‡ã‚Šè¨˜å·ãªã—ã€ãƒ‰ãƒƒãƒˆã€ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ãªã©ã‚‚å¯èƒ½ æ™‚é–“ 19:07:07 åŒºåˆ‡ã‚Šè¨˜å·ãªã—ã€ã‚‚å¯èƒ½ æ—¥æ™‚ 2019-07-07 19:07:07 åŒä¸Š ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆç§’ï¼‰ 1562494027 1970å¹´1æœˆ1æ—¥ã®0æ™‚0åˆ†0ç§’ã‹ã‚‰2019-07-07 19:07:07 ã¾ã§ã®çµŒéç§’æ•° instanceãƒ¡ã‚½ãƒƒãƒ‰ DateTimeã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å¼•æ•°ã¨ã—ã¦ã€Carbonã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ createãƒ¡ã‚½ãƒƒãƒ‰ æ—¥æ™‚ã®æ–‡å­—åˆ—ã‹ã‚‰Carbonã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š createFromXXXãƒ¡ã‚½ãƒƒãƒ‰ æŒ‡å®šã®æ–‡å­—åˆ—ã‹ã‚‰ã€Carbonã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ»æ—¥æ™‚æ•°å­—ã‹ã‚‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»æ™‚é–“æ•°å­—ã‹ã‚‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»æ—¥ä»˜ã€æ™‚é–“ã€æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ ç¬¬ä¸€å¼•æ•°ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š parseãƒ¡ã‚½ãƒƒãƒ‰ æ—¥ä»˜ã€æ™‚é–“ã€æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã€Carbonã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚createFromFormatãƒ¡ã‚½ãƒƒãƒ‰ã¨ã¯ç•°ãªã‚Šã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 02. Pinqãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Pinqã¨ã¯ï¼šPhp Integrated Query é…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ä»–ã®åŒæ§˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã€LinqãŒã‚ã‚‹ã€‚ Traversable::fromãƒ¡ã‚½ãƒƒãƒ‰ SQLã®SELECTã‚„WHEREã¨ã„ã£ãŸå˜èªã‚’ç”¨ã„ã¦ã€foreachã®ã‚ˆã†ã«ã€é…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã®å„è¦ç´ ã«å¯¾ã—ã¦ã€å‡¦ç†ã‚’è¡Œãˆã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Traversable::from($entities) // ä¸€ã¤ãšã¤è¦ç´ ã‚’å–ã‚Šå‡ºã—ã€é–¢æ•°ã«æ¸¡ã™ã€‚ ->select( function ($entity) { return $this->convertToArray($entity); }) // indexã‹ã‚‰ãªã‚‹é…åˆ—ã¨ã—ã¦è¿”å´ã€‚ ->asArray(), ]; } } 03. Guzzleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Guzzleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ é€šå¸¸ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€å—ä¿¡ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã‚µãƒ¼ãƒã«å¯¾ã—ã¦ã€Postmanã‚„curlé–¢æ•°ãªã©ã‚’ç”¨ã„ã¦è¡Œã†ã€‚ã—ã‹ã—ã€Guzzleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®Clientã‚’ä½¿ãˆã°ã€ã‚µãƒ¼ãƒã‹ã‚‰ä»–ã‚µãƒ¼ãƒï¼ˆå¤–éƒ¨ã®APIãªã©ï¼‰ã«å¯¾ã—ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€å—ä¿¡ãŒã§ãã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ãƒ»GETé€ä¿¡ å‚è€ƒï¼šhttps://docs.guzzlephp.org/en/stable/quickstart.html#query-string-parameters ï¼Šå®Ÿè£…ä¾‹ï¼Š request( \"GET\", \"https://xxxxxxxx\", [ \"query\" => [ \"id\" => 1 ] ] ); ãƒ»POSTé€ä¿¡ å‚è€ƒï¼šhttps://docs.guzzlephp.org/en/stable/quickstart.html#post-form-requests \"Hello World!\" ]); // POSTé€ä¿¡ $response = $client->request( \"POST\", \"https://xxxxxxxx\", [ \"headers\" => [ \"Authorization\" => $this->token, \"Content-Length\" => strlen($json), \"Content-Type\" => \"application/json\", ], \"form_params\" => [ \"body\" => $message ] ] ); ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ãƒœãƒ‡ã‚£ã‚’å–å¾— ï¼Šå®Ÿè£…ä¾‹ï¼Š \"Hello World!\" ]); // POSTé€ä¿¡ $response = $client->request( \"POST\", \"https://xxxxxxxx\", [ \"headers\" => [ \"Authorization\" => $this->token, \"Content-Length\" => strlen($json), \"Content-Type\" => \"application/json\", ], \"form_params\" => [ \"body\" => $message ] ] ); $body = json_decode($response->getBody(), true); 04. Knp/Snappyãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Knp/Snappyã¨ã¯ ãƒ­ãƒ¼ã‚«ãƒ«ã¾ãŸã¯æŒ‡å®šã—ãŸURLã®htmlãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€PDFã‚„ç”»åƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€‚ ãƒ»generateFromHtmlãƒ¡ã‚½ãƒƒãƒ‰ htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ã—ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š generateFromHtml(\"foo.html\", \".../foo.pdf\"); 05. Respect/Validationãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Respect/Validationã¨ã¯ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ã„ã‹ã‚’ã€ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰å´ã§æ¤œè¨¼ã™ã‚‹ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦ã¯ã€JavaScriptã¨PHPã®ä¸¡æ–¹ã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ "},"public/software/software_application_object_oriented_language_php_testing.html":{"url":"public/software/software_application_object_oriented_language_php_testing.html","title":"ğŸ“– ï¸ãƒ†ã‚¹ãƒˆ","keywords":"","body":"ãƒ†ã‚¹ãƒˆ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ ãƒ†ã‚¹ãƒˆæ‰‹é † ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æ•´å½¢ã™ã‚‹ã€‚ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®é™çš„è§£æã‚’è¡Œã†ã€‚ ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã€‚ æ•´å½¢ãƒ„ãƒ¼ãƒ« PhpStormã€PHP-CS-Fixer é™çš„è§£æãƒ„ãƒ¼ãƒ« PhpStormã€PHPStanã€Larastan ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã€æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ« PHPUnit 02. ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ ãƒ†ã‚¹ãƒˆæ‰‹é † ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ã«åŸºã¥ãã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã€Integrationãƒ†ã‚¹ãƒˆã€User Acceptanceãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã€‚ ã‚°ãƒ©ãƒ•ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®å¯è¦–åŒ– "},"public/software/software_application_object_oriented_language_php_testing_based_on_code.html":{"url":"public/software/software_application_object_oriented_language_php_testing_based_on_code.html","title":"ğŸ“– ï¸ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ","keywords":"","body":"ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã®è¦ç´  æ§‹æˆå›³ å„ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆãƒ†ã‚¹ãƒˆé–¢æ•°ï¼‰ã¯ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆï¼ˆãƒ†ã‚¹ãƒˆã®çµ„ï¼‰ã‹ã‚‰æ§‹æˆã•ã‚Œã€å…¨ã¦ã¯ãƒ†ã‚¹ãƒˆãƒ—ãƒ©ãƒ³ã§ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ã€‚ 02-02. PHPUnitã«ã‚ˆã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ ã‚³ãƒãƒ³ãƒ‰ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— å…¨ã¦ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã¨ã—ã¦ã€å®šç¾©ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ vendor/bin/phpunit PHPUnit 9.5.0 by Sebastian Bergmann and contributors. ... 3 / 3 (100%) Time: 621 ms, Memory: 24.00 MB OK (3 tests, 3 assertions) ãƒ»--filter ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã¨ã—ã¦ã€å®šç¾©ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ vendor/bin/phpunit --filter Foo PHPUnit 9.5.0 by Sebastian Bergmann and contributors. ... 1 / 1 (100%) Time: 207 ms, Memory: 8.00 MB OK (1 tests, 1 assertions) ãƒ»--list-tests å®Ÿè¡Œã®å¯¾è±¡ã¨ãªã‚‹ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€è¦§ã§è¡¨ç¤ºã™ã‚‹ã€‚ $ vendor/bin/phpunit --list-tests PHPUnit 9.5.0 by Sebastian Bergmann and contributors. Available test(s): - Tests\\Unit\\FooTest::testFooMethod - Tests\\Feature\\FooTest::testFooMethod phpunit.xmlãƒ•ã‚¡ã‚¤ãƒ« ãƒ»phpunit.xmlãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ PHPUnitã®è¨­å®šã‚’è¡Œã†ã€‚æ¨™æº–ã®è¨­å®šã§ã¯ã€ã‚ã‚‰ã‹ã˜ã‚ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«testsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’é…ç½®ã—ã€ã“ã‚Œã‚’Unitsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¾ãŸã¯Featureãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«åˆ†å‰²ã—ã¦ãŠãã€‚ã¾ãŸã€Testã§çµ‚ã‚ã‚‹phpãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttp://phpunit.readthedocs.io/ja/latest/configuration.html ãƒ»testsuitesã‚¿ã‚° ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’å®šç¾©ã§ãã‚‹ã€‚testsuitesã‚¿ã‚°å†…ã®testsuitesã‚¿ã‚°ã‚’è¿½åŠ å¤‰æ›´ã™ã‚‹ã¨ã€æ¤œè¨¼å¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¢—ã‚„ã—ã€ã¾ãŸå¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’å¤‰æ›´ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://phpunit.readthedocs.io/ja/latest/configuration.html#appendixes-configuration-testsuites ... ./tests/Unit ./tests/Feature ... ãƒ»phpã‚¿ã‚° PHPUnitã®å®Ÿè¡Œå‰ã«è¨­å®šã™ã‚‹ini_seté–¢æ•°ã€defineé–¢æ•°ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã€ã‚’å®šç¾©ã§ãã‚‹ã€‚ã‚¿ã‚°åã¨ã®å¯¾å¿œé–¢ä¿‚ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://phpunit.readthedocs.io/ja/latest/configuration.html#php-ini ï¼Šå®Ÿè£…ä¾‹ï¼Š composerã®å®Ÿè¡Œæ™‚ã«ãƒ¡ãƒ¢ãƒªä¸è¶³ã«ãªã‚‰ãªã„ã‚ˆã†ã«ãƒ¡ãƒ¢ãƒªã‚’æ‹¡å¼µã™ã‚‹ã€‚ã¾ãŸã€ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã§ãã‚‹ã‚ˆã†ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é–¢ã™ã‚‹ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ ... --> ... ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã¯ å®Ÿéš›ã®å€¤ã¨æœŸå¾…å€¤ã‚’æ¯”è¼ƒã—ã€çµæœã«å¿œã˜ã¦SUCCESSã¾ãŸã¯FAILURESã‚’è¿”å´ã™ã‚‹ã€‚éstaticã¾ãŸã¯staticã¨ã—ã¦ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://phpunit.readthedocs.io/ja/latest/assertions.html $this->assertTrue(); self::assertTrue() ãƒ»assertTrue å®Ÿéš›å€¤ãŒtrueã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $this->assertTrue($response->isOk()); ãƒ»assertEquals ã€==ã€ã‚’ç”¨ã„ã¦ã€æœŸå¾…å€¤ã¨å®Ÿéš›å€¤ã®æ•´åˆæ€§ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿å‹ã‚’æ¤œè¨¼ã§ããªã„ãŸã‚ã€assertSameãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹æ–¹ãŒè‰¯ã„ã€‚ $this->assertSame(200, $response->getStatusCode()); ãƒ»assertSame ã€===ã€ã‚’ç”¨ã„ã¦ã€æœŸå¾…å€¤ã¨å®Ÿéš›å€¤ã®æ•´åˆæ€§ã‚’æ¤œè¨¼ã™ã‚‹ã€‚å€¤ã ã‘ã§ãªãã€ãƒ‡ãƒ¼ã‚¿å‹ã‚‚æ¤œè¨¼ã§ãã‚‹ã€‚ $this->assertSame(200, $response->getStatusCode()); ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ ãƒ»ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨ã¯ ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒã€ãã‚Œå˜ä½“ã§ä»•æ§˜é€šã‚Šã«å‡¦ç†ãŒå‹•ä½œã™ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹æ–¹æ³•ã€‚æ¤œè¨¼å¯¾è±¡ä»¥å¤–ã®å‡¦ç†ã¯ã‚¹ã‚¿ãƒ–ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚ç†æƒ³ã¨ã—ã¦ã¯ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å±¤ã”ã¨ã«ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã®æ™‚ã€ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã«é–¢ã‚ã‚‹å±¤ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ãŸã‚ã«ã€æœ¬æ¥ã®DBã¨ã¯åˆ¥ã«ã€ã‚ã‚‰ã‹ã˜ã‚ãƒ†ã‚¹ãƒˆç”¨DBã‚’ç”¨æ„ã—ãŸæ–¹ãŒè‰¯ã„ã€‚ãƒ†ã‚¹ãƒˆç”¨DBã‚’docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã£ã¦ç”¨æ„ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/virtualization/virtualization_container_orchestration.html ï¼Šå®Ÿè£…ä¾‹ï¼Š ä»¥é™ã®ãƒ†ã‚¹ãƒˆä¾‹ã§ã¯ã€æ¬¡ã®ã‚ˆã†ãªé€šçŸ¥ã‚¯ãƒ©ã‚¹ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ãŒå‰æã«ã‚ã‚‹ã¨ã™ã‚‹ã€‚ httpClient = $httpClient; $this->token = $token; $this->logger = $logger; } public function sendMessage(FooMessage $fooMessage) { if (empty($this->token)) { throw new CouldNotSendMessageException(\"API requests is required.\"); } if (empty($fooMessage->channel_id)) { throw new CouldNotSendMessageException(\"Channnel ID is required.\"); } $json = json_encode($fooMessage->message); try { $this->httpClient->request( \"POST\", \"https://xxxxxxxx\", [ \"headers\" => [ \"Authorization\" => $this->token, \"Content-Length\" => strlen($json), \"Content-Type\" => \"application/json\", ], \"form_params\" => [ \"body\" => $fooMessage->message ] ] ); } catch (ClientException $exception) { $this->logger->error(sprintf( \"ERROR: %s at %s line %s\", $exception->getMessage(), $exception->getFile(), $exception->getLine() )); throw new CouldNotSendMessageException($exception->getMessage()); } catch (\\Exception $exception) { $this->logger->error(sprintf( \"ERROR: %s at %s line %s\", $exception->getMessage(), $exception->getFile(), $exception->getLine() )); throw new CouldNotSendMessageException($exception->getMessage()); } return true; } } channel_id = $channel_id; $this->message = $message; } } ãƒ»æ­£å¸¸ç³»ãƒ†ã‚¹ãƒˆä¾‹ ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€@testã‚’å®£è¨€ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¦ã€ãƒãƒ£ãƒ³ãƒãƒ«ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ãŸæ™‚ã«ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦TRUEãŒè¿”ä¿¡ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ client = \\Phake::mock(Client::class); $this->logger = \\Phake::mock(LoggerInterface::class); } /** * @test */ public function testSendMessage_FooMessage_ReturnTrue() { $fooNotification = new FooNotification( $this->client, \"xxxxxxx\", $this->logger ); $fooMessage = new FooMessage(\"test\", \"X-CHANNEL\"); $this->assertTrue( $fooNotification->sendMessage($fooMessage) ); } } # Time: x seconds # OK ãƒ»ç•°å¸¸ç³»ãƒ†ã‚¹ãƒˆä¾‹ ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€@testã¨@expectedExceptionã‚’å®£è¨€ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’é€ä¿¡ã—ã‚ˆã†ã¨ã—ãŸæ™‚ã«ã€ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‰ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ client = \\Phake::mock(Client::class); $this->logger = \\Phake::mock(LoggerInterface::class); } /** * @test * @expectedException */ public function testSendMessage_EmptyMessage_ExceptionThrown() { $fooNotification = new FooNotification( $this->client, \"xxxxxxx\", $this->logger ); $fooMessage = new FooMessage(\"test\", \"\"); $fooNotification->sendMessage($fooMessage); } } # Time: x seconds # OK æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ ãƒ»æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã¨ã¯ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒæ­£ã—ãè¿”ä¿¡ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹æ–¹æ³•ã€‚ã‚¹ã‚¿ãƒ–ã‚’ç”¨ã„ã‚‹ã“ã¨ã¯å°‘ãªã„ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€@testã‚’å®£è¨€ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š request( \"GET\", \"https://xxxxxxxx\", [ \"query\" => [ \"id\" => 1 ] ] ); // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å®Ÿéš›å€¤ã¨æœŸå¾…å€¤ã®æ•´åˆæ€§ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ } } ãƒ»ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹ HTTPãƒ¡ã‚½ãƒƒãƒ‰ åˆ†é¡ ãƒ‡ãƒ¼ã‚¿ã®æ¡ä»¶ assertãƒ¡ã‚½ãƒƒãƒ‰ã®æ¤œè¨¼å†…å®¹ä¾‹ POSTã€PUT æ­£å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã€‚ ãƒ»ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»æ›´æ–°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®IDãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ä»»æ„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ãªã„å ´åˆã€‚ ãƒ»ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»æ›´æ–°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®IDãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ç©ºæ–‡å­—ã‚„nullãŒè¨±å¯ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã€ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ãªã„å ´åˆã€‚ ãƒ»ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»æ›´æ–°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®IDãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ ç•°å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ãªã„å ´åˆã€‚ ãƒ»ControllerãŒ400ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ç©ºæ–‡å­—ã‚„nullãŒè¨±å¯ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã€ç©ºæ–‡å­—ã‚„nullãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã€‚ ãƒ»ControllerãŒ400ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿å‹ãŒèª¤ã£ã¦ã„ã‚‹å ´åˆã€‚ ãƒ»ControllerãŒ400ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ GET æ­£å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã€‚ ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ ç•°å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å‚ç…§ç¦æ­¢ã®ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆèªå¯ã®å¤±æ•—ï¼‰ã€‚ ControllerãŒ403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ DELETE æ­£å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã€‚ ãƒ»ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»å‰Šé™¤ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®IDãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ ç•°å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å‰Šé™¤ç¦æ­¢ã®ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆèªå¯ã®å¤±æ•—ï¼‰ã€‚ ãƒ»ControllerãŒ400ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€‚ èªè¨¼èªå¯ æ­£å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã¦ã€èªè¨¼ã•ã‚Œã¦ã„ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆèªè¨¼ã®æˆåŠŸï¼‰ã€‚ ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ ç•°å¸¸ç³» ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã¦ã€èªè¨¼ã•ã‚Œã¦ã„ãªã„ãƒˆãƒ¼ã‚¯ãƒ³ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆèªè¨¼ã®å¤±æ•—ï¼‰ã€‚ ControllerãŒ401ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒœãƒ‡ã‚£ã«ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ç¦æ­¢ã®ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆèªå¯ã®å¤±æ•—ï¼‰ã€‚ ControllerãŒ403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€‚ ãƒ»æ­£å¸¸ç³»GET ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š request( \"GET\", \"/xxx/yyy/\" ); $response = $client->getResponse(); // 200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè¿”å´ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $this->assertSame(200, $response->getStatusCode()); } } ãƒ»æ­£å¸¸ç³»POST ControllerãŒ200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€æ›´æ–°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®IDãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š request( \"POST\", \"/xxx/yyy/\", [ \"id\" => 1, \"message\" => \"Hello World!\" ], [ \"HTTP_X_API_Token\" => \"Bearer xxxxxx\" ] ); $response = $client->getResponse(); // 200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè¿”å´ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $this->assertSame(200, $response->getStatusCode()); // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹ã€‚ $actual = json_decode($response->getContent(), true); // æ›´æ–°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®IDãŒæ­£ã—ã„ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $this->assertSame(1, $actual[\"id\"]); // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ­£ã—ã„ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $this->assertSame( [ \"ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ã¾ã—ãŸã€‚\" ], $actual[\"message\"] ); } } ãƒ»ç•°å¸¸ç³»POST ControllerãŒ400ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã“ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…é€šã‚Šã§ã‚ã‚‹ã“ã¨ã€ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š request( \"POST\", \"/xxx/yyy/\", [ \"id\" => 1, \"message\" => \"\" ], [ \"HTTP_X_API_Token\" => \"Bearer xxxxxx\" ] ); $response = $client->getResponse(); // 400ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè¿”å´ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $this->assertSame(400, $response->getStatusCode()); // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ãƒ©ãƒ¼ã‚’æŠ½å‡ºã™ã‚‹ã€‚ $actual = json_decode($response->getContent(), true); // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ­£ã—ã„ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ $this->assertSame( [ \"IDã¯å¿…ãšå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\", \"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å¿…ãšå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\" ], $actual[\"errors\"] ); } } ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ ãƒ»Data Provider ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã‚’äº‹å‰ã«ç”¨æ„ã™ã‚‹ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€@testã¨@dataProvider ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒã‚¤ãƒ€åã‚’å®£è¨€ã™ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®è¿”å´å€¤ã¨ã—ã¦é…åˆ—ã‚’è¨­å®šã—ã€é…åˆ—ã®å€¤ã®é †ç•ªã§ã€å¼•æ•°ã«å€¤ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://phpunit.readthedocs.io/ja/latest/writing-tests-for-phpunit.html#writing-tests-for-phpunit-data-providers ï¼Šå®Ÿè£…ä¾‹ï¼Š å‰å‡¦ç†ã¨å¾Œå‡¦ç† ãƒ»setUpãƒ¡ã‚½ãƒƒãƒ‰ å‰å‡¦ç†ã¨ã—ã¦ã€å…¨ã¦ã®ãƒ†ã‚¹ãƒˆé–¢æ•°ã®å‰ã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š DIã‚³ãƒ³ãƒ†ãƒŠã‚’äº‹å‰ã«ç”Ÿæˆã™ã‚‹ã€‚ container[\"option\"]; } } ï¼Šå®Ÿè£…ä¾‹ï¼Š å˜ä½“ãƒ†ã‚¹ãƒˆã§æ¤œè¨¼ã™ã‚‹ã‚¯ãƒ©ã‚¹ãŒå®Ÿéš›ã®å‡¦ç†ã®ä¸­ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã•ã‚Œã‚‹æ™‚ã€ä¾å­˜å¯¾è±¡ã®ã‚¯ãƒ©ã‚¹ã¯ã™ã§ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã‚ã‚‹ã€‚ãã®ãŸã‚ã€ã“ã‚Œã¨åŒã˜ã‚ˆã†ã«ä¾å­˜å¯¾è±¡ã®ã‚¯ãƒ©ã‚¹ã®ãƒ¢ãƒƒã‚¯ã‚’äº‹å‰ã«ç”Ÿæˆã—ã¦ãŠãã€‚ hoge = Phake::mock(Hoge::class); } public function testFoo_Xxx_Xxx() { // å®Ÿéš›ã®å‡¦ç†ã§ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–æ™‚ã«ã€Fooã‚¯ãƒ©ã‚¹ã¯Hogeã‚¯ãƒ©ã‚¹ã«ä¾å­˜ã—ã¦ã„ã‚‹ã€‚ $foo = new Foo($this->hoge) // ä½•ã‚‰ã‹ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ } } ãƒ»tearDownãƒ¡ã‚½ãƒƒãƒ‰ å¾Œå‡¦ç†ã¨ã—ã¦ã€å…¨ã¦ã®ãƒ†ã‚¹ãƒˆé–¢æ•°ã®å¾Œã«ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚ã‚‹ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã«ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹å ´åˆã€å¾Œã®æ¤œè¨¼ã§ã‚‚ãã®ãƒ‡ãƒ¼ã‚¿ãŒèª¤ã£ã¦ä½¿ç”¨ã•ã‚Œã¦ã—ã¾ã‚ãªã„ã‚ˆã†ã«ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã‚’ç ´æ£„ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š container[\"option\"]; } // å…¨ã¦ã®ãƒ†ã‚¹ãƒˆé–¢æ•°ã®å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ protected function tearDown() { // DIã‚³ãƒ³ãƒ†ãƒŠã«nullã‚’æ ¼ç´ã™ã‚‹ã€‚ $this->container = null; } } å‘½åè¦å‰‡ ãƒ»ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å Roy Osheroveæ°ã®å‘½åè¦å‰‡ã«å¾“ã£ã¦ã€ã€ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ãƒ¡ã‚½ãƒƒãƒ‰åã€ã€å…¥åŠ›å€¤ã€ã€æœŸå¾…ã•ã‚Œã‚‹è¿”å´å€¤ã€ã®ä¸‰è¦ç´ ã§ãƒ†ã‚¹ãƒˆé–¢æ•°ã‚’å‘½åã™ã‚‹ã€‚æœŸå¾…ã•ã‚Œã‚‹è¿”å´å€¤ã®å‘½åã§ã€æ­£å¸¸ç³»ãƒ†ã‚¹ãƒˆã€ã‹ã€ç•°å¸¸ç³»ãƒ†ã‚¹ãƒˆã€ã‹ã¨è­˜åˆ¥ã™ã‚‹ã€‚ä¾‹ãˆã°ã€æ­£å¸¸ç³»ã§ã‚ã‚Œã°ã€testFoo_Xxx_ReturnXxxã€ã€ã¾ãŸç•°å¸¸ç³»ã§ã‚ã‚Œã°ã€testFoo_Xxx_ExceptionThrownã€ã‚„ã€testFoo_Xxx_ErrorThrownã€ã¨ã™ã‚‹ã€‚Roy Osheroveæ°ã®å‘½åè¦å‰‡ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://osherove.com/blog/2005/4/3/naming-standards-for-unit-tests.html ãƒ»ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®æ¯”è¼ƒå€¤ ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã§å€¤ã‚’æ¯”è¼ƒã™ã‚‹å ´åˆã€å€¤ã‚’å®šæ•°ã¨ã—ã¦ç®¡ç†ã—ãŸæ–¹ãŒã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://osherove.com/blog/2005/4/3/naming-standards-for-unit-tests.html 02-03. Test Doubleï¼ˆãƒ†ã‚¹ãƒˆãƒ€ãƒ–ãƒ«ï¼‰ ãƒ†ã‚¹ãƒˆãƒ€ãƒ–ãƒ«ã®ç¨®é¡ ãƒ»ãƒ¢ãƒƒã‚¯ãƒ„ãƒ¼ãƒ«ã€ã‚¹ã‚¿ãƒ–ãƒ„ãƒ¼ãƒ« PHPUnitã€Phakeã€Mockeryã€JUnit ãƒ»ãƒ¢ãƒƒã‚¯ ä¸Šå±¤ã‚¯ãƒ©ã‚¹ãŒä¸‹å±¤ã‚¯ãƒ©ã‚¹ã‚’æ­£ã—ãã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã—ãŸã„æ™‚ã«ã€ä¸Šå±¤ã‚¯ãƒ©ã‚¹ä»¥å¤–ã®éƒ¨åˆ†ã®å‡¦ç†ã¯ä¸è¦ã§ã‚ã‚Šã€ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã®å®Ÿä½“ãŒã‚ã‚‹ã‹ã®ã‚ˆã†ã«è¦‹ã›ã‹ã‘ã‚‹ã€‚ã“ã®æ™‚ã€è¦‹ã›ã‹ã‘ã®ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã¨ã—ã¦ç”¨ã„ã‚‹æ“¬ä¼¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã€ãƒ¢ãƒƒã‚¯ã€ã¨ã„ã†ã€‚ã‚¹ã‚¿ãƒ–ã¨ã¯ã€ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ†ã‚¹ãƒˆãŒç•°ãªã‚‹ãŒã€ã©ã¡ã‚‰ã‚‚æ“¬ä¼¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã€‚ã‚¹ã‚¿ãƒ–ã«ã¤ã„ã¦ã¯å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ãƒ¢ãƒƒã‚¯ã«ãŠã„ã¦ã¯ã€ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ãŒå…¨ã¦ãƒ€ãƒŸãƒ¼å®Ÿè£…ã«ç½®ãæ›ãˆã‚‰ã‚Œã¦ã„ã‚‹ã€‚ã‚‚ã—ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã‚’æ­£ã—ã„å›æ•°å®Ÿè¡Œã§ãã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã—ãŸã„å ´åˆã¯ã€ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã®ãƒ¢ãƒƒã‚¯ã‚’å®šç¾©ã—ã€å®Ÿä½“ã®ã‚ã‚‹ä¸Šå±¤ã‚¯ãƒ©ã‚¹ãŒä¸‹å±¤ã‚¯ãƒ©ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã—ãŸæ™‚ã®ã‚³ãƒ¼ãƒ«å›æ•°ã¨æŒ‡å®šå›æ•°ã‚’æ¯”è¼ƒã™ã‚‹ã€‚ãªãŠã€ç”¨èªã®å®šç¾©ã¯ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã”ã¨ã«ã‚„ã‚„ç•°ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚PHPUnitã«ãŠã‘ã‚‹ãƒ¢ãƒƒã‚¯ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://phpunit.readthedocs.io/ja/latest/test-doubles.html#test-doubles-mock-objects ãƒ„ãƒ¼ãƒ«å ãƒ¢ãƒƒã‚¯ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ è£œè¶³ PHPUnit ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€nullã‚’è¿”å´ã™ã‚‹ã€‚ æ³¨æ„ç‚¹ã¨ã—ã¦ã€finalã€privateãªãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒ¢ãƒƒã‚¯åŒ–ã•ã‚Œãšã€å®Ÿä½“ã‚’ãã®ã¾ã¾å¼•ãç¶™ãã€‚ã¾ãŸã€staticãªãƒ¡ã‚½ãƒƒãƒ‰ã¯BadMethodCallExceptionã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ãƒ¢ãƒƒã‚¯ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã€‚ JUnit ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿”å´å€¤ã®å‹ã«åŸºã¥ã„ã¦ã€åˆæœŸå€¤ã‚’è¿”å´ã™ã‚‹ï¼ˆä¾‹ï¼šboolå‹ãªã‚‰falseï¼‰ ãƒ»ã‚¹ã‚¿ãƒ– ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‡¦ç†ã‚’æ¤œè¨¼ã—ãŸã„æ™‚ã«ã€æ¤œè¨¼å¯¾è±¡å¤–ã®ã‚¯ãƒ©ã‚¹ã«ä¾å­˜ã—ã¦ã„ã‚‹éƒ¨åˆ†ã¯ã€å®Ÿä½“ãŒã‚ã‚‹ã‹ã®ã‚ˆã†ã«è¦‹ã›ã‹ã‘ã‚‹ã€‚ã“ã®æ™‚ã€è¦‹ã›ã‹ã‘ã®ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã¨ã—ã¦ç”¨ã„ã‚‹æ“¬ä¼¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã€ã‚¹ã‚¿ãƒ–ã€ã¨ã„ã†ã€‚ãƒ¢ãƒƒã‚¯ã¨ã¯ã€ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ†ã‚¹ãƒˆãŒç•°ãªã‚‹ãŒã€ã©ã¡ã‚‰ã‚‚æ“¬ä¼¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã€‚ãƒ¢ãƒƒã‚¯ã¨åŒæ§˜ã«ã‚¹ã‚¿ãƒ–ã«ãŠã„ã¦ã‚‚ã€ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ãŒå…¨ã¦ãƒ€ãƒŸãƒ¼å®Ÿè£…ã«ç½®ãæ›ãˆã‚‰ã‚Œã¦ã„ã‚‹ã€‚ã‚¹ã‚¿ãƒ–ã«ã¯ã€æ­£ã—ã„å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«å¼•æ•°ã¨è¿”å´å€¤ã‚’æŒã¤ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã€ãã®ä»–ã®å®Ÿä½“ã®ã‚ã‚‹å‡¦ç†ãŒæ­£ã—ãå®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ã“ã‚Œã‚‰ã«ã‚ˆã‚Šã€æ¤œè¨¼å¯¾è±¡ã®å‡¦ç†ã®ã¿ãŒå®Ÿä½“ã§ã‚ã£ã¦ã‚‚ã€ä¸€é€£ã®å‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ãªãŠã€ç”¨èªã®å®šç¾©ã¯ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã”ã¨ã«ã‚„ã‚„ç•°ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚PHPUnitã«ãŠã‘ã‚‹ã‚¹ã‚¿ãƒ–ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://phpunit.readthedocs.io/ja/latest/test-doubles.html#test-doubles-stubs PHPUnit ãƒ»createMockãƒ¡ã‚½ãƒƒãƒ‰ ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã‚’å…ƒã«ã€ãƒ¢ãƒƒã‚¯ã¾ãŸã¯ã‚¹ã‚¿ãƒ–ã¨ã—ã¦ç”¨ã„ã‚‹æ“¬ä¼¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚ä»¥é™ã®å‡¦ç†ã§ã®ç”¨é€”ã«ã‚ˆã£ã¦ã€å‘¼ã³åãŒç•°ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ã¡ãªã¿ã«ã€PHPUnitã®å ´åˆã€ãƒ¢ãƒƒã‚¯ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯nullã‚’è¿”å´ã™ã‚‹ã€‚ createMock(Foo::class); // null $foo = $mock->find(1) } } ãƒ»methodãƒ¡ã‚½ãƒƒãƒ‰ ãƒ¢ãƒƒã‚¯ã¾ãŸã¯ã‚¹ã‚¿ãƒ–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ã€å‡¦ç†ã®å†…å®¹ã‚’å®šç¾©ã™ã‚‹ã€‚ç‰¹å®šã®å¤‰æ•°ãŒæ¸¡ã•ã‚ŒãŸæ™‚ã«ã€ç‰¹å®šã®å€¤ã‚’è¿”å´ã•ã›ã‚‰ã‚Œã‚‹ã€‚ createMock(Foo::class); // ã‚¹ã‚¿ãƒ–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«å‡¦ç†å†…å®¹ã‚’å®šç¾©ã™ã‚‹ã€‚ $stub->method(\"find\") ->with(1) ->willReturn([]); // []ï¼ˆç©ºé…åˆ—ï¼‰ $result = $stub->find(1) } } Phake ãƒ»Phakeã¨ã¯ ãƒ¢ãƒƒã‚¯ã¨ã‚¹ã‚¿ãƒ–ã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚ å‚è€ƒï¼šhttps://github.com/mlively/Phake#phake ãƒ»mockãƒ¡ã‚½ãƒƒãƒ‰ ã‚¯ãƒ©ã‚¹ã®åå‰ç©ºé–“ã‚’å…ƒã«ã€ãƒ¢ãƒƒã‚¯ã¾ãŸã¯ã‚¹ã‚¿ãƒ–ã¨ã—ã¦ç”¨ã„ã‚‹æ“¬ä¼¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚ä»¥é™ã®å‡¦ç†ã§ã®ç”¨é€”ã«ã‚ˆã£ã¦ã€å‘¼ã³åãŒç•°ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ ãƒ»whenãƒ¡ã‚½ãƒƒãƒ‰ ãƒ¢ãƒƒã‚¯ã¾ãŸã¯ã‚¹ã‚¿ãƒ–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ã€å‡¦ç†ã®å†…å®¹ã‚’å®šç¾©ã™ã‚‹ã€‚ã¾ãŸã€ç‰¹å®šã®å¤‰æ•°ãŒæ¸¡ã•ã‚ŒãŸæ™‚ã«ã€ç‰¹å®šã®å€¤ã‚’è¿”å´ã•ã›ã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ¢ãƒƒã‚¯ã®findãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€1ãŒæ¸¡ã•ã‚ŒãŸæ™‚ã«ã€ç©ºé…åˆ—ã‚’è¿”å´ã™ã‚‹ã€‚ find(1) ->thenReturn([]); ãƒ»verifyãƒ¡ã‚½ãƒƒãƒ‰ ä¸Šå±¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä¸‹å±¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ãƒ¢ãƒƒã‚¯ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒnå›å®Ÿè¡Œã§ããŸã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š find($fooId) ->thenReturn(new User(1)); // ä¸Šå±¤ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦ã€ä¸‹å±¤ã‚¯ãƒ©ã‚¹ã®ãƒ¢ãƒƒã‚¯ã®ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡Œã† $foo = new Foo($mockFooRepository); // ä¸Šå±¤ã‚¯ãƒ©ã‚¹ã®å†…éƒ¨ã«ã‚ã‚‹ä¸‹å±¤ãƒ¢ãƒƒã‚¯ã®findãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ $foo->getUser($fooId) // ä¸Šå±¤ã®ã‚¯ãƒ©ã‚¹ãŒã€ä¸‹å±¤ãƒ¢ãƒƒã‚¯ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã—ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ãŸã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ Phake::verify($mockFooRepository, Phake::times(1))->find($fooId); } } 03. ãƒ–ãƒ©ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ/ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆ ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆ ãƒ»ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã¨ã¯ ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã¨çµ„ã¿åˆã‚ã›ã¦ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’æ§‹æˆã™ã‚‹ã€‚å®Ÿè£…å†…å®¹ã¯æ°—ã«ã›ãšã€å…¥åŠ›ã«å¯¾ã—ã¦ã€é©åˆ‡ãªå‡ºåŠ›ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨ãƒ›ãƒ¯ã‚¤ãƒˆ/ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã®é–¢ä¿‚æ€§ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®æ›¸ç±ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/477415377X/ ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆ ãƒ»ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã¨ã¯ ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã¨çµ„ã¿åˆã‚ã›ã¦ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’æ§‹æˆã™ã‚‹ã€‚å®Ÿè£…å†…å®¹ãŒé©åˆ‡ã‹ã‚’ç¢ºèªã—ãªãŒã‚‰ã€å…¥åŠ›ã«å¯¾ã—ã¦ã€é©åˆ‡ãªå‡ºåŠ›ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ç¶²ç¾…æ¡ä»¶ãŒã„ãã¤ã‹ã‚ã‚Šã€æ±‚ã‚ã‚‰ã‚Œã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢å“è³ªã«å¿œã˜ãŸã‚‚ã®ã‚’æ¡ç”¨ã™ã‚‹ã€‚ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨ãƒ›ãƒ¯ã‚¤ãƒˆ/ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã®é–¢ä¿‚æ€§ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®æ›¸ç±ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/477415377X/ ï¼Šå®Ÿè£…ä¾‹ï¼Š if (A = 1 && B = 1) { ã€€return X; } ãƒ»Cï¼ï¼šStatement Coverageï¼ˆå‘½ä»¤ç¶²ç¾…ï¼‰ å…¨ã¦ã®å‘½ä»¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š Aã¨Bã¯ã€ã€1ã€ã¾ãŸã¯ã€0ã€ã«ãªã‚Šå¾—ã‚‹ã¨ã™ã‚‹ã€‚ æ¡ä»¶ å‡¦ç†å®Ÿè¡Œã®æœ‰ç„¡ A = 1ã€B = 1 return X ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã€‚ ãƒ»Cï¼‘ï¼šDecision Coverageï¼ˆåˆ¤å®šæ¡ä»¶ç¶²ç¾…ï¼åˆ†å²ç¶²ç¾…ï¼‰ å…¨ã¦ã®åˆ¤å®šãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š Aã¨Bã¯ã€ã€1ã€ã¾ãŸã¯ã€0ã€ã«ãªã‚Šå¾—ã‚‹ã¨ã™ã‚‹ã€‚ æ¡ä»¶ å‡¦ç†å®Ÿè¡Œã®æœ‰ç„¡ A = 1ã€B = 1 return X ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã€‚ A = 1ã€B = 0 return X ãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã€‚ ãƒ»Cï¼’ï¼šCondition Coverageï¼ˆæ¡ä»¶ç¶²ç¾…ï¼‰ å„æ¡ä»¶ãŒã€å–ã‚Šå¾—ã‚‹å…¨ã¦ã®å€¤ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š Aã¨Bã¯ã€ã€1ã€ã¾ãŸã¯ã€0ã€ã«ãªã‚Šå¾—ã‚‹ã¨ã™ã‚‹ã€‚ æ¡ä»¶ å‡¦ç†å®Ÿè¡Œã®æœ‰ç„¡ A = 1ã€B = 0 return X ãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã€‚ A = 0ã€B = 1 return X ãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã€‚ ã¾ãŸã¯ã€æ¬¡ã®çµ„ã¿åˆã‚ã›ã§ã‚‚ã‚ˆã„ã€‚ æ¡ä»¶ å‡¦ç†å®Ÿè¡Œã®æœ‰ç„¡ A = 1ã€B = 1 return X ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã€‚ A = 0ã€B = 0 return X ãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã€‚ ãƒ»MCCï¼šMultiple Condition Coverageï¼ˆè¤‡æ•°æ¡ä»¶ç¶²ç¾…ï¼‰ å„æ¡ä»¶ãŒã€å–ã‚Šå¾—ã‚‹å…¨ã¦ã®å€¤ã§ã€ã‹ã¤å…¨ã¦ã®çµ„ã¿åˆã‚ã›ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ä¸€èˆ¬çš„ã«ã€è¤‡æ•°æ¡ä»¶ç¶²ç¾…ã‚’æ¡ç”¨ã™ã‚Œã°ã€æœ€ä½é™ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢å“è³ªã‚’æ‹…ä¿ã§ãã¦ã„ã‚‹ã¨è¨€ãˆã‚‹ã€‚ ï¼Šä¾‹ï¼Š Aã¨Bã¯ã€ã€1ã€ã¾ãŸã¯ã€0ã€ã«ãªã‚Šå¾—ã‚‹ã¨ã™ã‚‹ã€‚ æ¡ä»¶ å‡¦ç†å®Ÿè¡Œã®æœ‰ç„¡ A = 1ã€B = 1 return X ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã€‚ A = 1ã€B = 0 return X ãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã€‚ A = 0ã€B = 1 return X ãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã€‚ A = 0ã€B = 0 return X ãŒå®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã€‚ ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã®æŒ‡æ¨™ ãƒ»ç¶²ç¾…ç‡ æ¡ç”¨ã—ãŸç¶²ç¾…ã§è€ƒãˆã‚‰ã‚Œã‚‹å…¨ã¦ã®æ¡ä»¶ã®ã†ã¡ã€ãƒ†ã‚¹ãƒˆã§æ¤œè¨¼ã§ãã¦ã„ã‚‹å‰²åˆã®ã“ã¨ã€‚ ç¶²ç¾…ç‡ã¯ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å˜ä½ã¨ã—ã¦è§£æã•ã‚Œã€ã“ã‚Œã¯è¨€èªåˆ¥ã«ç•°ãªã‚‹ã€‚Goã§å‘½ä»¤ç¶²ç¾…ã®ç¶²ç¾…ç‡ã‚’æ¤œå‡ºã™ã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_procedural_language_go_command_and_configuration.html PHPUnitã§ç¶²ç¾…ç‡ã‚’è§£æã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://phpunit.readthedocs.io/ja/latest/code-coverage-analysis.html ãƒ»å¾ªç’°çš„è¤‡é›‘åº¦ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®è¤‡é›‘ã•ã®ç¨‹åº¦ã®ã“ã¨ã€‚ãŠãŠã‚ˆãåˆ¤å®šæ¡ä»¶ç¶²ç¾…ã®çµŒè·¯æ•°ã®ç¨‹åº¦ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://jp.mathworks.com/discovery/cyclomatic-complexity.html https://szk-takanori.hatenablog.com/entry/20111219/p1 å¾ªç’°çš„è¤‡é›‘åº¦ è¤‡é›‘ã•ã®çŠ¶æ…‹ ãƒã‚°æ··å…¥ç‡ 10ä»¥ä¸‹ éå¸¸ã«è‰¯ã„ 25% 30ä»¥ä¸Š æ§‹é€ çš„ãªãƒªã‚¹ã‚¯ã‚ã‚Š 40% 50ä»¥ä¸Š ãƒ†ã‚¹ãƒˆä¸å¯èƒ½ 70% 75ä»¥ä¸Š å¤‰æ›´ã«ã‚ˆã£ã¦èª¤ä¿®æ­£ãŒç”Ÿã˜ã‚‹ã€‚ 98% 04. PHPStanã«ã‚ˆã‚‹é™çš„è§£æ ã‚³ãƒãƒ³ãƒ‰ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã¨ã—ã¦ã€é™çš„è§£æã‚’è¡Œã†ã€‚ $ vendor/bin/phpstan analyse phpstan.neonãƒ•ã‚¡ã‚¤ãƒ« ãƒ»phpstan.neonãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ PHPStanã®è¨­å®šã‚’è¡Œã†ã€‚ ãƒ»includes includes: - ./vendor/nunomaduro/larastan/extension.neon ãƒ»parameters é™çš„è§£æã®è¨­å®šã‚’è¡Œã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š parameters: # è§£æå¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª paths: - src # è§£æã®å³æ ¼ã•ï¼ˆæœ€å¤§ãƒ¬ãƒ™ãƒ«ã¯ï¼˜ï¼‰ã€‚å„ãƒ¬ãƒ™ãƒ«ã®è§£æé …ç›®ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ # https://phpstan.org/user-guide/rule-levels level: 5 # ç™ºç”Ÿã‚’ç„¡è¦–ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ignoreErrors: - '#Unsafe usage of new static#' # è§£æå¯¾è±¡ã¨ã—ã¦é™¤å¤–ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª excludes_analyse: - ./src/Foo/* checkMissingIterableValueType: false inferPrivatePropertyTypeFromConstructor: true "},"public/software/software_application_object_oriented_language_php_testing_based_on_test_specification.html":{"url":"public/software/software_application_object_oriented_language_php_testing_based_on_test_specification.html","title":"ğŸ“– ï¸ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ","keywords":"","body":"ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ã«åŸºã¥ãçµåˆãƒ†ã‚¹ãƒˆ çµåˆãƒ†ã‚¹ãƒˆã¨ã¯ å˜ä½“ãƒ†ã‚¹ãƒˆã®æ¬¡ã«è¡Œã†ãƒ†ã‚¹ãƒˆã€‚è¤‡æ•°ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç¹‹ã’ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ãŒé©åˆ‡ã«å‹•ã„ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã€‚ çµåˆãƒ†ã‚¹ãƒˆã®æ–¹å‘ ãƒ»ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ†ã‚¹ãƒˆ ä¸Šå±¤ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ä¸‹å±¤ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å‘ã‹ã£ã¦ã€çµåˆãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã€‚ä¸‹å±¤ã«ã¯ãƒ†ã‚¹ãƒˆãƒ€ãƒ–ãƒ«ã®ã‚¹ã‚¿ãƒ–ã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ»ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ ä¸‹å±¤ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ä¸Šå±¤ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å‘ã‹ã£ã¦ã€çµåˆãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã€‚ä¸Šå±¤ã«ã¯ãƒ†ã‚¹ãƒˆãƒ€ãƒ–ãƒ«ã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚ Scenarioãƒ†ã‚¹ãƒˆ å®Ÿéš›ã®æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã‚’å‚è€ƒã«ã—ã€ãƒ¦ãƒ¼ã‚¶ãŒæ“ä½œã™ã‚‹é †ã«ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã€‚ 02. ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ã«åŸºã¥ãã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ ãƒ»ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆã¨ã¯ çµåˆãƒ†ã‚¹ãƒˆã®æ¬¡ã«è¡Œã†ãƒ†ã‚¹ãƒˆã€‚ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢å…¨ä½“ãŒé©åˆ‡ã«å‹•ã„ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚User Acceptanceãƒ†ã‚¹ãƒˆã€ã¾ãŸç·åˆãƒ†ã‚¹ãƒˆã¨ã‚‚ã„ã†ã€‚ ãƒ»ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹ ä»¥ä¸‹ã®æ“ä½œã‚’å¯¾è±¡ã¨ã—ã¦æ¤œè¨¼ã™ã‚‹ã¨ã‚ˆã„ã€‚ å¤§åˆ†é¡ ä¸­åˆ†é¡ æ¤œè¨¼å¯¾è±¡ã®æ“ä½œ æ©Ÿèƒ½ æ­£å¸¸ç³» åŸºæœ¬æ“ä½œï¼ˆç™»éŒ²ã€å‚ç…§ã€æ›´æ–°ã€å‰Šé™¤ï¼‰ã€ç”»é¢é·ç§»ã€çŠ¶æ…‹é·ç§»ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ãªã© ç•°å¸¸ç³» åŸºæœ¬æ“ä½œï¼ˆç™»éŒ²ã€å‚ç…§ã€æ›´æ–°ã€å‰Šé™¤ï¼‰ã€ãªã© çµ„ã¿åˆã‚ã› åŒæ™‚æ“ä½œã€å‰²ã‚Šè¾¼ã¿æ“ä½œã€æ’ä»–åˆ¶å¾¡ã«é–¢ã‚ã‚‹æ“ä½œã€ãªã© æ¥­å‹™ã‚·ãƒŠãƒªã‚ª ã‚·ãƒŠãƒªã‚ªã«æ²¿ã£ãŸãƒ¦ãƒ¼ã‚¶ã«ã‚ˆã‚‹ä¸€é€£ã®æ“ä½œ é–‹ç™ºè€…ã‚·ãƒŠãƒªã‚ª ã‚·ãƒŠãƒªã‚ªã«æ²¿ã£ãŸé–‹ç™ºè€…ã«ã‚ˆã‚‹ä¸€é€£ã®æ“ä½œï¼ˆæ‰‹å‹•ã‚³ãƒãƒ³ãƒ‰ãªã©ï¼‰ å¤–éƒ¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é€£æº å¤–éƒ¨ã®APIã¨ã®é€£æºå‡¦ç†ã«é–¢ã‚ã‚‹æ“ä½œ éæ©Ÿèƒ½ è² è·è€æ€§ã‚„æ€§èƒ½ å„ç¨®è² è·ãƒ†ã‚¹ãƒˆï¼ˆæ€§èƒ½ãƒ†ã‚¹ãƒˆã€é™ç•Œãƒ†ã‚¹ãƒˆã€è€ä¹…ãƒ†ã‚¹ãƒˆï¼‰ æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ æ©Ÿèƒ½è¦ä»¶ã‚’æº€ãŸã›ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚PHPUnitã§ã®æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã¨ã¯æ„å‘³åˆã„ãŒç•°ãªã‚‹ã®ã§æ³¨æ„ã€‚ è² è·ãƒ†ã‚¹ãƒˆ ãƒ»è² è·ãƒ†ã‚¹ãƒˆã¨ã¯ å®Ÿéš›ã®é‹ç”¨æ™‚ã«ã€æƒ³å®šã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã«è€ãˆã‚‰ã‚Œã‚‹ã‹ã€ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ã¾ãŸã€ãƒ†ã‚¹ãƒˆçµæœã‹ã‚‰ã€é‹ç”¨æ™‚ã®ç›£è¦–ã§å‚è€ƒã«ã™ã‚‹ãŸã‚ã®ã€å®‰å…¨ç¯„å›²ï¼ˆé’ä¿¡å·ï¼‰ã€å±é™ºç¯„å›²ï¼ˆé»„è‰²ä¿¡å·ï¼‰ã€é™ç•Œå€¤ï¼ˆèµ¤ä¿¡å·ï¼‰ã€ã‚’å°ãå¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.oracle.com/jp/technical-resources/article/ats-tech/tech/useful-class-8.html ãƒ»è² è·ãƒ†ã‚¹ãƒˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ é …ç›® èª¬æ˜ ã‚¹ãƒ¬ãƒƒãƒ‰æ•° ãƒ¦ãƒ¼ã‚¶æ•°ã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ«ãƒ¼ãƒ—æ•° ãƒ¦ãƒ¼ã‚¶å½“ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡æ•°ã«ç›¸å½“ã™ã‚‹ã€‚ RampUpç§’ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹æœŸé–“ã«ç›¸å½“ã™ã‚‹ã€‚é•·ãã—éãã™ã‚‹ã¨ã€å…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚’é€ä¿¡ã™ã‚‹ã¾ã§ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã‚ˆã†ã«ãªã‚‹ãŸã‚ã€è² è·ãŒå°ã•ããªã‚‹ã€‚ ãƒ»æ€§èƒ½ãƒ†ã‚¹ãƒˆ ä¸€å®šæ™‚é–“å†…ã«ã€ãƒ¦ãƒ¼ã‚¶ãŒä¸€é€£ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆä¾‹ï¼šãƒ­ã‚°ã‚¤ãƒ³ã€é–²è¦§ã€ç™»éŒ²ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆï¼‰ã‚’è¡Œã£ãŸæ™‚ã«ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã«ã©ã®ã‚ˆã†ãªå¤‰åŒ–ãŒã‚ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚å…·ä½“çš„ã«ã¯ãƒ†ã‚¹ãƒˆæ™‚ã«ã€ã‚¢ã‚¯ã‚»ã‚¹æ•°ã‚’æ®µéšçš„ã«å¢—åŠ ã•ã›ã¦ã€ãã®çµæœã‚’ã‚°ãƒ©ãƒ•åŒ–ã™ã‚‹ã€‚ã‚°ãƒ©ãƒ•çµæœã‚’å…ƒã«ã€æƒ³å®šã•ã‚Œã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒç¾åœ¨ã®æ€§èƒ½ã«ã©ã®ç¨‹åº¦ã®è² è·ã‚’ã‹ã‘ã‚‹ã®ã‹ã‚’ç¢ºèªã—ã€ã¾ãŸæ€§èƒ½ã®è² è·ãŒæœ€å¤§ã«ãªã‚‹å€¤ã‚’å°ãã€‚ã“ã‚Œã‚‰ã‚’é‹ç”¨æ™‚ã®ç›£è¦–ã®å‚è€ƒå€¤ã«ã™ã‚‹ã€‚ ãƒ»é™ç•Œãƒ†ã‚¹ãƒˆ æ€§èƒ½ã®é™ç•Œå€¤ã«é”ã™ã‚‹ã»ã©ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒé€ä¿¡ã•ã‚ŒãŸæ™‚ã«ã€éšœå®³å›é¿å‡¦ç†ï¼ˆä¾‹ï¼šã‚¢ã‚¯ã‚»ã‚¹ãŒè¾¼ã¿åˆã£ã¦ã„ã‚‹æ—¨ã®ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºï¼‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚å…·ä½“çš„ã«ã¯ãƒ†ã‚¹ãƒˆæ™‚ã«ã€éšœå®³å›é¿å‡¦ç†ä»¥å¤–ã®å‹•ä½œï¼ˆã‚¨ãƒ©ãƒ¼ã€é–“é•ã£ãŸå‡¦ç†ã€éšœå®³å›å¾©å¾Œã«ã‚‚å¾©æ—§ã§ããªã„ã€ã‚·ã‚¹ãƒ†ãƒ ãƒ€ã‚¦ãƒ³ï¼‰ãŒèµ·ã“ã‚‰ãªã„ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ ãƒ»è€ä¹…ãƒ†ã‚¹ãƒˆ é•·æ™‚é–“ã®å¤§é‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚ŒãŸæ™‚ã«ã€çŸ­æ™‚é–“ã§ã¯æ¤œå‡ºã§ããªã„ã©ã®ã‚ˆã†ãªå•é¡ŒãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚å…·ä½“çš„ã«ã¯ãƒ†ã‚¹ãƒˆæ™‚ã«ã€é•·æ™‚é–“ã®å¤§é‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã•ã›ã€å•é¡Œï¼ˆä¾‹ï¼šå¾®é‡ã®ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãŒè“„ç©ã—ã¦ãƒ¡ãƒ¢ãƒªã‚’åœ§è¿«ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ãŒè“„ç©ã—ã¦ãƒ¡ãƒ¢ãƒªã‚„ãƒ‡ã‚£ã‚¹ã‚¯ã‚’åœ§è¿«ã€ãƒ­ã‚°ãŒè“„ç©ã—ã¦ãƒ‡ã‚£ã‚¹ã‚¯ã‚’åœ§è¿«ã€ãƒ’ãƒ¼ãƒ—ã‚„ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ã‚°ãŒCPUã‚„I/Oå‡¦ç†ã‚’åœ§è¿«ï¼‰ ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆå†ç¾ãƒ†ã‚¹ãƒˆï¼‰ ãƒ»ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆã¨ã¯ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒé€šå¸¸ï¼ãƒ”ãƒ¼ã‚¯ï¼éšœå®³æ™‚ã®è² è·ã‚’å†ç¾ã—ã€ã“ã‚Œã«è€ãˆã‚‰ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://stackify.com/what-is-load-testing/ ãƒ»ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹ é–‹å§‹ã‹ã‚‰ãƒ”ãƒ¼ã‚¯ã¾ã§ã«ã€æ¬¡ã®ã‚ˆã†ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒå¢—ã—ã€éšœå®³ãŒèµ·ã“ã£ãŸã¨ã™ã‚‹ã€‚ãã®å¾Œã€ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ãŸã€‚ éšœå®³ç™ºç”ŸæœŸé–“ åˆè¨ˆé–²è¦§ãƒšãƒ¼ã‚¸æ•°(PVæ•°/min) å¹³å‡ãƒ¦ãƒ¼ã‚¶æ•°(UAæ•°/min) ãƒ¦ãƒ¼ã‚¶å½“ãŸã‚Šé–²è¦§ãƒšãƒ¼ã‚¸æ•°(PVæ•°/UAæ•°) 13:00 ~ 13:05ï¼ˆé–‹å§‹ï¼‰ 300 100 3 13:05 ~ 13:10 600 200 3 13:10 ~ 13:15ï¼ˆãƒ”ãƒ¼ã‚¯ï¼‰ 900 300 3 ãƒ©ãƒ³ã‚­ãƒ³ã‚° URL å‰²åˆ 1 /aaa/bbb/* 40 % 2 /ccc/ddd/* 30 % 3 /eee/fff/* 20 % 4 /ggg/hhh/* 10 % ï¼Šãƒ†ã‚¹ãƒˆä¾‹ï¼Š ãƒ¦ãƒ¼ã‚¶å½“ãŸã‚Šã®é–²è¦§ãƒšãƒ¼ã‚¸æ•°ã¯ãƒ«ãƒ¼ãƒ—æ•°ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã®ã§ã€ãƒ«ãƒ¼ãƒ—æ•°ã¯ã€3å›ã€ã«ãªã‚‹ã€‚éšœå®³ç™ºç”ŸæœŸé–“ã®é–²è¦§ãƒšãƒ¼ã‚¸æ•°ã¯ã‚¹ãƒ¬ãƒƒãƒ‰æ•°ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã®ã§ã€ã‚¹ãƒ¬ãƒƒãƒ‰æ•°ã¯ã€1800å€‹ï¼ˆ300 + 600 + 900ï¼‰ã€ã«ãªã‚‹ã€‚éšœå®³ç™ºç”ŸæœŸé–“ã¯ã€Ramp-Upã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã®ã§ã€Ramp-UpæœŸé–“ã¯ã€900ç§’ï¼ˆ15åˆ†é–“ï¼‰ã€ ã‚¹ãƒ¬ãƒƒãƒ‰æ•°ï¼ˆå€‹ï¼‰ ãƒ«ãƒ¼ãƒ—æ•°ï¼ˆå›ï¼‰ Ramp-UpæœŸé–“(sec) 1800 3 900 03. ãã®ä»–ã®ãƒ†ã‚¹ãƒˆ Regressionãƒ†ã‚¹ãƒˆï¼ˆå›å¸°ãƒ†ã‚¹ãƒˆï¼‰ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå¾Œã€ä»–ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«æ‚ªå½±éŸ¿ã‚’ä¸ãˆã¦ã„ãªã„ã‹ã‚’æ¤œè¨¼ã€‚ 04. ã‚°ãƒ©ãƒ•ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®å¯è¦–åŒ– ãƒã‚°ç®¡ç†å›³ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ™‚ã€æ®‹å­˜ãƒ†ã‚¹ãƒˆæ•°ã¨ä¸è‰¯æ‘˜å‡ºæ•°ï¼ˆãƒã‚°ç™ºè¦‹æ•°ï¼‰ã‚’ç¸¦è»¸ã«ã¨ã‚Šã€æ™‚é–“ã‚’æ¨ªè»¸ã«ã¨ã‚‹ã“ã¨ã§ã€ãƒã‚°ç®¡ç†å›³ã‚’ä½œæˆã™ã‚‹ã€‚ãã‚Œãã‚Œã®æ›²ç·šã®çŠ¶æ…‹ã‹ã‚‰ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é€²æ—çŠ¶æ³ã‚’èª­ã¿å–ã‚‰ã‚Œã‚‹ã€‚ ä¸è‰¯æ‘˜å‡ºå®Ÿç¸¾ç·šï¼ˆä¿¡é ¼åº¦æˆé•·æ›²ç·šï¼‰ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å“è³ªã®çŠ¶æ…‹ã‚’è¡¨ã—ã€Så­—å‹ã§ãªã„ã‚‚ã®ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å“è³ªãŒè‰¯ããªã„ã“ã¨ã‚’è¡¨ã™ã€‚ "},"public/software/software_application_object_oriented_language_php_debug.html":{"url":"public/software/software_application_object_oriented_language_php_debug.html","title":"ğŸ“– ï¸ãƒ‡ãƒãƒƒã‚°","keywords":"","body":"ãƒ‡ãƒãƒƒã‚°ã®è±†çŸ¥è­˜ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ‡ãƒãƒƒã‚°ã®Tips var_dumpãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’ç¢ºèª ãƒ» åŸºæœ¬å½¢ ãƒ–ãƒ©ã‚¦ã‚¶ã®ã€ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ«ï¼Networkï¼å‡ºåŠ›å…ˆãƒšãƒ¼ã‚¸ã®Previewã‚¿ãƒ–ã¾ãŸã¯Responseã‚¿ãƒ–ã€ã§ç¢ºèªã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»ä¾‹å¤–å‡¦ç†ã¨ã®çµ„ã¿åˆã‚ã› ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ«ï¼Networkï¼å‡ºåŠ›å…ˆãƒšãƒ¼ã‚¸ã®Previewã‚¿ãƒ–ã§ä¾‹å¤–ã‚¨ãƒ©ãƒ¼ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ç”»é¢ã®ä¸Šéƒ¨ã§ã€var_dump($var)ã®çµæœã‚’ç¢ºèªã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š var_dumpãƒ¡ã‚½ãƒƒãƒ‰ã®çµæœãŒè¡¨ç¤ºã•ã‚Œãªã„ ãƒ»å‡¦ç†ã®é€šéåœ°ç‚¹ã®ç‰¹å®š å‡¦ç†ãŒvar_dumpãƒ¡ã‚½ãƒƒãƒ‰ã‚’é€šéã—ã¦ã„ãªã„ã“ã¨ãŒåŸå› ã€‚ä»»æ„ã®å ´æ‰€ã«var_dump(\"æ–‡å­—åˆ—\")ã‚’è¨˜è¿°ã—ã€ã©ã“ã«è¨˜è¿°ã—ãŸæ™‚ã«æ–‡å­—åˆ—ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 500ã‚¨ãƒ©ãƒ¼ã®ä½ç½®ã‚’ç‰¹å®šã§ããªã„ ãƒ»ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ã®ç‰¹å®š ä»»æ„ã®å ´æ‰€ã«exitãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¨˜è¿°ã—ã€ã©ã“ã«è¨˜è¿°ã—ãŸæ™‚ã«ã€500ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‰ãšã«å‡¦ç†ãŒçµ‚äº†ã™ã‚‹ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ç„¡ã—ï¼‰ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ»æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒç•°ãªã£ã¦ã„ã‚‹ã“ã¨ãŒåŸå› ã€‚ä»¥ä¸‹ã‚’ã€var_dumpãƒ¡ã‚½ãƒƒãƒ‰ã‚ˆã‚Šã‚‚ä¸Šæµã«è¿½åŠ ã™ã‚‹ã€‚ 02. Xdebugã«ã‚ˆã‚‹ãƒ‡ãƒãƒƒã‚° å°å…¥æ–¹æ³• 1. ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã€‚ $ sudo pecl install xdebug-2.2.7 2. Xdebugã®è¨­å®š Xdebugã®ã‚ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒã‹ã‚‰è¦‹ã¦ã€PhpStromãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚µãƒ¼ãƒã‚’æ¥ç¶šå…ˆã¨è¦‹ãªã™ã€‚ zend_extension=/usr/lib64/php/modules/xdebug.so xdebug.default_enable=1 # ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ãƒãƒƒã‚°ã®æœ‰åŠ¹åŒ–ã€‚ xdebug.remote_enable=1 # DBGãƒ—ãƒ­ãƒˆã‚³ãƒ« xdebug.remote_handler=dbgp # ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã€‚ xdebug.remote_host=10.0.2.2 # ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã®é–‹æ”¾ãƒãƒ¼ãƒˆã€‚ xdebug.remote_port=9001 # å¸¸ã«ãƒ‡ãƒãƒƒã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã€‚ xdebug.remote_autostart=1 # DBGpãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã«æ¸¡ã™IDEã‚­ãƒ¼ã‚’è¨­å®šã€‚ xdebug.idekey=PhpStorm 3. ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒã‚’å†èµ·å‹• $ sudo service httpd restart 4. PhpStormãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚µãƒ¼ãƒã®è¨­å®š ãƒ‡ãƒãƒƒã‚°ã«ãŠã‘ã‚‹é€šä¿¡ã®ä»•çµ„ã¿ 1. ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã®æ§‹ç¯‰ ã‚¨ãƒ‡ã‚£ã‚¿ã¯ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã—ã€ãƒãƒ¼ãƒˆ9000ã‚’é–‹æ”¾ã™ã‚‹ã€‚ 2. ã‚¨ãƒ‡ã‚£ã‚¿ã‹ã‚‰ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆXdebugï¼‰ã¯ãƒãƒ¼ãƒˆ80ã‚’é–‹æ”¾ã™ã‚‹ã€‚ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã¯ã“ã‚Œã«å¯¾ã—ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€ä¿¡ã™ã‚‹ã€‚ 3. ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã‹ã‚‰ã‚µãƒ¼ãƒã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆXdebugï¼‰ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã€ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã®ãƒãƒ¼ãƒˆ9000ã«å¯¾ã—ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ 4. Breakpointã®è¨­å®š ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã¯ã€ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã«å¯¾ã—ã¦ã€Breakpointã‚’è¨­å®šã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ 5. DBGãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼šDebuggerãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«ã‚ˆã‚‹ç›¸äº’é€šä¿¡ã®ç¢ºç«‹ DBGãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã€ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã¨ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã®é–“ã®ç›¸äº’é€šä¿¡ã‚’ç¢ºç«‹ã™ã‚‹ã€‚ 6. ç›¸äº’é€šä¿¡ã®å®Ÿè¡Œ ã‚¨ãƒ‡ã‚£ã‚¿ã¯ã€ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã«å¯¾ã—ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã™ã‚‹ã€‚ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€Breakpointã¾ã§ã®å„å¤‰æ•°ã®ä¸­èº«ã‚’è§£æã—ã€ã‚¨ãƒ‡ã‚£ã‚¿ã‚µãƒ¼ãƒã«è¿”ä¿¡ã™ã‚‹ã€‚ "},"public/software/software_application_object_oriented_language_js_prototype_based.html":{"url":"public/software/software_application_object_oriented_language_js_prototype_based.html","title":"ğŸ“– ï¸ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—","keywords":"","body":"ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ— ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. æ¨™æº–ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ æ¨™æº–ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯ JavaScriptã®å®Ÿè¡Œç’°å¢ƒã«ã‚ã‚‰ã‹ã˜ã‚çµ„ã¿è¾¼ã¾ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚ Object ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚ä»–ã®å…¨ã¦ã®æ¨™æº–ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç¶™æ‰¿å…ƒã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€æ¨™æº–ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ObjectãŒæŒã¤ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ãˆã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // newæ¼”ç®—å­ã‚’ä½¿ã£ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ const obj = new Object(); Function ï¼Šå®Ÿè£…ä¾‹ï¼Š Array ãƒ»Array.prototype.entries() é…åˆ—ã‹ã‚‰keyã¨valueã‚’å–å¾—ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const array = [\"foo\", \"bar\", \"baz\"]; // keyã€valueã‚’å–å¾—ã§ãã‚‹ã€‚ const iterator = array.entries(); // for-ofã§å±•é–‹ for (const value of iterator) { console.log(value); } // [ 0, 'foo' ] // [ 1, 'bar' ] // [ 2, 'baz' ] ãƒ»Array.prototype.map() ï¼Šå®Ÿè£…ä¾‹ï¼Š // ã“ã“ã«å®Ÿè£…ä¾‹ ãƒ»Array.prototype.filter() ï¼Šå®Ÿè£…ä¾‹ï¼Š // ã“ã“ã«å®Ÿè£…ä¾‹ ãƒ»Array.length è¦ç´ æ•°ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const param = [\"foo\", \"bar\", \"baz\", \"qux\"]; console.log( param.length ); // 4 JSON ãƒ»JSON.parseãƒ¡ã‚½ãƒƒãƒ‰ JavaScriptã‹ã‚‰JSONã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š console.log( JSON.stringify({ \"x\": 1, \"y\": 5, \"z\": \"test\" }) ); // JSONå½¢å¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ // \"{\"x\":5, \"y\":5 \"z\":\"test\"}\" ãƒ»stringifyãƒ¡ã‚½ãƒƒãƒ‰ JSONã‹ã‚‰JavaScriptã«ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š console.log( JSON.parse({ \"x\" : 1, \"y\" : 5, \"z\" : \"test\" }) ); // JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ // {x:5, y:5 z:\"test\"} 02. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆã€åˆæœŸåŒ– ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã®ä½¿ç”¨ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã§ç”Ÿæˆã™ã‚‹æ–¹æ³•ã€‚ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆå°æ–‡å­—ã‹ã‚‰å§‹ã‚ã‚‹è¨˜æ³•ï¼‰ã‚’ç”¨ã„ã‚‹ã€‚ ãƒ»éçœç•¥å½¢ ï¼Šå®Ÿè£…ä¾‹ï¼Š // ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ const foo = { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property: 0, alertValue: (value) => { alert(value); }, setValue(value) { this._property = value; }, getValue() { return this._property; } } ãƒ»çœç•¥å½¢ ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã«ãŠã„ã¦ã€methodA(): fucntion{} ã¨ã™ã‚‹ã¨ã“ã‚ã‚’ã€methodA() {}ã¨è¨˜è¿°ã§ãã‚‹ã€‚ // ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ const foo = { // ï½ ä¸­ç•¥ ï½ alertValue(value) { alert(value); }, // ï½ ä¸­ç•¥ ï½ } ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã®ä½¿ç”¨ ãƒ»Objectã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•° ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆå°æ–‡å­—ã‹ã‚‰å§‹ã‚ã‚‹è¨˜æ³•ï¼‰ã‚’ç”¨ã„ã‚‹ã€‚ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã¯ã€å€¤ã‚’æ ¼ç´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚é–¢æ•°å®£è¨€ã‚ã‚‹ã„ã¯é–¢æ•°å¼ã§è¨˜è¿°ã™ã‚‹ã€‚ãƒ‘ã‚¹ã‚«ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆå¤§æ–‡å­—ã‹ã‚‰å§‹ã‚ã‚‹è¨˜æ³•ï¼‰ã‚’ç”¨ã„ã‚‹ã€‚ã¡ãªã¿ã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ã¨ã—ã¦ç”Ÿæˆã•ã‚ŒãŸé–¢æ•°ã‚’ã€ãƒ¡ã‚½ãƒƒãƒ‰ã¨å‘¼ã¶ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const foo = new Object({ // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property: 0, setValue(value) { this._property = value; }, getValue() { return this._property; } }) ãƒ»Functionã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•° ï¼Šå®Ÿè£…ä¾‹ï¼Š const Foo = new Function(); ãŸã ã—ã€å…¬å¼ã‹ã‚‰ã“ã®ã‚ˆã†ãªè¨˜æ³•ã¯ã€éæ¨å¥¨ã¨ã•ã‚Œã¦ã„ã‚‹ã€‚ä»¥ä¸‹ã®é–¢æ•°å®£è¨€ã€é–¢æ•°å¼ã€ã‚¢ãƒ­ãƒ¼é–¢æ•°ã«ã‚ˆã‚‹é–¢æ•°å¼çœç•¥ã€ã®è¨˜æ³•ãŒæ¨å¥¨ã•ã‚Œã‚‹ã€‚ç‰¹ã«ã‚¢ãƒ­ãƒ¼é–¢æ•°ã§ã¯ã€thisãŒå®£è¨€ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè‡ªèº«ã‚’æŒ‡ã™ãŸã‚ã€ä¿å®ˆæ€§ãŒé«˜ããŠã™ã™ã‚ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // é–¢æ•°å®£è¨€ function Foo() { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property = 0; // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ã¨ã—ã¦å®£è¨€ã—ãŸé–¢æ•°ã‚’ã€ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã„ã†ã€‚ this.setValue = (value) => { this._property = value; }; this.getValue = () =>{ return this._property; }; } // ã‚³ãƒ¼ãƒ« const Foo = new Foo(); // é–¢æ•°å¼ const Foo = (value) => { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property = 0; this.setValue = (value) => { this._property = value; }; this.getValue = () => { return this._property; }; } // ã‚¢ãƒ­ãƒ¼é–¢æ•°ã«ã‚ˆã‚‹é–¢æ•°å¼ã®çœç•¥è¨˜æ³• const Foo = (value) => { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property = 0; this.setValue = (value) => { this._property = value; }; this.getValue = () => { return this._property; }; } ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã¨Objectã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã«ã‚ˆã‚‹ç”Ÿæˆã¨ã¯ç•°ãªã‚Šã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã«ã‚ˆã£ã¦å®£è¨€ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€æš—ç¤ºçš„ã«prototypeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã«ã‚ˆã‚‹ç”Ÿæˆ const object1 = {}; // Objectã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã«ã‚ˆã‚‹ç”Ÿæˆ const object2 = new Object({}); // ãƒ¦ãƒ¼ã‚¶å®£è¨€Functionã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã«ã‚ˆã‚‹ç”Ÿæˆ const Object3 = () => {}; // å‡ºåŠ›çµæœ console.log( object1.prototype, // undefined object2.prototype, // undefined object3.prototype // Object3 {} ); ç³–è¡£æ§‹æ–‡ã®classã®ä½¿ç”¨ ãƒ»JavaScriptã®ã‚¯ãƒ©ã‚¹ã¨ã¯ ES6ã‹ã‚‰ã€ç³–è¡£æ§‹æ–‡ã®classã«ã‚ˆã£ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®£è¨€ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚ã‚¯ãƒ©ã‚¹å®£è¨€ã‚ã‚‹ã„ã¯ã‚¯ãƒ©ã‚¹å¼ã§è¨˜è¿°ã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆæ™‚ã€constructor()ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–ã‚’è¡Œã†ã€‚ãƒ‘ã‚¹ã‚«ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆå¤§æ–‡å­—ã‹ã‚‰å§‹ã‚ã‚‹è¨˜æ³•ï¼‰ã‚’ç”¨ã„ã‚‹ã€‚ ãƒ»ã‚¯ãƒ©ã‚¹å®£è¨€è¨˜æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š // named exportã«ã‚ˆã‚‹å‡ºåŠ› export class Foo { // classã§ã—ã‹ä½¿ãˆãªã„ã€‚ // Setterã®ä»£ã‚ã‚Šã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§Immutableã‚’å®Ÿç¾ã€‚ // ãƒ‡ãƒ¼ã‚¿ã®å®£è¨€ã¨æ ¼ç´ãŒåŒæ™‚ã«è¡Œã‚ã‚Œã‚‹ã€‚ constructor(value) { this.property = value; } getValue() { return this.property; } } // ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ import {Foo} from \"./foo.js\"; // ç”Ÿæˆã€åˆæœŸåŒ– const foo = new Foo(1); // ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ¼ãƒ« foo.getValue(); ãƒ»ã‚¯ãƒ©ã‚¹å¼è¨˜æ³• // named exportã«ã‚ˆã‚‹å‡ºåŠ› export const Foo = class { // classã§ã—ã‹ä½¿ãˆãªã„ã€‚ // Setterã®ä»£ã‚ã‚Šã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§Immutableã‚’å®Ÿç¾ã€‚ // ãƒ‡ãƒ¼ã‚¿ã®å®£è¨€ã¨æ ¼ç´ãŒåŒæ™‚ã«è¡Œã‚ã‚Œã‚‹ã€‚ constructor(value) { this._property = value; } getValue() { return this._property; } } // ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ import { Foo } from \"./foo.js\"; // ç”Ÿæˆã€åˆæœŸåŒ– const foo = new Foo(1); // ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ¼ãƒ« foo.getValue(); 02-02. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ“ä½œ ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ã«ã‚ˆã‚‹ç¶™æ‰¿ ãƒ»ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæš—ç¤ºçš„ã«æŒã¤prototypeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã€åˆ¥ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ãƒ³ãƒã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’ç¶™æ‰¿ã§ãã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ãŸæ™‚ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã“ã‚Œã‚‰ãŒå­˜åœ¨ã—ãªã‘ã‚Œã°ã€ç¶™æ‰¿å…ƒã¾ã§è¾¿ã‚‹ä»•çµ„ã¿ã‚’ã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ã€ã¨ã„ã†ã€‚ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ç”¨ã„ã‚‰ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ãƒã‚§ãƒ¼ãƒ³ã«ã¤ã„ã¦ã¯ã€åˆ¥ãƒãƒ¼ãƒˆã‚’å‚ç…§ã›ã‚ˆã€‚ ãƒ»new Obejct()ã‚’ç”¨ã„ãŸç¶™æ‰¿ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å¤§å…ƒã¨ãªã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†ã—ã¦ãŠãã®ãŒãƒ™ã‚¿ãƒ¼ã€‚ // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã®é–¢æ•°å¼ã«ã‚ˆã‚‹å®£è¨€ã€‚ const Foo = (value) => { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property = 0; this.setValue = (value) => { this._property = value; } this.getValue = () => { return this._property; }; } åˆ¥ã‚¯ãƒ©ã‚¹ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ç¶™æ‰¿ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // ç¶™æ‰¿å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã‚‚å¿˜ã‚Œãšã«ã€‚ // prototypeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ç¶™æ‰¿å…ˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®£è¨€ã€‚ const SubFoo = (subValue) => { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ this.subProperty = subValue; this.setSubValue = (subValue) => { this.subProperty = subValue; } this.getSubValue = () => { return this.subProperty; }; } // new Foo()ã‚’ç”¨ã„ãŸç¶™æ‰¿ã€‚ SubFoo.prototype = new Foo(); // SubFooã‚¯ãƒ©ã‚¹ã«ã¯getValue()ã¯ç„¡ã„ã€‚ // ç¶™æ‰¿å…ƒã¾ã§è¾¿ã‚Šã€Examlpeã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ï¼‰ã€‚ const result = SubFoo.getValue() console.log(result); ãƒ»Object.create()ã‚’ç”¨ã„ãŸç¶™æ‰¿ã¨ãƒ¡ãƒ³ãƒè¿½åŠ  ï¼Šå®Ÿè£…ä¾‹ï¼Š // ç¶™æ‰¿å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã‚‚å¿˜ã‚Œãšã«ã€‚ // prototypeãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ç¶™æ‰¿å…ˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®£è¨€ã€‚ const SubFoo = () => { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property = 0; this.setSubValue = (subValue) => { this.subProperty = subValue; }; this.getSubValue = () => { return this.subProperty; }; }; // Object.create()ã‚’ç”¨ã„ãŸç¶™æ‰¿ã€‚ SubFoo.prototype = Object.create(Foo.prototype); // SubFooã‚¯ãƒ©ã‚¹ã«ã¯getValue()ã¯ç„¡ã„ã€‚ // ç¶™æ‰¿å…ƒã¾ã§è¾¿ã‚Šã€Examlpeã‚¯ãƒ©ã‚¹ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ï¼‰ã€‚ const result = SubFoo.getValue(); console.log(result); ã¾ãŸã€Object.create()ã‚’ç”¨ã„ã‚‹å ´åˆã€ç¶™æ‰¿ã ã‘ã§ãªãã€ãƒ¡ãƒ³ãƒã‚’æ–°ã—ãè¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // Object.create()ã«ã‚ˆã‚‹ç¶™æ‰¿ã€‚ SubFoo.prototype = Object.create(Foo.prototype, { // ãƒ‡ãƒ¼ã‚¿ã‚’å®šç¾© subProperty: \"ãƒ†ã‚¹ãƒˆ\", // ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾© printSubValue: () => { return \"ã“ã‚Œã¯\" + this.subProperty + \"ã§ã™ã€‚\"; } }); // SubFooã‚¯ãƒ©ã‚¹ã«ã¯printSubValue()ãŒè¿½åŠ ã•ã‚ŒãŸã€‚ const result = SubFoo.printSubValue(); console.log(result); 02-03. thisã®å‚ç…§å…ˆ ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦ã‚³ãƒ¼ãƒ«ã™ã‚‹å ´åˆ ãƒ¡ã‚½ãƒƒãƒ‰å†…ã®thisã¯ã€fooã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡ã™ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const foo = { // æ…£ç¿’çš„ã«ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ã§privateã‚’è¡¨ã™ã€‚ _property: 0, setValue(value) { this._property = value; }, getValue() { return this._property; } } // ãƒ¡ã‚½ãƒƒãƒ‰å†…ã®thisã¯ã€fooã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡ã™ã€‚ foo.setValue(1); foo.getValue(); // 1 ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã¨ã—ã¦ã‚³ãƒ¼ãƒ«ã™ã‚‹å ´åˆ ãƒ»é–¢æ•°å®£è¨€ã¨é–¢æ•°å¼ã«ã‚ˆã‚‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°å†…ã®thisã®å ´åˆ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°å†…ã®thisã¯ã€è‡ªèº«ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡ã™ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // ä¸€ç•ªå¤–å´ã¯Windowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ param = \"global param\"; // é–¢æ•°å®£è¨€ function printParam(){ console.log(this.param); } // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ1 const object1 = { param: \"object1 param\", func: printParam } // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ2 const object2 = { param: \"object2 param\", func: printParam } /* ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°å†…ã®thisã®å ´åˆ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°å†…ã®thisã¯ã€è‡ªèº«ãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡ã™ã€‚ ã“ã“ã§ã¯ã€object1ã¨object2 */ object1.printParam; // object1 param object2.printParam; // object2 param ãƒ»ã‚¢ãƒ­ãƒ¼é–¢æ•°ã«ã‚ˆã‚‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°å†…ã®thisã®å ´åˆ ã‚¢ãƒ­ãƒ¼é–¢æ•°å†…ã®thisã®å‚ç…§å…ˆã«ã¯ã€ååˆ†ãªæ³¨æ„ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ä»Šã¾ã§ã€JavaScriptã§ã¯ã€thisã®å‚ç…§å…ˆãŒæ–‡è„ˆã«ã‚ˆã£ã¦å¤‰ã‚ã‚‹ã“ã¨ã«æ‰¹åˆ¤ãŒé›†ã¾ã£ã¦ã„ãŸã€‚ãã“ã§ã€å‚ç…§å…ˆãŒæ–‡è„ˆã«ã‚ˆã£ã¦å¤‰ã‚ã‚‰ãªã„æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚ŒãŸã€‚thisã¯ã€è‡ªèº«ãŒå®£è¨€ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡ã™ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // ä¸€ç•ªå¤–å´ã¯Windowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ param = \"global param\"; // ã‚¢ãƒ­ãƒ¼é–¢æ•°ã«ã‚ˆã‚‹çœç•¥è¨˜æ³• const printParam = () => { console.log(this.param); }; // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ1 const object1 = { param: \"object1 param\", func: printParam }; // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ2 const object2 = { param: \"object2 param\", func: printParam } /* ã‚¢ãƒ­ãƒ¼é–¢æ•°å†…ã®thisã®å ´åˆ thisã¯ã€è‡ªèº«ãŒå®£è¨€ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡ã™ã€‚ ã“ã“ã§ã¯ã€ä¸€ç•ªå¤–å´ã®Windowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚Šã€object1ã¨object2ã§ã¯ãªã„ã€‚ å‚ç…§å…ˆã¯æ–‡è„ˆã«ã‚ˆã£ã¦å¤‰ã‚ã‚‰ãªã„ã€‚ */ object1.printParam; // global param object2.printParam; // global param ã¾ãŸã€ã‚¢ãƒ­ãƒ¼é–¢æ•°ãŒã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®å¼•æ•°ã¨ãªã£ã¦ã„ã‚‹å ´åˆâ€¦ï¼ˆè¦å‹‰å¼·ï¼‰ "},"public/software/software_application_object_oriented_language_js_prototype_based_method_data.html":{"url":"public/software/software_application_object_oriented_language_js_prototype_based_method_data.html","title":"ğŸ“– ï¸ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿","keywords":"","body":"ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. é–¢æ•° é–¢æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ»é–¢æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚ã‚ã‚Šã€é–¢æ•°ã§ã‚ã‚‹ã€‚ ãƒ»ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã«ã‚ˆã‚‹é–¢æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ // å®šç¾© const object = { foo: \"bar\", age: 42, baz: {myProp: 12}, } ãƒ»ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•° é–¢æ•°å®£è¨€æ–¹å¼ã®Functionã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ç”¨ã„ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ // é–¢æ•°å®£è¨€ã«ã‚ˆã‚‹å®šç¾© function car(make, model, year) { this.make = make; this.model = model; this.year = year; } // ã‚³ãƒ¼ãƒ« const mycar = new car(\"Eagle\", \"Talon TSi\", 1993); functionå‘½ä»¤ ãƒ»functionå‘½ä»¤ã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ãªã„é–¢æ•°ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å®šç¾©ï¼ˆã‚³ãƒ¼ãƒ«ã™ã‚‹å ´æ‰€ãŒå‰å¾Œã—ã¦ã‚‚ç„¡é–¢ä¿‚ï¼‰ function foo(){ return \"foo\"; } // ã‚³ãƒ¼ãƒ« methodA(); ãƒ»åå‰ãŒãƒ‰ãƒ«ãƒãƒ¼ã‚¯ã®ã‚‚ã® JavaScriptã§ã‚ˆãè¦‹ã‹ã‘ã‚‹ãƒ‰ãƒ«ãƒãƒ¼ã‚¯ã€‚ã“ã‚Œã¯ã€é–¢æ•°ã®åå‰ã¨ã—ã¦ãƒ‰ãƒ«ãƒãƒ¼ã‚¯ã‚’ç”¨ã„ã¦ã„ã‚‹ã ã‘ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å®šç¾© function $(){ return \"foo\"; } jQueryã§ã¯ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿å®£è¨€æ™‚ã«ã€ã€Jqueryã€ã¨ã„ã†åå‰ã®ä»£ã‚ã‚Šã«ãƒ‰ãƒ«ãƒãƒ¼ã‚¯ã‚’ç”¨ã„ã‚‹ä»•æ§˜ã«ãªã£ã¦ã‚‹ã€‚ã“ã‚Œã¨æ··ä¹±ã—ãªã„ã‚ˆã†ã«æ³¨æ„ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // jQuery.get() ã¨åŒã˜ $.get() ãƒ»ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•° const asyncFunc = (param, callback) => { setTimeout(() => { // getDataãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€æ•°å€¤ã‚’æ¸¡ã™ã¨dataã‚’å–å¾—ã—ã¦ãã‚Œã‚‹ã¨ä»®å®šã—ã¾ã™ã€‚ const data = getData(param); const err = data.getError(); // ç¬¬äºŒå¼•æ•°ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯ã€getDataãƒ¡ã‚½ãƒƒãƒ‰ã¨getErrorãƒ¡ã‚½ãƒƒãƒ‰ã®å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ callback(err, data); }, 0); } const test = 1 // asyFuncãƒ¡ã‚½ãƒƒãƒ‰ã®ç¬¬ä¸€å¼•æ•°ãŒã€ç¬¬äºŒå¼•æ•°ã§è¨­å®šã—ãŸã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã«æ¸¡ã•ã‚Œã‚‹ã€‚ // æ¸¡ã•ã‚ŒãŸã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯ã€getDataãƒ¡ã‚½ãƒƒãƒ‰ã¨getErrorãƒ¡ã‚½ãƒƒãƒ‰ã®å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€errã‚„dataã‚’å—ã‘å–ã‚Œã‚‹ asyncFunc(test, (err, data) => { if (err) { throw err; } console.log(data); }); ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å¤–ã§èª­ã¿è¾¼ã‚€ é–¢æ•°ã®å‰ã§exportã‚’å®£è¨€ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š é–¢æ•°ã®å®šç¾©ã¨exportå®£è¨€ã‚’åŒæ™‚ã«è¡Œã†ã€‚ export function foo(){ return \"foo\"; } ã‚ã‚‹ã„ã¯ã€åˆ¥ã€…ã«è¡Œã†ã€‚ const foo = () => { return \"foo\"; } export default foo 02. ãƒ‡ãƒ¼ã‚¿å‹ undefinedã€null ãƒ»undefined ãƒ‡ãƒ¼ã‚¿ã‚’ä»£å…¥ã—ãªã„æ™‚ã«é©ç”¨ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å¤‰æ•°b: åˆæœŸåŒ–ã•ã‚Œã¦ã„ãªã„ï¼ˆå€¤ãŒä»£å…¥ã•ã‚Œã¦ã„ãªã„ï¼‰ const b; // å¤‰æ•°bã®å‡ºåŠ› console.log(b); // undefied ãƒ»null nullã¯ã€undefinedã¨ã¯ç•°ãªã‚Šã€æ„å›³ã—ã¦ä»£å…¥ã—ãªã‘ã‚Œã°é©ç”¨ã•ã‚Œãªã„ãƒ‡ãƒ¼ã‚¿å‹ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å¤‰æ•°a: æ„å›³ã‚’ã‚‚ã£ã¦nullã‚’å…¥ã‚Œã¦ã„ã‚‹ const a = null; console.log(a); // null ãƒ»undefinedã®è¿”å´ undefinedã‚’è¿”å´ã™ã‚‹å ´åˆã€returnã®ã¿ã‚’è¨˜è¿°ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š function hoge(){ return; // ç©ºã®ã€returnæ–‡ã€ã§ã™ã€‚ç©ºãªã®ã§ã€undefinedã€ã‚’è¿”ã—ã¾ã™ã€‚ } const x = hoge(); // å¤‰æ•°ã€xã€ã«ã¯é–¢æ•°ã€hogeã€ã‹ã‚‰è¿”ã£ã¦ããŸã€undefinedã€ãŒä»£å…¥ã•ã‚Œã¾ã™ã€‚ console.log(x); // ã€undefinedã€ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ 03. å¤‰æ•° å¤‰æ•°ã®ç¨®é¡ ãƒ»ä¸€è¦§è¡¨ é …ç›® var let const å†å®£è¨€ å¯èƒ½ ä¸å¯èƒ½ ä¸å¯èƒ½ å†ä»£å…¥ å¯èƒ½ å¯èƒ½ ä¸å¯èƒ½ åˆæœŸåŒ–ï¼ˆundefinedåŒ–ï¼‰ å¯èƒ½ å¯èƒ½ ä¸å¯èƒ½ ã‚¹ã‚³ãƒ¼ãƒ— é–¢æ•°ã‚¹ã‚³ãƒ¼ãƒ— ãƒ–ãƒ­ãƒƒã‚¯ã‚¹ã‚³ãƒ¼ãƒ— ãƒ–ãƒ­ãƒƒã‚¯ã‚¹ã‚³ãƒ¼ãƒ— ãƒ»const åŸºæœ¬çš„ã«ã¯ã€å®£è¨€ã«constã‚’ç”¨ã„ã‚‹ if (true) { // ãƒ–ãƒ­ãƒƒã‚¯å¤–ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ const x = \"foo\"; // å†å®£è¨€ä¸å¯ const x = \"bar\"; // ERROR // å†ä»£å…¥ä¸å¯ x = \"baz\"; // ERROR } // ãƒ–ãƒ­ãƒƒã‚¯å†…ã®constã«ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ console.log(x); // ERROR ãƒ» let ç¹°ã‚Šè¿”ã—å‡¦ç†ã«ãŠã„ã¦å†ä»£å…¥ãŒå¿…è¦ã§ã‚ã‚Œã°ã€constã§ã¯ãªãletã‚’ç”¨ã„ã‚‹ã€‚ if (true) { // ãƒ–ãƒ­ãƒƒã‚¯å¤–ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ let x = \"foo\"; // å†å®£è¨€ä¸å¯ let x = \"bar\"; // ERROR // å†ä»£å…¥å¯èƒ½ x = \"baz\"; } // ãƒ–ãƒ­ãƒƒã‚¯å†…ã®letã«ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ console.log(x); // ERROR ã¾ãŸã€try-catchæ§‹æ–‡ã§ã¯å¤‰æ•°ã¸ã®ä»£å…¥ãŒä¿è¨¼ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€letã‚’ç”¨ã„ã¦ã€ã‚ã‚‰ã‹ã˜ã‚åˆæœŸåŒ–ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ const asyncFunc = async () => { // åˆæœŸåŒ–ã™ã‚‹ã¨undefinedã«ãªã‚‹ã€‚ let response; try { response = await axios.get(\"/some/path1\") console.info(response); } catch (error) { console.error(error); } return response; } ãƒ» var if (true) { // ãƒ–ãƒ­ãƒƒã‚¯å¤–ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯ var x = \"hoge\"; // å†å®£è¨€ var x = \"fuga\"; // å†ä»£å…¥å¯èƒ½ x = \"fuga\"; } // ãƒ–ãƒ­ãƒƒã‚¯å†…ã®varã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ console.log(x); // fuga å¤‰æ•°ã®å·»ãä¸Šã’ ãƒ»å·»ãä¸Šã’ã®å¯¾ç­– æ„å›³ã—ãªã„æŒ™å‹•ã‚’é˜²ããŸã‚ã€javascriptã«ãŠã„ã¦ã€å¤‰æ•°ã®å®£è¨€ã¨ä»£å…¥ã¯ã€ã‚¹ã‚³ãƒ¼ãƒ—ã®æœ€åˆã«è¡Œã†ã€‚ ãƒ»var ç¢ºèªã®ãŸã‚console.logãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ãŸå ´åˆã€xã‚’å®£è¨€ã—ã¦ã„ãªã„ãŸã‚ã€ã€x is not defined ã€ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šãã†ã§ã‚ã‚‹ã€‚ã—ã‹ã—å®Ÿéš›ã¯ã€å®£è¨€ãŒæ—¢ã«æ¸ˆã‚“ã§ãŠã‚Šã€xã«å€¤ãŒä»£å…¥ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¤ºã™ã€undefinedã€ã¨ãªã‚‹ã€‚ console.log(x); // undefined var x = \"hoge\"; // å®£è¨€ã¨ä»£å…¥ ã“ã‚Œã¯ã€ã‚¹ã‚³ãƒ¼ãƒ—ã®ç¯„å›²å†…ã§å®£è¨€ã¨ä»£å…¥ã‚’å®Ÿè¡Œã—ãŸå¤‰æ•°ã«ãŠã„ã¦ã€å®£è¨€å‡¦ç†ãŒã‚¹ã‚³ãƒ¼ãƒ—ã®æœ€åˆã«è¡Œã£ãŸã“ã¨ã«ãªã‚‹ã¨ã„ã†ä»•æ§˜ã®ãŸã‚ã§ã‚ã‚‹ã€‚ // var x å®£è¨€å‡¦ç†ã—ãŸã“ã¨ã«ãªã‚‹ console.log(x); // undefined var x = \"hoge\"; // å®£è¨€ã¨ä»£å…¥ã«ã‚ˆã‚Šã€å®Ÿéš›ã¯å®£è¨€å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ãªãã¨ã‚‚ã€è¡Œãªã£ãŸã“ã¨ã«ãªã‚‹ã€‚ ãƒ»let,const å®£è¨€ã«letã€constã‚’ç”¨ã„ãŸå ´åˆã€å·»ãä¸Šã’ã¯èµ·ã“ã‚‰ãªã„ã€‚ console.log(x); // x is not defined let x = \"hoge\"; åˆ†å‰²ä»£å…¥ ãƒ»é…åˆ— é…åˆ—ã®å€¤ã‚’ã€ä»»æ„ã®åå‰ã®å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const array = [1, 2, 3]; // fooã«1ã€barã«2ã€bazã«3ã€ã‚’ä»£å…¥ const [foo, bar, baz] = array; console.log(foo); // 1 console.log(bar); // 2 console.log(baz); // 3 ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å€¤ã‚’ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã¨åŒã˜åå‰ã®å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š const obj = { foo: 1, bar: 2, baz: 3 }; // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã¨åŒã˜åå‰ã®å¤‰æ•°ã«ä»£å…¥ const {foo, baz} = obj; console.log(foo); // 1 console.log(bar); // 3 04. åå¾© for ... of ãƒ»for ... ofã¨ã¯ é…åˆ—ã‚’é †åºã‚’ä¿ã£ãŸã¾ã¾èµ°æŸ»ã—ã€é…åˆ—ã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦entiresãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€ä¸€åº¦é…åˆ—ã«å¤‰æ›ã™ã‚Œã°ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚for ... ofã‚’ä½¿ç”¨ã§ãã‚‹ã€‚for ... inã‚’ç”¨ã„ã‚‹ã‚ˆã‚Šã€ã“ã¡ã‚‰ã‚’ç”¨ã„ãŸæ–¹ãŒè‰¯ã„ã€‚ ãƒ»é…åˆ—ã®å ´åˆ const array = [\"foo\", \"bar\", \"baz\"]; for (const value of array) { console.log(value); } // foo // bar // baz é…åˆ—ã®entiresãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚Œã°ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç•ªå·ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ const array = [\"foo\", \"bar\", \"baz\"]; for (const [key, value] of array.entries()) { console.log(key); } // 0 // 1 // 2 ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦entiresãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ã€ä¸€åº¦é€£æƒ³é…åˆ—ã«å¤‰æ›ã™ã‚Œã°ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚for ... ofã‚’ä½¿ç”¨ã§ãã‚‹ã€‚ const object = { \"x\": \"foo\", \"y\": \"bar\", \"z\": \"baz\" }; for (const [property, value] of Object.entries(object)) { console.log(value); } // foo // bar // baz for ... in ãƒ»for ... inã¨ã¯ é…åˆ—ï¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆé€£æƒ³é…åˆ—ï¼‰ã‚’é †åºã‚’ä¿ãŸãšã«èµ°æŸ»ã—ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚„é…åˆ—ã®ã‚­ãƒ¼åã‚’å–å¾—ã™ã‚‹ã€‚ ãƒ»é…åˆ—ã®å ´åˆ const array = [\"foo\", \"bar\", \"baz\"]; for (const key in array) { console.log(key); } // 0 // 1 // 2 ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ const object = { \"x\": \"foo\", \"y\": \"bar\", \"z\": \"baz\" }; for (const property in object) { console.log(property); console.log(object[property]); } // x // y // z // foo // bar // baz continue ãƒ»continueã¨ã¯ åå¾©å‡¦ç†ã®ç¾åœ¨ã®ãƒ«ãƒ¼ãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã€æ¬¡ã®ãƒ«ãƒ¼ãƒ—ã‚’é–‹å§‹ã™ã‚‹ã€‚ const array = [\"foo\", \"bar\", \"baz\"]; for (const [key, value] of array.entries()) { // ã‚­ãƒ¼åãŒå¶æ•°ã®çµ„ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã€‚ if(!(key % 2 == 0)){ continue; } console.log(value); } // foo // baz ãƒ»forEaché–¢æ•°ã‚’ç”¨ã„ãŸä»£æ›¿æ³• åå¾©å‡¦ç†ã®ãƒ«ãƒ¼ãƒ—ã‚’continueã§ã‚¹ã‚­ãƒƒãƒ—ã¨åŒã˜å‹•ä½œã‚’ã€é…åˆ—ã‚’æ‰±ã†é–¢æ•°ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã§å®Ÿç¾ã§ãã‚‹ã€‚continueã‚’ç”¨ã„ã‚‹ã‚ˆã‚Šã€ã“ã¡ã‚‰ã®æ–¹ãŒè‰¯ã„ã€‚ å‚è€ƒï¼šhttps://www.deep-rain.com/programming/javascript/778#continue PHPã«ã‚‚ã€forEaché–¢æ•°ã¨åŒã˜ã‚ˆã†ã«é…åˆ—ã«å¯¾ã—ã¦ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’é©ç”¨ã™ã‚‹é–¢æ•°ï¼ˆfindã€fliterã€mapã€reduceã€someï¼‰ãŒã‚ã‚Šã€ç”¨é€”ã«åˆã‚ã›ã¦ä½¿ã„åˆ†ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/diescake/items/70d9b0cbd4e3d5cc6fce ã¡ãªã¿ã«PHPã«ã‚‚ã€forEaché–¢æ•°ã¨åŒã˜ã‚ˆã†ãªä½¿ã„æ–¹ã‚’ã™ã‚‹array_walké–¢æ•°ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_logic_iteration.html const array = [\"foo\", \"bar\", \"baz\"]; array.forEach((value, key) => { // ã‚­ãƒ¼ãŒå¶æ•°ã®çµ„ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã€‚ if(!(key % 2 == 0)){ return; } console.log(value); }) // foo // baz "},"public/software/software_application_object_oriented_language_js_logic_validation.html":{"url":"public/software/software_application_object_oriented_language_js_logic_validation.html","title":"ğŸ“– ï¸æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯","keywords":"","body":"æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. æ¤œè¨¼ æ¤œè¨¼ã®å¿…è¦æ€§ã®æœ‰ç„¡ ãƒ»ä¸è¦ãªå ´åˆ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã—ãŸå¾Œã«ç›´æ¥è¡¨ç¤ºã™ã‚‹å€¤ã®å ´åˆã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§Nullã«ãªã‚‰ãªã„ã‚ˆã†ã«åˆ¶ç´„ã‚’ã‹ã‘ã‚‰ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€å€¤ãŒæƒ³å®šé€šã‚Šã®çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã‹ã‚’æ”¹ã‚ã¦æ¤œè¨¼ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ ãƒ»å¿…è¦ãªå ´åˆ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®å€¤ã‚’ç›´æ¥è¡¨ç¤ºã™ã‚‹å ´åˆã¨ç•°ãªã‚Šã€æ–°ã—ãä½œã‚‰ã‚Œã‚‹å€¤ã‚’ç”¨ã„ã‚‹å ´åˆã€ãã®å€¤ãŒæƒ³å®šå¤–ã®çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ãã®ãŸã‚ã€å€¤ãŒæƒ³å®šé€šã‚Šã®çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚æ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦ã¯ã€å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ æ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨æ¤œè¨¼ãƒ¡ã‚½ãƒƒãƒ‰ã®å¯¾å¿œ ã€‡ï¼šTRUE âœ•ï¼šFALSE ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_logic_validation.html typeof $var if($var) null object âœ• 0 number âœ• 1 number ã€‡ \"\"ï¼ˆç©ºæ–‡å­—ï¼‰ string âœ• \"ã‚\" string ã€‡ NaN number âœ• undefined undefined âœ• "},"public/software/software_application_object_oriented_language_js_logic_asynchronous_process.html":{"url":"public/software/software_application_object_oriented_language_js_logic_asynchronous_process.html","title":"ğŸ“– ï¸éåŒæœŸå‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯","keywords":"","body":"éåŒæœŸå‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ 01. éåŒæœŸå‡¦ç† éåŒæœŸå‡¦ç† ãƒ»éåŒæœŸå‡¦ç†ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_basic_language_processor_process_mode.html ãƒ»éåŒæœŸå‡¦ç†åŒ– å‡¦ç†ã®å®Ÿè¡Œã‚’éƒ¨åˆ†çš„ã«é…ã‚‰ã›ã‚‹ã¨ã€å¾Œç¶šã™ã‚‹å‡¦ç†ãŒå…ˆã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã‚Œã¯éåŒæœŸå‡¦ç†ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/kiyodori/items/da434d169755cbb20447#%E9%9D%9E%E5%90%8C%E6%9C%9F%E5%87%A6%E7%90%86 ï¼Šå®Ÿè£…ä¾‹ï¼Š éåŒæœŸåŒ–ã™ã‚‹å‡¦ç†ã‚’setTimeouté–¢æ•°ã«æ¸¡ã—ã€å‡¦ç†ã‚’é…ã‚‰ã›ã‚‹ã€‚ function asyncMethod() { // 1ç§’ã ã‘å®Ÿè¡Œã‚’é…ã‚‰ã›ã‚‹ setTimeout(function () { console.log(\"foo\"); }, 1000); console.log(\"bar\"); } asyncMethod(); // å…ˆã«barãŒå®Ÿè¡Œã•ã‚Œã‚‹ // bar // foo Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ»Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯ JavaScriptã«ãŠã„ã¦ã€éåŒæœŸå‡¦ç†ã®æˆå¦ã‚’ç®¡ç†ã—ã€å¾Œç¶šã™ã‚‹å‡¦ç†ã‚’å®šç¾©ã§ãã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã“ã¨ã€‚Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å®Ÿè£…ã®ä»•æ§˜ã¯å–ã‚Šæ±ºã‚ã‚‰ã‚Œã¦ãŠã‚Šã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://promisesaplus.com/ ãƒ»Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç¨®é¡ ãƒã‚¤ãƒ†ã‚£ãƒ–ãªJavaScriptã®Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€JQueryã®Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ãŒã‚ã‚‹ã€‚ãƒã‚¤ãƒ†ã‚£ãƒ–ã®æ–¹ãŒã€Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä»•æ§˜ã«ã‚ˆã‚Šå‰‡ã£ãŸæ©Ÿèƒ½ã‚’æŒã¤ã€‚ å‚è€ƒï¼šhttps://stackoverflow.com/questions/32831143/javascript-promise-vs-jquery-deferred ãƒªãƒªãƒ¼ã‚¹æ—¥ æä¾› ç¨®é¡ èª¬æ˜ è£œè¶³ 2012 JQueryãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®Deferredãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒãƒ¼ã‚¸ãƒ§ãƒ³1.5ã§Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå°å…¥ã•ã‚ŒãŸã€‚å‚è€ƒï¼šhttps://api.jquery.com/category/version/1.5/ å‚è€ƒï¼šhttps://api.jquery.com/category/deferred-object/ 2015 ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ JQueryã®Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‚è€ƒã«ã—ã¦ã€ES2015ã‹ã‚‰æ–°ã—ãä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Promise 2017 ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ async/awaitå®£è¨€ ES2017ã‹ã‚‰æ–°ã—ãä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚ˆã‚Šä½¿ç”¨ã—ã‚„ã™ãã—ãŸã‚‚ã®ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Statements/async_function 02. ãƒã‚¤ãƒ†ã‚£ãƒ–ãªJavaScript Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã€éåŒæœŸå‡¦ç†ã‚’æŒã¤é–¢æ•°ã‚’æ¸¡ã™ã“ã¨ã«ã‚ˆã‚Šã€Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã“ã®é–¢æ•°å†…ã®éåŒæœŸå‡¦ç†ã®æˆå¦ã‚’ç®¡ç†ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Promise const asyncFunc = () => { return new Promise( // éåŒæœŸå‡¦ç†ã‚’æŒã¤é–¢æ•°ã‚’æ¸¡ã™ (resolve, reject) => { // é–¢æ•°å†…ã®éåŒæœŸå‡¦ç†ã®æˆå¦ãŒç®¡ç†ã•ã‚Œã‚‹ }) } resolveãƒ¡ã‚½ãƒƒãƒ‰ã€rejectãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ç”¨ã„ã‚‹å ´åˆ Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å†…ã§ã¯ã€æš—é»™çš„ã«try-catchãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€çµæœã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒæˆåŠŸã§ã‚ã‚Œã°resolveãƒ¡ã‚½ãƒƒãƒ‰ã®çµæœã‚’è¿”å´ã—ã€åå¯¾ã«å¤±æ•—ã§ã‚ã‚Œã°rejectãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿”å´ã™ã‚‹ã€‚ä¸¡æ–¹ã‚’å®Ÿè£…ã™ã‚‹ã¨è‰¯ã—ãªã«å®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã€‚resolveãƒ¡ã‚½ãƒƒãƒ‰ã¨resolveãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ¼ãƒ«æ™‚ã«returnã‚’ä½¿ç”¨ã—ãªã„ã¨ã€å¾Œç¶šã™ã‚‹å‡¦ç†ã‚‚å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ä¸€ã¤ç›®ã®æ›¸ãæ–¹ã¨ã—ã¦ã€Promiseã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã«æ¸¡ã™æ–¹æ³•ãŒã‚ã‚‹ã€‚ const asyncFunc = () => { return new Promise((resolve, reject) => { // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒæˆåŠŸã®å ´åˆã«é¸æŠã•ã‚Œã‚‹ã€‚ resolve(\"SUCCESS\"); // Promise { \"SUCCESS\" } // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå¤±æ•—ã®å ´åˆã«é¸æŠã•ã‚Œã‚‹ã€‚ reject(\"FAILED\"); // Promise { \"FAILED\" } console.log(\"test\"); }) } console.log(asyncFunc()); // å¾Œç¶šã™ã‚‹å‡¦ç†ã‚‚å®Ÿè¡Œã•ã‚Œã€resolveãƒ¡ã‚½ãƒƒãƒ‰ã®çµæœãŒè¿”å´ã•ã‚Œã‚‹ã€‚ // test // Promise { 'SUCCESS' } ä¸€æ–¹ã§ã€resolveãƒ¡ã‚½ãƒƒãƒ‰ã¨resolveãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ¼ãƒ«æ™‚ã«returnã‚’ç”¨ã„ã‚‹ã¨ã€å¾Œç¶šã™ã‚‹å‡¦ç†ã¯å®Ÿè¡Œã•ã‚Œãªã„ã€‚ const asyncFunc = () => { return new Promise((resolve, reject) => { return resolve(\"SUCCESS\"); reject(\"FAILED\"); console.log(\"test\"); }) } console.log(asyncFunc()); // å¾Œç¶šã™ã‚‹å‡¦ç†ã‚‚å®Ÿè¡Œã•ã‚Œãªã„ã€‚ // Promise { 'SUCCESS' } ãƒ»ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ä½¿ç”¨ã—ãªã„å ´åˆ åˆ¥ã®æ›¸ãæ–¹ã¨ã—ã¦ã€Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ç›´æ¥resolveãƒ¡ã‚½ãƒƒãƒ‰ã‚„rejectãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã—ã¦ã‚‚ã‚ˆã„ã€‚ã“ã®å ´åˆã€å¿…ãšreturnã§è¿”å´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚returnã‚’ä½¿ç”¨ã—ãªã„ã¨ã€ä½•ã‚‚è¿”å´ã•ã‚Œãªã„ã€‚ const asyncFunc = () => { // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒæˆåŠŸã®å ´åˆã«é¸æŠã•ã‚Œã‚‹ã€‚ return Promise.resolve(\"SUCCESS\"); // Promise { \"SUCCESS\" } } const asyncFunc = () => { // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå¤±æ•—ã®å ´åˆã«é¸æŠã•ã‚Œã‚‹ã€‚ return Promise.reject(\"FAILED\"); // Promise { \"FAILED\" } } console.log(asyncFunc()); // Promise { 'SUCCESS' } const asyncFunc = () => { return Promise.resolve(\"SUCCESS\"); } asyncFunc() // å¤±æ•—æ™‚ã«è¿”å´ã•ã‚ŒãŸrejectã‚’ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° .catch((reject) => { // rejectãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œ reject }) .then((resolve) => { // resolveãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œ resolve }) console.log(asyncFunc()); // Promise { 'SUCCESS' } éåŒæœŸå‡¦ç†å†…ã§ä¸¡æ–¹ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ const asyncFunc = () => { Promise.resolve(\"SUCCESS\"); Promise.reject(\"FAILED\"); } console.log(asyncFunc()); // ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ UnhandledPromiseRejectionWarning: FAILED (Use `node --trace-warnings ...` to show where the warning was created) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 1) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code. è£œè¶³ã¨ã—ã¦ã€Nodeã®HTTPãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®é–¢æ•°ã¯ã€Promiseã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¨ã—ã¦ä½¿ç”¨ã—ãªã„ã¨ã€æ­£ã—ãæŒ™å‹•ã—ãªã„ã€‚ å‚è€ƒï¼šhttps://stackoverflow.com/questions/38533580/nodejs-how-to-promisify-http-request-reject-got-called-two-times thenãƒ¡ã‚½ãƒƒãƒ‰ã€catchãƒ¡ã‚½ãƒƒãƒ‰ã€finallyãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ç”¨ã„ã‚‹å ´åˆ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Promise#instance_methods ï¼Šå®Ÿè£…ä¾‹ï¼Š const resolveFunc = new Promise((resolve, reject) => { return resolve(\"resolve!!\"); }); resolveFunc.then((value) => { // resolveFuncãŒPromiseã‚’è¿”ã—ã€resolve!!ãŒresolveã•ã‚Œã‚‹ãŸã‚ // thenãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«resolve!!ãŒè¡¨ç¤ºã•ã‚Œã‚‹ console.log(value); // resolve!! }); const resolveFunc = () => { // resolveFuncã¯async functionã§ã¯ãªã„ãŸã‚ã€Promiseã‚’è¿”ã•ãªã„ return \"resolve!!\"; } resolveFunc.then((value) => { // resolveFuncã¯Promiseã‚’è¿”ã•ãªã„ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦å‹•ã‹ãªã„ // Uncaught TypeError: resolveError(...).then is not a function console.log(value); }); const rejectFunc = new Promise((resolve, reject) => { reject(new Error(\"reject!!\")); }); rejectFunc.catch((err) => { // rejectFuncãŒPromiseã‚’è¿”ã—ã€reject!!ãŒrejectã•ã‚Œã‚‹ãŸã‚ // catchãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«reject!!ãŒè¡¨ç¤ºã•ã‚Œã‚‹ console.log(err); // reject!! }); 02-02. async/awaitå®£è¨€ asyncå®£è¨€ ãƒ»asyncå®£è¨€ã¨ã¯ Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ˜ç¤ºçš„ã«ç”¨ã„ã‚‹å ´åˆã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«éåŒæœŸå‡¦ç†ã‚’æŒã¤é–¢æ•°ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ä¸€æ–¹ã§ã€asyncå®£è¨€ã•ã‚ŒãŸé–¢æ•°å†…ã®éåŒæœŸå‡¦ç†ã¯ã€Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æ¸¡ã™ãŸã‚ã®é–¢æ•°å†…ã«æš—é»™çš„ã«å®šç¾©ã•ã‚Œã‚‹ã€‚Promiseã‚„ã€ã“ã‚Œã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ã‚¿ã«æ¸¡ã™é–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒç„¡ã„ãŸã‚ã€å¯èª­æ€§ãŒé«˜ã¾ã‚‹ã€‚ã¾ãŸã€ä»®ã«Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚³ãƒ¼ãƒ«ã—ã€Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒPromiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æ¸¡ã•ã‚Œã¦ã—ã¾ã£ã¦ã‚‚ã€çµæœçš„ã«å…¥ã‚Œå­ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã‚ˆã—ãªã«å‡¦ç†ã—ã¦ãã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Statements/async_function ï¼Šå®Ÿè£…ä¾‹ï¼Š ä»¥ä¸‹ã®å…¨ã¦ã¯ã€åŒã˜å‡¦ç†ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã€‚ const asyncFunc = async () => { // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æ¸¡ã™ãŸã‚ã®é–¢æ•°å†…ã«æš—é»™çš„ã«å®šç¾©ã•ã‚Œã‚‹ã€‚ return \"SUCCESS\" } // å˜ã«returnã¨ã—ã¦ã‚‚Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¿”å´ã•ã‚Œã‚‹ã€‚ console.log(asyncFunc()); // Promise { \"SUCCESS\" } const asyncFunc = async () => { return new Promise((resolve, reject) => { return resolve(\"SUCCESS\") // Promise { \"SUCCESS\" } }) } // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”å´ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚‚ã€å…¥ã‚Œå­ã«ã¯ãªã‚‰ãªã„ã€‚ console.log(asyncFunc()); // Promise { \"SUCCESS\" } const asyncFunc = async () => { return Promise.resolve(\"SUCCESS\") // Promise { \"SUCCESS\" } } // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”å´ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚‚ã€å…¥ã‚Œå­ã«ã¯ãªã‚‰ãªã„ã€‚ console.log(asyncFunc()); // Promise { \"SUCCESS\" } ã¾ãŸã€axiosã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚ˆã†ã«Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¨™æº–ã§è¿”å´ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã‚‚ã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š éé“å‡¦ç†ã¨ã—ã¦GETã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã„ã‚‹ã€‚ // axiosã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”å´ã™ã‚‹ã€‚ const asyncFunc = async () => { axios.get(\"/some/path\").then((res) => { console.log(res.data); // \"some data\" }); } awaitå®£è¨€ã¨ã¯ ãƒ»awaitå®£è¨€ ä»¥é™ã®å…¨å‡¦ç†ã‚’thenãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã™ã€‚Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®thenãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“ã™ã‚‹ãŒã€thenãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚ˆã†ã«ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã™ã‚‹å¿…è¦ã¯ãªããªã‚‹ãŸã‚ã€å¯èª­æ€§ãŒé«˜ã„ã€‚æ™‚é–“ã®ã‹ã‹ã‚‹éåŒæœŸå‡¦ç†ã§ã“ã‚Œã‚’å®£è¨€ã™ã‚‹ã¨ã€äºˆæœŸã›ãšå‡¦ç†ãŒæµã‚Œã¦ã—ã¾ã†ã“ã¨ã‚’é˜²ã’ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®thenãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ãŸå ´åˆ const asyncFunc = async () => { axios.get(\"/some/path\").then((res) => { console.log(res.data); // \"some data\" }); } // awaitã‚’ç”¨ã„ãŸå ´åˆ const asyncFunc = async () => { // ä»¥é™ã®å…¨å‡¦ç†ãŒthenãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã•ã‚Œã‚‹ã€‚ const res = await axios.get(\"/some/path\"); console.log(res.data); // \"some data\" } awaitå®£è¨€ã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯åœ°ç„ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒåˆ†ã‹ã‚Šã‚„ã™ããªã‚‹ã€‚ // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®thenãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ãŸå ´åˆ const asyncFunc = async () => { // ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°åœ°ç„ã«ãªã£ã¦ã„ã‚‹ã€‚ axios.get(\"/some/path1\").then((res) => { const res1 = res; axios.get(\"/some/path1\").then((res) => { const res2 = res; console.log(res1.data + res2.data); // \"some data\" }); }) } // awaitã‚’ç”¨ã„ãŸå ´åˆ const asyncFunc = async () => { const res1 = await axios.get(\"/some/path1\"); const res2 = await axios.get(\"/some/path2\"); console.log(res1.data + res2.data); // \"some data\" } ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° ãƒ»try-catch Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®thenãƒ¡ã‚½ãƒƒãƒ‰ã€catchãƒ¡ã‚½ãƒƒãƒ‰ã€finallyãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…ã§ãã‚‹ãŒã€try-catchæ–‡ã¨awaitå®£è¨€ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ã‚ˆã‚Šå¯èª­æ€§é«˜ãå®Ÿè£…ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Promise#instance_methods ï¼Šå®Ÿè£…ä¾‹ï¼Š const asyncFunc = async () => { return axios.get(\"/some/path1\") .catch((error) => { console.error(error); }) .then((data) => { console.info(data); }); } const asyncFunc = async () => { // åˆæœŸåŒ– let response; try { response = await axios.get(\"/some/path1\") console.info(response); } catch (error) { console.error(error); } return response; } ã‚¹ãƒªãƒ¼ãƒ— ãƒ»setTimeout æŒ‡å®šã—ãŸç§’æ•°ã ã‘å‡¦ç†ã‚’å¾…æ©Ÿã™ã‚‹ã€‚ // 5ç§’å¾…æ©Ÿã™ã‚‹ã€‚ await new Promise((resolve) => { setTimeout(resolve, 5000) }); 03. JQuery Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ»doneãƒ¡ã‚½ãƒƒãƒ‰ã€failãƒ¡ã‚½ãƒƒãƒ‰ã€alwaysãƒ¡ã‚½ãƒƒãƒ‰ Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚‚ã¤ãƒ¡ã‚½ãƒƒãƒ‰ã€‚ajaxãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ã—ãŸå¾Œã€ãã®çµæœã‚’doneã€failã€alwaysã®ä¸‰ã¤ã«åˆ†é¡ã—ã€ã“ã‚Œã«å¿œã˜ãŸã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š JQueryãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®getãƒ¡ã‚½ãƒƒãƒ‰ã‚„postãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ãŸå ´åˆã€‚ const url = \"https://www.google.co.jp/\"; $.get(url) .done((data) => { console.log(data); }) .fail((error) => { console.log(error); }); const url = \"https://www.google.co.jp/\"; const params = { name: \"Hiroki\", }; $.post(url, params) .done((data) => { console.log(data); }) .fail((error) => { console.log(error); }); JQueryãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ajaxãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ãŸå ´åˆã€‚ const id = 1; $.ajax({ type: \"POST\", url: \"/xxx/xxx/\" + id + \"/\", contentType: \"application/json\", data: { param1: \"AAA\", param2: \"BBB\" }, }) // éåŒæœŸé€šä¿¡ã®æˆåŠŸæ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† .done((data) => { console.log(data); }) // éåŒæœŸé€šä¿¡ã®å¤±æ•—æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† .fail((error) => { console.log(data); toastr.error(\"\", \"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚\"); }) // éåŒæœŸé€šä¿¡ã®æˆåŠŸå¤±æ•—ã«é–¢ã‚ã‚‰ãšå¸¸ã«å®Ÿè¡Œã™ã‚‹å‡¦ç† .always((data) => { this.isLoaded = false; }); ãƒ»thenãƒ¡ã‚½ãƒƒãƒ‰ Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚‚ã¤ãƒ¡ã‚½ãƒƒãƒ‰ã€‚ajaxãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ã—ãŸå¾Œã€ãã®çµæœã‚’thenãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã®é †ç•ªã§åˆ†é¡ã—ã€ã“ã‚Œã«å¿œã˜ãŸã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã€‚éåŒæœŸå‡¦ç†ã®å¾Œã«åŒæœŸå‡¦ç†ã‚’è¡Œã„ãŸã„å ´åˆã«ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š JQueryãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ajaxãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ãŸå ´åˆã€‚ const id = 1; $.ajax({ type: \"POST\", url: \"/xxx/xxx/\" + id + \"/\", contentType: \"application/json\", data: { param1: \"AAA\", param2: \"BBB\" }, }) // æœ€åˆã®then .then( // å¼•æ•°1ã¤ã‚ã¯é€šä¿¡æˆåŠŸæ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† (data) => { }, // å¼•æ•°2ã¤ã‚ã¯é€šä¿¡å¤±æ•—æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† (data) => { }) // æ¬¡ã®then .then( // å¼•æ•°1ã¤ã‚ã¯é€šä¿¡æˆåŠŸæ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† (data) => { }); "},"public/software/software_application_object_oriented_language_js_package.html":{"url":"public/software/software_application_object_oriented_language_js_package.html","title":"ğŸ“– ï¸ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸","keywords":"","body":"ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. npmã«ã‚ˆã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç®¡ç† init ãƒ»package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ $ npm init ãƒ»package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€  { # npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã€‚å…¨ã¦ã®npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¸­ã§ã€ä¸€æ„ã®åå‰ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ \"name\": \"tech-notebook-gitbook\", \"version\": \"1.0.0\", \"description\": \"tech-notebook-gitbook\", \"main\": \"index.js\", \"directories\": {}, # æœ¬ç•ªç’°å¢ƒã¨é–‹ç™ºç’°å¢ƒã§ä¾å­˜ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¯ä¸€æ„ã«è­˜åˆ¥ã§ãã‚‹ã€‚ \"dependencies\": { \"gitbook-plugin-advanced-emoji\": \"^0.2.2\", \"gitbook-plugin-anchors\": \"^0.7.1\", \"gitbook-plugin-back-to-top-button\": \"^0.1.4\", \"gitbook-plugin-copy-code-button\": \"^0.0.2\", \"gitbook-plugin-ga\": \"^1.0.1\", \"gitbook-plugin-github-buttons\": \"^3.0.0\", \"gitbook-plugin-hide-published-with\": \"^1.0.3\", \"gitbook-plugin-intopic-toc\": \"^1.1.1\", # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ç™»éŒ²ã•ã‚Œã¦ã„ãªã„ã‚‚ã®ã€ãƒªãƒã‚¸ãƒˆãƒªURLã‹ã‚‰ç›´æ¥å‚ç…§ã™ã‚‹ã€‚ã€git+ã€ã‚’å¿˜ã‚Œãªã„ã“ã¨ã€‚ \"gitbook-plugin-prism\": \"git+https://github.com/hiroki-it/gitbook-plugin-prism.git\", \"gitbook-plugin-search-pro-fixed\": \"^1.0.1\", \"gitbook-plugin-sunlight-highlighter\": \"^0.4.3\", \"gitbook-plugin-toolbar\": \"^0.6.0\" }, # é–‹ç™ºç’°å¢ƒã®ã¿ä¾å­˜ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã€‚ \"devDependencies\": {}, \"scripts\": {}, \"repository\": { \"type\": \"git\", \"url\": \"https://github.com/hiroki-it/tech-notebook-gitbook.git\" }, # è‘—è€…å \"author\": { \"name\": \"Hiroki Hasegawa\", \"email\": \"example@gmail.com\", \"url\": \"https://github.com/hiroki-it\" }, \"license\": \"ISC\", \"bugs\": { \"url\": \"https://github.com/hiroki-it/tech-notebook-gitbook/issues\" }, \"homepage\": \"https://github.com/hiroki-it/tech-notebook-gitbook\" } install ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¦ã€package.lockãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã†ã¡ã§ã€ã‚¤ãƒ³ã‚¹ãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ã‚‚ã®ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚package.lockãƒ•ã‚¡ã‚¤ãƒ«ã®ãŠã‹ã’ã§ã€ãƒªãƒã‚¸ãƒˆãƒªã®åˆ©ç”¨è€…ãŒã€npm installã®å®Ÿè¡Œæ™‚ã«ã€å…±é€šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã€‚ $ npm install ãƒ»--force ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å®Ÿè¡Œæ¨©é™ä¸è¶³ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒåœæ­¢ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ã“ã‚Œã‚’ç„¡è¦–ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã†ã€‚ $ npm install --force ãƒ»--save ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ã€ä¾å­˜ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã€dependenciesã‚­ãƒ¼ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›¸ãè¾¼ã‚€ã€‚ $ npm install --save update ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¦ã€package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æŒ‡å®šã‚’ã‚‚ã¨ã«ã€æ›´æ–°å¯èƒ½ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ›´æ–°ã™ã‚‹ã€‚ $ npm update run ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ãƒ¦ãƒ¼ã‚¶ãŒå®šç¾©ã—ãŸã‚¨ã‚¤ãƒªã‚¢ã‚¹åã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ npm run ã‚ã‚‰ã‹ã˜ã‚ã€ä»»æ„ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’scriptsã‚­ãƒ¼ä¸‹ã«å®šç¾©ã™ã‚‹ã€‚ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®ä¸­ã§ã€å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã®ã‚»ãƒƒãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ã¡ãªã¿ã«ã€å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã®ä¸­ã§ã€å†åº¦runã‚³ãƒãƒ³ãƒ‰ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚ { \"scripts\": { # \"\": \"\", \"dev\": \"npm run development\", \"development\": \"cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js\", \"watch\": \"npm run development -- --watch\", \"watch-poll\": \"npm run watch -- --watch-poll\", \"hot\": \"cross-env NODE_ENV=development node_modules/webpack-dev-server/bin/webpack-dev-server.js --inline --hot --disable-host-check --config=node_modules/laravel-mix/setup/webpack.config.js\", \"prod\": \"npm run production\", \"production\": \"cross-env NODE_ENV=production node_modules/webpack/bin/webpack.js --no-progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js\" } } NODE_OPTIONS ãƒ¡ãƒ¢ãƒªä¸Šé™ã‚’è¨­å®šã™ã‚‹ã€‚ $ export NODE_OPTIONS=\"--max-old-space-size=2048\" 02. yarnã«ã‚ˆã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç† 03. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ« ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ«ã¨ã¯ ãƒ»èª­ã¿è¾¼ã‚€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã¾ã¨ã‚ã‚‹ JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€scriptã‚¿ã‚°ã‚’ä¸€ã¤ã«ã¾ã¨ã‚ã‚‹ã€‚HTMLãŒãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã¨ã€JavaScriptã®ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒæ¸›ã‚‹ãŸã‚ã€ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ãŒæ—©ããªã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/soarflat/items/28bf799f7e0335b68186 ï¼Šä¾‹ï¼Š ä»¥ä¸‹ã®ã‚ˆã†ãªHTMLãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã¨ã™ã‚‹ã€‚ webpack tutorial ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ«ã¯ã€scriptã‚¿ã‚°ã§ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚’ã¾ã¨ã‚ã‚‹ã€‚ webpack tutorial "},"public/software/software_application_object_oriented_language_js_framework_vuejs.html":{"url":"public/software/software_application_object_oriented_language_js_framework_vuejs.html","title":"ğŸ“– ï¸Vue.js","keywords":"","body":"Vue.js ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Vue.jsã‚’ç”¨ã„ãŸMVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° ãƒ»MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_architecture_frontend.html ãƒ» MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹å„å±¤ã®è²¬å‹™ Viewå±¤ï¼ˆxxx.htmlã€/xxx.twigã€xxx-component.vueã®templateã‚¿ã‚°éƒ¨åˆ†ï¼‰ ViewModelå±¤ã‹ã‚‰æ¸¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹ã ã‘ã€‚ ViewModelå±¤ï¼ˆindex.jsã€xxx-component.vueã®scriptã‚¿ã‚°éƒ¨åˆ†ï¼‰ ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ•´å½¢ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒšãƒ¼ã‚¸ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«ãªã©ï¼‰ã‚„ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆâ€»æ§ãˆã‚ã«ï¼‰ã‚’è¨˜è¿°ã™ã‚‹ã€‚scriptã‚¿ã‚°ã«ã‚ˆã£ã¦ã€JavaScriptãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã€‚ Modelå±¤ï¼ˆstore.jsã¾ãŸã¯xxx.js) ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚„ã€ajaxãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿é€å—ä¿¡ã€ã‚’è¨˜è¿°ã™ã‚‹ã€‚ ãƒ»Vueã‚’ç”¨ã„ãŸMVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° Vueã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­è¨ˆã«MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç”¨ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã€åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Ÿç¾ã§ãã‚‹ã‚ˆã†ãªæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã€‚ Viewå±¤ã§ã¯ã€xxx.htmlã€/xxx.twigã€xxx-component.vueã®templateã‚¿ã‚°éƒ¨åˆ†ï¼‰ ViewModelå±¤ã§ã¯ã€index.jsã€xxx-component.vueã®scriptã‚¿ã‚°éƒ¨åˆ† Modelå±¤ã§ã¯ã€Vuexï¼ˆstore.js)ã‚„JavaScriptã‹ã‚‰ãªã‚‹ãƒ¢ãƒ‡ãƒ«ï¼ˆxxx.jsï¼‰ã‚’è¨­ç½®ã™ã‚‹ã€‚ ã“ã‚Œã®å…ƒã€åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒå®Ÿç¾ã•ã‚Œã‚‹ä»•çµ„ã¿ã¨ã—ã¦ã€Viewå±¤ã§ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ã“ã‚‹ã¨ã€ViewModelå±¤ã§ã“ã‚Œã«ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ è¦ªå­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®ãƒ‡ãƒ¼ã‚¿æ¸¡ã— ãƒ»è¦ªå­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®ãƒ‡ãƒ¼ã‚¿æ¸¡ã—ã®ä»•çµ„ã¿ï¼ˆProps Down, Events Upï¼‰ ã¾ãšã€åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã¨ã¯ç•°ãªã‚‹æ¦‚å¿µãªã®ã§ã€æ··ä¹±ã—ãªã„ã‚ˆã†ã«æ³¨æ„ã™ã‚‹ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆxxx-component.vueï¼‰ã®scriptã‚¿ã‚°éƒ¨åˆ†ï¼ˆViewModelå±¤ï¼‰ã®è¦ªå­é–“ã§ã¯ã€propsã¨$emit()ã‚’ç”¨ã„ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã€‚ã“ã®ä»•çµ„ã¿ã‚’ã€Props Down, Events Upã¨ã„ã†ã€‚ MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å®Ÿè£…ä¾‹ (1) ã€Viewå±¤ã€‘ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆxxx.htmlã€xxx.twigï¼‰ ãƒ‡ãƒ¼ã‚¿ãŒã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã«æ¸¡ã•ã‚Œã‚‹ä»•çµ„ã¿ã¯ã€ãƒ•ãƒ¬ãƒ¼ã‚¯ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã‚ãªã„å ´åˆã¨åŒã˜ã§ã‚ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ãŒJavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã«æ¸¡ã•ã‚Œã‚‹çŠ¶æ³ã¨ã—ã¦ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«æ™‚ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ãˆã°ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¿ã‚°ã§ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãŸæ™‚ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ã€ã‚¤ãƒ™ãƒ³ãƒˆã«ç´ä»˜ã„ãŸã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ (1-2) ã€ViewModelå±¤ã€‘ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–ã‚’è¡Œã†Vueã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ï¼ˆindex.jsï¼‰ Vueã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã‚’ç”¨ã„ã¦ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ«ãƒ¼ãƒˆVueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å¤‰æ•°åvmã¯VIewModelã®æ„å‘³ã§ã‚ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–æ™‚ã€å…¨ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãŒåˆæœŸåŒ–ã•ã‚Œã‚‹ã€‚å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å€‹åˆ¥ã«çŠ¶æ…‹ã‚’å¤‰åŒ–ã•ã›ãŸã„ã‚‚ã®ã¯ã€propsã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã¯ãªãã€dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦æ‰±ã†ã€‚ å‚è€ƒï¼šhttps://v1-jp.vuejs.org/guide/instance.html ï¼Šå®Ÿè£…ä¾‹ï¼Š // ãƒ«ãƒ¼ãƒˆVueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ //ã€€Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”¨ã„ã‚‹divã‚¿ã‚°ã‚’è¨­å®š. el: \"#app\", /* dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ ãƒ»Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ ãƒ»ç•°ãªã‚‹å ´æ‰€ã«ã‚ã‚‹åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ç•°ãªã‚‹Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ãªã‚‹ã€‚ ãƒ»ç•°ãªã‚‹Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ç•°ãªã‚‹å€¤ã‚’æŒã¤å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦å®šç¾©ã€‚ */ data: function () { return { isLoading: false, staffData: [], criteria: { id: null, name: null }, }; }, /* methodã‚ªãƒ—ã‚·ãƒ§ãƒ³ ãƒ»Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚µãƒ¡ã‚½ãƒƒãƒ‰ã‚„çŠ¶æ…‹å¤‰åŒ–ãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã€dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚»ãƒƒã‚¿ãƒ¼ã‚’å®šç¾© */ method: { // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•° changeQuery(criteriaObj) { const keys = [ \"criteria\", \"limit\", ]; for (const key of keys) { if (key in criteriaObj) { this[key] = criteriaObj[key]; } } }, // dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚»ãƒƒã‚¿ãƒ¼ load(query) { // ã“ã“ã§ã®thisã¯dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡ã™ã€‚ this.isLoading = true; this.staffData = []; // ajaxãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ©ãƒƒãƒ”ãƒ³ã‚°ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ« return Staff.find(query) /* done() ajaxãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦è¿”å´ã•ã‚ŒãŸJSONãŒå¼•æ•°ã«ãªã‚‹ã€‚ */ .done((data) => { /* ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã‹ã‚‰ã®JSONã‚’ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã€‚ dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¨­å®šã€‚ */ this.staffData = _.map( data.staffData, Staff.deserializeStaff ); }) }, }, /* watchã‚ªãƒ—ã‚·ãƒ§ãƒ³ ãƒ»Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã®å€¤ã®å¤‰åŒ–ã‚’ç›£è¦–ã™ã‚‹é–¢æ•°ã‚’å®šç¾©ã€‚ ãƒ»Vue-Routerã‚’å‚ç…§ã›ã‚ˆã€‚ */ watch: {}, // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¯¾å¿œã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ component: { //ã€HTMLã§ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¿ã‚°åï¼šå­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€ \"v-foo-component-1\": require(\".../component/xxx-1.vue\"), \"v-foo-component-2\": require(\".../component/xxx-2.vue\"), \"v-foo-component-3\": require(\".../component/xxx-3.vue\") }, }) (2) ã€View + ViewModelå±¤ã€‘å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆxxx-component.vueï¼‰ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€Viewå±¤ã¨ã—ã¦ã®templateã‚¿ã‚°ã€ViewModelå±¤ã¨ã—ã¦ã®scriptã‚¿ã‚°ã¨styleã‚¿ã‚°ã‚’ç”¨ã„ã¦ã€å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ãˆã°ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¿ã‚°ã§ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãŸæ™‚ã€å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ã€ã‚¤ãƒ™ãƒ³ãƒˆã«ç´ä»˜ã„ãŸã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ //============= // ViewModelå±¤ //============= // è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä»¥é™ã§ã¯ã€Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ module.exports = { /* propsã‚ªãƒ—ã‚·ãƒ§ãƒ³ ãƒ»è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¾ãŸã¯ajaxãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰propsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å€¤ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ */ props: { \"criteria\": { type: Object, required: true, }, \"foo\": { type: Object, required: true, } }, /* dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ ãƒ»ç•°ãªã‚‹å ´æ‰€ã«ã‚ã‚‹åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ç•°ãªã‚‹Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ãªã‚‹ã€‚ ãƒ»ç•°ãªã‚‹Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ç•°ãªã‚‹å€¤ã‚’æŒã¤å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚ */ data: function () { return { a: \"a\", b: \"b\", c: \"c\", d: \"d\", }; }, // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã€dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚»ãƒƒã‚¿ãƒ¼ method: { updateCriteria(key, value) { /* ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆv-foo-component-1ï¼‰ã¨ç´ä»˜ãå‡¦ç† ãƒ»changeã‚¤ãƒ™ãƒ³ãƒˆã®ç™ºç«ã¨ã€ã“ã‚Œã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã«å¼•æ•°ã‚’æ¸¡ã™ã€‚ */ this.$emit( \"change\", {\"criteria\": localCriteria} ); }, // ajaxãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ããŸãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ã€propsã‚’æ›´æ–° updateProps(key, value) { }, // ã€HTMLã§ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¿ã‚°åï¼šã€€JSã§ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåã€ component: { // å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨å­«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¯¾å¿œé–¢ä¿‚ \"v-foo-component-4\": require(\"./xxx/xxx/xxx-4\"), \"v-foo-component-5\": require(\"./xxx/xxx/xxx-5\"), }, } } (3) ã€Modelå±¤ã€‘ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã®Vuexï¼ˆstore.jsï¼‰ Vuexã«ã¤ã„ã¦ã¯ã€ä»¥é™ã®èª¬æ˜ã‚’å‚ç…§ã›ã‚ˆã€‚ (3-2) ã€Modelå±¤ã€‘ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã®JavaScriptï¼ˆxxx.jsï¼‰ ã‚¯ãƒ©ã‚¹å®£è¨€ã§å®Ÿè£…ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š class Foo { /* ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã€‚ ãƒ»ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å®£è¨€ã¨ã€åŒæ™‚ã«æ ¼ç´ã€‚ */ constructor(properties) { this.isOk = properties.isOk; } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã‚ˆã£ã¦å®£è¨€ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚ isOk() { // boolå€¤ã‚’è¿”å´ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ return this.isOk; } } 01-02. Viewå±¤ã¨ViewModelå±¤ã®é–“ã§ã®åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®æ–¹æ³• ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° ãƒ»v-on:ã¨ã¯ Viewå±¤ï¼ˆtemplateã‚¿ã‚°éƒ¨åˆ†ï¼‰ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã€ViewModelå±¤ï¼ˆscriptã‚¿ã‚°éƒ¨åˆ†ï¼‰ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ï¼ˆmethods:å†…ã«ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã‚„ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³JSã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã«ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã—ã€ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãŸæ™‚ç‚¹ã§ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®scriptã‚¿ã‚°éƒ¨åˆ†ï¼ˆViewModelå±¤ï¼‰ã®è¦ªå­é–“ãƒ‡ãƒ¼ã‚¿æ¸¡ã—ã§ã‚ã‚‹ã€Props Down, Events Upã€ã¨ã¯ç•°ãªã‚‹æ¦‚å¿µãªã®ã§æ³¨æ„ã™ã‚‹ã€‚ v-on:{ã‚¤ãƒ™ãƒ³ãƒˆå}=\"{ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ï¼ˆmethods: å†…ã«ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ï¼‰}\" ã¾ãŸã¯ã€çœç•¥ã—ã¦ã€ @:{ã‚¤ãƒ™ãƒ³ãƒˆå}=\"\" ã§è¨˜è¿°ã™ã‚‹ã€‚ ãƒ»v-on:submit=\"\"ã€buttonã‚¿ã‚° Viewå±¤ã®ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ããŸæ™‚ç‚¹ã§ã€ViewModelå±¤ã«ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ä¾‹ãˆã°ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ã€å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚ˆã£ã¦ç™ºç«ã•ã›ã‚‰ã‚Œã‚‹searchã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦ã€result()ã¨ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ç´ä»˜ã‘ã¦ãŠãã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š index.jsã®methods:å†…ã«ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã¨ã—ã¦result()ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ //ã€€Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”¨ã„ã‚‹divã‚¿ã‚°ã‚’è¨­å®š. el: \"#app\", // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•° method: { result() { // ä½•ã‚‰ã‹ã®å‡¦ç† } } }) ã€æ¤œç´¢ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã€ã¨ã„ã†submitã‚¤ãƒ™ãƒ³ãƒˆã®ç™ºç«ã«ã‚ˆã£ã¦ã€formã‚¿ã‚°ã§ã‚¤ãƒ™ãƒ³ãƒˆã«ç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ï¼ˆsearch()ï¼‰ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°å†…ã®emit()ãŒã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®searchã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«ã•ã›ã‚‹ã€‚ã“ã‚Œã«ç´ä»˜ãã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ï¼ˆresult()ï¼‰ ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¤œç´¢ã™ã‚‹ // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’å®šç¾© methods: { search() { // è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®searchã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«ã•ã›ã‚‹ã€‚ this.$emit(\"search\") }, } }) ãƒ»v-on:click=\"\" Viewå±¤ã§ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ããŸæ™‚ç‚¹ã§ç™ºç«ã—ã€ViewModelå±¤ã§ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ ãƒ»v-on:change=\"\" Viewå±¤ã§inputã‚¿ã‚°ã‚„selectã‚¿ã‚°ã§ã€å€¤ã®å…¥åŠ›å¾Œã«ãƒã‚¦ã‚¹ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒã‚¿ã‚°ã‹ã‚‰å¤–ã‚ŒãŸæ™‚ç‚¹ã§ç™ºç«ã—ã€ViewModelå±¤ã§ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ ãƒ»v-on:input=\"\" Viewå±¤ã§inputã‚¿ã‚°ã§ã€ä¸€æ–‡å­—ã§ã‚‚å€¤ãŒå…¥åŠ›ã•ã‚ŒãŸæ™‚ç‚¹ã§ç™ºç«ã—ã€ViewModelå±¤ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚v-on:changeã¨ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒç•°ãªã‚‹ãŸã‚ã€å…±å­˜ã§ãã‚‹ã€‚ æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° ãƒ»v-showï¼v-ifã¨ã¯ æ¡ä»¶åˆ†å²ã‚’è¡Œã†ã‚¿ã‚°ã§ã‚ã‚Šã€v-showã¾ãŸã¯v-ifã‚’ç”¨ã„ã¦ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚’æŒ‡å®šã™ã‚‹ã€‚ï¼ˆv-xxx=\"\"ï¼‰ã§è¨˜è¿°ã™ã‚‹ã€‚è¦ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰æ¸¡ã•ã‚ŒãŸpropså†…ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åãŒã‚‚ã¤å€¤ãŒTRUEã®æ™‚ã«è¡¨ç¤ºã—ã€FALSEã®æ™‚ã«éè¡¨ç¤ºã«ã™ã‚‹ã€‚ã‚‚ã—é »ç¹ã«è¡¨ç¤ºã¨éè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆã‚’è¡Œã†ã‚ˆã†ãªã‚‰ã€v-ifã®æ–¹ãŒã€æç”»ã‚³ã‚¹ãƒˆãŒé‡ãŸããªã‚‹ãƒªã‚¹ã‚¯ãŒé«˜ããªã‚‹ç‚ºã€v-showæ¨å¥¨ã§ã‚ã‚‹ã€‚ ã‚¿ã‚° ä½¿ã„åˆ†ã‘ v-if å˜ç™ºã®åˆ‡ã‚Šæ›¿ãˆãŒãƒ¡ã‚¤ãƒ³ã®å ´åˆ v-show è¡¨ç¤º/éè¡¨ç¤ºã®åˆ‡æ›¿å›æ•°ãŒå¤šã„å ´åˆ å±æ€§ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° ãƒ»v-bindã¨ã¯ â€»è¦å‹‰å¼· ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° ãƒ»v-modelã¨ã¯ å®Ÿè£…æ–¹æ³•ã¯ã€v-on:input=\"\"ã¨åŒã˜ã§ã‚ã‚‹ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®äºŒã¤ã¯åŒã˜ã§ã‚ã‚‹ã€‚ ãã®ä»–ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– ãƒ»v-cloakã¨ã¯ â€»è¦å‹‰å¼· 01-03. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç™»éŒ²æ–¹æ³• ãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«ç™»éŒ² ï¼Šå®Ÿè£…ä¾‹ï¼Š Vue.component(\"v-foo-component\", { template: require(\"./xxx/xxx/xxx\") }); // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ el: \"#app\" }) ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ç™»éŒ² ï¼Šå®Ÿè£…ä¾‹ï¼Š var vFooComponent = { // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¯¾å¿œé–¢ä¿‚ template: require(\"./xxx/xxx/xxx\"), }; // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ el: \"#app\", components: { // è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåã‚’ã¤ã‘ã‚‹ã€‚ \"v-foo-component\": vFooComponent } }) ãŸã ã—ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåã®å®šç¾©ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«çœç•¥ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ el: \"#app\", components: { // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¯¾å¿œé–¢ä¿‚ \"v-foo-component\": require(\"./xxx/xxx/xxx\"), } }) 02. Vue-Routerãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° Vue-Router ãƒ»Vue-Routerã¨ã¯ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸€ã¤ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å¯¾ã—ã¦ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã„ã€//ã«å¿œã˜ã¦ã€ã‚³ãƒ¼ãƒ«ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å‹•çš„ã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ã€‚ GET http://www.example.co.jp:80//?text1=a&text2=b HTTP/2 ï¼Šå®Ÿè£…ä¾‹ï¼Š // Vue-Routerãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã‚€ã€‚ const vueRouter = require(\"vue-router\").default; // VueRouterã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ const router = new VueRouter({ routes: [ {path: \"/\", component: Home}, {path: \"/foo\", component: Foo} ] }) // å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒã€VueRouterã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’èª­ã¿è¾¼ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã€‚ module.exports = router; ã¾ãŸã€Vue-Routerã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ã€routerã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ³¨å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ import router from \"./router\" // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ // routerã‚ªãƒ—ã‚·ãƒ§ãƒ³ router, // watchã‚ªãƒ—ã‚·ãƒ§ãƒ³ watch: { // ã‚¹ã‚¿ãƒƒã‚¯å†…ã§å±¥æ­´ã®ç§»å‹•ãŒèµ·ã“ã£ãŸæ™‚ã«ã€å¯¾å¿œä»˜ã‘ãŸç„¡åé–¢æ•°ã‚’å®Ÿè¡Œã€‚ \"$route\": function (to, from) { if (to.fullPath !== from.fullPath) { // ä½•ã‚‰ã‹ã®å‡¦ç†ã€‚ } }, } }) ãƒ»$routerï¼ˆRouterã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼‰ Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã«1ã¤å­˜åœ¨ã—ã€å…¨ä½“çš„ãªRouteræ©Ÿèƒ½ã‚’ç®¡ç†ã—ã¦ã„ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã€‚ã‚¹ã‚¿ãƒƒã‚¯å‹ã§å±¥æ­´ã‚’ä¿æŒã—ã€å±¥æ­´ã‚’è¡Œãæ¥ã™ã‚‹ã“ã¨ã§ã€ãƒšãƒ¼ã‚¸é·ç§»ã‚’è¡Œã†ã€‚ ãƒ¡ã‚½ãƒƒãƒ‰ èª¬æ˜ push queryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¼•æ•°ã¨ã™ã‚‹ã€‚å±¥æ­´ã‚¹ã‚¿ãƒƒã‚¯å†…ã«æ–°ã—ã„å±¥æ­´ã‚’è¿½åŠ ã—ã€ç¾åœ¨ã‚’ãã®å±¥æ­´ã¨ã™ã‚‹ã€‚ã¾ãŸã€ãƒ–ãƒ©ã‚¦ã‚¶ã®æˆ»ã‚‹æ“ä½œã§ã€å±¥æ­´ã‚¹ã‚¿ãƒƒã‚¯å†…ã®ä¸€ã¤å‰ã®å±¥æ­´ã«ç§»å‹•ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://router.vuejs.org/guide/essentials/navigation.html ï¼Šå®Ÿè£…ä¾‹ï¼Š // users/?foo=xyz ãŒå±¥æ­´ã‚¹ã‚¿ãƒƒã‚¯ã«è¿½åŠ ã•ã‚Œã‚‹ã€‚ this.$router.push({ path : \"/users\", query: { foo : \"xyz\" }}); ãƒ»$routeï¼ˆRouteã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ ç¾åœ¨ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ«ãƒ¼ãƒˆã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ ãƒ‡ãƒ¼ã‚¿å‹ èª¬æ˜ æ³¨æ„ path string ç¾åœ¨ã®ãƒ«ãƒ¼ãƒˆã®æ–‡å­—åˆ—ã€‚ query Object ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚­ãƒ¼åã¨å€¤ã‚’ä¿æŒã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚/foo?user=1ã¨ã„ã†ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å ´åˆã€$route.query.user==1ã¨ãªã‚‹ã€‚ ã‚‚ã—ã‚¯ã‚¨ãƒªãƒ¼ãŒãªã„å ´åˆã¯ã€ç©ºã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ fullPath string URLå…¨ä½“ã®æ–‡å­—åˆ—ã€‚ ãã®ä»–ã®Routerãƒ©ã‚¤ãƒ–ãƒ©ãƒª JQueryã«ã¯JQueryRouterã€Reactã«ã¯React-RouterãŒã‚ã‚‹ã€‚ 03. Vuexãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ã®çŠ¶æ…‹å¤‰åŒ–ã®ç®¡ç† Vuex ãƒ»Vuexã¨ã¯ Vuejsã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸€ã¤ã§ã€MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ¢ãƒ‡ãƒ«ã«ç›¸å½“ã™ã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã§å‚ç…§ã§ãã‚‹ã€‚ç•°ãªã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å…±é€šã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã„ãŸãã¨ã‚‚ã€åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã§ã¯ã€è¦ªå­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§ã—ã‹ã€ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘æ¸¡ã—ã§ããªã„ã€‚ã—ã‹ã—ã€Vuexã‚¹ãƒˆã‚¢å†…ã§ã€ãƒ‡ãƒ¼ã‚¿ã®çŠ¶æ…‹ã®å¤‰åŒ–ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€è¦ªå­é–¢ä¿‚ãªãã€å…¨ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘æ¸¡ã—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ â€»Vuexã‹ã‚‰ãªã‚‹ãƒ¢ãƒ‡ãƒ«ã¯ã©ã†ã‚ã‚‹ã¹ãã‹ã€ã«ã¤ã„ã¦è¦å‹‰å¼· Vuex.Store()ã«ã‚ˆã‚‹Vuexã‚¹ãƒˆã‚¢ã®å®Ÿè£… å¤–éƒ¨ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€å„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚ ãƒ»getters:{} ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰çŠ¶æ…‹ã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã„ãã¤ã‹æŒã¤ã€‚ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ã„ã†ã¨ã“ã‚ã®ã€Getterãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“ã™ã‚‹ã€‚ â€»MVVMã«ãŠã„ã¦ã€ãƒ¢ãƒ‡ãƒ«ã«ã‚²ãƒƒã‚¿ãƒ¼ã‚’æŒãŸã›ã¦ã¯ã„ã‘ãªã„ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã«ã¤ã„ã¦ã¯ã€è¦å‹‰å¼·ã€‚ ãƒ»state:{} ãƒ‡ãƒ¼ã‚¿ã®çŠ¶æ…‹ã®å¤‰åŒ–ã‚’ã„ãã¤ã‹ç®¡ç†ã™ã‚‹ã€‚ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ã„ã†ã¨ã“ã‚ã®ã€ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰ã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»mutations:{} ãƒ‡ãƒ¼ã‚¿ã«çŠ¶æ…‹ï¼ˆstateï¼‰ã‚’è¨­å®šã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã„ãã¤ã‹æŒã¤ã€‚ä¿å®ˆæ€§ã®è¦³ç‚¹ã‹ã‚‰ã€mutations:{}ã«ãŠããƒ¡ã‚½ãƒƒãƒ‰é–“ã¯åŒæœŸçš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ãŠã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ã„ã†ã¨ã“ã‚ã®ã€Setterãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»actions:{} å®šç¾©ã•ã‚ŒãŸmutations{}ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é–“æ¥çš„ã«ã‚³ãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã„ãã¤ã‹æŒã¤ã€‚ã¾ãŸã€JQueryã®ajaxãƒ¡ã‚½ãƒƒãƒ‰ ã‚’ã‚³ãƒ¼ãƒ«ã—ã€ã‚µãƒ¼ãƒãƒ¼å´ã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’mutations:{}ã¸æ¸¡ã™ã€‚ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ã„ã†ã¨ã“ã‚ã®ã€Setterãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // Vuexãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã‚€ã€‚ const vuex = require(\"vuex\") // å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒã€ã“ã®Storeã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’èª­ã¿è¾¼ã‚ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ module.exports = new Vuex.Store({ /* getters ãƒ»ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰çŠ¶æ…‹ã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã„ãã¤ã‹æŒã¤ ãƒ»ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®Getterãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“. */ getters: { staffData(state) { return state.staffData; }, }, /* state ãƒ»çŠ¶æ…‹ã®å¤‰åŒ–ã‚’ç®¡ç†ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’ã„ãã¤ã‹ã‚‚ã¤ã€‚ ãƒ»ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ç›¸å½“ã€‚ */ state: { // stateã«ã¯å¤šãã‚’è¨­å®šã›ãšã€Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¨­å®šã—ã¦ãŠãã€‚ staffData: [], }, /* mutations ãƒ»ãƒ‡ãƒ¼ã‚¿ã®çŠ¶æ…‹ï¼ˆstateï¼‰ã‚’å¤‰åŒ–ã•ã›ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã„ãã¤ã‹ã‚‚ã¤ã€‚ ãƒ»ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®Setterãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“ã€‚ */ mutations: { // Vuexã®stateã‚’ç¬¬ä¸€å¼•æ•°ã€å¤–éƒ¨ã‹ã‚‰ã‚»ãƒƒãƒˆã—ãŸã„å€¤ã‚’ç¬¬äºŒå¼•æ•° mutate(state, staffData) { exArray.forEach( /* ãƒ»çŸ¢å°ã¯ã‚¢ãƒ­ãƒ¼é–¢æ•°ã‚’è¡¨ã—ã€ç„¡åé–¢æ•°ã®å³ã‚³ãƒ¼ãƒ«ã‚’çœç•¥ã§ãã‚‹ã€‚ ãƒ»å¼•æ•°ã§æ¸¡ã•ã‚ŒãŸexArrayã®è¦ç´ ã‚’ã€stateã®exArrayã«æ ¼ç´ã™ã‚‹ã€‚ */ (element) => { state.exArray.push(element); } /* â€»ã‚¢ãƒ­ãƒ¼é–¢æ•°ã‚’ç”¨ã„ãªã‘ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã§ãã‚‹ã€‚ function(element) { state.exArray.push(element); } */ ); }, }, /* actions ãƒ»mutations{}ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é–“æ¥çš„ã«ã‚³ãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã„ãã¤ã‹æŒã¤ã€‚ ãƒ»contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰commitæ©Ÿèƒ½ã‚’å–ã‚Šå‡ºã™å¿…è¦ãŒã‚ã‚‹ã€‚ï¼ˆâ€»çœç•¥è¨˜æ³•ã‚ã‚Šï¼‰ ãƒ»ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®Setterãƒ¡ã‚½ãƒƒãƒ‰ã«ç›¸å½“ã€‚ */ actions: { // çœç•¥è¨˜æ³•ï¼ˆArgument destructuring) mutate({commit}) { commit(\"mutate\"); } } }) ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰Vuexã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ ä¾‹ãˆã°ã€å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆtemplateã‚¿ã‚°ã‚’æŒã¤ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®ä¸‹éƒ¨ã«ã€ä»¥ä¸‹ã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ã§ã€Vuex.Store()ã¨ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘æ¸¡ã—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ãƒ»computed: {} ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã¨ã—ã¦ã€mapGettersãƒ˜ãƒ«ãƒ‘ãƒ¼ã¨mapStateãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»methods: {} ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã¨ã—ã¦ã€mapMutationsãƒ˜ãƒ«ãƒ‘ãƒ¼ã¨mapActionsãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»mapGettersãƒ˜ãƒ«ãƒ‘ãƒ¼ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®computed:{}ã«ã€Vuex.Store()ã®getters: {}ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»mapStateãƒ˜ãƒ«ãƒ‘ãƒ¼ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®computed:{}ã«ã€Vuex.Store()ã®state: {}ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»mapMutationsãƒ˜ãƒ«ãƒ‘ãƒ¼ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®methods: {}ã«ã€Vuex.Store()ã®mutations: {}```ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»mapActionsãƒ˜ãƒ«ãƒ‘ãƒ¼ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®methods: {}ã«ã€Vuex.Store()ã®actions:{}ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ... // Vuex.Store()ã‚’èª­ã¿è¾¼ã‚€ã€‚ const store = require(\"./_store\") // Vuex.Store()ã®gettersã€mutationsã€actionsã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã§ãã‚‹ã‚ˆã†ã«èª­ã¿è¾¼ã‚€ã€‚ const mapGetters = require(\"vuex\").mapGetters; const mapActions = require(\"vuex\").mapActions; const mapMutaions = require(\"vuex\").mapMutaions; module.exports = { // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’å®šç¾©ï¼ˆâ€»ãƒ‡ãƒ¼ã‚¿ã‚’çŠ¶æ…‹ã®å¤‰æ›´ã‚’ä¿æŒã—ãŸããªã„ã‚‚ã®ï¼‰ computed: { /* mapGettersãƒ˜ãƒ«ãƒ‘ãƒ¼ã€‚ Storeã®Getterã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã®computed:{}ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã€‚ */ ...mapGetters([ \"x-Function\" ]) }, // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’å®šç¾©ï¼ˆâ€»ãƒ‡ãƒ¼ã‚¿ã‚’çŠ¶æ…‹ã®å¤‰æ›´ã‚’ä¿æŒã—ãŸã„ã‚‚ã®ï¼‰ methods: { // mapMutationsãƒ˜ãƒ«ãƒ‘ãƒ¼ ...mapMutations([ \"y-Function\" ]), // mapActionsãƒ˜ãƒ«ãƒ‘ãƒ¼ ...mapActions([ \"z-Function\" ]), } } 04. ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ ãƒ»ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ã¨ã¯ Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆã‹ã‚‰ç ´æ£„ã¾ã§ã®é–“ã«å®Ÿè¡Œã•ã‚Œã‚‹é–¢æ•°ã®ã“ã¨ã€‚å…¨ã¦ã®é–¢æ•°ã‚’ç”¨ã„ã‚‹å¿…è¦ã¯ãªã„ã€‚ å‚è€ƒï¼šhttps://jp.vuejs.org/v2/api/index.html#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%83%A9%E3%82%A4%E3%83%95%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB%E3%83%95%E3%83%83%E3%82%AF é †ç•ª ãƒ•ãƒƒã‚¯å ã‚¿ã‚¤ãƒŸãƒ³ã‚° 1 beforeCreate Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆå‰ 2 created Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆå¾Œ 3 beforeMount Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹å‰ 4 mounted Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚ŒãŸå¾Œ 5 beforeUpdate ãƒ‡ãƒ¼ã‚¿æ›´æ–°æ™‚ã®å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å‰ 6 updated ãƒ‡ãƒ¼ã‚¿æ›´æ–°æ™‚ã®å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å¾Œ 7 beforeDestroy Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå‰Šé™¤ã•ã‚Œã‚‹å‰ï¼ˆ$destroyãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œå‰ï¼‰ 8 destroyed Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå‰Šé™¤ã•ã‚ŒãŸå¾Œï¼ˆ$destroyãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œå¾Œï¼‰ ãƒ»ãƒã‚¦ãƒ³ãƒˆã¨ã¯ ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã®ãƒªã‚¢ãƒ«DOMã®è¦ç´ ã‚’ã€Vue.jsã®å‡¦ç†ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ä»®æƒ³DOMã®è¦ç´ ã§ç½®ãæ›ãˆã‚‹ã“ã¨ã€‚ å‚è€ƒï¼šhttps://jp.vuejs.org/v2/guide/render-function.html#%E3%83%8E%E3%83%BC%E3%83%89%E3%80%81%E3%83%84%E3%83%AA%E3%83%BC%E3%80%81%E3%81%8A%E3%82%88%E3%81%B3%E4%BB%AE%E6%83%B3-DOM ãƒ»beforeCreate Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆå‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼Šæ¤œè¨¼ä¾‹ï¼Š beforeCreateãƒ•ãƒƒã‚¯ã®å‹•ä½œã‚’æ¤œè¨¼ã™ã‚‹ã€‚dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆå¾Œã«æœ‰åŠ¹ã«ãªã‚‹ãŸã‚ã€beforeCreateãƒ•ãƒƒã‚¯ã§ã‚³ãƒ¼ãƒ«ã§ããšã€undefinedã«ãªã‚‹ã€‚ {{ name }} new Vue({ data(){ return{ hoge:\"Hiroki\" } }, beforeCreate () { console.log(this.name) } } # çµæœ undefined ãƒ»created ãƒ•ãƒƒã‚¯ã®ä¸­ã§ç‰¹ã«ã‚ˆãä½¿ã†ã€‚Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆå¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãƒã‚¦ãƒ³ãƒˆå‰ã«å¿…è¦ãªå‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š éåŒæœŸé€šä¿¡ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã€ãƒã‚¦ãƒ³ãƒˆæ™‚ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ã€ãªã© ï¼Šæ¤œè¨¼ä¾‹ï¼Š createdãƒ•ãƒƒã‚¯ã®å‹•ä½œã‚’æ¤œè¨¼ã™ã‚‹ã€‚dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆå¾Œã«è¨­å®šã•ã‚Œã‚‹ãŸã‚ã€createdãƒ•ãƒƒã‚¯ã§ã‚³ãƒ¼ãƒ«ã§ãã€å‡¦ç†çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ {{ name }} // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ data() { return{ name:\"Hiroki\" } }, created() { console.log(this.name) } } # çµæœ \"Hiroki\" ãƒ»beforeMount Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼Šæ¤œè¨¼ä¾‹ï¼Š beforeMountãƒ•ãƒƒã‚¯ã®å‹•ä½œã‚’æ¤œè¨¼ã™ã‚‹ã€‚dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰nameå¤‰æ•°ã¸ã®å±•é–‹ã¯ã€ãƒã‚¦ãƒ³ãƒˆã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€beforeMountãƒ•ãƒƒã‚¯ã®æ®µéšã§ã¯è¦ç´ è‡ªä½“ãŒç”Ÿæˆã•ã‚Œã¦ãŠã‚‰ãšã€ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ã€‚ {{ name }} // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ data() { return{ name: \"\" } }, beforeMount() { this.name = \"Hiroki\" } } # çµæœ è¦ç´ ãŒç”Ÿæˆã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ã€‚ ãƒ»mounted ãƒ•ãƒƒã‚¯ã®ä¸­ã§ç‰¹ã«ã‚ˆãä½¿ã†ã€‚Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚ŒãŸå¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚è¦ç´ ã‚’æ“ä½œã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚ã¾ãšã€Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«elã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’è­˜åˆ¥ã—ã€ã“ã‚Œã«å¿œã˜ã¦å‡¦ç†ã®æµã‚ŒãŒåˆ†å²ã™ã‚‹ã€‚SSRã®å ´åˆã«ã¯ä½¿ç”¨ã§ããªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Vue.jsä»¥å¤–ã®å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã€æ¤œç´¢å®Ÿè¡Œæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã€ãƒšãƒ¼ã‚¸ãƒ³ã‚°å®Ÿè¡Œæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã€ãªã© ï¼Šæ¤œè¨¼ä¾‹ï¼Š beforeMountãƒ•ãƒƒã‚¯ã®å‹•ä½œã‚’æ¤œè¨¼ã™ã‚‹ã€‚dataã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰nameå¤‰æ•°ã¸ã®å±•é–‹ã¯ã€elementã¸ã®ãƒã‚¦ãƒ³ãƒˆä¸­ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€mountedãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã€ç©ºæ–‡å­—ãŒä¸Šæ›¸ãã•ã‚Œã‚‹ã€‚ {{ name }} // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ data() { return{ name: \"\" } }, mounted() { this.name = \"Hiroki\" } } # çµæœ \"Hiroki\" ãŸã ã—ã€å…¨ã¦ã®å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒã‚¦ãƒ³ãƒˆãŒå®Œäº†ã—ãŸã“ã¨ã‚’å¾…ã¤ãŸã‚ã«ã€nextTickãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ {{ name }} // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ data() { return{ name: \"\" } }, mounted() { this.$nextTick(function () { this.name = \"Hiroki\" }) } } ãƒ»beforeUpdate ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã‚‹æ™‚ã®å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å‰ã«è¦ç´ ã‚’æ“ä½œã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Windowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„Documentã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹è¦ç´ ã®å–å¾—ã€ãªã© ï¼Šæ¤œè¨¼ä¾‹ï¼Š {{ name }} // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ data() { return{ name: \"\" } }, mounted() { this.$nextTick(function () { this.name = \"Hiroki\" }) }, beforeUpdate(){ console.log(this.name) } } # çµæœ \"Hiroki\" ãƒ»updated ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã‚‹æ™‚ã®å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å¾Œã«è¦ç´ ã‚’æ“ä½œã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚ {{ name }} // å¤‰æ•°ã¸ã®æ ¼ç´ã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ var vm = new Vue({ data() { return{ name: \"\" } }, mounted() { this.$nextTick(function () { this.name = \"Hiroki\" }) }, beforeUpdate(){ console.log(this.name) } } # çµæœ \"Hiroki\" ãƒ»beforeDestroy Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå‰Šé™¤ã•ã‚Œã‚‹å‰ã«å®Ÿè¡Œã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å‰Šé™¤ã™ã‚‹å‰ã«ç„¡åŠ¹åŒ–ã—ã¦ãŠãå¿…è¦ã®ã‚ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚SSRã®å ´åˆã«ã¯ä½¿ç”¨ã§ããªã„ã€‚ ãƒ»destroyed Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå‰Šé™¤ã•ã‚ŒãŸå¾Œã«å®Ÿè¡Œã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å‰Šé™¤ã—ãŸå¾Œã®TearDownå‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚SSRã®å ´åˆã«ã¯ä½¿ç”¨ã§ããªã„ã€‚ "},"public/software/software_application_object_oriented_language_js_framework_nuxtjs.html":{"url":"public/software/software_application_object_oriented_language_js_framework_nuxtjs.html","title":"ğŸ“– ï¸Nuxt.js","keywords":"","body":"Nuxt.js ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒãƒ³ãƒ‰ serverãƒ¢ãƒ¼ãƒ‰ ãƒ»serverãƒ¢ãƒ¼ãƒ‰ã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’SSRã¨ã—ã¦ç¨¼åƒã•ã›ã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.nuxtjs.org/docs/2.x/get-started/commands#target-server ãƒ»dev ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã¨ã—ã¦ç”¨ã„ã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ“ãƒ«ãƒ‰ã—ã€Nodeã‚µãƒ¼ãƒã‚’èµ·å‹•ã™ã‚‹ã€‚Webpackã¯ä½¿ç”¨ã•ã‚Œãªã„ãŸã‚ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®åœ§ç¸®ã‚„ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã®ãƒãƒƒã‚·ãƒ¥åŒ–ã¯å®Ÿè¡Œã•ã‚Œãªã„ã€‚ $ nuxt dev ãƒ»build æœ¬ç•ªç’°å¢ƒã¨ã—ã¦ç”¨ã„ã‚‹ãŸã‚ã€Nodeã‚µãƒ¼ãƒã®èµ·å‹•å‰ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚devã‚³ãƒãƒ³ãƒ‰ã¨ã¯ç•°ãªã‚Šã€ãƒ“ãƒ«ãƒ‰æ™‚ã«Webpackã«ã‚ˆã‚‹æœ€é©åŒ–ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€JavaScriptã¨CSSã¯minifyã•ã‚Œã‚‹ã€‚minifyã«ã‚ˆã‚Šã€ä¸è¦ãªæ”¹è¡Œã‚„ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒå‰Šé™¤ã•ã‚Œã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿URLã¯ã¾ã¨ã‚ã‚‰ã‚Œã€åœ§ç¸®ã•ã‚Œã‚‹ã€‚ç”»åƒåã¯ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚Œã‚‹ã€‚ $ nuxt build ãƒ»start æœ¬ç•ªç’°å¢ƒã¨ã—ã¦ç”¨ã„ã‚‹ãŸã‚ã€ãƒ“ãƒ«ãƒ‰å®Œäº†å¾Œã«Nodeã‚µãƒ¼ãƒã‚’èµ·å‹•ã™ã‚‹ã€‚SSRãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ $ nuxt start staticãƒ¢ãƒ¼ãƒ‰ ãƒ»staticãƒ¢ãƒ¼ãƒ‰ã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’SSGã¨ã—ã¦ç¨¼åƒã•ã›ã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.nuxtjs.org/docs/2.x/get-started/commands#target-static ãƒ»dev ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã¨ã—ã¦ç”¨ã„ã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ“ãƒ«ãƒ‰ã—ã€Nodeã‚µãƒ¼ãƒã‚’èµ·å‹•ã™ã‚‹ã€‚Webpackã¯ä½¿ç”¨ã•ã‚Œãªã„ãŸã‚ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®åœ§ç¸®ã‚„ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã®ãƒãƒƒã‚·ãƒ¥åŒ–ã¯å®Ÿè¡Œã•ã‚Œãªã„ã€‚ $ nuxt dev ãƒ»build Node.jsã‚’ç”¨ã„ã¦ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å‹•ã‹ã™ãŸã‚ã«ç”¨ã„ã‚‹ã€‚devã‚³ãƒãƒ³ãƒ‰ã¨ã¯ç•°ãªã‚Šã€ãƒ“ãƒ«ãƒ‰æ™‚ã«Webpackã«ã‚ˆã‚‹æœ€é©åŒ–ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€JavaScriptã¨CSSã¯minifyã•ã‚Œã‚‹ã€‚minifyã«ã‚ˆã‚Šã€ä¸è¦ãªæ”¹è¡Œã‚„ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒå‰Šé™¤ã•ã‚Œã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿URLã¯ã¾ã¨ã‚ã‚‰ã‚Œã€åœ§ç¸®ã•ã‚Œã‚‹ã€‚ç”»åƒåã¯ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚Œã‚‹ã€‚ $ nuxt build ãƒ»generate JavaScriptã‹ã‚‰é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ã€‚ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«æ¥ç¶šã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ ¼ç´ã—ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆä¾‹ï¼šç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼‰ã‚’å…ƒã«ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚SSGãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ $ nuxt generate ãƒ»start é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚µã‚¤ãƒˆã‚’èµ·å‹•ã™ã‚‹ã€‚ $ nuxt start ãƒ“ãƒ«ãƒ‰æ™‚ã®Webpackã‚ªãƒ—ã‚·ãƒ§ãƒ³ serverãƒ¢ãƒ¼ãƒ‰ã¨staticãƒ¢ãƒ¼ãƒ‰ã«ãŠã„ã¦ã€buildã‚³ãƒãƒ³ãƒ‰æ™‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹Webpackã®æœ€é©åŒ–æ–¹æ³•ã‚’æŒ‡å®šã§ãã‚‹ã€‚` https://ja.nuxtjs.org/docs/2.x/get-started/commands#webpack-%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E6%A4%9C%E6%9F%BB 02. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ nuxt.config.jsãƒ•ã‚¡ã‚¤ãƒ« ãƒ»nuxt.config.jsãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ NuxtãŒæ¨™æº–ã§ç”¨æ„ã—ã¦ã„ã‚‹è¨­å®šã‚’ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¨­å®šå€¤ã§ä¸Šæ›¸ãã§ãã‚‹ã€‚å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://ja.nuxtjs.org/docs/2.x/directory-structure/nuxt-config#nuxtconfigjs import { Configuration } from '@nuxt/types' const nuxtConfig: Configuration = { // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ } ãƒ».envãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ ã‚ã‚‰ã‹ã˜ã‚ã€dotenvãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚process.envã‹ã‚‰.envãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ•°ã‚’å‚ç…§ã™ã‚‹ã€‚å®šæ•°ã«ä»£å…¥ã™ã‚‹å ´åˆã¯ã€ã¾ã¨ã‚ã¦ä»£å…¥ã™ã‚‹ã¨ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://levelup.gitconnected.com/what-are-env-files-and-how-to-use-them-in-nuxt-7f194f083e3d $ npm install @nuxtjs/dotenv # APIã®URLã€‚ã‚µãƒ¼ãƒä¸Šã®JavaScriptã‹ã‚‰APIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ç”¨ã„ã‚‹ã€‚ API_URL=https://example.co.jp/api # APIã®URLã€‚ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã®JavaScriptã‹ã‚‰APIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ç”¨ã„ã‚‹ã€‚ API_URL_BROWSER=https://example.co.jp/api # APIã®Oauthèªè¨¼ã®æƒ…å ± OAUTH_CLIENT_ID= OAUTH_CLIENT_SECRET= # GoogleMapã®URL GOOGLE_MAP_QUERY_URL=https://www.google.com/maps/search/?api=1&query= # ãƒ›ãƒ¼ãƒ ãƒ‘ã‚¹ HOME_PATH=/ import { Configuration } from '@nuxt/types' const { API_URL, API_URL_BROWSER, OAUTH_CLIENT_ID, OAUTH_CLIENT_SECRET, HOME_PATH } = process.env const nuxtConfig: Configuration = { // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ } ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§ ãƒ»hardSource ãƒ“ãƒ«ãƒ‰æ™‚ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ãƒ“ãƒ«ãƒ‰ã®å®Œäº†ãŒæ—©ããªã‚‹ã€‚ å‚è€ƒï¼šhttps://nuxtjs.org/docs/2.x/configuration-glossary/configuration-build#hardsource import { Configuration } from '@nuxt/types' const nuxtConfig: Configuration = { build: { hardSource: true, }, } ãƒ»privateRuntimeConfig SSRãƒ¢ãƒ¼ãƒ‰ã§ã®ã¿ä½¿ç”¨ã§ãã‚‹ç’°å¢ƒå¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã¯ã€pagesã€storeã€componentsã€pluginãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ä½¿ç”¨ã§ãã‚‹ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®JavaScriptã‚½ãƒ¼ã‚¹ã‚¿ãƒ–ã§å…¬é–‹ã•ã‚Œã¦ã—ã¾ã†ãŸã‚ã€æ©Ÿå¯†ãªå€¤ã¯è¨­å®šã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚‚ã—publicRuntimeConfigã§åŒã˜åå‰ã®å¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ãŸå ´åˆã¯ã€ã“ã®å€¤ã‚’ä¸Šæ›¸ãã™ã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã¯ã€contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®configå¤‰æ•°ã‹ã‚‰å–å¾—ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://nuxtjs.org/docs/directory-structure/nuxt-config/#privateruntimeconfig https://blog.mktia.com/dotenv-is-no-longer-need-in-nuxt/ import { Configuration } from '@nuxt/types' const { API_KEY, } = process.env const nuxtConfig: Configuration = { privateRuntimeConfig: { apiKey: API_KEY, }, } # .envãƒ•ã‚¡ã‚¤ãƒ« API_KEY=***** export function foo() { // contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®$configãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’åˆ†å‰²ä»£å…¥ const { $config } = useContext() $config.apiKey } ãƒ»publicRuntimeConfig SPAãƒ¢ãƒ¼ãƒ‰ã¾ãŸã¯SSRãƒ¢ãƒ¼ãƒ‰ã§ä½¿ç”¨ã§ãã‚‹ç’°å¢ƒå¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã¯ã€pagesã€storeã€componentsã€pluginãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ä½¿ç”¨ã§ãã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã¯ã€contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®configå¤‰æ•°ã‹ã‚‰å–å¾—ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://nuxtjs.org/docs/directory-structure/nuxt-config/#publicruntimeconfig https://blog.mktia.com/dotenv-is-no-longer-need-in-nuxt/ import { Configuration } from '@nuxt/types' const { API_URL, } = process.env const nuxtConfig: Configuration = { publicRuntimeConfig: { apiUrl: API_URL }, } # .envãƒ•ã‚¡ã‚¤ãƒ« API_URL=https://example.co.jp/api export function foo() { // contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®$configãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’åˆ†å‰²ä»£å…¥ const { $config } = useContext() $config.apiUrl } ãƒ»quiet ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒ­ã‚°ã‚’æœ€å°é™ã«ã™ã‚‹ã€‚CICDãƒ„ãƒ¼ãƒ«ã§ãƒ­ã‚°ãŒç¢ºèªã§ããªããªã‚‹ãŸã‚ã€ç„¡åŠ¹åŒ–ã—ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã„ã€‚ å‚è€ƒï¼šhttps://ja.nuxtjs.org/docs/2.x/configuration-glossary/configuration-build#quiet import { Configuration } from '@nuxt/types' const nuxtConfig: Configuration = { build: { quiet: false, }, } ãƒ»serverMiddleware ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã§ãã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã€ç´ä»˜ã‘ã‚‹ãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://nuxtjs.org/docs/configuration-glossary/configuration-servermiddleware/ import { Configuration } from '@nuxt/types' const nuxtConfig: Configuration = { serverMiddleware: [ { path: '/foos', handler: '~/foos/index.js' }, ] } 03. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª distï¼šdistribution staticãƒ¢ãƒ¼ãƒ‰ã®generateã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œæ™‚ã«ã€ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆãŒé…ç½®ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://nuxtjs.org/ja/docs/directory-structure/dist module å‚è€ƒï¼šhttps://nuxtjs.org/docs/directory-structure/modules plugin å‚è€ƒï¼š https://nuxtjs.org/docs/directory-structure/plugins/ https://github.com/nuxt/nuxt.js/issues/2820 "},"public/software/software_application_object_oriented_language_js_debug.html":{"url":"public/software/software_application_object_oriented_language_js_debug.html","title":"ğŸ“– ï¸ãƒ‡ãƒãƒƒã‚°","keywords":"","body":"ãƒ‡ãƒãƒƒã‚°ã®è±†çŸ¥è­˜ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. JavaScript ãƒ‡ãƒãƒƒã‚°ã«ä½¿ãˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»Console API ãƒ¡ã‚½ãƒƒãƒ‰å å‡ºåŠ›å†…å®¹ console.clearãƒ¡ã‚½ãƒƒãƒ‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‚’ã‚¯ãƒªã‚¢ã«ã™ã‚‹ console.countãƒ¡ã‚½ãƒƒãƒ‰ å®Ÿè¡Œã™ã‚‹åº¦ã«ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ã—ã¦å›æ•°ã‚’å‡ºåŠ›ã™ã‚‹ console.dirãƒ¡ã‚½ãƒƒãƒ‰ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæŒã¤ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ä¸€è¦§ã‚’ãƒªã‚¹ãƒˆã§å‡ºåŠ›ã™ã‚‹ console.errorãƒ¡ã‚½ãƒƒãƒ‰ ã‚¨ãƒ©ãƒ¼æƒ…å ±ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ï¼ˆä»–ã«ã€info() / warn()ã‚‚ã‚ã‚Šï¼‰ console.groupãƒ¡ã‚½ãƒƒãƒ‰ ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ä»˜ã‘ã¦å‡ºåŠ›ã™ã‚‹ã“ã¨ã§éšå±¤æ§‹é€ ã‚’æŒãŸã›ã‚‹ï¼ˆgroupEnd()ã§çµ‚äº†ã™ã‚‹ï¼‰ console.logãƒ¡ã‚½ãƒƒãƒ‰ ä»»æ„ã®å€¤ã‚’å‡ºåŠ›ã™ã‚‹ console.tableãƒ¡ã‚½ãƒƒãƒ‰ é…åˆ—ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã©ã®æ§‹é€ ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ã«ã—ã¦å‡ºåŠ›ã™ã‚‹ console.timeãƒ¡ã‚½ãƒƒãƒ‰ time()ã€œtimeEnd()ã¾ã§ã®é–“ã«ã‚ã‚‹å‡¦ç†ã‚’è¨ˆæ¸¬ã™ã‚‹ console.traceãƒ¡ã‚½ãƒƒãƒ‰ å‘¼ã³å‡ºã—å…ƒã‚’å‡ºåŠ›ã™ã‚‹ã€‚ "},"public/software/software_application_object_oriented_language_js_browser_rendering.html":{"url":"public/software/software_application_object_oriented_language_js_browser_rendering.html","title":"ğŸ“– ï¸ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°","keywords":"","body":"ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä»•çµ„ã¿ æ§‹æˆã™ã‚‹å‡¦ç† ä»¥ä¸‹ã®8ã¤ã®å‡¦ç†ã‹ã‚‰ãªã‚‹ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æ“ä½œã®ãŸã³ã«ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã€Scriptingãƒ—ãƒ­ã‚»ã‚¹ãŒç¹°ã‚Šè¿”ã—å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ Downloading Parse Scripting Rendering CalculateStyle Paint Rasterize Composite 01-02. ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èª ãƒ»ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã¨ã¯ ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŒèª­ã¿è¾¼ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã€‚ã“ã®ã†ã¡ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¿ã‚°ã¨ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã£ã¦æ§‹é€ çš„ã«è¡¨ç¾ã—ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŒèª­ã¿è¾¼ã‚ã‚‹çŠ¶æ…‹ã™ã‚‹è¨€èªã®ã“ã¨ã€‚ ãƒ»ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã®æ­´å² Webãƒšãƒ¼ã‚¸ã‚’ãƒ†ã‚­ã‚¹ãƒˆã«ã‚ˆã£ã¦æ§‹æˆã™ã‚‹ãŸã‚ã®è¨€èªã‚’ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã¨ã„ã†ã€‚1970å¹´ã€IBMãŒã€ã‚¿ã‚°ã«ã‚ˆã£ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆæ–‡ç« ã«æ§‹é€ ã‚„æ„å‘³ã‚’æŒãŸã›ã‚‹GMLè¨€èªã‚’ç™ºè¡¨ã—ãŸã€‚ XMLå½¢å¼ï¼šExtensible Markup Language ãƒ»XMLå½¢å¼ã¨ã¯ ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã†ã¡ã€ä½•ã‚‰ã‹ã®ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’è¡¨ç¾ã™ã‚‹ã“ã¨ã«ç‰¹åŒ–ã—ã¦ã„ã‚‹ã€‚ ãƒ»ã‚¹ã‚­ãƒ¼ãƒè¨€èªã¨ã¯ ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã®ç‰¹ã«XMLå½¢å¼ã«ãŠã„ã¦ã€ã‚¿ã‚°ã®ä»˜ã‘æ–¹ã¯è‡ªç”±ã§ã‚ã‚‹ã€‚ã—ã‹ã—ã€åˆ©ç”¨è€…é–“ã§å…±é€šã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­ã‘ãŸæ–¹ãŒè‰¯ã„ã€‚ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã®è¨€èªã‚’ã‚¹ã‚­ãƒ¼ãƒè¨€èªã¨ã„ã†ã€‚ã‚¹ã‚­ãƒ¼ãƒè¨€èªã«ã€DTDï¼šDocument Type Definitionï¼ˆæ–‡æ›¸å‹å®šç¾©ï¼‰ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ]> HTMLå½¢å¼ï¼šHyperText Markup Language ãƒ»HTMLå½¢å¼ã¨ã¯ ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã†ã¡ã€Webãƒšãƒ¼ã‚¸ã®æ§‹é€ ã‚’è¡¨ç¾ã™ã‚‹ã“ã¨ã«ç‰¹åŒ–ã—ã¦ã„ã‚‹ã€‚ 01-03. JavaScript ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã¸ã®JavaScriptã®çµ„ã¿è¾¼ã¿ ãƒ»ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥çµ„ã¿è¾¼ã‚€æ–¹æ³•ã€‚ document.write(\"JavaScriptã‚’ç›´æ¥çµ„ã¿è¾¼ã‚“ã§ã„ã¾ã™ã€‚\") ãƒ»å¤–éƒ¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ å¤–éƒ¨JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµ„ã¿è¾¼ã‚€æ–¹æ³•ã€‚ CDNã®ä»•çµ„ã¿ã‚’ç”¨ã„ã¦ã€Webä¸Šã‹ã‚‰ãƒªã‚½ãƒ¼ã‚¹ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ ãƒ»scriptã‚¿ã‚°ãŒè¤‡æ•°ã‚ã‚‹å ´åˆ ä¸€ã¤ã®ãƒšãƒ¼ã‚¸ã®Htmlå†…ã§ã€scriptã‚¿ã‚°ãŒè¤‡æ•°ã«åˆ†æ•£ã—ã¦ã„ã¦ã‚‚ã€Scriptingãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€ä¸€ã¤ã«ã¾ã¨ã‚ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ã‚ˆã‚Šä¸Šéƒ¨ã®scriptã‚¿ã‚°ã®å‡¦ç†ã¯ã€ã‚ˆã‚Šä¸‹éƒ¨ã®scriptã«å¼•ãç¶™ãŒã‚Œã‚‹ã€‚ 1ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã€‚ localNumè¦‹å‡ºã—ï¼‘ var globalNum = 10; è¦‹å‡ºã—ï¼’ globalNum = globalNum * 10; è¦‹å‡ºã—ï¼“ document.write(\"çµæœã¯\" + globalNum + \"ã§ã™\"); var hoge = true; // sample.js // ç„¡åé–¢æ•°ã®å³æ™‚å®Ÿè¡Œã€‚å®šç¾©ã¨å‘¼ã³å‡ºã—ã‚’åŒæ™‚ã«è¡Œã†ã€‚ (function () { // å¤–å´ã®å¤‰æ•°ï¼ˆhogeï¼‰ã‚’å‚ç…§ã§ãã‚‹ã€‚ if(hoge) { console.log(\"å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ\"); } var localNum = 20; function localMethod() { // å¤–å´ã®å¤‰æ•°ï¼ˆlocalNumï¼‰ã‚’å‚ç…§ã§ãã‚‹ã€‚ console.log(\"localNum\"); } // å®šç¾©ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œ localMethod(); }()); å®Ÿè¡Œæ™‚ã«ã¯ä»¥ä¸‹ã®æ§˜ã«ã€ã¾ã¨ã‚ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã“ã§ã¯ã€htmlãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã—ãŸé–¢æ•°ã®å¤–ã«ã‚ã‚‹å¤‰æ•°ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ãªã£ã¦ã„ã‚‹ã€‚ä¸€ã¤ã®ãƒšãƒ¼ã‚¸ã‚’æ§‹æˆã™ã‚‹Htmlã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦åˆ†å‰²ã—ã¦ã„ã¦ã‚‚ã€åŒã˜ã§ã‚ã‚‹ã€‚ var globalNum = 10; localNum = localNum * 10; document.write(\"çµæœã¯\" + num + \"ã§ã™\"); var hoge = true; // ç„¡åé–¢æ•°ã®å³æ™‚å®Ÿè¡Œã€‚å®šç¾©ã¨å‘¼ã³å‡ºã—ã‚’åŒæ™‚ã«è¡Œã†ã€‚ (function () { // å¤–å´ã®å¤‰æ•°ï¼ˆhogeï¼‰ã‚’å‚ç…§ã§ãã‚‹ã€‚ if(hoge) { console.log(\"å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ\"); } var localNum = 20; function localMethod() { // å¤–å´ã®å¤‰æ•°ï¼ˆlocalNumï¼‰ã‚’å‚ç…§ã§ãã‚‹ã€‚ console.log(\"localNum\"); } // å®šç¾©ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œ localMethod(); }()); 01-04. ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ Polyfill ãƒ»Polyfillã¨ã¯ JavaScriptã‚„HTMLã®æ›´æ–°ã«ãƒ–ãƒ©ã‚¦ã‚¶ãŒè¿½ã„ã¤ã„ã¦ã„ãªã„å ´åˆã€ãã‚Œã‚’è£œå®Œã™ã‚‹ã‚ˆã†ã«å®Ÿè£…ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã“ã¨ã€‚ã€Polyfillaã€ã«ç”±æ¥ã—ã¦ã„ã‚‹ã€‚ 02. Downloadingå‡¦ç† Downloadingå‡¦ç†ã¨ã¯ ãƒ»éåŒæœŸçš„ãªèª­ã¿è¾¼ã¿ ã¾ãšã€ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã‹ã‚‰ãƒªã‚½ãƒ¼ã‚¹ï¼ˆHtmlã€CSSã€JSã€ç”»åƒï¼‰ã¯ã€åˆ†å‰²ã•ã‚ŒãªãŒã‚‰ã€ãƒã‚¤ãƒˆå½¢å¼ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã‚‹ã€‚ã“ã‚Œã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«å«ã¾ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œã‚’å„ªå…ˆåº¦ã«åŸºã¥ã„ã¦èª­ã¿è¾¼ã‚€å‡¦ç†ã€‚åˆ†å‰²ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã‚’ã€éšæ™‚èª­ã¿è¾¼ã‚“ã§ã„ãã€‚ãã®ãŸã‚ã€å„ãƒªã‚½ãƒ¼ã‚¹ã®èª­ã¿è¾¼ã¿ã¯éåŒæœŸçš„ã«è¡Œã‚ã‚Œã‚‹ã€‚Downloadingå‡¦ç†ãŒçµ‚äº†ã—ãŸãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã€æ¬¡ã®Parseå‡¦ç†ã«é€²ã‚“ã§ã„ãã€‚ ãƒ»ãƒªã‚½ãƒ¼ã‚¹ã®å„ªå…ˆé †ä½ HTML CSS JS ç”»åƒ Pre-Loading ãƒ»Pre-Loadingã¨ã¯ Downloadingå‡¦ç†ã®å„ªå…ˆé †ä½ã‚’ä¸Šã’ã‚‹ã‚ˆã†ã«å®£è¨€ã™ã‚‹æ–¹æ³•ã€‚å„ªå…ˆåº¦ã®é«˜ã„åˆ†å‰²ãƒªã‚½ãƒ¼ã‚¹ã¯ã€æ¬¡ã®Parseå‡¦ç†ã€Scriptingå‡¦ç†ã‚‚è¡Œã‚ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€JSãƒ•ã‚¡ã‚¤ãƒ«ã®Scriptingå‡¦ç†ãŒã€ä»¥é™ã®imageãƒ•ã‚¡ã‚¤ãƒ«ã®Downloadingå‡¦ç†ã‚ˆã‚Šã‚‚æ—©ãã«è¡Œã‚ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ Title Hello World Lazy Loadingï¼ˆé…å»¶èª­ã¿è¾¼ã¿ï¼‰ ãƒ»Lazy Loadingã¨ã¯ æ¡ä»¶ã«åˆè‡´ã—ãŸè¦ç´ ã‚’éšæ™‚èª­ã¿è¾¼ã‚€æ–¹æ³•ã€‚æ¡ä»¶ã®æŒ‡å®šæ–¹æ³•ã«ã¯ã€scroll/resizeã‚¤ãƒ™ãƒ³ãƒˆã«åŸºã¥ãæ–¹æ³•ã¨ã€Intersection Observerã«ã‚ˆã‚‹è¦ç´ ã®äº¤å·®ç‡ã«åŸºã¥ãæ–¹æ³•ãŒã‚ã‚‹ã€‚ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®é…å»¶èª­ã¿è¾¼ã¿ã§ã¯ã€èª­ã¿è¾¼ã¿å‰ã«ãƒ€ãƒŸãƒ¼ç”»åƒã‚’è¡¨ç¤ºã•ã›ã¦ãŠãã€é…å»¶èª­ã¿è¾¼ã¿æ™‚ã«ãƒ€ãƒŸãƒ¼ç”»åƒãƒ‘ã‚¹ã‚’æœ¬æ¥ã®ç”»åƒãƒ‘ã‚¹ã«ä¸Šæ›¸ãã™ã‚‹ã€‚ ãƒ»scrollã‚¤ãƒ™ãƒ³ãƒˆã¨resizeã‚¤ãƒ™ãƒ³ãƒˆã«åŸºã¥ãèª­ã¿è¾¼ã¿ scrollã‚¤ãƒ™ãƒ³ãƒˆã¨resizeã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–ã—ã€ã“ã‚Œã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆã®ç™ºç«ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã—ã¦ã€ç”»é¢å†…ã«æ–°ã—ãè¿½åŠ ã•ã‚ŒãŸè¦ç´ ã‚’éšæ™‚èª­ã¿è¾¼ã‚€æ–¹æ³•ã€‚ ãƒ»Intersection Observerã«ã‚ˆã‚‹è¦ç´ ã®äº¤å·®ç‡ã«åŸºã¥ãèª­ã¿è¾¼ã¿ Intersection Observerã«ã‚ˆã‚‹è¦ç´ ã®äº¤å·®ç‡ã‚’ç›£è¦–ã—ã€æŒ‡å®šã®äº¤å·®ç‡ã‚’è¶…ãˆãŸè¦ç´ ã‚’éšæ™‚èª­ã¿è¾¼ã‚€æ–¹æ³•ã€‚ä¾‹ãˆã°ã€äº¤å·®ç‡ã®é–¾å€¤ã‚’ã€0.5ã€ã¨è¨­å®šã™ã‚‹ã¨ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®äº¤å·®ç‡ãŒã€0.5ã€ã‚’è¶…ãˆãŸè¦ç´ ã‚’éšæ™‚èª­ã¿è¾¼ã‚€ã€‚ Eager Loading ãƒ»Eager Loadingã¨ã¯ 02-02. Parseå‡¦ç† Parseå‡¦ç†ã¨ã¯ Downloadingå‡¦ç†ã«ã‚ˆã£ã¦èª­ã¿è¾¼ã¾ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã‚’ç¿»è¨³ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ HTMLå½¢å¼ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ è§£æ ãƒ»æ§‹é€ è§£æã®æµã‚Œ Downloadingå‡¦ç†ã§èª­ã¿ã“ã¾ã‚ŒãŸãƒã‚¤ãƒˆå½¢å¼ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«åŸºã¥ã„ã¦ã€ä¸€é€£ã®æ–‡å­—åˆ—ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ã“ã“ã§ã¯ã€ä»¥ä¸‹ã®HTMLå½¢å¼ãƒ•ã‚¡ã‚¤ãƒ«ã¨CSSå½¢å¼ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆstyle.cssï¼‰ã«å¤‰æ›ã•ã‚ŒãŸã¨ã™ã‚‹ã€‚ Critical Path Hello web performance students! Hello world! /* style.css */ body { font-size: 16px } p { font-weight: bold } span { color: red } p span { display: none } img { float: right } ãƒªã‚½ãƒ¼ã‚¹ã®æ–‡å­—åˆ—ã‹ã‚‰HTMLã‚¿ã‚°ãŒèªè­˜ã•ã‚Œã€ãƒˆãƒ¼ã‚¯ãƒ³ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚å„ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ä¸€ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ HTMLãƒ‘ãƒ¼ã‚µãƒ¼ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒ¼ãƒ‰ã¨ã—ã¦ã€DOMãƒ„ãƒªãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã€‚DOMãƒ„ãƒªãƒ¼ã‚’ç”Ÿæˆã™ã‚‹é€”ä¸­ã§scriptã‚¿ã‚°ã«åˆ°é”ã™ã‚‹ã¨ã€ä¸€æ—¦ã€JSãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§Scriptingå‡¦ç†ã‚’çµ‚ãˆã¦ã‹ã‚‰ã€DOMãƒ„ãƒªãƒ¼ã®ç”Ÿæˆã‚’å†é–‹ã™ã‚‹ã€‚DOMã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/API/Document_Object_Model åŒæ™‚ã«ã€CSSãƒ‘ãƒ¼ã‚µãƒ¼ã¯ã€headã‚¿ã‚°ã«ã‚ã‚‹linkã‚¿ã‚°ã‚’ã‚‚ã¨ã«ã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸCSSãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦Downloadingå‡¦ç†ã‚’è¡Œã£ãŸå¾Œã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒ¼ãƒ‰ã¨ã—ã¦ã€CSSOMãƒ„ãƒªãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã€‚ XMLå½¢å¼ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ è§£æ ãƒ»æ§‹é€ è§£æã®æµã‚Œ ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€æœ€åˆã«å‡ºç¾ã™ã‚‹ãƒ«ãƒ¼ãƒˆè¦ç´ ã‚’æ ¹ï¼ˆãƒ«ãƒ¼ãƒˆï¼‰ã€ã¾ãŸã™ã¹ã¦ã®è¦ç´ ã‚„å±æ€§ã‚’ã€ãã“ã‹ã‚‰å»¶ã³ã‚‹æè‘‰ã¨ã—ã¦æ„å‘³ã¥ã‘ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ„ãƒªãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š å¼•ç”¨ï¼šReal-time Generalization of Geodata in the WEBã€https://www.researchgate.net/publication/228930844_Real-time_Generalization_of_Geodata_in_the_WEB 03. Scriptingå‡¦ç† Scriptingå‡¦ç†ã¨ã¯ JavaScriptã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã£ã¦ã€JavaScriptã‚³ãƒ¼ãƒ‰ãŒæ©Ÿæ¢°èªã«ç¿»è¨³ã•ã‚Œã€å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã“ã®å‡¦ç†ã¯ã€åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã ã‘ã§ãªãã€ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãŸæ™‚ã«ã‚‚å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ JavaScriptã‚¨ãƒ³ã‚¸ãƒ³ ãƒ»JavaScriptã‚¨ãƒ³ã‚¸ãƒ³ã¨ã¯ JavaScriptã®ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã®ã“ã¨ã€‚JavaScriptã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ã‹ã‚‰HTMLãƒ•ã‚¡ã‚¤ãƒ«ã«çµ„ã¿è¾¼ã¾ã‚ŒãŸJavaScriptã®ã‚³ãƒ¼ãƒ‰ã‚’å—ã‘å–ã‚‹ã€‚JavaScriptã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€ã“ã‚Œã‚’æ©Ÿæ¢°èªã«ç¿»è¨³ã—ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã«å¯¾ã—ã¦ã€å‘½ä»¤ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ãƒ»æ©Ÿæ¢°èªç¿»è¨³ JavaScriptã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã€å­—å¥è§£æã€æ§‹é€ è§£æã€æ„å‘³è§£é‡ˆã€å‘½ä»¤ã®å®Ÿè¡Œã€ã‚’ã‚³ãƒ¼ãƒ‰ä¸€è¡Œãšã¤ã«å¯¾ã—ã€ç¹°ã‚Šè¿”ã—è¡Œã†ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_basic_language_processor.html 03-02. ã‚¤ãƒ™ãƒ³ãƒˆ ã‚¤ãƒ™ãƒ³ãƒˆ ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã¨ã¯ ãƒ–ãƒ©ã‚¦ã‚¶ã®å„æ“ä½œã¯ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦JavaScriptã¾ãŸã¯HTMLã«ç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/Events ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã¨ã¯ ã‚¤ãƒ™ãƒ³ãƒˆã®ç™ºç«ã«ä¼´ã£ã¦ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹é–¢æ•°ã®ã“ã¨ã€‚ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŸã³ã«Scriptingå‡¦ç†ãŒç¹°ã‚Šè¿”ã•ã‚Œã‚‹ã€‚ HTMLå½¢å¼ã«ãŠã‘ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã®ã‚³ãƒ¼ãƒ« ãƒ»onload ã€ç”»é¢ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã¨ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã™ã‚‹ã¨ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ ãƒ»onclick ã€è¦ç´ ã®ã‚¯ãƒªãƒƒã‚¯ã€ã¨ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã™ã‚‹ã¨ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ function methodA(){ console.log(\"ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã¾ã—ãŸ\"); } JSå½¢å¼ã«ãŠã‘ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã®ã‚³ãƒ¼ãƒ« ãƒ»document.getElementById.onclické–¢æ•° æŒ‡å®šã—ãŸIDã«å¯¾ã—ã¦ã€ä¸€ã¤ã®ã‚¤ãƒ™ãƒ³ãƒˆã¨ä¸€ã¤ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š // æŒ‡å®šã—ãŸIDã§ã€ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãŸæ™‚ã«ã€å‡¦ç†ã‚’è¡Œã†ã€‚ document.getElementById(\"btn\").onclick = () => { console.log(\"ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã¾ã—ãŸ\"); } ãƒ»document.addEventListeneré–¢æ•° ä¸€ã¤ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦ã€ä¸€ã¤ä»¥ä¸Šã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ç¬¬ä¸€å¼•æ•°ã§ã€clickãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®šã—ã€ç¬¬äºŒå¼•æ•°ã§ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆç„¡åé–¢æ•°ã§ã‚‚å¯ï¼‰ã‚’æ¸¡ã™ã€‚falseã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ–ãƒªãƒ³ã‚°ã‚’è¡Œã‚ã›ãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š è¡¨ç¤º const btn = document.getElementById(\"btn\"); btn.addEventListener(\"click\", () => { console.log(\"ã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸï¼\"); },false); // DOMContentLoadedã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãŸæ™‚ã«ã€å‡¦ç†ã‚’è¡Œã†ã€‚ document.addEventListener(\"DOMContentLoaded\", () => { console.log(\"ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã¾ã—ãŸ\"); }); // ä¸€ã¤ç›® document.getElementById(\"btn\").addEventListener(\"click\", () => { console.log(\"ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã¾ã—ãŸï¼ˆï¼‘ï¼‰\"); }, false); // äºŒã¤ç›® document.getElementById(\"btn\").addEventListener(\"click\", () => { console.log(\"ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã¾ã—ãŸï¼ˆï¼’ï¼‰\"); }, false); 04. Renderingå‡¦ç† Renderingå‡¦ç†ã¨ã¯ ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ„ãƒªãƒ¼ãŒç”Ÿæˆã•ã‚Œã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã®ã©ã“ã«ä½•ã‚’æç”»ã™ã‚‹ã®ã‹ã‚’è¨ˆç®—ã™ã‚‹ã€‚CalculateStyleå‡¦ç†ã¨Layoutå‡¦ç†ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚ 04-02. CalculateStyleå‡¦ç† CalculateStyleå‡¦ç†ã¨ã¯ ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€DOMãƒ„ãƒªãƒ¼ã®ãƒ«ãƒ¼ãƒˆã®ãƒãƒ¼ãƒ‰ã‹ã‚‰é †ã«CSSOSãƒ„ãƒªãƒ¼ã‚’é©ç”¨ã—ã€Renderãƒ„ãƒªãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã€‚ 04-03. Layoutå‡¦ç† Layoutå‡¦ç†ã¨ã¯ ä¸Šè¨˜ã§èª­ã¿è¾¼ã¾ã‚ŒãŸHTMLå½¢å¼ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ãƒã‚¹ãƒˆã•ã‚ŒãŸ 2 ã¤ã® div ãŒã‚ã‚‹ã€‚1 ã¤ç›®ï¼ˆè¦ªï¼‰ã®divã‚ˆã‚Šã€ãƒãƒ¼ãƒ‰ã®è¡¨ç¤ºã‚µã‚¤ã‚ºã‚’ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®å¹…ã® 50% ã«è¨­å®šã—ã€ã“ã®è¦ªã«å«ã¾ã‚Œã¦ã„ã‚‹ 2 ã¤ç›®ï¼ˆå­ï¼‰ã®divã‚ˆã‚Šã€ãã®å¹…ã‚’è¦ªã®50%ã€ã¤ã¾ã‚Šãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®å¹…ã®25%ã«ãªã‚‹ã‚ˆã†ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹ã€‚ 05. Paintå‡¦ç† Paintå‡¦ç†ã¨ã¯ DOMãƒ„ãƒªãƒ¼ã®å„ãƒãƒ¼ãƒ‰ã‚’ã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã«æç”»ã™ã‚‹ã€‚ 05-02. Rasterizeå‡¦ç† Rasterizeå‡¦ç†ã¨ã¯ 05-03. CompositeLayerså‡¦ç† CompositeLayserså‡¦ç†ã¨ã¯ 06. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã¯ é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆHTMLã€JavaScriptã€CSSã€ç”»åƒï¼‰ã‚’ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¦ãŠãã€å†åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å‡¦ç†é€Ÿåº¦ã‚’é«˜ã‚ã‚‹ä»•çµ„ã¿ã®ã“ã¨ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ä¿å­˜å ´æ‰€ã®ç¨®é¡ ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ–ãƒ©ã‚¦ã‚¶ã«ãŠã„ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸé™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒä½œæˆã•ã‚Œã‚‹ã€‚Chromeã®å ´åˆã¯ã€CacheStorageã«ä¿æŒã•ã‚Œã‚‹ã€‚ç¢ºèªæ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://developer.chrome.com/docs/devtools/storage/cache/ ãƒ»ãƒªãƒãƒ¼ã‚¹Proxyã‚µãƒ¼ãƒã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ãƒªãƒãƒ¼ã‚¹Proxyã‚µãƒ¼ãƒã«ãŠã„ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸé™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒä½œæˆã•ã‚Œã‚‹ã€‚AWSã§ã¯ã€CloudFrontã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã“ã‚Œã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãŠã„ã¦ã€ãƒ¡ã‚½ãƒƒãƒ‰å‡¦ç†çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒä½œæˆã•ã‚Œã‚‹ã€‚å¿…è¦ãªå ´åˆã€ã“ã‚Œã‚’å–ã‚Šå‡ºã—ã¦å†åˆ©ç”¨ã™ã‚‹ã€‚Laravelã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://readouble.com/laravel/8.x/ja/cache.html ã‚µãƒ¼ãƒå´ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã¹ãã§ãªã„ãƒ‡ãƒ¼ã‚¿ ãƒªãƒãƒ¼ã‚¹Proxyã‚µãƒ¼ãƒï¼ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã¹ãã§ãªã„ãƒ‡ãƒ¼ã‚¿ã‚’æŒã¤ãƒšãƒ¼ã‚¸ãŒã‚ã‚‹ã€‚ ãƒšãƒ¼ã‚¸ ç†ç”± Formèªè¨¼ãƒšãƒ¼ã‚¸ ç„¡é–¢ä¿‚ã®ãƒ¦ãƒ¼ã‚¶ã«èªè¨¼æ¸ˆã¿ã®ãƒšãƒ¼ã‚¸ãŒè¿”ä¿¡ã•ã‚Œã¦ã—ã¾ã†ã€‚ ç·¯åº¦çµŒåº¦ï¼ãƒ•ãƒªãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«åŸºã¥ãæ¤œç´¢çµæœãƒšãƒ¼ã‚¸ ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ãŒå¤šãã€å…¨ã¦ã®ãƒšãƒ¼ã‚¸ã‚’ç¶²ç¾…ã™ã‚‹ã“ã¨ãŒç¾å®Ÿçš„ã§ãªã„ã€‚ ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨ï¼ä¸ä½¿ç”¨ã®æ¤œè¨¼ ãƒ»ETagå€¤ã«ã‚ˆã‚‹æ¤œè¨¼ === ï¼ˆï¼‘ï¼‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ‰åŠ¹æ™‚é–“ãŒåˆ‡ã‚Œã‚‹ã¾ã§ === ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã€‚ ã‚µãƒ¼ãƒã¯ã€ç‰¹å®šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ã¦ãƒãƒƒã‚·ãƒ¥å€¤ã‚’ç”Ÿæˆã—ã€ã“ã‚Œã‚’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ETagå€¤ã¨ã™ã‚‹ã€‚ ã‚µãƒ¼ãƒã¯ã€ETagãƒ˜ãƒƒãƒ€ãƒ¼ã«ETagå€¤ã‚’è¨­å®šã—ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ã¨ã‚‚ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ETagå€¤ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ‰åŠ¹æ™‚é–“ãŒåˆ‡ã‚Œã‚‹ã¾ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã—ç¶šã‘ã‚‹ã€‚ === ï¼ˆï¼’ï¼‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ‰åŠ¹æ™‚é–“ãŒåˆ‡ã‚ŒãŸå¾Œ === ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ‰åŠ¹æ™‚é–“ãŒåˆ‡ã‚Œã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã€‚ã“ã®æ™‚ã€If-None-Matchãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦ãŠã„ãŸETagå€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚µãƒ¼ãƒã¯ã€é€ä¿¡ã•ã‚ŒãŸETagå€¤ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ETagå€¤ã‚’æ¯”è¼ƒæ¤œè¨¼ã™ã‚‹ã€‚ === ï¼ˆï¼“ï¼‰æ¤œè¨¼ã«ã‚ˆã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ === ETagå€¤ã®æ¯”è¼ƒæ¤œè¨¼ã®çµæœã€ä¸€è‡´ã™ã‚‹ã€‚ ã‚µãƒ¼ãƒã¯ã€ä¸¡æ–¹ã®å€¤ãŒä¸€è‡´ã™ã‚‹å ´åˆã€304ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”¨ã„ã‚‹ã€‚ === ï¼ˆï¼”ï¼‰æ¤œè¨¼ã«ã‚ˆã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã›ãš === ETagå€¤ã®æ¯”è¼ƒæ¤œè¨¼ã®çµæœã€ä¸€è‡´ã—ãªã„ã€‚ ã‚µãƒ¼ãƒã¯ã€ä¸¡æ–¹ã®å€¤ãŒä¸€è‡´ã—ãªã„å ´åˆã€ETagå€¤ã‚’ç”Ÿæˆã—ã€ã“ã‚Œã‚’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ–°ã—ã„ETagå€¤ã¨ã™ã‚‹ã€‚ ã‚µãƒ¼ãƒã¯ã€ETagãƒ˜ãƒƒãƒ€ãƒ¼ã«ETagå€¤ã‚’è¨­å®šã—ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ã¨ã‚‚ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ETagå€¤ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã€‚ ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ™‚é–“ã®å®šç¾© ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã— ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã¦ã€Cache-Controlãƒ˜ãƒƒãƒ€ãƒ¼ã«no-storeã‚’è¨­å®šã™ã‚‹ã€‚ã“ã®å ´åˆã€ETagå€¤ãŒç„¡åŠ¹ã«ãªã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã—ãªããªã‚‹ã€‚ HTTP/1.1 200 # ï½ ä¸­ç•¥ ï½ Cache-Control: no-store # ï½ ä¸­ç•¥ ï½ # ãƒœãƒ‡ã‚£ ã“ã“ã«ã‚µã‚¤ãƒˆã®HTMLã®ã‚³ãƒ¼ãƒ‰ ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚ã‚Šï¼ˆæœ‰åŠ¹æ™‚é–“ã‚ã‚Šï¼‰ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã¦ã€Cache-Controlãƒ˜ãƒƒãƒ€ãƒ¼ã«max-age=31536000ã‚’è¨­å®šã™ã‚‹ã€‚Expireãƒ˜ãƒƒãƒ€ãƒ¼ã«æœ‰åŠ¹æ™‚é–“ã‚’è¨­å®šã—ã¦ã‚‚è‰¯ã„ãŒã€Cache-Controlãƒ˜ãƒƒãƒ€ãƒ¼ã®æœ‰åŠ¹æ™‚é–“ãŒå„ªå…ˆã•ã‚Œã‚‹ã€‚ã“ã®å ´åˆã€æœ‰åŠ¹æ™‚é–“ã‚’éãã‚‹ã¨ã€ETagå€¤ã‚’æ¯”è¼ƒæ¤œè¨¼ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ HTTP/1.1 200 # ï½ ä¸­ç•¥ ï½ Cache-Control: max-age=31536000 # ï½ ä¸­ç•¥ ï½ # ãƒœãƒ‡ã‚£ ã“ã“ã«ã‚µã‚¤ãƒˆã®HTMLã®ã‚³ãƒ¼ãƒ‰ ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚ã‚Šï¼ˆæœ‰åŠ¹æ™‚é–“ãªã—ï¼‰ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã¦ã€Cache-Controlãƒ˜ãƒƒãƒ€ãƒ¼ã«max-age=0ã‚’è¨­å®šã™ã‚‹ã€‚ã¾ãŸã€Expireãƒ˜ãƒƒãƒ€ãƒ¼ã«æœŸé™åˆ‡ã‚Œã®æ—¥æ™‚ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã®å ´åˆã€æ¯å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ETagå€¤ã‚’æ¯”è¼ƒæ¤œè¨¼ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ HTTP/1.1 200 # ï½ ä¸­ç•¥ ï½ Cache-Control: max-age=0 Expires: Sat, 01 Jan 2000 00:00:00 GMT # ï½ ä¸­ç•¥ ï½ # ãƒœãƒ‡ã‚£ ã“ã“ã«ã‚µã‚¤ãƒˆã®HTMLã®ã‚³ãƒ¼ãƒ‰ "},"public/software/software_application_procedural_language_go.html":{"url":"public/software/software_application_procedural_language_go.html","title":"ğŸ“– Goã¨ã¯","keywords":"","body":"Goã¨ã¯ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ 01. ç‰¹é•· ä¸¦åˆ—å‡¦ç†ãŒå®Ÿè£…å¯èƒ½ å€‹äººçš„ã«Goã§æœ€å¤§ã®ç‰¹é•·ã€‚ä¸¦åˆ—å‡¦ç†ã‚’ç°¡å˜ã«å®Ÿè£…ã§ãã‚‹ã€‚ä¸¦è¡Œå‡¦ç†ã—ã¦ã‚‚çµæœã«å½±éŸ¿ã—ãªã‘ã‚Œã°ã€å‡¦ç†ã‚’é«˜é€ŸåŒ–ã§ãã‚‹ã€‚ä¸¦åˆ—å‡¦ç†ã«ã¤ã„ã¦ã¯ã€æœ¬ãƒãƒ¼ãƒˆå†…ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ã»ã©ã‚ˆãã‚·ãƒ³ãƒ—ãƒ« é»’é­”è¡“çš„ãªé–¢æ•°ã‚„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒãªã„ä¸€æ–¹ã§ã€åŸºæœ¬çš„ãªæ©Ÿèƒ½ã¯æƒã£ã¦ã„ã‚‹ãŸã‚ã€å‡¦ç†ã®å¯èª­æ€§ãŒé«˜ã„ã€‚ãã®ãŸã‚ã€å¾Œç¶šè€…ãŒé–‹ç™ºã—ã‚„ã™ãã€å®Ÿè£…ãŒã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã—ã‚„ã™ã„ã€‚ å‹ä»˜ã‘ã®å³æ ¼ã•ã¨å‹æ¨è«– å‹ä»˜ã‘ãƒ«ãƒ¼ãƒ«ãŒå³ã—ãã€å®šç¾©ã«å¿…ãšå‹ä»˜ã‘ãŒå¿…è¦ã§ã‚ã‚‹ä¸€æ–¹ã§ã€å‹æ¨è«–ã§å‹ä»˜ã‘ã®å®Ÿè£…ã‚’çœç•¥ã§ãã‚‹ã€‚ãã®ãŸã‚ã€å‹ä»˜ã‘ã®å®Ÿè£…ãªã—ã«é™çš„å‹ä»˜ã‘ã®ãƒ¡ãƒªãƒƒãƒˆã‚’äº«å—ã§ãã‚‹ã€‚ç‰¹ã«ãƒã‚°ãŒè¨±ã•ã‚Œãªã„ã‚ˆã†ãªåŸºç›¤éƒ¨åˆ†ã«é©ã—ã¦ã„ã‚‹ã€‚ é«˜é€Ÿãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ« ä»–ã®é™çš„å‹ä»˜ã‘è¨€èªã®Javaã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä¸€åº¦ä¸­é–“è¨€èªã«å¤‰æ›ã—ã€ãã®å¾Œæ©Ÿæ¢°èªã«ç¿»è¨³ã™ã‚‹ã€‚ã—ã‹ã—Goã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ç›´æ¥æ©Ÿæ¢°èªã«ç¿»è¨³ã™ã‚‹ãŸã‚ã€ã‚ˆã‚Šé«˜é€Ÿã§ã‚ã‚‹ã€‚ ãƒ¡ãƒ¢ãƒªã®å®‰å…¨æ€§ã‚’æ‹…ä¿ã™ã‚‹ä»•çµ„ã¿ ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹æ•°å€¤åŒå£«ã‚’æ¼”ç®—ã™ã‚‹ã€ãƒã‚¤ãƒ³ã‚¿æ¼”ç®—ã€ã®æ©Ÿèƒ½ã‚’æ„å›³ã—ã¦å»ƒæ­¢ã—ã¦ã„ã‚‹ã€‚ãƒã‚¤ãƒ³ã‚¿æ¼”ç®—ã®ä¾‹ã¨ã—ã¦ã€10ç•ªã‚¢ãƒ‰ãƒ¬ã‚¹ã¨20ç•ªã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ•°å€¤ã‚’è¶³ã—ã¦ã€30ç•ªã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ–°ã—ãå‰²ã‚Šå½“ã¦ã‚‹ã€ã¨ã„ã£ãŸå‡¦ç†ã‚’è¡Œã†ã€‚ã“ã®æ™‚ã€ä½•ã‚‰ã‹ã®åŸå› ã§ç‰‡æ–¹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ–‡å­—åˆ—ã ã£ãŸå ´åˆã€30ç•ªã‚¢ãƒ‰ãƒ¬ã‚¹ã«äºˆæœŸã—ãªã„å€¤ï¼ˆæ•°å€¤ï¼‹æ–‡å­—åˆ—ï¼‰ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã“ã‚Œã¯ã€ä¸å…·åˆã‚„æ‚ªæ„ã‚ã‚‹æ“ä½œã«ç¹‹ãŒã‚‹ãŸã‚ã€Goã§ã¯ãƒã‚¤ãƒ³ã‚¿æ¼”ç®—å­ã®æ©Ÿèƒ½ãŒãªã„ã€‚ ã‚¯ãƒ©ã‚¹ã‚„ç¶™æ‰¿ãŒãªã„ ç¶™æ‰¿ã¯ã‚«ãƒ—ã‚»ãƒ«åŒ–ã‚’å£Šã™ãŸã‚ã€ã“ã‚Œã‚’å›é¿ã§ãã‚‹ã€å§”è­²ã€ã®æ–¹ãŒå„ªã‚Œã¦ã„ã‚‹ã¨ã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€æ€æƒ³ã¨ã—ã¦ã‚¯ãƒ©ã‚¹ã‚„ç¶™æ‰¿ã‚’å»ƒæ­¢ã—ã¦ã„ã‚‹ã€‚åŸ‹ã‚è¾¼ã¿ã«ã‚ˆã£ã¦ã€å§”è­²ã‚’å®Ÿç¾ã™ã‚‹ã€‚åŸ‹ã‚è¾¼ã¿ã«ã¤ã„ã¦ã¯ã€æœ¬ãƒãƒ¼ãƒˆå†…ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ è£œè¶³ 02. å®Ÿè£…è¦å‰‡ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€  ãƒ»$GOPATH ãƒ‘ã‚¹ã¯å¥½ã¿ã§ã‚ã‚‹ãŒã€$HOME/goã¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://github.com/golang-standards/project-layout $GOPATH # ä¾‹ãˆã°ã€ã€$HOME/goã€ã¨ã™ã‚‹ã€‚ â”œâ”€â”€ bin â”œâ”€â”€ pkg â””â”€â”€ src â”œâ”€â”€ build # Dockerfileã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª â”œâ”€â”€ cmd # main.goãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã€ã‚µãƒ–mainãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª â”‚ â”œâ”€â”€ main.go â”‚ â””â”€â”€ foo â”‚ â””â”€â”€ foo.go â”‚ â”œâ”€â”€ configs â”‚ â””â”€â”€ envrc.template â”‚ â”œâ”€â”€ docsï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’é…ç½®ã™ã‚‹ï¼‰ â”‚ â”œâ”€â”€ BUG.md â”‚ â”œâ”€â”€ ROUTING.md â”‚ â””â”€â”€ TODO.md â”‚ â”œâ”€â”€ internal # cmdãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã›ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª â”‚ â””â”€â”€ pkg â”‚ â”œâ”€â”€ pkg # cmdãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ç‹¬è‡ªgoãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª â”‚ â””â”€â”€ public â”‚ â””â”€â”€ add.go â”‚ â”œâ”€â”€ scripts â”‚ â””â”€â”€ Makefile â”‚ â”œâ”€â”€ test â”‚ â””â”€â”€ test.go â”‚ â””â”€â”€ webï¼ˆç”»åƒã€CSSã€ãªã©ï¼‰ â”œâ”€â”€ static â””â”€â”€ template ãƒ»bin ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆï¼ˆãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€‚ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã™ã‚‹ã¨ã€å‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ ãƒ»pkg ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ã¯åˆ¥ã«ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ãƒ»src ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ãƒ•ã‚¡ã‚¤ãƒ«ã®è¦ç´  ãƒ»package åå‰ç©ºé–“ã¨ã—ã¦ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã‚’å®šç¾©ã™ã‚‹ã€‚ä¸€ã¤ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã§ã¯ã€ä¸€ã¤ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã—ã‹å®£è¨€ã§ããªã„ã€‚ package main ãƒ»import ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€å†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€äº‹å‰ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸå¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚€ã€‚ import \"\" äº’ã„ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—åˆã†ã¨ã€å¾ªç’°å‚ç…§ã‚¨ãƒ©ãƒ¼ï¼ˆmport cycle not allowedï¼‰ã«ãªã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨æ§‹é€ ä½“ã®ä¸¡æ–¹ã‚’åŒã˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ç½®ã„ã¦ã„ã‚‹ã¨ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒä»–ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã€æ§‹é€ ä½“ãŒä»–ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã‚ˆã†ã«ãªã‚Šã€èµ·ã“ã‚Šã‚„ã™ã„ã€‚ ãƒ»func è©³ã—ãã¯ã€é–¢æ•°ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ func xxx() { } ãƒ»æ–‡ã®åŒºåˆ‡ã‚Š Goã§ã¯æ–‡ã®å‡¦ç†ã¯ã‚»ãƒŸã‚³ãƒ­ãƒ³ã§åŒºåˆ‡ã‚‰ã‚Œã‚‹ã€‚ãŸã ã—ã€ã‚»ãƒŸã‚³ãƒ­ãƒ³ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«è£œå®Œã•ã‚Œã€å®Ÿè£…æ™‚ã«ã¯çœç•¥ã§ãã‚‹ã€‚ å‘½åè¦å‰‡ ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå å°æ–‡å­—ä¸€å˜èªã¾ãŸã¯ã‚±ãƒãƒ–ã‚±ãƒ¼ã‚¹ã§å‘½åã™ã‚‹ã€‚ãƒ“ãƒ«ãƒ‰æ™‚ã«ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å¯èƒ½ãªé™ã‚Šãƒã‚¤ãƒ•ãƒ³ã‚’ä½¿ç”¨ã—ãªã„æ–¹ãŒè‰¯ã„ã€‚ ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å å°æ–‡å­—ä¸€å˜èªã§å‘½åã™ã‚‹ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã«å°æ–‡å­—ä¸€å˜èªãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€ã“ã‚Œã¨åŒã˜ã«ã™ã‚‹ã¨ãªãŠè‰¯ã„ã€‚ã¾ãŸã€å‡¦ç†ä¸­ã®å¤‰æ•°åã¨è¢«ã‚‹ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã™ã‚‹ãŸã‚ã€å¤‰æ•°åã¨è¢«ã‚‰ãªã„ã‚ˆã†ã«ã€ã§ãã‚‹ã ã‘çœç•¥ã—ãªã„åå‰ã®æ–¹ãŒè‰¯ã„ã€‚ãŸã ã—ã€ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢ã—ã¦ã¯ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã‚’ã€xxxxx_testã€ã¨ã—ã¦ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://github.com/golang/go/wiki/CodeReviewComments#package-names ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å å°æ–‡å­—ä¸€å˜èªã¾ãŸã¯ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã§å‘½åã™ã‚‹ã€‚ãƒ•ã‚¡ã‚¤ãƒ«åã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¯åˆã‚ã›ã‚‹å¿…è¦ã¯ãªã„ãŒã€ç‹¬è‡ªãƒ«ãƒ¼ãƒ«ã‚’è¨­ã‘ã¦ã‚‚è‰¯ã„ã€‚ä¾‹ãˆã°ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®å ´åˆã€ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã‚’åˆã‚ã›ã‚‹ã‚ˆã†ã«å·¥å¤«ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.stackoverflow.com/q/41599 å‚è€ƒï¼š ãƒ»é–¢æ•°ã€typeã€æ§‹é€ ä½“ ã‚¢ãƒƒãƒ‘ãƒ¼ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã¾ãŸã¯ãƒ­ãƒ¼ãƒ¯ãƒ¼ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã§å‘½åã™ã‚‹ã€‚ ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å æœ«å°¾ã«ã€erã€ã‚’ã¤ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://golang.org/doc/effective_go#interface-names ãƒ»ãƒ¬ã‚·ãƒ¼ãƒå æ§‹é€ ä½“åã®é ­ä¸€æ–‡å­—ã¾ãŸã¯é ­äºŒæ–‡å­—ã‚’å–ã£ã¦å‘½åã™ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§æ§‹é€ ä½“åã®é ­æ–‡å­—ãŒé‡è¤‡ã™ã‚‹ã¨ã€åŒã˜ãƒ¬ã‚·ãƒ¼ãƒåã®æ§‹é€ ä½“ãŒä¹±ç«‹ã—ã¦ã—ã¾ã†ãŸã‚ã€ã“ã‚Œã‚’é˜²ããŸã‚ã«äºŒæ–‡å­—ã‚’å–ã‚‹ã¨ã‚ˆã„ã€‚ã¾ãŸã€ä¿®é£¾èªã¨çµ„ã¿åˆã‚ã›ã¦æ§‹æˆã•ã‚Œã‚‹æ§‹é€ ä½“åã®å ´åˆã€è¢«ä¿®é£¾èªã®é ­äºŒæ–‡å­—ã‚’å–ã‚‹ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ä½¿ã‚ã‚Œã‚‹ã€thisã€ã€selfã€ å‚è€ƒï¼š https://github.com/golang/go/wiki/CodeReviewComments#receiver-names https://yyh-gl.github.io/tech-blog/blog/go-ddd-entity-vo/ ï¼Šä¾‹ï¼Š httpClientã§ã‚ã‚Œã°ã€ä¿®é£¾èªã¯ã€httpã€è¢«ä¿®é£¾èªã€clientã€ã§ã‚ã‚‹ã€‚ãã®ãŸã‚ã€ãƒ¬ã‚·ãƒ¼ãƒåã¾ãŸã¯å¼•æ•°åã§ã¯ã€clã€ã¨ã™ã‚‹ã€‚` ãƒ»ä¸€æ™‚çš„ãªå¤‰æ•°å è‹±å˜èªã®é ­ä¸€æ–‡å­—ã€é ­äºŒæ–‡å­—ã€ç•¥èªã€ã§å‘½åã™ã‚‹ã€‚ã“ã‚Œã¯ã€å®Ÿéš›ã®å‡¦ç†ã‚’å¼·èª¿ã—ã€å¤‰æ•°ã‚’ç›®ç«‹ãŸãªãã™ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚ãŸã ã—ã€ã‚¹ã‚³ãƒ¼ãƒ—ã®å¤§ããªå¤‰æ•°ã«çœç•¥ã—ãŸåå‰ã‚’ã¤ã‘ã‚‹ã¨ã€é‡è¤‡ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€çœç•¥ã›ãšã«ãƒ­ãƒ¼ãƒ¯ãƒ¼ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã§å‘½åã—ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://github.com/golang/go/wiki/CodeReviewComments#variable-names çœç•¥åã«ã¤ã„ã¦ã¯ã€ç•¥èªæ¤œç´¢ã‚µã‚¤ãƒˆã§æ¢ã™ã€‚ã‚ã‚‹ã„ã¯ã€Goãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‹ã‚‰ãã®å˜èªãŒã©ã†çœç•¥ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’æ¢ã—ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://www.allacronyms.com/ ãƒ»ãƒ¢ãƒƒã‚¯ã®å¤‰æ•° ãƒ¢ãƒƒã‚¯æ§‹é€ ä½“ã‚’ä»£å…¥ã™ã‚‹ãŸã‚ã®å¤‰æ•°ã¯ã€ã€mã€ã¨ã™ã‚‹ã€‚ ãƒ»erroræ§‹é€ ä½“ã®å¤‰æ•° erroræ§‹é€ ä½“ã‚’å¤‰æ•°ã«ä»£å…¥ã™ã‚‹å ´åˆã€ã€Errã€ã¨ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã‚’ã¤ã‘ã‚‹ã€‚ ãƒ»ã‚­ãƒ¼åã®æ¤œè¨¼ ãƒãƒƒãƒ—å‹ã‚„ã‚¹ãƒ©ã‚¤ã‚¹å‹ã«ãŠã„ã¦ã€æŒ‡å®šã—ãŸã‚­ãƒ¼åãŒå­˜åœ¨ã™ã‚‹ã‹æ¤œè¨¼ã™ã‚‹å ´åˆã€çœŸå½å€¤ã‚’ä»£å…¥ã™ã‚‹å¤‰æ•°ã‚’ã€okã€ã¨ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" \"log\" ) func main() { userIds := map[string]int{ \"user_id\": 1, } // user_idã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€okã«trueãŒè¿”å´ã•ã‚Œã‚‹ã€‚ userId, ok := userIds[\"user_id\"] if ok == false { log.Fatal(\"user_id does not exist\") // 2009/11/10 23:00:00 user_id does not exist } fmt.Printf(\"%#v\\n\", userId) // 1 } ãã®ä»–ã®ãŠä½œæ³• ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆã®æ›¸å¼ å‚è€ƒï¼šhttps://github.com/golang/go/wiki/CodeReviewComments#comment-sentences ãƒ»Uberé¢¨ã®ãŠä½œæ³• Uberç¤¾ãŒæ¡ç”¨ã—ã¦ã„ã‚‹ãŠä½œæ³•ã€‚ å‚è€ƒï¼šhttps://github.com/uber-go/guide/blob/master/style.md "},"public/software/software_application_procedural_language_go_command_and_configuration.html":{"url":"public/software/software_application_procedural_language_go_command_and_configuration.html","title":"ğŸ“– Goã‚³ãƒãƒ³ãƒ‰ã¨è¨­å®š","keywords":"","body":"Goã‚³ãƒãƒ³ãƒ‰ã¨è¨­å®š ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒãƒ³ãƒ‰ install ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å¯¾ã—ã¦buildã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€$GOPATHä»¥ä¸‹ã®binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¾ãŸã¯pkgãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆé…ç½®ï¼‰ã™ã‚‹ã€‚å†…éƒ¨ã¾ãŸã¯å¤–éƒ¨ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆï¼ˆãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã§ã‚ã‚Œã°binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ã€ãã‚Œä»¥å¤–ï¼ˆä¾‹ï¼š.aãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã§ã‚ã‚Œã°pkgãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã™ã‚‹ã€‚ $ go install get ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— æŒ‡å®šã—ãŸãƒ‘ã‚¹ã‹ã‚‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ã“ã‚Œã«å¯¾ã—ã¦installã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å†…éƒ¨ã¾ãŸã¯å¤–éƒ¨ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆï¼ˆãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã§ã‚ã‚Œã°binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ã€ãã‚Œä»¥å¤–ï¼ˆä¾‹ï¼š.aãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã§ã‚ã‚Œã°pkgãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã™ã‚‹ã€‚ $ go get build ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— æŒ‡å®šã—ãŸãƒ‘ã‚¹ã‚’ãƒ“ãƒ«ãƒ‰å¯¾è±¡ã¨ã—ã¦ã€ãƒ“ãƒ«ãƒ‰ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚foo_test.goãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ“ãƒ«ãƒ‰ã‹ã‚‰è‡ªå‹•çš„ã«é™¤å¤–ã•ã‚Œã‚‹ã€‚ # cmdãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒ“ãƒ«ãƒ‰å¯¾è±¡ã¨ã—ã¦ã€ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«cmdã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚ $ go build ./cmd ãƒ»-o æŒ‡å®šã—ãŸãƒ‘ã‚¹ã«ãƒ“ãƒ«ãƒ‰ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚ãƒ“ãƒ«ãƒ‰å¯¾è±¡ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ãªã„å ´åˆã€ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®goãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ“ãƒ«ãƒ‰ã®å¯¾è±¡ã¨ã™ã‚‹ã€‚ # ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®goãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ“ãƒ«ãƒ‰å¯¾è±¡ã¨ã—ã¦ # $HOME/go/binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚ $ go build -o $HOME/go/bin ã¾ãŸã€æŒ‡å®šã—ãŸãƒ‘ã‚¹å†…ã®goãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ“ãƒ«ãƒ‰å¯¾è±¡ã¨ã—ã¦ã€æŒ‡å®šã—ãŸãƒ‘ã‚¹ã«ãƒ“ãƒ«ãƒ‰ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ # cmdãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®goãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ“ãƒ«ãƒ‰å¯¾è±¡ã¨ã—ã¦ # $HOME/go/binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«cmdã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚ $ go build -o $HOME/go/bin ./cmd ã¡ãªã¿ã«ã€äº‹å‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å¤±æ•—ã«ã€ãƒ“ãƒ«ãƒ‰å¯¾è±¡ãŒå­˜åœ¨ã—ã¦ã„ãªã„ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ package xxxxx is not in GOROOT (/usr/local/go/src/xxxxx) env ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— Goã«é–¢ã™ã‚‹ç’°å¢ƒå¤‰æ•°ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š $ go env # go.modã®æœ‰åŠ¹åŒ– GO111MODULE=\"on\" # ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒå®Ÿè¡Œã•ã‚Œã‚‹CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ GOARCH=\"amd64\" # installã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆæŒ‡å®šç„¡ã—ã®å ´åˆã€$GOPATH/binï¼‰ GOBIN=\"\" GOCACHE=\"/root/.cache/go-build\" GOENV=\"/root/.config/go/env\" GOEXE=\"\" GOFLAGS=\"\" GOHOSTARCH=\"amd64\" # ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒå®Ÿè¡Œã•ã‚Œã‚‹OS GOHOSTOS=\"linux\" GOINSECURE=\"\" GOMODCACHE=\"/go/pkg/mod\" GONOPROXY=\"\" GONOSUMDB=\"\" GOOS=\"linux\" # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒé…ç½®ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª GOPATH=\"/go\" GOPRIVATE=\"\" GOPROXY=\"https://proxy.golang.org,direct\" # Goæœ¬ä½“ã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª GOROOT=\"/usr/local/go\" GOSUMDB=\"sum.golang.org\" GOTMPDIR=\"\" GOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\" GCCGO=\"gccgo\" AR=\"ar\" CC=\"gcc\" CXX=\"g++\" # cè¨€èªè£½ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æœ‰åŠ¹åŒ–ã€‚ç„¡åŠ¹åŒ–ã—ãªã„ã¨ã€vetã‚³ãƒãƒ³ãƒ‰ãŒå¤±æ•—ã™ã‚‹ã€‚ CGO_ENABLED=\"0\" GOMOD=\"/go/src/go.mod\" CGO_CFLAGS=\"-g -O2\" CGO_CPPFLAGS=\"\" CGO_CXXFLAGS=\"-g -O2\" CGO_FFLAGS=\"-g -O2\" CGO_LDFLAGS=\"-g -O2\" PKG_CONFIG=\"pkg-config\" GOGCCFLAGS=\"-fPIC -m64 -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build887404645=/tmp/go-build -gno-record-gcc-switches\" fmt ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— æŒ‡å®šã—ãŸãƒ‘ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æ•´å½¢ã™ã‚‹ã€‚ãƒ‘ã‚¹ã¨ã—ã¦ã€./...ã€ã‚’æŒ‡å®šã—ã¦ã€å†å¸°çš„ã«å®Ÿè¡Œã™ã‚‹ã®ãŒãŠã™ã™ã‚ã€‚ $ go fmt ./... vet ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— æŒ‡å®šã—ãŸãƒ‘ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦é™çš„è§£æã‚’è¡Œã†ã€‚ãƒ‘ã‚¹ã¨ã—ã¦ã€./...ã€ã‚’æŒ‡å®šã—ã¦ã€å†å¸°çš„ã«å®Ÿè¡Œã™ã‚‹ã®ãŒãŠã™ã™ã‚ã€‚ $ go vet ./... test ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— æŒ‡å®šã—ãŸãƒ‘ã‚¹ã®xxxxx_test.goãƒ•ã‚¡ã‚¤ãƒ«ã§ã€Testã€ã‹ã‚‰å§‹ã¾ã‚‹ãƒ†ã‚¹ãƒˆé–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚testãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã‚’å†å¸°çš„ã«å®Ÿè¡Œã™ã‚‹ã®ãŒãŠã™ã™ã‚ã€‚ $ go test ./... ãƒ»-v ãƒ†ã‚¹ãƒˆæ™‚ã«ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œæ™‚é–“ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ $ go test -v ./... ãƒ»-cover ãƒ†ã‚¹ãƒˆæ™‚ã«ã€xxxxx_test.goãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ãƒ•ã‚¡ã‚¤ãƒ«ã®å‘½ä»¤ç¶²ç¾…ã®ç¶²ç¾…ç‡ã‚’è§£æã™ã‚‹ã€‚åå¯¾ã«ã€xxxxx_test.goãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã‘ã‚Œã°ã€ãã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç¶²ç¾…ç‡ã¯è§£æã—ãªã„ã€‚ç¶²ç¾…æ¡ä»¶ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_testing_based_on_code.html $ go test -cover ./... "},"public/software/software_application_procedural_language_go_logic_method_data.html":{"url":"public/software/software_application_procedural_language_go_logic_method_data.html","title":"ğŸ“– ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ‡ãƒ¼ã‚¿","keywords":"","body":"ãƒ¡ã‚½ãƒƒãƒ‰ã€ãƒ‡ãƒ¼ã‚¿ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ‡ãƒ¼ã‚¿å‹ ãƒ‡ãƒ¼ã‚¿å‹ã®ç¨®é¡ ãƒ»ãƒ‡ãƒ¼ã‚¿å‹ã®åˆæœŸå€¤ ãƒ‡ãƒ¼ã‚¿å‹ã«ã¯ã€å€¤ãŒä»£å…¥ã•ã‚Œã¦ã„ãªã„æ™‚ã€åˆæœŸå€¤ãŒä»£å…¥ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã«å±ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ ãƒ‡ãƒ¼ã‚¿å‹ è¡¨è¨˜ åˆæœŸå€¤ æ•°å€¤ intã€float 0 æ–‡å­—åˆ— string \"\"ï¼ˆç©ºæ–‡å­—ï¼‰ çœŸå½å€¤ boolean false ãƒ»åˆæˆå‹ã«å±ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ ãƒ‡ãƒ¼ã‚¿å‹ è¡¨è¨˜ åˆæœŸå€¤ æ§‹é€ ä½“ struct é…åˆ— [i] ãƒ»å‚ç…§å‹ã«å±ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ ãƒ‡ãƒ¼ã‚¿å‹ è¡¨è¨˜ åˆæœŸå€¤ ãƒã‚¤ãƒ³ã‚¿ * nil ã‚¹ãƒ©ã‚¤ã‚¹ [] nilï¼ˆè¦ç´ æ•°ã€å®¹é‡ï¼š0ï¼‰ ãƒãƒƒãƒ— nil ãƒãƒ£ãƒãƒ« nil ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã®ã¾ã¨ã‚ ãƒ»ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã¨ã¯ ï¼Šå®Ÿè£…ä¾‹ï¼Š // å®šç¾©ï¼ˆåˆæœŸå€¤ã¨ã—ã¦ã€0ã€ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ï¼‰ var number int // ä»£å…¥ number = 5 ãƒ»Defined Typeã«ã‚ˆã‚‹ç‹¬è‡ªã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ Defined Typeã‚’ç”¨ã„ã¦ã€ç‹¬è‡ªã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã‚’å®šç¾©ã™ã‚‹ã€‚å…ƒã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã¨ã¯äº’æ›æ€§ãŒãªããªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š intå‹ã‚’å…ƒã«ã€Ageå‹ã‚’å®šç¾©ã™ã‚‹ã€‚ type Age int ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å‹ã‚’å…ƒã«ã€MyAppWriterå‹ã‚’å®šç¾©ã™ã‚‹ã€‚ type MyAppWriter io.Writer ãƒ»ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã¨ãƒ¡ãƒ¢ãƒªã®é–¢ä¿‚ ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã®å¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿å‹ã®ãƒã‚¤ãƒˆæ•°ã«å¿œã˜ã¦ã€ç©ºã„ã¦ã„ã‚‹ãƒ¡ãƒ¢ãƒªé ˜åŸŸã«ã€å¤‰æ•°ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ä¸€ã¤ã®ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹å½“ãŸã‚Šï¼‘ãƒã‚¤ãƒˆã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»å„ãƒ‡ãƒ¼ã‚¿å‹ã®ã‚µã‚¤ã‚º ç¨®é¡ å‹å ã‚µã‚¤ã‚º(bit) èª¬æ˜ intï¼ˆç¬¦å·ä»˜ãæ•´æ•°ï¼‰ int8 8 int16 16 int32 32 int64 64 int 32 or 64 å®Ÿè£…ç’°å¢ƒã«ã‚ˆã£ã¦ç•°ãªã‚‹ã€‚ uintï¼ˆç¬¦å·ãªã—æ•´æ•°ï¼‰ uint8 8 uint16 16 unit32 32 uint64 64 uint 32 or 64 å®Ÿè£…ç’°å¢ƒã«ã‚ˆã£ã¦ç•°ãªã‚‹ã€‚ floatï¼ˆæµ®å‹•å°æ•°ç‚¹ï¼‰ float32 32 float64 64 complexï¼ˆè¤‡ç´ æ•°ï¼‰ complex64 64 å®Ÿéƒ¨ï¼šfloat32ã€è™šéƒ¨ï¼šfloat32 complex128 128 å®Ÿéƒ¨ï¼šfloat64ã€è™šéƒ¨ï¼šfloat64 æ§‹é€ ä½“ ãƒ»æ§‹é€ ä½“ã¨ã¯ ä»–ã®è¨€èªã§ã„ã†ã€ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’ä¿æŒã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã«ç›¸å½“ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ§‹é€ ä½“ã‚’å®šç¾©ã—ã€å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã€‚ var person struct { Name string } ãƒ»Defined Typeã«ã‚ˆã‚‹ç‹¬è‡ªã®æ§‹é€ ä½“ Defined Typeã‚’ç”¨ã„ã¦ã€ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿å‹ã®æ§‹é€ ä½“ã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã®é ­æ–‡å­—ã‚’å¤§æ–‡å­—ã«ã—ãŸå ´åˆã¯ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å¤–ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã«ã€å°æ–‡å­—ã«ã—ãŸå ´åˆã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã¤æ§‹é€ ä½“ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚ type Person struct { // ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Name string } ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã¤æ§‹é€ ä½“ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚ type Person struct { // ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ name string } ãƒ»ä½¿ç”¨ä¸å¯ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å å°æ–‡å­—ã®ã€typeã€ã¯äºˆç´„èªã®ãŸã‚ä½¿ç”¨ä¸å¯ã§ã‚ã‚‹ã€‚å¤§æ–‡å­—ã®Typeã¯å¯èƒ½ã€‚ type Person struct { // å®šç¾©ä¸å¯ã‚¨ãƒ©ãƒ¼ type string // å®šç¾©å¯èƒ½ Type string } ãƒ»åˆæœŸåŒ– ã™ã§ã«å€¤ãŒä»£å…¥ã•ã‚Œã¦ã„ã‚‹æ§‹é€ ä½“ã‚’åˆæœŸåŒ–ã™ã‚‹å ´åˆã€ã„ãã¤ã‹è¨˜æ³•ãŒã‚ã‚‹ã€‚ãã®ä¸­ã§ã¯ã€ã‚¿ã‚°ä»˜ããƒªãƒ†ãƒ©ãƒ«ãŒæ¨å¥¨ã•ã‚Œã‚‹ã€‚åˆæœŸåŒ–ã«ã‚ˆã£ã¦æ§‹ç¯‰ã™ã‚‹æ§‹é€ ä½“ã¯ã€ãƒã‚¤ãƒ³ã‚¿å‹ã¾ãŸã¯éãƒã‚¤ãƒ³ã‚¿å‹ã®ã„ãšã‚Œã§ã‚‚å•é¡Œãªã„ã€‚ãŸã ã—ã€å¤šãã®é–¢æ•°ãŒãƒã‚¤ãƒ³ã‚¿å‹ã‚’å¼•æ•°å‹ã¨ã—ã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ã€ãã‚Œã«åˆã‚ã›ã¦ãƒã‚¤ãƒ³ã‚¿å‹ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã¾ãšã¯ã€ã‚¿ã‚°ä»˜ããƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã€‚ package main import \"fmt\" type Person struct { Name string } func main() { person := &Person{ // ã‚¿ã‚°ä»˜ããƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ Name: \"Hiroki\", } fmt.Printf(\"%#v\\n\", person.Name) // \"Hiroki\" } äºŒã¤ç›®ã«ã€ã‚¿ã‚°ç„¡ã—ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ãŒã‚ã‚‹ã€‚ package main import \"fmt\" type Person struct { Name string } func main() { person := &Person{ // ã‚¿ã‚°ç„¡ã—ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ \"Hiroki\", } fmt.Printf(\"%#v\\n\", person.Name) // \"Hiroki\" } ä¸‰ã¤ç›®ã«ã€newé–¢æ•°ã¨ãƒ‡ãƒ¼ã‚¿ä»£å…¥ã«ã‚ˆã‚‹åˆæœŸåŒ–ãŒã‚ã‚‹ã€‚newé–¢æ•°ã¯ã€ãƒ‡ãƒ¼ã‚¿ãŒä»£å…¥ã•ã‚Œã¦ã„ãªã„æ§‹é€ ä½“ã‚’ä½œæˆã™ã‚‹ãŸã‚ã€ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜æ™‚ã§ã‚‚è¡¨ç¾ã§ãã‚‹ã€‚newé–¢æ•°ã¯ã€æ§‹é€ ä½“ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿å‹ã§ã‚‚ä½¿ç”¨ã§ãã‚‹ã€‚ãƒã‚¤ãƒ³ã‚¿å‹ã®æ§‹é€ ä½“ã‚’è¿”å´ã™ã‚‹ã€‚ package main import \"fmt\" type Person struct { Name string } /** * å‹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ * â€»ã‚¹ã‚³ãƒ¼ãƒ—ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã®ã¿ã¨ã™ã‚‹ã€‚ */ func newPerson(name string) *Person { // newé–¢æ•°ã‚’ç”¨ã„ã‚‹ã€‚ // &Person{} ã«åŒã˜ã€‚ person := new(Person) // ãƒã‚¤ãƒ³ã‚¿å‹ã®åˆæœŸåŒ–ã•ã‚ŒãŸæ§‹é€ ä½“ãŒè¿”å´ã•ã‚Œã‚‹ã€‚ fmt.Printf(\"%#v\\n\", person) // &main.Person{Name:\"\"} // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ä»£å…¥ã™ã‚‹ person.Name = name return person } func main() { person := newPerson(\"Hiroki\") fmt.Printf(\"%#v\\n\", person.Name) // \"Hiroki\" } ãƒ»DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦æ§‹é€ ä½“ã‚’ä¿æŒã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ä¾å­˜é–¢ä¿‚ã‚’æ§‹æˆã™ã‚‹ã€‚ä¾å­˜ã•ã‚Œã‚‹å´ã‚’ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã€ã¾ãŸä¾å­˜ã™ã‚‹å´ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã„ã†ã€‚æ§‹é€ ä½“é–“ã«ä¾å­˜é–¢ä¿‚ã‚’æ§‹æˆã™ã‚‹ã«ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã‚’æ³¨å…¥ã™ã‚‹ã€‚æ³¨å…¥æ–¹æ³•ã«ã¯ã€ã€Constructor Injectionã€ã€Setter Injectionã€ã€Setter Injectionã€ãŒã‚ã‚‹ã€‚è©³ã—ãã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based.html package main import \"fmt\" //======================== // ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å´ //======================== type Name struct { FirstName string LastName string } func NewName(firstName string, lastName string) *Name { return &Name{ FirstName: firstName, LastName: lastName, } } func (n *Name) fullName() string { return fmt.Sprintf(\"%s %s\", n.FirstName, n.LastName) } //======================== // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ //======================== type Person struct { Name *Name } func NewPerson(name *Name) *Person { return &Person{ Name: name, } } func (p *Person) getName() *Name { return p.Name } func main() { name := NewName(\"Hiroki\", \"Hasegawa\") // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹DI person := NewPerson(name) fmt.Printf(\"%#v\\n\", person.getName().fullName()) // \"Hiroki Hasegawa\" } ãƒ»åŸ‹ã‚è¾¼ã¿ã«ã‚ˆã‚‹å§”è­² Goã«ã¯ç¶™æ‰¿ãŒãªãã€ä»£ã‚ã‚Šã«å§”è­²ãŒã‚ã‚‹ã€‚æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦åˆ¥ã®æ§‹é€ ä½“ã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ã«ã‚ˆã‚Šã€åŸ‹ã‚è¾¼ã¾ã‚ŒãŸæ§‹é€ ä½“ã«å‡¦ç†ã‚’å§”è­²ã™ã‚‹ã€‚å§”è­²ã™ã‚‹å´ã®æ§‹é€ ä½“ã‚’å®£è¨€ã™ã‚‹ã ã‘ã§ãªãã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã®æ™‚ã€å®Ÿè£…è€…ãŒå§”è­²ã‚’æ„è­˜ã—ãªãã¦è‰¯ããªã‚‹ã‚ˆã†ã«ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ä¸­ã§åˆæœŸåŒ–ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å§”è­²ã¨ã¯ç•°ãªã‚Šã€ã‚¢ãƒƒãƒ—ã‚­ãƒ£ã‚¹ãƒˆã¯è¡Œãˆãªã„ã€‚ã¤ã¾ã‚Šã€å§”è­²ã•ã‚ŒãŸæ§‹é€ ä½“ã¯å§”è­²ã™ã‚‹æ§‹é€ ä½“ã®ãƒ‡ãƒ¼ã‚¿å‹ã«ã‚­ãƒ£ã‚¹ãƒˆã§ãã€åŒä¸€ã®ãƒ‡ãƒ¼ã‚¿å‹ã¨ã—ã¦æ‰±ãˆãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" //======================== // å§”è­²ã™ã‚‹å´ï¼ˆåŸ‹ã‚è¾¼ã‚€æ§‹é€ ä½“ï¼‰ //======================== type Name struct { FirstName string LastName string } func (n *Name) fullName() string { return fmt.Sprintf(\"%s %s\", n.FirstName, n.LastName) } //======================== // å§”è­²ã•ã‚Œã‚‹å´ï¼ˆåŸ‹ã‚è¾¼ã¾ã‚Œã‚‹æ§‹é€ ä½“ï¼‰ //======================== type MyName struct { *Name } func NewMyName(firstName string, lastName string) *MyName { return &MyName{ // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å†…ã§å§”è­²ã™ã‚‹æ§‹é€ ä½“ã‚’åˆæœŸåŒ–ã™ã‚‹ã€‚ Name: &Name{ FirstName: firstName, LastName: lastName, }, } } //================ // main //================ func main() { myName := NewMyName(\"Hiroki\", \"Hasegawa\") // myNameæ§‹é€ ä½“ã¯ã€Nameæ§‹é€ ä½“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ fmt.Printf(\"%#v\\n\", myName.fullName()) // \"Hiroki Hasegawa\" } ã‚‚ã—ã€å§”è­²ã™ã‚‹å´ã¨å§”è­²ã•ã‚Œã‚‹å´ã«ã€åŒã˜åå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ï¼ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã€å§”è­²ã•ã‚ŒãŸå´ã®ã‚‚ã®ãŒå„ªå…ˆã—ã¦ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ package main import \"fmt\" //======================== // å§”è­²ã™ã‚‹å´ï¼ˆåŸ‹ã‚è¾¼ã‚€æ§‹é€ ä½“ï¼‰ //======================== type Name struct { FirstName string LastName string } func (n *Name) fullName() string { return fmt.Sprintf(\"%s %s\", n.FirstName, n.LastName) } //======================== // å§”è­²ã•ã‚Œã‚‹å´ï¼ˆåŸ‹ã‚è¾¼ã¾ã‚Œã‚‹æ§‹é€ ä½“ï¼‰ //======================== type MyName struct { *Name } func NewMyName(firstName string, lastName string) *MyName { return &MyName{ // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å†…ã§å§”è­²ã™ã‚‹æ§‹é€ ä½“ã‚’åˆæœŸåŒ–ã™ã‚‹ã€‚ Name: &Name{ FirstName: firstName, LastName: lastName, }, } } // å§”è­²ã™ã‚‹å´ã¨å§”è­²ã•ã‚Œã‚‹å´ã§åŒã˜ãƒ¡ã‚½ãƒƒãƒ‰ func (n *MyName) fullName() string { return fmt.Sprintf(\"%s\", \"å§”è­²ã•ã‚ŒãŸæ§‹é€ ä½“ã§ã™\") } //================ // main //================ func main() { myName := NewMyName(\"Hiroki\", \"Hasegawa\") // åŒã˜ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹å ´åˆã€å§”è­²ã•ã‚ŒãŸå´ãŒå„ªå…ˆã€‚ fmt.Printf(\"%#v\\n\", myName.fullName()) // \"å§”è­²ã•ã‚ŒãŸæ§‹é€ ä½“ã§ã™\" } ãƒ»ç„¡åæ§‹é€ ä½“ æ§‹é€ ä½“ã®å®šç¾©ã¨åˆæœŸåŒ–ã‚’åŒæ™‚ã«è¡Œã†ã€‚æ§‹é€ ä½“ã«åå‰ãŒãªãã€ãƒ‡ãƒ¼ã‚¿å‹ã‚’å‰²ã‚Šå½“ã¦ã‚‰ã‚Œãªã„ãŸã‚ã€è¿”å´å€¤ã¨ã—ã¦ã¯ä½¿ç”¨ã§ããªã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" type Person struct { Name string } func main() { person := &struct { Name string }{ // ã‚¿ã‚°ä»˜ããƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ï¼ˆã‚¿ã‚°ç„¡ã—ãƒªãƒ†ãƒ©ãƒ«è¡¨è¨˜ã‚‚å¯èƒ½ï¼‰ Name: \"Hiroki\", } fmt.Printf(\"%#v\\n\", person.Name) // \"Hiroki\" } JSON ãƒ»JSONã¨æ§‹é€ ä½“ã®ãƒãƒƒãƒ”ãƒ³ã‚° æ§‹é€ ä½“ã¨JSONã®é–“ã§ãƒ‘ãƒ¼ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã€æ§‹é€ ä½“ã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã€JSONã®ã‚­ãƒ¼åã‚’ã€ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¦ãŠãã“ã¨ãŒã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"encoding/json\" \"fmt\" \"log\" ) type Person struct { Name string `json:\"name\"` } func main() { person := &Person{ Name: \"Hiroki\", } byteJson, err := json.Marshal(person) if err != nil { log.Println(\"JSONã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\") } // ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰çµæœã‚’å‡ºåŠ› fmt.Printf(\"%#v\\n\", string(byteJson)) // \"{\\\"Name\\\":\\\"Hiroki\\\"}\" } ãƒ»omitempty å€¤ãŒã€falseã€0ã€nilã€ç©ºé…åˆ—ã€ç©ºsliceã€ç©ºmapã€ç©ºæ–‡å­—ã€ã®æ™‚ã«ã€JSONã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã§ã“ã‚Œã‚’é™¤å¤–ã§ãã‚‹ã€‚æ§‹é€ ä½“ã‚’é™¤å¤–ã—ãŸã„å ´åˆã¯ã€nilã«ãªã‚Šã†ã‚‹ãƒã‚¤ãƒ³ã‚¿å‹ã¨ã—ã¦ãŠãã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"encoding/json\" \"fmt\" \"log\" ) type Person struct { // falseã€0ã€nilã€ç©ºé…åˆ—ã€ç©ºsliceã€ç©ºmapã€ç©ºæ–‡å­—ã‚’é™¤å¤–ã§ãã‚‹ã€‚ Id int `json:\"id\"` // æ§‹é€ ä½“ã¯ãƒã‚¤ãƒ³ã‚¿å‹ã¨ã—ã¦ãŠã Name *Name `json:\"name,omitempty\"` } type Name struct { FirstName string `json:\"first_name\"` LastName string `json:\"last_name\"` } func main() { person := &Person{ Id: 1, // Nameæ§‹é€ ä½“ã¯nilã«ã—ã¦ãŠã } byteJson, err := json.Marshal(person) if err != nil { log.Println(\"JSONã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\") } // ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰çµæœã‚’å‡ºåŠ› fmt.Printf(\"%#v\\n\", string(byteJson)) // \"{\\\"id\\\":1}\" } é…åˆ— ãƒ»é…åˆ—ã¨ã¯ è¦ç´ ã€å„è¦ç´ ã®ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã‹ã‚‰ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã“ã¨ã€‚ ãƒ»å®£è¨€ã¨ä»£å…¥ é…åˆ—ã‚’å®£è¨€ã—ã€å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å®£è¨€ã¨ä»£å…¥ã‚’åˆ¥ã€…ã«è¡Œã†ã€‚ã¾ãŸã€è¦ç´ æ•°ã®å®šç¾©ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ package main import \"fmt\" func main() { var z [2]string z[0] = \"Hiroki\" z[1] = \"Gopher\" fmt.Printf(\"%#v\\n\", z) // [Hiroki Gopher] fmt.Printf(\"%#v\\n\", z) // [2]string{\"Hiroki\", \"Gopher\"} } å®£è¨€ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†ã€‚ã¾ãŸã€è¦ç´ æ•°ã®å®šç¾©ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ package main import \"fmt\" func main() { var y [2]string = [2]string{\"Hiroki\", \"Gopher\"} fmt.Printf(\"%#v\\n\", y) // [Hiroki Gopher] fmt.Printf(\"%#v\\n\", y) // [2]string{\"Hiroki\", \"Gopher\"} } å®£è¨€ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†ã€‚ã¾ãŸã€å‹æ¨è«–ã¨è¦ç´ æ•°çœç•¥ã‚’è¡Œã†ã€‚ package main import \"fmt\" func main() { x := [...]string{\"Hiroki\", \"Gopher\"} fmt.Printf(\"%#v\\n\", x) // [Hiroki Gopher] fmt.Printf(\"%#v\\n\", x) // [2]string{\"Hiroki\", \"Gopher\"} } ãƒ»é…åˆ—ã¨ãƒ¡ãƒ¢ãƒªã®é–¢ä¿‚ é…åˆ—å‹ã®å¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã¨ã€ç©ºã„ã¦ã„ã‚‹ãƒ¡ãƒ¢ãƒªé ˜åŸŸã«ã€é…åˆ—ãŒã¾ã¨ã¾ã£ã¦å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ä¸€ã¤ã®ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹å½“ãŸã‚Šï¼‘ãƒã‚¤ãƒˆã«ç›¸å½“ã™ã‚‹ã€‚ ãƒã‚¤ãƒ³ã‚¿ ãƒ»ãƒã‚¤ãƒ³ã‚¿å‹ã¨ã¯ ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä»£å…¥ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã®ã“ã¨ã€‚ ãƒ»å‚ç…§æ¼”ç®—å­ï¼ˆ&ï¼‰ å®šç¾©ã•ã‚ŒãŸå¤‰æ•°ã«å¯¾ã—ã¦ã€&ï¼ˆã‚¢ãƒ³ãƒ‘ã‚µãƒ³ãƒ‰ï¼‰ã‚’å®£è¨€ã™ã‚‹ã¨ã€ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‚ç…§ã§ãã‚‹ã€‚å‚ç…§ã—ãŸãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹å€¤ã¯ã€ãƒã‚¤ãƒ³ã‚¿å‹ã®å¤‰æ•°ã«ä»£å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŒã€å‹æ¨è«–ã§è¨˜è¿°ã™ã‚Œã°ã“ã‚Œã‚’æ„è­˜ã—ãªãã¦ã‚ˆã„ã€‚PHPã«ãŠã‘ã‚‹ãƒã‚¤ãƒ³ã‚¿ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_class_based_method_data.html ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func main() { x := \"a\" // ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‚ç…§ã™ã‚‹ã€‚ var p *string = &x // p := &x ã¨åŒã˜ // ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‚ç…§ã™ã‚‹å‰ fmt.Printf(\"%#v\\n\", x) // \"a\" // ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‚ç…§ã—ãŸå¾Œ fmt.Printf(\"%#v\\n\", p) // (*string)(0xc0000841e0) } ãƒ»é–“æ¥å‚ç…§æ¼”ç®—å­ï¼ˆ*ï¼‰ ãƒã‚¤ãƒ³ã‚¿å‹ã®å¤‰æ•°ã«å¯¾ã—ã¦ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã‚’å®£è¨€ã™ã‚‹ã¨ã€ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®å®Ÿä½“ã‚’å–å¾—ã§ãã‚‹ã€‚ãƒã‚¤ãƒ³ã‚¿ã‚’ç”¨ã„ã¦ãƒ‡ãƒ¼ã‚¿ã®å®Ÿä½“ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚’ã€é€†å‚ç…§ï¼ˆãƒ‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ï¼‰ã€ã¨ã„ã†ã€‚ package main import \"fmt\" func main() { x := \"a\" p := &x // ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã®å®Ÿä½“ã‚’å–å¾—ã™ã‚‹ï¼ˆãƒ‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ï¼‰ã€‚ y := *p // ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‚ç…§ã™ã‚‹å‰ fmt.Printf(\"%#v\\n\", x) // \"a\" // ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‚ç…§ã—ãŸå¾Œ fmt.Printf(\"%#v\\n\", p) // (*string)(0xc0000841e0) // ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ fmt.Printf(\"%#v\\n\", y) // \"a\" } ãƒ»ãƒã‚¤ãƒ³ã‚¿å‹ã§æ‰±ã†ã¹ããƒ‡ãƒ¼ã‚¿å‹ ãƒ‡ãƒ¼ã‚¿å‹ ãƒã‚¤ãƒ³ã‚¿å‹ã§æ‰±ã†ã¹ãã‹ èª¬æ˜ æ§‹é€ ä½“ â—¯ ãƒã‚¤ãƒ³ã‚¿å‹ã¨ã—ã¦æ‰±ã†ã¨ã€æ§‹é€ ä½“ãŒæŒã¤ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‡¦ç†ã™ã‚‹ã ã‘ã§ã‚ˆããªã‚‹ã€‚ãƒã‚¤ãƒ³ã‚¿å‹ã¨ã—ãªã„å ´åˆã¨æ¯”ã¹ã¦ã€å°‘ãªã„ãƒ¡ãƒ¢ãƒªæ¶ˆè²»ã§æ§‹é€ ä½“ã‚’æ‰±ãˆã‚‹ã€‚ sliceã€mapã€chanã€ func â–³ ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã®å¤§ãã•ã«ã‚ˆã‚‹ã€‚ ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ Ã— ãƒã‚¤ãƒ³ã‚¿å‹ã§æ‰±ã†ãƒ¡ãƒªãƒƒãƒˆã¯ãªã„ã€‚ ã‚¹ãƒ©ã‚¤ã‚¹ ãƒ»ã‚¹ãƒ©ã‚¤ã‚¹ã¨ã¯ å‚ç…§å…ˆã®é…åˆ—ã«å¯¾ã™ã‚‹ãƒã‚¤ãƒ³ã‚¿ã€é•·ã•ã€å®¹é‡ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿å‹ã§ã‚ã‚‹ã€‚ // Goã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚ˆã‚Š type slice struct { array unsafe.Pointer len int cap int } å‚è€ƒï¼šhttps://github.com/golang/go/blob/04a4dca2ac3d4f963e3c740045ce7a2959bf0319/src/runtime/slice.go#L13-L17 ãƒ»å®£è¨€ã¨ä»£å…¥ ï¼Šå®Ÿè£…ä¾‹ï¼Š å®£è¨€ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†ã€‚ package main import \"fmt\" func main() { var y []string = []string{\"Hiroki\", \"Gopher\"} fmt.Printf(\"%+v\\n\", y) // [Hiroki Gopher] fmt.Printf(\"%#v\\n\", y) // []string{\"Hiroki\", \"Gopher\"} } æ–‡å­—åˆ—ã®å®£è¨€ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†ã€‚ã¾ãŸã€å‹æ¨è«–ã‚’è¡Œã†ã€‚ package main import \"fmt\" func main() { x := []string{\"Hiroki\", \"Gopher\"} fmt.Printf(\"%+v\\n\", x) // [Hiroki Gopher] fmt.Printf(\"%#v\\n\", x) // []string{\"Hiroki\", \"Gopher\"} } ãƒã‚¤ãƒˆæ–‡å­—åˆ—ã®å®£è¨€ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†ã€‚ã¾ãŸã€å‹æ¨è«–ã‚’è¡Œã†ã€‚ package main import \"fmt\" func main() { x := []byte(\"abc\") fmt.Printf(\"%+v\\n\", x) // [97 98 99] fmt.Printf(\"%#v\\n\", x) // []byte{0x61, 0x62, 0x63} } æ§‹é€ ä½“ã®ã‚¹ãƒ©ã‚¤ã‚¹ã®å®£è¨€ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†ã€‚ã¾ãŸã€å‹æ¨è«–ã‚’è¡Œã†ã€‚ package main import \"fmt\" type Person struct { Name string } func main() { person := []Person{{Name: \"Hiroki\"}} fmt.Printf(\"%+v\\n\", person) // [{Name:Hiroki}] fmt.Printf(\"%#v\\n\", person) // []main.Person{main.Person{Name:\"Hiroki\"}} } ãƒ»é…åˆ—ã®å€¤ã®å‚ç…§ å…¨ã¦ã®ã‚¹ãƒ©ã‚¤ã‚¹ãŒå…±é€šã®é…åˆ—ã‚’å‚ç…§ã—ã¦ã„ã‚‹ãŸã‚ã€ä¾‹ãˆã°ã€xbå¤‰æ•°ã—ã‹ä¸Šæ›¸ãã—ã¦ã„ãªã„ã®ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ä»–ã®ã‚¹ãƒ©ã‚¤ã‚¹ã«ã‚‚ãã®ä¸Šæ›¸ããŒåæ˜ ã•ã‚Œã‚‹ã€‚ package main import \"fmt\" func main() { // æœ€å¾Œã®è¦ç´ ã®å¾Œã«ã‚‚ã‚«ãƒ³ãƒãŒå¿…è¦ã§ã‚ã‚‹ã€‚ x := [5]string{\"ã‚\", \"ã„\", \"ã†\", \"ãˆ\", \"ãŠ\"} fmt.Printf(\"%#v\\n\", x) // [5]string{\"ã‚\", \"ã„\", \"ã†\", \"ãˆ\", \"ãŠ\"} // 0ã‹ã‚‰3ç•ªç›®ã‚’å‚ç…§ã™ã‚‹ã€‚ xa := x[0:3] fmt.Printf(\"%#v\\n\", xa) // []string{\"ã‚\", \"ã„\", \"ã†\"} // 2ã‹ã‚‰5ç•ªç›®ã‚’å‚ç…§ã™ã‚‹ã€‚ xb := x[2:5] fmt.Printf(\"%#v\\n\", xb) // []string{\"ã†\", \"ãˆ\", \"ãŠ\"} // xbã‚¹ãƒ©ã‚¤ã‚¹ã®0ç•ªç›®ï¼ˆ\"ã†\"ï¼‰ã‚’ä¸Šæ›¸ãã™ã‚‹ã€‚ xb[0] = \"Hiroki\" // xbã—ã‹ä¸Šæ›¸ãã—ã¦ã„ãªã„ãŒã€ä»–ã®ã‚¹ãƒ©ã‚¤ã‚¹ã«ã‚‚åæ˜ ã•ã‚Œã‚‹ã€‚ fmt.Printf(\"%#v\\n\", xa) // []string{\"ã‚\", \"ã„\", \"Hiroki\"} fmt.Printf(\"%#v\\n\", xb) // []string{\"Hiroki\", \"ãˆ\", \"ãŠ\"} fmt.Printf(\"%#v\\n\", x) // [5]string{\"ã‚\", \"ã„\", \"Hiroki\", \"ãˆ\", \"ãŠ\"} } ãƒ»è¦ç´ ã®è¿½åŠ  æ¸¡ã•ã‚ŒãŸã‚¹ãƒ©ã‚¤ã‚¹ã§ã€å¾Œã‚ã‹ã‚‰è¦ç´ ã‚’è¿½åŠ ã™ã‚‹ã€‚ package main import ( \"fmt\" ) func main() { s := []int{10, 20, 30, 40} fmt.Println(s) // [10 20 30 40] // è¦ç´ ã‚’è¿½åŠ ã€‚ s = append(s, 50, 60, 70, 80) fmt.Println(s) // [10 20 30 40 50 60 70 80] } ãƒãƒƒãƒ— ãƒ»å˜ä¸€ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã‚’å€¤ã«æŒã¤ãƒãƒƒãƒ— ãƒãƒƒãƒ—ã®å®šç¾©ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†ã€‚ package main import \"fmt\" func main() { // ã€æ•°å€¤:æ–‡å­—åˆ—ã€ã®ãƒãƒƒãƒ— m := map[int]string{ 0: \"Hiroki\", 1: \"Hiroko\", 2: \"Hiroshi\", } fmt.Println(m) // map[0:Hiroki 1:Hiroko 2:Hiroshi] } å®šç¾©ã¨ä»£å…¥ã‚’åˆ¥ã€…ã«è¡Œã†ã€‚ package main import \"fmt\" func main() { // ã€æ•°å€¤:æ–‡å­—åˆ—ã€ã®ãƒãƒƒãƒ— m := map[int]string{} m[0] = \"Hiroki\" m[1] = \"Hiroshi\" m[2] = \"Hiroshi\" fmt.Println(m) // map[0:Hiroki 1:Hiroko 2:Hiroshi] } ã¾ãŸã¯ã€makeé–¢æ•°ã‚’ç”¨ã„ã¦ãƒãƒƒãƒ—ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ package main import \"fmt\" func main() { // ã€æ•°å€¤:æ–‡å­—åˆ—ã€ã®ãƒãƒƒãƒ— m := make(map[int]string) m[0] = \"Hiroki\" m[1] = \"Hiroshi\" m[2] = \"Hiroshi\" fmt.Println(m) // map[0:Hiroki 1:Hiroko 2:Hiroshi] } ãƒ»ã‚¹ãƒ©ã‚¤ã‚¹å‹ã‚’å€¤ã«æŒã¤ãƒãƒƒãƒ— package main import ( \"fmt\" ) func main() { // ã€æ–‡å­—åˆ—:ã‚¹ãƒ©ã‚¤ã‚¹ã€ã®ãƒãƒƒãƒ— m := map[string][]string{ \"errors\": { 0: \"ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸0\", 1: \"ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸1\", 2: \"ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸2\", }, } fmt.Println(m) // map[errors:[ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸0 ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸1 ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸2]] } ãƒ»è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’æŒã¤ãƒãƒƒãƒ— ãƒãƒƒãƒ—å‹ãƒ‡ãƒ¼ã‚¿ã®å€¤ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã¨ã™ã‚‹ã“ã¨ã§ã€è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’è¡¨ç¾ã§ãã‚‹ã€‚ package main import \"fmt\" func main() { // ã€æ–‡å­—åˆ—:è¤‡æ•°ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã€ã®ãƒãƒƒãƒ— m := map[string]interface{}{ \"id\": 1, \"name\": \"Hiroki Hasegawa\", } fmt.Println(m) // map[id:1 name:Hiroki Hasegawa] } ãƒ»ãƒãƒƒãƒ—å€¤ã®æŠ½å‡º package main import \"fmt\" func main() { m := map[int]string{ 1: \"Hiroki\", 2: \"Hiroko\", 3: \"Hiroshi\", } // å€¤ã®æŠ½å‡º v, ok := m[1] // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° if ok != true { fmt.Println(\"Value is not found.\") // Value is not found. } fmt.Println(v) // Hiroki } ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ãƒ»åŸ‹ã‚è¾¼ã¿ã«ã‚ˆã‚‹å§”è­² æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦åˆ¥ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ã«ã‚ˆã‚Šã€åŸ‹ã‚è¾¼ã¾ã‚ŒãŸæ§‹é€ ä½“ã«å‡¦ç†ã®å…¨ã¦ã‚’å§”è­²ã™ã‚‹ã€‚ãŸã ã—ã€æ§‹é€ ä½“ã«æ˜ç¤ºçš„ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’åŸ‹ã‚è¾¼ã‚€å¿…è¦ã¯ãªãã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æº€ãŸã™é–¢æ•°ã‚’æ§‹é€ ä½“ã«ç´ä»˜ã‘ã‚‹ã¨ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æš—é»™çš„ã«å®Ÿè£…ã§ãã‚‹ã€‚æ§‹é€ ä½“ã®å§”è­²ã¨ã¯ç•°ãªã‚Šã€ã‚¢ãƒƒãƒ—ã‚­ãƒ£ã‚¹ãƒˆã‚’è¡Œãˆã‚‹ã€‚ã¤ã¾ã‚Šã€å§”è­²ã•ã‚ŒãŸæ§‹é€ ä½“ã¯å§”è­²ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿å‹ã«ã‚­ãƒ£ã‚¹ãƒˆã§ãã€åŒä¸€ã®ãƒ‡ãƒ¼ã‚¿å‹ã¨ã—ã¦æ‰±ãˆã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š InspectImplæ§‹é€ ä½“ã«Animalã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’åŸ‹ã‚è¾¼ã¿ã€æ§‹é€ ä½“ã«Eatãƒ¡ã‚½ãƒƒãƒ‰ã€Sleepãƒ¡ã‚½ãƒƒãƒ‰ã€Matingãƒ¡ã‚½ãƒƒãƒ‰ã€ã®å‡¦ç†ã‚’å§”è­²ã™ã‚‹ã€‚ package main import \"fmt\" // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã™ã‚‹ã€‚ type AnimalInterface interface { Name() string Eat() string Sleep() string } type InsectImpl struct { name string } type FishImpl struct { name string } type MammalImpl struct { name string } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ func NewInsect(name string) (*InsectImpl, error) { return &InsectImpl{ name: name, }, nil } // æ§‹é€ ä½“ã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æš—é»™çš„ã«å®Ÿè£…ã™ã‚‹ã€‚ func (i *InsectImpl) Name() string { return i.name } func (i *InsectImpl) Eat() string { return \"é£Ÿã¹ã‚‹\" } func (i *InsectImpl) Sleep() string { return \"çœ ã‚‹\" } func main() { insect, err := NewInsect(\"ã‚«ãƒ–ãƒˆãƒ ã‚·\") if err != nil { fmt.Println(err) } // ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ fmt.Println(insect.Name()) fmt.Println(insect.Eat()) fmt.Println(insect.Sleep()) } ãƒ»ã‚¢ãƒƒãƒ—ã‚­ãƒ£ã‚¹ãƒˆã®å¯å¦ã‚’åˆ©ç”¨ã—ãŸæ¤œè¨¼ ã‚‚ã—ã€æ§‹é€ ä½“ã«å®Ÿè£…ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã«ä¸è¶³ãŒã‚ã‚‹ã¨ã€å§”è­²ãŒè‡ªå‹•çš„ã«å–ã‚Šæ¶ˆã•ã‚Œã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ã¯ç™ºç”Ÿã—ãªã„ãŸã‚ã€å®Ÿè£…ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ãŒååˆ†ã§ã‚ã‚‹ã“ã¨ã‚’å®Ÿè£…è€…ãŒçŸ¥ã‚‰ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã‚¢ãƒƒãƒ—ã‚­ãƒ£ã‚¹ãƒˆã®å¯å¦ã‚’ç”¨ã„ã¦ã€æ„å›³çš„ã«ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/uber-go/guide/blob/master/style.md#verify-interface-compliance package main import \"fmt\" // ã‚¢ãƒƒãƒ—ã‚­ãƒ£ã‚¹ãƒˆã®å¯å¦ã‚’ç”¨ã„ã¦ã€æ§‹é€ ä½“ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ var _ AnimalInterface = &InsectImpl{} // ã‚‚ã—ãã¯ (*InsectImpl)(nil) // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã™ã‚‹ã€‚ type AnimalInterface interface { Name() string Eat() string } type InsectImpl struct { name string } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ func NewInsect(name string) (*InsectImpl, error) { return &InsectImpl{ name: name, }, nil } // æ§‹é€ ä½“ã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æš—é»™çš„ã«å®Ÿè£…ã™ã‚‹ã€‚ func (i *InsectImpl) Name() string { return i.name } func main() { insect, err := NewInsect(\"ã‚«ãƒ–ãƒˆãƒ ã‚·\") if err != nil { fmt.Println(err) } // ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ fmt.Println(insect.Name()) } # Eatãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç´ä»˜ã‘ã¦ã„ãªã„å ´åˆ cannot use insect (type Insect) as type Animal in assignment: Insect does not implement Animal (missing Eat method) ãƒ»ç·©ã„å‹ã¨ã—ã¦ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ æ§˜ã€…ãªå€¤ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã¨ã—ã¦å®šç¾©ã§ãã‚‹ã€‚ã¾ãŸã€ä»–ã®å‹ã«å¤‰æ›ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" ) func main() { var x interface{} x = 1 fmt.Printf(\"%#v\\n\", x) // 1 x = 3.14 fmt.Printf(\"%#v\\n\", x) // 3.14 x = \"Hiroki\" fmt.Printf(\"%#v\\n\", x) // \"Hiroki\" x = [...]uint8{1, 2, 3, 4, 5} fmt.Printf(\"%#v\\n\", x) // [5]uint8{0x1, 0x2, 0x3, 0x4, 0x5} } ãªãŠã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã¯ã¯æ¼”ç®—ã§ããªã„ã€‚ package main import ( \"fmt\" ) func main() { var x, y interface{} // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ x, y = 1, 2 fmt.Printf(\"%#v\\n\", x) // 1 fmt.Printf(\"%#v\\n\", y) // 2 // ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ // invalid operation: x + y (operator + not defined on interface) z := x + y fmt.Printf(\"%#v\\n\", z) } ãƒ»å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã‚’ä»–ã®å‹ã«å¤‰æ›ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã®å¤‰æ•°ã§ã€.(ãƒ‡ãƒ¼ã‚¿å‹)ã€ã‚’å®£è¨€ã™ã‚‹ã€‚ package main import ( \"fmt\" ) func main() { var x, y interface{} // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ x, y = 1, 2 // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã‹ã‚‰æ•´æ•°å‹ã«å¤‰æ›ï¼ˆå¤‰æ›ã—ãªã„ã¨æ¼”ç®—ã§ããªã„ï¼‰ a := x.(int) b := y.(int) z := a + b fmt.Printf(\"%#v\\n\", z) } ãƒ»errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ Goã«ã¯ã€æ¨™æº–æ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒã‚ã‚‹ã€‚ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒå¼·åˆ¶ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ãŸæ§‹é€ ä½“ã‚’å®šç¾©ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«å§”è­²ãŒè¡Œã‚ã‚Œã‚‹ã€‚ ï¼Šä¾‹ï¼Š errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å§”è­²ã«ã¤ã„ã¦ã¯ã€æœ¬ãƒãƒ¼ãƒˆå†…ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ type error interface { Error() string } ãƒ»stringã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ æ§‹é€ ä½“ã«Stringãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¦ãŠãã¨ã€Printç³»é–¢æ•°ã«æ§‹é€ ä½“ã‚’æ¸¡ã—ãŸæ™‚ã«ã€ã“ã‚ŒãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" type Foo struct{} func (f *Foo) String() string { return \"Stringãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã—ãŸã€‚\" } func main() { f := &Foo{} fmt.Println(f) } nil ãƒ»nilã¨ã¯ ã„ãã¤ã‹ã®ãƒ‡ãƒ¼ã‚¿å‹ã«ãŠã‘ã‚‹åˆæœŸå€¤ã®ã“ã¨ã€‚ ãƒ»ãƒã‚¤ãƒ³ã‚¿ã®å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func main() { x := \"x\" // ãƒã‚¤ãƒ³ã‚¿å‹ã®å®šç¾©ã®ã¿ var p1 *string // ãƒã‚¤ãƒ³ã‚¿å‹ã®å¤‰æ•°ã‚’å®šç¾©ä»£å…¥ var p2 *string = &x fmt.Printf(\"%#v\\n\", p1) // (*string)(nil) fmt.Printf(\"%#v\\n\", p2) // (*string)(0xc0000841e0) } ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å ´åˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func main() { var x interface{} fmt.Printf(\"%#v\\n\", x) // } 02. é–¢æ•° mainé–¢æ•° ãƒ»mainé–¢æ•°ã¨ã¯ goã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹ã€‚goã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒèµ·å‹•ã—ãŸã¨ãã«ã€å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®inité–¢æ•°ãŒå®Ÿè¡Œã•ã‚ŒãŸå¾Œã€mainé–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚mainé–¢æ•°ã‚’ãƒ“ãƒ«ãƒ‰å¯¾è±¡ã«æŒ‡å®šã™ã‚‹ã¨ã€ã“ã‚Œã‚’èµ·ç‚¹ã¨ã—ã¦èª­ã¿è¾¼ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒæåˆ†ã‹ã‚ŒçŠ¶ã«ãƒ“ãƒ«ãƒ‰ã•ã‚Œã¦ã„ãã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€0ã€ã§ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func main() { fmt.Printf(\"%#v\\n\", \"Hello world!\") } å½“ç„¶ã€mainãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚„mainé–¢æ•°ãŒç„¡ã„ã¨ã€goã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®èµ·å‹•æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã€‚ $ go run server.go go run: cannot run non-main package $ go run server.go # command-line-arguments runtime.main: call to external function main.main runtime.main: main.main: not defined runtime.main: undefined: main.main ç‹¬è‡ªé–¢æ•° ãƒ»é–¢æ•°ã¨ã¯ æ§‹é€ ä½“ã«ç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ãªã„é–¢æ•°ã®ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" // é ­æ–‡å­—ã‚’å¤§æ–‡å­—ã™ã‚‹ func Foo(x string) string { fmt.Println(x) } func main() { Foo(\"Hello world!\") } ãƒ»å¼•æ•°ã®å‹ å¼•æ•°ã®å‹ã¨ã—ã¦ã€æ§‹é€ ä½“ã®å ´åˆã¯ãƒã‚¤ãƒ³ã‚¿å‹ã€ãã‚Œä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ã®å ´åˆã¯ãƒã‚¤ãƒ³ã‚¿å‹ä»¥å¤–ãŒæ¨å¥¨ã•ã‚Œã‚‹ã€‚ https://github.com/golang/go/wiki/CodeReviewComments#pass-values ãƒ»Closureï¼ˆç„¡åé–¢æ•°ï¼‰ã¨ã¯ åå‰ã®ãªã„é–¢æ•°ã®ã“ã¨ã€‚ ãƒ»å³æ™‚é–¢æ•°ã¨ã¯ å®šç¾©ã—ãŸãã®å ´ã§ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ç„¡åé–¢æ•°ã®ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š mainé–¢æ•°ã§å³æ™‚é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ package main import \"fmt\" func main() { result := func() string { return \"Closure is working!\" }() fmt.Printf(\"%#v\\n\", result) } ï¼Šå®Ÿè£…ä¾‹ï¼Š å³æ™‚é–¢æ•°ã«å¼•æ•°ã‚’è¨­å®šã§ãã‚‹ã€‚ãã®å ´åˆã€ä»®å¼•æ•°ã¨å¼•æ•°ã®ä¸¡æ–¹ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ package main import \"fmt\" func main() { // ä»®å¼•æ•°ã‚’è¨­å®š result := func(x string) string { return x }(\"Closure is working!\") // å¼•æ•°ã«å€¤ã‚’æ¸¡ã™ fmt.Printf(\"%#v\\n\", result) } ãƒ¡ã‚½ãƒƒãƒ‰ ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã¯ ãƒ‡ãƒ¼ã‚¿å‹ã‚„å‹ãƒªãƒ†ãƒ©ãƒ«ã«ç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹é–¢æ•°ã®ã“ã¨ã€‚Goã¯ã€è¨€èªã¨ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã„ã†æ©Ÿèƒ½ã‚’æŒã£ã¦ã„ãªã„ãŒã€æ§‹é€ ä½“ã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã“ã¨ã§ã€æ“¬ä¼¼çš„ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¡¨ç¾ã§ãã‚‹ã€‚ ãƒ»ãƒ¬ã‚·ãƒ¼ãƒã«ã‚ˆã‚‹ç´ä»˜ã‘ ãƒ‡ãƒ¼ã‚¿å‹ã‚„å‹ãƒªãƒ†ãƒ©ãƒ«ãªã©ã‚’é–¢æ•°ã®ãƒ¬ã‚·ãƒ¼ãƒã¨ã—ã¦æ¸¡ã™ã“ã¨ã«ã‚ˆã£ã¦ã€ãã‚Œã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ç´ä»˜ã‘å¾Œã€é–¢æ•°ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã¨å‘¼ã°ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ãƒ¡ã‚½ãƒƒãƒ‰åã¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã«åŒã˜åå‰ã¯ä½¿ç”¨ã§ããªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š intå‹ã‚’å€¤ãƒ¬ã‚·ãƒ¼ãƒã¨ã—ã¦æ¸¡ã—ã€æ§‹é€ ä½“ã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ package main import \"fmt\" type Age int func (a Age) PrintAge() string { return fmt.Sprintf(\"%dã§ã™ã€‚\", a) } func main() { var age Age = 20 fmt.Printf(\"%#v\\n\", age.printAge()) } ï¼Šå®Ÿè£…ä¾‹ï¼Š æ§‹é€ ä½“ã‚’å€¤ãƒ¬ã‚·ãƒ¼ãƒã¨ã—ã¦æ¸¡ã—ã€æ§‹é€ ä½“ã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ package main import \"fmt\" // æ§‹é€ ä½“ã‚’å®šç¾© type Person struct { name string } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ func NewPerson(name string) *Person { return &Person{ name: name, } } // æ§‹é€ ä½“ã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ func (p Person) GetName() string { return p.name } // æ§‹é€ ä½“ã‹ã‚‰é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ« func main() { // æ§‹é€ ä½“ã‚’åˆæœŸåŒ– person := NewPerson(\"Hiroki\") fmt.Printf(\"%#v\\n\", person.GetName()) // \"Hiroki\" } ãƒ»å€¤ãƒ¬ã‚·ãƒ¼ãƒ æ§‹é€ ä½“ã®å®Ÿä½“ã¨é–¢æ•°ã‚’ç›´æ¥çš„ã«ç´ä»˜ã‘ã‚‹ã€‚ç´ä»˜ã‘å¾Œã€é–¢æ•°ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã¨å‘¼ã°ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ãƒ¬ã‚·ãƒ¼ãƒã¨ã—ã¦æ¸¡ã•ã‚ŒãŸå¼•æ•°ã‚’ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ã‚³ãƒ”ãƒ¼ã—ã¦ã‹ã‚‰ç”¨ã„ã‚‹ã€‚å€¤ãƒ¬ã‚·ãƒ¼ãƒã«ã‚ˆã£ã¦ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã¨ã€ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯æ§‹é€ ä½“ã®çŠ¶æ…‹ã‚’å¤‰ãˆã‚‰ã‚Œãªããªã‚‹ã®ã§ã€æ§‹é€ ä½“ã‚’ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã«ã—ãŸã„å ´åˆã¯ã€å€¤ãƒ¬ã‚·ãƒ¼ãƒã‚’ä½¿ã†ã¨è‰¯ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ§‹é€ ä½“ã‚’å€¤ãƒ¬ã‚·ãƒ¼ãƒã¨ã—ã¦æ¸¡ã—ã€æ§‹é€ ä½“ã«é–¢æ•°ã‚’ç´ä»˜ã‘ã‚‹ã€‚ package main import \"fmt\" type Person struct { name string } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ func NewPerson(name string) *Person { return &Person{ name: name, } } // å€¤ãƒ¬ã‚·ãƒ¼ãƒ func (p Person) SetName(name string) { // å¼•æ•°ã®æ§‹é€ ä½“ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‹ã‚‰ä½¿ç”¨ p.name = name } func (p Person) GetName() string { return p.name } func main() { person := NewPerson(\"Gopher\") person.SetName(\"Hiroki\") fmt.Printf(\"%#v\\n\", person.GetName()) // \"Gopher\" } ãƒ»ãƒã‚¤ãƒ³ã‚¿ãƒ¬ã‚·ãƒ¼ãƒ æ§‹é€ ä½“ã®ãƒã‚¤ãƒ³ã‚¿ã‚’ç”¨ã„ã¦ã€é–¢æ•°ã¨æ§‹é€ ä½“ã®å®Ÿä½“ã‚’ç´ä»˜ã‘ã‚‹ã€‚ç´ä»˜ã‘å¾Œã€é–¢æ•°ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã¨å‘¼ã°ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ãƒ¬ã‚·ãƒ¼ãƒã¨ã—ã¦æ¸¡ã•ã‚ŒãŸå¼•æ•°ã‚’ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ãã®ã¾ã¾ç”¨ã„ã‚‹ã€‚ãƒã‚¤ãƒ³ã‚¿ãƒ¬ã‚·ãƒ¼ãƒã«ã‚ˆã£ã¦ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã¨ã€ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯æ§‹é€ ä½“ã®çŠ¶æ…‹ã‚’å¤‰ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã®ã§ã€æ§‹é€ ä½“ã‚’ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã«ã—ãŸã„å ´åˆã¯ã€ãƒã‚¤ãƒ³ã‚¿ãƒ¬ã‚·ãƒ¼ãƒã‚’ä½¿ã†ã¨è‰¯ã„ã€‚æ§‹é€ ä½“ã‚’åˆæœŸåŒ–ã™ã‚‹å‡¦ç†ã‚’æŒã¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã®ã¿ã‚’ãƒã‚¤ãƒ³ã‚¿ãƒ¬ã‚·ãƒ¼ãƒã¨ã—ã€ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å…¨ã¦å€¤ãƒ¬ã‚·ãƒ¼ãƒã¨ã™ã‚‹ã¨ã€æœ€ä½é™ã«ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè£…ã§ãã‚‹ã€‚ã¾ãŸã€æ§‹é€ ä½“ã¯ãƒã‚¤ãƒ³ã‚¿å‹ã¨ã—ã¦æ‰±ã£ãŸæ–¹ãŒãƒ¡ãƒ¢ãƒªã‚’ç¯€ç´„ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" type Person struct { Name string } // ãƒã‚¤ãƒ³ã‚¿ãƒ¬ã‚·ãƒ¼ãƒ func (p *Person) SetName(name string) { // å¼•æ•°ã®æ§‹é€ ä½“ã‚’ãã®ã¾ã¾ä½¿ç”¨ p.Name = name } func (p *Person) GetName() string { return p.Name } func main() { person := Person{Name: \"Gopher\"} person.SetName(\"Hiroki\") fmt.Printf(\"%#v\\n\", person.GetName()) // \"Hiroki\" } deferé–¢æ•° ãƒ»deferé–¢æ•°ã¨ã¯ å…¨ã¦ã®å‡¦ç†ã®æœ€å¾Œã«å¿…ãšå®Ÿè¡Œã•ã‚Œã‚‹é…å»¶å®Ÿè¡Œé–¢æ•°ã®ã“ã¨ã€‚ãŸã¨ãˆã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã®ã‚ˆã†ã«å‡¦ç†ãŒå¼·åˆ¶çš„ã«é€”ä¸­çµ‚äº†ã—ã¦ã‚‚å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å³æ™‚é–¢æ•°ã‚’deferé–¢æ•°åŒ–ã—ã¦ã„ã‚‹ã€‚å‡¦ç†ã®æœ€å¾Œã«ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ãŸã¨ãã€ã“ã‚Œã‚’recoverãƒ¡ã‚½ãƒƒãƒ‰ã§å¸åã§ãã‚‹ã€‚ package main import \"fmt\" func main() { fmt.Println(\"Start\") // ã‚ã‚‰ã‹ã˜ã‚deferé–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠã defer func() { err := recover() if err != nil { fmt.Printf(\"Recover: %#v\\n\", err) } fmt.Println(\"End\") }() // ã“ã“ã§æ„å›³çš„ã«å‡¦ç†ã‚’åœæ­¢ã•ã›ã¦ã„ã‚‹ã€‚ panic(\"Runtime error\") } // Start // Recover: \"Runtime error\" // End ãƒ»è¤‡æ•°ã®deferé–¢æ•° deferã¯è¤‡æ•°ã®é–¢æ•°ã§å®£è¨€ã§ãã‚‹ã€‚è¤‡æ•°å®£è¨€ã—ãŸå ´åˆã€å¾Œã«å®£è¨€ã•ã‚ŒãŸã‚‚ã®ã‹ã‚‰å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func main() { defer fmt.Println(\"1\") defer fmt.Println(\"2\") defer fmt.Println(\"3\") } // 3 // 2 // 1 è¿”å´å€¤ ãƒ»è¤‡æ•°ã®è¿”å´å€¤ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func division(x int, y int) (int, int) { // å•†ã‚’è¨ˆç®—ã™ã‚‹ã€‚ quotient := x / y // ä½™ã‚Šã‚’è¨ˆç®—ã™ã‚‹ã€‚ remainder := x % y // å•†ã¨ä½™ã‚Šã‚’è¿”å´ã™ã‚‹ã€‚ return quotient, remainder } func main() { // 10Ã·3ã‚’è¨ˆç®—ã™ã‚‹ã€‚ q, r := division(10, 3) fmt.Printf(\"å•†=%dã€ä½™ã‚Š=%d\", q, r) } ãƒ»è¿”å´å€¤ã®ç ´æ£„ é–¢æ•°ã‹ã‚‰è¤‡æ•°ã®å€¤ãŒè¿”å´ã•ã‚Œã‚‹æ™‚ã€ä½¿ã‚ãªã„å€¤ã‚’ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã«ä»£å…¥ã™ã‚‹ã“ã¨ã§ã€ã“ã‚Œã‚’ç ´æ£„ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" \"os\" ) func main() { // errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ç ´æ£„ file, _ := os.Open(\"filename.txt\") // ã‚¨ãƒ©ãƒ¼ã‚­ãƒ£ãƒƒãƒã™ã‚‹å¿…è¦ãŒãªããªã‚‹ fmt.Printf(\"%#v\\n\", flle) } 04. å¤‰æ•° å®šç¾©ï¼ˆå®£è¨€ï¼‹ä»£å…¥ï¼‰ ãƒ»æ˜ç¤ºçš„ãªå®šç¾© ï¼Šå®Ÿè£…ä¾‹ï¼Š // ä¸€ã¤ã®å¤‰æ•°ã‚’å®šç¾©ï¼ˆå®£è¨€ã¨ä»£å…¥ãŒåŒæ™‚ã§ãªã„ï¼‰ var number int number = 5 // ä¸€ã¤ã®å¤‰æ•°ã‚’å®šç¾©ï¼ˆå®£è¨€ã¨ä»£å…¥ãŒåŒæ™‚ï¼‰ var number int = 5 // è¤‡æ•°ã®å¤‰æ•°ã‚’å®šç¾© var x, y, z int x, y, z = 1, 3, 5 ãƒ»æš—é»™çš„ãªå®šç¾©ï¼ˆå‹æ¨è«–ï¼‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š // ãƒ‡ãƒ¼ã‚¿å‹ãŒè‡ªå‹•çš„ã«èªè­˜ã•ã‚Œã‚‹ w := 1 x := true y := 3.14 z := \"abc\" var w = 1 var ( x = true y = 3.14 z = \"abc\" ) package main import \"fmt\" func quotient(x int, y int) int { // å•†ã‚’è¨ˆç®—ã™ã‚‹ã€‚ quotient := x / y // ã‚’è¿”å´ã™ã‚‹ã€‚ return quotient } func main() { fmt.Println(quotient(2, 2)) } ãƒ»å†å®£è¨€ åŸºæœ¬çš„ã«ã¯ã€åŒã˜ã‚¹ã‚³ãƒ¼ãƒ—å†…ã§æ—¢å­˜ã®å¤‰æ•°ã‚’å†å®£è¨€ã§ããªã„ã€‚ãŸã ã—ã€è¤‡æ•°ã®å¤‰æ•°ã‚’å®£è¨€ã™ã‚‹æ™‚ã«ã€ã„ãšã‚Œã‹ã«æ–°ã—ã„å¤‰æ•°ã®å®£è¨€ãŒå«ã¾ã‚Œã¦ã„ã‚Œã°ã€æ—¢å­˜ã®å¤‰æ•°ã‚’å®£è¨€ã—ãŸã¨ã—ã¦ã‚‚ã€ä»£å…¥ã®ã¿ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" ) func main() { x := 1 // æ–°ã—ã„å¤‰æ•°ã®å®£è¨€ãŒå«ã¾ã‚Œã¦ã„ã‚‹ x, y := 2, 3 fmt.Printf(\"%#v\\n\", x) // 2 fmt.Printf(\"%#v\\n\", y) // 3 } å®šç¾©ä½ç½®ã®ç¨®é¡ ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å¤‰æ•° é–¢æ•°ã®å¤–éƒ¨ã§å®šç¾©ã•ã‚ŒãŸå¤‰æ•°ã®ã“ã¨ã€‚ã‚¹ã‚³ãƒ¼ãƒ—ã¨ã—ã¦ã€å®£è¨€ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å¤–éƒ¨ã§ã‚‚ä½¿ç”¨ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å¤‰æ•°ã‚’å®£è¨€ã—ã€é–¢æ•°å†…ã§å€¤ã‚’ä»£å…¥ã™ã‚‹ã€‚ package main import ( \"fmt\" ) // ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å¤‰æ•° var text string func main() { text = \"Hello World!\" fmt.Printf(\"%#v\\n\", text) } å¤‰æ•°ã¸ã®å€¤ã®ä»£å…¥ã¯é–¢æ•°å†…ã§ã—ã‹ã§ããªã„ãŸã‚ã€å®£è¨€ã¨ä»£å…¥ã‚’åŒæ™‚ã«è¡Œã†å‹æ¨è«–ã‚’ç”¨ã„ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ package main import ( \"fmt\" ) // ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ text := \"Hello World!\" func main() { fmt.Printf(\"%#v\\n\", text) } ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•° é–¢æ•°ã®å†…éƒ¨ã§å®šç¾©ã•ã‚ŒãŸå¤‰æ•°ã®ã“ã¨ã€‚ã‚¹ã‚³ãƒ¼ãƒ—ã¨ã—ã¦ã€å®£è¨€ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…éƒ¨ã§ã—ã‹ä½¿ç”¨ã§ããªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" ) func main() { // ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•° text := \"Hello World!\" fmt.Printf(\"%#v\\n\", text) } 03. ã‚¹ã‚³ãƒ¼ãƒ— å¤‰æ•°ã€å®šæ•° ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…å¤–ã‹ã‚‰å‚ç…§å¯èƒ½ å¤‰æ•°åã¾ãŸã¯å®šæ•°åã®é ­æ–‡å­—ã‚’å¤§æ–‡å­—ã™ã‚‹ã¨ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…å¤–ã§ã“ã‚Œã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package foo // å®šæ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ const ( X = \"X\" ) package main import ( \"fmt\" ) func main() { fmt.Printf(\"%#v\\n\", X) // X } ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã®ã¿å‚ç…§å¯èƒ½ å¤‰æ•°åã¾ãŸã¯å®šæ•°åã®é ­æ–‡å­—ã‚’å°æ–‡å­—ã™ã‚‹ã¨ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å¤–ã§ã“ã‚Œã‚’ã‚³ãƒ¼ãƒ«ã§ããªããªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" ) // å®šæ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ const ( yZ = \"yZ\" ) func main() { fmt.Printf(\"%#v\\n\", yZ) // yZ } é–¢æ•° ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…å¤–ã‹ã‚‰å‚ç…§å¯èƒ½ é–¢æ•°åã®é ­æ–‡å­—ã‚’å¤§æ–‡å­—ã™ã‚‹ã¨ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…å¤–ã§ã“ã‚Œã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package foo func Foo() { // ä½•ã‚‰ã‹ã®å‡¦ç† } package main func main() { Foo() } ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã®ã¿å‚ç…§å¯èƒ½ é–¢æ•°åã®é ­æ–‡å­—ã‚’å°æ–‡å­—ã™ã‚‹ã¨ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å¤–ã§ã“ã‚Œã‚’ã‚³ãƒ¼ãƒ«ã§ããªããªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main func foo() { // ä½•ã‚‰ã‹ã®å‡¦ç† } func main() { foo() } 04. åˆ¶å¾¡æ–‡ é…åˆ—ã¾ãŸã¯ã‚¹ãƒ©ã‚¤ã‚¹ã®èµ°æŸ» ãƒ»for ... range é…åˆ—ã¾ãŸã¯ã‚¹ãƒ©ã‚¤ã‚¹ã‚’èµ°æŸ»ã™ã‚‹ã€‚PHPã®foreachã«ç›¸å½“ã™ã‚‹ã€‚ package main import ( \"fmt\" ) func main() { slice := []string{\"a\", \"b\", \"c\"} for key, value := range slice { fmt.Println(key, value) } } // 0 a // 1 b // 2 c 05. å‡¦ç†ã®ç¨®é¡ åŒæœŸå‡¦ç† ãƒ»åŒæœŸå‡¦ç†ã¨ã¯ å‰ã®å‡¦ç†ã‚’å¾…ã£ã¦ã€æ¬¡ã®å‡¦ç†ã‚’é–‹å§‹ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func main() { fmt.Println(\"1\") fmt.Println(\"2\") fmt.Println(\"3\") } // 1 // 2 // 3 éåŒæœŸå‡¦ç†ï¼ˆä¸¦è¡Œå‡¦ç†ï¼‰ ãƒ»éåŒæœŸå‡¦ç†ï¼ˆä¸¦è¡Œå‡¦ç†ï¼‰ã¨ã¯ å‰ã®å‡¦ç†ã®çµ‚äº†ã‚’å¾…ãŸãšã«æ¬¡ã®å‡¦ç†ã‚’é–‹å§‹ã—ã€ãã‚Œãã‚Œã®å‡¦ç†ãŒç‹¬ç«‹ã—ã¦çµ‚äº†ã™ã‚‹ã€‚çµæœã€çµ‚äº†ã™ã‚‹é †ç•ªã¯é †ä¸åŒã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://golang.org/pkg/sync/ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¸¦åˆ—å‡¦ç† ãƒ»ä¸¦åˆ—å‡¦ç† æŒ‡å®šã—ãŸå‡¦ç†ã‚’åŒæ™‚ã«é–‹å§‹ã—ã€ãã‚Œãã‚Œã®å‡¦ç†ãŒç‹¬ç«‹ã—ã¦çµ‚äº†ã™ã‚‹ã€‚çµæœã€çµ‚äº†ã™ã‚‹é †ç•ªã¯é †ä¸åŒã«ãªã‚‹ã€‚é–¢æ•°ã§Goãƒ«ãƒ¼ãƒãƒ³ã‚’å®£è¨€ã™ã‚‹ã¨ã€ãã®é–¢æ•°ã®ã‚³ãƒ¼ãƒ«ã‚’ä¸¦åˆ—åŒ–ã§ãã‚‹ã€‚ãŸã ã—ã€mainé–¢æ•°ã¯Goãƒ«ãƒ¼ãƒãƒ³å®£è¨€ã•ã‚ŒãŸé–¢æ•°ã®å®Œäº†ã‚’å¾…ãŸãšã«çµ‚äº†ã—ã¦ã—ã¾ã†ãŸã‚ã€ã“ã®é–¢æ•°ã®å®Ÿè¡Œå®Œäº†ã‚’å¾…ã¤ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚æ–¹æ³•ã«ã¯ã€ä»¥ä¸‹ã®ä¸‰ã¤ãŒã‚ã‚‹ã€‚ ãƒ»channel ã‚­ãƒ¥ãƒ¼ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã€‚ã‚­ãƒ¥ãƒ¼ã«å€¤ã‚’æ ¼ç´ã—ã€ã¾ãŸã‚­ãƒ¥ãƒ¼ã‹ã‚‰å€¤ã‚’å–ã‚Šå‡ºã›ã‚‹ã€‚ package main import \"fmt\" func main() { // ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä»»æ„ã®ãƒ‡ãƒ¼ã‚¿å‹ã§ä½œæˆ channel := make(chan string) go func() { // ãƒãƒ£ãƒ³ãƒãƒ«ã«å€¤ã‚’æ ¼ç´ channel ãƒ»WaitGroup ä¸€ã¤ã¾ãŸã¯è¤‡æ•°ã®é–¢æ•°ã§Goãƒ«ãƒ¼ãƒãƒ³ã‚’å®£è¨€ã—ãŸã„æ™‚ã«ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¸¦åˆ—å‡¦ç†ã«ã‚ˆã‚Šã€åå¾©å‡¦ç†ã‚’ç´ æ—©ãå®Œäº†ã§ãã‚‹ã€‚å®Ÿè¡Œå®Œäº†ã«ä¸€ç§’ã‹ã‹ã‚‹é–¢æ•°ãŒã‚ã‚‹ã¨ä»®å®šã™ã‚‹ã€‚åå¾©å‡¦ç†ã§ã“ã®é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹å ´åˆã€æ¯å›ã®èµ°æŸ»ã«ä¸€ç§’ã‹ã‹ã‚‹ãŸã‚ã€åå¾©ã®å›æ•°ã ã‘ç§’æ•°ãŒå¢—ãˆã‚‹ã€‚ã—ã‹ã—ã€Goãƒ«ãƒ¼ãƒãƒ³ã‚’å®£è¨€ã—ä¸¦åˆ—åŒ–ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å„èµ°æŸ»ãŒå…¨ã¦ä¸¦åˆ—ã«å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€åå¾©å›æ•°ãŒä½•å›ã§ã‚ã£ã¦ã‚‚ã€ä¸€ç§’ã§å‡¦ç†ãŒçµ‚ã‚ã‚‹ã€‚ package main import ( \"fmt\" \"sync\" \"time\" ) func print(key int, value string) { fmt.Println(key, value) time.Sleep(time.Second * 1) // å‡¦ç†å®Œäº†ã«ä¸€ç§’ã‹ã‹ã‚‹ã¨ä»®å®šã™ã‚‹ã€‚ } func main() { wg := &sync.WaitGroup{} slice := []string{\"a\", \"b\", \"c\"} // å‡¦ç†ã®é–‹å§‹æ™‚åˆ»ã‚’å–å¾— start := time.Now() for key, value := range slice { wg.Add(1) // go routineã®å®£è¨€ã®æ•° // Goãƒ«ãƒ¼ãƒãƒ³ã‚’å®£è¨€ã—ã¦ä¸¦åˆ—åŒ– go func(key int, value string) { defer wg.Done() // æ™‚é–“ã®ã‹ã‹ã‚‹é–¢æ•° print(key, value) }(key, value) } // Addé–¢æ•°ã§æŒ‡å®šã—ãŸæ•°ã®go routineãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¾ã§å¾…æ©Ÿ wg.Wait() // é–‹å§‹æ™‚åˆ»ã‹ã‚‰çµŒéã—ãŸç§’æ•°ã‚’å–å¾— fmt.Printf(\"çµŒéç§’æ•°: %s\", time.Since(start)) } // 2 c // 0 a // 1 b // çµŒéç§’æ•°: 1s ãƒ»errgroup ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’å«ã‚€é–¢æ•°ã§Goãƒ«ãƒ¼ãƒãƒ³ã‚’å®£è¨€ã—ãŸã„æ™‚ã«ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š 06. ã‚¨ãƒ©ãƒ¼ã‚­ãƒ£ãƒƒãƒã€ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ Goã«ãŠã‘ã‚‹ã‚¨ãƒ©ãƒ¼ã‚­ãƒ£ãƒƒãƒã¨ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ ãƒ»ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã®ã‚ã‚‹è¨€èªã®å ´åˆ ä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã®æ„ç¾©ã¯ã€ä»¥ä¸‹ã®å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_logic_validation.html ãƒ»Goã«ã¯ä¾‹å¤–ãŒç„¡ã„ ä¾‹ãˆã°PHPã§ã¯ã€ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã—ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…ã«ã‚ã‹ã‚‹è¨€è‘‰ã«å¤‰æ›ã—ãŸä¾‹å¤–ã¨ã—ã¦ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã€‚Goã«ã¯ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã«ç›¸å½“ã™ã‚‹ã‚‚ã®ãŒç„¡ã„ã€‚ãã®ä»£ã‚ã‚Šã€ã‚¨ãƒ©ãƒ¼ãã®ã‚‚ã®ãŒerrorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¿æŒã•ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚’ä¸€ã¤ã®å€¤ã¨ã—ã¦æ‰±ãˆã‚‹ã€‚ä¸‹æµã§ç™ºç”Ÿã—ãŸerrorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ã€ãã®ã¾ã¾ä¸Šæµã«è¿”å´ã™ã‚‹ã€‚ ã‚¨ãƒ©ãƒ¼ã‚­ãƒ£ãƒƒãƒ ãƒ»nilã®æ¯”è¼ƒæ¤œè¨¼ é–¢æ•°ã‹ã‚‰è¿”å´ã•ã‚ŒãŸerrã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒã€nilã§ãªã‹ã£ãŸå ´åˆã€ã‚¨ãƒ©ãƒ¼ã§ã‚ã‚‹ã¨è¦‹ãªã™ã‚ˆã†ã«ã™ã‚‹ã€‚ if err != nil { // ä½•ã‚‰ã‹ã®å‡¦ç† } errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ãƒ»æ¨™æº–ã‚¨ãƒ©ãƒ¼ Goã§ã¯è¤‡æ•°ã®å€¤ã‚’è¿”å´ã§ãã‚‹ãŸã‚ã€å¤šãã®é–¢æ•°ã§ã¯æ¨™æº–ã§ã€æœ€å¾Œã«errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒè¿”å´ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯æš—é»™çš„ã«Errorãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã€‚ type error interface { Error() string } ï¼Šå®Ÿè£…ä¾‹ï¼Š osãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®Openãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒè¿”å´ã•ã‚Œã‚‹ã€‚errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯Errorãƒ¡ã‚½ãƒƒãƒ‰ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã—ã€æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ package main import ( \"fmt\" \"log\" \"os\" ) func main() { // å‡¦ç†çµæœã¨errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒè¿”å´ã•ã‚Œã‚‹ã€‚ file, err := os.Open(\"filename.txt\") if err != nil { // ã‚¨ãƒ©ãƒ¼ã®å†…å®¹ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ log.Fatalf(\"ERROR: %#v\\n\", err) } fmt.Printf(\"%#v\\n\", flle) } ãƒ»Newé–¢æ•°ã«ã‚ˆã‚‹ç‹¬è‡ªã‚¨ãƒ©ãƒ¼ errorsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®Newãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¨ãƒ©ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç‹¬è‡ªã®ã‚¨ãƒ©ãƒ¼ã‚’ä¿æŒã™ã‚‹errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã§ãã‚‹ã€‚errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯Errorãƒ¡ã‚½ãƒƒãƒ‰ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://golang.org/pkg/errors/#New ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"errors\" \"fmt\" \"log\" \"os\" ) func NewError() error { return errors.New(\"\") } func main() { file, err := os.Open(\"filename.txt\") if err != nil { // ç‹¬è‡ªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨­å®šã™ã‚‹ã€‚ myErr := NewError() log.Fatalf(\"ERROR: %#v\\n\", myErr) } fmt.Printf(\"%#v\\n\", flle) } ãƒ»fmt.Errorfãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹ç‹¬è‡ªã‚¨ãƒ©ãƒ¼ fmtãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®Errorfãƒ¡ã‚½ãƒƒãƒ‰ã§ç‹¬è‡ªã‚¨ãƒ©ãƒ¼ã‚’ä½œæˆã§ãã‚‹ã€‚äº‹å‰ã«å®šç¾©ã—ãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å…ƒã«ã‚¨ãƒ©ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç‹¬è‡ªã®ã‚¨ãƒ©ãƒ¼ã‚’ä¿æŒã™ã‚‹errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã§ãã‚‹ã€‚errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯Errorãƒ¡ã‚½ãƒƒãƒ‰ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://golang.org/pkg/fmt/#Errorf ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" \"os\" ) func main() { file, err := os.Open(\"filename.txt\") if err != nil { fmt.Errorf(\"ERROR: %s\", err) } fmt.Printf(\"%#v\\n\", flle) } ãƒ»æ§‹é€ ä½“ã«ã‚ˆã‚‹ç‹¬è‡ªã‚¨ãƒ©ãƒ¼ æ§‹é€ ä½“ã«Errorãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã™ã‚‹ã¨ã€ã“ã®æ§‹é€ ä½“ã«errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒè‡ªå‹•çš„ã«å§”è­²ã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç‹¬è‡ªã®ã‚¨ãƒ©ãƒ¼ã‚’ä¿æŒã™ã‚‹errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã§ãã‚‹ã€‚errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯Errorãƒ¡ã‚½ãƒƒãƒ‰ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" \"os\" ) type Error struct { Message string } func (error *Error) Error() string { return fmt.Sprintf(\"ERROR: %s\", error.Message) } func main() { file, err := os.Open(\"filename.txt\") if err != nil { // æ§‹é€ ä½“ã«å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ myError := &Error{Message: \"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€å‡¦ç†ã‚’çµ‚äº†ã—ã¾ã—ãŸã€‚\"} // æ§‹é€ ä½“ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã ã‘ã§ã€Errorãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ fmt.Printf(\"%#v\\n\", myError) os.Exit(1) } fmt.Printf(\"%#v\\n\", flle) } xerrorsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒ»xerrorsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ æ¨™æº–ã®errorsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã¯ã€ã‚¨ãƒ©ãƒ¼ã«ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ãªã„ã€‚xerrorsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã¯ã€errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒè¿”å´ã•ã‚ŒãŸè¡Œæ•°ãŒã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ã—ã¦å«ã¾ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»Newé–¢æ•°ã«ã‚ˆã‚‹ãƒˆãƒ¬ãƒ¼ã‚¹ä»˜ä¸ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" \"golang.org/x/xerrors\" \"log\" \"os\" ) func NewErrorWithTrace() error { return xerrors.New(\"\") } func main() { file, err := os.Open(\"filename.txt\") if err != nil { // errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒè¿”å´ã•ã‚ŒãŸè¡Œæ•°ãŒä»˜ä¸ã•ã‚Œã‚‹ã€‚ errWithStack := NewErrorWithTrace() // %+v\\n ã‚’ç”¨ã„ã‚‹ã€‚ log.Fatalf(\"ERROR: %+v\\n\", errWithStack) } fmt.Printf(\"%#v\\n\", flle) } ãƒ»Errorfãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹ãƒˆãƒ¬ãƒ¼ã‚¹ä»˜ä¸ package main import ( \"fmt\" \"golang.org/x/xerrors\" \"log\" \"os\" ) func main() { file, err := os.Open(\"filename.txt\") if err != nil { // errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒè¿”å´ã•ã‚ŒãŸè¡Œæ•°ãŒä»˜ä¸ã•ã‚Œã‚‹ã€‚ errWithStack := xerrors.Errorf(\"ERROR: %w\", err) // %+v\\n ã‚’ç”¨ã„ã‚‹ã€‚ log.Fatalf(\"ERROR: %+v\\n\", errWithStack) } fmt.Printf(\"%#v\\n\", flle) } 06-02. ãƒ­ã‚®ãƒ³ã‚° logãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒ»logãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ Goã«ã¯æ¨™æº–ã§ã€ãƒ­ã‚®ãƒ³ã‚°ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ãŸã ã—ã€æ©Ÿèƒ½ãŒä¹ã—ã„ã®ã§ã€å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆä¾‹ï¼šlogrusï¼‰ã‚‚æ¨å¥¨ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://pkg.go.dev/log https://github.com/sirupsen/logrus ãƒ»æ¥å°¾è¾Printãƒ¡ã‚½ãƒƒãƒ‰ æ¸¡ã•ã‚ŒãŸå€¤ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¸¡ã•ã‚ŒãŸerrorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ if err != nil { log.Printf(\"ERROR: %#v\\n\", err) } ãƒ»æ¥å°¾è¾Fatalãƒ¡ã‚½ãƒƒãƒ‰ æ¸¡ã•ã‚ŒãŸå€¤ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã—ã€os.Exit(1)ã‚’å®Ÿè¡Œã—ã¦ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€1ã€ã§å‡¦ç†ã‚’çµ‚äº†ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¸¡ã•ã‚ŒãŸerrorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ if err != nil { // å†…éƒ¨ã§os.Exit(1)ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ log.Fatalf(\"ERROR: %#v\\n\", err) } ãƒ»æ¥å°¾è¾Panicãƒ¡ã‚½ãƒƒãƒ‰ æ¸¡ã•ã‚ŒãŸå€¤ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã—ã€äºˆæœŸã›ã¬ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸã¨è¦‹ãªã—ã¦panicãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã¡ãªã¿ã«ã€panicãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡ºåŠ›ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹å‡ºåŠ›ã€å‡¦ç†åœæ­¢ãŒè¡Œã‚ã‚Œã‚‹ã€‚ä½¿ç”¨ã¯éæ¨å¥¨ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/golang/go/wiki/CodeReviewComments#dont-panic ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¸¡ã•ã‚ŒãŸerrorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ if err != nil { // panicãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ log.Panicf(\"ERROR: %#v\\n\", err) } 07. ãƒ†ã‚¹ãƒˆ ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ ãƒ»ãƒ†ã‚¹ãƒˆã®å˜ä½ ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¯æ§‹é€ ä½“ã‚’ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã®å˜ä½ã¨ã—ã¦è¡Œã†ã€‚ ãƒ»æ§‹æˆ ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã¨ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_testing_based_on_code.html ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆ ãƒ»å®Ÿç¾æ–¹æ³• ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åãŒã€åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹å®Ÿéš›ã®å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ã«ã€_testã€ã‚’åŠ ãˆãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã®å ´åˆã€ãã‚Œã¯ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã«ãªã‚‹ã€‚ã¡ãªã¿ã«ã€Goã§ã¯ä¸€ã¤ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ä¸€ã¤ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã—ã‹å®£è¨€ã§ããªã„ãŒã€ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã®ãŸã‚ã«ã€_testã€ã‚’åŠ ãˆã‚‹ã“ã¨ã¯è¨±ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆ ãƒ»å®Ÿç¾æ–¹æ³• ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åãŒã€åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹å®Ÿéš›ã®å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¨åŒã˜å ´åˆã€ãã‚Œã¯ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆã«ãªã‚‹ã€‚ ãƒ»ç¶²ç¾…ç‡ ç¶²ç¾…ç‡ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å˜ä½ã¨ã—ã¦è§£æã•ã‚Œã‚‹ã€‚ç¶²ç¾…ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_testing_based_on_code.html ãƒ†ã‚¹ãƒˆã®å®Ÿè£…æ–¹æ³•ã®Tips ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å°å…¥ ãƒ†ã‚¹ãƒˆã§ããªã„æ§‹é€ ä½“ã¯ãƒ¢ãƒƒã‚¯ã«å·®ã—æ›¿ãˆã‚‰ã‚Œã‚‹ã“ã¨ãªã‚‹ã€‚ã“ã®æ™‚ã€ã‚ã‚‰ã‹ã˜ã‚å®Ÿéš›ã®æ§‹é€ ä½“ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…ã«ã—ã¦ãŠãã€‚ãƒ†ã‚¹ãƒˆæ™‚ã«ã€ãƒ¢ãƒƒã‚¯ã‚‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®å®Ÿè£…ã¨ã™ã‚Œã°ã€ãƒ¢ãƒƒã‚¯ãŒå®Ÿéš›ã®æ§‹é€ ä½“ã¨åŒã˜ãƒ‡ãƒ¼ã‚¿å‹ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¢ãƒƒã‚¯ã«å·®ã—æ›¿ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆ å‚è€ƒï¼šhttps://github.com/golang/go/wiki/TableDrivenTests ãƒ»å›å¸°ãƒ†ã‚¹ãƒˆ å›å¸°ãƒ†ã‚¹ãƒˆã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã€éå»ã®ãƒ†ã‚¹ãƒˆçµæœã‚’ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¦ãŠãã€ä»Šå›ã®ãƒ†ã‚¹ãƒˆçµæœãŒéå»ã®ã‚‚ã®ã¨ä¸€è‡´ã™ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚Goã§ã¯ã€ã“ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€Golden Fileã€ã¨ã„ã†ã€‚Goldenï¼ˆé‡‘ï¼‰ã¯åŒ–å­¦çš„ã«å®‰å®šã—ãŸç‰©è³ªã§ã‚ã‚‹ã“ã¨ã«ç”±æ¥ã—ã¦ãŠã‚Šã€ã€å®‰å®šã—ãŸãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã€ã¨ã‹ã‘ã¦ã„ã‚‹ã€‚å›å¸°ãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_testing_based_on_code.html ãƒ»POSTãƒ‡ãƒ¼ã‚¿ã®åˆ‡ã‚Šåˆ†ã‘ POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’è¡Œã†æ™‚ã«ã€JSONãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šåˆ†ã‘ã¦ãŠãã€‚ã“ã‚Œã‚’ReadFileé–¢æ•°ã§èª­ã¿å‡ºã™ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package test import ( \"io/ioutil\" ) /** * mainãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚ */ func TestMain(t *testing.T) { // jsonãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿å‡ºã— data, err := ioutil.ReadFile(\"../testdata/foo.json\") // ä»¥ä¸‹ã«ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¦ã„ã } 08. ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ å‚è€ƒï¼šhttps://golang.org/pkg/ bytes ãƒ»Bufferãƒ¡ã‚½ãƒƒãƒ‰ æ¸¡ã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’çµåˆã—ã€æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"bytes\" \"fmt\" ) func main() { var buffer bytes.Buffer buffer.WriteString(\"Hello \") buffer.WriteString(\"world!\") fmt.Printf(\"%#v\\n\", buffer.String()) // \"Hello world!\" } encoding/json ãƒ»Marshalé–¢æ•° æ§‹é€ ä½“ã‚’JSONã«å¤‰æ›ã™ã‚‹ã€‚å¤‰æ›å‰ã«ã€ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’è¡Œã†ã‚ˆã†ã«ã™ã‚‹ã€‚å¼•æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã¯ã€ãƒã‚¤ãƒ³ã‚¿å‹ã¾ãŸã¯éãƒã‚¤ãƒ³ã‚¿å‹ã®ã„ãšã‚Œã§ã‚‚å•é¡Œãªã„ã€‚ãŸã ã—ã€ä»–ã®å¤šãã®é–¢æ•°ãŒãƒã‚¤ãƒ³ã‚¿å‹ã‚’å¼•æ•°å‹ã¨ã—ã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ã€ãã‚Œã«åˆã‚ã›ã¦ãƒã‚¤ãƒ³ã‚¿å‹ã§æ¸¡ã™ã“ã¨ãŒå¤šã„ã€‚ å‚è€ƒï¼šhttps://golang.org/pkg/encoding/json/#Marshal ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"encoding/json\" \"fmt\" \"log\" ) type Person struct { // Marshalã«æ¸¡ã™æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãŒå¿…é ˆ Name string `json:\"name\"` } func main() { person := &Person{Name: \"Hiroki\"} // ãƒã‚¤ãƒ³ã‚¿å‹ã¨éãƒã‚¤ãƒ³ã‚¿å‹ã®ä¸¡æ–¹ã®å¼•æ•°ã«å¯¾å¿œ byteJson, err := json.Marshal(person) if err != nil { log.Fatalf(\"ERROR: %#v\\n\", err) } // ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰çµæœã‚’å‡ºåŠ› fmt.Printf(\"%#v\\n\", string(byteJson)) // \"{\\\"Name\\\":\\\"Hiroki\\\"}\" } ã“ã®æ™‚ã€æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã—ã‹ã—ã€MarshalJSONé–¢æ•°ã‚’æ§‹é€ ä½“ã«å®šç¾©ã™ã‚‹ã¨ã€Marshalé–¢æ•°ã®ä»£ã‚ã‚Šã«ã“ã‚ŒãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚æ§‹é€ ä½“ã«ã‚²ãƒƒã‚¿ãƒ¼ã‚’ç”¨æ„ã—ã¦ã€MarshalJSONé–¢æ•°ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãªæ§‹é€ ä½“ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªæ§‹é€ ä½“ã«å¯¾ã—ã¦ã‚‚Marshalé–¢æ•°ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ package main import ( \"encoding/json\" \"fmt\" \"log\" ) type Person struct { name string } func NewPerson(name string) *Person { return &Person{ name: name, } } func (p *Person) Name() string { return p.name } func (p *Person) MarshalJSON() ([]byte, error) { byteJson, err := json.Marshal(&struct { // ã“ã“ã§jsonã‚¿ã‚°ã‚’å®šç¾©ã™ã‚‹ã€‚ Name string `json:\"name\"` }{ Name: p.Name(), }) return byteJson, err } func main() { person := NewPerson(\"Hiroki\") byteJson, err := json.Marshal(person) if err != nil { log.Fatalf(\"ERROR: %#v\\n\", err) } // ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰çµæœã‚’å‡ºåŠ› fmt.Printf(\"%#v\\n\", string(byteJson)) // \"{\\\"Name\\\":\\\"Hiroki\\\"}\" } ãƒ»Unmarshalé–¢æ•° JSONã‚’æ§‹é€ ä½“ã«å¤‰æ›ã™ã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å—ä¿¡ã«ã‚ˆãä½¿ã‚ã‚Œã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«ã¯ãƒã‚¤ãƒˆå‹ãƒ‡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ãŸã‚ã€Unmarshalé–¢æ•°ã®ç¬¬ä¸€å¼•æ•°ã¯ãƒã‚¤ãƒˆå‹ã«ãªã‚‹ã€‚ã¾ãŸã€ç¬¬äºŒå¼•æ•°ã¨ã—ã¦ã€å¤‰æ›å¾Œã®æ§‹é€ ä½“ã®ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ¸¡ã™ã“ã¨ã«ã‚ˆã‚Šã€ç¬¬ä¸€å¼•æ•°ãŒãã®æ§‹é€ ä½“ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚å†…éƒ¨çš„ã«ã¯ã€ãã®ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å¤‰æ•°ã‚’æ›¸ãæ›ãˆã¦ã„ã‚‹ã€‚Unmarshalé–¢æ•°ã«æ¸¡ã™æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãŒå¿…è¦ã§ã‚ã‚‹ãŒã€Marshalé–¢æ•°ã¨åŒæ§˜ã«ã—ã¦ã€UnMarshalJSONé–¢æ•°ã‚’æ§‹é€ ä½“ã«å®šç¾©ã™ã‚Œã°ã€ä»£ã‚ã‚Šã«ã“ã‚Œã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://golang.org/pkg/encoding/json/#Unmarshal ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"encoding/json\" \"fmt\" \"log\" ) type Person struct { // Unmarshalã«æ¸¡ã™æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãŒå¿…é ˆ Name string } func main() { // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã—ãŸå ´åˆã‚’æƒ³å®šã™ã‚‹ã€‚ byte := []byte(`{\"name\":\"Hiroki\"}`) var person Person fmt.Printf(\"%#v\\n\", person) // main.Person{Name:\"\"}ï¼ˆå¤‰æ•°ã¯ã¾ã æ›¸ãæ›ãˆã‚‰ã‚Œã¦ã„ãªã„ï¼‰ // personå¤‰æ•°ã‚’å¤‰æ›å¾Œã®å€¤ã«æ›¸ãæ›ãˆã¦ã„ã‚‹ã€‚ err := json.Unmarshal(byteJson, &person) if err != nil { log.Fatalf(\"ERROR: %#v\\n\", err) } fmt.Printf(\"%#v\\n\", person) // main.Person{Name:\"Hiroki\"}ï¼ˆå¤‰æ•°ãŒæ›¸ãæ›ãˆã‚‰ã‚ŒãŸï¼‰ } ãƒ»RawMessageé–¢æ•° JSONã‹ã‚‰æ§‹é€ ä½“ã«ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ãŸã‚ã«Unmarshalé–¢æ•°ã‚’å®Ÿè¡Œã—ãŸæ™‚ã«ã€éƒ¨åˆ†çš„ã«ãƒ‘ãƒ¼ã‚¹ã›ãšã«JSONã®ã¾ã¾å–å¾—ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š CloudWatchã¯æ§˜ã€…ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’æ‰±ã†ãŸã‚ã€ä¸€éƒ¨ã®JSONæ§‹é€ ãŒå‹•çš„ã«å¤‰åŒ–ã™ã‚‹ã€‚ãã®ãŸã‚ã€RawMessageé–¢æ•°ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws/aws-lambda-go/blob/master/events/cloudwatch_events.go package events import ( \"encoding/json\" \"time\" ) type CloudWatchEvent struct { Version string `json:\"version\"` // ï½ ä¸­ç•¥ ï½ Resources []string `json:\"resources\"` // å‹•çš„ã«å¤‰åŒ–ã™ã‚‹JSONæ§‹é€  Detail json.RawMessage `json:\"detail\"` } ã‚¤ãƒ™ãƒ³ãƒˆã®JSONã‚’æ–‡å­—åˆ—ã®ã¾ã¾å–å¾—ã§ãã‚‹ã€‚ package handler import ( \"fmt\" ) /** * Lambdaãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•° */ func HandleRequest(event events.CloudWatchEvent) (string) { return fmt.Printf(\"%#v\\n\", event.Detail) } ãƒ»Indenté–¢æ•° æ¸¡ã•ã‚ŒãŸJSONã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æŒ¿å…¥ã™ã‚‹ã€‚ã‚¿ãƒ–ã‚’æŒ¿å…¥ã™ã‚‹å ´åˆã¯ã€\\tã€ã€ç©ºç™½äºŒã¤ã‚’æŒ¿å…¥ã™ã‚‹å ´åˆã¯ã€ ã€ã‚’è¨­å®šã™ã‚‹ã€‚æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã¨ã€æ•´å½¢ã•ã‚ŒãŸJSONã‚’ç¢ºèªã§ãã‚‹ã€‚ package main import ( \"bytes\" \"encoding/json\" \"fmt\" \"log\" ) type Objects struct { Id int Name string } func main() { objects := []Objects{ {1, \"Hiroki\"}, {2, \"Hiroko\"}, {3, \"Hiroshi\"}, } byteJson, err := json.Marshal(objects) if err != nil { log.Fatal(err) } var buf bytes.Buffer // ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆã‚¿ãƒ–ã€ç©ºç™½ï¼‰ã‚’æŒ¿å…¥ã™ã‚‹ã€‚ json.Indent(&buf, byteJson, \"\", \"\\t\") // json.Indent(&buf, byteJson, \"\", \" \") fmt.Println(buf.String()) } /* çµæœ [ { \"Id\": 1, \"Name\": \"Hiroki\" }, { \"Id\": 2, \"Name\": \"Hiroko\" }, { \"Id\": 3, \"Name\": \"Hiroshi\" } ] */ fmt ãƒ»æ¥é ­æ¥å°¾è¾ç„¡ã—ãƒ¡ã‚½ãƒƒãƒ‰ æ¥é ­æ¥å°¾è¾ã®ç„¡ã„ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆPrintãƒ¡ã‚½ãƒƒãƒ‰ã€Sprintãƒ¡ã‚½ãƒƒãƒ‰ã€Fprintãƒ¡ã‚½ãƒƒãƒ‰ã€ãªã©ï¼‰ãŒå±ã™ã‚‹ã€‚è¤‡æ•°ã®å¼•æ•°ã‚’ã‚¹ãƒšãƒ¼ã‚¹ã‚’æŒŸã‚“ã§ç¹‹ãã€‚ å‚è€ƒï¼š https://golang.org/pkg/fmt/#Print https://golang.org/pkg/fmt/#Fprint https://golang.org/pkg/fmt/#Sprint ï¼Šå®Ÿè£…ä¾‹ï¼Š package mainimport \"fmt\"func main() { fmt.Print(\"Hello world!\") // Hello world! } ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import \"fmt\" func main() { // è¤‡æ•°ã®å¼•æ•°ã‚’ã‚¹ãƒšãƒ¼ã‚¹ã§æŒŸã‚“ã§ç¹‹ã fmt.Print(1, 2, 3) // 1 2 3 } ãŸã ã—ã€å¼•æ•°ã®ã„ãšã‚Œã‹ãŒæ–‡å­—åˆ—ã®å€¤ã®å ´åˆã€ã‚¹ãƒšãƒ¼ã‚¹ãŒæŒ¿å…¥ã•ã‚Œãªã„ã€‚ package main import \"fmt\" func main() { // ã„ãšã‚Œã‹ãŒæ–‡å­—åˆ— fmt.Print(\"Hello\", \"world!\", 12345) // Helloworld!12345 } ã¾ãŸã€é€£ç¶šã§ç”¨ã„ã¦ã‚‚ã€æ”¹è¡ŒãŒæŒ¿å…¥ã•ã‚Œãªã„ã€‚ package main import \"fmt\" func main() { fmt.Print(\"Hello\", \"world!\") fmt.Print(\"Hello\", \"world!\") // Hello world!Hello world! } ãƒ»æ¥é ­è¾Sãƒ¡ã‚½ãƒƒãƒ‰ æ¥é ­è¾ã«Sã®ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆSprintãƒ¡ã‚½ãƒƒãƒ‰ã€Sprintfãƒ¡ã‚½ãƒƒãƒ‰ã€Sprintlnãƒ¡ã‚½ãƒƒãƒ‰ã€ãªã©ï¼‰ãŒå±ã™ã‚‹ã€‚æ¥é ­è¾ãŒFã‚„Pã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã¯ç•°ãªã‚Šã€å‡¦ç†çµæœã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã›ãšã«è¿”å´ã™ã‚‹ã€‚æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã§ãã‚‹ä»–ã®é–¢æ•°ã®å¼•æ•°ã¨ã—ã¦æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼š https://golang.org/pkg/fmt/#Sprint https://golang.org/pkg/fmt/#Sprintf https://golang.org/pkg/fmt/#Sprintln ï¼Šå®Ÿè£…ä¾‹ï¼Š package mainimport \"fmt\"func main() { // Sprintã¯è¿”å´ã™ã‚‹ã ã‘ fmt.Print(fmt.Sprint(1, 2, 3)) // 1 2 3} ãƒ»æ¥å°¾è¾lnãƒ¡ã‚½ãƒƒãƒ‰ æ¥å°¾è¾ã«lnã®ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆPrintlnãƒ¡ã‚½ãƒƒãƒ‰ã€Fprintlnãƒ¡ã‚½ãƒƒãƒ‰ã€Sprintlnãƒ¡ã‚½ãƒƒãƒ‰ã€ãªã©ï¼‰ãŒå±ã™ã‚‹ã€‚è¤‡æ•°ã®å¼•æ•°ã‚’ã‚¹ãƒšãƒ¼ã‚¹ã‚’æŒŸã‚“ã§ç¹‹ãã€æœ€å¾Œã«æ”¹è¡Œã‚’æŒ¿å…¥ã—ã¦çµåˆã™ã‚‹ã€‚ å‚è€ƒï¼š https://golang.org/pkg/fmt/#Println https://golang.org/pkg/fmt/#Fprintln https://golang.org/pkg/fmt/#Sprintln ï¼Šå®Ÿè£…ä¾‹ï¼Š æ–‡å­—ã‚’é€£ç¶šã§æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ package mainimport \"fmt\"func main() { fmt.Println(\"Hello\", \"world!\") fmt.Println(\"Hello\", \"world!\") // Hello world! // Hello world!} ãƒ»æ¥å°¾è¾fãƒ¡ã‚½ãƒƒãƒ‰ æ¸¡ã•ã‚ŒãŸå¼•æ•°ã‚’ã€äº‹å‰ã«å®šç¾©ã—ãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã‚‚åŸºã¥ã„ã¦çµåˆã™ã‚‹ã€‚ ã‚ˆãä½¿ã†è­˜åˆ¥å­ æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚Œã‚‹ã‚‚ã® å‚™è€ƒ %s æ–‡å­—åˆ—ã¾ãŸã¯ã‚¹ãƒ©ã‚¤ã‚¹ã¨ã—ã¦ %p ãƒã‚¤ãƒ³ã‚¿ã¨ã—ã¦ %+v ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å«ã‚€æ§‹é€ ä½“ã¨ã—ã¦ ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’ç¢ºèªã§ãã‚‹ãŸã‚ã€ãƒ‡ãƒãƒƒã‚°ã«æœ‰åŠ¹ã§ã‚ã‚‹ã€‚ %#v Goæ§‹æ–‡ã¨ã—ã¦ ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’ç¢ºèªã§ãã‚‹ãŸã‚ã€ãƒ‡ãƒãƒƒã‚°ã«æœ‰åŠ¹ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://golang.org/pkg/fmt/#Printf https://golang.org/pkg/fmt/#Fprintf https://golang.org/pkg/fmt/#Sprintf ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¸¡ã•ã‚ŒãŸå¼•æ•°ã‚’æ–‡å­—åˆ—ã¨ã—ã¦çµåˆã™ã‚‹ package main import \"fmt\" func main() { fmt.Printf(\"String is %s\", \"Hello world!\") } ã¾ãŸã€é€£ç¶šã—ã¦ç”¨ã„ã¦ã‚‚ã€æ”¹è¡Œã¯æŒ¿å…¥ã•ã‚Œãªã„ã€‚ package main import \"fmt\" func main() { fmt.Printf(\"String is %s\", \"Hello world!\") fmt.Printf(\"String is %s\", \"Hello world!\") // String is Hello world!String is Hello world! } ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¸¡ã•ã‚ŒãŸå¼•æ•°ã‚’ãƒã‚¤ãƒ³ã‚¿ã¨ã—ã¦çµåˆã™ã‚‹ã€‚ package main import \"fmt\" type Person struct { Name string } func main() { person:= new(Person) person.Name = \"Hiroki\" fmt.Printf(\"Pointer is %p\", person) // 0xc0000821e0 } ï¼Šå®Ÿè£…ä¾‹ï¼Š æ¸¡ã•ã‚ŒãŸè¤‡æ•°ã®å¼•æ•°ã‚’æ–‡å­—åˆ—ã¨ã—ã¦çµåˆã™ã‚‹ã€‚ package mainimport \"fmt\"func main() { var first string = \"Hiroki\" var last string = \"Hasegawa\" fmt.Printf(\"Im %s %s\", first, last) // Im Hiroki Hasegawa} net/http ãƒ»httpãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã¯ HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¾ãŸã¯Webã‚µãƒ¼ãƒã‚’æä¾›ã™ã‚‹ã€‚ãã®ãŸã‚ã€Goã§ã¯Nginxã‚„ApacheãŒä¸è¦ã§ã‚ã‚‹ã€‚ãŸã ã€Goã«ã‚ˆã‚‹Webã‚µãƒ¼ãƒã¯æ©Ÿèƒ½ãŒä¸ååˆ†ã§ã‚ã‚‹ã€ãã®ãŸã‚ã€Nginxã‚„Apacheã‚’Webã‚µãƒ¼ãƒã¨ã—ã¦ã€Goã‚’Appã‚µãƒ¼ãƒã¨ã—ã¦ç”¨ã„ãŸæ–¹ãŒè‰¯ã„ã€‚ å‚è€ƒï¼š https://golang.org/pkg/net/http/#pkg-index https://stackoverflow.com/questions/17776584/what-are-the-benefits-of-using-nginx-in-front-of-a-webserver-for-go ãƒ»Getãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š package mainimport ( \"fmt\" \"log\" \"net/http\")func main() { response, err := http.Get(\"http://xxx/api.com\") defer response.Body.Close() if err != nil { log.Fatal(err) } fmt.Println(response.Body)} ãƒ»Postãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š package mainimport ( \"bytes\" \"encoding/json\" \"fmt\" \"log\" \"net/http\")type User struct { id int `json:\"id\"` name string `json:\"name\"`}// ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿func NewUser(id int, name string) *User { return &User{ id: id, name: name, }}func main() { user := NewUser(1, \"Hiroki\") byteJson, err := json.Marshal(user) response, err := http.Post( \"http://xxx/api.com\", // URL \"application/json\", // Content-Type bytes.NewBuffer(byteJson), // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ ) defer response.Body.Close() if err != nil { log.Fatal(err) } fmt.Println(response.Body)} ãƒ»NewRequestãƒ¡ã‚½ãƒƒãƒ‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"bytes\" \"encoding/json\" \"fmt\" \"log\" \"net/http\" ) type User struct { id int `json:\"id\"` name string `json:\"name\"` } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ func NewUser(id int, name string) *User { return &User{ id: id, name: name, } } func main() { user := NewUser(1, \"Hiroki\") byteJson, err := json.Marshal(user) // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ request, err := http.NewRequest( \"POST\", // HTTPãƒ¡ã‚½ãƒƒãƒ‰ \"http://xxx/api.com\", // URL bytes.NewBuffer(byteJson), // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ ) // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚ request.Header.Set(\"Content-Type\", \"application/json\") // Content-Type // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ client := &http.Client{} // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ response, err := client.Do(request) defer response.Body.Close() if err != nil || response.StatusCode != 200 { log.Fatal(err) } // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒœãƒ‡ã‚£ã‚’å–å¾—ã™ã‚‹ã€‚ // ä»£ã‚ã‚Šã«ã€httputil.DumpResponseã‚’ç”¨ã„ã¦ã‚‚ã‚ˆã„ã€‚ body, _ := ioutil.ReadAll(response.Body) log.Println(string(body)) } ãƒ»ListenAndServeãƒ¡ã‚½ãƒƒãƒ‰ ã‚µãƒ¼ãƒã‚’èµ·å‹•ã™ã‚‹ã€‚ç¬¬ä¸€å¼•æ•°ã«ã‚µãƒ¼ãƒã®URLã€ç¬¬äºŒå¼•æ•°ã«ServeMuxé–¢æ•°ï¼ˆãƒãƒ«ãƒãƒ—ãƒ¬ã‚¯ã‚µé–¢æ•°ï¼‰ã‚’æ¸¡ã™ã€‚ç¬¬äºŒå¼•æ•°ã«nilã‚’æ¸¡ã—ãŸå ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¼•æ•°ã¨ã—ã¦http.DefaultServeMuxãŒæ¸¡ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"net/http\" \"log\" ) func main() { err := http.ListenAndServe(\":8080\", nil) // ä»¥ä¸‹ã§ã‚‚åŒã˜ã€‚ // http.ListenAndServe(\":8080\", http.DefaultServeMux) if err != nil { log.Fatal(\"Error ListenAndServe : \", err) } } ãƒ»NewServeMuxãƒ¡ã‚½ãƒƒãƒ‰ ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã™ã‚‹ListenAndServeãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ã€è‡ªèº«ã§å®šç¾©ã—ãŸServeMuxé–¢æ•°ã‚’æ¸¡ã™å ´åˆã€NewServeMuxãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã‚Œã®HandleFuncé–¢æ•°ã«å¯¾ã—ã¦ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨é–¢æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š HTMLã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã‚µãƒ¼ãƒï¼ˆhttp://localhost:8080/ï¼‰ã‚’èµ·å‹•ã™ã‚‹ã€‚ package main import ( \"log\" \"net/http\" ) func myHandler(writer http.ResponseWriter, request *http.Request) { // HTMLã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚ fmt.Fprintf(writer, \"Hello world!\") } func main() { mux := http.NewServeMux() // ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨é–¢æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ mux.HandleFunc(\"/\", myHandler) // ã‚µãƒ¼ãƒã‚’èµ·å‹•ã™ã‚‹ã€‚ err := http.ListenAndServe(\":8080\", mux) if err != nil { log.Fatal(\"Error ListenAndServe : \", err) } } JSONã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã‚µãƒ¼ãƒï¼ˆhttp://localhost:8080/ï¼‰ã‚’èµ·å‹•ã™ã‚‹ã€‚ package main import ( \"encoding/json\" \"log\" \"net/http\" ) type User struct { Id int `json:\"id\"` Name string `json:\"name\"` } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ func NewUser(id int, name string) *User { return &User{ Id: id, Name: name, } } func myHandler(writer http.ResponseWriter, request *http.Request) { user := NewUser(1, \"Hiroki\") byteJson, err := json.Marshal(user) if err != nil { log.Fatal(err) } // JSONã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚ writer.Header().Set(\"Content-Type\", \"application/json; charset=utf-8\") writer.Write(byteJson) } func main() { mux := http.NewServeMux() // ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨é–¢æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ mux.HandleFunc(\"/\", myHandler) // ã‚µãƒ¼ãƒã‚’èµ·å‹•ã™ã‚‹ã€‚ err := http.ListenAndServe(\":8080\", mux) if err != nil { log.Fatal(err) } } os ãƒ»Opené–¢æ•° ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ReadOnlyçŠ¶æ…‹ã«ã™ã‚‹ã€‚ package main import ( \"fmt\" \"os\" ) func main() { file, err := os.Open(\"filename.txt\") if err != nil { log.Fatalf(\"ERROR: %#v\\n\", err) } fmt.Printf(\"%#v\\n\", file) } reflect ãƒ»TypeOfãƒ¡ã‚½ãƒƒãƒ‰ã€ValueOfãƒ¡ã‚½ãƒƒãƒ‰ æ§‹é€ ä½“ã‹ã‚‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒè¤‡æ•°ã‚ã‚‹å ´åˆã¯ã€è¦ç´ ç•ªå·ã®æŒ‡å®šãŒå¿…è¦ã«ãªã‚‹ãŸã‚ã€äº‹å‰ã«è¦ç´ æ•°ã‚’å–å¾—ã™ã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã€‚ package main import ( \"fmt\" \"reflect\" ) type Foo struct { bar string baz int } func main() { foo := &Foo{bar: \"BAR\", baz: 1} fields := reflect.TypeOf(*foo) fmt.Println(fields) values := reflect.ValueOf(*foo) // å†å¸°çš„ã«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨å€¤ã‚’å–å¾—ã™ã‚‹ for i := 0; i strings ãƒ»Builderé–¢æ•° æ¸¡ã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’çµåˆã—ã€æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package main import ( \"fmt\" \"strings\" ) func main() { var builder strings.Builder builder.WriteString(\"Hello \") builder.WriteString(\"world!\") fmt.Println(builder.String()) // Hello world! } "},"public/software/software_application_procedural_language_go_package.html":{"url":"public/software/software_application_procedural_language_go_package.html","title":"ğŸ“– ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸","keywords":"","body":"ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_procedural_language_go_logic_method_data.html 02. aws-sdk-go-v2 aws-sdk-go-v2ã¨ã¯ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/aws/aws-sdk-go-v2?tab=versions awsã¨ã¯ æ±ç”¨çš„ãªé–¢æ•°ãŒåŒæ¢±ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/aws/aws-sdk-go-v2/aws?tab=versions ãƒã‚¤ãƒ³ã‚¿å‹ã‹ã‚‰æ–‡å­—åˆ—å‹ã«å¤‰æ›ã™ã‚‹ToStringé–¢æ•°ã‚„ã€åå¯¾ã«æ–‡å­—åˆ—å‹ã‹ã‚‰ãƒã‚¤ãƒ³ã‚¿å‹ã«å¤‰æ›ã™ã‚‹Stringé–¢æ•°ã‚’ã‚ˆãä½¿ã†ã€‚ å‚è€ƒï¼š https://pkg.go.dev/github.com/aws/aws-sdk-go-v2/aws#String https://pkg.go.dev/github.com/aws/aws-sdk-go-v2/aws#ToString ãƒ»serviceãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/aws/aws-sdk-go-v2/service/amplify?tab=versions 03. aws-lambda-go ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws_lambda_function.html 04. gorm gormã¨ã¯ Goè£½ã®ORMã§ã‚ã‚‹ã€‚ Gormãƒ¢ãƒ‡ãƒ« ãƒ»Gormãƒ¢ãƒ‡ãƒ«åŸ‹ã‚è¾¼ã¿ æ§‹é€ ä½“ã«Gormãƒ¢ãƒ‡ãƒ«ã‚’åŸ‹ã‚è¾¼ã‚€ã¨ã€IDã‚„ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦è¿½åŠ ã•ã‚Œã‚‹ã€‚æ§‹é€ ä½“ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã«ã€idã‚«ãƒ©ãƒ ã€created_atã‚«ãƒ©ãƒ ã€updated_atã‚«ãƒ©ãƒ ã€deleted_atã‚«ãƒ©ãƒ ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/models.html#embedded_struct type User struct { gorm.Model Name string } // ä»¥ä¸‹ã¨åŒã˜ type User struct { ID uint `gorm:\"primaryKey\"` Name string CreatedAt time.Time UpdatedAt time.Time DeletedAt gorm.DeleteAt `gorm:\"index\"` } ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ ã€IDã€ã¨ã„ã†åå‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’èªè­˜ã—ã¦ã€ã“ã‚Œã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã€‚ã‚‚ã—ã€ä»–ã®åå‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’IDã¨ã—ã¦ç”¨ã„ãŸã„å ´åˆã¯ã€gorm:\"primaryKey\"ã‚¿ã‚°ã‚’ã¤ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/conventions.html#ID-as-Primary-Key type User struct { ID string // ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ Name string } type User struct { UserID string `gorm:\"primaryKey\"` // ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ Name string } ãƒ»SoftDelete æ§‹é€ ä½“ãŒã€gorm.DeleteAtã‚’ãƒ‡ãƒ¼ã‚¿å‹ã¨ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã£ã¦ã„ã‚‹ã¨ã€ãã®æ§‹é€ ä½“ã‚’ç”¨ã„ãŸDELETEå‡¦ç†ã§ã¯è«–ç†å‰Šé™¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚Gormãƒ¢ãƒ‡ãƒ«ã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ã«ã‚ˆã‚Šã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒãŸã›ã‚‹ã‹ã€ã¾ãŸã¯ç‹¬è‡ªå®šç¾©ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€SoftDeleteã‚’æœ‰åŠ¹åŒ–ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/delete.html#Soft-Delete type User struct { ID int Deleted gorm.DeletedAt Name string } user := User{Id:111} // user's ID is `111` db.Delete(&user) // UPDATE users SET deleted_at=\"2013-10-29 10:23\" WHERE id = 111; // Batch Delete db.Where(\"age = ?\", 20).Delete(&User{}) // UPDATE users SET deleted_at=\"2013-10-29 10:23\" WHERE age = 20; // Soft deleted records will be ignored when querying db.Where(\"age = 20\").Find(&user) // SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL; ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ»TableNameãƒ¡ã‚½ãƒƒãƒ‰ æ¨™æº–ã§ã¯Gormãƒ¢ãƒ‡ãƒ«ã®åå‰ã‚’ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã«å¤‰æ›´ã—ã€ã¾ãŸè¤‡æ•°å½¢ã¨ã—ãŸåå‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚TableNameãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚Šã€ç‹¬è‡ªã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ã¤ã‘ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/conventions.html#TableName // ãƒ†ãƒ¼ãƒ–ãƒ«åã¯æ¨™æº–ã§ã¯ã€usersã€ã«ãªã‚‹ã€‚ type User struct { ID int Deleted gorm.DeletedAt Name string } // ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ã€fooã€ã«ãªã‚‹ã€‚ func (User) TableName() string { return \"foo\" } Create Gormãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¨­å®šã•ã‚ŒãŸå€¤ã‚’å…ƒã«ã€ã‚«ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹ã€‚ä½œæˆã—ãŸã‚«ãƒ©ãƒ ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’ã€æ§‹é€ ä½“ã‹ã‚‰å–å¾—ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/docs/create.html#Create-Record user := User{Name: \"Jinzhu\", Age: 18, Birthday: time.Now()} result := db.Create(&user) // pass pointer of data to Create user.ID // returns inserted data's primary key result.Error // returns error result.RowsAffected // returns inserted records count Read ãƒ»å…¨ã‚«ãƒ©ãƒ å–å¾— å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/query.html#Retrieving-all-objects user := User{} // Get all records result := db.Find(&users) // SELECT * FROM users; result.RowsAffected // returns found records count, equals `len(users)` result.Error // returns error ãƒ»å˜ä¸€ï¼è¤‡æ•°ã‚«ãƒ©ãƒ å–å¾— Gormãƒ¢ãƒ‡ãƒ«ã¨ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’æŒ‡å®šã—ã¦ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®ãƒ¢ãƒ‡ãƒ«ã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸã‚«ãƒ©ãƒ ã‚’å–å¾—ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/query.html#Retrieving-objects-with-primary-key user := User{} db.First(&user, 10) // SELECT * FROM users WHERE id = 10; db.First(&user, \"10\") // SELECT * FROM users WHERE id = 10; db.Find(&users, []int{1,2,3}) // SELECT * FROM users WHERE id IN (1,2,3); Update ãƒ»å˜ä¸€ã‚«ãƒ©ãƒ æ›´æ–°ï¼ˆæš—é»™çš„ï¼‰ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã¯ç„¡é–¢ä¿‚ã«ã€æ¸¡ã•ã‚ŒãŸå€¤ã‚’å…ƒã«UPDATEåˆ†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/update.html#Update-single-column // Update with conditions db.Model(&User{}).Where(\"active = ?\", true).Update(\"name\", \"hello\") // UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE active=true; user := User{Id:111} // User's ID is `111`: db.Model(&user).Update(\"name\", \"hello\") // UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE id=111; // Update with conditions and model value db.Model(&user).Where(\"active = ?\", true).Update(\"name\", \"hello\") // UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE id=111 AND active=true; ãƒ»è¤‡æ•°ã‚«ãƒ©ãƒ æ›´æ–°ï¼ˆæš—é»™çš„ï¼‰ Gormãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æš—é»™çš„ã«æŒ‡å®šã—ã¦ã€è¤‡æ•°ã®ã‚«ãƒ©ãƒ å€¤ã‚’æ›´æ–°ã™ã‚‹ã€‚ã¾ãŸã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã¯ç„¡é–¢ä¿‚ã«ã€ãƒãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã‚’å…ƒã«UPDATEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹ã€‚Gormãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ãŸå ´åˆã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ãŒã‚¼ãƒ­å€¤ã§ã‚ã‚‹ã¨ã€ã“ã‚Œã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸã‚«ãƒ©ãƒ å€¤ã®æ›´æ–°ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¦ã—ã¾ã†ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/update.html#Updates-multiple-columns user := User{Id:111} // Update attributes with `struct`, will only update non-zero fields db.Model(&user).Updates(User{Name: \"hello\", Age: 18, Active: false}) // UPDATE users SET name='hello', age=18, updated_at = '2013-11-17 21:34:10' WHERE id = 111; // Update attributes with `map` db.Model(&user).Updates(map[string]interface{}{\"name\": \"hello\", \"age\": 18, \"active\": false}) // UPDATE users SET name='hello', age=18, active=false, updated_at='2013-11-17 21:34:10' WHERE id=111; ãƒ»è¤‡æ•°ã‚«ãƒ©ãƒ æ›´æ–°ï¼ˆæ˜ç¤ºçš„ï¼‰ Gormãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã—ã¦ã€è¤‡æ•°ã®ã‚«ãƒ©ãƒ å€¤ã‚’æ›´æ–°ã™ã‚‹ã€‚ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ãŒã‚¼ãƒ­å€¤ã§ã‚ã£ã¦ã‚‚ã€ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œãªã„ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/update.html#Update-Selected-Fields user := User{Id:111} // Select with Struct (select zero value fields) db.Model(&user).Select(\"Name\", \"Age\").Updates(User{Name: \"new_name\", Age: 0}) // UPDATE users SET name='new_name', age=0 WHERE id=111; // Select all fields (select all fields include zero value fields) db.Model(&user).Select(\"*\").Updates(User{Name: \"jinzhu\", Role: \"admin\", Age: 0}) // UPDATE users SET name='new_name', age=0 WHERE id=111; ãƒ»å…¨ã‚«ãƒ©ãƒ æ›´æ–° Gormãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æš—é»™çš„ã«å…¨ã¦æŒ‡å®šã—ã¦ã€å…¨ã¦ã®ã‚«ãƒ©ãƒ å€¤ã‚’å¼·åˆ¶çš„ã«æ›´æ–°ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://gorm.io/ja_JP/docs/update.html#Save-All-Fields user := User{Id:111} db.First(&user) user.Name = \"jinzhu 2\" user.Age = 100 db.Save(&user) // UPDATE users SET name='jinzhu 2', age=100, birthday='2016-01-01', updated_at = '2013-11-17 21:34:10' WHERE id=111; 05. testify testifyã¨ã¯ ãƒ¢ãƒƒã‚¯ã€ã‚¹ã‚¿ãƒ–ã€ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚Goã§ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ¦‚å¿µãŒãªã„ãŸã‚ã€ãƒ¢ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯è¨€ã‚ãªã„ã€‚ãƒ¢ãƒƒã‚¯ã¨ã‚¹ã‚¿ãƒ–ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_testing_based_on_code.html mockã€assert ãƒ»ãƒ¢ãƒƒã‚¯åŒ– ã‚ˆãä½¿ã†ãƒ¡ã‚½ãƒƒãƒ‰ èª¬æ˜ ãªã— ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã€æ§‹é€ ä½“ã«Mockã‚’è¨­å®šã™ã‚Œã°ã€ãã®æ§‹é€ ä½“ã¯ãƒ¢ãƒƒã‚¯åŒ–ã•ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š AWSã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ãƒ¢ãƒƒã‚¯åŒ–ã™ã‚‹ã€‚ package amplify import ( \"github.com/stretchr/testify/mock\" ) /** * AWSã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ãƒ¢ãƒƒã‚¯åŒ–ã—ã¾ã™ã€‚ */ type MockedAwsClient struct { mock.Mock } ãƒ»ã‚¹ã‚¿ãƒ–åŒ– å‚è€ƒï¼šhttps://pkg.go.dev/github.com/stretchr/testify/mock?tab=versions ã‚ˆãä½¿ã†ãƒ¡ã‚½ãƒƒãƒ‰ èª¬æ˜ Mock.Calledãƒ¡ã‚½ãƒƒãƒ‰ é–¢æ•°ã®ä¸€éƒ¨ã®å‡¦ç†ã‚’ã‚¹ã‚¿ãƒ–åŒ–ã™ã‚‹æ™‚ã«ç”¨ã„ã‚‹ã€‚é–¢æ•°ã«å€¤ãŒæ¸¡ã•ã‚ŒãŸã“ã¨ã‚’ãƒ¢ãƒƒã‚¯ã«ä¼ãˆã‚‹ã€‚ Arguments.Getãƒ¡ã‚½ãƒƒãƒ‰ é–¢æ•°ã®ä¸€éƒ¨ã®å‡¦ç†ã‚’ã‚¹ã‚¿ãƒ–åŒ–ã™ã‚‹æ™‚ã«ç”¨ã„ã‚‹ã€‚å¼•æ•°ã¨ã—ã¦ã€è¿”å´å€¤ã®é †ç•ªã‚’æ¸¡ã™ã€‚ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’è¿”å´ã™ã‚‹å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚ Arguments.Errorãƒ¡ã‚½ãƒƒãƒ‰ é–¢æ•°ã®ä¸€éƒ¨ã®å‡¦ç†ã‚’ã‚¹ã‚¿ãƒ–åŒ–ã™ã‚‹æ™‚ã«ç”¨ã„ã‚‹ã€‚å¼•æ•°ã¨ã—ã¦ã€è¿”å´å€¤ã®é †ç•ªã‚’æ¸¡ã™ã€‚ã‚¨ãƒ©ãƒ¼ã‚’è¿”å´ã™ã‚‹å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š é–¢æ•°ã®ä¸€éƒ¨ã®å‡¦ç†ã‚’ã‚¹ã‚¿ãƒ–åŒ–ã—ã€ã“ã‚Œã‚’AWSã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ¢ãƒƒã‚¯ã«ç´ä»˜ã‘ã‚‹ã€‚ package amplify import ( aws_amplify \"github.com/aws/aws-sdk-go-v2/service/amplify\" \"github.com/stretchr/testify/mock\" ) type MockedAmplifyAPI struct { mock.Mock } /** * Amplifyã®GetBranché–¢æ•°ã®å‡¦ç†ã‚’ã‚¹ã‚¿ãƒ–åŒ–ã—ã¾ã™ã€‚ */ func (mock *MockedAmplifyAPI) GetBranch(ctx context.Context, params *aws_amplify.GetBranchInput, optFns ...func(*aws_amplify.Options)) (*aws_amplify.GetBranchOutput, error) { arguments := mock.Called(ctx, params, optFns) return arguments.Get(0).(*aws_amplify.GetBranchOutput), arguments.Error(1) } ãƒ»ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹æ¤œè¨¼ å‚è€ƒï¼š https://pkg.go.dev/github.com/stretchr/testify/mock?tab=versions https://pkg.go.dev/github.com/stretchr/testify/assert?tab=versions ã‚ˆãä½¿ã†ãƒ¡ã‚½ãƒƒãƒ‰ èª¬æ˜ Mock.Onãƒ¡ã‚½ãƒƒãƒ‰ é–¢æ•°ã®æ¤œè¨¼æ™‚ã«ç”¨ã„ã‚‹ã€‚é–¢æ•°å†…éƒ¨ã®ã‚¹ã‚¿ãƒ–ã«å¼•æ•°ã¨ã—ã¦æ¸¡ã•ã‚Œã‚‹å€¤ã¨ã€ãã®æ™‚ã®è¿”å´å€¤ã‚’å®šç¾©ã™ã‚‹ã€‚ Mock.AssertExpectationsãƒ¡ã‚½ãƒƒãƒ‰ é–¢æ•°ã®æ¤œè¨¼æ™‚ã«ç”¨ã„ã‚‹ã€‚é–¢æ•°å†…éƒ¨ã®ã‚¹ã‚¿ãƒ–ãŒæ­£ã—ãå®Ÿè¡Œã•ã‚ŒãŸã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ assert.Exactlyãƒ¡ã‚½ãƒƒãƒ‰ é–¢æ•°ã®æ¤œè¨¼æ™‚ã«ç”¨ã„ã‚‹ã€‚æœŸå¾…å€¤ã¨å®Ÿéš›å€¤ã®æ•´åˆæ€§ã‚’æ¤œè¨¼ã™ã‚‹ã€‚å€¤ã ã‘ã§ãªãã€ãƒ‡ãƒ¼ã‚¿å‹ã‚‚æ¤œè¨¼ã§ãã‚‹ã€‚ ãƒ»å‰å‡¦ç†ã¨å¾Œå‡¦ç† ãƒ†ã‚¹ãƒˆé–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ç›´å‰ã«ã€å‰å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒ¢ãƒƒã‚¯ã®ç”Ÿæˆã®ãŸã‚ã«ç”¨ã„ã‚‹ã¨ã‚ˆã„ã€‚PHPUnitã«ãŠã‘ã‚‹å‰å‡¦ç†ã¨å¾Œå‡¦ç†ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_testing_based_on_code.html å‰å‡¦ç†ã¨å¾Œå‡¦ç†ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://github.com/google/go-github/blob/master/github/github_test.go#L36-L66 ã‚ˆãä½¿ã†é–¢æ•° å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚° èª¬æ˜ SetupSuite 1 ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå†…ã®å…¨ã¦ã®ãƒ†ã‚¹ãƒˆã®å‰å‡¦ç†ã¨ã—ã¦ã€ä¸€å›ã ã‘å®Ÿè¡Œã™ã‚‹ã€‚ SetupTest 2 ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå†…ã®å„ãƒ†ã‚¹ãƒˆã®å‰å‡¦ç†ã¨ã—ã¦ã€ãƒ†ã‚¹ãƒˆã®åº¦ã«äº‹å‰ã«å®Ÿè¡Œã™ã‚‹ã€‚BeforeTesté–¢æ•°ã‚ˆã‚Šã‚‚å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ BeforeTest 3 ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå†…ã®å„ãƒ†ã‚¹ãƒˆã®ç›´å‰ã®å‰å‡¦ç†ã¨ã—ã¦ã€ãƒ†ã‚¹ãƒˆã®åº¦ã«äº‹å‰ã«å®Ÿè¡Œã™ã‚‹ã€‚å¿…ãšã€ã€suiteNameã€ã€testNameã€ã‚’å¼•æ•°ã¨ã—ã¦è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ AfterTest 4 ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå†…ã®å„ãƒ†ã‚¹ãƒˆã®ç›´å¾Œã®å¾Œå‡¦ç†ã¨ã—ã¦ã€ãƒ†ã‚¹ãƒˆã®åº¦ã«äº‹å¾Œã«å®Ÿè¡Œã™ã‚‹ã€‚å¿…ãšã€ã€suiteNameã€ã€testNameã€ã‚’å¼•æ•°ã¨ã—ã¦è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ TearDownTest 5 ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå†…ã®å„ãƒ†ã‚¹ãƒˆã®å¾Œå‡¦ç†ã¨ã—ã¦ã€ãƒ†ã‚¹ãƒˆã®åº¦ã«äº‹å¾Œã«å®Ÿè¡Œã™ã‚‹ã€‚BeforeTesté–¢æ•°ã‚ˆã‚Šã‚‚å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ TearDownSuite 6 ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå†…ã®å…¨ã¦ã®ãƒ†ã‚¹ãƒˆã®å¾Œå‡¦ç†ã¨ã—ã¦ã€ä¸€å›ã ã‘å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š äº‹å‰ã«ãƒ¢ãƒƒã‚¯ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã€BeforeTesté–¢æ•°ã‚’ç”¨ã„ã‚‹ã€‚ package foo import ( \"testing\" ) /** * ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’æ§‹æˆã™ã‚‹ã€‚ */ type FooSuite struct { suite.Suite fooMock *FooMock } /** * ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ç›´å‰ã®å‰å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ */ func (suite *FooSuite) BeforeTest(suiteName string, testName string) { // ãƒ¢ãƒƒã‚¯ã‚’ç”Ÿæˆã™ã‚‹ã€‚ suite.fooMock = &FooMock{} } /** * ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚ */ func TestFooSuite(t *testing.T) { suite.Run(t, &FooSuite{}) } package foo import ( \"github.com/stretchr/testify/assert\" ) /** * Methodãƒ¡ã‚½ãƒƒãƒ‰ãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã€‚ */ func (suite *FooSuite) TestMethod() { suite.T().Helper() // å‰å‡¦ç†ã§ç”Ÿæˆã—ãŸãƒ¢ãƒƒã‚¯ã‚’ç”¨ã„ã‚‹ã€‚ fooMock := suite.fooMock // ä»¥é™ã«ãƒ†ã‚¹ãƒˆå‡¦ç† } 06. validator validatorã¨ã¯ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ package validators import ( \"fmt\" \"github.com/go-playground/validator\" ) type FoobarbazValidator struct { Foo string `json:\"foo\" validate:\"required\"` Bar string `json:\"bar\" validate:\"required\"` Baz string `json:\"baz\" validate:\"required\"` } // NewValidator ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ func NewValidator() *Validator { return &Validator{} } // Validate ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ func (v *FoobarbazValidator) Validate() map[string]string { err := validator.New().Struct(v) var errorMessages = make(map[string]string) if err != nil { for _, err := range err.(validator.ValidationErrors) { switch err.Field() { // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã”ã¨ã«ãƒãƒƒãƒ—å½¢å¼ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ§‹æˆã—ã¾ã™ã€‚ case \"foo\": errorMessages[\"foo\"] = v.stringValidation(err) errorMessages[\"foo\"] = v.requiredValidation(err) case \"bar\": errorMessages[\"bar\"] = v.stringValidation(err) case \"baz\": errorMessages[\"baz\"] = v.stringValidation(err) errorMessages[\"baz\"] = v.requiredValidation(err) } } } return errorMessages } // stringValidation æ–‡å­—åˆ—å‹æŒ‡å®šã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”å´ã—ã¾ã™ã€‚ func (v *FoobarbazValidator) stringValidation(err validator.FieldError) string { return fmt.Sprintf(\"%s ã¯æ–‡å­—åˆ—ã®ã¿æœ‰åŠ¹ã§ã™\", err.Field()) } // requiredValidation å¿…é ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”å´ã—ã¾ã™ã€‚ func (v *FoobarbazValidator) requiredValidation(err validator.FieldError) string { return fmt.Sprintf(\"%s ã¯å¿…é ˆã§ã™\", err.Field()) } package main import ( \"encoding/json\" \"fmt\" \"log\" \"github.com/foobarbaz_repository/validators\" ) func main() { v := NewFoobarbazValidator() // JSONã‚’æ§‹é€ ä½“ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¾ã™ã€‚ err := json.Unmarshal([]byte(`{\"foo\": \"test\", \"bar\": \"test\", \"baz\": \"test\"}`), v) if err != nil { log.Println(\"JSONã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\") } // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ errorMessages := v.Validate() if len(errorMessages) > 0 { // ãƒãƒƒãƒ—ã‚’JSONã«å¤‰æ›ã—ã¾ã™ã€‚ byteJson, _ := json.Marshal(errorMessages) fmt.Printf(\"%#v\\n\", byteJson) } // ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰çµæœã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ fmt.Println(\"ãƒ‡ãƒ¼ã‚¿ã«å•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\") } 07. å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç®¡ç† ã‚³ãƒãƒ³ãƒ‰ ãƒ»go mod tidy ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«åˆã‚ã›ã¦ã€go.modãƒ•ã‚¡ã‚¤ãƒ«ã¨go.sumãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹ã€‚ $ go mod tidy go.modãƒ•ã‚¡ã‚¤ãƒ« ãƒ»go.modãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ PHPã«ãŠã‘ã‚‹composer.jsonãƒ•ã‚¡ã‚¤ãƒ«ã«ç›¸å½“ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã«ãŠã‘ã‚‹è‡ªèº«ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¨Goãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã€å…¨ã¦ã®Goã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å¿…ãšå¿…è¦ã§ã‚ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚‚å®šç¾©ã§ãã‚‹ã€‚ module github.com/hiroki-it/foo_repository go 1.16 ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚°ã‚’ç”¨ã„ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚go mod tidyã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦indirectã‚³ãƒ¡ãƒ³ãƒˆã®ã¤ã„ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå®Ÿè£…ã•ã‚Œã‚‹ã€‚ã“ã‚Œã¯ã€ç”¨ã„ã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã¯ãªãã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä¾å­˜ã—ã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã‚ã‚‹ã€‚ãªãŠã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¯ã€ç”¨ã„ãŸã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®go.modãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã€‚ å‚è€ƒï¼šhttps://github.com/golang/go/wiki/Modules#should-i-commit-my-gosum-file-as-well-as-my-gomod-file module github.com/hiroki-it/repository go 1.16 require ( github.com/foo v1.3.0 github.com/bar v1.0.0 github.com/baz // indirect ) import \"github.com/bar\" func main() { // ä½•ã‚‰ã‹ã®å‡¦ç† } ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ãƒ­ãƒ¼ã‚«ãƒ«PCã§ã®ã¿ç”¨ã„ã‚‹ç‹¬è‡ªå…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã§ã®è‡ªèº«ã®ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã›ãšã«ã€replaceé–¢æ•°ã‚’ç”¨ã„ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ç‹¬è‡ªå…±æœ‰ã®å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã‚’ç½®æ›ã™ã‚‹å¿…è¦ã¯ãªãã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã«ã¤ã„ã¦ã®ã¿å®šç¾©ã™ã‚Œã°ã‚ˆã„ã€‚ãƒ‘ã‚¹å®Ÿéš›ã€unknown revisionã®ã‚¨ãƒ©ãƒ¼ã§ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œãªã„ã€‚ å‚è€ƒï¼šhttps://qiita.com/hnishi/items/a9217249d7832ed2c035 module foo.com/hiroki-it/repository go 1.16 replace github.com/hiroki-it/foo_repository => / ã¾ãŸã€ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã ã‘ã§ãªãã€å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚‚go.modãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ foo_repository â”œâ”€â”€ cmd â”‚ â””â”€â”€ hello.go â”‚ â”œâ”€â”€ go.mod â”œâ”€â”€ go.sum â””â”€â”€ local-pkg â”œâ”€â”€ go.mod # å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«go.modã‚’é…ç½®ã™ã‚‹ã€‚ â””â”€â”€ module.go module foo.com/hiroki-it/foo_repository/local-pkg go 1.16 ã“ã‚Œã‚‰ã«ã‚ˆã‚Šã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ import \"local.packages/local-pkg\" func main() { // ä½•ã‚‰ã‹ã®å‡¦ç† } go.sumãƒ•ã‚¡ã‚¤ãƒ« ãƒ»go.sumãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ PHPã«ãŠã‘ã‚‹composer.lockãƒ•ã‚¡ã‚¤ãƒ«ã«ç›¸å½“ã™ã‚‹ã€‚go.modãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã£ã¦å®Ÿéš›ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè‡ªå‹•çš„ã«å®Ÿè£…ã•ã‚Œã‚‹ã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã”ã¨ã®ãƒã‚§ãƒƒã‚¯ã‚µãƒ ãŒè¨˜éŒ²ã•ã‚Œã‚‹ãŸã‚ã€å‰å›ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã¨æ¯”è¼ƒã—ã¦ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«å¤‰æ›´ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œçŸ¥ã§ãã‚‹ã€‚ "},"public/software/software_application_procedural_language_go_framework_gin.html":{"url":"public/software/software_application_procedural_language_go_framework_gin.html","title":"ğŸ“– Gin","keywords":"","body":"Gin ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ Context Bind ãƒ»å‡¦ç† ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ§‹é€ ä½“ã«ç´ä»˜ã‘ã‚‹ã€‚Cotent-Typeãƒ˜ãƒƒãƒ€ãƒ¼ã®MIMEã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦ã€ãƒã‚¤ãƒ³ãƒ‰é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã—åˆ†ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/gin-gonic/gin?utm_source=godoc#Context.Bind BindJSON ãƒ»å‡¦ç† Content-Typeãƒ˜ãƒƒãƒ€ãƒ¼ã®MIMEã‚¿ã‚¤ãƒ—ãŒapplication/jsonã§ã‚ã‚‹ã“ã¨ãŒå‰æã§ã‚ã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰JSONãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ§‹é€ ä½“ã«ç´ä»˜ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/gin-gonic/gin?utm_source=godoc#Context.BindJSON BindQuery ãƒ»å‡¦ç† ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ§‹é€ ä½“ã«ç´ä»˜ã‘ã‚‹ã€‚ Get ãƒ»å‡¦ç† åŒä¸€ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¦Seté–¢æ•°ã§ã‚»ãƒƒãƒˆã•ã‚ŒãŸãƒãƒƒãƒ—å‹ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã§å€¤ã‚’å–å¾—ã™ã‚‹ã€‚å€¤ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€ç¬¬äºŒè¿”å´å€¤ã§falseã‚’è¿”å´ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/gin-gonic/gin#Context.Get ShouldBindQueryï¼ˆ= ShouldBindWithï¼‰ ãƒ»å‡¦ç† ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æŒ‡å®šã—ãŸãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã€æ§‹é€ ä½“ã«ç´ä»˜ã‘ã‚‹ã€‚ JSON ãƒ»å‡¦ç† JSONãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ç¬¬äºŒå¼•æ•°ã®å¼•æ•°å‹ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿å‹ã‚’æ¸¡ã›ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒãƒƒãƒ—å‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã€‚ c.JSON(200, gin.H{ \"id\": 1, \"name\": \"hiroki hasegawa\", }) æ§‹é€ ä½“å‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã€‚ type Foo struct { id int json:\"id\" name string json:\"name\" } c.JSON(200, &Foo{ id: 1, name: \"hiroki hasegawa\", }) MustGet ãƒ»å‡¦ç† åŒä¸€ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¦Seté–¢æ•°ã§ã‚»ãƒƒãƒˆã•ã‚ŒãŸãƒãƒƒãƒ—å‹ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã§å€¤ã‚’å–å¾—ã™ã‚‹ã€‚å€¤ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/gin-gonic/gin#Context.MustGet Param ãƒ»å‡¦ç† ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€‚ã“ã®å¾Œã€æ§‹é€ ä½“ã«ç´ä»˜ã‘ã‚‹å ´åˆã¯ã€BindQueryé–¢æ•°ã‚’ç”¨ã„ãŸæ–¹ãŒè‰¯ã„ã€‚ Set ãƒ»å‡¦ç† å½“è©²ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§åˆ©ç”¨ã§ãã‚‹ãƒãƒƒãƒ—å‹ãƒ‡ãƒ¼ã‚¿ã«ã€å€¤ã‚’ä¿å­˜ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://pkg.go.dev/github.com/gin-gonic/gin#Context.Set ãƒ»æ³¨æ„ç‚¹ ãƒ‡ãƒ¼ã‚¿å‹ã‚’å¤‰æ›ã—ãŸå€¤ã‚’Seté–¢æ•°ã§ä¿å­˜ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚Seté–¢æ•°å¾Œã«Geté–¢æ•°ã§å–å¾—ã•ã‚Œã‚‹å€¤ã¯ã€å…ƒã€…ã®ãƒ‡ãƒ¼ã‚¿å‹ã«é–¢ä¿‚ãªãã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã«å¤‰æ›ã•ã‚Œã¦ã—ã¾ã†ã€‚ãã®ãŸã‚ã€ä¾‹ãˆã°ã€ã‚¿ã‚¤ãƒ—IDå‹ã¨ã—ã¦å€¤ã‚’ä¿å­˜ã—ãŸã¨ã—ã¦ã‚‚ã€Geté–¢æ•°ã§å¾—ã‚‰ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ãƒ‡ãƒ¼ã‚¿ã‚’æ”¹ã‚ã¦å¤‰æ›ã—ãªã„ã¨ã„ã‘ãªããªã£ã¦ã—ã¾ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š package middlewares import ( \"strconv\" \"github.com/gin-gonic/gin\" ) // ConvertId ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®idã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å¤‰æ›ã—ã¾ã™ã€‚ func ConvertId() gin.HandlerFunc { return func(ctx *gin.Context) { id, err := strconv.Atoi(ctx.Param(\"id\")) if err != nil { _ = ctx.Error(err) return } ctx.Set(\"id\", id) ctx.Next() } } package controller type UserController struct { *interfaces.Controller userInteractor *interactor.UserInteractor } func (uc *UserController) GetUser(ctx *gin.Context) { // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ã«ãªã£ã¦ã—ã¾ã†ã€‚ userId, ok := ctx.Get(\"id\") if !ok { uc.SendErrorJson(ctx, 400, []string{\"Parameters are not found.\"}) return } Util H ãƒãƒƒãƒ—å‹ã®å¤‰æ•°ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã¨ã—ã¦åƒãã€‚ type H map[string]interface{} c.JSON(200, gin.H{ \"id\": 1, \"name\": \"hiroki hasegawa\", }) c.JSON(400, gin.H{ \"errors\": []string{ \"Fooã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\", \"Barã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\", } }) Validator tag ãƒ»binding ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚æ¨™æº–ã®ãƒ«ãƒ¼ãƒ«ã®ä¸€è¦§ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://github.com/go-playground/validator/blob/65bb1236771df9bc1630c78a43b0bfea10fe7122/baked_in.go#L70 "},"public/hardware/hardware.html":{"url":"public/hardware/hardware.html","title":"ğŸ“– ï¸ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢","keywords":"","body":"ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã¨ã¯ ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢è¦ç´  å‚è€ƒï¼šhttps://living-maou.com/computer-composition/ 02. CPUï¼šCentral Processing Unit CPUã¨ã¯ CPUã¯åˆ¶å¾¡è£…ç½®ã¨æ¼”ç®—è£…ç½®ã‹ã‚‰ãªã‚‹ã€‚CPUã®åˆ¶å¾¡éƒ¨åˆ†ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‘½ä»¤ã‚’è§£é‡ˆã—ã¦ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿å…¨ä½“ã‚’åˆ¶å¾¡ã€‚CPUã®æ¼”ç®—éƒ¨åˆ†ã¯ã€è¨ˆç®—ã‚„æ¼”ç®—å‡¦ç†ã‚’è¡Œã†ã€‚ç‰¹ã«ã€ã€ç®—è¡“è«–ç†æ¼”ç®—è£…ç½®ï¼ˆALUï¼šArithmetic and Logic Unitï¼‰ã€ã¨ã‚‚å‘¼ã¶ã€‚ CPUã®æ­´å²ï¼ˆâ€»2009å¹´ã¾ã§ï¼‰ Intelã¨AMDã«ãŠã‘ã‚‹CPUã®æ­´å²ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•° ãƒ»ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°ã¨ã¯ CPUã®å›è·¯ãŒå‡¦ç†ã¨æ­©èª¿ã‚’åˆã‚ã›ã‚‹ãŸã‚ã«ç”¨ã„ã‚‹ä¿¡å·ã‚’ã€ã€ã‚¯ãƒ­ãƒƒã‚¯ã€ã¨è¨€ã†ã€‚ä¸€å®šæ™‚é–“ã”ã¨ã«ã‚¯ãƒ­ãƒƒã‚¯ãŒèµ·ã“ã‚‹æ™‚ã€ï¼‘ç§’é–“ã«ã‚¯ãƒ­ãƒƒã‚¯ãŒä½•å›èµ·ã“ã‚‹ã‹ã‚’ã€ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°ã€ã¨ã„ã†ã€‚ã“ã‚Œã¯ã€Hzã§è¡¨ã•ã‚Œã‚‹ã€‚ã¡ãªã¿ã«ã€ãƒ¯ã‚¤ã®ãƒ‘ã‚½ã‚³ãƒ³ã®ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°ã¯2.60GHzã§ã—ãŸã€‚ ï¼ˆä¾‹1ï¼‰ 3Hz = 3 (ã‚¯ãƒ­ãƒƒã‚¯æ•°ï¼ç§’) ï¼ˆä¾‹2ï¼‰ 2.6GHz = 2.6Ã—10^9 (ã‚¯ãƒ­ãƒƒã‚¯æ•°ï¼ç§’) MIPSï¼šMillion Instructions Per Secondï¼ˆÃ—10^6 å‘½ä»¤æ•°ï¼ç§’ï¼‰ ãƒ»MIPSã¨ã¯ CPUãŒ1ç§’é–“ã«ä½•å›å‘½ä»¤ã‚’å®Ÿè¡Œã™ã‚‹ã‹ã‚’è¡¨ã™ã€‚ ï¼ˆä¾‹é¡Œï¼‰ (å‘½ä»¤å½“ãŸã‚Šã®å¹³å‡ã‚¯ãƒ­ãƒƒã‚¯æ•°) = (4Ã—0.3)ï¼‹(8Ã—0.6)ï¼‹(10Ã—0.1) = 7 (ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°) Ã· (ã‚¯ãƒ­ãƒƒã‚¯å½“ãŸã‚Šã®å‘½ä»¤æ•°) = 700Hz (Ã—10^6 ã‚¯ãƒ­ãƒƒã‚¯æ•°ï¼ç§’) Ã· 7 (ã‚¯ãƒ­ãƒƒã‚¯æ•°ï¼å‘½ä»¤) = 100 (Ã—10^6 å‘½ä»¤æ•°ï¼ç§’) 1å‘½ä»¤å½“ãŸã‚Šã®å®Ÿè¡Œæ™‚é–“ (ç§’ï¼å‘½ä»¤) ã®æ±‚ã‚æ–¹ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚ 1 Ã· 100 (Ã—10^6 å‘½ä»¤ï¼ç§’) = 10n (ç§’ï¼å‘½ä»¤) 03. ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªï¼ˆä¸»è¨˜æ†¶è£…ç½®ï¼‰ DRAMï¼šDynamic RAM ãƒ»DRAMã¨ã¯ ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã¨ã—ã¦ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ã‚ˆãè¦‹ã‚‹ã‚„ã¤ã€‚ Mask ROM ãƒ»Mask ROMã¨ã¯ Programmable ROM ãƒ»Programmable ROM ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒç¢ºä¿ã—ãŸãƒ¡ãƒ¢ãƒªé ˜åŸŸã®ã†ã¡ã€ä¸è¦ã«ãªã£ãŸé ˜åŸŸã‚’è‡ªå‹•çš„ã«è§£æ”¾ã™ã‚‹æ©Ÿèƒ½ã€‚ ãƒ»Javaã®å ´åˆ Javaã§ã¯ã€JVMï¼šJava Virtual Machineï¼ˆJavaä»®æƒ³ãƒã‚·ãƒ³ï¼‰ãŒã€ãƒ¡ãƒ¢ãƒªé ˜åŸŸã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è‡ªå‹•çš„ã«å‰²ã‚Šå½“ã¦ã€ã¾ãŸä¸€æ–¹ã§ã€ä¸è¦ã«ãªã£ãŸãƒ¡ãƒ¢ãƒªé ˜åŸŸã®è§£æ”¾ã‚’è¡Œã†ã€‚ä¸€æ–¹ã§è‡ªå‹•çš„ã«è¡Œã†ã€‚ 04. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒª ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã¨ã¯ ãƒ»ä¸€æ¬¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã¨äºŒæ¬¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒª CPUã¨ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã®é–“ã«ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ä½•æ®µéšã‹è¨­ç½®ã—ã€CPUã¨ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã®é–“ã®èª­ã¿è¾¼ã¿ã¨æ›¸ãå‡ºã—ã®å‡¦ç†é€Ÿåº¦ã®å·®ã‚’ç·©å’Œã•ã›ã‚‹ã€‚ å®Ÿéš›ã«ã€ã‚¿ã‚¹ã‚¯ãƒãƒãƒ¼ã‚¸ãƒ£ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¿ãƒ–ã§ã€næ¬¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªãŒã©ã®ãã‚‰ã„ä½¿ã‚ã‚Œã¦ã„ã‚‹ã®ã‹ã‚’ç¢ºèªã§ãã‚‹ã€‚ ãƒ»ä»•çµ„ã¿ ãƒ¦ãƒ¼ã‚¶ãƒ¼ â” ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒª â” äºŒæ¬¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒª â” ä¸€æ¬¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®é †ã§ã€ãƒ‡ãƒ¼ã‚¿ãŒã‚„ã‚Šå–ã‚Šã•ã‚Œã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ãƒ‘ã‚½ã‚³ãƒ³ã«å¯¾ã—ã¦å‘½ä»¤ã‚’ä¸ãˆã‚‹ã€‚ CPUã¯ã€å‘½ä»¤ã‚’ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã«æ›¸ãè¾¼ã‚€ã€‚ CPUã¯ã€ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã‹ã‚‰å‘½ä»¤ã‚’èª­ã¿å‡ºã™ã€‚ CPUã¯ã€äºŒæ¬¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã«æ›¸ãè¾¼ã‚€ã€‚ CPUã¯ã€ä¸€æ¬¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã«æ›¸ãè¾¼ã‚€ã€‚ CPUã¯ã€å‘½ä»¤ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã¸ã®æ›¸ãè¾¼ã¿æ–¹å¼ã®ç¨®é¡ ãƒ»Write-throughtæ–¹å¼ CPUã¯ã€å‘½ä»¤ã‚’ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®ä¸¡æ–¹ã«æ›¸ãè¾¼ã‚€ã€‚å¸¸ã«ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®å†…å®¹ãŒä¸€è‡´ã—ã¦ã„ã‚‹çŠ¶æ…‹ã‚’ç¢ºä¿ã§ãã‚‹ãŒã€ãƒ¡ãƒ¢ãƒªã¸ã®æ›¸ãè¾¼ã¿ãŒé »ç¹ã«è¡Œã‚ã‚Œã‚‹ã®ã§é…ã„ã€‚ ãƒ»Write-backæ–¹å¼ CPUã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®ã¿ã«æ›¸ãè¾¼ã‚€ã€‚æ¬¡ã«ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªãŒãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã«æ›¸ãè¾¼ã‚€ã€‚ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®å†…å®¹ãŒä¸€è‡´ã—ã¦ã„ã‚‹çŠ¶æ…‹ã‚’å¿…ãšã—ã‚‚ç¢ºä¿ã§ããªã„ãŒã€ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã¸ã®æ›¸ãè¾¼ã¿å›æ•°ãŒå°‘ãªã„ãŸã‚é€Ÿã„ å®ŸåŠ¹ã‚¢ã‚¯ã‚»ã‚¹æ™‚é–“ SRAMï¼šStatic RAM ãƒ»SRAMã¨ã¯ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã¨ã—ã¦ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ 05. ãƒ‡ã‚£ã‚¹ã‚¯ãƒ¡ãƒ¢ãƒª ãƒ‡ã‚£ã‚¹ã‚¯ãƒ¡ãƒ¢ãƒªã¨ã¯ ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®é–“ã«è¨­ç½®ã•ã‚Œã‚‹ã€‚èª­ã¿è¾¼ã¿ã¨æ›¸ãå‡ºã—ã®å‡¦ç†é€Ÿåº¦ã®å·®ã‚’ç·©å’Œã•ã›ã‚‹ã€‚ 06. è£œåŠ©è¨˜æ†¶è£…ç½® 06-02. SSD 06-03. HDDï¼šHard Disk Drive ãƒ‡ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ æ–­ç‰‡åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿é ˜åŸŸã‚’æ•´ç†æ•´é “ã™ã‚‹ã€‚ RAIDï¼šRedundant Arrays of Inexpensive Disks è¤‡æ•°ã®HDDã‚’ä»®æƒ³çš„ã«ä¸€ã¤ã®HDDã§ã‚ã‚‹ã‹ã®ã‚ˆã†ã«ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹æŠ€è¡“ã€‚ ãƒ»RAID0ï¼ˆStripingï¼‰ ãƒ‡ãƒ¼ã‚¿ã‚’ã€è¤‡æ•°ã®HDDã«åˆ†å‰²ã—ã¦æ›¸ãè¾¼ã‚€ã€‚ ãƒ»RAID1ï¼ˆMirroringï¼‰ ãƒ‡ãƒ¼ã‚¿ã‚’ã€è¤‡æ•°ã®HDDã«åŒã˜ã‚ˆã†ã«æ›¸ãè¾¼ã‚€ã€‚ ãƒ»RAID5ï¼ˆStriping with parityï¼‰ ãƒ‡ãƒ¼ã‚¿ã¨ãƒ‘ãƒªãƒ†ã‚£ï¼ˆèª¤ã‚Šè¨‚æ­£ç¬¦å·ï¼‰ã‚’ã€3ã¤ä»¥ä¸Šã®HDDã«æ›¸ãè¾¼ã‚€ã€‚ 07. GPUã¨VRAM GPUã¨VRAMã®å®¹é‡ã«ã‚ˆã£ã¦ã€æ‰±ã†ã“ã¨ã®ã§ãã‚‹è§£åƒåº¦ã¨è‰²æ•°ãŒæ±ºã¾ã‚‹ã€‚ å¯Œå£«é€šPCã®GPUã¨VRAMã®å®¹é‡ã¯ã€ä»¥ä¸‹ã®é€šã‚Šã€‚ è‰²æ•°ã«ã‚ˆã£ã¦ã€ï¼‘ãƒ‰ãƒƒãƒˆå½“ãŸã‚Šä½•ãƒ“ãƒƒãƒˆã‚’è¦ã™ã‚‹ãŒç•°ãªã‚‹ã€‚ "},"public/hardware/hardware_memory_address_space_management.html":{"url":"public/hardware/hardware_memory_address_space_management.html","title":"ğŸ“– ï¸ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç†","keywords":"","body":"ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç† ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç†ã®ç¨®é¡ å‰ç½®ã è¨€è‘‰ã®ä½¿ã„æ–¹ã‚’ã€ä»¥ä¸‹ã«çµ±ä¸€ã™ã‚‹ã€‚ ä¸»è¨˜æ†¶ â‡’ ç‰©ç†ãƒ¡ãƒ¢ãƒªï¼ˆãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªï¼‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªï¼‰ è£œåŠ©è¨˜æ†¶ â‡’ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ ä»®æƒ³è¨˜æ†¶ â‡’ ä»®æƒ³ãƒ¡ãƒ¢ãƒª ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç† ãƒ»åŒºç”»æ–¹å¼ å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ãƒ»ã‚¹ãƒ¯ãƒƒãƒ”ãƒ³ã‚°æ–¹å¼ å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤æ–¹å¼ å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç† ãƒ»ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ–¹å¼ å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ 01-02. ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç† å›ºå®šåŒºç”»æ–¹å¼ï¼ˆåŒã˜å¤§ãã•ã®åŒºç”»ã«åˆ†å‰²ã™ã‚‹æ–¹å¼ï¼‰ ãƒ»å˜ä¸€åŒºç”»æ–¹å¼ã¨ã¯ ç‰©ç†ãƒ¡ãƒ¢ãƒªã®é ˜åŸŸã‚’ã€ä¸€ã¤ã®åŒºç”»ã¨ã—ã¦æ‰±ã„ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å‰²ã‚Šå½“ã¦ã‚‹æ–¹å¼ã€‚å˜ä¸€ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã—ã‹èª­ã¿è¾¼ã‚ãšã€ä½™ã‚Šã®ãƒ¡ãƒ¢ãƒªé ˜åŸŸã¯åˆ©ç”¨ã§ããªã„ã€‚ ãƒ»å¤šé‡åŒºç”»æ–¹å¼ã¨ã¯ ç‰©ç†ãƒ¡ãƒ¢ãƒªã®é ˜åŸŸã‚’ã€è¤‡æ•°ã®åŒã˜å¤§ãã•ã®åŒºç”»ã«åˆ†å‰²ã—ã€å„åŒºç”»ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å‰²ã‚Šå½“ã¦ã‚‹æ–¹å¼ã€‚è¤‡æ•°ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’èª­ã¿è¾¼ã‚ã‚‹ãŒã€å˜ä¸€åŒºç”»æ–¹å¼ã¨åŒæ§˜ã«ã€ä½™ã£ãŸãƒ¡ãƒ¢ãƒªé ˜åŸŸã¯åˆ©ç”¨ã§ããªã„ã€‚ å¯å¤‰åŒºç”»æ–¹å¼ï¼ˆæ§˜ã€…ãªå¤§ãã•ã®åŒºç”»ã«åˆ†å‰²ã™ã‚‹æ–¹å¼ï¼‰ ãƒ»å¯å¤‰åŒºç”»æ–¹å¼ã¨ã¯ ç‰©ç†ãƒ¡ãƒ¢ãƒªã®é ˜åŸŸã‚’ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å¤§ãã•ã«å¿œã˜ã¦ã€åŒºç”»ã‚’æ§˜ã€…ãªå¤§ãã•ã®åŒºç”»ã«åˆ†å‰²ã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å‰²ã‚Šå½“ã¦ã‚‹æ–¹å¼ã€‚å›ºå®šåŒºç”»æ–¹å¼ã¨ã¯ç•°ãªã‚Šã€ãƒ¡ãƒ¢ãƒªé ˜åŸŸã‚’æœ‰åŠ¹ã«åˆ©ç”¨ã§ãã‚‹ã€‚ ã‚¹ãƒ¯ãƒƒãƒ”ãƒ³ã‚°æ–¹å¼ ãƒ»ã‚¹ãƒ¯ãƒƒãƒ”ãƒ³ã‚°æ–¹å¼ã¨ã¯ ç‰©ç†ãƒ¡ãƒ¢ãƒªã®é ˜åŸŸã‚’ã€å„ªå…ˆåº¦ã®é«˜ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å‰²ã‚Šå½“ã¦ã€åå¯¾ã«å„ªå…ˆåº¦ãŒä½ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«é€€é¿ã•ã›ã‚‹æ–¹å¼ã€‚ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤æ–¹å¼ ãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤æ–¹å¼ã¨ã¯ GCï¼šã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ç¢ºä¿ã•ã‚ŒãŸç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã†ã¡ã€è§£æ”¾å¯èƒ½ãªãƒ¡ãƒ¢ãƒªã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰è§£æ”¾ã™ã‚‹ã€‚ç‰©ç†ãƒ¡ãƒ¢ãƒªã‚’ç”¨ã„ã¦ã„ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½•ã‹ã—ã‚‰ã‹ã‚‰å‚ç…§ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’å…ƒã«ã€è§£æ”¾ã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ã€‚ ãƒ»ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯æ§˜ã€…ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã‚ã‚Šã€æ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯è¨€èªã”ã¨ã«ç•°ãªã‚‹ã€‚Goã®ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_procedural_language_go_logic.html 01-03. ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç† ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ–¹å¼ ãƒ»ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ–¹å¼ã¨ã¯ ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®å®Ÿè£…æ–¹æ³•ã®ä¸€ã¤ã€‚ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’ã€å›ºå®šé•·ã€ã®é ˜åŸŸï¼ˆãƒšãƒ¼ã‚¸ï¼‰ã€ã¾ãŸç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’ã€å›ºå®šé•·ã€ã®é ˜åŸŸï¼ˆãƒšãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰ã«åˆ†å‰²ã—ã€ç®¡ç†ã™ã‚‹æ–¹å¼ã€‚ ãƒ»ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ï¼ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆ ä»®æƒ³ãƒ¡ãƒ¢ãƒªã¯ã€CPUã®å‡¦ç†ã«ã‚ˆã£ã¦ç¨¼åƒã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è¦æ±‚ã‚’ã€ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ä»£ç†ã¨ã—ã¦å—ã‘ä»˜ã‘ã‚‹ã€‚ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ãƒšãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ ã«ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã‚’ã€Page-inã€ã¨ã„ã†ã€‚ã¾ãŸã€ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ãƒšãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ ã‹ã‚‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ãƒšãƒ¼ã‚¸ã‚’è¿½ã„å‡ºã™ã“ã¨ã‚’ã€Page-outã€ã¨ã„ã†ã€‚ ãƒ»ä»®æƒ³ãƒ¡ãƒ¢ãƒªã¨ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã«ã‚ˆã‚‹å¤§å®¹é‡ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã®å®Ÿç¾ ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’ã€ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’ç–‘ä¼¼çš„ã«å¤§ããè¦‹ã›ã‹ã‘ã‚‰ã‚Œã‚‹ã€‚ ã¡ãªã¿ã«ã€å¯Œå£«é€šã®ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®å®¹é‡ã¯ã€ä»¥ä¸‹ã®é€šã‚Šã€‚ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ–¹å¼ ãƒ»ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ–¹å¼ã¨ã¯ ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®å®Ÿè£…æ–¹æ³•ã®ä¸€ã¤ã€‚ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’ã€å¯å¤‰é•·ã€ã®é ˜åŸŸï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰ã€ã¾ãŸç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’ã€å¯å¤‰é•·ã€ã®é ˜åŸŸï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰ã«åˆ†å‰²ã—ã€ç®¡ç†ã™ã‚‹æ–¹å¼ã€‚ MMUï¼šMemory Management Unitï¼ˆãƒ¡ãƒ¢ãƒªç®¡ç†ãƒ¦ãƒ‹ãƒƒãƒˆï¼‰ ãƒ»MMUã«ãŠã‘ã‚‹å‹•çš„ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›æ©Ÿæ§‹ MMUã«ã‚ˆã£ã¦ã€ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã€ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ã“ã®ä»•çµ„ã¿ã‚’ã€ã€å‹•çš„ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›æ©Ÿæ§‹ã€ã¨å‘¼ã¶ã€‚ ãƒ»ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã®ä»•çµ„ã¿ï¼ˆãƒšãƒ¼ã‚¸ãƒ³ã‚°æ–¹å¼å‹ï¼ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ–¹å¼å‹ï¼‰ ä»®æƒ³ãƒ¡ãƒ¢ãƒªã«ãŠã‘ã‚‹ãƒšãƒ¼ã‚¸ã®ä»®æƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ãƒšãƒ¼ã‚¸ç•ªå·ã¨ãƒšãƒ¼ã‚¸ã‚ªãƒ•ã‚»ãƒƒãƒˆã«åˆ†å‰²ã™ã‚‹ã€‚ ãƒšãƒ¼ã‚¸ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”¨ã„ã¦ã€ä»®æƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒšãƒ¼ã‚¸ç•ªå·ã«å¯¾å¿œã™ã‚‹ç‰©ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒšãƒ¼ã‚¸ç•ªå·ã‚’æ¢ã™ã€‚ ç‰©ç†ãƒšãƒ¼ã‚¸ç•ªå·ã«ãƒšãƒ¼ã‚¸ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’å†çµåˆã—ã€ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ãƒšãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ ã®ç‰©ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã™ã‚‹ã€‚ ãƒ»ãƒšãƒ¼ã‚¸ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹ä»®æƒ³ãƒšãƒ¼ã‚¸ç•ªå·ã¨ç‰©ç†ãƒšãƒ¼ã‚¸ç•ªå·ã®å¯¾å¿œã¥ã‘ 02. ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã®ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆ ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆã¨ã¯ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã¸ã®å‰²ã‚Šè¾¼ã¿å‡¦ç†ã®ã“ã¨ã€‚CPUã«ã‚ˆã£ã¦ç¨¼åƒã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒã€ä»®æƒ³ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãã®ãƒšãƒ¼ã‚¸ãŒç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ãªã‹ã£ãŸå ´åˆã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã«ã€ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ã€ãŒèµ·ã“ã‚‹ã€‚ Page Replacementã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ã“ã¨ã€‚æ–¹å¼ã”ã¨ã«ã€ç‰©ç†ãƒ¡ãƒ¢ãƒªã®ãƒšãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ ã‹ã‚‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã™ã‚‹ãƒšãƒ¼ã‚¸ãŒç•°ãªã‚‹ã€‚ ãƒ»ã€FIFOæ–¹å¼ï¼šFirst In First Outã€ã¨ã€LIFOæ–¹å¼ï¼šLast In First Outã€ ãƒ»ã€LRUæ–¹å¼ï¼šLeast Recently Usedã€ã¨ã€LFUæ–¹å¼ï¼šLeast Frequently Usedã€ 03. ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ç®¡ç†ã«ãŠã‘ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç¨®é¡ Reusableï¼ˆå†ä½¿ç”¨å¯èƒ½ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ ä¸€åº¦å®Ÿè¡Œã™ã‚Œã°ã€å†åº¦ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ç‰©ç†ãƒ¡ãƒ¢ãƒªã«ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ã‚’è¡Œã‚ãšã«ã€å®Ÿè¡Œã‚’ç¹°ã‚Šè¿”ã›ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ Reentrantï¼ˆå†å…¥å¯èƒ½ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ å†ä½¿ç”¨å¯èƒ½ã®æ€§è³ªã‚’ã‚‚ã¡ã€ã¾ãŸè¤‡æ•°ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã¦ã‚‚ã€äº’ã„ã®å‘¼ã³å‡ºã—ãŒå¹²æ¸‰ã›ãšã€åŒæ™‚ã«å®Ÿè¡Œã§ãã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ Relocatableï¼ˆå†é…ç½®å¯èƒ½ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ç‰©ç†ãƒ¡ãƒ¢ãƒªã«ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ã‚’è¡Œã†æ™‚ã«ã€ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ä¸Šã®ã©ã“ã«é…ç½®ã•ã‚Œã¦ã‚‚å®Ÿè¡Œã§ãã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ 04. ãƒ—ãƒ­ã‚»ã‚¹ ãƒ—ãƒ­ã‚»ã‚¹ã¨ã¯ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€ãƒ¡ãƒ¢ãƒªä¸Šã®ç‰¹å®šã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ è‡ªä½“ã‚’ã€ãƒ—ãƒ­ã‚»ã‚¹ã€ã¨ã„ã†ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã®ä»£ã‚ã‚Šã«ã€ã‚¿ã‚¹ã‚¯ã€ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚‹ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯CPUã«å‚ç…§ã•ã‚Œã€CPUã®ã‚³ã‚¢ä¸Šã§å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã‚·ãƒ³ã‚°ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã¨ãƒãƒ«ãƒãƒ—ãƒ­ã‚»ã‚¹ãŒã‚ã‚Šã€ç¾ä»£ã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®ã»ã¨ã‚“ã©ãŒãƒãƒ«ãƒãƒ—ãƒ­ã‚»ã‚¹ã®æ©Ÿèƒ½ã‚’æŒã¤ã€‚ å‚è€ƒï¼š https://jpazamu.com/thread_process/#index_id5 http://staff.miyakyo-u.ac.jp/~m-yasu/curri-ex/os/txt/os5.html ãƒ—ãƒ­ã‚»ã‚·ãƒ³ã‚°ã®ç¨®é¡ ãƒ»ã‚·ãƒ³ã‚°ãƒ«ãƒ—ãƒ­ã‚»ã‚·ãƒ³ã‚° å˜ä¸€ã®ãƒ¡ãƒ¢ãƒªä¸Šã«ãŠã„ã¦ã€å˜ä¸€ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã‚¢ãƒ‰ãƒ¬ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ä»•çµ„ã¿ã®ã“ã¨ã€‚ ãƒ»ãƒãƒ«ãƒãƒ—ãƒ­ã‚»ã‚·ãƒ³ã‚° å˜ä¸€ã®ãƒ¡ãƒ¢ãƒªä¸Šã«ãŠã„ã¦ã€è¤‡æ•°ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã‚¢ãƒ‰ãƒ¬ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ä»•çµ„ã¿ã®ã“ã¨ã€‚å„ªå…ˆåº¦ã®ä½ã„ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰CPUã‚’åˆ‡ã‚Šé›¢ã—ã€å„ªå…ˆåº¦ã®é«˜ã„ãƒ—ãƒ­ã‚»ã‚¹ã«CPUã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€ã¨ã„ã£ãŸä»•çµ„ã¿ã‚’æŒã¤ã€‚ å‚è€ƒï¼šhttps://linuxjf.osdn.jp/JFdocs/The-Linux-Kernel-5.html 04-02. ã‚¹ãƒ¬ãƒƒãƒ‰ ã‚¹ãƒ¬ãƒƒãƒ‰ã¨ã¯ ãƒ¡ãƒ¢ãƒªä¸Šã§ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ãŠã‚Šã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯CPUã®ã‚³ã‚¢ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ã€‚CPUã®ã‚³ã‚¢ã¨ç´ä»˜ããƒ—ãƒ­ã‚»ã‚¹ã®å®Ÿè¡Œå˜ä½ã‚’ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã€ã¨ã„ã†ã€‚ å‚è€ƒï¼šhttps://atmarkit.itmedia.co.jp/ait/articles/0503/12/news025.html ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ã®ç¨®é¡ ãƒ»ã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚° ãƒ¡ãƒ¢ãƒªä¸Šã®ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã«ãŠã„ã¦ã€å˜ä¸€ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ä»•çµ„ã¿ã®ã“ã¨ã€‚ ãƒ»ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚° ãƒ¡ãƒ¢ãƒªä¸Šã®ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã«ãŠã„ã¦ã€è¤‡æ•°ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ä»•çµ„ã¿ã®ã“ã¨ã€‚å„ã‚¹ãƒ¬ãƒƒãƒ‰ãŒãƒ—ãƒ­ã‚»ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…±æœ‰ã—ã¦ä½¿ã†ã€‚ ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ã«ã¤ã„ã¦ ãƒ»é€šå¸¸ã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ CPUã®ã‚³ã‚¢ãŒå˜ä¸€ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒç´ä»˜ãã‚ˆã†ãªãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://milestone-of-se.nesuke.com/sv-basic/architecture/hyper-threading-smt/ ãƒ»åŒæ™‚ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ CPUã®ã‚³ã‚¢ãŒè¤‡æ•°ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒç´ä»˜ãã‚ˆã†ãªãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://milestone-of-se.nesuke.com/sv-basic/architecture/hyper-threading-smt/ "},"public/hardware/hardware_embedded_system.html":{"url":"public/hardware/hardware_embedded_system.html","title":"ğŸ“– ï¸çµ„ã¿è¾¼ã¿æ©Ÿå™¨","keywords":"","body":"çµ„ã¿è¾¼ã¿æ©Ÿå™¨ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. çµ„ã¿è¾¼ã¿æ©Ÿå™¨ çµ„ã¿è¾¼ã¿ã‚·ã‚¹ãƒ†ãƒ ã¨ã¯ çµ„ã¿è¾¼ã¿æ©Ÿå™¨ï¼ˆé™å®šçš„ãªç”¨é€”å‘ã‘ã«ç‰¹å®šã®æ©Ÿèƒ½ã‚’æœãŸã™äº‹ã‚’ç›®çš„ã¨ã—ãŸæ©Ÿå™¨ï¼‰ã‚’åˆ¶å¾¡ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®ã“ã¨ã€‚ â€»ãƒ‘ã‚½ã‚³ãƒ³ã¯ã€æ±ç”¨æ©Ÿå™¨ï¼ˆæ±ç”¨çš„ãªç”¨é€”å‘ã‘ã«å¤šæ§˜ãªæ©Ÿèƒ½ã‚’æœãŸã™äº‹ã‚’ç›®çš„ã¨ã—ãŸæ©Ÿå™¨ï¼‰ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚ ãƒã‚¤ã‚¯ãƒ­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã¨ã¯ CPUã¨ã—ã¦ã€ã€ãƒã‚¤ã‚¯ãƒ­ãƒ—ãƒ­ã‚»ãƒƒã‚µã€ã‚’ç”¨ã„ãŸã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®ã“ã¨ã€‚ ã‚»ãƒ³ã‚µã«ã‚ˆã‚‹ã‚¢ãƒŠãƒ­ã‚°æƒ…å ±ã®å…¥åŠ› å¤–éƒ¨ã®ã‚¢ãƒŠãƒ­ã‚°æƒ…å ±ã‚’è¨ˆæ¸¬ã—ã€ãƒã‚¤ã‚³ãƒ³ã«è»¢é€ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Šï¼šæ¸©åº¦ã‚»ãƒ³ã‚µã€åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µã€ç…§åº¦ã‚»ãƒ³ã‚µã€â€¦ A/Då¤‰æ›å™¨ã«ã‚ˆã‚‹ã‚¢ãƒŠãƒ­ã‚°æƒ…å ±ã‹ã‚‰ãƒ‡ã‚¸ã‚¿ãƒ«æƒ…å ±ã¸ã®å¤‰æ› D/Aå¤‰æ›å™¨ã«ã‚ˆã‚‹ãƒ‡ã‚¸ã‚¿ãƒ«æƒ…å ±ã‹ã‚‰ã‚¢ãƒŠãƒ­ã‚°æƒ…å ±ã¸ã®å¤‰æ› Actuater å…¥åŠ›ã•ã‚ŒãŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚‚ã—ãã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãŒå‡ºåŠ›ã—ãŸé›»æ°—ä¿¡å·ã‚’ç‰©ç†çš„é‹å‹•ã«å¤‰æ›ã™ã‚‹è£…ç½®ã®ã“ã¨ã€‚ çµ„ã¿è¾¼ã¿ã‚·ã‚¹ãƒ†ãƒ ã®åˆ¶å¾¡æ–¹å¼ã®ç¨®é¡ ãƒ»ã‚·ãƒ¼ã‚±ãƒ³ã‚¹åˆ¶å¾¡ æ±ºã‚ã‚‰ã‚ŒãŸé †åºã‚„æ¡ä»¶ã«å¾“ã£ã¦ã€åˆ¶å¾¡ã®å„æ®µéšã‚’é€²ã‚ã¦ã„ãåˆ¶å¾¡æ–¹å¼ã€‚ ï¼Šä¾‹ï¼Š æ´—æ¿¯æ©Ÿ ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ ãã®æ™‚ã®çŠ¶æ³ã‚’å®šæœŸçš„ã«è¨ˆæ¸¬ã—ã€ç›®æ¨™å€¤ã¨ã®å·®åˆ†ã‚’åŸºã«ã€å‡ºåŠ›ã‚’èª¿ç¯€ã™ã‚‹åˆ¶å¾¡æ–¹å¼ã€‚ ï¼Šä¾‹ï¼Š ã‚¨ã‚¢ã‚³ãƒ³ 02. å…¥å‡ºåŠ›æ©Ÿå™¨ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‹ã‚‰ãƒã‚¤ãƒ³ãƒ†ã‚£ãƒ³ã‚°ãƒ‡ãƒã‚¤ã‚¹ ãƒ»ã‚¸ãƒ§ã‚¤ã‚¹ãƒ†ã‚£ãƒƒã‚¯ èª­ã¿å–ã‚Šæ©Ÿå™¨ ãƒ»ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒŠ ãƒ»Optical Character Reader ç´™ä¸Šã®æ–‡å­—ã‚’æ–‡å­—ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦èª­ã¿å–ã‚‹æ©Ÿå™¨ã€‚ ãƒ»Optical Mark Reader ãƒãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã®å¡—ã‚Šæ½°ã—ä½ç½®ã‚’èª­ã¿å–ã‚‹æ©Ÿå™¨ã€‚ ãƒ»ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚«ãƒ¼ãƒ‰ ãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«ã‚«ãƒ¡ãƒ© ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ ãƒ»CRTãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ ãƒ»æ¶²æ™¶ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ é›»åœ§ã®æœ‰ç„¡ã«ã‚ˆã£ã¦æ¶²æ™¶åˆ†å­ã‚’åˆ¶å¾¡ã€‚å¤–éƒ¨ã‹ã‚‰ã®å…‰ã«ã‚ˆã£ã¦ç”»é¢ã‚’è¡¨ç¤ºã•ã›ã‚‹ã€‚ ãƒ»æœ‰æ©ŸELãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ æœ‰æ©ŸåŒ–åˆç‰©ã«é›»åœ§ã‚’åŠ ãˆã‚‹ã“ã¨ã«ã‚ˆã£ã¦ç™ºå…‰ã•ã›ã€ç”»é¢ã‚’è¡¨ç¤ºã•ã›ã‚‹ã€‚ ãƒ»ãƒ—ãƒ©ã‚ºãƒãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ 2æšã®ã‚¬ãƒ©ã‚¹ã®é–“ã«ã€å°å…¥ã•ã‚ŒãŸå¸Œã‚¬ã‚¹ã«é›»åœ§ã‚’ã‹ã‘ã‚‹ã¨æ”¾é›»ã—ã€ç´«å¤–ç·šãŒå‡ºã‚‹ã€‚ãã—ã¦ã€ã“ã®ç´«å¤–ç·šãŒè›å…‰ä½“ã‚’ç™ºå…‰ã•ã›ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ æ¶²æ™¶ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã¨ã®ã‚·ã‚§ã‚¢å·®ãŒå¤§ãããªã‚Šã€2014å¹´ã«ä¸–ç•Œçš„ã«ç”Ÿç”£ãŒçµ‚äº†ã•ã‚ŒãŸã€‚ ãƒ»LEDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ 2018å¹´1æœˆã«é–‹å‚¬ã•ã‚ŒãŸã€CES 2018ã€ã§ã‚µãƒ ã‚¹ãƒ³ãŒç™ºè¡¨ã—ãŸâ€œãƒã‚¤ã‚¯ãƒ­LEDãƒ†ãƒ¬ãƒ“â€ã€The Wallã€ã¯ã€å¾“æ¥ã®ã€æ¶²æ™¶ã€ã‚„ã€æœ‰æ©ŸELã€ã¨ã¯ç•°ãªã‚‹æ–°ãŸãªè¡¨ç¤ºæ–¹å¼ã‚’æ¡ç”¨ã—ãŸãƒ†ãƒ¬ãƒ“ã¨ã—ã¦ã€å¤§ããªè©±é¡Œã¨ãªã£ãŸã€‚ ãƒ—ãƒªãƒ³ã‚¿ ãƒ»ãƒ‰ãƒƒãƒˆã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆãƒ—ãƒªãƒ³ã‚¿ ãƒ»ã‚¤ãƒ³ã‚¯ã‚¸ã‚§ãƒƒãƒˆãƒ—ãƒªãƒ³ã‚¿ ãƒ»ãƒ¬ãƒ¼ã‚¶ãƒ—ãƒªãƒ³ã‚¿ ãƒ»ãƒ—ãƒªãƒ³ã‚¿ã®è§£åƒåº¦ ï¼‘ã‚¤ãƒ³ãƒå½“ãŸã‚Šã®ãƒ‰ãƒƒãƒˆæ•°ï¼ˆdpiï¼‰ã«ã‚ˆã£ã¦ã€è§£åƒåº¦ãŒç•°ãªã‚‹ã€‚å¾©ç¿’ã§ã¯ã‚ã‚‹ãŒã€PCä¸Šã§ã¯ã€ãƒ‰ãƒƒãƒˆæ•°ãŒã©ã®ãã‚‰ã„ã®ãƒ“ãƒƒãƒˆæ•°ã‚’æŒã¤ã‹ã§ã€è§£åƒåº¦ãŒå¤‰ã‚ã‚‹ã€‚ dpiãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ã€è§£åƒåº¦ã¯å¤§ãããªã‚‹ã€‚ ãƒ»ãƒ—ãƒªãƒ³ã‚¿ã®å°å­—é€Ÿåº¦ 02-02. å…¥å‡ºåŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ Serial interface vs. Parallel interface ã‚·ãƒªã‚¢ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¯ã€æƒ…å ±ã‚’1bitãšã¤è»¢é€ã™ã‚‹æ–¹å¼ã€‚ãƒ‘ãƒ©ãƒ¬ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¯ã€è¤‡æ•°ã®bitã®æƒ…å ±ã‚’åŒæ™‚ã«è»¢é€ã™ã‚‹æ–¹å¼ã€‚ãƒ‘ãƒ©ãƒ¬ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¯ã€åŒæ™‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã€åŒæ™‚ã«å—ä¿¡ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚é…ç·šã®å½¢çŠ¶ã‚„é•·ã•ã«ã‚ˆã£ã¦ã€ä¿¡å·ã®è»¢é€æ™‚é–“ã¯ç•°ãªã‚‹ã€‚å‹•ä½œã‚¯ãƒ­ãƒƒã‚¯ãŒé€Ÿã‘ã‚Œã°é€Ÿã„ã»ã©ã€é…ç·šé–“ã®åŒæ™‚è»¢é€ã«èª¤å·®ãŒç”Ÿã˜ã¦ã—ã¾ã†ãŸã‚ã€ç¾ä»£ã®é«˜ã‚¹ãƒšãƒƒã‚¯ãƒ‘ã‚½ã‚³ãƒ³ã«ã¯å‘ã„ã¦ã„ãªã„ã€‚ Serial interface ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ä¾‹ ãƒ»USBï¼ˆUniversal Serial Busï¼‰ ãƒ»IEEE1394 ãƒ“ãƒ‡ã‚ªã‚«ãƒ¡ãƒ©ã¨ã®æ¥ç¶šã«ç”¨ã„ã‚‰ã‚Œã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ Parallel interface ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ä¾‹ ãƒ»IDEï¼ˆIntegrated Drive Electronicsï¼‰ ãƒãƒ¼ãƒ‰ãƒ‡ã‚£ã‚¹ã‚¯ã¨ã®æ¥ç¶šã«ç”¨ã„ã‚‰ã‚Œã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã€‚ ãƒ»SCSIï¼ˆSmall Computer System Interfaceï¼‰ ãƒãƒ¼ãƒ‰ãƒ‡ã‚£ã‚¹ã‚¯ã€CD-ROMã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒŠãªã©ã€æ§˜ã€…ãªå‘¨è¾ºæ©Ÿå™¨ã‚’ãƒ‡ã‚¤ã‚¸ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã€‚ ç„¡ç·šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ ãƒ»IrDAï¼ˆinfrared Data Assoiciationï¼‰ èµ¤å¤–ç·šã‚’ä½¿ã£ã¦ã€ç„¡ç·šé€šä¿¡ã‚’è¡Œã†ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã€‚ ãƒ»Bluetooth 2.4GHzã®é›»æ³¢ã‚’ä½¿ã£ã¦ç„¡ç·šé€šä¿¡ã‚’è¡Œã†ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã€‚ "},"public/network/network.html":{"url":"public/network/network.html","title":"ğŸ“– ï¸ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯","keywords":"","body":"ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å…¨ä½“åƒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã€WANã€LAN ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã¯ã€ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã€ã€WANã€ã€LANã€ãŒã‚ã‚‹ã€‚å®¶åº­å†…LANã€å­¦å†…LANã€ä¼æ¥­å†…LANã€ä¼æ¥­WANãªã©ã€ã•ã¾ã–ã¾ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ã‚Šã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯ã€ãã‚Œãã‚Œã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’äº’ã„ã«æ¥ç¶šã—ã¦ã„ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚‹ã€‚ WANã€LANã®ä¾‹ ä¾‹ãˆã°ã€LANã¨ã—ã¦Ethernetã€WANã¨ã—ã¦ãƒ‡ã‚¸ã‚¿ãƒ«å°‚ç”¨ç·šã‚’ç”¨ã„ã‚‹ã€‚ WANã®ç¨®é¡ã¨æ­´å² ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ãƒ«ãƒ¼ã‚¿ã‚’å¢ƒã«ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚ã‚„ã‚„ã“ã—ã„ãŒã€ãƒ«ãƒ¼ã‚¿ã«ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ 02. ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ãƒ‡ãƒ¼ã‚¿é€ä¿¡ ãƒ‡ãƒ¼ã‚¿é€šä¿¡æ–¹æ³•ã®ç¨®é¡ ãƒ»å›ç·šäº¤æ›æ–¹å¼ å°‘æ•°å¯¾å°‘æ•°ã§ãƒ‡ãƒ¼ã‚¿é€šä¿¡ã‚’è¡Œã†ãŸã‚ã€é€ä¿¡æ™‚ã«ã€é€ä¿¡è€…ã¨å—ä¿¡è€…ã®å®›å…ˆæƒ…å ±ã¯å¿…è¦ãªã„ã€‚ ãƒ»ãƒ‘ã‚±ãƒƒãƒˆäº¤æ›æ–¹å¼ é€šä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‘ã‚±ãƒƒãƒˆåŒ–ã™ã‚‹ã€‚å¤šæ•°å¯¾å¤šæ•°ã§ãƒ‡ãƒ¼ã‚¿é€šä¿¡ã‚’è¡Œã†ãŸã‚ã€é€ä¿¡æ™‚ã«ã€é€ä¿¡è€…ã¨å—ä¿¡è€…ã®å®›å…ˆæƒ…å ±ãŒå¿…è¦ã«ãªã‚‹ã€‚ URLã¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ ãƒ»æ§‹é€  URLã¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’æŒã¤ã€‚ ã¾ãŸã€å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³åã®å­é–¢ä¿‚ã«ã‚ã‚‹ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’æŒã¦ã‚‹ã€‚ãƒ›ã‚¹ãƒˆåï¼ˆä»¥ä¸‹ã§ã¯çœç•¥ã•ã‚Œã¦ã„ã‚‹ï¼‰ã¨ã€ãƒ‰ãƒ¡ã‚¤ãƒ³åã®é–“ã«ã¤ã‘ã‚‹ã€‚ ãƒ»å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã«ã‚ˆã‚‹ã‚µãƒ¼ãƒæŒ‡å®š å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã¯ã€æ‰€å±ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æŒ‡ã™ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨ã€ãã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ãŠã‘ã‚‹å…·ä½“çš„ãªã‚µãƒ¼ãƒã‚’æŒ‡ã™ãƒ›ã‚¹ãƒˆåã‹ã‚‰ãªã‚‹ã€‚ãŸã ã—ã€ã‚µãƒ¼ãƒã®ãƒ›ã‚¹ãƒˆåãŒã€wwwã€ã§ã‚ã‚‹å ´åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯URLã®æŒ‡å®šæ™‚ã«ãƒ›ã‚¹ãƒˆåã‚’çœç•¥ã§ãã‚‹ã€‚ä¾‹ãˆã°ã€ã€www.example.co.jpã€ã¨ã„ã†å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’URLã§æŒ‡å®šã™ã‚‹å ´åˆã€ã€example.co.jpã€ã¨ã—ã¦ã‚‚ã‚ˆã„ã€‚ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ ãƒ»ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ç¨®é¡ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€å¤–éƒ¨å…¬é–‹ç”¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€éæ­¦è£…åœ°å¸¯ã€å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚ ãƒ»éæ­¦è£…åœ°å¸¯ã®ã‚µãƒ¼ãƒã®ç¨®é¡ æ”»æ’ƒã®å½±éŸ¿ãŒå†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«åºƒãŒã‚‹å¯èƒ½æ€§ã‚’é˜²ããŸã‚ã«ã€å¤–éƒ¨ã‹ã‚‰ç›´æ¥ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ã‚‹ã€‚ãã®ãŸã‚ã€ã€DNSã‚µãƒ¼ãƒã€ã€ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã€ã€Webã‚µãƒ¼ãƒã€ã€ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã€ã¯ã€éæ­¦è£…åœ°å¸¯ã«è¨­ç½®ã•ã‚Œã‚‹ã€‚ ãƒ»å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚µãƒ¼ãƒã®ç¨®é¡ å¤–éƒ¨ã‹ã‚‰ç›´æ¥ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ãªã„ã€‚ãã®ãŸã‚ã€ã€DBã‚µãƒ¼ãƒã€ã¯ã€å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«è¨­ç½®ã•ã‚Œã‚‹ã€‚ 03. Webã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹æˆã™ã‚‹ä¸»è¦ãª3å±¤æ§‹é€  Webã‚·ã‚¹ãƒ†ãƒ ã¨ã¯ Webã‚µãƒ¼ãƒã€Appã‚µãƒ¼ãƒã€DBã‚µãƒ¼ãƒã«ã‚ˆã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ä»•çµ„ã¿ã‚’Webã‚·ã‚¹ãƒ†ãƒ ã¨ã„ã†ã€‚ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¨ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®ãƒãƒ¼ãƒˆã‚‚å‚è€ƒã«ã›ã‚ˆã€‚ Webã‚µãƒ¼ãƒ ãƒ»Webã‚µãƒ¼ãƒã®å½¹å‰² ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼ˆApacheã€Nginxãªã©ï¼‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã€‚ã¾ãŸã€Webå…¼Appã‚µãƒ¼ãƒã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ï¼ˆNGINX Unitï¼‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ Webã‚µãƒ¼ãƒ â†’ Appã‚µãƒ¼ãƒ â†’ DBã‚µãƒ¼ãƒ é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ é™çš„ãƒ¬ã‚¹ ãƒ¼ ãƒ¼ é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼‹å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ é™çš„ãƒ¬ã‚¹ å‹•çš„ãƒ¬ã‚¹ ãƒ‡ãƒ¼ã‚¿ç®¡ç† ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã¿ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã£ãŸå ´åˆã€é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã€‚ã¾ãŸã€é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸¡æ–¹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã£ãŸå ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒã«å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¡Œã†ã€‚ Appã‚µãƒ¼ãƒ ãƒ»Appã‚µãƒ¼ãƒã®å½¹å‰² ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼ˆPHPãªã‚‰PHP-FPMã€Javaãªã‚‰Tomcatï¼‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã€‚ Webã‚µãƒ¼ãƒ â†’ Appã‚µãƒ¼ãƒ â†’ DBã‚µãƒ¼ãƒ é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ é™çš„ãƒ¬ã‚¹ ãƒ¼ ãƒ¼ é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼‹å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ é™çš„ãƒ¬ã‚¹ å‹•çš„ãƒ¬ã‚¹ ãƒ‡ãƒ¼ã‚¿ç®¡ç† Webã‚µãƒ¼ãƒã‹ã‚‰å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã£ãŸå ´åˆã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’è¨€èªãƒ—ãƒ­ã‚»ãƒƒã‚µã§ç¿»è¨³ã—ã€DBã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†ã€‚DBã‚µãƒ¼ãƒã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚Šã€Webã‚µãƒ¼ãƒã«å‹•çš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¡Œã†ã€‚ DBç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æŒã¤DBã‚µãƒ¼ãƒ ãƒ»DBã‚µãƒ¼ãƒã®å½¹å‰² DBç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã€‚DBã®æƒ…å ±ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã€‚ ã‚µãƒ¼ãƒã®å‡¦ç†èƒ½åŠ›å‘ä¸Š ãƒ»å‚ç›´ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ï¼ˆã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ— â‡” ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ï¼‰ ã‚µãƒ¼ãƒè‡ªä½“ã®ã‚¹ãƒšãƒƒã‚¯ã‚’ã‚ˆã‚Šé«˜ãã™ã‚‹ã“ã¨ã§ã€ã‚µãƒ¼ãƒå½“ãŸã‚Šã®å‡¦ç†èƒ½åŠ›ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚ãã®é€†ã¯ã€ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã€‚è¨­å®šã§ã€ä»®æƒ³ã‚µãƒ¼ãƒã®ã‚¹ãƒšãƒƒã‚¯ã‚’ä¸Šã’ã‚‹ã“ã¨ã‚‚ã€ã“ã‚Œã«è©²å½“ã™ã‚‹ã€‚ ãƒ»æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ï¼ˆã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ â‡” ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ï¼‰ ã‚µãƒ¼ãƒã®å°æ•°ã‚’å¢—ã‚„ã™ã“ã¨ã§ã€ã‚µãƒ¼ãƒå…¨ä½“ã®å‡¦ç†èƒ½åŠ›ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚ãã®é€†ã¯ã€ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã€‚ 03-02. Webã‚·ã‚¹ãƒ†ãƒ ã®æ§‹æˆæ–¹æ³• Dualã‚·ã‚¹ãƒ†ãƒ  åŒã˜å‡¦ç†ã‚’è¡Œã†2ã¤ã®ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ãªã‚‹ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆã®ã“ã¨ã€‚éšæ™‚ã€å‡¦ç†çµæœã‚’ç…§åˆã™ã‚‹ã€‚ã„ãšã‚Œã‹ãŒæ•…éšœã—ãŸå ´åˆã€ç•°å¸¸ãŒç™ºç”Ÿã—ãŸã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ‡ã‚Šé›¢ã—ã€æ®‹ã‚‹ç‰‡æ–¹ã§å‡¦ç†ã‚’ç¶šã‘ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€æ•…éšœã‚’ä¹—ã‚Šåˆ‡ã‚‹ã€‚ Duplexã‚·ã‚¹ãƒ†ãƒ  ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å‡¦ç†ã‚’è¡Œã†ä¸»ç³»ã‚·ã‚¹ãƒ†ãƒ ã¨ã€ãƒãƒƒãƒå‡¦ç†ã‚’è¡Œã†å¾“ç³»ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ãªã‚‹ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆã®ã“ã¨ã€‚ä¸»ç³»ã‚·ã‚¹ãƒ†ãƒ ãŒæ•…éšœã—ãŸå ´åˆã€ä¸»ç³»ã‚·ã‚¹ãƒ†ãƒ ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å‡¦ç†ã‚’å¾“ç³»ã‚·ã‚¹ãƒ†ãƒ ã«å¼•ãç¶™ãã€å‡¦ç†ã‚’ç¶šã‘ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€æ•…éšœã‚’ä¹—ã‚Šåˆ‡ã‚‹ã€‚ å¾“ç³»ã‚·ã‚¹ãƒ†ãƒ ã®å¾…æ©Ÿæ–¹æ³•ã«ã¯ï¼’ã¤ã®ç¨®é¡ãŒã‚ã‚‹ã€‚ ãƒ»ãƒ›ãƒƒãƒˆã‚¹ã‚¿ãƒ³ãƒã‚¤ ãƒ»ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ³ãƒã‚¤ ã‚·ã‚¹ãƒ†ãƒ ã®ç¨¼åƒç‡ ä¸¦åˆ—ã‚·ã‚¹ãƒ†ãƒ ã®å ´åˆã€ä¸¡æ–¹ã®éç¨¼åƒç‡ã‚’ã‹ã‘ã¦ã€å…¨ä½“ã‹ã‚‰å¼•ãã€‚ ï¼Šä¾‹ï¼Š ï¼‘ï¼(1ï¼0.81) Ã— (1ï¼0.64) = 0.9316 04. ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ï¼ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒ å½¹å‰² ãƒ»ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ©Ÿèƒ½ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒãƒ¼ãƒˆã‚‚å‚ç…§ï¼‰ ä»£ç†ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ã‚‹ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«åˆ†é¡ã§ãã‚‹ã€‚ ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ã€Webãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€Webã‚µãƒ¼ãƒã®ã‚¢ã‚¯ã‚»ã‚¹è² è·ã‚’æŠ‘ãˆã‚‹ã€‚ã¡ãªã¿ã«ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã‚’æŒã£ã¦ã„ã‚‹ã€‚ è¨­ç½®å ´æ‰€ ãƒ»ç‰©ç†ã‚µãƒ¼ãƒã®å ´åˆ ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ä¼šç¤¾ã«ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã®ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«è¨­ç½®ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã®å ´åˆ ã‚¯ãƒ©ã‚¦ãƒ‰ã®å ´åˆã‚‚ã€ã‚µãƒ¼ãƒãŒä»®æƒ³çš„ã«æ§‹ç¯‰ã•ã‚Œã‚‹é•ã„ã ã‘ã§ã€è¨­ç½®å ´æ‰€ã¯åŒã˜ã§ã‚ã‚‹ã€‚ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã®å®Ÿç¾æ–¹æ³• ãƒ»Nginx Webã‚µãƒ¼ãƒã¨ã—ã¦ã§ã¯ãªãã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¨ã—ã¦ä½¿ç”¨ã—ã€ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½œæˆã‚’è¡Œãˆã‚‹ã€‚ 04-02. ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã€DNSã‚µãƒ¼ãƒã«ã‚ˆã‚‹åå‰è§£æ±º ï¼ˆ1ï¼‰å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã«å¯¾å¿œã™ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ»ä»•çµ„ã¿ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã¯ã€å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’ã€ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥DNSã‚µãƒ¼ãƒï¼‰ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’ã€DNSã‚µãƒ¼ãƒï¼ˆãƒãƒ¼ãƒ ã‚µãƒ¼ãƒï¼‰ã«ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ DNSã‚µãƒ¼ãƒã¯ã€å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã‚‹IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ | å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³å | â‡„ | IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ | | :--------------------------: | :--: | :-------------------: | | http://www.example.com | | 203.142.205.139 | ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ä»£ç†ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ï¼ˆâ€»NATã«ã‚ˆã‚‹IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“å¤‰æ›ãŒèµ·ã“ã‚‹ï¼‰ ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã«ä»£ç†ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ ãƒ»ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥DNSã‚µãƒ¼ãƒï¼‰ã«ãŠã‘ã‚‹DNSã‚­ãƒ£ãƒƒã‚·ãƒ¥ ãƒ«ãƒ¼ãƒˆã‚µãƒ¼ãƒã¯ä¸–ç•Œã«13æ©Ÿã—ã‹å­˜åœ¨ã—ã¦ãŠã‚‰ãšã€ä¸–ç•Œä¸­ã®åå‰è§£æ±ºã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å…¨ã¦å‡¦ç†ã™ã‚‹ã“ã¨ã¯ç¾å®Ÿçš„ã«ä¸å¯èƒ½ã§ã‚ã‚‹ã€‚ãã“ã§ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³åã®é–¢ä¿‚ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥DNSã‚µãƒ¼ãƒï¼‰ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚åŸºæœ¬çš„ã«ã¯ã€ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¨DNSã‚µãƒ¼ãƒã¯åŒºåˆ¥ã•ã‚Œã‚‹ã€‚ãŸã ã—ã€Amazon Route53ã®ã‚ˆã†ã«ã€ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¨DNSã‚µãƒ¼ãƒã®æ©Ÿèƒ½ã‚’ä¸¡ç«‹ã—ã¦ã„ã‚‹ã‚‚ã®ã‚‚ã‚ã‚‹ã€‚ ï¼ˆ2ï¼‰IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾å¿œã™ã‚‹Webãƒšãƒ¼ã‚¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ»ä»•çµ„ã¿ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸIPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åŸºã«ã€Webãƒšãƒ¼ã‚¸ã‚’ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€Webãƒšãƒ¼ã‚¸ã‚’ã€Webã‚µãƒ¼ãƒã«ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ Webã‚µãƒ¼ãƒã¯ã€Webãƒšãƒ¼ã‚¸ã‚’ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€Webãƒšãƒ¼ã‚¸ã‚’ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã«ä»£ç†ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ 06. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€Ÿåº¦ã®æŒ‡æ¨™ ä¸€è¦§ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ  ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã‹ã‚‰ã€ã‚µãƒ¼ãƒãŒå‡¦ç†ã‚’å®Ÿè¡Œã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ä¿¡ã•ã‚Œã‚‹ã¾ã§ã«è¦ã™ã‚‹æ™‚é–“ã®ã“ã¨ã€‚ ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã‹ã‚‰ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ä¿¡ã•ã‚Œã‚‹ã¾ã§è¦ã™ã‚‹æ™‚é–“ã®ã“ã¨ã€‚ã‚µãƒ¼ãƒã®å‡¦ç†æ™‚é–“ã¯å«ã¾ãªã„ã€‚ Connection Timeï¼ˆæ¥ç¶šæ™‚é–“ï¼‰ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å‰ã«ã€ã‚µãƒ¼ãƒã¨ã®TCPæ¥ç¶šã®ç¢ºç«‹ã«è¦ã™ã‚‹æ™‚é–“ã®ã“ã¨ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®é€å—ä¿¡ã®å‰å¾Œã«è¡Œã‚ã‚Œã‚‹TCPæ¥ç¶šã®ç¢ºç«‹ã‚’ã€ã‚¹ãƒªãƒ¼ã‚¦ã‚§ã‚¤ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã€ã¨ã„ã†ã€‚ Bandwidthï¼ˆå¸¯åŸŸå¹…ï¼‰ ä¸€åº¦ã«é€å—ä¿¡ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã®æœ€å¤§å®¹é‡ã®ã“ã¨ã€‚ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆï¼ˆä¼é€é€Ÿåº¦ï¼‰ å˜ä½æ™‚é–“å½“ãŸã‚Šã®é€ä¿¡ã§ãã‚‹æœ€å¤§ã®ãƒ‡ãƒ¼ã‚¿å®¹é‡ã®ã“ã¨ã€‚ ä»–ã‹ã‚‰ã®å½±éŸ¿ã‚’å—ã‘ãŸå®Ÿéš›ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚’ã€å®ŸåŠ¹ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã€ã¨ã„ã†ã€‚ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆï¼ˆä¼é€é€Ÿåº¦ï¼‰ ãƒ»ä¼é€ã¨ã¯ ã‚µãƒ¼ãƒã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã€‚ç›¸äº’ã®é€ä¿¡ã¯ã€é€šä¿¡ã¨å‘¼ã¶ã€‚ ãƒ»ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã¨ã¯ å˜ä½æ™‚é–“å½“ãŸã‚Šã®é€ä¿¡ã§ãã‚‹æœ€å¤§ã®ãƒ‡ãƒ¼ã‚¿å®¹é‡ã®ã“ã¨ã€‚å®Ÿéš›ã«ã¯ã€ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã¯ã€ã€ãƒ—ãƒ­ãƒã‚¤ãƒ€ã€ã€ã€å…‰å›ç·šã€ã€ã€è‡ªå®…ã®æœ‰ç·šï¼ç„¡ç·šã€ã®ä¸‰ã¤ã«å½±éŸ¿ã•ã‚Œã‚‹ãŸã‚ã€ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã§æœŸå¾…ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿å®¹é‡ã‚’æº€ãŸã›ãªã„ã“ã¨ãŒå¤šã„ã€‚å®Ÿéš›ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚’ã€å®ŸåŠ¹ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã€ã¨ã„ã†ã€‚ ãƒ»ä¼é€ç§’æ•°ã®æ±‚ã‚æ–¹ (ä¼é€ç§’æ•°) = ãƒ‡ãƒ¼ã‚¿å®¹é‡(bit) Ã· ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ(bit/s) Ã— ä¼é€åŠ¹ç‡ ãƒ»ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¨ã¯ ã¨ã‚ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åœ°ç‚¹ã§ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://xtech.nikkei.com/it/article/Keyword/20070222/262872/ ç·å‹™çœã®ãƒ‡ãƒ¼ã‚¿ã§ã€æ—¥æœ¬ã®ãƒ–ãƒ­ãƒ¼ãƒ‰ãƒãƒ³ãƒ‰å¤§æ‰‹5ç¤¾ã®ç·ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å¹´æ¬¡ã§ã‚°ãƒ©ãƒ•åŒ–ã—ãŸã‚‚ã®ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://xtech.nikkei.com/atcl/nxt/column/18/00525/112900001/ "},"public/network/network_osi_tcp_model.html":{"url":"public/network/network_osi_tcp_model.html","title":"ğŸ“– ï¸OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ï¼TCPéšå±¤ãƒ¢ãƒ‡ãƒ«","keywords":"","body":"OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ï¼TCPéšå±¤ãƒ¢ãƒ‡ãƒ« ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã¨TCPéšå±¤ãƒ¢ãƒ‡ãƒ« ãƒ‡ãƒ¼ã‚¿ãŒãƒ‘ã‚±ãƒƒãƒˆã«ãªã‚‹ã¾ã§ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã§ãƒ‡ãƒ¼ã‚¿ãŒä½œæˆã•ã‚Œã‚‹ã€‚ ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ã§TCPãƒ˜ãƒƒãƒ€ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå±¤ã§IPãƒ˜ãƒƒãƒ€ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã§Ethernetãƒ˜ãƒƒãƒ€ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ ãƒ‘ã‚±ãƒƒãƒˆã¨ã—ã¦é€ä¿¡ã•ã‚Œã‚‹ã€‚ OSIå‚ç…§ãƒ¢ãƒ‡ãƒ« ãƒ»å„æ¦‚å¿µå±¤ã®ãƒ˜ãƒƒãƒ€æƒ…å ±è¿½åŠ  TCPéšå±¤ãƒ¢ãƒ‡ãƒ« ãƒ»ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®åˆ†é¡ã¨æ‰±ã‚ã‚Œã‚‹éšå±¤ TCP/IPãƒ¢ãƒ‡ãƒ«ã§ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ã†ã¡ã€æœ€ã‚‚ä»£è¡¨çš„ãªã€TCPã€ã¨ã€IPã€ã‹ã‚‰åå‰ã‚’ã¨ã£ã¦ã€TCP/IPã€ã¨åä»˜ã‘ã‚‰ã‚ŒãŸã€‚ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã—ã¦ã®æš—å·åŒ–æŠ€è¡“ã§ã‚ã‚‹ã€ã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€ã¯ã€èµ¤è‰²ã§ç¤ºã—ã¦ã‚ã‚‹ã€‚ 02-02. é€šä¿¡æ©Ÿå™¨ã«ãŠã‘ã‚‹ãƒ˜ãƒƒãƒ€æƒ…å ±èªè­˜ å„æ¦‚å¿µå±¤ã¨é€šä¿¡æ©Ÿå™¨ã®é–“ã®å¯¾å¿œé–¢ä¿‚ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCãŒã‚ã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã«ã¦ã€Webãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒTCPã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆOSIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‹ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‹ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ï¼‰ã§ç¨¼åƒã—ã¦ã„ã‚‹ã€‚ã“ã“ã§ã€ãƒ‘ã‚±ãƒƒãƒˆãŒä½œæˆã•ã‚Œã‚‹ã€‚ ãƒ‘ã‚±ãƒƒãƒˆã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã®TCPãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ï¼ˆOSIãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ï¼‰ã€TCPã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå±¤ï¼ˆOSIãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ï¼‰ã€TCPãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆOSIãƒ‡ãƒ¼ã‚¿ãƒªãƒ³ã‚¯å±¤ï¼‹OSIç‰©ç†å±¤ï¼‰ã‚’çµŒã‚‹ã€‚å„å±¤ã§ã€ãƒ‘ã‚±ãƒƒãƒˆã«ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ PCã‹ã‚‰ãƒ«ãƒ¼ã‚¿ã«ãƒ‘ã‚±ãƒƒãƒˆãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ ãƒ«ãƒ¼ã‚¿ã¯TCPã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå±¤ï¼ˆOSIãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ï¼‰ã«å±ã™ã‚‹ãŸã‚ã€ã‚ˆã‚Šä¸Šå±¤ã«ä¸€åº¦æˆ»ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’çµŒã¦ã€é€ä¿¡å…ˆã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ãƒ«ãƒ¼ã‚¿ã«åˆ°é”ã™ã‚‹ã€‚ ãƒ«ãƒ¼ã‚¿ã‹ã‚‰ã‚µãƒ¼ãƒã«ãƒ‘ã‚±ãƒƒãƒˆãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ ãƒ‘ã‚±ãƒƒãƒˆã¯ã€ã‚µãƒ¼ãƒã®CPãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆOSIãƒ‡ãƒ¼ã‚¿ãƒªãƒ³ã‚¯å±¤ï¼‹OSIç‰©ç†å±¤ï¼‰ã€TCPã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå±¤ï¼ˆOSIãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ï¼‰ã€TCPãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ï¼ˆOSIãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ï¼‰ã€ã‚’çµŒã‚‹ã€‚ ã‚µãƒ¼ãƒã«ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒç‰¹å®šã®ãƒãƒ¼ãƒˆç•ªã§ãƒªãƒƒã‚¹ãƒ³ã—ã¦ã„ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ãƒ‘ã‚±ãƒƒãƒˆãŒå‡¦ç†ã•ã‚Œã‚‹ã€‚ ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒªãƒ³ã‚¯å±¤ ãƒ»ç‰©ç†å±¤ NICï¼šNetwork Interface Cardï¼ˆä¾‹ï¼šLANã‚¢ãƒ€ãƒ—ã‚¿ã€LANãƒœãƒ¼ãƒ‰ã€LANã‚«ãƒ¼ãƒ‰ï¼‰ã€ãƒªãƒ”ãƒ¼ã‚¿ã€LANã‚±ãƒ¼ãƒ–ãƒ« å„æ¦‚å¿µå±¤ã®ãƒ˜ãƒƒãƒ€æƒ…å ±èªè­˜ é€ä¿¡å…ƒã§ä½œæˆã•ã‚ŒãŸãƒ‘ã‚±ãƒƒãƒˆã¯ã€éã‚«ãƒ—ã‚»ãƒ«åŒ–ã•ã‚ŒãªãŒã‚‰ã€é€šä¿¡æ©Ÿå™¨ã«èªè­˜ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://ja.wikipedia.org/wiki/%E3%83%AB%E3%83%BC%E3%82%BF%E3%83%BC 03. TCPã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã¨ã¯ å„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç¨¼åƒã—ã¦ãŠã‚Šã€ãã‚Œãã‚ŒãŒãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ã‚’ä½œæˆã™ã‚‹ã€‚å„ãƒ—ãƒ­ã‚»ã‚¹ã¯ç‰¹å®šã®ãƒãƒ¼ãƒˆç•ªå·ã‚’ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://netdekagaku.com/netstat-command/ ã¡ãªã¿ã«ã€æŒ‡å®šã—ãŸãƒãƒ¼ãƒˆç•ªå·ã§ãƒªãƒƒã‚¹ãƒ³ã—ã¦ã„ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç‰¹å®šã§ãã‚‹ã€‚ $ sudo lsof -i: 03-02. ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã®é€å—ä¿¡ ãƒ»ä»•çµ„ã¿ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡å¯èƒ½ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã¯ã€é€ä¿¡å´ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«é€ä¿¡ã•ã‚Œã‚‹ã€‚ é€ä¿¡å´ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã¯ã€ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡å´ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«è»¢é€ã™ã‚‹ã€‚ å—ä¿¡å´ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€å„ã€…ãŒæŒ‡å®šã—ãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«å¿œã˜ã¦ã€å—ä¿¡å´ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://xtech.nikkei.com/it/pc/article/basic/20120312/1043605/ ãƒ»é€ä¿¡å´ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã®ãƒ¢ãƒƒã‚¯ ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡æ©Ÿèƒ½ã‚’é–‹ç™ºã™ã‚‹ã¨ãã«ã€é€ä¿¡ãƒ†ã‚¹ãƒˆã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã€ã“ã®å†…å®¹ã¯å…¬é–‹ã—ãŸããªã„ã€‚ãã“ã§ã€é€ä¿¡å´ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã®ãƒ¢ãƒƒã‚¯ã‚’æä¾›ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã€‚ã“ã®é€ä¿¡å´ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¢ãƒƒã‚¯ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡å´ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«è»¢é€ã—ãªã„ãŸã‚ã€å®‰å…¨ã«é€ä¿¡ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã§ãã‚‹ã€‚MailtrapãŒãŠã™ã™ã‚ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://mailtrap.io/ SMTPï¼šSimple Mail Transfer Protocol ãƒ»SMTPã¨ã¯ ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ã“ã¨ã€‚ ãƒ»SMTP-AUTHï¼šSMTP AUTHentication SMTPã«èªè¨¼ã‚’çµ„ã¿è¾¼ã‚“ã ä»•çµ„ã¿ã®ã“ã¨ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡å¯èƒ½ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’SMTPé€ä¿¡ã™ã‚‹æ™‚ã€ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã—ã¦èªè¨¼ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ POP3ï¼šPost Official Protocol version 3 ãƒ»POP3ã¨ã¯ ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«å±Šã„ãŸãƒ¡ãƒ¼ãƒ«ã‚’ã€å—ä¿¡æ©Ÿå™¨ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€å—ä¿¡æ©Ÿå™¨ã§é–²è¦§ã™ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚ãƒ¡ãƒ¼ãƒ«ã®æ—¢èª­æœªèª­çŠ¶æ³ã¯ã€ä»–ã®å—ä¿¡æ©Ÿå™¨ã¨å…±æœ‰ã•ã‚Œã‚‹ã€‚ IMAP4ï¼šInternet Message Access Protocol version 4 ãƒ»IMAP4ã¨ã¯ ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«å±Šã„ãŸãƒ¡ãƒ¼ãƒ«ã‚’ã€å—ä¿¡æ©Ÿå™¨ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã›ãšã€ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«ç½®ã„ãŸã¾ã¾é–²è¦§ã™ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚ãƒ¡ãƒ¼ãƒ«ã®æ—¢èª­æœªèª­çŠ¶æ³ã¯ã€ä»–ã®å—ä¿¡æ©Ÿå™¨ã¨å…±æœ‰ã•ã‚Œãªã„ã€‚ ï¼Šä¾‹ï¼Š Gmailã§POPã‹IMAPã‚’è¨­å®šå¯èƒ½ APOPï¼šAuthenticated POP ãƒ»APOPã¨ã¯ ãƒ¡ãƒ¼ãƒ«å—ä¿¡ã®éš›ã«ã€ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ–¹å¼ã®èªè¨¼ã‚’è¡Œã†ã“ã¨ã§å¹³æ–‡ã®èªè¨¼æƒ…å ±ãŒãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æµã‚Œã‚‹ã®ã‚’é˜²æ­¢ã™ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ« 04. TCPãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ã¨ã¯ ãƒ»å…¨ä½“åƒ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã‹ã‚‰æ¸¡ã•ã‚ŒãŸãƒ‘ã‚±ãƒƒãƒˆã®ãƒãƒ¼ãƒˆç•ªå·æƒ…å ±ã‚’å…ƒã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã«ãƒ‘ã‚±ãƒƒãƒˆã‚’æ¸¡ã™ã€‚ã¾ãŸåå¯¾ã«ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å‡ºåŠ›ã•ã‚ŒãŸãƒ‘ã‚±ãƒƒãƒˆã«æƒ…å ±ã‚’ä»˜åŠ ã—ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã«æ¸¡ã™ã€‚ã“ã®æ™‚ã€å„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç¨¼åƒã—ã¦ã„ã‚‹ã“ã¨ã«ç•™æ„ã™ã‚‹ã€‚ ãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ï¼ˆå›³ã® ã€â†’ã€ ï¼‰ ã¾ãšã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã§ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç”¨ã„ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã®ãƒ‘ã‚½ã‚³ãƒ³ã‚’è­˜åˆ¥ã™ã‚‹ã€‚ãã®å¾Œã€ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ã§ã€ãƒãƒ¼ãƒˆç•ªå·ã‚’å…ƒã«ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®nginxãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ãƒãƒ¼ãƒˆç•ªå·ã‚’8080ã¨è¨­å®šã—ãŸå ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒãƒ¼ãƒˆç•ªå·ã‚’æŒ‡å®šã™ã‚‹ã¨ã€nginxãƒ—ãƒ­ã‚»ã‚¹ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã§ãã‚‹ã€‚ GET http://localhost:8080/ ãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ï¼ˆå›³ã® ã€â†ã€ ï¼‰ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ããŸãƒ‘ã‚±ãƒƒãƒˆã®é€šéã—ãŸãƒãƒ¼ãƒˆç•ªå·ã‚’ãƒ˜ãƒƒãƒ€æƒ…å ±ã¨ã—ã¦è¿½åŠ ã™ã‚‹ã€‚ã“ã‚Œã‚’ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã¸é€ä¿¡ã™ã‚‹ã€‚ ãƒ»ã‚½ã‚±ãƒƒãƒˆã€ã‚½ã‚±ãƒƒãƒˆæ¥ç¶šã¨ã¯ ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ã«å­˜åœ¨ã—ã€å—ä¿¡ã—ãŸé€šä¿¡ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®å„ãƒ—ãƒ­ã‚»ã‚¹ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹å—ã‘å£ã‚’ã‚½ã‚±ãƒƒãƒˆã¨ã„ã†ã€‚é€ä¿¡å…ƒã®ã‚µãƒ¼ãƒãŒé€ä¿¡å…ˆã«å¯¾ã—ã¦ã€ã€192.168.1.1:50001ï¼ˆé€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹:é€ä¿¡ãƒãƒ¼ãƒˆï¼‰ã€ã€10.0.0.1:80ï¼ˆå®›å…ˆIPã‚¢ãƒ‰ãƒ¬ã‚¹:å®›å…ˆãƒãƒ¼ãƒˆï¼‰ã€ã¨ã„ã£ãŸã‚ˆã†ã«ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆç•ªå·ã®çµ„åˆã›ã§æŒ‡å®šã™ã‚‹ã€‚ã‚ªãƒªã‚¸ãƒ³ã¨ã¯ä¼¼ã¦éãªã‚‹ã‚‚ã®ãªã®ã§æ³¨æ„ã€‚ã‚µãƒ¼ãƒé–“ã®ã‚½ã‚±ãƒƒãƒˆé–“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ã‚½ã‚±ãƒƒãƒˆæ¥ç¶šã¨ã„ã†ã€‚ ãƒãƒ¼ãƒˆç•ªå· ãƒ»ãƒãƒ¼ãƒˆç•ªå·ã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ã‚»ã‚¹ã¸ã®ãƒ‘ã‚±ãƒƒãƒˆé€å—ä¿¡ã«ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’åŒºåˆ¥ã™ã‚‹ãŸã‚ã«å„ãƒ—ãƒ­ã‚»ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ç•ªå·ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ã€ãã‚Œãã‚Œãƒãƒ¼ãƒˆç•ªå·ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ãŠã‚Šã€ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ã§ã€ãƒãƒ¼ãƒˆç•ªå·ã‚’å…ƒã«ã—ã¦ã€ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã«ãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ ãƒ»Well known ãƒãƒ¼ãƒˆç•ªå·ï¼ˆ0 ï½ 1023ï¼‰ IANAï¼šInternet Assigned Numbers Authorityï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå‰²å½“ç•ªå·å…¬ç¤¾ï¼‰ã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ãƒˆç•ªå·ã€‚Webã‚µãƒ¼ãƒãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹æ™‚ã€ã¾ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹æ™‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ãƒ›ã‚¹ãƒˆOSã¨ã‚²ã‚¹ãƒˆï¼ˆä»®æƒ³ã‚µãƒ¼ãƒï¼‰ã¨ã®é€šä¿¡ã§ã¯ã€80ç•ªï¼ˆHTTPï¼‰ã®å—ä¿¡ã«é–¢ã™ã‚‹æ§˜ã€…ãªè¨­å®šãŒå¿…è¦ã«ãªã‚‹ã€‚ ãƒ»ç™»éŒ²æ¸ˆã¿ãƒãƒ¼ãƒˆç•ªå·ï¼ˆ1024 ï½ 49151ï¼‰ IANAãŒç™»éŒ²ç”³è«‹ã‚’å—ã‘ã¦å…¬é–‹ã—ã¦ã„ã‚‹ãƒãƒ¼ãƒˆç•ªå·ã€‚ä¼æ¥­ãŒä½œæˆã—ãŸç‹¬è‡ªã®ã‚¢ãƒ—ãƒªãªã©ã«å¯¾ã—ã¦å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹æ™‚ã€ã¾ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ã™ã‚‹æ™‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ãƒ»å‹•çš„ï¼éå…¬å¼ãƒãƒ¼ãƒˆç•ªå·ï¼ˆ49152 ï½ 65535ï¼‰ è‡ªç”±ã«ä½¿ç”¨ã§ãã‚‹ãƒãƒ¼ãƒˆç•ªå·ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹æ™‚ã€ã¾ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ã™ã‚‹æ™‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ãƒ»ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆãƒãƒ¼ãƒˆè»¢é€ï¼‰ ã‚µãƒ¼ãƒå†…ã®ç‰¹å®šã®ãƒãƒ¼ãƒˆç•ªå·ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ã€ãƒ‘ã‚±ãƒƒãƒˆãŒé€ä¿¡ã•ã‚Œã¦ããŸæ™‚ã€ã“ã‚Œã‚’ç•°ãªã‚‹ãƒãƒ¼ãƒˆç•ªå·ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è»¢é€ã™ã‚‹ã“ã¨ã€‚SSHãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨çµ„ã¿åˆã‚ã›ã‚‹ã¨ã€SSHãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Ÿç¾ã§ãã‚‹ã€‚ ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒŠ ãƒ»ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒŠã¨ã¯ ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒŠã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å„ãƒãƒ¼ãƒˆç•ªå·ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€å¿œç­”ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚„ã€ã©ã®ã‚ˆã†ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒå¿œç­”ã™ã‚‹ã‹ã‚’èª¿ã¹ã€ä¸€è¦§è¡¨ç¤ºã§ãã‚‹ã€‚ 05. TCPã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå±¤ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå±¤ã¨ã¯ IPãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã‚’ç”¨ã„ã¦ã€å®›å…ˆèªè­˜ã™ã‚‹ã€‚ PC-Aã¯ã€æ§‹æˆã—ãŸIPãƒ‘ã‚±ãƒƒãƒˆã‚’Ethernetã«ä¹—ã›ã¦ã€ãƒ«ãƒ¼ã‚¿Aã«é€ä¿¡ã€‚ ãƒ«ãƒ¼ã‚¿Aã¯ã€IPãƒ‘ã‚±ãƒƒãƒˆã‚’ãƒ‡ã‚¸ã‚¿ãƒ«å°‚ç”¨ç·šã«ä¹—ã›ã¦ã€ãƒ«ãƒ¼ã‚¿Bã«é€ä¿¡ã€‚ ãƒ«ãƒ¼ã‚¿Bã¯ã€æ§‹æˆã—ãŸIPãƒ‘ã‚±ãƒƒãƒˆã‚’Ethernetã«ä¹—ã›ã¦ã€Webã‚µãƒ¼ãƒã«é€ä¿¡ã€‚ IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¨®é¡ ãƒ»ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ LANå†…ã§ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ç•°ãªã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ã§ã¯ã€åŒã˜IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã€ã€10.0.0.0 ï½ 10.255.255.255ã€ã€ã€172.16.0.0 ï½ 172.31.255.255ã€ã€ã€192.168.0.0 ï½ 192.168.255.255ã€ã§è¡¨ã•ã‚Œã‚‹ã€‚ ãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãŒæä¾›ã™ã‚‹IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚ã‚‹ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã«åŒã˜IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å­˜åœ¨ã›ãšã€Network Information Centerã¸ã®ä½¿ç”¨ç”³è«‹ãŒå¿…è¦ã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç•ªå·ã§ãªã‘ã‚Œã°ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚ã‚‹ã€‚NATã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã£ã¦ãŠã‚Šã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ã®åŒæ–¹å‘ã¸ã®é€šä¿¡æ™‚ã«ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ç›¸äº’å¤‰æ›ã™ã‚‹ã€‚ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆï¼ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨bitã¨ã®é–¢ä¿‚ ä¾‹ãˆã°ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ï¼”ã¤ã®ã‚ªã‚¯ãƒ†ãƒƒãƒˆï¼ˆç¬¬ä¸€ã‚ªã‚¯ãƒ†ãƒƒãƒˆã‹ã‚‰ç¬¬å››ã‚ªã‚¯ãƒ†ãƒƒãƒˆã¾ã§ï¼‰ãŒï¼‘Byteã®å®¹é‡ã‚’ã‚‚ã¡ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹å…¨ä½“ã§ï¼”Byteã®å®¹é‡ã‚’æŒã¤ã€‚ã¡ãªã¿ã«ã€172ã‹ã‚‰å§‹ã¾ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã€ã‚¯ãƒ©ã‚¹Bã§ã‚ã‚‹ã€‚ã€€ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆï¼ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã¨ãƒ›ã‚¹ãƒˆéƒ¨ ãƒ»ã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹ãƒ›ã‚¹ãƒˆéƒ¨ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã®å®šç¾© IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚¯ãƒ©ã‚¹ã¨ã—ã¦åˆ†é¡ã—ã€å„ã‚¯ãƒ©ã‚¹ã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã¨ãƒ›ã‚¹ãƒˆéƒ¨ã‚’å®šç¾©ã™ã‚‹æ–¹æ³•ã€‚è¨­å®šã—ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å±ã™ã‚‹ã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦ã€ä½¿ç”¨ã§ãã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›²ãŒæ±ºã¾ã£ã¦ã—ã¾ã†ã€‚ãƒ›ã‚¹ãƒˆéƒ¨ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã®å®šç¾©æ–¹æ³•ãŒ4ç¨®é¡ã—ã‹ãªã„ãŸã‚ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ï¼ˆæœ€å¤§ãƒ‘ã‚½ã‚³ãƒ³æ•°ï¼‰ãŒå¤šã™ããŸã‚Šã€å°‘ãªã™ããŸã‚Šã—ã¦ã—ã¾ã†ã€‚ ä½¿ç”¨å¯èƒ½ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›² ã‚¯ãƒ©ã‚¹ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã®ã‚ªã‚¯ãƒ†ãƒƒãƒˆ ãƒ›ã‚¹ãƒˆéƒ¨ã®ã‚ªã‚¯ãƒ†ãƒƒãƒˆ äºŒé€²æ•°ã§è¦‹ãŸæ™‚ï¼ˆnï¼šãƒã€hï¼šãƒ›ï¼‰ IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ï¼ˆæœ€å¤§ãƒ‘ã‚½ã‚³ãƒ³æ•°ï¼‰ å‚™è€ƒ 0.0.0.0 ã€œ 127.255.255.255 A ç¬¬ä¸€ã®ã¿ ç¬¬äºŒã‹ã‚‰ç¬¬å›› 0nnnnnnn.hhhhhhhh.hhhhhhhh.hhhhhhhh 2^24ï¼ˆ16777216ï¼‰å€‹ 128.0.0.0 ã€œ 191.255.255.255 B ç¬¬ä¸€ã‹ã‚‰ç¬¬äºŒ ç¬¬ä¸‰ã‹ã‚‰ç¬¬å›› 10nnnnnn.nnnnnnnn.hhhhhhhh.hhhhhhhh 2^16ï¼ˆ65536ï¼‰å€‹ ã‚ˆãä½¿ã† 192.0.0.0 ã€œ 223.255.255.255 C ç¬¬ä¸€ã‹ã‚‰ç¬¬ä¸‰ ç¬¬å››ã®ã¿ 110nnnnn.nnnnnnnn.nnnnnnnn.hhhhhhhh 2^8ï¼ˆ256ï¼‰å€‹ 224.0.0.0 ã€œ 239.255.255.255 D - - 1110xxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx - 240.0.0.0 ã€œ 255.255.255.255 E - - 1111xxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx - ãƒ»ã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ã‚ˆã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã¨ãƒ›ã‚¹ãƒˆéƒ¨ã®å®šç¾© ã€1ã€ã‚ã‚‹ã„ã¯ã€0ã€ã§ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã¨ãƒ›ã‚¹ãƒˆéƒ¨ã‚’å®šç¾©ã—ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å¾Œã‚ã«è¨˜è¿°ã™ã‚‹æ–¹æ³•ï¼ˆï¼Šä¾‹ï¼Š192.168.42.23/24ï¼‰ã€‚è¨­å®šã—ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦ã€ä½¿ç”¨å¯èƒ½ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›²ã‚’è‡ªç”±ã«å®šç¾©ã§ãã‚‹ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éƒ¨ã‚’ã€1ã€ã€ãƒ›ã‚¹ãƒˆéƒ¨ã‚’ã€0ã€ã§è¡¨ç¾ã™ã‚‹ã€‚ã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ã®è¡¨è¨˜æ–¹æ³•ã«ã¯ã€äºŒé€²æ•°å½¢å¼ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ã€1ã®å€‹æ•°ã§è¡¨ã™CIDRå½¢å¼ã«ã‚ˆã‚‹è¡¨ç¾æ–¹æ³•ãŒã‚ã‚‹ã€‚ äºŒé€²æ•°å½¢å¼ IPã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ CIDRå½¢å¼ IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ï¼ˆæœ€å¤§PCæ•°ï¼‰ å‚™è€ƒ /10000000.00000000.00000000.00000000 /128.0.0.0 /1 /11000000.00000000.00000000.00000000 /192.0.0.0 /2 ... ... ... /11111111.00000000.00000000.00000000 /255.0.0.0 /8 2^24ï¼ˆ16777216ï¼‰å€‹ ... ... ... /11111111.11111110.00000000.00000000 /255.254.0.0 /15 /11111111.11111111.00000000.00000000 /255.255.0.0 /16 2^16ï¼ˆ65536ï¼‰å€‹ ã‚ˆãä½¿ã†ç¯„å›² ... ... /11111111.11111111.11111110.00000000 /255.255.254.0 /23 /11111111.11111111.11111111.00000000 /255.255.255.0 /24 2^8ï¼ˆ256ï¼‰å€‹ ... ... ... /11111111.11111111.11111111.11111110 /255.255.255.254 /31 /11111111.11111111.11111111.11111111 /255.255.255.255 /32 1å€‹ ã‚ˆãä½¿ã†ç¯„å›² ï¼Šä¾‹ï¼Š ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ192.168.0.0ï¼ˆ11000000.10101000.00000000.00000000ï¼‰ã§ã€ä½¿ã„ãŸã„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ãŒ65536å€‹ã€ã¾ãŸã¯16777216å€‹ã®å ´åˆã€ã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ã®è¡¨è¨˜ã€ä½¿ç”¨å¯èƒ½ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›²ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚ ä½¿ã„ãŸã„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•° äºŒé€²æ•°å½¢å¼ã«ã‚ˆã‚‹è¡¨è¨˜ IPã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ CIDRå½¢å¼ ä½¿ç”¨å¯èƒ½ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›² 16777216å€‹ 192.168.0.0/11111111.00000000.00000000.00000000 192.168.0.0/255.0.0.0 192.168.0.0/24 â‡’ 192.168.0.1 ã€œ 192.168.0.254 65536å€‹ 192.168.0.0/11111111.11111111.00000000.00000000 192.168.0.0/255.255.0.0 192.168.0.0/16 â‡’ 192.168.0.1 ã€œ 192.168.255.254 1å€‹ 192.168.0.0/11111111.11111111.11111111.11111111 192.168.0.0/255.255.255.255 192.168.0.0/32 â‡’ 192.168.0.0 DNSã‚µãƒ¼ãƒã¨hostsãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰² ãƒ»å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒƒãƒ”ãƒ³ã‚° ä¾‹ãˆã°ã€å¤–éƒ¨Webã‚µãƒ¼ãƒã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã€203.142.205.139ã€ã§ã‚ã‚‹ã¨çŸ¥ã£ã¦ã„ã‚‹å ´åˆã€URLã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«éƒ¨åˆ†ä»¥ä¸‹ã‚’ã€203.142.205.139ã€ã¨ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚Œã°ã€å¤–éƒ¨Webã‚µãƒ¼ãƒãŒæä¾›ã™ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚ã—ã‹ã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯æ•°å­—ã®ç¾…åˆ—ã§ã‚ã‚‹ãŸã‚ã€äººé–“ã«ã¯è¦šãˆã«ãã„ã€‚ãã“ã§ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ä»£ã‚ã‚Šã«ã€å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’URLã®ä¸€éƒ¨ã¨ã—ã¦ç”¨ã„ã‚‹ã€‚ ãƒ»hostsãƒ•ã‚¡ã‚¤ãƒ« DNSã‚µãƒ¼ãƒã‚ˆã‚Šã‚‚å…ˆã«å‚ç…§ã•ã‚Œã‚‹ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã€‚Webã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒDNSã‚µãƒ¼ãƒã«ç™»éŒ²ã•ã‚Œã¦ã„ãªã„æ™‚ã€ã¾ãŸDNSã‚µãƒ¼ãƒãŒä¸å…·åˆã®æ™‚ã«ã€DNSã‚µãƒ¼ãƒã®ä»£ã‚ã‚Šã¨ã—ã¦ç”¨ã„ã‚‹ã€‚ 05-02. ãƒ«ãƒ¼ã‚¿ NATï¼ˆé™çš„NATï¼‰ï¼šNetwork Address Translationã«ã‚ˆã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹v4ã®å¤‰æ› ä¸€ã¤ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦ã€ä¸€ã¤ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã¡ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åŒæ–¹å‘ã¸ã®é€šä¿¡æ™‚ã«ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰æ›ã§ãã‚‹ã€‚ ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã®ãƒ«ãƒ¼ã‚¿ã«ãŠã‘ã‚‹å¤‰æ› ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰å‡ºã‚‹æ™‚ã«ã€ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã«ãŠã‘ã‚‹ã€é€ä¿¡å…ƒã€ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š ä¾‹ãˆã°ã€Googleã§Webãƒšãƒ¼ã‚¸ã‚’è¦‹ãªãŒã‚‰ã€Gmailã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¦ã„ã‚‹å ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ãŠã‘ã‚‹ãƒ‘ã‚±ãƒƒãƒˆæƒ…å ±ã¨ã—ã¦â€¦ é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ â‡„ é€ä¿¡å…ƒã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ 192.168.1.1 200.1.1.1 ã€é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã€é€ä¿¡å…ˆã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã€ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã®å¾…ã¡å—ã‘ãƒãƒ¼ãƒˆç•ªå·110ï¼ˆPOP3ï¼‰ã€ã‚’æŒ‡å®šã—ã¦ã€ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ GET http://www.example.co.jp:110/ ã€é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã€é€ä¿¡å…ˆã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã€Webã‚µãƒ¼ãƒã®å¾…ã¡å—ã‘ãƒãƒ¼ãƒˆç•ªå·80ï¼ˆHTTPï¼‰ã€ã‚’æŒ‡å®šã—ã¦ã€Webã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ãŸã ã—ã€‚80ã¯ã€çœç•¥å¯èƒ½ã€‚ GET http://www.example.co.jp:80/ ã€é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã€é€ä¿¡å…ˆã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã€DNSã‚µãƒ¼ãƒã®å¾…ã¡å—ã‘ãƒãƒ¼ãƒˆç•ªå·53ï¼ˆDNSï¼‰ã€ã‚’æŒ‡å®šã—ã¦ã€DNSã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ GET http://www.example.co.jp:53/ ã“ã‚Œã‚‰ã®ã€é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãŒã€NATãƒ«ãƒ¼ã‚¿ã§ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã®å¤‰æ› ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å…¥ã‚‹æ™‚ã«ã€ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã«ãŠã‘ã‚‹ã€å®›å…ˆã€ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã™ã‚‹ã€‚ NAPTï¼ˆå‹•çš„NATï¼‰ï¼šNetwork Address Port Translationã«ã‚ˆã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆç•ªå·ã®å¤‰æ› ä¸€ã¤ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦ã€è¤‡æ•°ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åŒæ–¹å‘ã¸ã®é€šä¿¡æ™‚ã«ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰æ›ã§ãã‚‹ã€‚ ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã®å¤‰æ› ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰å‡ºã‚‹æ™‚ã«ã€ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã«ãŠã‘ã‚‹ã€é€ä¿¡å…ƒã€ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã™ã‚‹ã€‚ãŸã ã—ã€ç•°ãªã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒåŒã˜ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã«å¤‰æ›ã•ã‚Œã¦ã—ã¾ã†ãŸã‚ã€ã“ã‚Œã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã«ã€ãƒãƒ¼ãƒˆç•ªå·ã‚’è¤‡æ•°ã®ç•°ãªã‚‹ãƒãƒ¼ãƒˆç•ªå·ã«å¤‰æ›ã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ä»˜ã‘åŠ ãˆã‚‹ã€‚ ï¼Šä¾‹ï¼Š é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ å¤‰æ›å‰ãƒãƒ¼ãƒˆç•ªå· â‡„ é€ä¿¡å…ƒã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ å¤‰æ›å¾Œãƒãƒ¼ãƒˆç•ªå· 192.168.2.1 50011 130.X.X.X:50011 50011 192.168.3.1 50011 130.X.X.X:50012 50012 ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã®å¤‰æ› ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å…¥ã‚‹æ™‚ã«ã€ä»˜ã‘åŠ ãˆã‚‰ã‚ŒãŸãƒãƒ¼ãƒˆç•ªå·ã‚’å…ƒã«ã€ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã«ãŠã‘ã‚‹ã€å®›å…ˆã€ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ç•°ãªã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã—åˆ†ã‘ã‚‹ã€‚ "},"public/security/security_cyber_attacks.html":{"url":"public/security/security_cyber_attacks.html","title":"ğŸ“– ï¸ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒ","keywords":"","body":"ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒã‹ã‚‰ã®é˜²å¾¡æ–¹æ³• é˜²å¾¡æ–¹æ³•ã®ç¨®é¡ ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« ãƒ»Proxyã‚µãƒ¼ãƒã«ã‚ˆã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤å‹ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« Proxyã‚µãƒ¼ãƒä¸Šã§ã€SSLè¨¼æ˜æ›¸ã®æ¤œè¨¼ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç³»ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ç¨¼åƒã€ã‚’è¡Œã„ã€ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨ã—ã¦ç”¨ã„ã‚‹ã€‚Proxyã‚µãƒ¼ãƒã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç²¾åº¦ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯ã“ã¡ã‚‰ã€‚ ãƒ»ãƒ‘ã‚±ãƒƒãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‹ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã«è¨˜è¼‰ã•ã‚ŒãŸé€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„ãƒãƒ¼ãƒˆç•ªå·ãªã©ã«ã‚ˆã£ã¦ã€ãƒ‘ã‚±ãƒƒãƒˆã‚’è¨±å¯ã™ã‚‹ã¹ãã‹ã©ã†ã‹ã‚’æ±ºå®šã™ã‚‹ã€‚é€Ÿåº¦ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯ã“ã¡ã‚‰ã€‚ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨Webã‚µãƒ¼ãƒã®é–“ã«ã¯ã€NATãƒ«ãƒ¼ã‚¿ã‚„NAPTãƒ«ãƒ¼ã‚¿ãŒè¨­ç½®ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œã‚‰ã«ã‚ˆã‚‹é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰é€ä¿¡å…ƒã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®å¤‰æ›ã«ã¤ã„ã¦ã‚‚å‚è€ƒã«ã›ã‚ˆã€‚ ï¼Šä¾‹ï¼Š Win10ã«ãŠã‘ã‚‹è¨­å®šç”»é¢ Detection Systemã¨ã¯ ãƒ»Detection Systemã¨ã¯ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã‚’æµã‚Œã‚‹ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç›£è¦–ã—ã€ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã¨æ€ã‚ã‚Œã‚‹ãƒ‘ã‚±ãƒƒãƒˆã‚’æ¤œå‡ºã—ãŸæ™‚ã«ã€ç®¡ç†è€…ã«é€šçŸ¥ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã€‚ã‚ãã¾ã§é€šçŸ¥ã™ã‚‹ã ã‘ã§ã€æ”»æ’ƒã‚’é˜²å¾¡ã™ã‚‹ã“ã¨ã¯ã—ãªã„ã€‚ IPSï¼šIntrusion Prevention Systemã¨ã¯ ãƒ»IPSã¨ã¯ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã‚’æµã‚Œã‚‹ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç›£è¦–ã—ã€ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã¨æ€ã‚ã‚Œã‚‹ãƒ‘ã‚±ãƒƒãƒˆã‚’æ¤œå‡ºã—ãŸæ™‚ã«ã€ç®¡ç†è€…ã«é€šçŸ¥ã—ã€ã•ã‚‰ã«ãƒ‘ã‚±ãƒƒãƒˆã®ä¾µå…¥ã‚’é˜²ãã‚·ã‚¹ãƒ†ãƒ ã€‚ WAFï¼šWeb Application Firewallã¨ã¯ ãƒ»WAFã¨ã¯ ã‚·ã‚¹ãƒ†ãƒ ã‚’ä¿è­·ã™ã‚‹æ©Ÿèƒ½ã‚’æŒã£ãŸã‚·ã‚¹ãƒ†ãƒ ã®ã“ã¨ã€‚ 02. Malware ã®ç¨®é¡ã¨ç‰¹å¾´ Malware ã®èªæº ã€maliciousï¼ˆæ‚ªæ„ã®ã‚ã‚‹ï¼‰ï¼‹softwareï¼ˆã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼‰ã€ Macroã‚¦ã‚¤ãƒ«ã‚¹ ãƒ»Macroã‚¦ã‚¤ãƒ«ã‚¹ã¨ã¯ Wordãªã©ã®ãƒ¯ãƒ¼ãƒ—ãƒ­ã‚¢ãƒ—ãƒªã‚„ã€Excelãªã©ã®è¡¨è¨ˆç®—ã‚¢ãƒ—ãƒªã«æ„ŸæŸ“ Worm ãƒ»Wormã¨ã¯ è‡ªå·±è¤‡è£½ã—ã€1ã¤ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‹ã‚‰ã€4ã¤ã®çµŒè·¯ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ãƒ¡ãƒ¼ãƒ«ã€å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã€USBï¼‰ã‚’è¾¿ã£ã¦ã€ä»–ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«æ„ŸæŸ“ã‚’åºƒã’ã¦ã„ãã€‚ãƒ‘ã‚½ã‚³ãƒ³ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«IPã§ç›´æ¥ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«æ¥ç¶šã—ã¦ã„ã‚‹ã¨æ„ŸæŸ“ã—ã‚„ã™ã„ã€‚ãƒ¯ãƒ¼ãƒ ã‚’é˜²ããŸã‚ã«ã¯ã€ãƒ‘ã‚½ã‚³ãƒ³ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã—ã€NATã‚„NAPTãªã©ã‚’ä»‹ã—ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«æ¥ç¶šã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šä¾‹ï¼Š å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€çµŒç”±ã§ã®æ„ŸæŸ“æ‹¡å¤§ ãƒˆãƒ­ã‚¤ã®æœ¨é¦¬ ãƒ»ãƒˆãƒ­ã‚¤ã®æœ¨é¦¬ã¨ã¯ ï¼Šä¾‹ï¼Š Google play ã§ã€éå»ã«ã‚¢ãƒ—ãƒªã¨ã—ã¦å¿ã³è¾¼ã‚“ã§ã„ãŸãƒˆãƒ­ã‚¤ã®æœ¨é¦¬ æ„ŸæŸ“æ–¹æ³•ãŒã‚®ãƒªã‚·ãƒ£ç¥è©±ä¸Šã®ãƒˆãƒ­ã‚¤ã®æœ¨é¦¬ã«ä¼¼ã¦ã„ã‚‹ã“ã¨ã«ç”±æ¥ã™ã‚‹ã€‚æœ‰ç”¨ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã‚‹ã‚ˆã†ã«è¦‹ã›ã‹ã‘ã¦ã€ãƒ‘ã‚½ã‚³ãƒ³åˆ©ç”¨è€…ã«å®Ÿè¡Œã•ã›ã‚‹ã“ã¨ã§æ„ŸæŸ“ã€‚è£ã§ä¸æ­£ãªå‡¦ç†ã‚’è¡Œã†ã€‚ â€»ãƒˆãƒ­ã‚¤ã®æœ¨é¦¬ã¯ã‚®ãƒªã‚·ãƒ£ç¥è©±ã«ç™»å ´ã™ã‚‹ã€‚ã‚®ãƒªã‚·ãƒ£è»ã¯é›£æ”»ä¸è½ã®ãƒˆãƒ­ã‚¤åŸã‚’é™¥è½ã•ã›ã‚‹ãŸã‚ã€ä¸­ã«ç²¾é‹­éƒ¨éšŠã‚’å¿ã³è¾¼ã¾ã›ãŸæœ¨é¦¬ã‚’ãƒˆãƒ­ã‚¤åŸã®è¿‘ãã«ç½®ã„ã¦å¸°ã£ãŸã€‚æˆ¦åˆ©å“ã ã¨å‹˜é•ã„ã—ãŸãƒˆãƒ­ã‚¤è»ã¯ã€åŸå†…ã«æœ¨é¦¬ã‚’æŒã¡å¸°ã£ãŸã€‚å¤œä¸­ã€æœ¨é¦¬ã®ä¸­ã«éš ã‚ŒãŸç²¾é‹­éƒ¨éšŠãŒè‡ªè»ã®å…µå£«ã‚’ãƒˆãƒ­ã‚¤åŸã«å¼•ãå…¥ã‚Œã€åŸã‚’åˆ¶åœ§ã—ãŸã€‚ Spyware ãƒ»Spywareã¨ã¯ ãƒ‘ã‚½ã‚³ãƒ³åˆ©ç”¨è€…ã®å€‹äººæƒ…å ±ã‚’åé›†ã—ã€å¤–éƒ¨ã«é€ä¿¡ã™ã‚‹ã€‚ Bot ãƒ»Botã¨ã¯ ã‚ã‚‰ã‹ã˜ã‚BotåŒ–ã•ã›ã¦ãŠã„ãŸãƒ‘ã‚½ã‚³ãƒ³ã‚’è¸ã¿å°ã¨ã—ã¦ã€æ”»æ’ƒè€…ã®å‘½ä»¤é€šã‚Šã«å‹•ã‹ã™ã€‚ ãƒ»ãƒ‘ã‚½ã‚³ãƒ³ãŒãƒœãƒƒãƒˆåŒ–ã™ã‚‹ã¾ã§ã®ãƒ—ãƒ­ã‚»ã‚¹ ãƒ»ã‚¹ãƒãƒ›ãŒãƒœãƒƒãƒˆåŒ–ã™ã‚‹ã¾ã§ã®ãƒ—ãƒ­ã‚»ã‚¹ ãƒ»Bot ã®ä½¿ã‚ã‚Œæ–¹ ã¾ãšã€æ”»æ’ƒå¯¾è±¡ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã«ã‚ã‚‹ãƒ‘ã‚½ã‚³ãƒ³ã‚’BotåŒ–ã•ã›ã‚‹ã€‚æ”»æ’ƒè€…ã¯ã€BotåŒ–ã—ãŸãƒ‘ã‚½ã‚³ãƒ³ã‚’è¸ã¿å°ã¨ã—ã¦ã‚µãƒ¼ãƒãƒ¼ã‚’æ”»æ’ƒã•ã›ã‚‹ã‚ˆã†ã«ã€C&Cã‚µãƒ¼ãƒãƒ¼ã«å‘½ä»¤ã‚’å‡ºã™ã€‚ 03. ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒï¼ãã®å¯¾ç­– CSRFï¼šCross-Site Request Forgeries ãƒ»CSRFã¨ã¯ ãƒ¦ãƒ¼ã‚¶ãŒã¨ã‚ã‚‹ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä¿æŒã—ãŸã¾ã¾æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ã™ã‚‹ã€‚æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆã®ã‚µãƒ¼ãƒã¯ã€ãƒ¦ãƒ¼ã‚¶ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”¨ã„ã¦ã€å…ƒã€…ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãŸã‚µã‚¤ãƒˆã®ã‚µãƒ¼ãƒã‚’æ”»æ’ƒã™ã‚‹ã€‚ã‚µãƒ¼ãƒã¯ã€æ­£ã—ã„ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨èª¤èªã—ã¦ã—ã¾ã„ã€æ”»æ’ƒã‚’è¨±å®¹ã—ã¦ã—ã¾ã†ã€‚ å‚è€ƒï¼šhttps://www.ipa.go.jp/security/vuln/websecurity-HTML-1_6.html ãƒ»ã€å¯¾ç­–ã€‘ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒˆãƒ¼ã‚¯ãƒ³ èªè¨¼æ™‚ã«ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã ã‘ã§ãªãã€ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒˆãƒ¼ã‚¯ãƒ³ã‚‚ä½µç”¨ã™ã‚‹ã€‚èªè¨¼ãƒ•ã‚©ãƒ¼ãƒ ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸæ™‚ã€ã‚µãƒ¼ãƒå´ã§ã¯ã€ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ã€ã“ã‚Œã‚’Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®csrftokenãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«ã‚ˆã£ã¦ã¯ã€ã“ã‚Œã«ç›¸å½“ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ã‚„ç‹¬è‡ªãƒ˜ãƒƒãƒ€ãƒ¼ã«å‰²ã‚Šå½“ã¦ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ 200 OK Set-Cookie: csrftoken= # ç‹¬è‡ªãƒ˜ãƒƒãƒ€ãƒ¼ X-CSRF-TOKEN: ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–ã‚Šå‡ºã—ã€èªè¨¼ãƒ•ã‚©ãƒ¼ãƒ ã®inputã‚¿ã‚°ã®hiddenå±æ€§ã«å‰²ã‚Šå½“ã¦ã‚‹ã€‚ä»–ã«ã€metaã‚¿ã‚°ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ \"> \"> èªè¨¼ã®ãŸã‚ã®POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‚„ç‹¬è‡ªãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰²ã‚Šå½“ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ã©ã¡ã‚‰ã‚’ç”¨ã„ã‚‹ã‹ã¯ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®ä»•æ§˜ã«ã‚ˆã£ã¦ç•°ãªã‚‹ã€‚ POST https://example.co.jp/bar-form.php HTTP/2 # ç‹¬è‡ªãƒ˜ãƒƒãƒ€ãƒ¼ x-csrf-token: { _token= } ã‚µãƒ¼ãƒå´ã§ã¯ã€POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã‚ˆã£ã¦é€ä¿¡ã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã¨ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¯”è¼ƒã—ã€èªè¨¼ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ä»¥é™ã€POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã¯ãã®ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ã„å›ã—ã€GETãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã¯ä½¿ç”¨ã—ãªã„ã€‚ãƒˆãƒ¼ã‚¯ãƒ³ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚Œã°ã€èª¤ã£ãŸå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ã—ã¦åˆ¤å®šã—ã€401ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿”å´ã™ã‚‹ã€‚ å‚è€ƒï¼š https://terasolunaorg.github.io/guideline/5.2.0.RELEASE/ja/Security/CSRF.html#spring-securitycsrf https://qiita.com/Nsystem/questions/1bd6d30748957e1b6700 https://qiita.com/mpyw/items/0595f07736cfa5b1f50c#%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E3%81%AE%E7%94%9F%E6%88%90%E6%96%B9%E6%B3%95 ãƒ»ã€å¯¾ç­–ã€‘CORS XSSã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆ ã‚»ãƒƒã‚·ãƒ§ãƒ³IDå›ºå®šåŒ– ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³IDå›ºå®šåŒ–ã¨ã¯ å‚è€ƒï¼šhttps://www.ipa.go.jp/security/vuln/websecurity-HTML-1_4.html Directory traversal ãƒ»Directory traversalã¨ã¯ traversalã¯ã€æ¨ªæ–­ã™ã‚‹ï¼ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ§‹é€ ã‚’ä¹—ã‚Šè¶Šãˆã‚‹ï¼‰ã®æ„å‘³ã€‚ãƒ‘ã‚¹åã‚’ä½¿ã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã€ç®¡ç†è€…ã®æ„å›³ã—ã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸æ­£ã«é–²è¦§ã¾ãŸã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚ DoSæ”»æ’ƒï¼šDenial of Service ãƒ»DoSæ”»æ’ƒã€DDosæ”»æ’ƒã¨ã¯ ã‚¢ã‚¯ã‚»ã‚¹ãŒé›†ä¸­ã™ã‚‹ã“ã¨ã§Webã‚µãƒ¼ãƒãƒ¼ãŒãƒ‘ãƒ³ã‚¯ã™ã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã€æ‚ªæ„ã‚’æŒã£ã¦Webã‚µãƒ¼ãƒãƒ¼ã«å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’é€ã‚Šã¤ã‘ã‚‹æ‰‹æ³•ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡å…ƒãŒä¸€ã¤ã®å ´åˆã¯Dosæ”»æ’ƒã€è¤‡æ•°ã®å ´åˆã¯DDosæ”»æ’ƒã¨ã„ã†ã€‚ ãƒ»ã€å¯¾ç­–ã€‘POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°åˆ¶é™ php.iniãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ä¸€åº¦ã«å—ä¿¡ã§ãã‚‹POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ä¸Šé™å€¤ã‚’è¨­å®šã§ãã‚‹ã€‚ max_input_vars = 1000 ãƒ»ã€å¯¾ç­–ã€‘åŒä¸€é€ä¿¡å…ƒã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™ åŒã˜é€ä¿¡å…ƒã‹ã‚‰ã®ä¸€åˆ†é–“ã‚ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚’åˆ¶é™ã™ã‚‹ã€‚ä¾‹ãˆã°ã€WAFã€API Gatewayã®æ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws.html SQL Injection ãƒ»SQL Injectionã¨ã¯ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®SQLã‚¯ã‚¨ãƒªã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãªã‚‹å…¥åŠ›ã«ã€ä¸æ­£ãªæ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦ä¸æ­£ãªSQLã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã•ã›ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æƒ…å ±ã‚’æŠœãå–ã‚‹æ‰‹æ³•ã€‚ãŸã ã—ã€è¿‘å¹´ã¯æ¸›å°‘å‚¾å‘ã«ã‚ã‚‹ã€‚ ãƒ»ã€å¯¾ç­–ã€‘ç‰¹æ®Šãªæ–‡å­—ã®ç„¡åŠ¹åŒ– ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®SQLã‚¯ã‚¨ãƒªã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãªã‚‹å…¥åŠ›ã§ã¯ã€ã€ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚„ã€ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã€ãªã©ã¯SQLã§ç‰¹åˆ¥ãªæ„å‘³ã‚’æŒã¤ã€‚ãã®ãŸã‚ã€ã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ‹’å¦ã™ã‚‹ã€‚ä¾‹ãˆã°ã€WAFã®æ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/waf/latest/developerguide/aws-managed-rule-groups-list.html ãƒ»ã€å¯¾ç­–ã€‘ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ ãƒ—ãƒªãƒšã‚¢ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®SQLä¸­ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã€å€¤ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«æ¸¡ã—ãŸä¸Šã§ã€SQLã¨ã—ã¦ç™ºè¡Œã™ã‚‹æ–¹æ³•ã€‚å‡¦ç†é€Ÿåº¦ãŒé€Ÿã„ã€‚ã¾ãŸã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«èª¤ã£ã¦SQLãŒæ¸¡ã•ã‚Œã¦ã‚‚ã€ã“ã‚Œã‚’å®Ÿè¡Œã§ããªããªã‚‹ãŸã‚ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å¯¾ç­–ã«ãªã‚‹ã€‚ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_package_mysql.html XSSï¼šCross Site Scripting ãƒ»XSSã¨ã¯ Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹HTMLå‡ºåŠ›ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å‡¦ç†ã®æ¬ é™¥ã‚’æ‚ªç”¨ã—ã€åˆ©ç”¨è€…ã®Webãƒ–ãƒ©ã‚¦ã‚¶ã§æ‚ªæ„ã®ã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ ã€‚ ãƒ»ã€å¯¾ç­–ã€‘CORSï¼šCross-Origin Resource Sharingï¼ˆã‚ªãƒªã‚¸ãƒ³é–“ãƒªã‚½ãƒ¼ã‚¹å…±æœ‰ï¼‰ ç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã§è¡¨ç¤ºã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã™ã‚‹ä»•çµ„ã¿ã®ã“ã¨ã€‚æ¨™æº–ã§ã¯ã€ç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã§è¡¨ç¤ºã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯æ‹’å¦ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚ç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã§è¡¨ç¤ºã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã—ãŸã„å ´åˆã¯ã€ãƒšãƒ¼ã‚¸ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã‚µãƒ¼ãƒã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä¸¡æ–¹ã§å¯¾å¿œãŒå¿…è¦ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Glossary/Origin ï¼Šå®Ÿè£…ä¾‹ï¼Š ã¾ãšã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®Originãƒ˜ãƒƒãƒ€ãƒ¼ã«é€ä¿¡å…ƒã‚ªãƒªã‚¸ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚åŠ ãˆã¦ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ãŸã„å ´åˆã¯ã€JavaScriptã®å®Ÿè£…ã§withCredentialsã«trueã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚JavaScriptã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã£ã¦ã‚ªãƒ—ã‚·ãƒ§ãƒ³åãŒç•°ãªã‚‹ãŸã‚æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/tomoyukilabs/items/81698edd5812ff6acb34#%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AB%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%82%92%E8%A8%B1%E5%8F%AF%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88 GET https://foo.com/bar HTTP/2 # é€ä¿¡å…ƒã‚ªãƒªã‚¸ãƒ³ Origin: https://example.com import axios from 'axios' const client = axios.create({ baseURL: \"https://foo.co.jp\", withCredentials: true, // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹åŒ– }) return new Promise((resolve, reject) => { client.get('/bar') .then((data) => { resolve(data) }) .catch((err) => { reject(err) }) }) æ¬¡ã«ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®Access-Control-Allow-Originãƒ˜ãƒƒãƒ€ãƒ¼ã«ã€è¨±å¯ã•ã‚ŒãŸé€ä¿¡å…ƒã‚ªãƒªã‚¸ãƒ³ã‚’å‰²ã‚Šå½“ã¦ã¦è¿”ä¿¡ã™ã‚‹ã€‚Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨±å¯ã™ã‚‹å ´åˆã€åŒã˜ããƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®Access-Control-Allow-Credentialsãƒ˜ãƒƒãƒ€ãƒ¼ã«trueã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ãã®ä»–ã€è¨±å¯ã™ã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚„HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å®šç¾©ã§ãã‚‹ã€‚ä¾‹ãˆã°ã€è¨±å¯ã•ã‚Œã¦ã„ãªã„HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€ç•°ãªã‚‹ã‚ªãƒªã‚¸ãƒ³ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã¨ã€405ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ä¿¡ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials https://stackoverflow.com/questions/24687313/what-exactly-does-the-access-control-allow-credentials-header-do 200 OK # è¨±å¯ã•ã‚ŒãŸé€ä¿¡å…ƒã‚ªãƒªã‚¸ãƒ³ Access-Control-Allow-Origin: https://example.co.jp # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒCookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ã“ã¨ã‚’è¨±å¯ã™ã‚‹å ´åˆ Access-Control-Allow-Credentials: true # è¨±å¯ã™ã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ Access-Control-Allow-Methods: GET,POST,HEAD,OPTIONS # ãã®ä»–ã€è¨±å¯ã™ã‚‹HTTPãƒ˜ãƒƒãƒ€ãƒ¼ Access-Control-Allow-Headers: Content-Type ã¡ãªã¿ã«ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨±å¯ã—ãªã„å ´åˆã«é™ã‚Šã€å…¨ã¦ã®ã‚ªãƒªã‚¸ãƒ³ã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨±å¯ã§ãã‚‹ã€‚ 200 OK # å…¨ã¦ã®ã‚ªãƒªã‚¸ãƒ³ã‚’è¨±å¯ Access-Control-Allow-Origin: * Access-Control-Allow-Headers: * ãƒ»ã€å¯¾ç­–ã€‘Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®Domainå±æ€§ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒCookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ã“ã¨ã‚’è¨±å¯ã—ãŸå ´åˆã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚ªãƒªã‚¸ãƒ³ã«ã‚‚Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¶å¾¡ã§ãã‚‹ã€‚ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«ã¦ã€Domainå±æ€§ã«ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒå‰²ã‚Šå½“ã¦ãªã‹ã£ãŸå ´åˆã¯ã€ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã‚µãƒ¼ãƒã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã®ã¿Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã§ãã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã¸ã®é€ä¿¡ã‚’æ‹’å¦ã§ãã‚‹ã€‚ä¸€æ–¹ã§ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒå‰²ã‚Šå½“ã¦ãŸå ´åˆã¯ã€ãã®ãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å¯¾ã—ã¦ã‚‚ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã§ãã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ã¯ãªãã€ã‚ªãƒªã‚¸ãƒ³ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼š https://zenn.dev/agektmr/articles/f8dcd345a88c97 https://azisava.sakura.ne.jp/programming/0017.html#sec4-1 ï¼Šå®Ÿè£…ä¾‹ï¼Š Domainå±æ€§ã«example.co.jpãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ãŸã¨ã™ã‚‹ã€‚æœ€åˆã«ãƒ‰ãƒƒãƒˆãŒã¤ã„ã¦ã„ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ.example.co.jpï¼‰ã§ã‚‚ã€åŒã˜å€¤ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ã€‚ã“ã®å ´åˆã€example.co.jpã«åŠ ãˆã¦ã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆfoo.example.co.jpï¼‰ã«å¯¾ã—ã¦ã‚‚ã€Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã§ãã‚‹ã€‚ 200 OK Set-Cookie: domain=example.co.jp POST http://foo.example.co.jp/bar-form.php HTTP/2 # é€ä¿¡å…ƒã‚ªãƒªã‚¸ãƒ³ Origin: http://example.co.jp Cookie: sessionid=; csrftoken= ãƒ»ã€å¯¾ç­–ã€‘Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®HttpOnlyå±æ€§ ã“ã‚Œã‚’æœ‰åŠ¹åŒ–ã—ãŸå ´åˆã€Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«HttpOnlyå±æ€§ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚JavaScriptã‹ã‚‰Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªãã§ãã‚‹ã€‚ 200 OK Set-Cookie: HttpOnly ãƒ»ã€å¯¾ç­–ã€‘Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®sameSiteå±æ€§ ç¨®é¡ èª¬æ˜ None ç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸå…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒCookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ Lax ç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸä¸€éƒ¨ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒCookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ Strict ç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸå…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒCookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã€‚ ç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒCookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒã¤ã“ã¨ã‚’è¨±å¯ï¼æ‹’å¦ã™ã‚‹ã€‚ã“ã“ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’åˆ¶å¾¡ã—ã¦ã„ã‚‹ã®ã¯ã€ã‚ªãƒªã‚¸ãƒ³ã§ã¯ãªãã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://zenn.dev/agektmr/articles/f8dcd345a88c97 200 OK Set-Cookie: SameSite=None ãƒ»ã€å¯¾ç­–ã€‘Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®Secureå±æ€§ ã“ã‚Œã‚’æœ‰åŠ¹åŒ–ã—ãŸå ´åˆã€Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«Secureå±æ€§ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚HTTPSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ãŸå ´åˆã®ã¿ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ 200 OK Set-Cookie: Secure ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆæ”»æ’ƒ ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆæ”»æ’ƒã¨ã¯ æ¼æ´©ã—ãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã€æ­£é¢ã‹ã‚‰æ­£ã€…å ‚ã€…ã¨ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ‰‹æ³•ã€‚ Brute-forceæ”»æ’ƒã¨Reverse Brute-forceæ”»æ’ƒ ãƒ»Brute-forceæ”»æ’ƒã¨Reverse Brute-forceæ”»æ’ƒã¨ã¯ Brute-forceã¯åŠ›ãšãã®æ„å‘³ã€‚IDã‚’å›ºå®šã—ã¦ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç·å½“ãŸã‚Šã§è©¦ã™æ‰‹æ³•ã€‚ä¾‹ãˆã°ã€5æ¡æ•°å­—ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã‚‰ã€9ã®5ä¹—é€šã‚Šã®çµ„ã¿åˆã‚ã›ã‚’è©¦ã™ã€‚ä¸€æ–¹ã§ã€Reverse Brute-forceã¯ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å›ºå®šã—ã¦ã€IDã‚’ç·å½“ãŸã‚Šã§è©¦ã™æ‰‹æ³•ã€‚ ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•° ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼æ”»æ’ƒ ãƒ»ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼æ”»æ’ƒã¨ã¯ ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ–‡å­—åˆ—ã¨ãƒãƒƒã‚·ãƒ¥å€¤ã®å¯¾å¿œé–¢ä¿‚ã‚’å…ƒã«ã—ã¦ã€ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸæš—å·ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¨æ¸¬ã™ã‚‹æ‰‹æ³•ã€‚ ãƒ»ã€å¯¾ç­–ã€‘BCryptã«ã‚ˆã‚‹ãƒãƒƒã‚·ãƒ¥åŒ– BCryptã‚’ç”¨ã„ã¦ã€Blowfishæ–¹å¼ã«åŸºã¥ãæš—å·åŒ–ã‚’å®Ÿè¡Œã™ã‚‹ã€‚Blowfishæ–¹å¼ã§ã¯ã€åŒã˜ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æ–‡å­—åˆ—ã§ã‚ã£ã¦ã‚‚ç•°ãªã‚‹ãƒãƒƒã‚·ãƒ¥å€¤ãŒç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼æ”»æ’ƒã‚’é˜²ã’ã‚‹ã€‚Blowfishæ–¹å¼ã§ç”Ÿæˆã•ã‚ŒãŸãƒãƒƒã‚·ãƒ¥å€¤ã¯ã€ç•°ãªã‚‹ãƒ«ãƒ¼ãƒ«ã§ç”Ÿæˆã•ã‚ŒãŸè¤‡æ•°ã®ãƒãƒƒã‚·ãƒ¥å€¤ã®çµ„ã¿åˆã‚ã›ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://medium-company.com/%E3%82%B9%E3%83%88%E3%83%AC%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0/ https://medium-company.com/bcrypt/ # + + + $2y$10$1QVmWNzk.TsaZQLQ/zeI9OAZL02AWP.VdFPPyAc9hSc2Cp4yOXKtG æ–‡å­—åˆ— èª¬æ˜ $2y$ï¼ˆ4æ–‡å­—ï¼‰ æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ã™ã€‚ä»–ã«ã€2ã€2aã€2bã€2xãŒã‚ã‚‹ã€‚ $10$ï¼ˆ4æ–‡å­—ï¼‰ ã‚¹ãƒˆãƒ¬ãƒƒãƒãƒ³ã‚°ï¼ˆãƒãƒƒã‚·ãƒ¥åŒ–ã®åå¾©ï¼‰ã®å›æ•°ã‚’è¡¨ã™ã€‚10ã¨ã—ãŸå ´åˆã¯ã€2^10å›åå¾©ã§ãƒãƒƒã‚·ãƒ¥åŒ–ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ 1QVmWNzk.TsaZQLQ/zeI9Oï¼ˆ22æ–‡å­—ï¼‰ ã‚½ãƒ«ãƒˆï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ï¼‰ã‚’è¡¨ã™ã€‚ AZL02AWP.VdFPPyAc9hSc2Cp4yOXKtGï¼ˆ31æ–‡å­—ï¼‰ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãã®ã‚‚ã®ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¡¨ã™ã€‚ 04. ãã®ä»–ã®ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒ ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚° ãƒ»ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã¨ã¯ æŠ€è¡“çš„ãªæ‰‹æ³•ã§ã¯ãªãã€ç‰©ç†çš„ãªæ‰‹æ³•ï¼ˆç›—ã¿è¦‹ã€ç›—ã¿èãã€æˆã‚Šã™ã¾ã—ã€è©æ¬ºãªã©ï¼‰ã«ã‚ˆã£ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ‰‹æ³•ã€‚ è¸ã¿å°æ”»æ’ƒ ãƒ»è¸ã¿å°æ”»æ’ƒã¨ã¯ å¯¾è±¡ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå†…ã®ãƒ‘ã‚½ã‚³ãƒ³ã«æ”»æ’ƒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä»•è¾¼ã‚“ã§ç½®ãã€æ”»æ’ƒè€…ã‹ã‚‰ã®å‘½ä»¤ã§ã‚µãƒ¼ãƒã‚’æ”»æ’ƒã•ã›ã‚‹æ‰‹æ³•ï¼ˆâ€»ãƒœãƒƒãƒˆã‚’ç”¨ã„ãŸæ”»æ’ƒãªã©ï¼‰ ãƒ»ãƒ‘ã‚½ã‚³ãƒ³ãŒãƒœãƒƒãƒˆåŒ–ã™ã‚‹ã¾ã§ã®ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆå†æ²ï¼‰ ãƒ»ã‚¹ãƒãƒ›ãŒãƒœãƒƒãƒˆåŒ–ã™ã‚‹ã¾ã§ã®ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆå†æ²ï¼‰ ãƒ»Bot ã®ä½¿ã‚ã‚Œæ–¹ï¼ˆå†æ²ï¼‰ DNS Cache Poisoning ãƒ»DNS Cache Poisoningã¨ã¯ ã‚­ãƒ£ãƒƒã‚·ãƒ¥DNSã‚µãƒ¼ãƒãƒ¼ãŒã‚‚ã¤IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å½ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰ãˆã€å½ã®Webã‚µã‚¤ãƒˆã«å¼·åˆ¶çš„ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã›ã‚‹æ‰‹æ³•ã€‚ Back Door ãƒ»Back Doorã¨ã¯ ä¾‹ãˆã°ã€Webã‚µã‚¤ãƒˆã®ã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆç”»é¢ã‚„ã‚µãƒ¼ãƒã«æ½œã¾ã›ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã‚«ãƒ¼ãƒ‰æƒ…å ±ã‚’ç¬¬ä¸‰è€…ã«é€ä¿¡ã™ã‚‹æ‰‹æ³•ã€‚ "},"public/security/security_encryption_technology.html":{"url":"public/security/security_encryption_technology.html","title":"ğŸ“– ï¸é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–æŠ€è¡“","keywords":"","body":"é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–æŠ€è¡“ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’æš—å·åŒ–ã™ã‚‹ç›®çš„ ç›—è´ï¼ˆé€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®ç›—ã¿å–ã‚Šï¼‰ã‚’é˜²ããŸã‚ ã€å…±é€šéµæš—å·æ–¹å¼ã€ã‚„ã€å…¬é–‹éµæš—å·æ–¹å¼ã€ã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã‚‹ã€‚æš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«åŸºã¥ãæš—å·æ–¹å¼ã‚’ç”¨ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æš—å·åŒ–ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®ç›—è´ã‚’é˜²ãã€‚ æ”¹ç«„ï¼ˆé€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãæ›ãˆï¼‰ã‚’é˜²ããŸã‚ ã€ãƒ‡ã‚¸ã‚¿ãƒ«ç½²åã€ã‚„ã€ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã€ã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã‚‹ã€‚ç›¸æ‰‹ã«é€ã£ãŸãƒ‡ãƒ¼ã‚¿ã¨ç›¸æ‰‹ãŒå—ã‘å–ã£ãŸãƒ‡ãƒ¼ã‚¿ãŒåŒã˜ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®æ”¹ç«„ã‚’é˜²ãã€‚ æˆã‚Šã™ã¾ã—ã‚’é˜²ããŸã‚ ã€ãƒ‡ã‚¸ã‚¿ãƒ«ç½²åã€ã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã‚‹ã€‚æ­£ã—ã„ç›¸æ‰‹ã§ã‚ã‚‹ã“ã¨ã‚’è¨¼æ˜ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€æˆã‚Šã™ã¾ã—ã‚’é˜²ãã€‚ 01-02. æš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–ã®ã»ã¨ã‚“ã©ã¯ã€ã€å…±é€šéµæš—å·æ–¹å¼ã€ã‚„ã€å…¬é–‹éµæš—å·æ–¹å¼ã€ã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã‚‹ã€‚ãã‚Œã‚‰ã®æ–¹å¼ã¯ã€ä»¥ä¸‹ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹ã€‚ å…±é€šéµæš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  å…±é€šéµæš—å·æ–¹å¼ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ãƒ»DES æš—å·ï¼šData Encryption Standard ãƒ»AES æš—å·ï¼šAdvanced Encryption Standard å…¬é–‹éµæš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  å…¬é–‹éµæš—å·æ–¹å¼ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ãƒ»RSA æš—å·ï¼šRivest-Shamir-Adleman cryptosystem 01-03. æš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«åŸºã¥ãæš—å·æ–¹å¼ æš—å·æ–¹å¼ã®ç¨®é¡ä¸€è¦§ å…±é€šéµæš—å·æ–¹å¼ å…¬é–‹éµæš—å·æ–¹å¼ æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  å…±é€šéµæš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  å…¬é–‹éµæš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç¨®é¡ RC4ã€DESã€3DESã€AES RSAã€ElGamal æš—å·åŒ–ã«è¦ã™ã‚‹æ™‚é–“ ã‚ˆã‚ŠçŸ­ã„ ã‚ˆã‚Šé•·ã„ ç”Ÿæˆã•ã‚Œã‚‹æš—å·éµ å…±é€šéµ ç§˜å¯†éµã€å…¬é–‹éµ éµã®é…å¸ƒæ–¹æ³• ãƒ¡ãƒ¼ãƒ«ï¼ˆç›—è´ã«æ°—ã‚’ä»˜ã‘ã‚‹ï¼‰ ãƒ¡ãƒ¼ãƒ«ã€PKI éµã®å†åˆ©ç”¨ å†åˆ©ç”¨ã™ã‚‹ã¹ãã§ã¯ãªã„ å†åˆ©ç”¨ã—ã¦ã‚‚ã‚ˆã„ å…±é€šéµæš—å·æ–¹å¼ ãƒ»å…±é€šéµæš—å·æ–¹å¼ã¨ã¯ ã‚µãƒ¼ãƒã‹ã‚‰å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã«ã‚ã‚‰ã‹ã˜ã‚ç§˜å¯†éµã‚’æ¸¡ã—ã¦ãŠãã€‚éµã®å—ã‘æ¸¡ã—ã‚’å·¥å¤«ã—ãªã„ã¨ã€å…±é€šéµãŒç›—è´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼ˆéµé…é€å•é¡Œï¼‰ã€‚ ï¼Šä¾‹ï¼Š ã‚¨ã‚¯ã‚»ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒƒã‚¯ é•·æ‰€ï¼šå‡¦ç†ãŒé€Ÿã„ çŸ­æ‰€ï¼šéµã®é…å¸ƒãŒå¤§å¤‰ ãƒ»å…±é€šéµã®å†åˆ©ç”¨ã®å¯å¦ å„å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã¯ã€ã‚µãƒ¼ãƒã‹ã‚‰ã€å—ä¿¡è€…ã”ã¨ã«ç”Ÿæˆã•ã‚ŒãŸå…±é€šéµã‚’ã‚‚ã‚‰ã†ã€‚éµã®å†åˆ©ç”¨ã‚’ã™ã‚‹ã¹ãã§ã¯ãªã„ã€‚ å…¬é–‹éµæš—å·æ–¹å¼ ãƒ»å…¬é–‹éµæš—å·æ–¹å¼ã¨ã¯ å…¬é–‹éµæš—å·æ–¹å¼ã§ã‚‚è¨˜è¼‰ã®é€šã‚Šã€å…±é€šéµæš—å·æ–¹å¼ã®éµé…é€å•é¡Œã‚’è§£æ±ºã™ã¹ãé–‹ç™ºã•ã‚ŒãŸã€‚ã€RSAæš—å·ã€ãªã©ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã‚‹ã€‚å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã®å…¬é–‹éµã§æš—å·åŒ–ã—ãŸå ´åˆã€å—ä¿¡è€…ã®ç§˜å¯†éµã§ã®ã¿å¾©å·å¯èƒ½ã€‚ã™ãªã‚ã¡ã€ç¬¬ä¸‰è€…ã«å¾©å·ï¼ˆè§£èª­ï¼‰ã•ã‚Œã‚‹ã“ã¨ã¯ãªã„ã¨åˆ¤æ–­å¯èƒ½ã€‚ ï¼Šã‚µãƒ¼ãƒãŒè¡Œã†ã“ã¨ï¼Š ã‚µãƒ¼ãƒã¯ã€å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã‹ã‚‰å…¬é–‹éµã‚’ã‚‚ã‚‰ã†ã€‚ å…¬é–‹éµã‚’ç”¨ã„ã¦ã€æƒ…å ±ã‚’æš—å·åŒ–ã™ã‚‹ã€‚ ï¼Šå—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ãŒè¡Œã†ã“ã¨ï¼Š å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã¯ã€ç§˜å¯†éµã§æƒ…å ±ã‚’å¾©å·ã™ã‚‹ã€‚ ãƒ»å…¬é–‹éµã®å†åˆ©ç”¨ã®å¯å¦ å„å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã¯ã€ã‚µãƒ¼ãƒã‹ã‚‰ã€ç•°ãªã‚‹ã‚µãƒ¼ãƒã§å†åˆ©ç”¨ã•ã‚Œã‚‹å…¬é–‹éµã‚’ã‚‚ã‚‰ã†ã€‚ãŸã ã—ã€ã‚µãƒ¼ãƒã”ã¨ã«ç•°ãªã‚‹ç§˜å¯†éµã¨å…¬é–‹éµã‚’ç”¨ã„ã¦ã‚‚ã‚ˆã„ã€‚ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æš—å·æ–¹å¼ å…±é€šéµæš—å·æ–¹å¼ã¨å…¬é–‹éµæš—å·æ–¹å¼ã‚’çµ„ã¿åˆã‚ã›ãŸæš—å·æ–¹å¼ã€‚ä¸¡æ–¹ã®æ–¹å¼ã®é•·æ‰€ã¨çŸ­æ‰€ã‚’è£œã†ã€‚ 02. æš—å·åŒ–æ–¹å¼ã«åŸºã¥ãã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ« ã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ç¨®é¡ã¨æ‰±ã‚ã‚Œã‚‹éšå±¤ ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã—ã¦ã®æš—å·åŒ–æŠ€è¡“ã§ã‚ã‚‹ã€ã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€ã¯ã€èµ¤è‰²ã§ç¤ºã—ã¦ã‚ã‚‹ã€‚ ã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§æ‰±ã‚ã‚Œã‚‹é€šä¿¡ãƒ‡ãƒ¼ã‚¿ ãƒ»é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡ Webã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ‡ãƒ¼ã‚¿ã€ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã€ãã®ä»– ãƒ»é€šä¿¡ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆã€ãƒ˜ãƒƒãƒ€æƒ…å ±è¿½åŠ ã€ã‚«ãƒ—ã‚»ãƒ«åŒ– ãƒ‘ã‚±ãƒƒãƒˆäº¤æ›æ–¹å¼ã«ãŠã‘ã‚‹ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã¯ã€ãƒ‘ã‚½ã‚³ãƒ³ã®å„æ¦‚å¿µå±¤ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«ã‚ˆã£ã¦è¿½åŠ ã•ã‚Œã¦ã„ãã€‚ 02-02. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã«ãŠã‘ã‚‹ãƒ¡ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–æŠ€è¡“ S/MIMEï¼šSecure MIME ãƒ»S/MINEã¨ã¯ æš—å·åŒ–ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’å«ã‚€ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã‚’ãƒ¡ãƒ¼ãƒ«ã«æ·»ä»˜ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å…¬é–‹éµã®æˆã‚Šã™ã¾ã—ã‚’é˜²ãã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æŠ€è¡“ã€‚ ãƒ»S/MIMEã«ãŠã‘ã‚‹ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã‚’S/MIMEã«ç”¨ã„ã‚‹å ´åˆã€ç‰¹ã«S/MIMEè¨¼æ˜æ›¸ã¨ã„ã†ã€‚è©³ã—ãã¯ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’å‚ç…§ã€‚ 02-03. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã«ãŠã‘ã‚‹ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šï¼æ“ä½œã‚„ãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ã®æš—å·åŒ–æŠ€è¡“ SSHï¼šSecure Shell ãƒ»SSHã¨ã¯ å…¬é–‹éµæš—å·æ–¹å¼ã«åŸºã¥ãã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚å…¬é–‹éµæš—å·æ–¹å¼ã¨ã€å…¬é–‹éµèªè¨¼æ–¹å¼ã‚„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼æ–¹å¼ã®æŠ€è¡“ã‚’ç”¨ã„ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’çµŒç”±ã—ã¦ã€ã‚µãƒ¼ãƒã®ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šï¼æ“ä½œã‚’è¡Œã†ã€‚ç‰©ç†Webã‚µãƒ¼ãƒã§ã‚ã£ã¦ã‚‚ã€ä»®æƒ³Webã‚µãƒ¼ãƒã§ã‚ã£ã¦ã‚‚ã€SSHã«ã‚ˆã‚‹ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šï¼æ“ä½œã®ä»•çµ„ã¿ã¯åŒã˜ã§ã‚ã‚‹ã€‚ ãƒ»SSHæ¥ç¶šï¼æ“ä½œã™ã‚‹å´ã«å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ ã€OpenSSHã€ã€ã€TeraTermã€ã€ã€Puttyã€ãŒã‚ã‚‹ã€‚ ãƒ»SSHæ¥ç¶šï¼æ“ä½œã•ã‚Œã‚‹å´ã«å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ ã€OpenSSHã€ã€ã€Apache MINA/SSHDã€ ãƒ»SSHãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆSSHãƒãƒ¼ãƒˆè»¢é€ï¼‰ ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒã¨è¸ã¿å°ã‚µãƒ¼ãƒã®SSHæ¥ç¶šã¨ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é–“æ¥çš„ã«é€šä¿¡ã‚’è¡Œã†æ–¹æ³•ã€‚ ï¼Šä¾‹ï¼Š è¸ã¿å°ã‚µãƒ¼ãƒï¼ˆä¾‹ï¼šEC2ï¼‰ã‚’ç”¨ã„ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒï¼ˆä¾‹ï¼šè‡ªèº«ã®ãƒ‘ã‚½ã‚³ãƒ³ï¼‰ã®20000ç•ªãƒãƒ¼ãƒˆãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã€ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒï¼ˆä¾‹ï¼šRDSï¼‰ã®3306ç•ªãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚DBMSã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚½ãƒ•ãƒˆã§ã¯ã€ãƒªãƒ¢ãƒ¼ãƒˆã«ã‚ã‚‹DBã‚µãƒ¼ãƒã«æ¥ç¶šã™ã‚‹ãŸã‚ã«ã€ã“ã®ä»•çµ„ã¿ãŒã‚ˆãç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ # ãƒ­ãƒ¼ã‚«ãƒ«ã®20000ç•ªãƒãƒ¼ãƒˆãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã™ã‚‹é€šä¿¡ã‚’ã€RDSã®3306ç•ªãƒãƒ¼ãƒˆã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è»¢é€ã€‚ [local pc] $ ssh -L20000:xxxx.rds.amazonaws.com:3306 username@fumidai.com ï¼Šä¾‹ï¼Š ã“ã®ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒãŒä»®æƒ³ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®å ´åˆã‚‚ã‚ã‚Šã€ãƒ›ã‚¹ãƒˆOSã¨ä»®æƒ³ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®æ¥ç¶šã§ã‚‚SSHãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ãƒ›ã‚¹ãƒˆå¤–éƒ¨ã®ãƒ‘ã‚½ã‚³ãƒ³ã‹ã‚‰ã€ãƒ›ã‚¹ãƒˆOSä¸Šã®ä»®æƒ³ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã—ãŸã„å ´åˆã€SSHãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ›ã‚¹ãƒˆOSã‚’è¸ã¿å°ã¨ã—ãŸä»®æƒ³ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã¸ã®æ¥ç¶šãŒè¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ SCPï¼šSecure Copy Protocol ãƒ»SCPã¨ã¯ SSHã‚’ä»‹ã—ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ã‚’è¡Œã†ã€‚SSHã®æ©Ÿèƒ½ã‚’ã‚ˆã‚Šæ‹¡å¼µã—ãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šå…ˆã®ã‚µãƒ¼ãƒã«ãƒ•ã‚¡ã‚¤ãƒ«é€ä¿¡ã‚’å‘½ä»¤ã™ã‚‹ã€‚ ã‚µãƒ¼ãƒã¯ã€Shellã‚’ç”¨ã„ã¦SCPãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’èµ·å‹•ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€ä¿¡ã™ã‚‹ã€‚ ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦æ±‚ã™ã‚‹å´ã«å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ ã€WinSCPã€ã€ã€Filezillaã€ ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€ä¿¡ã™ã‚‹å´ã«å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ SFTPï¼šSSH File Transfer Protocol ãƒ»SFTPã¨ã¯ SSHã‚’ä»‹ã—ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ã‚’è¡Œã†ã€‚SSHã¨FTPã‚’çµ„ã¿åˆã‚ã›ãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã¯ãªãã€SSHã®æ©Ÿèƒ½ã‚’ã‚ˆã‚Šæ‹¡å¼µã—ãŸã‚‚ã®ã§ã‚ã‚‹ã€‚ ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«è¦æ±‚å´ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ ã€WinSCPã€ã€ã€Filezillaã€ ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«é€ä¿¡å´ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ 02-04. ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ã«ãŠã‘ã‚‹ãƒ˜ãƒƒãƒ€æƒ…å ±ã®æš—å·åŒ–æŠ€è¡“ SSL/TLSï¼šSecure Sockets Layer / Transport Layer Security ãƒ»SSL/TLSã¨ã¯ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æš—å·æ–¹å¼ã«åŸºã¥ãã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ã§ã€ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã®æš—å·åŒ–ã‚’æ‹…ã†ã€‚å…·ä½“çš„ã«ã¯ã€HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€GETé€ä¿¡ã®ãƒ˜ãƒƒãƒ€éƒ¨åˆ†ã€ã¾ãŸPOSTé€ä¿¡ã®ãƒ˜ãƒƒãƒ€éƒ¨åˆ†ã¨ãƒœãƒ‡ã‚£éƒ¨åˆ†ã‚’æš—å·åŒ–ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š Chromeã§ã¯ã€HTTPSã«ãŠã„ã¦ã€SSLè¨¼æ˜æ›¸ã«ä¸å‚™ãŒã‚ã‚‹ï¼ˆä¾‹ãˆã°ã€ã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸ã‚’ç”¨ã„ã¦ã„ã‚‹ï¼‰ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚SSLè¨¼æ˜æ›¸ã«ã¤ã„ã¦ã¯ã€å…¬é–‹éµåŸºç›¤ã®èª¬æ˜ã‚’å‚ç…§ã›ã‚ˆã€‚ ãƒ»SSL/TLSã«ãŠã‘ã‚‹ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³èªè¨¼ ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã‚’SSLã«ç”¨ã„ã‚‹å ´åˆã€ç‰¹ã«SSLè¨¼æ˜æ›¸ã¨ã„ã†ã€‚æä¾›ã•ã‚Œã‚‹ç§˜å¯†éµã¨çµ„ã¿åˆã‚ã›ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã®èªè¨¼ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚è©³ã—ãã¯ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’å‚ç…§ã€‚ VPNï¼šVirtual Private Networkï¼ˆä»®æƒ³ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ ãƒ»VPNã¨ã¯ ç•°ãªã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ã§å®‰å…¨ãªé€šä¿¡ã‚’è¡Œã†ãŸã‚ã®ä»•çµ„ã¿ã€‚IPsecã‚„SSL/TLSã«ã‚ˆã£ã¦å®Ÿç¾ã•ã‚Œã‚‹ã€‚ ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆVPNã§ã®SSL/TLSé€šä¿¡ã®åˆ©ç”¨ VPNã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¨ã®SSL/TLSé€šä¿¡ã«ã‚ˆã£ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆVPNã‚’å®Ÿç¾ã§ãã‚‹ã€‚ 02-05. æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã«ã¤ã„ã¦ æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’ç”¨ã„ãŸæš—å·åŒ–æŠ€è¡“ ãƒ»æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã¨ã¯ ã€å…¬é–‹éµæš—å·æ–¹å¼ã¨ã¯é€†ã®ä»•çµ„ã¿ï¼ˆâ€»ã¤ã¾ã‚Šã€å…¬é–‹éµæš—å·æ–¹å¼ã§ã¯ãªã„ï¼‰ã€ã¨ã€ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã€ã‚’åˆ©ç”¨ã—ãŸæš—å·åŒ–ã€‚ã€æˆã‚Šã™ã¾ã—ã€ã¨ã€æ”¹ç«„ã€ã‚’é˜²ã’ã‚‹ã€‚ ï¼Šã‚µãƒ¼ãƒãŒè¡Œã†ã“ã¨ï¼Š ã‚µãƒ¼ãƒã¯ã€å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã«ã‚ã‚‰ã‹ã˜ã‚å…¬é–‹éµã‚’é…å¸ƒã—ã¦ãŠãã€‚ å¹³æ–‡ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã€ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã«ã™ã‚‹ã€‚ ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã‚’ç§˜å¯†éµã§æš—å·åŒ–ã—ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’ä½œæˆã™ã‚‹ã€‚ ã€å¹³æ–‡ã€ã€ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã€ã‚’é€ä¿¡ã™ã‚‹ã€‚ ï¼Šå—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ãŒè¡Œã†ã“ã¨ï¼Š å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã¯ã€ã€å¹³æ–‡ã€ã¨ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã€ã‚’å—ä¿¡ã™ã‚‹ã€‚ å¹³æ–‡ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã€ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã«ã™ã‚‹ã€‚ ä¸Šè¨˜ï¼’ã¤ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆãŒåŒä¸€ãªã‚‰ã€ã€æˆã‚Šã™ã¾ã—ã€ã¨ã€æ”¹ç«„ã€ãŒè¡Œã‚ã‚Œã¦ã„ãªã„ã¨åˆ¤æ–­ ãƒ»æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã®ãƒ¡ãƒªãƒƒãƒˆ 1ã€‚æ”¹ç«„ã‚’é˜²ã’ã‚‹ ã‚µãƒ¼ãƒã‹ã‚‰é€ã‚‰ã‚ŒãŸã€å¹³æ–‡ã€ã¨ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã€ã®ã©ã¡ã‚‰ã‹ãŒã€é€šä¿¡ã®é€”ä¸­ã§æ”¹ç«„ã•ã‚ŒãŸå ´åˆã€ã“ã‚Œã‚‰ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆãŒåŒã˜ã«ãªã‚‹ã“ã¨ã¯ç¢ºç‡çš„ã«ã‚ã‚Šãˆãªã„ã€‚ã—ãŸãŒã£ã¦ã€ç¢ºã‹ã«æ”¹ç«„ã•ã‚Œã¦ã„ãªã„ã¨åˆ¤æ–­å¯èƒ½ã€‚ 2ã€‚æˆã‚Šã™ã¾ã—ã‚’é˜²ã’ã‚‹ ç‰¹å®šã®ç§˜å¯†éµã‚’æŒã¤ã®ã¯ã€ç‰¹å®šã®ã‚µãƒ¼ãƒã ã‘ã€‚ã—ãŸãŒã£ã¦ã€ç¢ºã‹ã«ã‚µãƒ¼ãƒã«ã‚ˆã£ã¦æš—å·åŒ–ã•ã‚ŒãŸã‚‚ã®ã ã¨åˆ¤æ–­å¯èƒ½ã€‚ ãƒ»æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ â˜…â˜…å…¬é–‹éµã®æˆã‚Šã™ã¾ã—ã‚’é˜²ãã“ã¨ãŒã§ããªã„â˜…â˜… äºŒè€…é–“ã ã‘ã®ã‚„ã‚Šå–ã‚Šã§ã¯ã€ã‚ã‚‰ã‹ã˜ã‚å—ä¿¡è€…ã«æ¸¡ã•ã‚Œã‚‹å…¬é–‹éµãŒå½ã®é€ä¿¡è€…ã®ã‚‚ã®ã§ã‚ã£ã¦ã‚‚ã€ç¢ºã‹ã‚ã‚‹è¡“ãŒãªã„ã€‚ã“ã‚Œã‚’ä¿éšœã™ã‚‹ä»•çµ„ã¿ã«ã€PKIï¼ˆå…¬é–‹éµåŸºç›¤ï¼‰ãŒã‚ã‚‹ã€‚ æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã¨å…¬é–‹éµæš—å·æ–¹å¼ã‚’ç”¨ã„ãŸæš—å·åŒ–æŠ€è¡“ ã€æˆã‚Šã™ã¾ã—ã€ã¨ã€æ”¹ç«„ã€ã‚’é˜²ã’ã‚‹ãƒ‡ã‚¸ã‚¿ãƒ«ç½²åã«ã€ã€ç›—è´ã€ã‚’é˜²ã’ã‚‹å…¬é–‹éµæš—å·æ–¹å¼ã‚’çµ„ã¿è¾¼ã‚“ã æš—å·åŒ–æŠ€è¡“ã€‚ ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã«ã‚ˆã‚‹ãƒãƒƒã‚·ãƒ¥åŒ– ä½•ã‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€è¦å‰‡æ€§ã®ãªã„ä¸€å®šã®æ¡æ•°ã®å€¤ã‚’å‡ºåŠ›ã™ã‚‹æ¼”ç®—æ‰‹æ³•ã€‚ PKIï¼šPublic Key Infrastructureï¼ˆå…¬é–‹éµåŸºç›¤ï¼‰ã«ã‚ˆã‚‹å…¬é–‹éµã®æ¤œè¨¼ ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ­£å½“æ€§ã®æ¤œè¨¼ ç§˜å¯†éµã¨ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ­£å½“æ€§ï¼ˆå½ã‚µã‚¤ãƒˆã§ã¯ãªã„ã“ã¨ï¼‰ã‚’æ‹…ä¿ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚ãƒ‡ã‚¸ã‚¿ãƒ«ç½²åã«ç”¨ã„ãŸç§˜å¯†éµã«å¯¾å¿œã™ã‚‹å…¬é–‹éµã¯ã€æˆã‚Šã™ã¾ã—ãŸäººç‰©ã«ã‚ˆã‚‹å½ã®å…¬é–‹éµã§ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ç¬¬ä¸‰è€…æ©Ÿé–¢ã®èªè¨¼å±€ã«ã‚ˆã£ã¦ã€å…¬é–‹éµã‚’æ¤œè¨¼ã™ã‚‹ã‚¤ãƒ³ãƒ•ãƒ©ã®ã“ã¨ã‚’ã€å…¬é–‹éµåŸºç›¤ã¨ã„ã†ã€‚ ãƒ»å…¬é–‹éµã®æ¤œè¨¼ã®ä»•çµ„ã¿ å¤šãã®å ´åˆã€ã‚µãƒ¼ãƒã®æä¾›ä¼šç¤¾ãŒä¸­é–“èªè¨¼å±€ã‚’ã‚‚ã£ã¦ã„ã‚‹ã€‚ä¸­é–“èªè¨¼å±€ã¨ãƒ«ãƒ¼ãƒˆèªè¨¼å±€ã®é–¢ä¿‚ã«ã¤ã„ã¦ã¯ã€èªè¨¼å±€ãã®ã‚‚ã®ã®ãªã‚Šã™ã¾ã—ã®é˜²æ­¢ç­–ã‚’å‚ç…§ã€‚ ï¼Šä¾‹ï¼Š ã‚µãƒ¼ãƒæä¾›è€… è‡ªç¤¾ã®ä¸­é–“èªè¨¼å±€å ãƒ«ãƒ¼ãƒˆèªè¨¼å±€å AWS Amazon Trust Services Starfieldç¤¾ GCP Google Trust Services ï¼Šã‚µãƒ¼ãƒãŒè¡Œã†ã“ã¨ï¼Š ã‚µãƒ¼ãƒã¯ã€å…¬é–‹éµã¨ç§˜å¯†éµã‚’ä½œã‚Šã€èªè¨¼å±€ã«å…¬é–‹éµã¨ãƒ‡ã‚¸ã‚¿ãƒ«ç½²åã‚’æå‡ºã€‚ èªè¨¼å±€ã‹ã‚‰ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’å«ã‚€ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ï¼ˆS/MIMEè¨¼æ˜æ›¸ã€SSLè¨¼æ˜æ›¸ï¼‰ã‚’ç™ºè¡Œã—ã¦ã‚‚ã‚‰ã†ã€‚ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ãŒã€å…¬é–‹éµã®æœ¬äººè¨¼æ˜ã«ãªã‚‹ã€‚ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã¯ã€S/MIMEã§ç”¨ã„ã‚‹å ´åˆã«ã¯ã€ã€S/MIMEè¨¼æ˜æ›¸ã€ã€SSL/TLSã§ç”¨ã„ã‚‹å ´åˆã«ã¯ã€ã€SSLè¨¼æ˜æ›¸ã€ã¨ã„ã†ã€‚ å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã«ãƒ¡ãƒ¼ãƒ«ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’å«ã‚€ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã‚’é€ä¿¡ã€‚ ï¼Šå—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ãŒè¡Œã†ã“ã¨ï¼Š å—ä¿¡è€…ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã¯ã€æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰ã‚’å«ã‚€ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ï¼ˆS/MIMEè¨¼æ˜æ›¸ã€SSLè¨¼æ˜æ›¸ï¼‰ã‚’å—ä¿¡ã€‚ èªè¨¼å±€ã‹ã‚‰ã‚‚ã‚‰ã£ãŸå…¬é–‹éµã‚’ç”¨ã„ã¦ã€ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ã®æš—å·ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ç½²åï¼‰éƒ¨åˆ†ã‚’å¾©å·ã—ã€ãƒãƒƒã‚·ãƒ¥å€¤ãŒåŒã˜ãªã‚‰ã€èªè¨¼å±€ãã®ã‚‚ã®ãŒæˆã‚Šã™ã¾ã—ã§ãªã„ã¨åˆ¤æ–­ã™ã‚‹ã€‚ ãƒ»èªè¨¼å±€ãã®ã‚‚ã®ã®æˆã‚Šã™ã¾ã—ã®é˜²æ­¢ç­– ãƒ‡ã‚¸ã‚¿ãƒ«è¨¼æ˜æ›¸ï¼ˆS/MIMEè¨¼æ˜æ›¸ã€SSLè¨¼æ˜æ›¸ï¼‰ã‚’ç™ºè¡Œã™ã‚‹èªè¨¼å±€ãã®ã‚‚ã®ãŒã€æˆã‚Šã™ã¾ã—ã®å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ãã“ã§ã€èªè¨¼å±€ã‚’ãƒ©ãƒ³ã‚¯ä»˜ã‘ã—ã€ãƒ«ãƒ¼ãƒˆèªè¨¼å±€ãŒä¸‹ä½ãƒ©ãƒ³ã‚¯ã®èªè¨¼å±€ã«æ¨©é™ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€ä¸‹ä½ã®èªè¨¼å±€ã®ä¿¡é ¼æ€§ã‚’æŒãŸã›ã¦ã„ã‚‹ã€‚ãªãŠã€ãƒ«ãƒ¼ãƒˆèªè¨¼å±€ã¯å°‚é–€æ©Ÿé–¢ã‹ã‚‰å³ã—ã„å¯©æŸ»ã‚’å—ã‘ã¦ã„ã‚‹ãŸã‚ã€ãƒ«ãƒ¼ãƒˆèªè¨¼å±€è‡ªä½“ãŒãªã‚Šã™ã¾ã—ã§ã‚ã‚‹å¯èƒ½æ€§ã¯éå¸¸ã«ä½ã„ã€‚ 02-06. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã«ãŠã‘ã‚‹ãƒ˜ãƒƒãƒ€æƒ…å ±ã®æš—å·åŒ–æŠ€è¡“ IPsecï¼šInternet Protocol Security ãƒ»IPSecã¨ã¯ å…±é€šéµæš—å·æ–¹å¼ã«åŸºã¥ãã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã§ã€ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã®æš—å·åŒ–ã‚’æ‹…ã†ã€‚ä¾‹ãˆã°ã€ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯æ™‚ã«ã€è‡ªå®…PCã¨ä¼šç¤¾ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’VPNæ¥ç¶šã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚VPNæ¥ç¶šã•ã‚Œã‚‹ã¨ã€è‡ªå®…PCã‹ã‚‰ã®TCPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒä¼šç¤¾ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’é€šéã™ã‚‹ãŸã‚ã€é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒä¼šç¤¾ã®ã‚‚ã®ã«ã‹ã‚ã‚‹ã€‚ç›—è´ã‚’é˜²ã’ã‚‹ã€‚ ãƒ»IPsecã«ã‚ˆã‚‹ãƒ‘ã‚±ãƒƒãƒˆã®ã‚«ãƒ—ã‚»ãƒ«åŒ– VPNï¼šVirtual Private Networkï¼ˆä»®æƒ³ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ ãƒ»VPNã¨ã¯ ç•°ãªã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ã§å®‰å…¨ãªé€šä¿¡ã‚’è¡Œã†ãŸã‚ã®ä»•çµ„ã¿ã€‚ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«åŸºã¥ã„ã¦ã€ã€PPTP-VPNã€ã€ã€SSL/TLS-VPNã€ã€ã€IPsec-VPNã€ãŒã‚ã‚‹ã€‚ ãƒ»PPTP-VPNã®ä¾‹ ã€PPTPã€ ãƒ»SSL/TLS-VPNã®ä¾‹ ã€OpenVPNã€ ãƒ»IPsec-VPNã®ä¾‹ ã€L2TP/IPSecã€ 03. ãã®ä»–ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æŠ€è¡“ ãƒ¡ãƒ¼ãƒ«å—ä¿¡ã«ãŠã‘ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ ãƒ»OP25Bï¼ˆOutbound Port 25 Blockingï¼‰ ãƒ»SPFï¼ˆSender Policy Frameworkï¼‰ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä¿å­˜æ–¹æ³• å¹³æ–‡ã§ä¿å­˜ã—ã¦ãŠãã¨ã€æµå‡ºã—ãŸæ™‚ã«å‹æ‰‹ã«ä½¿ç”¨ã•ã‚Œã¦ã—ã¾ã†ãŸã‚ã€ãƒãƒƒã‚·ãƒ¥å€¤ã§ä¿å­˜ã™ã‚‹ã¹ãã§ã‚ã‚‹ã€‚ ç”Ÿä½“èªè¨¼ Web beacon webãƒšãƒ¼ã‚¸ã«ã€ã‚µãƒ¼ãƒã«å¯¾ã—ã¦HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è¨­ç½®ã—ã€é€ä¿¡ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é›†è¨ˆã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹è§£ææ–¹æ³•ã€‚ä¾‹ãˆã°ã€1x1ã®å°ã•ãªGifã€ç”»åƒã€ãªã©ã‚’è¨­ç½®ã™ã‚‹ã€‚ Penetration ãƒ†ã‚¹ãƒˆ æ—¢çŸ¥ã®ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒã‚’æ„å›³çš„ã«è¡Œã„ã€ã‚·ã‚¹ãƒ†ãƒ ã®è„†å¼±æ€§ã‚’ç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š æ ªå¼ä¼šç¤¾LACã«ã‚ˆã‚‹Penetration ãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒ“ã‚¹ "},"public/cloud_computing/cloud_computing.html":{"url":"public/cloud_computing/cloud_computing.html","title":"ğŸ“– ï¸ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°","keywords":"","body":"ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã¨ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ç¨®é¡ ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã¨ã¯ ãƒ¦ãƒ¼ã‚¶ã®è‡ªç¤¾è¨­å‚™ã«ã‚ˆã£ã¦ã€ã‚·ã‚¹ãƒ†ãƒ ã‚’é‹ç”¨ã™ã‚‹ã“ã¨ã€‚ ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã¯ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’çµŒç”±ã—ã¦ã€ãƒ™ãƒ³ãƒ€ãƒ¼ã®ã‚µãƒ¼ãƒã«è‡ªèº«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã€åˆ©ç”¨ã™ã‚‹ã“ã¨ã€‚ãƒ™ãƒ³ãƒ€ãƒ¼ãŒã€ã‚·ã‚¹ãƒ†ãƒ ã‚’ç¨¼åƒã•ã›ã‚‹ãŸã‚ã«å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¨ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚’ã©ã“ã¾ã§æä¾›ã™ã‚‹ã‹ã«ã‚ˆã£ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ã®åç§°ãŒç•°ãªã‚‹ã€‚ 02. ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ 03. ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° IaaSï¼šInfrastructure as a Service ï¼Šä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å æä¾› Amazon Web Service Amazon Google Cloud Platform Google Microsoft Azure Microsoft IBM Cloud IBM PaaSï¼šPlatform as a Service ï¼Šä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å æä¾› Google App Engine Google Windows Azure Microsoft GitHub Pages GitHub FaaSï¼šPlatform as a Service ãƒ¦ãƒ¼ã‚¶å´ã¯é–¢æ•°ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè£…ã®ã¿ã‚’è¡Œã„ã€ãã‚Œä»¥å¤–ã¯ãƒ™ãƒ³ãƒ€ãƒ¼å´ã«ç®¡ç†ã—ã¦ã‚‚ã‚‰ã†ã‚µãƒ¼ãƒ“ã‚¹ã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š Lambda SaaSï¼šSoftware as a Service å¾“æ¥ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦æä¾›ã—ã¦ã„ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦æä¾›ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š Google Appsï¼ˆGoogle Mapã€Google Cloudã€Google Calender ãªã©ï¼‰ "},"public/cloud_computing/cloud_computing_aws.html":{"url":"public/cloud_computing/cloud_computing_aws.html","title":"ğŸ“– ï¸AWS","keywords":"","body":"AWSï¼šAmazon Web Service ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ https://hiroki-it.github.io/tech-notebook-gitbook/ 01. ALBï¼šApplication Load Balancing ALBã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã€ã‹ã¤ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã¨ã—ã¦åƒãã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä»£ç†ã§å—ä¿¡ã—ã€EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆãåˆ†é…ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã‚µãƒ¼ãƒã¸ã®è² è·ã‚’ç·©å’Œã™ã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒªã‚¹ãƒŠãƒ¼ ALBã«å‰²ã‚ŠæŒ¯ã‚‹ãƒãƒ¼ãƒˆç•ªå·ãŠã€å—ä¿¡ã™ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‹ã¤ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ã¨ã—ã¦ã€ã“ã‚Œã‚‰ã®é€šä¿¡ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã€‚ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡è€…ãŒç”¨ã„ã‚‹SSL/TLSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚„æš—å·åŒ–æ–¹å¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«åˆã‚ã›ã¦ã€ALBãŒå—ä¿¡ã§ãã‚‹ã“ã‚Œã‚‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡è€…ã«ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã€APIã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã€è»¢é€å…ƒã®AWSãƒªã‚½ãƒ¼ã‚¹ï¼ˆCloudFrontãªã©ï¼‰ã€ãªã©ã‚’å«ã‚€ã€‚ãƒ»å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/create-https-listener.html#describe-ssl-policies ãƒ«ãƒ¼ãƒ« ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«ç”¨ã„ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒãƒ¼ãƒˆç•ªå·ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ã†ã¡ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãŒOKã«ãªã£ã¦ã„ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã‚‹ã€‚ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«å±ã™ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ãƒˆç•ªå·ã‚’æŒ‡å®šã—ã¦ã€å®šæœŸçš„ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®æŒ‡å®šæ–¹æ³• è£œè¶³ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒã€EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ IPã‚¢ãƒ‰ãƒ¬ã‚¹ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã€é™çš„ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ Lambda ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒã€Lambdaã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ ãƒ«ãƒ¼ãƒ« ãƒ»ãƒ«ãƒ¼ãƒ«ã®è¨­å®šä¾‹ ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ ãƒãƒ¼ãƒˆ IF THEN ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒãƒ¼ãƒˆ80ã‚’æŒ‡å®šã—ãŸæ™‚ã«ã€443ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ãŸã„ã€‚ 80 ãã‚Œä»¥å¤–ã®å ´åˆã¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œãªã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆï¼šhttps://#{host}:443/#{path}?#{query}ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ï¼šHTTP_301 ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒãƒ¼ãƒˆ443ã‚’æŒ‡å®šã—ãŸæ™‚ã«ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«è»¢é€ã—ãŸã„ã€‚ 443 ãã‚Œä»¥å¤–ã®å ´åˆã¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œãªã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ç‰¹å®šã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— Webã‚µãƒ¼ãƒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹å¯¾å¿œ ãƒ»å•é¡Œ ALBã‹ã‚‰EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã—ãŸå ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§ã€HTTPSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ãŸå‡¦ç†ãŒã§ããªããªã‚‹ã€‚ãã“ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ALBã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒHTTPSã ã£ãŸå ´åˆã€Webã‚µãƒ¼ãƒã¾ãŸã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’HTTPSã¨è¦‹ãªã™ã‚ˆã†ã«å¯¾å‡¦ã™ã‚‹ã€‚ ãƒ»Webã‚µãƒ¼ãƒã«ãŠã‘ã‚‹å¯¾å‡¦æ–¹æ³• ALBã‚’çµŒç”±ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã«X-Forwarded-Protoãƒ˜ãƒƒãƒ€ãƒ¼ãŒä»˜ä¸ã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã¯ã€ALBã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ç¨®é¡ãŒæ–‡å­—åˆ—ã§ä»£å…¥ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚ŒãŒã€HTTPSã€ã ã£ãŸå ´åˆã€Webã‚µãƒ¼ãƒã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’HTTPSã§ã‚ã‚‹ã¨ã¿ãªã™ã‚ˆã†ã«å¯¾å‡¦ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒHTTPSã¨ãªã‚‹ï¼ˆã“ã¡ã‚‰ã‚’è¡Œã£ãŸå ´åˆã¯ã€ä»¥é™ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã®å¯¾å¿œä¸è¦ï¼‰ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š SetEnvIf X-Forwarded-Proto https HTTPS=on ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹å¯¾å‡¦æ–¹æ³• ALBã‚’çµŒç”±ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã«HTTP_X_FORWARDED_PROTOãƒ˜ãƒƒãƒ€ãƒ¼ãŒä»˜ä¸ã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã¯ã€ALBã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ç¨®é¡ãŒæ–‡å­—åˆ—ã§ä»£å…¥ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚ŒãŒã€HTTPSã€ã ã£ãŸå ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’HTTPSã§ã‚ã‚‹ã¨ã¿ãªã™ã‚ˆã†ã«ã€index.phpã«è¿½åŠ å®Ÿè£…ã‚’è¡Œã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãã®ä»–ã®ç•™æ„äº‹é … ãƒ»å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›² ALBã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã«ã¯ã€VPCã®ã‚‚ã®ãŒé©ç”¨ã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®Security Groupã§ã¯ã€VPCã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’è¨±å¯ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»ALBã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— Route53ã‹ã‚‰è»¢é€ã•ã‚Œã‚‹ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å—ä¿¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å…¬é–‹ã™ã‚‹Webã‚µã‚¤ãƒˆã§ã‚ã‚Œã°ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å…¨ã¦ã®ç¯„å›²ï¼ˆ0.0.0.0/0ã¨::/0ï¼‰ã«ã™ã‚‹ã€‚ç¤¾å†…å‘ã‘ã®Webã‚µã‚¤ãƒˆã§ã‚ã‚Œã°ã€ç¤¾å†…ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã¿ï¼ˆn.n.n.n/32ï¼‰ã‚’è¨±å¯ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ 02. Amplify Amplifyã¨ã¯ ã‚µãƒ¼ãƒãƒ¬ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚SSGã®å ´åˆã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã•ãˆã™ã‚Œã°ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã®è¦ä»¶ãŒå…¨ã¦æ•´ã†ã€‚SPAã®å ´åˆã€ã‚µãƒ¼ãƒãƒ¬ã‚¹ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’è‡ªå‹•æ§‹ç¯‰ã—ã¦ãã‚Œã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã•ãˆã™ã‚Œã°ã€è¦ä»¶ãŒå…¨ã¦æ•´ã†ã€‚ã“ã‚Œã®AWSãƒªã‚½ãƒ¼ã‚¹ã¯CloudFormationã«ã‚ˆã£ã¦æ§‹ç¯‰ã•ã‚Œã‚‹ãŒã€AmplifyçµŒç”±ã§ã—ã‹è¨­å®šã‚’å¤‰æ›´ã§ããšã€å„AWSãƒªãƒªãƒ¼ã‚¹ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‚’è¦‹ã¦ã‚‚ã€éè¡¨ç¤ºã«ãªã£ã¦ã„ã‚‹ã€‚ãŸã ã—ã€Route53ã®è¨­å®šã¯è¡¨ç¤ºã•ã‚Œã¦ãŠã‚Šã€AmplifyãŒè¿½åŠ ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¦ãƒ¼ã‚¶ãŒç·¨é›†ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://d1.awsstatic.com/webinars/jp/pdf/services/20200520_AWSBlackBelt_Amplify_A.pdf å½¹å‰² ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ èªè¨¼ Gognito é™çš„ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° CloudFrontã€S3 API API Gatewayã€AppSync GraphQL ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ Lambda DB DynamoDB ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ S3 å…¨æ–‡æ¤œç´¢ Elastic Search ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ AppSyncã€IoT Core è¨­å®šé …ç›® é …ç›® èª¬æ˜ è£œè¶³ æœ¬ç•ªç¨¼åƒãƒ–ãƒ©ãƒ³ãƒ åŸºç‚¹ãƒ–ãƒ©ãƒ³ãƒã‚’è¨­å®šã™ã‚‹ã€‚ Amplifyã‚’æœ¬ç•ªé‹ç”¨ã—ãªã„å ´åˆã¯ã€developãƒ–ãƒ©ãƒ³ãƒã‚’è¨­å®šã™ã‚Œã°ã‚ˆã„ã€‚ Branch autodetection ãƒ–ãƒ©ãƒ³ãƒã®è‡ªå‹•æ¤œå‡ºã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’çµ„ã¿è¾¼ã‚€å ´åˆã€ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã‚’äºŒã¤å‰²ã‚Šå½“ã¦ãªã„ã¨ã€ãƒ–ãƒ©ãƒ³ãƒãŒæ¤œçŸ¥ã•ã‚Œãªã„ã“ã¨ãŒã‚ã‚‹ã€‚ æ‰‹å‹•ãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤ ãƒ»é–‹ç™ºç’°å¢ƒã§æ“¬ä¼¼å†ç¾ ã‚µãƒ¼ãƒãƒ¬ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºç’°å¢ƒã§å†ç¾ã™ã‚‹ã€‚ $ amplify mock api ãƒ»é–‹ç™ºç’°å¢ƒã‹ã‚‰ç›´æ¥ãƒ“ãƒ«ãƒ‰&ãƒ‡ãƒ—ãƒ­ã‚¤ é–‹ç™ºï¼ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ï¼æœ¬ç•ªç’°å¢ƒã«åˆ‡ã‚Šæ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®š $ amplify add hosting # ãƒ“ãƒ«ãƒ‰&ãƒ‡ãƒ—ãƒ­ã‚¤ $ amplify publish è‡ªå‹•ãƒ“ãƒ«ãƒ‰&ãƒ‡ãƒ—ãƒ­ã‚¤ ãƒ»é€£æºå¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/amplify/latest/userguide/getting-started.html#step-1-connect-repository ãƒ»å¯¾å¿œã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªæ§‹é€  ç¨®é¡ ãƒ“ãƒ«ãƒ‰é–‹å§‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª éãƒ¢ãƒãƒªãƒã‚¸ãƒˆãƒª ãƒªãƒã‚¸ãƒˆãƒªåã‹ã‚‰ãªã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ãƒ¢ãƒãƒªãƒã‚¸ãƒˆãƒª ãƒ¢ãƒãƒªãƒã‚¸ãƒˆãƒªã®å„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ãƒ»amplify.ymlãƒ•ã‚¡ã‚¤ãƒ« ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ«ãƒ¼ãƒˆã«amplify.ymlãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã™ã‚‹ã€‚Next.jsã§ã¯SSGï¼SSRã®ä¸¡ãƒ¢ãƒ¼ãƒ‰ã§ãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹ã€‚package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã§ç”¨ã„ã‚‰ã‚Œã‚‹nextã‚³ãƒãƒ³ãƒ‰ã«å¿œã˜ã¦ã€SSGã¾ãŸã¯SSRã®ã„ãšã‚Œã‹ã®ã‚¤ãƒ³ãƒ•ãƒ©ãŒæ§‹ç¯‰ã•ã‚Œã€ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹ã€‚SSGã®å ´åˆã€è£å´ã§ã¯S3ã€CloudFrontã€Route53ãªã©ãŒæ§‹ç¯‰ã•ã‚Œã€é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚SSRã®å ´åˆã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã ã‘ã§ãªããƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ç¨¼åƒç’°å¢ƒãŒå¿…è¦ã«ãªã‚‹ãŸã‚ã€Lambdaã‚„CogniteãŒæ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/amplify/latest/userguide/build-settings.html https://docs.aws.amazon.com/ja_jp/amplify/latest/userguide/server-side-rendering-amplify.html#deploy-nextjs-app version: 1 #===================== # ç’°å¢ƒå¤‰æ•° #===================== env: variables: key: # ç’°å¢ƒå¤‰æ•°ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° #===================== # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®CI/CD #===================== backend: phases: preBuild: commands: - # ã‚³ãƒãƒ³ãƒ‰ build: commands: - # ã‚³ãƒãƒ³ãƒ‰ postBuild: commands: - # ã‚³ãƒãƒ³ãƒ‰ #===================== # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®CI/CD #===================== frontend: phases: preBuild: commands: - npm install # ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ç™»éŒ²ã—ãŸã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰å€¤ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ - echo $ENV | base64 -di > .env - cat .env build: commands: - nuxt generate --fail-on-error - ls -la ./dist artifacts: # ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª files: # å…¨ã¦ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª - \"**/*\" discard-paths: yes # ãƒ“ãƒ«ãƒ‰ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’é…ç½®ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª baseDirectory: dist # æŒ‡å®šã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆ cache: paths: - node_modules/**/* #===================== # ãƒ†ã‚¹ãƒˆ #===================== test: phases: preTest: commands: - # ã‚³ãƒãƒ³ãƒ‰ test: commands: - # ã‚³ãƒãƒ³ãƒ‰ postTest: commands: - # ã‚³ãƒãƒ³ãƒ‰ artifacts: # ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª files: # å…¨ã¦ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª - \"**/*\" configFilePath: *location* # ãƒ“ãƒ«ãƒ‰ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª baseDirectory: *location* 03. API Gateway API Gatewayã¨ã¯ ç•°ãªã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã—ã¦å·®åˆ†ã‚’å¸åã—ã€é©åˆ‡ãªAPIã«æŒ¯ã‚Šåˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ API Gatewayã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€çµ±åˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹ã€‚ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒªã‚½ãƒ¼ã‚¹ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€HTTPãƒ¡ã‚½ãƒƒãƒ‰ã€è»¢é€å…ˆã€ãªã©ã‚’è¨­å®šã™ã‚‹ã€‚ æ§‹ç¯‰ã—ãŸAWSãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‘ã‚¹ãŒã€API Gatewayã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãªã‚‹ã€‚ ã‚¹ãƒ†ãƒ¼ã‚¸ API Gatewayã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ç’°å¢ƒã‚’å®šç¾©ã™ã‚‹ã€‚ ã‚ªãƒ¼ã‚½ãƒ©ã‚¤ã‚¶ãƒ¼ Lambdaã¾ãŸã¯Cognitoã«ã‚ˆã‚‹ã‚ªãƒ¼ã‚½ãƒ©ã‚¤ã‚¶ãƒ¼ã‚’ç”¨ã„ã¦ã€èªå¯ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚ ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ¢ãƒ‡ãƒ« ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒã‚’è¨­å®šã™ã‚‹ã€‚ã“ã‚Œã‚‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ã€‚ OpenAPIä»•æ§˜ã«ãŠã‘ã‚‹ã‚¹ã‚­ãƒ¼ãƒã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html ãƒªã‚½ãƒ¼ã‚¹ãƒãƒªã‚·ãƒ¼ ãƒãƒªã‚·ãƒ¼ã‚’ç”¨ã„ã¦ã€API Gatewayã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å®šç¾©ã¥ã‘ã‚‹ã€‚ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ APIã®è¨­å®š ä½¿ç”¨é‡ãƒ—ãƒ©ãƒ³ æœ‰æ–™ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦APIã‚’å…¬é–‹ã—ã€æ–™é‡‘ä½“ç³»ã«å¿œã˜ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆé‡ã‚’åˆ¶é™ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‹ã€‚APIã‚­ãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆé‡ã®ãƒ¬ãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ æœ‰æ–™ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ä½¿ç”¨ã—ãªã„APIã®å ´åˆã¯ã€ãƒ¬ãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ APIã‚­ãƒ¼ APIã‚­ãƒ¼èªè¨¼ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãã®ä»–ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®æ–¹æ³•ã¨ã—ã¦ã€ä»¥ä¸‹ãŒã‚ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/apigateway-control-access-to-api.htmlãƒ»APIã‚­ãƒ¼èªè¨¼ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_authentication_authorization.html ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸ SSLè¨¼æ˜æ›¸ã‚’API Gatewayã«å‰²ã‚Šå½“ã¦ã‚‹ã€‚ APIãŒã€API Gatewayã‹ã‚‰è»¢é€ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ã“ã¨è­˜åˆ¥ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ CloudWatchãƒ­ã‚°ã®è¨­å®š API GatewayãŒCloudWatchãƒ­ã‚°ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã€ãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ ä¸€ã¤ã®AWSç’°å¢ƒã«ã¤ãã€ä¸€ã¤ã®ãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚Œã°ã‚ˆã„ã€‚ ãƒªã‚½ãƒ¼ã‚¹ ãƒ»ãƒªã‚½ãƒ¼ã‚¹ é †ç•ª å‡¦ç† èª¬æ˜ è£œè¶³ 1 ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ã†ã¡ã€å®Ÿéš›ã«è»¢é€ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚ 2 çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰è»¢é€ã•ã‚ŒãŸå„ãƒ‡ãƒ¼ã‚¿ã‚’ã€ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®JSONã«ç´ä»˜ã‘ã‚‹ã€‚ 3 çµ±åˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’ç”¨ã„ã‚‹å ´åˆã€çµ±åˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ä½¿ç”¨ã§ããªããªã‚‹ã€‚ 4 ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒæˆåŠŸã—ãŸå ´åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ èªå¯ å®šç¾©ã—ãŸLambdaã¾ãŸã¯Cognitoã«ã‚ˆã‚‹ã‚ªãƒ¼ã‚½ãƒ©ã‚¤ã‚¶ãƒ¼ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ¤œè¨¼ ã€URLã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã€ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ¬æ–‡ã€ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ APIã‚­ãƒ¼ã®å¿…è¦æ€§ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã«ãŠã‘ã‚‹APIã‚­ãƒ¼ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã€x-api-keyã€ã‚’å«ã¿ã€ã“ã‚Œã«APIã‚­ãƒ¼ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å¼·åˆ¶ã™ã‚‹ã€‚ ãƒ˜ãƒƒãƒ€ãƒ¼åã¯å¤§æ–‡å­—ã§ã‚‚å°æ–‡å­—ã§ã‚‚å•é¡Œãªã„ãŒã€å°æ–‡å­—ãŒæ¨å¥¨ã€‚å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html URLã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸURLã®ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚ HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ¬æ–‡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚ SDKè¨­å®š ãƒ»çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ çµ±åˆã‚¿ã‚¤ãƒ— ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è»¢é€å…ˆã‚’è¨­å®šã™ã‚‹ã€‚ URLãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰è»¢é€ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€API Gatewayã‹ã‚‰è»¢é€ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ç´ä»˜ã‘ã‚‹ã€‚ã¾ãŸã¯ç´ä»˜ã‘ãšã«ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã—ã¦ã‚‚è‰¯ã„ã€‚ URLã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰è»¢é€ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€API Gatewayã‹ã‚‰è»¢é€ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ç´ä»˜ã‘ã‚‹ã€‚ã¾ãŸã¯ç´ä»˜ã‘ãšã«ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã—ã¦ã‚‚è‰¯ã„ã€‚ HTTPãƒ˜ãƒƒãƒ€ãƒ¼ ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰è»¢é€ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€API Gatewayã‹ã‚‰è»¢é€ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«ç´ä»˜ã‘ã‚‹ã€‚ã¾ãŸã¯ç´ä»˜ã‘ãšã«ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã—ã¦ã‚‚è‰¯ã„ã€‚ å€¤ã¯ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã§å›²ã†å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰è»¢é€ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€API Gatewayã‹ã‚‰è»¢é€ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«ç´ä»˜ã‘ã‚‹ã€‚ã¾ãŸã¯ç´ä»˜ã‘ãšã«ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã—ã¦ã‚‚è‰¯ã„ã€‚ ãƒ»ãƒ†ã‚¹ãƒˆ è¨­å®šé …ç›® è¨­å®šä¾‹ è£œè¶³ ã‚¯ã‚¨ãƒªæ–‡å­— ãƒ˜ãƒƒãƒ€ãƒ¼ X-API-Token: test æ³¢æ‹¬å¼§ã€ã‚¹ãƒšãƒ¼ã‚¹ã€ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸è¦ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ¬æ–‡ {test:\"test\"} æ”¹è¡Œã‚¿ã‚°ã‚„ã‚¹ãƒšãƒ¼ã‚¹ãŒå…¥ã‚Šè¾¼ã¾ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»OpenAPIä»•æ§˜ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws_api_gateway_import.html ãƒ»CORSã®æœ‰åŠ¹åŒ– CORSã‚’æœ‰åŠ¹åŒ–ã—ã€ç•°ãªã‚‹ã‚ªãƒªã‚¸ãƒ³ã«ã‚ˆã£ã¦è¡¨ç¤ºã•ã‚ŒãŸãƒšãƒ¼ã‚¸ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã™ã‚‹ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/how-to-cors.html ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆçµ±åˆ ãƒ»ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆçµ±åˆã¨ã¯ API Gatewayã¨VPCãƒªãƒ³ã‚¯ã®é–“ã§ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®JSONãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•çš„ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹æ©Ÿèƒ½ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/set-up-private-integration.html ã¾ãŸã€VPCãƒªãƒ³ã‚¯ã®è¨­å®šã«ã‚ˆã£ã¦ã€VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ãŒæ§‹ç¯‰ã•ã‚Œã‚‹ã€‚VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã¯ã€VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ è¨­å®šé …ç›® èª¬æ˜ çµ±åˆã‚¿ã‚¤ãƒ— VPCãƒªãƒ³ã‚¯ã‚’é¸æŠã™ã‚‹ã€‚ ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã®ä½¿ç”¨ VPCãƒªãƒ³ã‚¯ã¨ã®ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ãƒ¡ã‚½ãƒƒãƒ‰ HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚ VPCãƒªãƒ³ã‚¯ VPCãƒªãƒ³ã‚¯åã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURL NLBã®DNSåã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨ã—ã¦ã€è»¢é€å…ˆã®URLã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®ä½¿ç”¨ ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒãƒƒãƒ”ãƒ³ã‚° Lambdaãƒ—ãƒ­ã‚­ã‚·çµ±åˆ ãƒ»Lambdaãƒ—ãƒ­ã‚­ã‚·çµ±åˆã¨ã¯ API Gatewayã¨Lambdaã®é–“ã§ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®JSONãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•çš„ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹æ©Ÿèƒ½ã®ã“ã¨ã€‚ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’ç”¨ã„ã‚‹ã¨ã€Lambdaã«é€ä¿¡ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã®eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä»£å…¥ã•ã‚Œã‚‹ã€‚ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€Lambdaã¨API Gatewayã®é–“ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’æ‰‹å‹•ã§è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/set-up-lambda-integrations.html è¨­å®šé …ç›® èª¬æ˜ çµ±åˆã‚¿ã‚¤ãƒ— Lambdaé–¢æ•°ã‚’é¸æŠã™ã‚‹ã€‚ Lambdaãƒ—ãƒ­ã‚­ã‚·çµ±åˆã®ä½¿ç”¨ Lambdaã¨ã®ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ Lambdaãƒªãƒ¼ã‚¸ãƒ§ãƒ³ å®Ÿè¡Œã—ãŸLambdaé–¢æ•°ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ Lambdaé–¢æ•° å®Ÿè¡Œã—ãŸLambdaé–¢æ•°ã®åå‰ã‚’è¨­å®šã™ã‚‹ã€‚ å®Ÿè¡Œãƒ­ãƒ¼ãƒ« å®Ÿè¡Œã—ãŸã„Lambdaé–¢æ•°ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸãƒ­ãƒ¼ãƒ«ã®ARNã‚’è¨­å®šã™ã‚‹ã€‚ãŸã ã—ã€Lambdaå´ã«API Gatewayã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ã‚¢ã‚¿ãƒƒãƒã—ã¦ã‚‚ã‚ˆã„ã€‚ èªè¨¼æƒ…å ±ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®ä½¿ç”¨ ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã®ãƒãƒƒãƒ”ãƒ³ã‚° API Gatewayå´ã§ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã¨ã€API Gatewayã‚’çµŒç”±ã—ãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã®eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®JSONãƒ‡ãƒ¼ã‚¿ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã‚‹ã€‚ { \"resource\": \"Resource path\", \"path\": \"Path parameter\", \"httpMethod\": \"Incoming request's method name\", \"headers\": { String containing incoming request headers }, \"multiValueHeaders\": { List of strings containing incoming request headers }, \"queryStringParameters\": { query string parameters }, \"multiValueQueryStringParameters\": { List of query string parameters }, \"pathParameters\": { path parameters }, \"stageVariables\": { Applicable stage variables }, \"requestContext\": { Request context including authorizer-returned key-value pairs }, \"body\": \"A JSON string of the request payload.\", \"isBase64Encoded\": \"A boolean flag to indicate if the applicable request payload is Base64-encoded\" } ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã®ãƒãƒƒãƒ”ãƒ³ã‚° API Gatewayã¯ã€Lambdaã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã€ä»¥ä¸‹ã®JSONãƒ‡ãƒ¼ã‚¿ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã€‚ã“ã‚Œä»¥å¤–ã®æ§‹é€ ã®JSONãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã¨ã€API Gatewayã§ã€Internal Server Errorã€ã®ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹ã€‚ { \"isBase64Encoded\": true | false, \"statusCode\": httpStatusCode, \"headers\": { \"headerName\": \"headerValue\", ... }, \"multiValueHeaders\": { \"headerName\": [ \"headerValue\", \"headerValue2\", ... ], ... }, \"body\": \"Hello Lambda\" } API Gatewayã¯ä¸Šè¨˜ã®JSONãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã—ãŸå¾Œã€bodyã®ã¿å€¤ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«æŒãŸã›ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã™ã‚‹ã€‚ \"Hello Lambda\" ã‚¹ãƒ†ãƒ¼ã‚¸ ãƒ»è¨­å®š è¨­å®šé …ç›® èª¬æ˜ ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-caching.html ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚° ï¼‘ç§’å½“ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°åˆ¶é™ã‚’è¨­å®šã™ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-request-throttling.html WAF å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/apigateway-control-access-aws-waf.html ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸ ç´ä»˜ã‘ã‚‹WAFã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¸å¤‰æ•° ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹ã‚¹ãƒ†ãƒ¼ã‚¸å›ºæœ‰ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã§ãã‚‹ã€‚Lambdaé–¢æ•°åã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURLã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°ã€ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§å€¤ã‚’å‡ºåŠ›ã§ãã‚‹ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/aws-api-gateway-stage-variables-reference.html ãƒ»SDKã®ç”Ÿæˆ ãƒ»Canary è¨­å®šé …ç›® èª¬æ˜ ã‚¹ãƒ†ãƒ¼ã‚¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ Canaryã®ãƒ‡ãƒ—ãƒ­ã‚¤ Canaryã‚¹ãƒ†ãƒ¼ã‚¸å¤‰æ•° ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ãƒ­ã‚°ã®ç¨®é¡ ãƒ»å®Ÿè¡Œãƒ­ã‚° CloudWatchãƒ­ã‚°ã«API Gatewayã®å®Ÿè¡Œãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã§ãã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ§‹é€ ã‚‚ãƒ­ã‚°ã«å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ã—ãŸæ–¹ãŒè‰¯ã„ã€‚ã€€ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/set-up-logging.html ãƒ»ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚° CloudWatchãƒ­ã‚°ã«API Gatewayã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã§ãã‚‹ã€‚ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’æ§‹é€ åŒ–ãƒ­ã‚°ã¨ã—ã¦å‡ºåŠ›ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/set-up-logging.html åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®åé›† X-Rayã‚’ç”¨ã„ã¦ã€API Gatewayã‚’èµ·ç‚¹ã¨ã—ãŸåˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ã¾ãšã€API Gatewayã§ãƒˆãƒ¬ãƒ¼ã‚¹IDãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚ãã®å¾Œã€å„AWSãƒªã‚½ãƒ¼ã‚¹ã§ã‚¹ãƒ‘ãƒ³ã‚’å–å¾—ã—ã€ã‚¹ãƒ‘ãƒ³ã‚’ç´ä»˜ã‘ã‚‹ã“ã¨ã‚ˆã‚Šã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¡¨ç¾ã§ãã‚‹ã€‚ãªãŠX-Rayã§ã¯ã€è¦ªã‚¹ãƒ‘ãƒ³ã‚’ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã€å­ã‚¹ãƒ‘ãƒ³ã‚’ã‚µãƒ–ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¨å‘¼ã¶ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/xray/latest/devguide/xray-concepts.html#xray-concepts-traces APIã®è¨­å®š ãƒ»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚¿ã‚¤ãƒ— å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-api-endpoint-types.html ç¨®é¡ èª¬æ˜ ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ API Gatewayã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å†…ã®ç‰©ç†ã‚µãƒ¼ãƒã§å—ã‘ä»˜ã‘ã‚‹ã€‚ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ API Gatewayã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€VPCå†…ã‹ã‚‰ã®ã¿å—ã‘ä»˜ã‘ã‚‹ã€‚ ã‚¨ãƒƒã‚¸æœ€é©åŒ– API Gatewayã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€CloudFrontã®ã‚¨ãƒƒã‚¸ã‚µãƒ¼ãƒã§å—ã‘ä»˜ã‘ã‚‹ã€‚ 04. Auto Scaling Auto Scalingã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®é–¾å€¤ã‚’åŸºæº–ã¨ã—ã¦ã€è‡ªå‹•æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»èµ·å‹•è¨­å®š ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®å¯¾è±¡ã¨ãªã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚ ãƒ»ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚°ãƒ«ãƒ¼ãƒ— ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®ã‚°ãƒ«ãƒ¼ãƒ—æ§‹æˆã‚’å®šç¾©ã™ã‚‹ã€‚å„ã‚°ãƒ«ãƒ¼ãƒ—ã§æœ€å¤§æœ€å°å¿…è¦æ•°ã‚’è¨­å®šã§ãã‚‹ã€‚ ãƒ»ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãƒãƒªã‚·ãƒ¼ ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®æ–¹æ³•ã‚’å®šç¾©ã™ã‚‹ã€‚ ç¨®é¡ èª¬æ˜ è£œè¶³ ã‚·ãƒ³ãƒ—ãƒ«ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚° ç‰¹å®šã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å˜ä¸€ã®é–¾å€¤ã‚’è¨­å®šã—ã€ãã‚Œã«å¿œã˜ã¦ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚ ã‚¹ãƒ†ãƒƒãƒ—ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚° ç‰¹å®šã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«æ®µéšçš„ãªé–¾å€¤ã‚’è¨­å®šã—ã€ãã‚Œã«å¿œã˜ã¦æ®µéšçš„ã«ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼ˆä¾‹ï¼‰CPUå¹³å‡ä½¿ç”¨ç‡ã«æ®µéšçš„ãªé–¾å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ãƒ»40%ã®æ™‚ã«EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒï¼‘ã¤ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆãƒ»70%ã®æ™‚ã«EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ï¼’ã¤ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆãƒ»90%ã®æ™‚ã«EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ï¼“ã¤ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¿½è·¡ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚° ç‰¹å®šã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆCPUå¹³å‡ä½¿ç”¨ç‡ã‚„Memoryå¹³å‡ä½¿ç”¨ç‡ï¼‰ã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã‚’è¨­å®šã—ã€ãã‚Œã«åæŸã™ã‚‹ã‚ˆã†ã«è‡ªå‹•çš„ã«ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã¨ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã‚’è¨­å®šã§ãã‚‹ãƒªã‚½ãƒ¼ã‚¹ã®ä¾‹ãƒ»ECSã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¿ã‚¹ã‚¯æ•°ãƒ»DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®Auroraã®ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«æ•°ãƒ»Lambdaã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒæ™‚å®Ÿè¡Œæ•° 05. Certificate Manager è¨­å®šé …ç›® è¨­å®šé …ç›® èª¬æ˜ ãƒ‰ãƒ¡ã‚¤ãƒ³å èªè¨¼ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ æ¤œè¨¼ã®æ–¹æ³• DNSæ¤œè¨¼ã‹Eãƒ¡ãƒ¼ãƒ«æ¤œè¨¼ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ èªè¨¼å±€ èªè¨¼å±€ã§ã‚ã‚‹ATSã«ã‚ˆã£ã¦èªè¨¼ã•ã‚ŒãŸSSLè¨¼æ˜æ›¸ã‚’ç®¡ç†ã§ãã‚‹ã€‚ è‡ªç¤¾ã®ä¸­é–“èªè¨¼å±€å ãƒ«ãƒ¼ãƒˆèªè¨¼å±€å ATSï¼šAmazon Trust Services Starfieldç¤¾ SSLè¨¼æ˜æ›¸ã®æ¤œè¨¼æ–¹æ³• ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³æ¤œè¨¼ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®SSLè¨¼æ˜æ›¸ã‚’ç™ºè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€ãã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ‰€æœ‰è€…ã§ã‚ã‚‹ã“ã¨ã‚’è¨¼æ˜ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚AWSã ã‘ã§ãªãã€GMOãªã©ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã§ãã‚‹å„ã‚µãƒ¼ãƒ“ã‚¹ã«æ¤œè¨¼æ–¹æ³•ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/acm/latest/userguide/domain-ownership-validation.html https://jp.globalsign.com/support/proceeding/147.html ãƒ»DNSæ¤œè¨¼ CMã«ã‚ˆã£ã¦Route53ã«è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹CNAMEãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã‚’ç”¨ã„ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ‰€æœ‰è€…ã§ã‚ã‚‹ã“ã¨ã‚’è¨¼æ˜ã™ã‚‹ã€‚è¨¼æ˜æ›¸ãŒå¤±åŠ¹ã—ãã†ã«ãªã£ãŸã¨ãã«ã€CNAMEãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ãŒç…§åˆã•ã‚Œã€CMãŒè¨¼æ˜æ›¸ã‚’å†ç™ºè¡Œã—ã¦ãã‚Œã‚‹ã€‚ãªãŠã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’AWSä»¥å¤–ï¼ˆä¾‹ï¼šãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ ï¼‰ã§è³¼å…¥ã—ã¦ã„ã‚‹å ´åˆã¯ã€NSãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã‚’è³¼å…¥å…ˆã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã«æ‰‹ä½œæ¥­ã§ç™»éŒ²ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/acm/latest/userguide/dns-validation.html https://dev.classmethod.jp/articles/route53-domain-onamae/ ãƒ»Eãƒ¡ãƒ¼ãƒ«æ¤œè¨¼ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ‰€æœ‰è€…ã«ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã€ã“ã‚Œã‚’æ‰¿èªã™ã‚‹ã“ã¨ã§æ‰€æœ‰è€…ã§ã‚ã‚‹ã“ã¨ã‚’è¨¼æ˜ã™ã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’AWSä»¥å¤–ï¼ˆä¾‹ï¼šãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ ï¼‰ã§è³¼å…¥ã—ã¦ã„ã‚‹å ´åˆã¯ã€ãã¡ã‚‰ã§è¨­å®šã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å®›ã«ç¢ºèªãƒ¡ãƒ¼ãƒ«ãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/acm/latest/userguide/email-validation.html ãƒ»æ¤œè¨¼æ–¹æ³•ã®å¤‰æ›´ æ—¢å­˜ã®è¨¼æ˜æ›¸ã®æ¤œè¨¼æ–¹æ³•ã¯å¤‰æ›´ã§ããªã„ã€‚ãã®ãŸã‚ã€æ¤œè¨¼æ–¹æ³•ã‚’å¤‰æ›´ã—ãŸè¨¼æ˜æ›¸ã‚’æ–°ã—ãç™ºè¡Œã—ã€ã“ã‚Œã‚’ç´ã¥ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å¤ã„è¨¼æ˜æ›¸ã¯å‰Šé™¤ã—ã¦ãŠãã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/premiumsupport/knowledge-center/switch-acm-certificate/ è¨¼æ˜æ›¸ ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ è¨±å¯ã™ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®šç¾©ã—ãŸãƒ«ãƒ¼ãƒ«ã“ã¨ã€‚SSL/TLSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’è¨±å¯ã—ã¦ãŠã‚Šã€å¯¾å¿œã§ãã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒç•°ãªã‚‹ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®SSL/TLSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã§ãã‚‹ã‹ã‚’èªè­˜ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ Policy-2016-08 Policy-TLS-1-1 Policy-TLS-1-2 Protocol-TLSv1 ã€‡ âœ• âœ• Protocol-TLSv1.1 ã€‡ ã€‡ âœ• Protocol-TLSv1.2 ã€‡ ã€‡ ã€‡ ãƒ»SSLè¨¼æ˜æ›¸ã®ç¨®é¡ DNSæ¤œè¨¼ã¾ãŸã¯Eãƒ¡ãƒ¼ãƒ«æ¤œè¨¼ã«ã‚ˆã£ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ‰€æœ‰è€…ã§ã‚ã‚‹ã“ã¨ãŒè¨¼æ˜ã•ã‚Œã‚‹ã¨ã€ç™ºè¡Œã•ã‚Œã‚‹ã€‚è¨¼æ˜æ›¸ã¯ã€PKIã«ã‚ˆã‚‹å…¬é–‹éµæ¤œè¨¼ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ è¨¼æ˜æ›¸ã®ç¨®é¡ èª¬æ˜ ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰è¨¼æ˜æ›¸ è¨¼æ˜ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³åã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸã‚‚ã®ã€‚ ãƒ»SSLè¨¼æ˜æ›¸ã®è¨­ç½®å ´æ‰€ãƒ‘ã‚¿ãƒ¼ãƒ³ AWSã®ä½¿ç”¨ä¸Šã€ACMè¨¼æ˜æ›¸ã‚’è¨­ç½®ã§ããªã„AWSãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã¯ã€å¤–éƒ¨ã®è¨¼æ˜æ›¸ã‚’æ‰‹ã«å…¥ã‚Œã¦è¨­ç½®ã™ã‚‹ã€‚HTTPSã«ã‚ˆã‚‹SSLãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å—ã‘ä»˜ã‘ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æœ€çµ‚åœ°ç‚¹ã®ã“ã¨ã‚’ã€SSLã‚¿ãƒ¼ãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ã¨ã„ã†ã€‚ ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆRoute53ã«ã¯å¿…ãšè¨­ç½®ï¼‰ SSLã‚¿ãƒ¼ãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆHTTPSã®æœ€çµ‚åœ°ç‚¹ï¼‰ è£œè¶³ Route53 â†’ ALB(+ACMè¨¼æ˜æ›¸) â†’ EC2 ALB Route53 â†’ CloudFront(+ACMè¨¼æ˜æ›¸) â†’ ALB(+ACMè¨¼æ˜æ›¸) â†’ EC2 ALB CloudFrontã¯ãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ã§ã€ã¾ãŸALBã¯æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§ã€è¨¼æ˜æ›¸ã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚CloudFrontã«é€ä¿¡ã•ã‚ŒãŸHTTPSãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ALBã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«ã€ä¸¡æ–¹ã«ç´ä»˜ã‘ã‚‹è¨¼æ˜æ›¸ã§æ‰¿èªã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯ã€ä¸€è‡´ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ Route53 â†’ CloudFront(+ACMè¨¼æ˜æ›¸) â†’ EC2 CloudFront Route53 â†’ CloudFront(+ACMè¨¼æ˜æ›¸) â†’ S3 CloudFront Route53 â†’ ALB(+ACMè¨¼æ˜æ›¸) â†’ EC2(+å¤–éƒ¨è¨¼æ˜æ›¸) EC2 Route53 â†’ NLB â†’ EC2(+å¤–éƒ¨è¨¼æ˜æ›¸) EC2 Route53 â†’ EC2(+å¤–éƒ¨è¨¼æ˜æ›¸) EC2 Route53 â†’ Lightsail(+ACMè¨¼æ˜æ›¸) Lightsail è¨¼æ˜æ›¸ã®ç¢ºèªæ–¹æ³• ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®ç¢ºèª Chromeã‚’ä¾‹ã«æŒ™ã’ã‚‹ã¨ã€SSLè¨¼æ˜æ›¸ã¯URLã®éµãƒãƒ¼ã‚¯ã‹ã‚‰ç¢ºèªã§ãã‚‹ã€‚ ï¼Šä¾‹ï¼Š CircleCIã®ã‚µã‚¤ãƒˆã¯ã€SSLè¨¼æ˜æ›¸ã®ãŸã‚ã«ACMã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ 06. Chatbot Chatbotã¨ã¯ SNSã‚’çµŒç”±ã—ã¦ã€CloudWatchã‹ã‚‰ã®é€šçŸ¥ã‚’ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã«è»¢é€ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã€‚ è¨­å®šé …ç›® ãƒ»slacké€šçŸ¥ã®å ´åˆ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’Slackã¨ã—ãŸå ´åˆã®è¨­å®šã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ è¨­å®šé …ç›® èª¬æ˜ Slackãƒãƒ£ãƒ³ãƒãƒ« é€šçŸ¥ã®è»¢é€å…ˆã®Slackãƒãƒ£ãƒ³ãƒãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ SNSã‚’ä»‹ã—ã¦ã€CloudWatchã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ SNSãƒˆãƒ”ãƒƒã‚¯ CloudWatchã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ™‚çµŒç”±ã™ã‚‹ã€SNSãƒˆãƒ”ãƒƒã‚¯ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ã‚µãƒãƒ¼ãƒˆå¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆ AWSãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã€EventBridgeï¼ˆCloudWatchã‚¤ãƒ™ãƒ³ãƒˆï¼‰ã‚’ç”¨ã„ã¦ã€Chatbotã«è»¢é€ã§ãã‚‹ãŒã€å…¨ã¦ã®AWSãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚ã‚µãƒãƒ¼ãƒˆå¯¾è±¡ã®AWSãƒªã‚½ãƒ¼ã‚¹ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/chatbot/latest/adminguide/related-services.html#cloudwatchevents ãƒ»ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ ï¼”å¤§ã‚·ã‚°ãƒŠãƒ«ã‚’å«ã‚€ã€ã‚·ã‚¹ãƒ†ãƒ çš„ã«è‰¯ããªã„äº‹è±¡ã®ã“ã¨ã€‚ ãƒ»ã‚ªãƒ³ã‚³ãƒ¼ãƒ« ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚’é€šçŸ¥ã™ã‚‹ã‚ˆã†ã«ã—ã€é€šçŸ¥ã‚’å—ã‘ã¦å¯¾å¿œã™ã‚‹ã“ã¨ã€‚ 07. CloudFront CloudFrontã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¨ã—ã¦åƒãã€‚VPCã®å¤–å´ï¼ˆãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ã«è¨­ç½®ã•ã‚Œã¦ã„ã‚‹ã€‚ã‚ªãƒªã‚¸ãƒ³ã‚µãƒ¼ãƒï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„æä¾›å…ƒï¼‰ã‚’S3ã¨ã—ãŸå ´åˆã€å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’EC2ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹ã€‚ã¾ãŸã€é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã€ãã®ä¸Šã§S3ã¸æŒ¯ã‚Šåˆ†ã‘ã‚‹ã€‚æ¬¡å›ä»¥é™ã®é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒªãƒ³ã‚¯ã‚¨ã‚¹ãƒˆã¯ã€CloudFrontãŒãƒ¬ãƒ³ã‚¹ãƒãƒ³ã‚¹ã‚’è¡Œã†ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ Distributions Reports & analytics Distributions ãƒ»Distributions å‚è€ƒï¼šhttps://www.geekfeed.co.jp/geekblog/wordpress%E3%81%A7%E6%A7%8B%E7%AF%89%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%82%A6%E3%82%A7%E3%83%96%E3%82%B5%E3%82%A4%E3%83%88%E3%81%ABcloudfront%E3%82%92%E7%AB%8B%E3%81%A6%E3%81%A6%E9%AB%98/ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ General Origin and Origin Groups ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æä¾›ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ Behavior ã‚ªãƒªã‚¸ãƒ³ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè¡Œã‚ã‚ŒãŸæ™‚ã®CloudFrontã®æŒ™å‹•ã‚’è¨­å®šã™ã‚‹ã€‚ ErrorPage æŒ‡å®šã—ãŸã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ã€æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ Restriction Invalidation CloudFrontã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã§ãã‚‹ã€‚ ãƒ»General è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Price Class ç”¨ã„ã‚‹ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ AsiaãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‚’é¸æŠã€‚ AWS WAF CloudFrontã«ç´ä»˜ã‘ã‚‹WAFã‚’è¨­å®šã™ã‚‹ã€‚ CNAME CloudFrontã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³åï¼ˆxxxxx.cloudfront.net.ï¼‰ã«ç´ä»˜ã‘ã‚‹Route53ãƒ¬ã‚³ãƒ¼ãƒ‰åã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»Route53ã‹ã‚‰ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹å ´åˆã¯å¿…é ˆã€‚ãƒ»è¤‡æ•°ã®ãƒ¬ã‚³ãƒ¼ãƒ‰åã‚’è¨­å®šã§ãã‚‹ã€‚ SSL Certificate HTTPSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã™ã‚‹å ´åˆã«è¨­å®šã™ã‚‹ã€‚ ä¸Šè¿°ã®CNAMEã‚’è¨­å®šã—ãŸå ´åˆã€SSLè¨¼æ˜æ›¸ãŒåˆ¥é€”å¿…è¦ã«ãªã‚‹ã€‚ã¾ãŸã€Certificate Managerã‚’ç”¨ã„ã‚‹å ´åˆã€ã“ã®è¨¼æ˜æ›¸ã¯ã€ãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ã€ã§ç”³è«‹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ Security Policy ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡è€…ãŒç”¨ã„ã‚‹SSL/TLSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚„æš—å·åŒ–æ–¹å¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«åˆã‚ã›ã¦ã€CloudFrontãŒå—ä¿¡ã§ãã‚‹ã“ã‚Œã‚‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡è€…ã«ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã€APIã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã€è»¢é€å…ƒã®AWSãƒªã‚½ãƒ¼ã‚¹ã€ãªã©ã‚’å«ã‚€ã€‚ãƒ»å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html Default Root Object ã‚ªãƒªã‚¸ãƒ³ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ä½•ã‚‚è¨­å®šã—ãªã„å ´åˆã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã¯æŒ‡å®šã•ã‚Œãšã€Behaviorã§æ˜ç¤ºçš„ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãƒ»index.htmlã‚’è¨­å®šã™ã‚‹ã¨ã€ã€/ã€ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ãŸæ™‚ã«ã€ã‚ªãƒªã‚¸ãƒ³ã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹index,htmlãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã«ãªã‚‹ã€‚ Standard Logging CloudFrontã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’S3ã«ç”Ÿæˆã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»Origin and Origin Groups è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Origin Domain Name CloudFrontã‚’ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã¨ã—ã¦ã€AWSãƒªã‚½ãƒ¼ã‚¹ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚„DNSã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã€‚ ãƒ»ä¾‹ãˆã°ã€S3ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ALBã®DNSåã‚’è¨­å®šã™ã‚‹ã€‚ãƒ»åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®AWSãƒªã‚½ãƒ¼ã‚¹ã®DNSåã§ã‚ã£ã¦ã‚‚ã‚ˆã„ã€‚ Origin Path ã‚ªãƒªã‚¸ãƒ³ã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ä½•ã‚‚è¨­å®šã—ãªã„ã¨ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ã€/ã€ã®ãªã‚‹ã€‚Behaviorã§ã¯ã€ã€/ã€ã®å¾Œã«ãƒ‘ã‚¹ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ãƒ»ã€/var/www/appã€ã‚’è¨­å®šã™ã‚‹ã¨ã€Behaviorã§è¨­å®šã—ãŸãƒ‘ã‚¹ãŒã€/var/www/app/xxxxxã€ã®ã‚ˆã†ã«è¿½åŠ ã•ã‚Œã‚‹ã€‚ Origin Access Identity ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è»¢é€å…ˆã¨ãªã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã§ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®ã‚¢ã‚¿ãƒƒãƒãŒå¿…è¦ãªå ´åˆã«è¨­å®šã™ã‚‹ã€‚è»¢é€å…ˆã®AWSãƒªã‚½ãƒ¼ã‚¹ã§ã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ CloudFrontãŒS3ã«å¯¾ã—ã¦èª­ã¿å‡ºã—ã‚’è¡Œã†ãŸã‚ã«å¿…è¦ã€‚ Origin Protocol Policy ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è»¢é€å…ˆã¨ãªã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€HTTPã¨HTTPSã®ã„ãšã‚Œã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§è»¢é€ã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ALBã§å¿…è¦ã€‚ALBã®ãƒªã‚¹ãƒŠãƒ¼ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«åˆã‚ã›ã¦è¨­å®šã™ã‚‹ã€‚ãƒ»HTTP Onlyï¼šHTTPã§è»¢é€ãƒ»HTTPS Onlyï¼šHTTPSã§è»¢é€ãƒ»Match Viewerï¼šä¸¡æ–¹ã§è»¢é€ HTTPãƒãƒ¼ãƒˆ è»¢é€æ™‚ã«æŒ‡å®šã™ã‚‹ã‚ªãƒªã‚¸ãƒ³ã®HTTPã®ãƒãƒ¼ãƒˆç•ªå· HTTPSãƒãƒ¼ãƒˆ è»¢é€æ™‚ã«æŒ‡å®šã™ã‚‹ã‚ªãƒªã‚¸ãƒ³ã®HTTPSã®ãƒãƒ¼ãƒˆç•ªå· ãƒ»Behavior è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Precedence å‡¦ç†ã®å„ªå…ˆé †ä½ã€‚ æœ€åˆã«æ§‹ç¯‰ã—ãŸBehaviorãŒã€Default (*)ã€ã¨ãªã‚Šã€ã“ã‚Œã¯å¾Œã‹ã‚‰å¤‰æ›´ã§ããªã„ãŸã‚ã€ä¸»è¦ãªBehaviorã‚’ã¾ãšæœ€åˆã«è¨­å®šã™ã‚‹ã€‚ Path pattern Behaviorã‚’è¡Œã†ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ Origin and Origin Group Behaviorã‚’è¡Œã†ã‚ªãƒªã‚¸ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ Viewer Protocol Policy HTTPï¼HTTPSã®ã©ã¡ã‚‰ã‚’å—ä¿¡ã™ã‚‹ã‹ã€ã¾ãŸã©ã®ã‚ˆã†ã«å¤‰æ›ã—ã¦è»¢é€ã™ã‚‹ã‹ã‚’è¨­å®š ãƒ»HTTP and HTTPSï¼šä¸¡æ–¹å—ä¿¡ã—ã€ãã®ã¾ã¾è»¢é€ãƒ»Redirect HTTP to HTTPSï¼šä¸¡æ–¹å—ä¿¡ã—ã€HTTPSã§è»¢é€ãƒ»HTTPS Onlyï¼šHTTPSã®ã¿å—ä¿¡ã—ã€HTTPSã§è»¢é€ Allowed HTTP Methods ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®ã†ã¡ã€ã‚ªãƒªã‚¸ãƒ³ã¸ã®è»¢é€ã‚’è¨±å¯ã™ã‚‹ã‚‚ã®ã‚’è¨­å®š ãƒ»ãƒ‘ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã€GETã®ã¿è¨±å¯ã€‚ãƒ»ãƒ‘ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå‹•çš„ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã€å…¨ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¨±å¯ã€‚ Object Caching CloudFrontã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¿å­˜ã—ã¦ãŠãç§’æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»Origin Cacheãƒ˜ãƒƒãƒ€ãƒ¼ã‚’é¸æŠã—ãŸå ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®Cache-Controlã®å€¤ãŒé©ç”¨ã•ã‚Œã‚‹ã€‚ãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚’é¸æŠã—ãŸå ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã®TTLã¨ã¯åˆ¥ã«è¨­å®šã§ãã‚‹ã€‚ TTL CloudFrontã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¿å­˜ã—ã¦ãŠãç§’æ•°ã‚’è©³ç´°ã«è¨­å®šã™ã‚‹ã€‚ ãƒ»Minã€Maxã€Defaultã€ã®å…¨ã¦ã‚’0ç§’ã¨ã™ã‚‹ã¨ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚ãƒ»ã€Headers = Allã€ã¨ã—ã¦ã„ã‚‹å ´åˆã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå®Ÿè³ªç„¡åŠ¹ã¨ãªã‚‹ãŸã‚ã€æœ€å°TTLã¯ã‚¼ãƒ­ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€çµ‚çš„ãªæœ‰åŠ¹æœŸé–“ã¯ã€CloudFrontã®TTLç§’ã®è¨­å®šã€Cache-Controlãƒ˜ãƒƒãƒ€ãƒ¼ã€Expiresãƒ˜ãƒƒãƒ€ãƒ¼ã®å€¤ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã£ã¦æ±ºã¾ã‚‹ã€‚ Whitelist Header Headers ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/Expiration.html#ExpirationDownloadDistãƒ»```Accept-xxxxx```ï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã—ã¦æ¬²ã—ã„ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡ï¼ˆãƒ‡ãƒ¼ã‚¿å‹ãªã©ï¼‰ã‚’æŒ‡å®šã€‚ãƒ» CloudFront-Is-xxxxx-Viewerï¼šãƒ‡ãƒã‚¤ã‚¹ã‚¿ã‚¤ãƒ—ã®Boolå€¤ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ Restrict Viewer Access ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡å…ƒã‚’åˆ¶é™ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã§ãã‚‹ã€‚ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã§åˆ¶å¾¡ã§ãã‚‹ãŸã‚ã€ã“ã“ã§ã¯è¨­å®šã—ãªãã¦ã‚ˆã„ã€‚ Compress Objects Automatically ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«gzipã‚’åœ§ç¸®ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®š ãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã®Accept-Encodingã«gzipãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«ã€gzipå½¢å¼ã§åœ§ç¸®ã—ã¦é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚è¨­å®šã—ãªã„å ´åˆã€åœ§ç¸®ã›ãšã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€Ÿåº¦å‘ä¸Šã®ãŸã‚ã€åŸºæœ¬çš„ã«ã¯æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ãƒ»ã‚ªãƒªã‚¸ãƒ³ã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ§‹é€  CloudFrontã‹ã‚‰ã‚ªãƒªã‚¸ãƒ³ã«é€ä¿¡ã•ã‚Œã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ§‹é€ ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ GET /foo/ # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³å Host: foo.com User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1 Authorization: Bearer X-Amz-Cf-Id: XXXXX Via: 2.0 77c20654dd474081d033f27ad1b56e1e.cloudfront.net (CloudFront) # å„Cookieã®å€¤ï¼ˆäºŒå›ç›®ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«è¨­å®šã•ã‚Œã‚‹ï¼‰ Cookie: sessionid=; __ulfpc=; _ga=; _gid= # é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ # â€»ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆALBã‚„CloudFrontãªã©ã‚‚å«ã‚€ï¼‰ã‚’çµŒç”±ã—ã¦ã„ã‚‹å ´åˆã€ãã‚Œã‚‰å…¨ã¦ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚é †ã«è¨­å®šã•ã‚Œã‚‹ X-Forwarded-For: , , Accept-Language: ja,en;q=0.9 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate, br pragma: no-cache cache-control: no-cache upgrade-insecure-requests: 1 sec-fetch-site: none sec-fetch-mode: navigate sec-fetch-user: ?1 sec-fetch-dest: document # ãƒ‡ãƒã‚¤ã‚¹ã‚¿ã‚¤ãƒ— CloudFront-Is-Mobile-Viewer: true CloudFront-Is-Tablet-Viewer: false CloudFront-Is-SmartTV-Viewer: false CloudFront-Is-Desktop-Viewer: false # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡å…ƒã®å›½å CloudFront-Viewer-Country: JP # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ—ãƒ­ãƒˆã‚³ãƒ« CloudFront-Forwarded-Proto: https ãƒ»CloudFrontã¨ã‚ªãƒªã‚¸ãƒ³é–“ã®HTTPSé€šä¿¡ CloudFrontã¨ã‚ªãƒªã‚¸ãƒ³é–“ã§HTTPSé€šä¿¡ã‚’è¡Œã†å ´åˆã€ä¸¡æ–¹ã«ãƒ‰ãƒ¡ã‚¤ãƒ³è¨¼æ˜æ›¸ã‚’å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å‰²ã‚Šå½“ã¦ãŸã¨ã—ã¦ã‚‚ã€ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã•ãªã„ã¨HTTPSé€šä¿¡ã‚’è¡Œã†ã“ã¨ã¯ã§ããªã„ã€‚CLoudFronã‹ã‚‰ã‚ªãƒªã‚¸ãƒ³ã«Hostãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è»¢é€ã—ãªã„è¨­å®šã®å ´åˆã€ã‚ªãƒªã‚¸ãƒ³ãŒè¿”å´ã™ã‚‹è¨¼æ˜æ›¸ã«ã€Origin Domain Nameã€ã¨ä¸€è‡´ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³åãŒå«ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ä¸€æ–¹ã§ã€Hostãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è»¢é€ã—ãªã„å ´åˆã€ã‚ªãƒªã‚¸ãƒ³ãŒè¿”å´ã™ã‚‹è¨¼æ˜æ›¸ã«ã€Origin Domain Nameã€ã¨ä¸€è‡´ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³åãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã€ã¾ãŸã¯ã‚ªãƒªã‚¸ãƒ³ãŒè¿”å´ã™ã‚‹è¨¼æ˜æ›¸ã«ã€Hostãƒ˜ãƒƒãƒ€ãƒ¼ã®å€¤ã¨ä¸€è‡´ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³åãŒå«ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ Reports & analytics ãƒ»Cache statistics ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢é€£ã™ã‚‹æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚’ã€æ—¥ä»˜åˆ¥ã«é›†è¨ˆã—ãŸã‚‚ã®ã‚’ç¢ºèªã§ãã‚‹ã€‚ ãƒ»Popular objects ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢é€£ã™ã‚‹æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚’ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåˆ¥ã«é›†è¨ˆã—ãŸã‚‚ã®ã‚’ç¢ºèªã§ãã‚‹ã€‚ ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¯å¦ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®æœ‰ç„¡ ãƒ»ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¯å¦ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®æœ‰ç„¡ã€ã®æ±ºã¾ã‚Šæ–¹ ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã™ã‚‹ã¹ããƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®Allï¼ˆå…¨è¨±å¯ï¼‰ï¼ä¸€éƒ¨è¨±å¯ï¼Noneï¼ˆå…¨æ‹’å¦ï¼‰ã§è¨­å®šã§ãã‚‹ã€‚ã¾ãŸã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®æœ‰ç„¡ã«ã‚‚é–¢ä¿‚ã—ã¦ã„ã‚‹ã€‚CloudFrontã§ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒJSONã¨ã—ã¦æ‰±ã‚ã‚Œã¦ãŠã‚Šã€JSONã®å€¤ãŒéå»ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«åˆè‡´ã—ãŸæ™‚ã®ã¿ã€ãã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨éå»ã®ã‚‚ã®ãŒåŒä¸€ã§ã‚ã‚‹ã¨è¦‹ãªã™ä»•çµ„ã¿ã«ãªã£ã¦ã„ã‚‹ã€‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¤å®šæ™‚ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¸›ã‚‰ã—ã€ãƒ’ãƒƒãƒˆç‡ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«ã€å…¨ã¦ã®é …ç›®ã§ã€Noneï¼ˆå…¨æ‹’å¦ï¼‰ã€ã‚’é¸æŠã—ãŸæ–¹ãŒè‰¯ã„ã€‚æœ€çµ‚çš„ã«ã€å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒCloudFrontã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®å¯¾è±¡ã¨ãªã£ã¦ã„ã‚‹ã‹ã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«å«ã¾ã‚Œã‚‹ã€X-Cache:ã€ãŒã€Hit from cloudfrontã€ã¾ãŸã¯ã€Miss from cloudfrontã€ã®ã©ã¡ã‚‰ã§åˆ¤æ–­ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/controlling-origin-requests.html https://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/controlling-the-cache-key.html ãƒ»ãƒ˜ãƒƒãƒ€ãƒ¼å€¤ã«åŸºã¥ãã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã®ã†ã¡ã€ã‚ªãƒªã‚¸ãƒ³ã¸ã®è»¢é€ã‚’è¨±å¯ã—ã€ã¾ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨è¦‹ãªã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚Cookieã¨ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã¨æ¯”ã¹ã¦ã€åŒã˜è¨­å®šã§ã‚‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®æœ‰ç„¡ãŒç•°ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/header-caching.html#header-caching-web ç¨®é¡ ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¯å¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®æœ‰ç„¡ å…¨è¨±å¯ å…¨ã¦ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã®è»¢é€ã‚’è¨±å¯ã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”Ÿæˆã—ãªã„ã€‚ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã—ã¤ã¤ã€å‹•çš„ã«ãªã‚Šã‚„ã™ã„å€¤ã‚’æŒã¤ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã«ã—ãªã„ã‚ˆã†ã«è¨­å®šã§ãã‚‹ã€‚ã“ã®æ™‚ã€ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã‚„Cookieã®é™çš„ãªå€¤ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨è¦‹ãªã›ã°ã€åŒä¸€ã¨è¦‹ãªã™ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¢—ãˆã€ãƒ’ãƒƒãƒˆç‡ã®å‘ä¸Šã«ã¤ãªãŒã‚‹ã€‚ ä¸€éƒ¨è»¢é€ ä¸€éƒ¨ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã®è»¢é€ã‚’æ‹’å¦ã—ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã®ç„¡ã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã€‚ æŒ‡å®šã—ãŸãƒ˜ãƒƒãƒ€ãƒ¼ã®ã¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨ã¿ãªã™ã€‚æ³¨æ„ç‚¹ã¨ã—ã¦ã€æ—¥ä»˜ã«é–¢ã™ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆAccept-Datetimeï¼‰ãªã©ã®å‹•çš„ãªå€¤ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨ã—ã¦ã—ã¾ã†ã¨ã€‚åŒä¸€ã¨è¦‹ãªã™ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã»ã¨ã‚“ã©ãªããªã‚Šã€ãƒ’ãƒƒãƒˆã—ãªããªã‚‹ã€‚ å…¨æ‹’å¦ å…¨ã¦ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã®è»¢é€ã‚’æ‹’å¦ã—ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã®ç„¡ã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”Ÿæˆã—ãªã„ã€‚ ãƒ»Cookieã«åŸºã¥ãã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆ Cookieæƒ…å ±ã®ã‚­ãƒ¼åã®ã†ã¡ã€ã‚ªãƒªã‚¸ãƒ³ã¸ã®è»¢é€ã‚’è¨±å¯ã—ã€ã¾ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨è¦‹ãªã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«å«ã¾ã‚Œã‚‹Cookieæƒ…å ±ï¼ˆã‚­ãƒ¼åï¼å€¤ï¼‰ãŒå¤‰å‹•ã—ã¦ã„ã‚‹ã¨ã€CloudFrontã«ä¿å­˜ã•ã‚ŒãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãƒ’ãƒƒãƒˆã—ãªã„ã€‚CloudFrontã¯ã‚­ãƒ¼åï¼å€¤ã‚’ä¿æŒã™ã‚‹ãŸã‚ã€å¤‰åŒ–ã—ã‚„ã™ã„ã‚­ãƒ¼åï¼å€¤ã¯ã€ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã—ãªã„ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚ä¾‹ãˆã°ã€GoogleAnalyticsã®ã‚­ãƒ¼åï¼ˆ_gaï¼‰ã®å€¤ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚ˆã£ã¦ç•°ãªã‚‹ãŸã‚ã€ï¼‘ãƒ¦ãƒ¼ã‚¶ãŒãƒ–ãƒ©ã‚¦ã‚¶ã‚’å¤‰ãˆã‚‹ãŸã³ã«ã€ç•°ãªã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚ãã®ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ã‚’ä¸€æ„ã«åˆ¤å®šã™ã‚‹ã“ã¨ãŒé›£ã—ããªã£ã¦ã—ã¾ã†ã€‚GoogleAnalyticsã®ã‚­ãƒ¼ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰Ajaxã§Googleã«é€ä¿¡ã•ã‚Œã‚‹ã‚‚ã®ã§ã€ã‚ªãƒªã‚¸ãƒ³ã«ã¨ã£ã¦ã‚‚åŸºæœ¬çš„ã«ä¸è¦ã§ã‚ã‚‹ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã¯Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã«é–¢ã‚ã‚‹ãƒ‘ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã®ã‚­ãƒ¼åã‚’è¨±å¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/Cookies.html ç¨®é¡ ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¯å¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®æœ‰ç„¡ å…¨è¨±å¯ å…¨ã¦ã®Cookieã®è»¢é€ã‚’è¨±å¯ã™ã‚‹ã€‚ å…¨ã¦ã®Cookieã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨ã¿ãªã™ã€‚ ä¸€éƒ¨è»¢é€ ä¸€éƒ¨ã®Cookieã®è»¢é€ã‚’æ‹’å¦ã—ã€Cookieã®ç„¡ã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã€‚ æŒ‡å®šã—ãŸCookieã®ã¿ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨ã¿ãªã™ã€‚Cookieã¯ãƒ¦ãƒ¼ã‚¶ã”ã¨ã«ä¸€æ„ã«ãªã‚‹ã“ã¨ãŒå¤šãã€å‹•çš„ã§ã‚ã‚‹ãŒã€ãã‚Œä»¥å¤–ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚„ã‚¯ã‚¨ãƒªæ–‡å­—ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ¤å®šã™ã‚‹ã‚ˆã†ã«ãªã‚‹ãŸã‚ã€åŒä¸€ã¨è¦‹ãªã™ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¢—ãˆã€ãƒ’ãƒƒãƒˆç‡ã®å‘ä¸Šã«ã¤ãªãŒã‚‹ã€‚ å…¨æ‹’å¦ å…¨ã¦ã®Cookieã®è»¢é€ã‚’æ‹’å¦ã—ã€Cookieã®ç„¡ã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”Ÿæˆã—ãªã„ã€‚ ãƒ»ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã«åŸºã¥ãã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆ ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®ã†ã¡ã€ã‚ªãƒªã‚¸ãƒ³ã¸ã®è»¢é€ã‚’è¨±å¯ã—ã€ã¾ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨è¦‹ãªã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚ç•°ãªã‚‹ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ¥ã€…ã«ä½œæˆã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/QueryStringParameters.html ç¨®é¡ ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¯å¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆã®æœ‰ç„¡ å…¨è¨±å¯ å…¨ã¦ã®ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®è»¢é€ã‚’è¨±å¯ã™ã‚‹ã€‚ å…¨ã¦ã®ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨ã¿ãªã™ã€‚ ä¸€éƒ¨æ‹’å¦ ä¸€éƒ¨ã®ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®è»¢é€ã‚’æ‹’å¦ã—ã€ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®ç„¡ã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã™ã‚‹ã€‚ æŒ‡å®šã—ãŸã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®ã¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã¨ã¿ãªã™ã€‚ å…¨æ‹’å¦ å…¨ã¦ã®ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®è»¢é€ã‚’æ‹’å¦ã—ã€ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®ç„¡ã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”Ÿæˆã—ãªã„ã€‚ ãƒ»Cookieã‚„ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã‚’ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã—ã¤ã¤ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”Ÿæˆã—ãªã„å ´åˆ ä¸Šè¨˜ã®è¨­å®šã§ã¯ã€Cookieã‚„ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã‚’ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã—ã¤ã¤ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”Ÿæˆã—ãªã„ã‚ˆã†ã«ã§ããªã„ã€‚ãã“ã§ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€å¤§æœ€å°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æœ‰åŠ¹æœŸé–“ã‚’0ç§’ã¨ã™ã‚‹ã“ã¨ã§ã€çµæœçš„ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ©Ÿèƒ½ã—ãªã„ã‚ˆã†ã«ã•ã›ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒç”Ÿæˆã•ã‚Œã¦ã„ãªã„ã‹ã®ã‚ˆã†ã«è¦‹ã›ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ ãƒ˜ãƒƒãƒ€ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡å‘ä¸Š ãƒ»ãƒ’ãƒƒãƒˆç‡ã®å‘ä¸Šã«ã¤ã„ã¦ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/header-caching.html Cookieã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡å‘ä¸Š ãƒ»ãƒ’ãƒƒãƒˆç‡ã®å‘ä¸Šã«ã¤ã„ã¦ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/Cookies.html ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡å‘ä¸Š ãƒ»ãƒ’ãƒƒãƒˆç‡ã®å‘ä¸Šã«ã¤ã„ã¦ CloudFrontã¯ã€ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã«ã‚ˆã£ã¦ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆã—ã€æ¬¡å›ã€åŒã˜ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã§ã‚ã£ãŸå ´åˆã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½œæˆã®ãƒ«ãƒ¼ãƒ«ã‚’ç†è§£ã™ã‚Œã°ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡ã‚’å‘ä¸Šã•ã›ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/cache-hit-ratio.html#cache-hit-ratio-query-string-parameters https://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/QueryStringParameters.html#query-string-parameters-optimizing-caching ãƒ»ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®é †ç•ªã‚’å›ºå®šã™ã‚‹ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã®ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®é †ç•ªãŒç•°ãªã‚‹å ´åˆã€CloudFrontã¯ãã‚Œãã‚Œã‚’ç•°ãªã‚‹URLã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨è¦‹ãªã—ã€åˆ¥ã€…ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆã™ã‚‹ã€‚ãã®ãŸã‚ã€ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®é †ç•ªã‚’å›ºå®šã™ã‚‹ã‚ˆã†ã«URLã‚’è¨­è¨ˆã™ã‚Œã°ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡ã‚’å‘ä¸Šã•ã›ã‚‰ã‚Œã‚‹ã€‚ GET https://example.co.jp?fooId=1&barId=2 GET https://example.co.jp?barId=2&fooId=1 ãƒ»ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®å¤§æ–‡å­—å°æ–‡å­—è¡¨è¨˜ã‚’å›ºå®šã™ã‚‹ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã®ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®å¤§æ–‡å­—å°æ–‡å­—è¡¨è¨˜ãŒç•°ãªã‚‹å ´åˆã€CloudFrontã¯ãã‚Œãã‚Œã‚’ç•°ãªã‚‹URLã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨è¦‹ãªã—ã€åˆ¥ã€…ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆã™ã‚‹ã€‚ãã®ãŸã‚ã€ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã®å¤§æ–‡å­—å°æ–‡å­—è¡¨è¨˜ã‚’å›ºå®šã™ã‚‹ã‚ˆã†ã«URLã‚’è¨­è¨ˆã™ã‚Œã°ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡ã‚’å‘ä¸Šã•ã›ã‚‰ã‚Œã‚‹ã€‚ GET https://example.co.jp?fooId=1&barId=2 GET https://example.co.jp?FooId=1&BarId=2 ãƒ»ç½²åä»˜ãURLã¨åŒã˜ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã‚’ä½¿ç”¨ã—ãªã„ S3ã«ã¯ã€ç½²åä»˜ãURLã‚’ç™ºè¡Œã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚‹ã€‚CloudFrontã®ä»•æ§˜ã§ã¯ã€ç½²åä»˜ãURLã«å«ã¾ã‚Œã‚‹Expiresã€Key-Pair-Idã€Policyã€Signatureã¨ã„ã£ãŸã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã‚’å‰Šé™¤ã—ãŸã†ãˆã§ã€ã‚ªãƒªã‚¸ãƒ³ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã€‚ã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆã®åˆ¤å®šè¦ç´ ã¨ã—ã¦ä½¿ãˆãªã„ã€‚ãã®ãŸã‚ã€URLã®è¨­è¨ˆæ™‚ã«ã“ã‚Œã‚‰ã‚’ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ Invalidationï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å‰Šé™¤ï¼‰ TTLç§’ã«ã‚ˆã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®è‡ªå‹•å‰Šé™¤ã‚’å¾…ãŸãšã«ã€æ‰‹å‹•ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã§ãã‚‹ã€‚å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã—ãŸã„å ´åˆã¯ã€/*ã€ã€ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã—ãŸã„å ´åˆã¯ã€/ã€ã€ã‚’è¨­å®šã™ã‚‹ã€‚CloudFrontã«é–¢ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆã€ä¸å…·åˆã‚’ä¿®æ­£ã—ãŸå¾Œã§ã‚‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ®‹ã£ã¦ã„ã‚‹ã¨ã€ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†ãŸã‚ã€ä½œæ¥­å¾Œã«ã¯å¿…ãšã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã™ã‚‹ã€‚ ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¨ãƒƒã‚¸ã‚µãƒ¼ãƒ ãƒ»Point Of Presence CloudFrontã¯ä¸–ç•Œä¸­ã«è¨­ç½®ã•ã‚Œã‚‹ã€Point Of Presenceï¼ˆã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‹ä¸­é–“å±¤ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ã€ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/cloudfront/features/?whats-new-cloudfront.sort-by=item.additionalFields.postDateTime&whats-new-cloudfront.sort-order=desc ãƒ»ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹å…¨ã‚¨ãƒƒã‚¸ã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ CloudFrontã«ã¯ã€ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ•°ã ã‘ã‚¨ãƒƒã‚¸ã‚µãƒ¼ãƒãŒã‚ã‚Šã€å„ã‚µãƒ¼ãƒã«IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã€å…¨ã¦ã®ã‚¨ãƒƒã‚¸ã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèªã§ãã‚‹ã€‚ $ curl https://ip-ranges.amazonaws.com/ip-ranges.json \\ | jq \".prefixes[]| select(.service==\"CLOUDFRONT\") | .ip_prefix\" ã‚‚ã—ãã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’ç›´æ¥å‚è€ƒã—ã€ã€\"service\": \"CLOUDFRONT\"ã€ã¨ãªã£ã¦ã„ã‚‹éƒ¨åˆ†ã‚’æ¢ã™ã€‚ å‚è€ƒï¼šhttps://ip-ranges.amazonaws.com/ip-ranges.json ãƒ»ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½¿ç”¨ä¸­ã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ CloudFrontã«ã¯ã€ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã€å„ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚µãƒ¼ãƒãŒã‚ã‚‹ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã€ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ã‚‹ä½¿ç”¨ä¸­ã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèªã§ãã‚‹ã€‚ $ nslookup .cloudfront.net ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ ãƒ»ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã¨ã¯ ã‚ªãƒªã‚¸ãƒ³ã«è©²å½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ã‚ªãƒªã‚¸ãƒ³ã¯CloudFrontã«ä»¥ä¸‹ã®403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã€‚ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã‚’è¨­å®šã—ãªã„å ´åˆã€CloudFrontã¯ã“ã®403ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ãã®ã¾ã¾ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã—ã¦ã—ã¾ã†ãŸã‚ã€ã‚ªãƒªã‚¸ãƒ³ã«é…ç½®ã—ãŸã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã‚’404ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚ This XML file does not appear to have any style information associated with it. The document tree is shown below. AccessDenied Access Denied ***** ***** ãƒ»è¨­å®šæ–¹æ³• ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ãƒ‘ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®šç¾©ã™ã‚‹ã€‚Lamnda@Edgeã‚’ç”¨ã„ãŸCloudFrontã®å ´åˆã¯ã€Lambda@Edgeã‚’çµŒç”±ã—ã¦ã€ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/HTTPStatusCodes.html 08. CloudTrail CloudTrailã¨ã¯ IAMãƒ¦ãƒ¼ã‚¶ã«ã‚ˆã‚‹æ“ä½œã‚„ã€ãƒ­ãƒ¼ãƒ«ã®ã‚¢ã‚¿ãƒƒãƒã®å±¥æ­´ã‚’è¨˜éŒ²ã—ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦S3ã«è»¢é€ã™ã‚‹ã€‚CloudWatchã¨é€£æºã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ 09. CloudWatch CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒ»CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã¯ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã§ç¨¼åƒã™ã‚‹å¸¸é§ã‚·ã‚¹ãƒ†ãƒ ã®ã“ã¨ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã€CloudWatchã«å¯¾ã—ã¦é€ä¿¡ã™ã‚‹ã€‚ ãƒ»CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¨­å®š ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç¨®é¡ èª¬æ˜ è£œè¶³ agentã‚»ã‚¯ã‚·ãƒ§ãƒ³ CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå…¨ä½“ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸå ´åˆã€ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¨­å®šã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã€‚ãƒ»å®Ÿè£…ã—ãªã‹ã£ãŸå ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒé©ç”¨ã•ã‚Œã‚‹ã€‚ metricsã‚»ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸå ´åˆã€ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¨­å®šã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã€‚ãƒ»å®Ÿè£…ã—ãªã‹ã£ãŸå ´åˆã€ä½•ã‚‚è¨­å®šã•ã‚Œãªã„ã€‚ logsã‚»ã‚¯ã‚·ãƒ§ãƒ³ CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€/opt/aws/amazon-cloudwatch-agent/bin/config.jsonãƒ•ã‚¡ã‚¤ãƒ«ã®å®šç¾©ã‚’å…ƒã«ã€å®Ÿè¡Œã•ã‚Œã‚‹ã€‚è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯åˆ†å‰²ã§ãã‚‹ã€‚è¨­å®šå¾Œã€amazon-cloudwatch-agent-ctlã‚³ãƒãƒ³ãƒ‰ã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¾ã›ã‚‹ã€‚CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã€CloudWatchã«ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€ä¿¡ã™ã‚‹ã ã‘ã§ã‚ã‚Œã°ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ/opt/aws/amazon-cloudwatch-agent/bin/config.jsonï¼‰ã«ã¯logã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã¿ã®å®Ÿè£…ã§è‰¯ã„ã€‚run_as_userã«ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¦ãƒ¼ã‚¶åï¼ˆä¾‹ï¼šcwagentï¼‰ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"agent\": { \"run_as_user\": \"cwagent\" }, \"logs\": { \"logs_collected\": { \"files\": { \"collect_list\": [ { \"file_path\": \"/var/log/nginx/error.log\", \"log_group_name\": \"/foo-www/var/log/nginx/error_log\", \"log_stream_name\": \"{instance_id}\" }, { \"file_path\": \"/var/log/php-fpm/error.log\", \"log_group_name\": \"/foo-www/var/log/php-fpm/error_log\", \"log_stream_name\": \"{instance_id}\" } ] } } } } ãƒ»ãƒ­ã‚°é€ä¿¡æ¨©é™ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/logs/AWS-logs-and-resource-policy.html ãƒ»æ“ä½œã‚³ãƒãƒ³ãƒ‰ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š # EC2å†…ã«ã‚ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«èª­ã¿è¾¼ã¾ã›ã‚‹ï¼ˆå†èµ·å‹•ã‚’å«ã‚€ï¼‰ $ /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \\ -a fetch-config \\ -m ec2 \\ -s \\ -c file:/opt/aws/amazon-cloudwatch-agent/bin/config.json # ãƒ—ãƒ­ã‚»ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª $ /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \\ -m ec2 \\ -a status # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‹ã‚’ç¢ºèª ### CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« $ tail -f /opt/aws/amazon-cloudwatch-agent/logs/amazon-cloudwatch-agent.log ### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« $ tail -f /opt/aws/amazon-cloudwatch-agent/logs/configuration-validation.log ### OSèµ·å‹•æ™‚ã«ãƒ‡ãƒ¼ãƒ¢ãƒ³ãŒç¨¼åƒã™ã‚‹ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèª $ systemctl list-unit-files --type=service 09-02. CloudWatchãƒ¡ãƒˆãƒªã‚¯ã‚¹ CloudWatchãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã¯ AWSãƒªã‚½ãƒ¼ã‚¹ã§ç™ºç”Ÿã—ãŸãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability.html ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åˆ†é¡å ãƒ»ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã€åå‰ç©ºé–“ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹å åˆ†é¡ç¾¤ èª¬æ˜ ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å˜ä½ã¨ã—ãŸåˆ†é¡åã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹IDã§å‘½åã•ã‚Œã‚‹ã€‚ åå‰ç©ºé–“ AWSãƒªã‚½ãƒ¼ã‚¹ã‚’å˜ä½ã¨ã—ãŸåˆ†é¡åã€‚AWSãƒªã‚½ãƒ¼ã‚¹åã§è¡¨ç¾ã•ã‚Œã‚‹ã€‚ ãƒ¡ãƒˆãƒªã‚¯ã‚¹å é›†è¨ˆå¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®ç™ºç”Ÿé ˜åŸŸã‚’å˜ä½ã¨ã—ãŸåˆ†é¡åã€‚ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®ç™ºç”Ÿé ˜åŸŸåã§è¡¨ç¾ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/cloudwatch_concepts.html https://www.slideshare.net/AmazonWebServicesJapan/20190326-aws-black-belt-online-seminar-amazon-cloudwatch CloudWatchãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¸Šã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ç¢ºèªã§ãã‚‹ã€‚ CloudWatch Synthetics ãƒ»CloudWatch Syntheticsã¨ã¯ åˆæˆç›£è¦–ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ ãƒ»ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¯ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¤ãƒ³ã‚µã‚¤ãƒˆ RDSï¼ˆAuroraã€éAuroraï¼‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚SQLãƒ¬ãƒ™ãƒ«ã§ç›£è¦–ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®performance_schemaã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å¯¾å¿œã™ã‚‹ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/USER_PerfInsights.Enabling.html https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/USER_PerfInsights.Overview.Engines.html ãƒ»Containerã‚¤ãƒ³ã‚µã‚¤ãƒˆ ECSï¼EKSã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ï¼EKSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã€ECSã‚µãƒ¼ãƒ“ã‚¹ã€ECSã‚¿ã‚¹ã‚¯ã€ECSã‚³ãƒ³ãƒ†ãƒŠã€å˜ä½ã§ç›£è¦–ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ã¾ãŸã€ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ç¹‹ãŒã‚Šã‚’ã‚³ãƒ³ãƒ†ãƒŠãƒãƒƒãƒ—ã§è¦–è¦šåŒ–ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ECSï¼EKSã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®šã§Containerã‚¤ãƒ³ã‚µã‚¤ãƒˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»Lambdaã‚¤ãƒ³ã‚µã‚¤ãƒˆ Lambdaã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ 09-03. CloudWatchãƒ­ã‚° CloudWatchãƒ­ã‚° ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ­ã‚°ã‚µãƒ¼ãƒã¨ã—ã¦åƒãã€‚AWSãƒªã‚½ãƒ¼ã‚¹ã§ç”Ÿæˆã•ã‚ŒãŸãƒ­ã‚°ã‚’åé›†ã§ãã‚‹ã€‚ãƒ­ã‚°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability.html è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ— ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¦åé›†ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ åŸºæœ¬çš„ã«ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã›ãšã«ã€ä¸€ã¤ã®ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯ä¸€ã¤ã®ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã—ã‹å«ã¾ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆè‡´ã—ãŸæ–‡å­—åˆ—ã‚’æŒã¤ãƒ­ã‚°ã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’ç™ºç”Ÿã•ã›ã‚‹ã€‚ã“ã‚Œã‚’åé›†ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ­ã‚°å†…ã§æ¤œçŸ¥ã™ã‚‹æ–‡å­—åˆ—ã‚’è¨­å®šã™ã‚‹ã€‚å¤§æ–‡å­—ã¨å°æ–‡å­—ã‚’åŒºåˆ¥ã™ã‚‹ãŸã‚ã€ç¶²ç¾…çš„ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/shimajiri/items/81a4ed0fe39fe337fedb ï¼Šä¾‹ï¼Š ORæ¡ä»¶ã§å¤§æ–‡å­—å°æ–‡å­—ã‚’è€ƒæ…®ã—ã€ã€:ã€ãŒå«ã¾ã‚Œã‚‹ãƒ­ã‚°ã‚’æ¤œå‡ºã™ã‚‹ã€‚ã“ã“ã§ã‚³ãƒ­ãƒ³ã‚’å«ã¾ã¦ã„ã‚‹ã®ã¯ã€ãƒ­ã‚°ã«å«ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åã‚„ãƒ¡ã‚½ãƒƒãƒ‰åãŒèª¤ã£ã¦æ¤œçŸ¥ã•ã‚Œãªã„ã‚ˆã†ã™ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚ ?\"WARNING:\" ?\"Warning:\" ?\"ERROR:\" ?\"Error:\" ?\"CRITICAL:\" ?\"Critical:\" ?\"EMERGENCY:\" ?\"Emergency:\" ?\"ALERT:\" ?\"Alert:\" ï¼Šä¾‹ï¼Š ORæ¡ä»¶ã§å¤§æ–‡å­—å°æ–‡å­—ã‚’è€ƒæ…®ã—ã€ã€ messageã€ãŒå«ã¾ã‚Œã‚‹ãƒ­ã‚°ã‚’æ¤œå‡ºã™ã‚‹ã€‚ ?\"WARNING message\" ?\"Warning message\" ?\"ERROR message\" ?\"Error message\" ?\"CRITICAL message\" ?\"Critical message\" ?\"EMERGENCY message\" ?\"Emergency message\" ?\"ALERT message\" ?\"Alert message\" ï¼Šä¾‹ï¼Š ã€error:ã€ãŒå«ã¾ã‚Œã€ã‹ã¤ã€Fooã€ãŒå«ã¾ã‚Œãªã„ãƒ­ã‚°ã‚’æ¤œçŸ¥ã™ã‚‹ã€‚ORæ¡ä»¶ã¨é™¤å¤–æ¡ä»¶ã‚’çµ„ã¿åˆã‚ã›ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ORæ¡ä»¶ãŒèªè­˜ã•ã‚Œãšã«é™¤å¤–æ¡ä»¶ã ã‘ãŒé©ç”¨ã•ã‚Œã¦ã—ã¾ã†ã€‚ãã®ãŸã‚ã€ã“ã“ã§ã¯ORæ¡ä»¶ã‚’ç”¨ã„ã¦ã„ãªã„ã€‚ å‚è€ƒï¼šhttps://dev.classmethod.jp/articles/cloudwatch-metricsfilter-filterpattern/ \"error:\" -Foo CloudWatchãƒ­ã‚°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆéæ¨å¥¨ï¼‰ ãƒ»CloudWatchãƒ­ã‚°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã¯ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã§ç¨¼åƒã™ã‚‹å¸¸é§ã‚·ã‚¹ãƒ†ãƒ ã®ã“ã¨ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã€CloudWatchãƒ­ã‚°ã«å¯¾ã—ã¦é€ä¿¡ã™ã‚‹ã€‚2020/10/05ç¾åœ¨ã¯éæ¨å¥¨ã§ã€CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®è¨­å®šã®ç§»è¡ŒãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ»awslogs.confãƒ•ã‚¡ã‚¤ãƒ« ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã®etcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸‹ã«awslogs.confãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€è¨­ç½®ã™ã‚‹ã€‚OSã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã®å„å±¤ã§ãƒ­ã‚°ã‚’åé›†ã™ã‚‹ã®ãŒã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/logs/AgentReference.html#agent-configuration-file ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################# # /var/awslogs/awslogs.conf ############################# # ------------------------------------------ # CentOS CloudWatch Logs # ------------------------------------------ [/var/log/messages] # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— #ï¼ˆä¾‹ï¼‰Jan 1 00:00:00 datetime_format = %b %d %H:%M:%S #ï¼ˆä¾‹ï¼‰2020-01-01 00:00:00 # datetime_format = %Y-%m-%d %H:%M:%S # åé›†ã—ãŸã„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ã“ã“ã§ã¯ã€CentOSã®ãƒ­ã‚°ã‚’è¨­å®šã™ã‚‹ã€‚ file = /var/log/messages # æ–‡å­—ã‚³ãƒ¼ãƒ‰utf_8ã¨ã—ã¦é€ä¿¡ã™ã‚‹ã€‚æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒåˆã‚ãªã„ã¨ã€CloudWatchãƒ­ã‚°ã®ç”»é¢ä¸Šã§æ–‡å­—åŒ–ã‘ã™ã‚‹ã€‚ encoding = utf_8 # è¦å‹‰å¼· buffer_duration = 5000 initial_position = start_of_file # ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ID log_stream_name = {instance_id} # AWSä¸Šã§ç®¡ç†ã™ã‚‹ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—å log_group_name = /var/log/messages # ------------------------------------------ # Nginx CloudWatch Logs # ------------------------------------------ [/var/log/nginx/error.log] file = /var/log/nginx/error.log buffer_duration = 5000 log_stream_name = {instance_id} initial_position = start_of_file log_group_name = /var/log/nginx/error_log.production # ------------------------------------------ # Application CloudWatch Logs # ------------------------------------------ [/var/www/project/app/storage/logs/laravel.log] file = /var/www/project/app/storage/logs/laravel.log buffer_duration = 5000 log_stream_name = {instance_id} initial_position = start_of_file log_group_name = /var/www/project/app/storage/logs/laravel_log.production ############################# # /var/awslogs/awscli.conf ############################# [plugins] cwlogs = cwlogs [default] region = ap-northeast-1 ãƒ»ã‚³ãƒãƒ³ãƒ‰ è¨­å®šå¾Œã€awslogsã‚³ãƒãƒ³ãƒ‰ã§ãƒ—ãƒ­ã‚»ã‚¹ã‚’èµ·å‹•ã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š # CloudWatchã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å†èµ·å‹• # æ³¨æ„: restartã ã¨CloudWatchã«åæ˜ ã•ã‚Œãªã„æ™‚ãŒã‚ã‚‹ã€‚ $ service awslogs restart # ã‚‚ã—ãã¯ $ service awslogs stop $ service awslogs start # ãƒ­ã‚°ãŒæ–°ã—ãç”Ÿæˆã•ã‚Œãªã„ã¨å¤‰æ›´ãŒé©ç”¨ã•ã‚Œãªã„ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã«é©å½“ãªæ–‡å­—åˆ—è¡Œã‚’å¢—ã‚„ã—ã¦ã¿ã‚‹ã€‚ Logã‚¤ãƒ³ã‚µã‚¤ãƒˆ ãƒ»Logã‚¤ãƒ³ã‚µã‚¤ãƒˆã¨ã¯ ã‚¯ã‚¨ãƒªã‚’ç”¨ã„ã¦ãƒ­ã‚°ã‚’æŠ½å‡ºã™ã‚‹ã€‚ ãƒ»ã‚¯ã‚¨ãƒªä¾‹ æ±ç”¨çš„ãªã‚¯ã‚¨ãƒªã‚’ç¤ºã™ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/logs/CWL_QuerySyntax.html ï¼Šä¾‹ï¼Š å°æ–‡å­—ã¨å¤§æ–‡å­—ã‚’åŒºåˆ¥ã›ãšã«ã€Warningã¾ãŸã¯Errorã‚’å«ã‚€ãƒ­ã‚°ã‚’æ¤œç´¢ã™ã‚‹ã€‚ fields @timestamp, @message, @logStream | filter @message like /(?i)(Warning|Error)/ | sort @timestamp desc | limit 100 CLI ãƒ»ãƒ­ã‚°åé›†é‡ã‚’ç¢ºèª ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š å…¨ã¦ã®ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã«å¯¾ã—ã¦ã€ä¸€æ—¥å½“ãŸã‚Šã®åé›†é‡ã‚’start-timeã‹ã‚‰end-timeã®é–“ã§å–å¾—ã™ã‚‹ã€‚--dimensionsã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦ã€ç‰¹å®šã®ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ï¼ˆãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰ã«å¯¾ã—ã¦é›†è¨ˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ï¼ˆãŸã ã€ã‚„ã£ã¦ã¿ãŸã‘ã©ã†ã¾ãã„ã‹ãšï¼‰ å‚è€ƒï¼šhttps://docs.aws.amazon.com/cli/latest/reference/cloudwatch/get-metric-statistics.html $ aws cloudwatch get-metric-statistics \\ --namespace AWS/Logs \\ --metric-name IncomingBytes \\ --start-time \"2021-08-01T00:00:00\" \\ --end-time \"2021-08-31T23:59:59\" \\ --period 86400 --statistics Sum | jq -r \".Datapoints[] | [.Timestamp, .Sum] | @csv\" | sort 09-04. CloudWatchã‚¢ãƒ©ãƒ¼ãƒ  è¨­å®šé …ç›® ãƒ»ãƒ­ã‚°ãŒå¯¾è±¡ã®å ´åˆ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ åå‰ç©ºé–“ ç´ä»˜ããƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ãŒå±ã™ã‚‹åå‰ç©ºé–“ã‚’è¨­å®šã™ã‚‹ã€‚CloudWatchãƒ­ã‚°ãŒã€è¨­å®šã—ãŸåå‰ç©ºé–“ã«å¯¾ã—ã¦ã€å€¤ã‚’ç™ºè¡Œã™ã‚‹ã€‚ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ ç´ä»˜ããƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ãŒå±ã™ã‚‹åå‰ç©ºé–“å†…ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚CloudWatchãƒ­ã‚°ãŒã€è¨­å®šã—ãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å¯¾ã—ã¦ã€å€¤ã‚’ç™ºè¡Œã™ã‚‹ã€‚ ãƒ¡ãƒˆãƒªã‚¯ã‚¹å€¤ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ãƒ­ã‚°ãŒæ¤œçŸ¥ã•ã‚ŒãŸæ™‚ã«ã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ç™ºç”Ÿã•ã›ã‚‹å€¤ã®ã“ã¨ã€‚ ä¾‹ãˆã°ã€æ¤œå‡ºæ•°ã€ã‚’ç™ºè¡Œã™ã‚‹å ´åˆã¯ã€ã€ï¼‘ã€ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒå¯¾è±¡ã®å ´åˆ ãƒ»æ¡ä»¶ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ é–¾å€¤ã®ç¨®é¡ ã‚¢ãƒ©ãƒ¼ãƒ ã‚’å®Ÿè¡Œã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆ ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç™ºç”Ÿã•ã›ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆæ•°ã‚’è¨­å®šã™ã‚‹ã€‚ æ¬ è½ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç† ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆãŒç™ºç”Ÿã—ãªã„ã“ã¨ã‚’ã©ã†åˆ¤å®šã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆãŒç™ºç”Ÿã—ãªã„ã“ã¨ã‚’æ­£å¸¸ã¨è¦‹ãªã™å ´åˆã¯ã€notBreachingã€ã¨ã—ã€ç™ºç”Ÿã—ãªã„ã“ã¨ã‚’ç•°å¸¸ã¨ã™ã‚‹å ´åˆã¯ã€ã€breachingã€ã¨ã™ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html#alarms-and-missing-data CLI ãƒ»CloudWatchã‚¢ãƒ©ãƒ¼ãƒ ã®çŠ¶æ…‹å¤‰æ›´ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š CloudWatchã‚¢ãƒ©ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹ã€‚ $ aws cloudwatch set-alarm-state \\ --alarm-name \"prd-foo-alarm\" \\ --state-value ALARM \\ --state-reason \"ã‚¢ãƒ©ãƒ¼ãƒ !!\" 10. Codeç³»ã‚µãƒ¼ãƒ“ã‚¹ CodePipeline ãƒ»CodePipelineã¨ã¯ CodeCommitã€CodeBuildã€CodeDeployã‚’é€£æºã•ã›ã¦ã€AWSã«å¯¾ã™ã‚‹CI/CDç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ã€‚CodeCommitã¯ã€ä»–ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹ã§ä»£ç”¨ã§ãã‚‹ã€‚ ãƒ»CodeCommitã¨ã¯ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã‚‹ã€‚ ãƒ»CodeBuildã¨ã¯ ãƒ“ãƒ«ãƒ‰ãƒ•ã‚§ãƒ¼ã‚ºã¨ãƒ†ã‚¹ãƒˆãƒ•ã‚§ãƒ¼ã‚ºã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ãƒ»CodeDeployã¨ã¯ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ã‚§ãƒ¼ã‚ºã‚’å®Ÿè¡Œã™ã‚‹ã€‚ CodeBuild ãƒ»buildspec.ymlãƒ•ã‚¡ã‚¤ãƒ« CodeBuildã®è¨­å®šã‚’è¡Œã†ã€‚ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç›´ä¸‹ã«é…ç½®ã—ã¦ãŠãã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/codebuild/latest/userguide/build-spec-ref.html version: 0.2 phases: install: runtime-versions: docker: 18 preBuild: commands: # ECRã«ãƒ­ã‚°ã‚¤ãƒ³ - $(aws ecr get-login --no-include-email --region ${AWS_DEFAULT_REGION}) # ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚°ã¯GitHubã‚³ãƒŸãƒƒãƒˆã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’ä½¿ç”¨ - IMAGE_TAG=$CODEBUILD_RESOLVED_SOURCE_VERSION # ECRã®URLã‚’CodeBuildã®ç’°å¢ƒå¤‰æ•°ã‹ã‚‰ä½œæˆ - REPOSITORY_URI=${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_DEFAULT_REGION}.amazonaws.com/${IMAGE_REPO_NAME} build: commands: # ã‚¿ã‚°ä»˜ã‘ã—ã¦ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ - docker build -t REPOSITORY_URI:$IMAGE_TAG -f Dockerfile . postBuild: commands: # ECRã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒƒã‚·ãƒ¥ - docker push $REPOSITORY_URI:$IMAGE_TAG # ECRã«ã‚ã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æƒ…å ±ï¼ˆimageDetail.jsonï¼‰ - printf \"{\"Version\":\"1.0\",\"ImageURI\":\"%s\"}\" $REPOSITORY_URI:$IMAGE_TAG > imageDetail.json # ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ã¨ã™ã‚‹ãƒ“ãƒ«ãƒ‰ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆ artifacts: files: imageDetail.json ãƒ»ãƒ“ãƒ«ãƒ‰æ™‚ã«ä½œæˆã™ã¹ããƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ã¨ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã€æ¨™æº–ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å ´åˆã«ã¯imagedefinitions.jsonãƒ•ã‚¡ã‚¤ãƒ«ã€ã¾ãŸã¯Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®å ´åˆã«ã¯imageDetail.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã‚Œã¯ãƒªãƒã‚¸ãƒˆãƒªã«äº‹å‰ã«é…ç½®ã™ã‚‹ã®ã§ã¯ãªãã€ãƒ“ãƒ«ãƒ‰æ™‚ã«è‡ªå‹•çš„ã«ä½œæˆã™ã‚‹ã‚ˆã†ã«ã—ãŸæ–¹ãŒã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/codepipeline/latest/userguide/file-reference.html CodeDeployã«ã‚ˆã‚‹Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ ãƒ»Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã¨ã¯ ä»¥ä¸‹ã®æ‰‹é †ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã†ã€‚ ECRã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ›´æ–° ã‚¿ã‚¹ã‚¯å®šç¾©ã®æ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã€‚ ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ›´æ–°ã€‚ CodeDeployã«ã‚ˆã£ã¦ã€ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’åŸºã«ã€ç¾è¡Œã®æœ¬ç•ªç’°å¢ƒï¼ˆProdãƒ–ãƒ«ãƒ¼ï¼‰ã®ã‚¿ã‚¹ã‚¯ã¨ã¯åˆ¥ã«ã€ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼ˆTestã‚°ãƒªãƒ¼ãƒ³ï¼‰ãŒæ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã®æ¥ç¶šå…ˆã‚’ã€æœ¬ç•ªç’°å¢ƒï¼ˆProdãƒ–ãƒ«ãƒ¼ï¼‰ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆPrimaryã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ï¼‰ã«åŠ ãˆã¦ã€ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼ˆTestã‚°ãƒªãƒ¼ãƒ³ï¼‰ã«ã‚‚å‘ã‘ã‚‹ã€‚ ç¤¾å†…ã‹ã‚‰ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼ˆTestã‚°ãƒªãƒ¼ãƒ³ï¼‰ã®ALBã«ã€ç‰¹å®šã®ãƒãƒ¼ãƒˆç•ªå·ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã€å‹•ä½œã‚’ç¢ºèªã™ã‚‹ã€‚ å‹•ä½œç¢ºèªã§å•é¡Œãªã‘ã‚Œã°ã€Consoleç”»é¢ã‹ã‚‰ã®å…¥åŠ›ã§ã€ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã®æ¥ç¶šå…ˆã‚’ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼ˆTestã‚°ãƒªãƒ¼ãƒ³ï¼‰ã®ã¿ã«è¨­å®šã™ã‚‹ã€‚ ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼ˆTestã‚°ãƒªãƒ¼ãƒ³ï¼‰ãŒæ–°ã—ã„æœ¬ç•ªç’°å¢ƒã¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ã«å…¬é–‹ã•ã‚Œã‚‹ã€‚ å…ƒã€…ã®æœ¬ç•ªç’°å¢ƒï¼ˆProdãƒ–ãƒ«ãƒ¼ï¼‰ã¯å‰Šé™¤ã•ã‚Œã‚‹ã€‚ ãƒ»appspec.ymlãƒ•ã‚¡ã‚¤ãƒ« CodeDeployã®è¨­å®šã‚’è¡Œã†ã€‚ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç›´ä¸‹ã«é…ç½®ã—ã¦ãŠãã€‚ä»•æ§˜ã¨ã—ã¦ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ããªã„ã€‚ã‚¿ã‚¹ã‚¯å®šç¾©åã‚’ã¨ã™ã‚‹ã¨ã€è‡ªå‹•è£œå®Œã—ã¦ãã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/codedeploy/latest/userguide/reference-appspec-file-structure-resources.html version: 0.0 Resources: - TargetService: # ç”¨ã„ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ Type: AWS::ECS::Service Properties: # ç”¨ã„ã‚‹ã‚¿ã‚¹ã‚¯å®šç¾© TaskDefinition: \"\" # ç”¨ã„ã‚‹ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ LoadBalancerInfo: ContainerName: \"\" ContainerPort: \"80\" PlatformVersion: \"1.4.0\" ãƒ»taskdef.jsonãƒ•ã‚¡ã‚¤ãƒ« ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’å®Ÿè£…ã—ã€ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç›´ä¸‹ã«é…ç½®ã™ã‚‹ã€‚CodeDeployã¯ã€CodeBuildã‹ã‚‰æ¸¡ã•ã‚ŒãŸimageDetail.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œçŸ¥ã—ã€ECRã‹ã‚‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹ã€‚ã“ã®æ™‚ã€taskdef.jsonãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ¡ãƒ¼ã‚¸åã‚’ã¨ã—ã¦ãŠãã¨ã€ECRã‹ã‚‰å–å¾—ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸åã‚’ç”¨ã„ã¦ã€è‡ªå‹•è£œå®Œã—ã¦ãã‚Œã‚‹ã€‚ { \"family\": \"\", \"requiresCompatibilities\": [ \"FARGATE\" ], \"networkMode\": \"awsvpc\", \"taskRoleArn\": \"\", \"executionRoleArn\": \"\", \"cpu\": \"512\", \"memory\": \"1024\", \"containerDefinitions\": [ { \"name\": \"\", \"image\": \"\", \"essential\": true, \"portMappings\": [ { \"containerPort\": 80, \"hostPort\": 80, \"protocol\": \"tcp\" } ], \"secrets\": [ { \"name\": \"DB_HOST\", \"valueFrom\": \"/ecs/DB_HOST\" }, { \"name\": \"DB_DATABASE\", \"valueFrom\": \"/ecs/DB_DATABASE\" }, { \"name\": \"DB_PASSWORD\", \"valueFrom\": \"/ecs/DB_PASSWORD\" }, { \"name\": \"DB_USERNAME\", \"valueFrom\": \"/ecs/DB_USERNAME\" }, { \"name\": \"REDIS_HOST\", \"valueFrom\": \"/ecs/REDIS_HOST\" }, { \"name\": \"REDIS_PASSWORD\", \"valueFrom\": \"/ecs/REDIS_PASSWORD\" }, { \"name\": \"REDIS_PORT\", \"valueFrom\": \"/ecs/REDIS_PORT\" } ], \"logConfiguration\": { \"logDriver\": \"awslogs\", \"options\": { \"awslogs-group\": \"\", # ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®ãƒ­ã‚°ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã€æ—¥ä»˜ã§åŒºåˆ‡ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ \"awslogs-datetime-format\": \"\\\\[%Y-%m-%d %H:%M:%S\\\\]\", \"awslogs-region\": \"\", \"awslogs-stream-prefix\": \"\" } } } ] } CodeDeployã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ 11. EC2ï¼šElastic Computer Cloud EC2ã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒã¨ã—ã¦åƒãã€‚æ³¨æ„ç‚¹ãŒã‚ã‚‹ã‚‚ã®ã ã‘ã¾ã¨ã‚ã‚‹ã€‚ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ec2-best-practices.html è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ AMIï¼šAmazonãƒã‚·ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ AMIã‚’é¸æŠã™ã‚‹ã€‚ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ— ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•° ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ã‚µãƒ–ãƒãƒƒãƒˆ è‡ªå‹•å‰²ã‚Šå½“ã¦IPã‚¢ãƒ‰ãƒ¬ã‚¹ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ§‹ç¯‰å¾Œã«æœ‰åŠ¹ã«ã§ããªã„ã€‚ ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã®äºˆç´„ ãƒ‰ãƒ¡ã‚¤ãƒ³çµåˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª IAMãƒ­ãƒ¼ãƒ« EC2ã«ä»˜ä¸ã™ã‚‹IAMãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³å‹•ä½œ çµ‚äº†ä¿è­· EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å‰Šé™¤ã‚’é˜²ãã€‚ å¿…ãšæœ‰åŠ¹ã«ã™ã‚‹ã“ã¨ã€‚ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚° ãƒ†ãƒŠãƒ³ã‚·ãƒ¼ Elastic Inference ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆä»•æ§˜ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚­ãƒ¼ãƒšã‚¢ EC2ã®ç§˜å¯†éµã«å¯¾å¿œã—ãŸå…¬é–‹éµã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã€‚ ã‚­ãƒ¼ãƒšã‚¢ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆå€¤ã‚’èª¿ã¹ã‚‹ã“ã¨ã§ã€å…¬é–‹éµã¨ç§˜å¯†éµã®å¯¾å¿œé–¢ä¿‚ã‚’èª¿ã¹ã‚‰ã‚Œã‚‹ã€‚ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ»ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®ç™ºç”Ÿæ¡ä»¶ ä»¥ä¸‹ã®æ¡ä»¶ã®æ™‚ã«EC2ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚EC2ã‚’å†—é•·åŒ–ã—ã¦ã„ã‚‹å ´åˆã¯ã€ãƒ¦ãƒ¼ã‚¶ã«å½±éŸ¿ã‚’ä¸ãˆãšã«å¯¾å‡¦ã§ãã‚‹ã€‚ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹æ–¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’äº‹å‰ã«ALBã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰è§£é™¤ã—ã¦ãŠãã€åœæ­¢ã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒèµ·å‹•ã—ãŸå¾Œã«ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«å†ç™»éŒ²ã™ã‚‹ã€‚ å¤‰æ›´ã™ã‚‹é …ç›® ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ‰ç„¡ è£œè¶³ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ— ã‚ã‚Š ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ã¯EC2ã‚’åœæ­¢ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãã®ãŸã‚ã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ ãƒ›ã‚¹ãƒˆç‰©ç†ã‚µãƒ¼ãƒã®ãƒªã‚¿ã‚¤ã‚¢ãƒ¡ãƒ³ãƒˆ ã‚ã‚Š AWSã‹ã‚‰å®šæœŸçš„ã«ãƒªã‚¿ã‚¤ã‚¢ãƒ¡ãƒ³ãƒˆã«é–¢ã™ã‚‹è­¦å‘Šãƒ¡ãƒ¼ãƒ«ãŒå±Šãã€‚ãƒ«ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ã‚¿ã‚¤ãƒ—ãŒã€EBSã€ã®å ´åˆã€ãƒ›ã‚¹ãƒˆç‰©ç†ã‚µãƒ¼ãƒã®å¼•ã£è¶Šã—ã‚’è¡Œã†ãŸã‚ã«EC2ã®åœæ­¢ã¨èµ·å‹•ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ãã®ãŸã‚ã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ãªãŠã€å†èµ·å‹•ã§ã¯å¼•ã£è¶Šã—ã§ããªã„ã€‚ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ— ãƒ»ä¸–ä»£ã¨å¤§ãã• ã€ä¸–ä»£ã€ã¨ã€å¤§ãã•ã€ã‹ã‚‰ãªã‚‹åå‰ã§æ§‹æˆã•ã‚Œã‚‹ã€‚ä¸–ä»£ã®æ•°å­—ãŒä¸ŠãŒã‚‹ã«ã¤ã‚Œã¦ã€ã‚ˆã‚Šå°ã•ãªä¸–ä»£ã¨åŒã˜å¤§ãã•ã§ã‚ã£ã¦ã‚‚ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ä½ã‚³ã‚¹ãƒˆã«ãªã‚‹ã€‚AMIã®OSã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã¯ã€æ–°ã—ãç™»å ´ã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã‚’é©ç”¨ã§ããªã„ã“ã¨ãŒã‚ã‚‹ãŸã‚æ³¨æ„ã™ã‚‹ã€‚ä¾‹ãˆã°ã€CentOS 6ç³»ã®AMIã§ã¯ã€t3.smallã‚’é¸æŠã§ããªã„ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/marketplace/pp/prodview-gkh3rqhqbgzme?ref=cns_srchrow ç¨®é¡ ä¸–ä»£ t2ã€t3ã€t3aã€t4gã€a1 å¤§ãã• nanoã€smallã€mediumã€largeã€xlargeã€2xlarge ãƒ»CPUãƒãƒ¼ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ ãƒãƒ¼ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã®å ´åˆã€ä¸€å®šæ°´æº–ã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³CPUä½¿ç”¨ç‡ã‚’æä¾›ã—ã¤ã¤ã€ã“ã‚Œã‚’è¶…éã§ãã‚‹ã€‚CPUä½¿ç”¨ç‡ãŒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’è¶…ãˆãŸã¨ãã€è¶…éã—ãŸåˆ†ã ã‘EC2ã¯CPUã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚’æ¶ˆè²»ã™ã‚‹ã€‚CPUã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã¯ä¸€å®šã®å‰²åˆã§å›å¾©ã™ã‚‹ã€‚è“„ç©ã§ãã‚‹æœ€å¤§CPUã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã®å›å¾©ç‡ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³CPUä½¿ç”¨ç‡ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã«ã‚ˆã£ã¦ç•°ãªã‚‹ã€‚è©³ã—ãã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/burstable-performance-instances.html ãƒ«ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ  ãƒ»ãƒ«ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã¯ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã€ãƒ«ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§èµ·å‹•ã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ã¯æ¬¡ã®ç¨®é¡ãŒã‚ã‚‹ã€‚ ãƒ»EBSãƒœãƒªãƒ¥ãƒ¼ãƒ  EBSã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒ«ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ã§ã€æ¨å¥¨ã®æ–¹æ³•ã§ã‚ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¹ãƒˆã‚¢ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã¯ç•°ãªã‚Šã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹EBSãŒåˆ†é›¢ã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã®æ°¸ç¶šåŒ–ã‚’è¨­å®šã—ãŸå ´åˆã«ã€‚EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒèª¤ã£ã¦å‰Šé™¤ã•ã‚Œã¦ã—ã¾ã£ãŸã¨ã—ã¦ã‚‚ã€ãƒ‡ãƒ¼ã‚¿ã‚’å®ˆã‚ã‚‹ã€‚ã¾ãŸã€ä¸¡è€…ãŒåˆ†é›¢ã•ã‚Œã¦ã„ãªã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨æ¯”è¼ƒã—ã¦ã€å†èµ·å‹•ãŒæ—©ã„ãŸã‚ã€å†èµ·å‹•ã«ä¼´ã†ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒçŸ­ã„ã€‚ãŸã ã—ã€ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/RootDeviceStorage.html#RootDeviceStorageConcepts https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/RootDeviceStorage.html#Using_RootDeviceStorage ãƒ»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¹ãƒˆã‚¢ãƒœãƒªãƒ¥ãƒ¼ãƒ  ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¹ãƒˆã‚¢ã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒ«ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ã§ã€éæ¨å¥¨ã®æ–¹æ³•ã§ã‚ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¹ãƒˆã‚¢ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¯ã€EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒçµ‚äº†ã™ã‚‹ã¨ä¸€ç·’ã«å‰Šé™¤ã•ã‚Œã¦ã—ã¾ã†ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/RootDeviceStorage.html#RootDeviceStorageConcepts https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device ã‚­ãƒ¼ãƒšã‚¢ ãƒ»ã‚­ãƒ¼ãƒšã‚¢ã®ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆå€¤ ãƒ­ãƒ¼ã‚«ãƒ«ã«ç½®ã‹ã‚Œã¦ã„ã‚‹ç§˜å¯†éµãŒã€è©²å½“ã™ã‚‹EC2ã«ç½®ã‹ã‚Œã¦ã„ã‚‹å…¬é–‹éµã¨ãƒšã‚¢ãªã®ã‹ã©ã†ã‹ã€ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆå€¤ã‚’ç…§åˆã—ã¦ç¢ºèªã™ã‚‹æ–¹æ³• $ openssl pkcs8 \\ -in .pem \\ -inform PEM \\ -outform DER \\ -topk8 \\ -nocrypt | openssl sha1 -c ãƒ»EC2ã¸ã®SSHæ¥ç¶š ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®SSHãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ‘ã‚±ãƒƒãƒˆã¯ã€ã¾ãšã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’çµŒç”±ã—ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’é€šéã™ã‚‹ã€‚ãã®å¾Œã€Route53ã€ALBã‚’çµŒç”±ã›ãšã€ãã®ã¾ã¾EC2ã¸å‘ã‹ã†ã€‚ 11-02. EC2 based on AMIï¼šAmazon Machine Image AMIã¨ã¯ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸Šã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ç¨¼åƒã•ã›ã‚‹ãŸã‚ã«å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆOSã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼‰ãŒå†…è”µã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ec2-instances-and-amis.html AMIã‚¿ã‚¤ãƒ— ãƒ»EBS-backed AMI EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’æŒã¤EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹AMIã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device ãƒ»instance store-backed AMI ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¹ãƒˆã‚¢ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’æŒã¤EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹AMIã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device AMI OS ãƒ»Amazon Linux ãƒ»CentOS ãƒ™ãƒ³ãƒ€ãƒ¼å…¬å¼ã‚ã‚‹ã„ã¯éå…¬å¼ãŒæä¾›ã—ã¦ã„ã‚‹AMIãŒåŒºåˆ¥ã—ã«ãã„ã®ã§ã€ç¢ºå®Ÿã«å…¬å¼ãƒ™ãƒ³ãƒ€ãƒ¼ãŒæä¾›ã—ã¦ã„ã‚‹ã‚‚ã®é¸æŠã™ã‚‹ã“ã¨ã€‚ å‚è€ƒï¼š https://wiki.centos.org/Cloud/AWS 11-03. EC2 with EBSï¼šElastic Block Storage EBSã¨ã¯ EC2ã®ã‚¯ãƒ©ã‚¦ãƒ‰å†…è”µã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨ã—ã¦åƒãã€‚ è¨­å®šé …ç›® ãƒ»EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚¿ã‚¤ãƒ—ã¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®é–¢ä¿‚ EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚¿ã‚¤ãƒ— ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ç¨®é¡ æ±ç”¨SSD SSD ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ IOPS SSD SSD ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆæœ€é©åŒ– HDD HDD Cold HDD HDD EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã®é¸ã³æ–¹ ãƒ»ä¸‹é™EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚µã‚¤ã‚º ä¸€èˆ¬çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ã‚Œã°ã€æœ€ä½é™20ï½30GiBã®EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚µã‚¤ã‚ºãŒã‚ã‚‹ã¨ã‚ˆã„ã€‚ã—ã‹ã—ã€è¸ã¿å°ã‚µãƒ¼ãƒã®å ´åˆã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«æ¥ç¶šã™ã‚‹ãŸã‚ã®è¶³å ´ã¨ã—ã¦ã®ç”¨é€”ã—ã‹ãªãã€å¤§ããªãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’çµ„ã¿è¾¼ã‚€å¿…è¦ãŒãªã„ã€‚ãã“ã§ã§ãã‚‹ã ã‘æœ€å°é™ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’é¸æŠã—ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åˆè¨ˆã‚’æŠ‘ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚OSã«ã‚ˆã£ã¦ä¸‹é™ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚µã‚¤ã‚ºãŒç•°ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ OS ä»®æƒ³ãƒ¡ãƒ¢ãƒª ä¸‹é™EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚µã‚¤ã‚º Amazon Linux t2.micro 8 CentOS t2.micro 10 EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã®æ°¸ç¶šåŒ– ãƒ»EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã®æ°¸ç¶šåŒ–ã¨ã¯ EC2ã®åˆæœŸæ§‹ç¯‰æ™‚ã«ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®è¿½åŠ ã®é …ç›®ã§ã€çµ‚äº†æ™‚ã«å‰Šé™¤ã€ã®è¨­å®šã‚’ç„¡åŠ¹åŒ–ã—ã¦ãŠãã€‚ã“ã‚Œã«ã‚ˆã‚Šã€EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå‰Šé™¤ã•ã‚Œã¦ã‚‚ã€EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’å‰Šé™¤ã—ãªã„ã‚ˆã†ã«ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/RootDeviceStorage.html#Using_RootDeviceStorage ãƒ»EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ§‹ç¯‰å¾Œã«æ°¸ç¶šåŒ–ã™ã‚‹ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ§‹ç¯‰å¾Œã«ã€EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’æ°¸ç¶šåŒ–ã—ãŸã„å ´åˆã¯ã€CLIã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ $ aws ec2 modify-instance-attribute \\ --instance-id --block-device-mappings \\ file://example.json # example.jsonãƒ•ã‚¡ã‚¤ãƒ« [ { \"DeviceName\": \"/dev/sda1\", \"Ebs\": { \"DeleteOnTermination\": false } } ] ãƒ»æ³¨æ„ç‚¹ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚’é©ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’æ°¸ç¶šåŒ–ã—ãªã„æ–¹ãŒè‰¯ã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³æ™‚ã«ã€å‰Šé™¤ã•ã‚ŒãŸEC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒå‰Šé™¤ã•ã‚Œãªã„ãŸã‚ã€æœªä½¿ç”¨ã®EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒã©ã‚“ã©ã‚“æºœã¾ã£ã¦ã„ãå•é¡ŒãŒèµ·ã“ã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/YujiHamada3/items/c890a3de8937ea20bbb2 EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ã‚µã‚¤ã‚ºå¤‰æ›´ EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ã¯ã€å®Ÿéš›ã®EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã€EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ç´ã¥ããƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã€ã«é–¢ã—ã¦ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/recognize-expanded-volume-linux.html#extend-file-system ï¼Šä¾‹ï¼Š ï¼ˆï¼‘ï¼‰EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’8GBã‹ã‚‰16GBã«å¤‰æ›´ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚lsblkã‚³ãƒãƒ³ãƒ‰ã§ç¾åœ¨ã®ãƒ–ãƒ­ãƒƒã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®ã‚µã‚¤ã‚ºã‚’ç¢ºèªã™ã‚‹ã¨ã€EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãŒã¨ã‚‚ã«8GBã§ã‚ã‚‹ã€‚ã¾ãŸã€dfã‚³ãƒãƒ³ãƒ‰ã§ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚µã‚¤ã‚ºã‚’ç¢ºèªã™ã‚‹ã¨ã€åŒã˜ã8GBã§ã‚ã‚‹ã€‚ $ lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT xvda 202:0 0 8G 0 disk # EBSãƒœãƒªãƒ¥ãƒ¼ãƒ  â””â”€xvda1 202:1 0 8G 0 part / # ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ # ï½ ä¸­ç•¥ ï½ $ df Filesystem Type Size Used Avail Use% Mounted on /dev/xvda1 ext4 8G 1.9G 14G 12% / # ï½ ä¸­ç•¥ ï½ ï¼ˆï¼’ï¼‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‹ã‚‰ã€EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’16GBã«å¤‰æ›´ã™ã‚‹ã€‚ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã¯ç™ºç”Ÿã—ãªã„ã€‚æ”¹ã‚ã¦lsblkã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€è©²å½“ã®EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒå¤‰æ›´ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã€‚ $ lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT xvda 202:0 0 16G 0 disk # EBSãƒœãƒªãƒ¥ãƒ¼ãƒ  â””â”€xvda1 202:1 0 8G 0 part / # ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ # ï½ ä¸­ç•¥ ï½ ï¼ˆï¼“ï¼‰growpartã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’æ‹¡å¼µã™ã‚‹ã€‚æ”¹ã‚ã¦lsblkã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€è©²å½“ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãŒå¤‰æ›´ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã€‚ $ sudo growpart /dev/xvda 1 $ lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT xvda 202:0 0 16G 0 disk # EBSãƒœãƒªãƒ¥ãƒ¼ãƒ  â””â”€xvda1 202:1 0 16G 0 part / # ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ # ï½ ä¸­ç•¥ ï½ ï¼ˆï¼”ï¼‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã†ã¡ã€/dev/xvda1ãƒ•ã‚¡ã‚¤ãƒ«ãŒEBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ç´ã¥ã„ã¦ã„ã‚‹ã€‚resize2fsã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€ã“ã‚Œã®ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹ã€‚æ”¹ã‚ã¦dfã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€è©²å½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãŒå¤‰æ›´ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã€‚ $ sudo resize2fs /dev/xvda1 $ df Filesystem Type Size Used Avail Use% Mounted on /dev/xvda1 ext4 16G 1.9G 14G 12% / # EBSãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ç´ã¥ããƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ  # ï½ ä¸­ç•¥ ï½ 13. ECR ECRã¨ã¯ AWSãŒæä¾›ã™ã‚‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚µãƒ¼ãƒ“ã‚¹ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ å¯è¦–æ€§ ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ï¼ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã«ã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ æ§˜ã€…ãªãƒ™ãƒ³ãƒ€ãƒ¼ãŒãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒªã§ECRã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æä¾›ã—ã¦ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://gallery.ecr.aws/ ã‚¿ã‚°ã®ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£ åŒã˜ã‚¿ã‚°åã§ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸå ´åˆã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚°ã‚’ä¸Šæ›¸ãå¯èƒ½ï¼ä¸å¯èƒ½ã‹ã‚’è¨­å®šã§ãã‚‹ã€‚ ãƒ—ãƒƒã‚·ãƒ¥æ™‚ã«ã‚¹ã‚­ãƒ£ãƒ³ ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸæ™‚ã«ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è„†å¼±æ€§ã‚’æ¤œè¨¼ã—ã€ä¸€è¦§è¡¨ç¤ºã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECR/latest/userguide/image-scanning.html æš—å·åŒ–è¨­å®š ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« ãƒ»ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ ECRã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æœ‰åŠ¹æœŸé–“ã‚’å®šç¾©ã§ãã‚‹ã€‚ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒ«ãƒ¼ãƒ«ã®å„ªå…ˆé †ä½ é †ä½ã®å¤§ãã•ã§ã€ãƒ«ãƒ¼ãƒ«ã®å„ªå…ˆåº¦ã‚’è¨­å®šã§ãã‚‹ã€‚ æ•°å­—ã¯é€£ç¶šã—ã¦ã„ã‚‹å¿…è¦ã¯ãªãã€ä¾‹ãˆã°ã€10ã€20ã€90ã€ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã‚‚è‰¯ã„ã€‚ ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æ¡ä»¶ã¨ã—ã¦ã€ã‚¿ã‚°ã®æœ‰ç„¡ã‚„æ–‡å­—åˆ—ã‚’è¨­å®šã§ãã‚‹ã€‚ ä¸€è‡´æ¡ä»¶ ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æœ‰åŠ¹æœŸé–“ã¨ã—ã¦ã€åŒæ¡ä»¶ã«å½“ã¦ã¯ã¾ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå‰Šé™¤ã•ã‚Œã‚‹é–¾å€¤ã‚’è¨­å®šã§ãã‚‹ã€‚ å€‹æ•°ã€ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œã¦ã‹ã‚‰ã®æœŸé–“ã€ãªã©ã‚’é–¾å€¤ã¨ã—ã¦è¨­å®šã§ãã‚‹ã€‚ ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚° ãƒ»ã‚¿ã‚°åã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ Dockerã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«å‰‡ã‚Šã€ã‚¿ã‚°åã«latestã‚’ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ãã®ä»£ã‚ã‚Šã«ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«ç•°ãªã‚‹ã‚¿ã‚°åã«ãªã‚‹ã‚ˆã†ãƒãƒƒã‚·ãƒ¥å€¤ï¼ˆä¾‹ï¼šGitHubã®ã‚³ãƒŸãƒƒãƒˆIDï¼‰ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://matsuand.github.io/docs.docker.jp.onthefly/develop/dev-best-practices/ 14-01. ECS ECSã¨ã¯ ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ç’°å¢ƒã‚’æä¾›ã™ã‚‹ã€‚VPCã®å¤–ã«å­˜åœ¨ã—ã¦ã„ã‚‹ã€‚ECSã€EKSã€Fargateã€EC2ã®å¯¾å¿œé–¢ä¿‚ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚ Control Planeï¼ˆã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒï¼‰ Data Planeï¼ˆã‚³ãƒ³ãƒ†ãƒŠå®Ÿè¡Œç’°å¢ƒï¼‰ èª¬æ˜ ECSï¼šElastic Container Service Fargateã€EC2 å˜ä¸€ã®OSä¸Šã§ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ EKSï¼šElastic Kubernetes Service EC2 è¤‡æ•°ã®OSä¸Šãã‚Œãã‚Œã§ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ 14-02. ECS on EC2 EC2èµ·å‹•ã‚¿ã‚¤ãƒ—ã®ã‚³ãƒ³ãƒ†ãƒŠ ãƒ»ã‚¿ã‚¹ã‚¯é…ç½®æˆ¦ç•¥ ECSã‚¿ã‚¹ã‚¯ã‚’ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«é…ç½®ã™ã‚‹æ™‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸æŠã§ãã‚‹ã€‚ æˆ¦ç•¥ èª¬æ˜ Spread ECSã‚¿ã‚¹ã‚¯ã‚’å„å ´æ‰€ã«ãƒãƒ©ãƒ³ã‚¹ã‚ˆãé…ç½®ã™ã‚‹ Binpack ECSã‚¿ã‚¹ã‚¯ã‚’ä¸€ã¤ã®å ´æ‰€ã«ã§ãã‚‹ã ã‘å¤šãé…ç½®ã™ã‚‹ã€‚ Random ECSã‚¿ã‚¹ã‚¯ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é…ç½®ã™ã‚‹ã€‚ 14-03. ECS on Fargateï¼šElastic Container Service ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ ãƒ»ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨ã¯ ECSã‚µãƒ¼ãƒ“ã‚¹ ãƒ»ECSã‚µãƒ¼ãƒ“ã‚¹ã¨ã¯ ECSã‚¿ã‚¹ã‚¯ã¸ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°ã€ã‚¿ã‚¹ã‚¯ã®æ•°ã®ç¶­æŒç®¡ç†ã‚„ã€ãƒªãƒªãƒ¼ã‚¹ã®æˆå¦ã®ç®¡ç†ã‚’è¡Œã†æ©Ÿèƒ½ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/userguide/service_definition_parameters.html è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ã‚¿ã‚¹ã‚¯å®šç¾© ã‚µãƒ¼ãƒ“ã‚¹ã§ç¶­æŒç®¡ç†ã™ã‚‹ã‚¿ã‚¹ã‚¯ã®å®šç¾©ãƒ•ã‚¡ãƒŸãƒªãƒ¼åã¨ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’è¨­å®šã™ã‚‹ã€‚ èµ·å‹•ã‚¿ã‚¤ãƒ— ECSã‚¿ã‚¹ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ã‚¿ã‚¤ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œç’°å¢ƒã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã€é€£æºã§ãã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ãŒç•°ãªã‚‹ã€‚ ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¤ãƒ— ã‚¿ã‚¹ã‚¯ã®å¿…è¦æ•° éã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æ™‚ã¾ãŸã¯ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®ã‚¿ã‚¹ã‚¯æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ æœ€å°ãƒ˜ãƒ«ã‚¹ç‡ã¨æœ€å¤§ç‡ã®è¨­å®šå€¤ã«å½±éŸ¿ã™ã‚‹ã€‚ æœ€å°ãƒ˜ãƒ«ã‚¹ç‡ ECSã‚¿ã‚¹ã‚¯ã®å¿…è¦æ•°ã®è¨­å®šã‚’100%ã¨ã—ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«ã€ç¨¼åƒä¸­ã‚¿ã‚¹ã‚¯ã®æœ€ä½åˆè¨ˆæ•°ã‚’å‰²åˆã§è¨­å®šã™ã‚‹ã€‚ ä¾‹ã¨ã—ã¦ã€ã‚¿ã‚¹ã‚¯å¿…è¦æ•°ãŒï¼”å€‹ã ã¨ä»®å®šã™ã‚‹ã€‚ã‚¿ã‚¹ã‚¯ãƒ˜ãƒ«ã‚¹æœ€å°ç‡ã‚’50%ã¨ã™ã‚Œã°ã€ç¨¼åƒä¸­ã‚¿ã‚¹ã‚¯ã®æœ€ä½åˆè¨ˆæ•°ã¯ï¼’å€‹ã¨ãªã‚‹ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®æ—¢å­˜ã‚¿ã‚¹ã‚¯åœæ­¢ã¨æ–°ã‚¿ã‚¹ã‚¯èµ·å‹•ã§ã¯ã€ç¨¼åƒä¸­ã®æ—¢å­˜ã‚¿ã‚¹ã‚¯ï¼æ–°ã‚¿ã‚¹ã‚¯ã®æ•°ãŒæœ€ä½åˆè¨ˆæ•°æœªæº€ã«ãªã‚‰ãªã„ã‚ˆã†ã«åˆ¶å¾¡ã•ã‚Œã‚‹ã€‚å‚è€ƒï¼šhttps://toris.io/2021/04/speeding-up-amazon-ecs-container-deployments æœ€å¤§ç‡ ECSã‚¿ã‚¹ã‚¯ã®å¿…è¦æ•°ã®è¨­å®šã‚’100%ã¨ã—ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«ã€ç¨¼åƒä¸­ï¼åœæ­¢ä¸­ã‚¿ã‚¹ã‚¯ã®æœ€é«˜åˆè¨ˆæ•°ã‚’å‰²åˆã§è¨­å®šã™ã‚‹ã€‚ ä¾‹ã¨ã—ã¦ã€ã‚¿ã‚¹ã‚¯å¿…è¦æ•°ãŒï¼”å€‹ã ã¨ä»®å®šã™ã‚‹ã€‚ã‚¿ã‚¹ã‚¯æœ€å¤§ç‡ã‚’200%ã¨ã™ã‚Œã°ã€ç¨¼åƒä¸­ï¼åœæ­¢ä¸­ã‚¿ã‚¹ã‚¯ã®æœ€é«˜åˆè¨ˆæ•°ã¯ï¼˜å€‹ã¨ãªã‚‹ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®æ—¢å­˜ã‚¿ã‚¹ã‚¯åœæ­¢ã¨æ–°ã‚¿ã‚¹ã‚¯èµ·å‹•ã§ã¯ã€ç¨¼åƒä¸­ï¼åœæ­¢ä¸­ã®æ—¢å­˜ã‚¿ã‚¹ã‚¯ï¼æ–°ã‚¿ã‚¹ã‚¯ã®æ•°ãŒæœ€é«˜åˆè¨ˆæ•°ã‚’è¶…éã—ãªã„ã‚ˆã†ã«åˆ¶å¾¡ã•ã‚Œã‚‹ã€‚å‚è€ƒï¼šhttps://toris.io/2021/04/speeding-up-amazon-ecs-container-deployments ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®çŒ¶äºˆæœŸé–“ ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®ALBï¼NLBã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹ã¾ã§ã®å¾…æ©Ÿæ™‚é–“ã‚’è¨­å®šã™ã‚‹ã€‚çŒ¶äºˆæœŸé–“ã‚’éãã¦ã‚‚ã€ALBï¼NLBã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãŒå¤±æ•—ã—ã¦ã„ã‚Œã°ã€ã‚µãƒ¼ãƒ“ã‚¹ã¯ã‚¿ã‚¹ã‚¯ã‚’åœæ­¢ã—ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’å†èµ·å‹•ã™ã‚‹ã€‚ ALBï¼NLBã§ã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ç™»éŒ²ã—ã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãŒã‚ã‚‹ã€‚ç‰¹ã«NLBã§ã¯ã€ã“ã‚Œã«æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚ã¾ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹ç¯‰ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚ãã®ãŸã‚ã€NLBã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãŒå®Œäº†ã™ã‚‹å‰ã«ã€ECSã‚µãƒ¼ãƒ“ã‚¹ãŒNLBã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®çµæœã‚’ç¢ºèªã—ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚ä¾‹ãˆã°ã€NLBã¨Laravelã‚’ç”¨ã„ã‚‹å ´åˆã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç™»éŒ²ã¨Laravelã‚³ãƒ³ãƒ†ãƒŠã®ç¯‰ã®æ™‚é–“ã‚’åŠ å‘³ã—ã¦ã€330ç§’ä»¥ä¸Šã‚’ç›®å®‰ã¨ã™ã‚‹ã€‚ä¾‹ãˆã°ã€ALBã¨Nuxtjsï¼ˆSSRãƒ¢ãƒ¼ãƒ‰ï¼‰ã‚’ç”¨ã„ã‚‹å ´åˆã¯ã€600ç§’ä»¥ä¸Šã‚’ç›®å®‰ã¨ã™ã‚‹ã€‚ãªãŠã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚³ãƒ³ãƒ†ãƒŠæ§‹ç¯‰ã«ã‹ã‹ã‚‹æ™‚é–“ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®æ‰€è¦æ™‚é–“ã‚’å‚è€ƒã«ã™ã‚‹ã€‚ ã‚¿ã‚¹ã‚¯ã®æœ€å°æ•° ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æ™‚ã®ã‚¿ã‚¹ã‚¯æ•°ã®æœ€å°æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ã‚¹ã‚¯ã®æœ€å¤§æ•° ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æ™‚ã®ã‚¿ã‚¹ã‚¯æ•°ã®æœ€å¤§æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚° ALBã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ã‚¹ã‚¯ã®æ•° ECSã‚¿ã‚¹ã‚¯ã®æ§‹ç¯‰æ•°ã‚’ã„ãã¤ã«ç¶­æŒã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ã‚¹ã‚¯ãŒä½•ã‚‰ã‹ã®åŸå› ã§åœæ­¢ã—ãŸå ´åˆã€ç©ºã„ã¦ã„ã‚‹AWSã‚µãƒ¼ãƒ“ã‚¹ã‚’ç”¨ã„ã¦ã€ã‚¿ã‚¹ã‚¯ãŒè‡ªå‹•çš„ã«è£œå¡«ã•ã‚Œã‚‹ã€‚ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã€Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤ãŒã‚ã‚‹ã€‚ ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¿½è·¡ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãƒãƒªã‚·ãƒ¼ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¿½è·¡ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãƒãƒªã‚·ãƒ¼ ç›£è¦–å¯¾è±¡ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã‚’è¶…éã—ã¦ã„ã‚‹ã‹å¦ã‹ã«åŸºã¥ã„ã¦ã€ã‚¿ã‚¹ã‚¯æ•°ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ECSã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ ç›£è¦–å¯¾è±¡ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ã€å¹³å‡CPUã€ã€ã€å¹³å‡ãƒ¡ãƒ¢ãƒªã€ã€ã€ã‚¿ã‚¹ã‚¯å½“ãŸã‚Šã®ALBã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã€ã‚’ç›£è¦–ã§ãã‚‹ã€‚SLIã«å¯¾å¿œã™ã‚‹CloudWatchãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚‚å‚è€ƒã«ã›ã‚ˆã€‚ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ ã‚¿ã‚¹ã‚¯æ•°ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒå®Ÿè¡Œã•ã‚Œã‚‹åæŸå€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã‚’è¶…éã—ã¦ã„ã‚‹å ´åˆã€ã‚¿ã‚¹ã‚¯æ•°ãŒã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹ã€‚åå¯¾ã«ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤æœªæº€ï¼ˆæ­£ç¢ºã«ã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã®ï¼™å‰²æœªæº€ï¼‰ã®å ´åˆã€ã‚¿ã‚¹ã‚¯æ•°ãŒã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã•ã‚Œã‚‹ã€‚ ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æœŸé–“ ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã‚’ç™ºå‹•ã—ã¦ã‹ã‚‰ã€æ¬¡å›ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã‚’ç™ºå‹•ã§ãã‚‹ã¾ã§ã®æ™‚é–“ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»æœŸé–“ã‚’çŸ­ãã—éãã‚‹ã¨ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã‚’è¶…éã™ã‚‹çŠ¶æ…‹ãŒæ–­ç¶šçš„ã«ç¶šã„ãŸå ´åˆã€ä½™åˆ†ãªã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆãŒé€£ç¶šã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã†ãŸã‚æ³¨æ„ã™ã‚‹ã€‚ãƒ»æœŸé–“ã‚’é•·ãéãã‚‹ã¨ã€ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆãŒä¸ååˆ†ã«ãªã‚Šã€ECSã®è² è·ãŒç·©å’Œã•ã‚Œãªã„ãŸã‚æ³¨æ„ã™ã‚‹ã€‚ ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æœŸé–“ ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã‚’ç™ºå‹•ã—ã¦ã‹ã‚‰ã€æ¬¡å›ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã‚’ç™ºå‹•ã§ãã‚‹ã¾ã§ã®æ™‚é–“ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã®ç„¡åŠ¹åŒ– ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã®è¨­å®šã«å¿œã˜ã¦ã€è‡ªå‹•çš„ã«ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã‚„ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ãŒèµ·ã“ã‚‹ã‚·ãƒŠãƒªã‚ªä¾‹ã‚’ç¤ºã™ã€‚ æœ€å°ã‚¿ã‚¹ã‚¯æ•°ã‚’2ã€å¿…è¦ã‚¿ã‚¹ã‚¯æ•°ã‚’4ã€æœ€å¤§æ•°ã‚’6ã€CPUå¹³å‡ä½¿ç”¨ç‡ã‚’40%ã«è¨­å®šã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ å¹³å¸¸æ™‚ã€CPUä½¿ç”¨ç‡40%ã«ç¶­æŒã•ã‚Œã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¢—åŠ ã—ã€CPUä½¿ç”¨ç‡55%ã«ä¸Šæ˜‡ã™ã‚‹ã€‚ ã‚¿ã‚¹ã‚¯æ•°ãŒ6ã¤ã«ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã—ã€CPUä½¿ç”¨ç‡40%ã«ç¶­æŒã•ã‚Œã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒæ¸›å°‘ã—ã€CPUä½¿ç”¨ç‡ãŒ20%ã«ä½ä¸‹ã™ã‚‹ã€‚ ã‚¿ã‚¹ã‚¯æ•°ãŒ2ã¤ã«ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ã—ã€CPUä½¿ç”¨ç‡40%ã«ç¶­æŒã•ã‚Œã‚‹ã€‚ ãƒ»ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é¢¨ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç¾¤ã‚’ç¨¼åƒã•ã›ã‚‹æ™‚ã€Kubernetesã‚’ä½¿ç”¨ã—ã€ã¾ãŸã‚¤ãƒ³ãƒ•ãƒ©ã¨ã—ã¦EKSã‚’ç”¨ã„ã‚‹ã®ãŒåŸºæœ¬ã§ã‚ã‚‹ã€‚ãŸã ã—ã€ãƒ¢ãƒãƒªã‚¹ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ECSã‚µãƒ¼ãƒ“ã‚¹ã§åˆ†å‰²ã—ã€Fargateã§ç¨¼åƒã•ã›ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é¢¨ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ§‹ç¯‰ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://tangocode.com/2018/11/when-to-use-lambdas-vs-ecs-docker-containers/ ECSã‚¿ã‚¹ã‚¯ ãƒ»ECSã‚¿ã‚¹ã‚¯ ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠç¾¤ã®ã“ã¨ ãƒ»ã‚¿ã‚¹ã‚¯å®šç¾©ã¨ã¯ ECSã‚¿ã‚¹ã‚¯ã‚’ã©ã®ã‚ˆã†ãªè¨­å®šå€¤ã«åŸºã¥ã„ã¦æ§‹ç¯‰ã™ã‚‹ã‹ã‚’è¨­å®šã§ãã‚‹ã€‚ã‚¿ã‚¹ã‚¯å®šç¾©ã¯ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¤ºã™ã€ãƒªãƒ“ã‚¸ãƒ§ãƒ³ãƒŠãƒ³ãƒãƒ¼ã€ã§ç•ªå·ã¥ã‘ã•ã‚Œã‚‹ã€‚ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€å…¨ã¦ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ã®ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’ç™»éŒ²è§£é™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»ã‚¿ã‚¹ã‚¯ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/task-lifecycle.html#lifecycle-states ãƒ»ã‚¿ã‚¹ã‚¯ã‚µã‚¤ã‚º è¨­å®šé …ç›® èª¬æ˜ ã‚¿ã‚¹ã‚¯ãƒ¡ãƒ¢ãƒª ECSã‚¿ã‚¹ã‚¯å½“ãŸã‚Šã®ã‚³ãƒ³ãƒ†ãƒŠã®åˆè¨ˆãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ ã‚¿ã‚¹ã‚¯CPU ECSã‚¿ã‚¹ã‚¯å½“ãŸã‚Šã®ã‚³ãƒ³ãƒ†ãƒŠã®åˆè¨ˆCPUä½¿ç”¨é‡ ãƒ»æ–°ã—ã„ECSã‚¿ã‚¹ã‚¯ã‚’ä¸€æ™‚çš„ã«å®Ÿè¡Œ ç¾åœ¨èµ·å‹•ä¸­ã®ECSã‚¿ã‚¹ã‚¯ã¨ã¯åˆ¥ã«ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’ä¸€æ™‚çš„ã«èµ·å‹•ã™ã‚‹ã€‚CI/CDãƒ„ãƒ¼ãƒ«ã§å®Ÿè¡Œã™ã‚‹ä»¥å¤–ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰æ‰‹å‹•ã§å®Ÿè¡Œã™ã‚‹å ´åˆã‚‚ã‚ã‚‹ã€‚èµ·å‹•æ™‚ã«ã€overridesã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦ã€æŒ‡å®šã—ãŸã‚¿ã‚¹ã‚¯å®šç¾©ã®ã‚³ãƒ³ãƒ†ãƒŠè¨­å®šã‚’ä¸Šæ›¸ãã§ãã‚‹ã€‚æ­£è¦è¡¨ç¾ã§è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã•ã‚‰ã«JSONã§ã¯ã€\\ã€ã‚’ã€\\\\ã€ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚ŒãŸå¾Œã«ã€ã‚¿ã‚¹ã‚¯ã¯è‡ªå‹•çš„ã«StoppedçŠ¶æ…‹ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Laravelã®Seederã‚³ãƒãƒ³ãƒ‰ã‚„ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚³ãƒãƒ³ãƒ‰ã‚’ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã€‚ #!/bin/bash set -x echo \"Set Variables\" SERVICE_NAME=\"stg-foo-ecs-service\" CLUSTER_NAME=\"stg-foo-ecs-cluster\" TASK_NAME=\"stg-foo-ecs-task-definition\" SUBNETS_CONFIG=$(aws ecs describe-services \\ --cluster ${CLUSTER_NAME} \\ --services ${SERVICE_NAME} \\ --query \"services[].deployments[].networkConfiguration[].awsvpcConfiguration[].subnets[]\") SGS_CONFIG=$(aws ecs describe-services \\ --cluster ${CLUSTER_NAME} \\ --services ${SERVICE_NAME} \\ --query \"services[].deployments[].networkConfiguration[].awsvpcConfiguration[].securityGroups[]\") # å®Ÿè¡Œã—ãŸã„ã‚³ãƒãƒ³ãƒ‰ã‚’overridesã«è¨­å®šã™ã‚‹ã€‚ echo \"Run Task\" TASK_ARN=$(aws ecs run-task \\ --launch-type FARGATE \\ --cluster ${CLUSTER_NAME} \\ --platform-version \"1.4.0\" \\ --network-configuration \"awsvpcConfiguration={subnets=${SUBNETS_CONFIG},securityGroups=${SGS_CONFIG}}\" \\ --task-definition ${TASK_NAME} \\ --overrides '{\\\"containerOverrides\\\": [{\\\"name\\\": \\\"laravel-container\\\",\\\"command\\\": [\\\"php\\\", \\\"artisan\\\", \\\"db:seed\\\", \\\"--class=DummySeeder\\\", \\\"--force\\\"]}]}' \\ --query \"tasks[0].taskArn\" | tr -d \"\"\") echo \"Wait until task stopped\" aws ecs wait tasks-stopped \\ --cluster ${CLUSTER_NAME} \\ --tasks ${TASK_ARN} echo \"Get task result\" RESULT=$(aws ecs describe-tasks \\ --cluster ${CLUSTER_NAME} \\ --tasks ${TASK_ARN}) echo ${RESULT} EXIT_CODE=$(echo ${RESULT} | jq .tasks[0].containers[0].exitCode) echo exitCode ${EXIT_CODE} exit ${EXIT_CODE} ãªãŠã€å®Ÿè¡ŒIAMãƒ¦ãƒ¼ã‚¶ã‚’ä½œæˆã—ã€ECSã‚¿ã‚¹ã‚¯ã‚’èµ·å‹•ã§ãã‚‹æœ€ä½é™ã®æ¨©é™ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"iam:PassRole\", \"ecs:RunTask\", \"ecs:DescribeServices\", \"ecs:DescribeTasks\" ], \"Resource\": [ \"arn:aws:ecs:*::service/*\", \"arn:aws:ecs:*::task/*\", \"arn:aws:ecs:*::task-definition/*\", \"arn:aws:iam:::role/*\" ] } ] } ãƒ»ECS Exec ECSã‚¿ã‚¹ã‚¯ã®ã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ã€ã‚·ã‚§ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ECSã‚µãƒ¼ãƒ“ã‚¹ã«ãŠã‘ã‚‹ECS-Execã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹åŒ–ã€ssmmessagesã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä½œæˆã€System Managerã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®IAMãƒãƒªã‚·ãƒ¼ã®ä½œæˆã€ECSã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã¸ã®IAMãƒãƒªã‚·ãƒ¼ã®ä»˜ä¸ã€IAMãƒ¦ãƒ¼ã‚¶ã¸ã®ãƒãƒªã‚·ãƒ¼ã®ä»˜ä¸ã€ãŒå¿…è¦ã«ãªã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/userguide/ecs-exec.html https://docs.aws.amazon.com/ja_jp/systems-manager/latest/userguide/systems-manager-setting-up-messageAPIs.html { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ # ssmmesages APIã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ \"ssmmessages:CreateControlChannel\", \"ssmmessages:CreateDataChannel\", \"ssmmessages:OpenControlChannel\", \"ssmmessages:OpenDataChannel\" ], \"Resource\": \"*\" } ] } ãªãŠã€äº‹å‰ã®è¨­å®šãŒãªã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ecs-exec-checkerã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ç¢ºèªã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws-containers/amazon-ecs-exec-checker #!/bin/bash ECS_CLUSTER_NAME=prd-foo-ecs-cluster ECS_TASK_ID=bar bash ECS Execã‚’å®Ÿè¡Œã™ã‚‹ãƒ¦ãƒ¼ã‚¶ã«ã€å®Ÿè¡Œæ¨©é™ã®ãƒãƒªã‚·ãƒ¼ã‚’ä»˜ä¸ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"ecs:ExecuteCommand\", ], \"Resource\": [ \"arn:aws:ecs:*::cluster/*\", \"arn:aws:ecs:*::task/*\", ] } ] } laravelã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ã€ã‚·ã‚§ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚bashã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã«ã€ã€/bin/bashã€ã‚„ã€/bin/shã€ã§æŒ‡å®šã™ã‚‹ã¨ã€binã‚ˆã‚Šä¸Šã®ãƒ‘ã‚¹ã‚‚ECSã«é€ä¿¡ã•ã‚Œã¦ã—ã¾ã†ã€‚ä¾‹ãˆã°ã€Windowsãªã‚‰ã€C:/Program Files/Git/usr/bin/bashã€ãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ã“ã‚Œã¯CloudTrailã§ExecuteCommandã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ç¢ºèªã§ãã‚‹ã€‚ECSã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã¯bashã¸ã®ãƒ‘ã‚¹ãŒç•°ãªã‚‹ãŸã‚ã€æ¥ç¶šã«å¤±æ•—ã™ã‚‹ã€‚ãã®ãŸã‚ã€bashã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ #!/bin/bash set -xe ECS_CLUSTER_NAME=prd-foo-ecs-cluster ECS_TASK_ID=bar ECS_CONTAINER_NAME=laravel aws ecs execute-command \\ --cluster $ECS_CLUSTER_NAME \\ --task $ECS_TASK_ID \\ --container $ECS_CONTAINER_NAME \\ --interactive \\ --debug \\ --command \"bash\" Fargate ãƒ»Fargateã¨ã¯ ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œç’°å¢ƒã®ã“ã¨ã€‚ã€ECS on Fargateã€ã¨ã„ã†å‘¼ã³æ–¹ã¯ã€FargateãŒç’°å¢ƒã®æ„å‘³åˆã„ã‚’æŒã¤ã‹ã‚‰ã§ã‚ã‚‹ã€‚Fargateç’°å¢ƒã§ã¯ãƒ›ã‚¹ãƒˆãŒéš è”½ã•ã‚Œã¦ãŠã‚Šã€å®Ÿä½“ã¨ã—ã¦EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒ›ã‚¹ãƒˆã¨ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠãŒç¨¼åƒã—ã¦ã„ã‚‹ï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ãŒãªã„ãŒã€AWSã‚µãƒãƒ¼ãƒˆã«ç¢ºèªæ¸ˆã¿ï¼‰ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/blogs/news/under-the-hood-fargate-data-plane/ ãƒ»ã‚³ãƒ³ãƒ†ãƒŠã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ç¨¼åƒã—ã€ã‚³ãƒ³ãƒ†ãƒŠã®æ“ä½œã‚’è¡Œã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ ãƒ»ã‚³ãƒ³ãƒ†ãƒŠå®šç¾© ã‚¿ã‚¹ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠä¸€ã¤ã«å¯¾ã—ã¦ã€ç’°å¢ƒã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/userguide/task_definition_parameters.html è¨­å®šé …ç›® å¯¾å¿œã™ã‚‹dockerã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³ èª¬æ˜ è£œè¶³ cpu --cpus ã‚¿ã‚¹ã‚¯å…¨ä½“ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸCPUã®ã†ã¡ã€è©²å½“ã®ã‚³ãƒ³ãƒ†ãƒŠã«å‰²ã‚Šå½“ã¦ã‚‹CPUåˆ†ã‚’è¨­å®šã™ã‚‹ã€‚ dnsServers --dns ã‚³ãƒ³ãƒ†ãƒŠãŒåå‰è§£æ±ºã«ç”¨ã„ã‚‹DNSã‚µãƒ¼ãƒã®\u0010IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ essential ã‚³ãƒ³ãƒ†ãƒŠãŒå¿…é ˆã‹å¦ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»trueã®å ´åˆã€ã‚³ãƒ³ãƒ†ãƒŠãŒåœæ­¢ã™ã‚‹ã¨ã€ã‚¿ã‚¹ã‚¯ã«å«ã¾ã‚Œã‚‹å…¨ã‚³ãƒ³ãƒ†ãƒŠãŒåœæ­¢ã™ã‚‹ã€‚falseã®å ´åˆã€ã‚³ãƒ³ãƒ†ãƒŠãŒåœæ­¢ã—ã¦ã‚‚ã€ãã®ä»–ã®ã‚³ãƒ³ãƒ†ãƒŠã¯åœæ­¢ã—ãªã„ã€‚ healthCheck(command) --health-cmd ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã‹ã‚‰Fargateã«å¯¾ã—ã¦ã€curlã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ã‚’ç¢ºèªã€‚ healthCheck(interval) --health-interval ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®é–“éš”ã‚’è¨­å®šã™ã‚‹ã€‚ healthCheck(retries) --health-retries ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’æˆåŠŸã¨è¦‹ãªã™å›æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ hostName --hostname ã‚³ãƒ³ãƒ†ãƒŠã«ãƒ›ã‚¹ãƒˆåã‚’è¨­å®šã™ã‚‹ã€‚ image ECRã®URLã‚’è¨­å®šã™ã‚‹ã€‚ logConfiguration(logDriver) --log-driver ãƒ­ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ãƒ­ã‚°ã®å‡ºåŠ›å…ˆã‚’è¨­å®šã™ã‚‹ã€‚ Dockerã®ãƒ­ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã«ãŠãŠã‚ˆãå¯¾å¿œã—ã¦ãŠã‚Šã€Fargateã§ã‚ã‚Œã°ã€awslogsã€awsfirelensã€splunkã€ã«è¨­å®šã§ãã‚‹ã€‚EC2ã§ã‚ã‚Œã°ã€awslogsã€json-fileã€syslogã€journaldã€fluentdã€gelfã€logentriesã€ã‚’è¨­å®šã§ãã‚‹ã€‚ logConfiguration(options) --log-opt ãƒ­ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã«å¿œã˜ã¦ã€è©³ç´°ãªè¨­å®šã‚’è¡Œã†ã€‚ portMapping --publish--expose ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã¨Fargateã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ãƒˆç•ªå·ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¡Œã†ã€‚ containerPortã®ã¿ã‚’è¨­å®šã—ã€hostPortã¯è¨­å®šã—ãªã‘ã‚Œã°ã€EXPOSEã¨ã—ã¦å®šç¾©ã§ãã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/APIReference/API_PortMapping.html secrets(volumesFrom) SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã‹ã‚‰å‡ºåŠ›ã™ã‚‹å¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ memory --memory--memory-reservation ã‚¿ã‚¹ã‚¯å…¨ä½“ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒ¡ãƒ¢ãƒªã®ã†ã¡ã€è©²å½“ã®ã‚³ãƒ³ãƒ†ãƒŠã«å‰²ã‚Šå½“ã¦ã‚‹ãƒ¡ãƒ¢ãƒªåˆ†ã‚’è¨­å®šã™ã‚‹ã€‚ mountPoints ulimit Linuxã‚³ãƒãƒ³ãƒ‰ã®--ulimitã«ç›¸å½“ ãƒ»awslogsãƒ‰ãƒ©ã‚¤ãƒãƒ¼ æ¨™æº–å‡ºåŠ›ï¼æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚ŒãŸãƒ­ã‚°ã‚’CloudWatch-APIã«é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼š https://docs.docker.com/config/containers/logging/awslogs/ https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/using_awslogs.html#create_awslogs_logdriver_options è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ awslogs-group ãƒ­ã‚°é€ä¿¡å…ˆã®CloudWatchãƒ­ã‚°ã®ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ awslogs-datetime-format æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å®šç¾©ã—ã€ã¾ãŸã“ã‚Œã‚’ãƒ­ã‚°ã®åŒºåˆ‡ã‚Šå˜ä½ã¨ã—ã¦ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å‡ºåŠ›ã™ã‚‹ã€‚ æ­£è¦è¡¨ç¾ã§è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã•ã‚‰ã«JSONã§ã¯ã€\\ã€ã‚’ã€\\\\ã€ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ä¾‹ãˆã°ã€\\\\[%Y-%m-%d %H:%M:%S\\\\]ã€ã¨ãªã‚‹ã€‚å‚è€ƒï¼šhttps://docs.docker.com/config/containers/logging/awslogs/#awslogs-datetime-format awslogs-region ãƒ­ã‚°é€ä¿¡å…ˆã®CloudWatchãƒ­ã‚°ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ awslogs-stream-prefix ãƒ­ã‚°é€ä¿¡å…ˆã®CloudWatchãƒ­ã‚°ã®ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹åã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã€ã€//ã€ã®å½¢å¼ã§é€ä¿¡ã•ã‚Œã‚‹ã€‚ ãƒ»å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ ã‚¿ã‚¹ã‚¯ã”ã¨ã«ç•°ãªã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ã“ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦ã€ALBã¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã†ã€‚ ãƒ­ãƒ¼ãƒ« ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ãƒ¼ãƒ« ã‚µãƒ¼ãƒ“ã‚¹æ©Ÿèƒ½ãŒã‚¿ã‚¹ã‚¯ã‚’æ“ä½œã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ­ãƒ¼ãƒ«ã®ã“ã¨ã€‚ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ«ã«å«ã¾ã‚Œã€ECSã®æ§‹ç¯‰æ™‚ã«è‡ªå‹•çš„ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€‚ ãƒ»ã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« ã‚¿ã‚¹ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã€ä»–ã®ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ­ãƒ¼ãƒ«ã®ã“ã¨ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«S3ã‚„SSMã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ä¸ãˆãŸã„å ´åˆã¯ã€ã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã§ã¯ãªãã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«æ¨©é™ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰CloudWatchãƒ­ã‚°ã«ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ã€ECSã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"logs:CreateLogStream\", \"logs:PutLogEvents\" ], \"Resource\": [ \"arn:aws:logs:*:*:*\" ] } ] } ï¼Šå®Ÿè£…ä¾‹ï¼Š SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã‹ã‚‰å¤‰æ•°ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã€ECSã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"ssm:GetParameters\" ], \"Resource\": \"*\" } ] } ãƒ»ã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ­ãƒ¼ãƒ« ã‚¿ã‚¹ã‚¯ä¸Šã«å­˜åœ¨ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã€ä»–ã®ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ­ãƒ¼ãƒ«ã®ã“ã¨ã€‚AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã§ã‚ã‚‹ã€AmazonECSTaskExecutionRolePolicyã€ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸãƒ­ãƒ¼ãƒ«ã‚’ã€ã‚¿ã‚¹ã‚¯ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã®ãƒãƒªã‚·ãƒ¼ã«ã¯ã€ECRã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®ä»–ã€CloudWatchãƒ­ã‚°ã«ãƒ­ã‚°ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®æ¨©é™ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ã‚¿ã‚¹ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠãŒãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã¨ã¯åŒºåˆ¥ã™ã‚‹ã“ã¨ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"ecr:GetAuthorizationToken\", \"ecr:BatchCheckLayerAvailability\", \"ecr:GetDownloadUrlForLayer\", \"ecr:BatchGetImage\", \"logs:CreateLogStream\", \"logs:PutLogEvents\" ], \"Resource\": \"*\" } ] } ï¼Šå®Ÿè£…ä¾‹ï¼Š Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚„ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã€ECSã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã«ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ecs:ListClusters\", \"ecs:ListContainerInstances\", \"ecs:DescribeContainerInstances\" ], \"Effect\": \"Allow\", \"Resource\": \"*\" } ] } ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ã‚³ãƒ³ãƒ†ãƒŠé–“é€šä¿¡ ãƒ»noneãƒ¢ãƒ¼ãƒ‰ å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒç„¡ãã€ã‚¿ã‚¹ã‚¯ã¨å¤–ã¨é€šä¿¡ã§ããªã„ã€‚ ãƒ»hostãƒ¢ãƒ¼ãƒ‰ Dockerã®hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»bridgeãƒ¢ãƒ¼ãƒ‰ Dockerã®bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»awsvpcãƒ¢ãƒ¼ãƒ‰ awsã®ç‹¬è‡ªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã€‚ã‚¿ã‚¹ã‚¯ã¯Elastic Networkã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ç´ä»˜ã‘ã‚‰ã‚Œã€Primary ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚åŒã˜ã‚¿ã‚¹ã‚¯ã«å±ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠé–“ã¯ã€localhostã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¨ã„ã†ENIçµŒç”±ã§é€šä¿¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ï¼ˆæ¨æ¸¬ã§ã¯ã‚ã‚‹ãŒã€Fargateç’°å¢ƒã§ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ›ã‚¹ãƒˆã¨ãªã‚‹EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«localhostã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒç´ä»˜ã‘ã‚‰ã‚Œã‚‹ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã¨ãï¼ˆä¾‹ï¼šNginxã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰PHP-FPMã‚³ãƒ³ãƒ†ãƒŠã¸ã®è»¢é€ï¼‰ã¯ã€è»¢é€å…ƒã‚³ãƒ³ãƒ†ãƒŠã«ã¦ã€è»¢é€å…ˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€localhostï¼ˆ127.0.0.1ï¼‰ã€ã§æŒ‡å®šã™ã‚Œã°è‰¯ã„ã€‚ã¾ãŸã€awsvpcãƒ¢ãƒ¼ãƒ‰ã®ç‹¬è‡ªã®ä»•çµ„ã¿ã¨ã—ã¦ã€åŒã˜ã‚¿ã‚¹ã‚¯å†…ã§ã‚ã‚Œã°ã€äº’ã„ã«ã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã›ãšã¨ã‚‚ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ãƒãƒ¼ãƒˆã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§ã€ã‚³ãƒ³ãƒ†ãƒŠé–“ã§é€šä¿¡ãŒã§ãã‚‹ã€‚ä¾‹ãˆã°ã€Nginxã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰PHP-FPMã‚³ãƒ³ãƒ†ãƒŠã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ãŸã‚ã«ã¯ã€PHP-FPMãƒ—ãƒ­ã‚»ã‚¹ãŒ9000ç•ªãƒãƒ¼ãƒˆã‚’ãƒªãƒƒã‚¹ãƒ³ã—ã€ã•ã‚‰ã«ã‚³ãƒ³ãƒ†ãƒŠãŒ9000ç•ªãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã—ã‹ã—ã€awsvpcãƒ¢ãƒ¼ãƒ‰ã§ã¯ã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/userguide/fargate-task-networking.html ã‚¿ã‚¹ã‚¯ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã®ç¨®é¡ ãƒ»ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ å‚è€ƒï¼šhttps://toris.io/2021/04/speeding-up-amazon-ecs-container-deployments/ æœ€å°ãƒ˜ãƒ«ã‚¹ç‡ã®è¨­å®šå€¤ã«åŸºã¥ã„ã¦ã€ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ™‚ã®ç¨¼åƒä¸­ã‚¿ã‚¹ã‚¯ã®æœ€ä½åˆè¨ˆæ•°ãŒæ±ºå®šã•ã‚Œã‚‹ã€‚ æœ€å¤§ç‡ã®è¨­å®šå€¤ã«åŸºã¥ã„ã¦ã€ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ™‚ã®ç¨¼åƒä¸­ï¼åœæ­¢ä¸­ã‚¿ã‚¹ã‚¯ã®æœ€é«˜åˆè¨ˆæ•°ãŒæ±ºã¾ã‚‹ ECSã¯ã€æ—¢å­˜ã‚¿ã‚¹ã‚¯ã‚’ç¨¼åƒä¸­ã®ã¾ã¾ã€æ–°ã‚¿ã‚¹ã‚¯ã‚’æœ€é«˜åˆè¨ˆæ•°ã„ã£ã±ã„ã¾ã§æ§‹ç¯‰ã™ã‚‹ã€‚ ECSã¯ã€çŒ¶äºˆæœŸé–“å¾Œã«ALBï¼NLBã«ã‚ˆã‚‹æ–°ã‚¿ã‚¹ã‚¯ã«å¯¾ã™ã‚‹ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®çµæœã‚’ç¢ºèªã™ã‚‹ã€‚ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãŒæˆåŠŸã—ã¦ã„ã‚Œã°ã€æ—¢å­˜ã‚¿ã‚¹ã‚¯ã‚’åœæ­¢ã™ã‚‹ã€‚ãŸã ã—ã€æœ€å°ãƒ˜ãƒ«ã‚¹ç‡ã«ã‚ˆã‚‹ã‚¿ã‚¹ã‚¯ã®æœ€ä½åˆè¨ˆæ•°ãŒä¿ãŸã‚Œã‚‹ã€‚ ã€æ–°ã‚¿ã‚¹ã‚¯ã®èµ·å‹•ã€ã¨ã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç¢ºèªå¾Œã®æ—¢å­˜ã‚¿ã‚¹ã‚¯ã®åœæ­¢ã€ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒç¹°ã‚Šè¿”ã—å®Ÿè¡Œã•ã‚Œã€å¾ã€…ã«æ—¢å­˜ã‚¿ã‚¹ã‚¯ãŒæ–°ã‚¿ã‚¹ã‚¯ã«ç½®ãæ›ã‚ã‚‹ã€‚ å…¨ã¦ã®æ—¢å­˜ã‚¿ã‚¹ã‚¯ãŒæ–°ã‚¿ã‚¹ã‚¯ã«ç½®ãæ›ã‚ã‚‹ã€‚ ãƒ»Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ CodeDeployã‚’ç”¨ã„ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã†ã€‚æœ¬ãƒãƒ¼ãƒˆå†…ã‚’æ¤œç´¢ã›ã‚ˆã€‚ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªECSã‚¿ã‚¹ã‚¯ã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ ãƒ»ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‹ã‚‰ã®é€šä¿¡ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«ECSã‚¿ã‚¹ã‚¯ã‚’é…ç½®ã—ãŸå ´åˆã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªé€šä¿¡ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€NAT Gatewayã¾ãŸã¯VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã«é…ç½®ã™ã‚Œã°ã“ã‚Œã‚‰ã¯ä¸è¦ã¨ãªã‚‹ãŒã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã‚ˆã‚Šã‚‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«ECSã‚¿ã‚¹ã‚¯ã‚’é…ç½®ã™ã‚‹æ–¹ãŒæœ›ã¾ã—ã„ã€‚ ãƒ»NAT Gatewayã‚’çµŒç”± Fargateã‹ã‚‰ECRã«å¯¾ã™ã‚‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ«ã¯ã€VPCã®å¤–å´ã«å¯¾ã™ã‚‹ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å‘ãé€šä¿¡ï¼‰ã§ã‚ã‚‹ã€‚ä»¥ä¸‹ã®é€šã‚Šã€NAT Gatewayã‚’è¨­ç½®ã—ãŸã¨ã™ã‚‹ã€‚ã“ã®å ´åˆã€ECSã‚„ECRã¨ã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ãŒNAT Gatewayã‚’é€šéã™ã‚‹ãŸã‚ã€é«˜é¡æ–™é‡‘ã‚’è«‹æ±‚ã•ã‚Œã¦ã—ã¾ã†ã€‚ ãƒ»VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’çµŒç”± VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¨­ã‘ã€ã“ã‚Œã«å¯¾ã—ã¦ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã‚’è¡Œã†ã‚ˆã†ã«ã™ã‚‹ã¨ã‚ˆã„ã€‚ãªãŠã€NAT Gatewayã¨VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¸¡æ–¹ã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹å ´åˆã€ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã§ã¯ã€VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã®æ–¹ãŒå„ªå…ˆã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€NATGatewayãŒã‚ã‚‹çŠ¶æ…‹ã§VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹ã¨ã€æ¥ç¶šå…ˆãŒè‡ªå‹•çš„ã«å¤‰ã‚ã£ã¦ã—ã¾ã†ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚æ–™é‡‘çš„ãªè¦³ç‚¹ã‹ã‚‰ã€NAT Gatewayã‚ˆã‚Šã‚‚VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’çµŒç”±ã—ãŸæ–¹ãŒã‚ˆã„ã€‚ VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æ¥ç¶šå…ˆ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆDNSå èª¬æ˜ CloudWatchãƒ­ã‚° logs.ap-northeast-1.amazonaws.com ECSã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã€‚ ECR api.ecr.ap-northeast-1.amazonaws.com*.dkr.ecr.ap-northeast-1.amazonaws.com ã‚¤ãƒ¡ãƒ¼ã‚¸ã®GETãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã€‚ S3 ãªã— ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ ssm.ap-northeast-1.amazonaws.com SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã«GETãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã€‚ SSMã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ ssmmessage.ap-northeast-1.amazonaws.com ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ã®æ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ãŸã‚ã€‚ FireLensã‚³ãƒ³ãƒ†ãƒŠ ãƒ»FireLensã‚³ãƒ³ãƒ†ãƒŠã¨ã¯ ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/summary.html?q=firelens Tips ãƒ»å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€Fargateã®IPã‚¢ãƒ‰ãƒ¬ã‚¹å•é¡Œ Fargateã«ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒãŸã›ãŸã„å ´åˆã€Elastic IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®è¨­å®šé …ç›®ãŒãªãã€å‹•çš„ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã—ã‹è¨­å®šã§ããªã„ï¼ˆFargateã®å†æ§‹ç¯‰å¾Œã«å¤‰åŒ–ã™ã‚‹ï¼‰ã€‚ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã®å…ˆã«ã‚ã‚‹å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ãŒã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã§é™çš„ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¦æ±‚ã™ã‚‹å ´åˆã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å‘ãé€šä¿¡ï¼‰æ™‚ã«é€ä¿¡å…ƒãƒ‘ã‚±ãƒƒãƒˆã«ä»˜åŠ ã•ã‚Œã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‹•çš„ã«ãªã‚Šã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã§ããªããªã£ã¦ã—ã¾ã†ã€‚ ãã“ã§ã€Fargateã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ãŒã€Elastic IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã¤NAT Gatewayã‚’çµŒç”±ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼ˆFargateã¯ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®ã©ã¡ã‚‰ã«ç½®ã„ã¦ã‚‚è‰¯ã„ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€Nat Gatewayã®Elastic IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒé€ä¿¡å…ƒãƒ‘ã‚±ãƒƒãƒˆã«ä»˜åŠ ã•ã‚Œã‚‹ãŸã‚ã€Fargateã®é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¦‹ã‹ã‘ä¸Šé™çš„ã«æ‰±ãˆã‚‹ã€‚ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/premiumsupport/knowledge-center/ecs-fargate-static-elastic-ip-address/ 15. EFSï¼šElastic File System EFSã¨ã¯ ãƒã‚¦ãƒ³ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨æ¥ç¶šã•ã‚ŒãŸç‰‡æ–¹ã®EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ã“ã‚Œã‚’ã‚‚ã†ä¸€æ–¹ã«å‡ºåŠ›ã™ã‚‹ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿä½“ã¯ã„ãšã‚Œã‹ã®EC2ã«å­˜åœ¨ã—ã¦ã„ã‚‹ãŸã‚ã€æ¥ç¶šã‚’åˆ‡æ–­ã—ã¦ã„ã‚‹é–“ã€ç‰‡æ–¹ã®EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç„¡ããªã‚‹ã€‚å†æ¥ç¶šã™ã‚‹ã¨ã€åˆ‡æ–­ç›´å‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå†ã³è¡¨ç¤ºã•ã‚Œã‚ˆã†ã«ãªã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆãƒ¢ãƒ¼ãƒ‰ EFSã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆæ€§èƒ½ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ ã—ã°ã‚‰ããƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½é »åº¦ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆIAï¼šInfrequent Accessï¼‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ã«ç§»å‹•ä¿å­˜ã™ã‚‹ã¾ã§ã®æœŸé™ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ã‚’æœ‰åŠ¹ã«ã—ãªã„å ´åˆã€ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ã®ã¿ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ãƒ»ç”»é¢ã‹ã‚‰ä¸¡ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä½¿ç”¨é‡ã‚’ç¢ºèªã§ãã‚‹ã€‚å‚è€ƒï¼šhttps://ap-northeast-1.console.aws.amazon.com/efs/home?region=ap-northeast-1#/file-systems/fs-f77d60d6 ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãƒãƒªã‚·ãƒ¼ ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ãŒEFSã‚’åˆ©ç”¨ã™ã‚‹æ™‚ã®ãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— AWS Backupã«å®šæœŸçš„ã«ä¿å­˜ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ãƒã‚¦ãƒ³ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’è¨­ç½®ã™ã‚‹ã‚µãƒ–ãƒãƒƒãƒˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ã‚µãƒ–ãƒãƒƒãƒˆã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ä¾›çµ¦ã®é€Ÿåº¦ã®è¦³ç‚¹ã‹ã‚‰ã€ãƒã‚¦ãƒ³ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã¨åŒã˜ã«ã™ã‚‹ã€‚ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€EC2ã‹ã‚‰ã®NFSãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ãŸã‚‚ã®ã‚’è¨­å®šã™ã‚‹ã€‚EC2ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’é€šéã—ãŸã‚¢ã‚¯ã‚»ã‚¹ã ã‘ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã¯ã€EC2ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¹ãƒšãƒƒã‚¯ ãƒ»ãƒãƒ¼ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã®ä»•çµ„ã¿ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆæ€§èƒ½ã®è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«æ®‹é«˜ãŒã‚ã‚Šã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’è¶…éã—ãŸåˆ†ã ã‘è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æ®‹é«˜ãŒæ¸›ã£ã¦ã„ãã€‚ã¾ãŸã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æœªæº€ã®åˆ†ã¯æ®‹é«˜ã¨ã—ã¦è“„ç©ã•ã‚Œã¦ã„ãã€‚ å…ƒã€…ã®æ®‹é«˜ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ã®å®¹é‡ã«å¿œã˜ã¦å¤§ãããªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/efs/latest/ug/performance.html#efs-burst-credits æ®‹é«˜ã¯ã€BurstCreditBalanceãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‹ã‚‰ç¢ºèªã§ãã‚‹ã€‚ã“ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒå¸¸ã«æ¸›å°‘ã—ç¶šã‘ã¦ã„ã‚‹å ´åˆã¯ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã®æ–¹ãŒã‚ˆã‚Šé©åˆ‡ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/efs/latest/ug/performance.html#using-throughputmode ãƒ»ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã®ä»•çµ„ã¿ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆæ€§èƒ½ã®è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æ©Ÿèƒ½ã¯ç„¡ã„ãŒã€ä¸€å®šã®æ€§èƒ½ã¯ä¿è¨¼ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/efs/latest/ug/performance.html#provisioned-throughput ã‚³ãƒãƒ³ãƒ‰ ãƒ»ãƒã‚¦ãƒ³ãƒˆ DNSçµŒç”±ã§ã€EFSãƒã‚¦ãƒ³ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’ç”¨ã„ãŸå ´åˆã‚’ç¤ºã™ã€‚ $ mount -t -o tls :/ # EFSã§ã€ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã‚’ç™»éŒ² $ mount -t efs -o tls fs-xxxxx:/ /var/www/app # ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã‚’è§£é™¤ $ umount /var/www/app # dfã‚³ãƒãƒ³ãƒ‰ã§ãƒã‚¦ãƒ³ãƒˆã—ã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèªã§ãã‚‹ $ df Filesystem 1K-blocks Used Available Use% Mounted on fs-xxx.efs.ap-northeast-1.amazonaws.com:/ xxx xxx xxx 1% /var/www/cerenavi 16. ElastiCache ElasticCacheã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»£ã‚ã‚Šã«ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€ã‚’ç®¡ç†ã™ã‚‹ã€‚Redisã¨MemcachedãŒã‚ã‚‹ã€‚ 16-02. ElastiCache for Redis è¨­å®šé …ç›® è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ å…¨ã¦ã®Redisãƒãƒ¼ãƒ‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¨ãƒ³ã‚¸ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚Redisé€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã€Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰é¸æŠã™ã‚‹ã€‚ Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã¨åŒæ§˜ã«ã€Redisé€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã‚‚ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ§‹æˆã«ãªã‚‹ã€‚ãŸã ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã¨ã¯ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®æ§‹æˆæ–¹æ³•ãŒç•°ãªã‚‹ã€‚ ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®äº’æ›æ€§ å…¨ã¦ã®Redisãƒãƒ¼ãƒ‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒã‚¤ãƒŠãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œãªã„ã‚ˆã†ã«ã€ä¾‹ãˆã°ã€6.xã€ã¯è¨­å®šã—ãªã„æ–¹ãŒã‚ˆã„ã€‚ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ— å…¨ã¦ã®Redisãƒãƒ¼ãƒ‰ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ä½¿ç”¨ã›ãšã«ç‹¬è‡ªå®šç¾©ã™ã‚‹å ´åˆã€äº‹å‰ã«æ§‹ç¯‰ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ ãƒãƒ¼ãƒ‰ã®ã‚¿ã‚¤ãƒ— ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ•° ãƒ—ãƒ©ã‚¤ãƒãƒªãƒãƒ¼ãƒ‰ã¨ã¯åˆ¥ã«ã€ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ãƒãƒ¼ãƒ‰ã‚’ã„ãã¤æ§‹ç¯‰ã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒãƒ«ãƒAZã«ãƒ—ãƒ©ã‚¤ãƒãƒªãƒãƒ¼ãƒ‰ã¨ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ãƒãƒ¼ãƒ‰ã‚’ä¸€ã¤ãšã¤é…ç½®ã•ã›ã‚‹å ´åˆã€ã“ã“ã§ã¯ã€ï¼‘å€‹ã€ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒãƒ«ãƒAZ ãƒ—ãƒ©ã‚¤ãƒãƒªãƒãƒ¼ãƒ‰ã¨ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã‚’ç•°ãªã‚‹AZã«é…ç½®ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚åˆã‚ã›ã¦ã€è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— Redisã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚µãƒ–ãƒãƒƒãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¸ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ã‚ã‚‰ã‹ã˜ã‚ä½œæˆã—ã¦ãŠã„ãŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€ã“ã‚Œã‚’å…ƒã«Redisã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚„ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å¼•ãç¶™ã’ã‚‹ã€‚ãã®ãŸã‚ã€æ–°ã—ã„Redisã¸ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œã«å½¹ç«‹ã¤ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/backups-seeding-redis.html ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®æœ‰åŠ¹åŒ–ã€ä¿æŒæœŸé–“ã€æ™‚é–“ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã‚‹ã»ã©ã§ã‚‚ãªã„ãŸã‚ã€ç„¡åŠ¹åŒ–ã—ã¦ãŠã„ã¦å•é¡Œãªã„ã€‚ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®æ™‚é–“ã‚’è¨­å®šã™ã‚‹ã€‚ Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ ãƒ»Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨ã¯ è¤‡æ•°ã®Redisãƒãƒ¼ãƒ‰ã‚’æŒã¤Redisã‚·ãƒ£ãƒ¼ãƒ‰ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/WhatIs.Terms.html https://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/WhatIs.Components.html#WhatIs.Components.Clusters ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å†…ã«è¤‡æ•°ã®Redisã‚·ãƒ£ãƒ¼ãƒ‰ãŒæ§‹ç¯‰ã•ã‚Œã‚‹ã€‚åå¯¾ã«ç„¡åŠ¹åŒ–ã™ã‚‹ã¨ã€ã‚·ãƒ£ãƒ¼ãƒ‰ã¯ä¸€ã¤ã ã‘æ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/WhatIs.Components.html#WhatIs.Components.ReplicationGroups Redisã‚·ãƒ£ãƒ¼ãƒ‰ ãƒ»Redisã‚·ãƒ£ãƒ¼ãƒ‰ã¨ã¯ Redisãƒãƒ¼ãƒ‰ã®ã‚°ãƒ«ãƒ¼ãƒ—ã€‚åŒã˜Redisã‚·ãƒ£ãƒ¼ãƒ‰å†…ã«ã‚ã‚‹Redisãƒãƒ¼ãƒ‰é–“ã§ã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚„ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒåŒæœŸã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/WhatIs.Components.html#WhatIs.Components.Shards Redisãƒãƒ¼ãƒ‰ ãƒ»Redisãƒãƒ¼ãƒ‰ã¨ã¯ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚„ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç®¡ç†ã™ã‚‹ã€‚ ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†æ©Ÿèƒ½ ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†æ©Ÿèƒ½ã¨ã¯ ã‚µãƒ¼ãƒå†…ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä»£ã‚ã‚Šã«ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç®¡ç†ã—ã€å†—é•·åŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã§å…±é€šã®ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_collaboration_api_restful.html ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†æ©Ÿèƒ½ ãƒ»ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†æ©Ÿèƒ½ã¨ã¯ RDSã«å¯¾ã™ã‚‹SQLã¨èª­ã¿å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã—ã¦ç®¡ç†ã™ã‚‹ã€‚ ï¼ˆï¼‘ï¼‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€RDSã®å‰ã«ã€Redisã«å¯¾ã—ã¦SQLã‚’å®Ÿè¡Œã™ã‚‹ã€‚ SELECT * FROM users; ï¼ˆï¼’ï¼‰å§‹ã‚ã¦å®Ÿè¡Œã•ã‚ŒãŸSQLã®å ´åˆã€Redisã¯SQLã‚’ã‚­ãƒ¼ã¨ã—ã¦ä¿å­˜ã—ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒç„¡ã„ã“ã¨ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿”å´ã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯RDSã«å¯¾ã—ã¦SQLã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼ˆï¼”ï¼‰ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿å‡ºã•ã‚Œã‚‹ã€‚ ï¼ˆï¼•ï¼‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯Redisã«ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ã™ã‚‹ã€‚ # ElastiCacheã«ã¯ã€SQLã®å®Ÿè¡ŒçµæœãŒã¾ã ä¿å­˜ã•ã‚Œã¦ã„ãªã„ *** no cache *** {\"id\"=>\"1\", \"name\"=>\"alice\"} {\"id\"=>\"2\", \"name\"=>\"bob\"} {\"id\"=>\"3\", \"name\"=>\"charles\"} {\"id\"=>\"4\", \"name\"=>\"donny\"} {\"id\"=>\"5\", \"name\"=>\"elie\"} {\"id\"=>\"6\", \"name\"=>\"fabian\"} {\"id\"=>\"7\", \"name\"=>\"gabriel\"} {\"id\"=>\"8\", \"name\"=>\"harold\"} {\"id\"=>\"9\", \"name\"=>\"Ignatius\"} {\"id\"=>\"10\", \"name\"=>\"jonny\"} ï¼ˆï¼–ï¼‰æ¬¡å›ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€RDSã®å‰ã«ã€Redisã«å¯¾ã—ã¦SQLã‚’å®Ÿè¡Œã™ã‚‹ã€‚ SELECT * FROM users; ï¼ˆï¼—ï¼‰Redisã¯ã€SQLã‚’ã‚­ãƒ¼ã«ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ç‰¹å®šã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿”å´ã™ã‚‹ã€‚ # ElastiCacheã«ã¯ã€SQLã®å®Ÿè¡ŒçµæœãŒæ—¢ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ *** cache hit *** {\"id\"=>\"1\", \"name\"=>\"alice\"} {\"id\"=>\"2\", \"name\"=>\"bob\"} {\"id\"=>\"3\", \"name\"=>\"charles\"} {\"id\"=>\"4\", \"name\"=>\"donny\"} {\"id\"=>\"5\", \"name\"=>\"elie\"} {\"id\"=>\"6\", \"name\"=>\"fabian\"} {\"id\"=>\"7\", \"name\"=>\"gabriel\"} {\"id\"=>\"8\", \"name\"=>\"harold\"} {\"id\"=>\"9\", \"name\"=>\"Ignatius\"} {\"id\"=>\"10\", \"name\"=>\"jonny\"} ãƒ»ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ“ä½œ # Redisæ¥ç¶šã‚³ãƒãƒ³ãƒ‰ $ /usr/local/sbin/redis-stable/src/redis-cli \\ -c -h -p 6379 # Redisæ¥ç¶šä¸­ã®çŠ¶æ…‹ # å…¨ã¦ã®ã‚­ãƒ¼ã‚’è¡¨ç¤º redis xxxxx:6379> keys * # Redisæ¥ç¶šä¸­ã®çŠ¶æ…‹ # ã‚­ãƒ¼ã‚’æŒ‡å®šã—ã¦ã€å¯¾å¿œã™ã‚‹å€¤ã‚’è¡¨ç¤º redis xxxxx:6379> type # Redisæ¥ç¶šä¸­ã®çŠ¶æ…‹ # RedisãŒå—ã‘å–ã£ãŸã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§è¡¨ç¤º redis xxxxx:6379> monitor éšœå®³å¯¾ç­– ãƒ»ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ ãƒãƒ¼ãƒ‰ã®éšœå®³ã‚’æ¤œçŸ¥ã—ã€éšœå®³ãŒç™ºç”Ÿã—ãŸãƒãƒ¼ãƒ‰ã‚’æ–°ã—ã„ã‚‚ã®ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã€‚ éšœå®³ã®ç™ºç”Ÿã—ãŸãƒãƒ¼ãƒ‰ æŒ™å‹• ãƒ—ãƒ©ã‚¤ãƒãƒªãƒãƒ¼ãƒ‰ ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã®ä¸€ã¤ãŒãƒ—ãƒ©ã‚¤ãƒãƒªãƒãƒ¼ãƒ‰ã«æ˜‡æ ¼ã—ã€éšœå®³ãŒèµ·ããŸãƒ—ãƒ©ã‚¤ãƒãƒªãƒãƒ¼ãƒ‰ã¨ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã€‚ ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ãƒãƒ¼ãƒ‰ éšœå®³ãŒèµ·ããŸãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ãƒãƒ¼ãƒ‰ãŒã€åˆ¥ã®æ–°ã—ã„ã‚‚ã®ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã€‚ Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ»ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®ç™ºç”Ÿæ¡ä»¶ å¤‰æ›´ã™ã‚‹é …ç›® ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ‰ç„¡ ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ã‚ã‚Š 1åˆ†30ç§’ã»ã©ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ è¨ˆç”»çš„ãªãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ»è¨ˆç”»çš„ãªãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã¨ã¯ Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã§ã¯ã€ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ™‚ã«ã€Redisãƒãƒ¼ãƒ‰ã®å†èµ·å‹•ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã‚µã‚¤ãƒˆã®åˆ©ç”¨è€…ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’å°ã•ãã§ãã‚‹ã‚ˆã†ã«ã€è¨ˆç”»çš„ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’ç™ºç”Ÿã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«ã‚ˆã‚‹ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ€å°åŒ– ä»¥ä¸‹ã®æ‰‹é †ã§ã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æœ€å°é™ã«ã—ã¦ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã§ãã‚‹ã€‚ ï¼ˆï¼‘ï¼‰Redisã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚„ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’S3ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰æ–°ã—ã„Redisã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ã“ã®æ™‚ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ç”¨ã„ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚„ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å¼•ãç¶™ã„ã Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’åˆ¥é€”æ§‹ç¯‰ã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰æ–°ã—ãæ§‹ç¯‰ã—ãŸRedisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹ã€‚ ï¼ˆï¼”ï¼‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¥ç¶šå…ˆã‚’å¤ã„Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‹ã‚‰æ–°ã—ã„ã‚‚ã®ã«å¤‰æ›´ã™ã‚‹ã€‚ ï¼ˆï¼•ï¼‰å¤ã„Redisã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã€‚ 17. EventBridgeï¼ˆCloudWatchã‚¤ãƒ™ãƒ³ãƒˆï¼‰ EventBridgeï¼ˆCloudWatchã‚¤ãƒ™ãƒ³ãƒˆï¼‰ã¨ã¯ AWSãƒªã‚½ãƒ¼ã‚¹ã§èµ·ã“ã£ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’ã€ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ã«è»¢é€ã™ã‚‹ã€‚ã‚µãƒãƒ¼ãƒˆå¯¾è±¡ã®AWSãƒªã‚½ãƒ¼ã‚¹ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/eventbridge/latest/userguide/what-is-amazon-eventbridge.html ãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ æŒ‡å®šã—ãŸAWSãƒªã‚½ãƒ¼ã‚¹ã§ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ã“ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªJSONãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®šç¾©ã—ã€JSONæ§‹é€ ãŒä¸€è‡´ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã®ã¿ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«è»¢é€ã™ã‚‹ã€‚ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã«å®šç¾©ã—ãªã„ã‚­ãƒ¼ã¯ä»»æ„ã®ãƒ‡ãƒ¼ã‚¿ã¨è¦‹ãªã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/CloudWatchEventsandEventPatterns.html { \"version\": \"0\", \"id\": \"*****\", \"detail-type\": \"\", \"source\": \"aws.\", \"account\": \"*****\", \"time\": \"2021-01-01T00:00:00Z\", \"region\": \"us-west-1\", \"resources\": [ \"\" ], \"detail\": { // ãã®æ™‚ã€…ã®ã‚¤ãƒ™ãƒ³ãƒˆã”ã¨ã«ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ } } ï¼Šå®Ÿè£…ä¾‹ï¼Š Amplifyã®æŒ‡å®šã—ãŸIDã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã€Amplify Deployment Status Changeã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡ã—ã€ã“ã‚Œã®jobStatusãŒSUCCEEDï¼FAILEDã ã£ãŸå ´åˆã€ã“ã‚Œã‚’è»¢é€ã™ã‚‹ã€‚ { \"detail\": { \"appId\": [ \"foo\", \"bar\" ], \"jobStatus\": [ \"SUCCEED\", \"FAILED\" ] }, \"detail-type\": [ \"Amplify Deployment Status Change\" ], \"source\": \"aws.amplify\" } ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« cronå¼ã¾ãŸã¯rateå¼ã‚’ä½¿ç”¨ã—ã€å®šæœŸã‚¸ãƒ§ãƒ–ã‚’å®šç¾©ã¥ã‘ã‚‹ã€‚ã“ã‚Œã¨Lambdaã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ãƒãƒƒãƒå‡¦ç†ã‚’æ§‹ç¯‰ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/ScheduledEvents.html ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ä¸€è¦§ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/eventbridge/latest/userguide/eb-targets.html ãƒ»ãƒ‡ãƒãƒƒã‚° EventBridgeã§ã¯ã€ã©ã®ã‚ˆã†ãªJSONã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«è»¢é€ã—ãŸã‹ã‚’ç¢ºèªã§ããªã„ã€‚ãã“ã§ã€ãƒ‡ãƒãƒƒã‚°æ™‚ã¯EventBridgeã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«Lambdaã‚’è¨­å®šã—ã€ã‚¤ãƒ™ãƒ³ãƒˆæ§‹é€ ã‚’ãƒ­ã‚°ã‹ã‚‰ç¢ºèªã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚ã‚‰ã‹ã˜ã‚ã€ã‚¤ãƒ™ãƒ³ãƒˆã®å†…å®¹ã‚’å‡ºåŠ›ã™ã‚‹é–¢æ•°ã‚’Lambdaã«ä½œæˆã—ã¦ãŠãã€‚ // Lambdaã«ãƒ‡ãƒãƒƒã‚°ç”¨ã®é–¢æ•°ã‚’ç”¨æ„ã™ã‚‹ exports.handler = async (event) => { console.log(JSON.stringify({event}, null, 2)); }; å¯¾è±¡ã®AWSãƒªã‚½ãƒ¼ã‚¹ã§ä»»æ„ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ã“ã£ãŸæ™‚ã«ã€EventBridgeã‹ã‚‰Lambdaã«è»¢é€ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚ { \"source\": \"aws.amplify\" } AWSãƒªã‚½ãƒ¼ã‚¹ã§æ„å›³çš„ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’èµ·ã“ã—ã€Lambdaã®ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã€‚detailã‚­ãƒ¼ã«ã‚¤ãƒ™ãƒ³ãƒˆãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ { \"event\": { \"version\": \"0\", \"id\": \"b4a07570-eda1-9fe1-da5e-b672a1705c39\", \"detail-type\": \"Amplify Deployment Status Change\", \"source\": \"aws.amplify\", \"account\": \"\", \"time\": \"\", \"region\": \"\", \"resources\": [ \"\" ], \"detail\": { \"appId\": \"\", \"branchName\": \"\", \"jobId\": \"\", \"jobStatus\": \"\" } } } å…¥åŠ› ãƒ»å…¥åŠ›ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒãƒ¼ å…¥åŠ›ãƒ‘ã‚¹ã§ç”¨ã„ã‚‹å€¤ã‚’æŠ½å‡ºã—ã€å…¥åŠ›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§è»¢é€ã™ã‚‹JSONã‚’å®šç¾©ã§ãã‚‹ã€‚ã‚¤ãƒ™ãƒ³ãƒˆã®JSONã®å€¤ã‚’å¤‰æ•°ã¨ã—ã¦å‡ºåŠ›ã§ãã‚‹ã€‚eventã‚­ãƒ¼ã‚’ãƒ‰ãƒ«ãƒãƒ¼ã‚¯ã¨ã—ã¦ã€ãƒ‰ãƒƒãƒˆã§ç¹‹ã„ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š å…¥åŠ›ãƒ‘ã‚¹ã«ã¦ã€ç”¨ã„ã‚‹å€¤ã‚’æŠ½å‡ºã™ã‚‹ã€‚Amplifyã§èµ·ã“ã£ãŸã‚¤ãƒ™ãƒ³ãƒˆã®JSONã‚’å¤‰æ•°ã¨ã—ã¦å–ã‚Šå‡ºã™ã€‚JSONã®ã‚­ãƒ¼åãŒå¤‰æ•°åã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã€‚ { \"appId\": \"$.detail.appId\", \"branchName\": \"$.detail.branchName\", \"jobId\": \"$.detail.jobId\", \"jobStatus\": \"$.detail.jobStatus\", \"region\": \"$.region\" } å…¥åŠ›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¦ã€è»¢é€ã™ã‚‹JSONã‚’å®šç¾©ã™ã‚‹ã€‚ä¾‹ãˆã°ã“ã“ã§ã¯ã€Slackã«é€ä¿¡ã™ã‚‹JSONã«å‡ºåŠ›ã™ã‚‹ã€‚å‡ºåŠ›ã™ã‚‹ã¨ãã¯ã€å…¥åŠ›ãƒ‘ã‚¹ã®å¤‰æ•°åã‚’ã€<>ã€ã§å›²ã†ã€‚Slackã«é€ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä½œæˆãƒ„ãƒ¼ãƒ«ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://app.slack.com/block-kit-builder { \"channel\": \"XXXXXX\", \"text\": \"Amplifyãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†é€šçŸ¥\", \"blocks\": [ { \"type\": \"section\", \"text\": { \"type\": \"mrkdwn\", \"text\": \":github: ãƒ—ãƒ«ãƒªã‚¯æ¤œè¨¼ç”¨ç’°å¢ƒ\" } }, { \"type\": \"context\", \"elements\": [ { \"type\": \"mrkdwn\", \"text\": \"*çµæœ*: \" } ] }, { \"type\": \"context\", \"elements\": [ { \"type\": \"mrkdwn\", \"text\": \"*ãƒ–ãƒ©ãƒ³ãƒå*: \" } ] }, { \"type\": \"context\", \"elements\": [ { \"type\": \"mrkdwn\", \"text\": \"*æ¤œè¨¼URL*: https://..amplifyapp.com\" } ] }, { \"type\": \"context\", \"elements\": [ { \"type\": \"mrkdwn\", \"text\": \":amplify: .console.aws.amazon.com/amplify/home?region=#///|*Amplifyã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã¯ã“ã¡ã‚‰*>\" } ] }, { \"type\": \"divider\" } ] } 18. Global Accelerator è¨­å®šé …ç›® ãƒ»åŸºæœ¬çš„è¨­å®š è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Accelerator ã‚¿ã‚¤ãƒ— ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’è¨­å®šã™ã‚‹ã€‚ Standardï¼šãƒ¦ãƒ¼ã‚¶ã«æœ€ã‚‚è¿‘ã„ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã‚‹ã€‚ IPã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ—ãƒ¼ãƒ« Global Acceleratorã«å‰²ã‚Šå½“ã¦ã‚‹é™çš„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒªã‚¹ãƒŠãƒ¼ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒãƒ¼ãƒˆ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã®ãƒãƒ¼ãƒˆç•ªå·ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ Client affinity ãƒ¦ãƒ¼ã‚¶ã”ã¨ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã‚’å›ºå®šã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»Noneï¼šè¤‡æ•°ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆãŒã‚ã£ãŸå ´åˆã€å„ãƒ¦ãƒ¼ã‚¶ã®æ¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã¯å›ºå®šã•ã‚Œãªããªã‚‹ã€‚ãƒ»Source IPï¼šè¤‡æ•°ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆãŒã‚ã£ãŸã¨ã—ã¦ã‚‚ã€å„ãƒ¦ãƒ¼ã‚¶ã®æ¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã‚’å›ºå®šã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ãƒ»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ— è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ— ç‰¹å®šã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ç´ä»˜ãã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ€ã‚¤ãƒ¤ãƒ«ã«ã¦ã€å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã®é‡ã¿ã‚’è¨­å®šã§ãã‚‹ã€‚ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ€ã‚¤ãƒ¤ãƒ« è¤‡æ•°ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ãŒã‚ã‚‹å ´åˆã€ãã‚Œãã‚Œã®é‡ã¿ï¼ˆ%ï¼‰ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ä¾‹ãˆã°ã€ã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹ã®ãŸã‚ã«ã€æ–°ã‚¢ãƒ—ãƒªã¨æ—§ã‚¢ãƒ—ãƒªã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«é‡ã¿ã‚’ä»˜ã‘ã‚‹å ´åˆã«å½¹ç«‹ã¤ã€‚ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã«å¯¾ã™ã‚‹ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚¿ã‚¤ãƒ— ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã®AWSãƒªã‚½ãƒ¼ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ALBã€NLBã€EC2ã€Elastic IPã‚’é¸æŠã§ãã‚‹ã€‚ é‡ã¿ è¤‡æ•°ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒã‚ã‚‹å ´åˆã€ãã‚Œãã‚Œã®é‡ã¿ã‚’è¨­å®šã™ã‚‹ã€‚ å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®é‡ã¿ã®åˆè¨ˆå€¤ã‚’256ã¨ã—ã€1ï½255ã§ç›¸å¯¾å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ä¿æŒ X-Forwarded-Forãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å«ã‚ã¦è»¢é€ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ç´ æ—©ã„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç†ç”± æœ€åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å—ä¿¡ã•ã‚Œã‚‹ã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµŒç”±ã—ã¦ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¾ã§å±Šãã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ãªã„ãŸã‚ã€å°ã•ãªãƒ¬ã‚¤ãƒ†ã‚·ãƒ¼ã§ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ãã‚‹ã€‚ Global Acceleratorã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‹ã‚‰æŒ‡å®šã—ãŸãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«è‡³ã‚‹ã¾ã§ã€ã„ãã¤ã‚‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’çµŒç”±ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€æ™‚é–“ãŒã‹ã‹ã£ã¦ã—ã¾ã†ã€‚ ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã§ã€Global Acceleratorã‚’ç”¨ã„ãŸå ´åˆã¨ã—ãªã‹ã£ãŸå ´åˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹é€Ÿåº¦ã‚’æ¯”è¼ƒã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://speedtest.globalaccelerator.aws/#/ 19. IAMï¼šIdentify and Access Management IAM ãƒ»IAMã¨ã¯ AWSãƒªã‚½ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«é–¢ã™ã‚‹èªè¨¼ã¨èªå¯ã‚’åˆ¶å¾¡ã™ã‚‹ã€‚èªè¨¼ã¯ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã«ã‚ˆã£ã¦ã€ã¾ãŸèªå¯ã¯IAMãƒ­ãƒ¼ãƒ«ï¼IAMãƒãƒªã‚·ãƒ¼ï¼IAMã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã«ã‚ˆã£ã¦åˆ¶å¾¡ã•ã‚Œã‚‹ã€‚ ãƒ»IAMãƒ­ãƒ¼ãƒ«ã¨ã¯ IAMãƒãƒªã‚·ãƒ¼ã®ã‚»ãƒƒãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ ãƒ»IAMãƒãƒªã‚·ãƒ¼ã¨ã¯ IAMã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®ã‚»ãƒƒãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ IAMãƒãƒªã‚·ãƒ¼ã®ç¨®é¡ èª¬æ˜ ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼ IAMãƒ¦ãƒ¼ã‚¶ã€IAMã‚°ãƒ«ãƒ¼ãƒ—ã€IAMãƒ­ãƒ¼ãƒ«ã€ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ãŸã‚ã®ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ å˜ä¸€ã®AWSãƒªã‚½ãƒ¼ã‚¹ã«ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒãƒªã‚·ãƒ¼ jsonå½¢å¼ã§å®šç¾©ã™ã‚‹å¿…è¦ãŒç„¡ã„ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ ï¼Šä¾‹ï¼Š ä»¥ä¸‹ã«ã€EC2ã®èª­ã¿å‡ºã—ã®ã¿æ¨©é™ï¼ˆAmazonEC2ReadOnlyAccessï¼‰ã‚’ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ãƒãƒªã‚·ãƒ¼ã‚’ç¤ºã™ã€‚ã“ã®IAMãƒãƒªã‚·ãƒ¼ã«ã¯ã€ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹æ¨©é™ã‚‚å«ã¾ã‚Œã¦ã„ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": \"ec2:Describe*\", \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": \"elasticloadbalancing:Describe*\", \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": [ \"cloudwatch:ListMetrics\", \"cloudwatch:GetMetricStatistics\", \"cloudwatch:Describe*\" ], \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": \"autoscaling:Describe*\", \"Resource\": \"*\" } ] } ãƒ»IAMã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã¨ã¯ AWSãƒªã‚½ãƒ¼ã‚¹ã«é–¢ã™ã‚‹èªå¯ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å®šç¾©ã™ã‚‹ã€‚å„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ AWSãƒªã‚½ãƒ¼ã‚¹ã®ç¨®é¡ ãƒªãƒ³ã‚¯ CloudWatchãƒ­ã‚° https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/logs/permissions-reference-cwl.html ï¼Šä¾‹ï¼Š ä»¥ä¸‹ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸãƒ­ãƒ¼ãƒ«ã‚’æŒã¤AWSãƒªã‚½ãƒ¼ã‚¹ã¯ã€ä»»æ„ã®SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"ssm:GetParameters\" ], \"Resource\": \"*\" } ] } Statementã®é …ç›® èª¬æ˜ Sid ä»»æ„ã®ä¸€æ„ãªæ–‡å­—åˆ—ã‚’è¨­å®šã™ã‚‹ã€‚ç©ºæ–‡å­—ã§ã‚‚ã‚ˆã„ã€‚ Effect è¨±å¯ï¼æ‹’å¦ã‚’è¨­å®šã™ã‚‹ã€‚ Action ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦å®Ÿè¡Œã§ãã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ Resource ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œå¯¾è±¡ã«é¸ã¹ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ä»¥ä¸‹ã«ä¸»è¦ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¤ºã™ã€‚ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å èª¬æ˜ Create ãƒªã‚½ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ Describe ãƒªã‚½ãƒ¼ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ Delete ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã€‚ Get ãƒªã‚½ãƒ¼ã‚¹ã‚’å–å¾—ã™ã‚‹ã€‚ Put ãƒªã‚½ãƒ¼ã‚¹ã‚’ä¸Šæ›¸ãã™ã‚‹ã€‚ ãƒ»ARNã¨ã¯ï¼šAmazon Resource Namespace AWSãƒªã‚½ãƒ¼ã‚¹ã®è­˜åˆ¥å­ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/general/latest/gr/aws-arns-and-namespaces.html { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Resource\": \"arn:::::\" } ] } IAMãƒ­ãƒ¼ãƒ« ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ« AWSãƒªã‚½ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã—ãŸæ™‚ã«è‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã‚‹ãƒ­ãƒ¼ãƒ«ã€‚ä»–ã«ã¯ã‚¢ã‚¿ãƒƒãƒã§ããªã„å°‚ç”¨ã®ãƒãƒªã‚·ãƒ¼ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã‚‹ã€‚ã€AWSServiceRoleFor*****ã€ã¨ã„ã†åå‰ã§è‡ªå‹•çš„ã«æ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ç‰¹ã«è¨­å®šã›ãšã¨ã‚‚ã€è‡ªå‹•çš„ã«ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€‚é–¢é€£ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã¾ã§ã€ãƒ­ãƒ¼ãƒ«è‡ªä½“ã§ããªã„ã€‚ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ«ã®ä¸€è¦§ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html ãƒ»ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ãƒ¼ãƒ« ãƒ»ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ãƒ¼ãƒ« ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼ ãƒ»ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼ã¨ã¯ IAMãƒ¦ãƒ¼ã‚¶ã€IAMã‚°ãƒ«ãƒ¼ãƒ—ã€IAMãƒ­ãƒ¼ãƒ«ã€ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ãŸã‚ã®ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ ãƒ»AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ AWSãŒæä¾›ã—ã¦ã„ã‚‹ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ã‚¢ã‚¿ãƒƒãƒå¼ã®ãƒãƒªã‚·ãƒ¼ã®ãŸã‚ã€ã™ã§ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã¦ã‚‚ã€ä»–ã®ã‚‚ã®ã«ã‚‚ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã€‚ ãƒ»ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ ãƒ¦ãƒ¼ã‚¶ãŒç‹¬è‡ªã«æ§‹ç¯‰ã—ãŸãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ã™ã§ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã¦ã‚‚ã€ä»–ã®ã‚‚ã®ã«ã‚‚ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã€‚ ãƒ»ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ å˜ä¸€ã®ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ãŸã‚ã®ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚çµ„ã¿è¾¼ã¿å¼ã®ãƒãƒªã‚·ãƒ¼ã®ãŸã‚ã€ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–“ã§å…±æœ‰ã—ã¦ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š IAMãƒ­ãƒ¼ãƒ«ã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ã“ã®ãƒ­ãƒ¼ãƒ«ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã™ã¹ã¦ã® ACM è¨¼æ˜æ›¸ã‚’ä¸€è¦§è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ { \"Version\":\"2012-10-17\", \"Statement\":[ { \"Effect\":\"Allow\", \"Action\":\"acm:ListCertificates\", \"Resource\":\"*\" } ] } ï¼Šå®Ÿè£…ä¾‹ï¼Š IAMãƒ­ãƒ¼ãƒ«ã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ã“ã®ãƒ­ãƒ¼ãƒ«ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ã¯ã€å…¨ã¦ã®AWSãƒªã‚½ãƒ¼ã‚¹ã«ã€ä»»æ„ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ { \"Version\":\"2012-10-17\", \"Statement\":[ { \"Effect\":\"Allow\", \"Action\":\"*\", \"Resource\":\"*\" } ] } ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ ãƒ»ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã¨ã¯ å˜ä¸€ã®AWSãƒªã‚½ãƒ¼ã‚¹ã«ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ã™ã§ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã‚‹ã¨ã€ä»–ã®ã‚‚ã®ã«ã¯ã‚¢ã‚¿ãƒƒãƒã§ããªã„ã€‚ ãƒ»ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ S3ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€è‡ªèº«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ ãƒ»ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ ECRã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æœ‰åŠ¹æœŸé–“ã‚’å®šç¾©ã™ã‚‹ãƒãƒªã‚·ãƒ¼ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‹ã‚‰å…¥åŠ›ã§ãã‚‹ãŸã‚ã€åŸºæœ¬çš„ã«ãƒãƒªã‚·ãƒ¼ã®å®Ÿè£…ã¯ä¸è¦ã§ã‚ã‚‹ãŒã€Terraformãªã©ã®IaCãƒ„ãƒ¼ãƒ«ã§ã¯å¿…è¦ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"rules\": [ { \"rulePriority\": 1, \"description\": \"Keep last 10 images untagged\", \"selection\": { \"tagStatus\": \"untagged\", \"countType\": \"imageCountMoreThan\", \"countNumber\": 10 }, \"action\": { \"type\": \"expire\" } }, { \"rulePriority\": 2, \"description\": \"Keep last 10 images any\", \"selection\": { \"tagStatus\": \"any\", \"countType\": \"imageCountMoreThan\", \"countNumber\": 10 }, \"action\": { \"type\": \"expire\" } } ] } ãƒ»ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ ãƒ­ãƒ¼ãƒ«ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€Assume Roleã‚’è¡Œã†ãŸã‚ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’ä»»æ„ã®ãƒ­ãƒ¼ãƒ«ã«ã‚¢ã‚¿ãƒƒãƒã—ãŸã¨ã™ã‚‹ã€‚ãã®å ´åˆã€Principalã®ecs-tasksãŒä¿¡é ¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨è¦‹ãªã•ã‚Œã€ãƒ­ãƒ¼ãƒ«ã‚’ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"Service\": \"ecs-tasks.amazonaws.com\" }, \"Action\": \"sts:AssumeRole\" } ] } ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã§ã¯ã€IAMãƒ¦ãƒ¼ã‚¶ã‚’ä¿¡é ¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã—ã¦è¨­å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’ä»»æ„ã®ãƒ­ãƒ¼ãƒ«ã«ã‚¢ã‚¿ãƒƒãƒã—ãŸã¨ã™ã‚‹ã€‚ãã®å ´åˆã€Principalã®IAMãƒ¦ãƒ¼ã‚¶ãŒä¿¡é ¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨è¦‹ãªã•ã‚Œã€ãƒ­ãƒ¼ãƒ«ã‚’ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"arn:aws:iam:::user/\" }, \"Action\": \"sts:AssumeRole\", \"Condition\": { \"StringEquals\": { \"sts:ExternalId\": \"\" } } } ] } IAMãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹å¯¾è±¡ ãƒ»IAMãƒ¦ãƒ¼ã‚¶ã«å¯¾ã™ã‚‹ã‚¢ã‚¿ãƒƒãƒ ãƒ»IAMã‚°ãƒ«ãƒ¼ãƒ—ã«å¯¾ã™ã‚‹ã‚¢ã‚¿ãƒƒãƒ ãƒ»IAMãƒ­ãƒ¼ãƒ«ã«å¯¾ã™ã‚‹ã‚¢ã‚¿ãƒƒãƒ ãƒ«ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶ã€IAMãƒ¦ãƒ¼ã‚¶ ãƒ»ãƒ«ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶ã¨ã¯ å…¨ã¦ã®æ¨©é™ã‚’ã‚‚ã£ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã“ã¨ã€‚ ãƒ»IAMãƒ¦ãƒ¼ã‚¶ã¨ã¯ ç‰¹å®šã®æ¨©é™ã‚’ã‚‚ã£ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã“ã¨ã€‚ ãƒ»credentialsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨ã„ãŸCLI AWS CLIã§ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ“ä½œã™ã‚‹ãŸã‚ã«ã¯ã€credentialsãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã•ã‚ŒãŸã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«æƒ…å ±ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã€aws_regionã€ã§ã¯ãªãã€aws_default_regionã€ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ $ aws configure set aws_access_key_id \"\" $ aws configure set aws_secret_access_key \"\" $ aws configure set aws_default_region \"ãƒªãƒ¼ã‚¸ãƒ§ãƒ³>\" # Linuxã€Unixã®å ´åˆï¼š$HOME/.aws/ # Windowsã®å ´åˆï¼š%USERPROFILE%\\.aws\\ [default] aws_access_key_id= aws_secret_access_key= [user1] aws_access_key_id= aws_secret_access_key= ãƒ»ç’°å¢ƒå¤‰æ•°ã‚’ç”¨ã„ãŸCLI AWS CLIã§ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ“ä½œã™ã‚‹ãŸã‚ã«ã¯ã€ç’°å¢ƒå¤‰æ•°ã§å®šç¾©ã•ã‚ŒãŸã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«æƒ…å ±ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã€AWS_REGIONã€ã§ã¯ãªãã€AWS_DEFAULT_REGIONã€ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ $ export AWS_ACCESS_KEY_ID= $ export AWS_SECRET_ACCESS_KEY= $ export AWS_DEFAULT_REGION= IAMã‚°ãƒ«ãƒ¼ãƒ— ãƒ»IAMã‚°ãƒ«ãƒ¼ãƒ—ã¨ã¯ IAMãƒ¦ãƒ¼ã‚¶ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãŸã‚‚ã®ã€‚IAMã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«IAMãƒ­ãƒ¼ãƒ«ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚Œã°ã€IAMãƒ¦ãƒ¼ã‚¶ã®IAMãƒ­ãƒ¼ãƒ«ã‚’ç®¡ç†ã—ã‚„ã™ããªã‚‹ã€‚ ãƒ»IAMã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®IAMãƒ­ãƒ¼ãƒ«ã®ç´ä»˜ã‘ IAMã‚°ãƒ«ãƒ¼ãƒ—ã«å¯¾ã—ã¦ã€IAMãƒ­ãƒ¼ãƒ«ã‚’ç´ä»˜ã‘ã‚‹ã€‚ãã®IAMã‚°ãƒ«ãƒ¼ãƒ—ã«å¯¾ã—ã¦ã€IAMãƒ­ãƒ¼ãƒ«ã‚’ã‚¢ã‚¿ãƒƒãƒã—ãŸã„IAMãƒ¦ãƒ¼ã‚¶ã‚’è¿½åŠ ã—ã¦ã„ãã€‚ ãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§ ç¨®é¡ èª¬æ˜ è£œè¶³ Administrator å…¨ã¦ã®æ“ä½œã«æ¨©é™ãŒã‚ã‚‹ã€‚ PowerUserAccess IAMä»¥å¤–ã®æ“ä½œæ¨©é™ãŒã‚ã‚‹ã€‚ ViewOnlyAccess é–²è¦§ã®ã¿ã®æ“ä½œæ¨©é™ãŒã‚ã‚‹ã€‚ CLI ãƒ»CLIã®ç¤¾å†…ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™ ç‰¹å®šã®é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åˆ¶é™ã™ã‚‹ãƒãƒªã‚·ãƒ¼ã‚’IAMãƒ¦ãƒ¼ã‚¶ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã“ã¨ã§ã€ãã®IAMãƒ¦ãƒ¼ã‚¶ãŒAWS CLIã®å®Ÿè¡Œã™ã‚‹æ™‚ã«ã€ç¤¾å¤–ã‹ã‚‰å®Ÿè¡Œã§ããªã„ã‚ˆã†ã«åˆ¶é™ã‚’ã‹ã‘ã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"Version\": \"2012-10-17\", \"Statement\": { \"Effect\": \"Deny\", \"Action\": \"*\", \"Resource\": \"*\", \"Condition\": { \"NotIpAddress\": { \"aws:SourceIp\": [ \"nn.nnn.nnn.nnn/32\" ] } } } } ãƒãƒªã‚·ãƒ¼ã®Denyã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã«ã‚ˆã£ã¦ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚ŒãŸå ´åˆã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æœ€å¾Œã«ã€with an explicit denyã€ã¨ã„ã†æ–‡è¨€ãŒã¤ãã€‚ ï¼Šä¾‹ï¼Š Error: An error occurred (AccessDeniedException) when calling the operation: is not authorized to perform: on resource: with an explicit deny ãƒ»ãƒ¦ãƒ¼ã‚¶åã‚’å¤‰æ›´ ãƒ¦ãƒ¼ã‚¶åã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‹ã‚‰å¤‰æ›´ã§ããšã€ã‚³ãƒãƒ³ãƒ‰ã§å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ $ aws iam update-user \\ --user-name \\ --new-user-name 20. Kinesis Data Streams Kinesis Data Streamsã¨ã¯ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ï¼ˆå‹•ç”»ãƒ‡ãƒ¼ã‚¿ã€éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã€ãªã©ï¼‰ã‚’ç¶™ç¶šçš„ã«åé›†ã—ã€ä¿ç®¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/streams/latest/dev/amazon-kinesis-streams.html 20-02. Kinesis Data Firehoseï¼ˆKinesis Delivery Streamï¼‰ Kinesis Data Firehoseã¨ã¯ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ï¼ˆå‹•ç”»ãƒ‡ãƒ¼ã‚¿ã€éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã€ãªã©ï¼‰ã‚’ç¶™ç¶šçš„ã«åé›†ã—ã€ä¿ç®¡ï¼å¯è¦–åŒ–ï¼åˆ†æï¼ãƒ¬ãƒãƒ¼ãƒˆä½œæˆï¼ã‚¢ãƒ©ãƒ¼ãƒˆãŒå¯èƒ½ãªå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‚„AWSãƒªã‚½ãƒ¼ã‚¹ã«è»¢é€ã™ã‚‹ã€‚è»¢é€æ™‚ã«Lambdaé–¢æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€åé›†ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’åŠ å·¥ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/firehose/latest/dev/what-is-this-service.html è¨­å®šé …ç›® é …ç›® èª¬æ˜ ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å¤‰æ› ãƒãƒƒãƒ•ã‚¡ãƒ¼ã«è“„ãˆã‚‰ã‚ŒãŸãƒ­ã‚°ãƒ†ã‚­ã‚¹ãƒˆã‚’ã€æŒ‡å®šã•ã‚ŒãŸå½¢å¼ã§è»¢é€ã™ã‚‹å‰ã«ã€ãƒ†ã‚­ã‚¹ãƒˆã®å†…å®¹ã‚’å¤‰æ›ã™ã‚‹ã€‚Lambdaã‚’ç”¨ã„ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/firehose/latest/dev/data-transformation.html è»¢é€å…ˆ è»¢é€å…ˆã¨ã™ã‚‹S3ãƒã‚±ãƒƒãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå S3ã¸ã®è»¢é€æ™‚ã«ã€S3ã«ä½œæˆã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®åå‰ã‚’è¨­å®šã§ãã‚‹ã€‚æ¨™æº–ã§YYYY/MM/dd/HHå½¢å¼ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã€2021/11/09ç¾åœ¨ã¯UTCã®ã¿è¨­å®šã§ãã‚‹ã€‚ã‚‚ã—JSTã«ã—ãŸã„å ´åˆã¯Lambdaã«å¤‰æ›å‡¦ç†ã‚’å®Ÿè£…ã—ã€Kinesis Data Firehoseã¨é€£æºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å‚è€ƒï¼šhttps://qiita.com/qiita-kurara/items/b697b65772cb0905c0f2#comment-ac3a2eb2f6d30a917549 ãƒãƒƒãƒ•ã‚¡ãƒ¼ Kinesis Data Firehoseã§ã¯ã€å—ä¿¡ã—ãŸãƒ­ã‚°ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¸€æ—¦ãƒãƒƒãƒ•ã‚¡ãƒ¼ã«è“„ãˆã€ä¸€å®šæœŸé–“ã‚ã‚‹ã„ã¯ä¸€å®šå®¹é‡ãŒè“„ãˆã‚‰ã‚ŒãŸæ™‚ç‚¹ã§ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦è»¢é€ã™ã‚‹ã€‚ã“ã®æ™‚ã€ãƒãƒƒãƒ•ã‚¡ãƒ¼ã«è“„ãˆã‚‹æœŸé–“ã‚„ä¸Šé™é‡ã‚’è¨­å®šã§ãã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/firehose/latest/dev/basic-deliver.html#frequency ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ è»¢é€æ™‚ã®ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã‚’è¨­å®šã§ãã‚‹ã€‚ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€çµ‚åˆ°é”åœ°ç‚¹ãŒS3ã®å ´åˆã¯åœ§ç¸®å½¢å¼ã§å•é¡Œãªã„ãŒã€S3ã‹ã‚‰ã•ã‚‰ã«ä»–ã®ãƒ„ãƒ¼ãƒ«ï¼ˆä¾‹ï¼šDatadogï¼‰ã«è»¢é€ã™ã‚‹å ´åˆã¯ãƒ‡ãƒ¼ã‚¿å½¢å¼ã‚’è¨­å®šã—ãªã„æ–¹ãŒè‰¯ã„ã€‚ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— åé›†ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’åŠ å·¥ã™ã‚‹å ´åˆã€åŠ å·¥å‰ãƒ‡ãƒ¼ã‚¿ã‚’ä¿ç®¡ã—ã¦ãŠãã€‚ æš—å·åŒ– ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®åé›† ãƒ‡ãƒ¼ã‚¿ã®è»¢é€æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’CloudWatchãƒ­ã‚°ã«é€ä¿¡ã™ã‚‹ã€‚ IAMãƒ­ãƒ¼ãƒ« Kinesis Data FirehoseãŒAWSãƒªã‚½ãƒ¼ã‚¹ã«ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã§ãã‚‹ã‚ˆã†ã«ã€æ¨©é™ã‚’è¨­å®šã™ã‚‹ã€‚ 20-03. Kinesis Data Analytics Kinesis Data Analyticsã¨ã¯ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ï¼ˆå‹•ç”»ãƒ‡ãƒ¼ã‚¿ã€éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã€ãªã©ï¼‰ã‚’ç¶™ç¶šçš„ã«åé›†ã—ã€åˆ†æã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/kinesisanalytics/latest/dev/what-is.html 21. Lambda Lambdaã¨ã¯ ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚ˆã£ã¦é§†å‹•ã™ã‚‹é–¢æ•°ã‚’ç®¡ç†ã§ãã‚‹ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šå‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/applications-usecases.html è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒ©ãƒ³ã‚¿ã‚¤ãƒ  é–¢æ•°ã®å®Ÿè£…ã«ç”¨ã„ã‚‹è¨€èªã‚’è¨­å®šã™ã‚‹ã€‚ ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®é–¢æ•°ã§ã¯ä½¿ç”¨ã§ããªã„ã€‚ ãƒãƒ³ãƒ‰ãƒ© é–¢æ•°ã®å®Ÿè¡Œæ™‚ã«ã‚³ãƒ¼ãƒ«ã—ãŸã„å…·ä½“çš„ãƒ¡ã‚½ãƒƒãƒ‰åã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®é–¢æ•°ã§ã¯ä½¿ç”¨ã§ããªã„ã€‚ãƒ»Node.jsï¼šindex.js ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§ exports.handler ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ãŸã„å ´åˆã€ãƒãƒ³ãƒ‰ãƒ©åã‚’index.handlerã¨ã™ã‚‹ ãƒ¬ã‚¤ãƒ¤ãƒ¼ ç•°ãªã‚‹é–¢æ•°ã®é–“ã§ã€ç‰¹å®šã®å‡¦ç†ã‚’å…±é€šåŒ–ã§ãã‚‹ã€‚ ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®é–¢æ•°ã§ã¯ä½¿ç”¨ã§ããªã„ã€‚ ãƒ¡ãƒ¢ãƒª Lambdaã«å‰²ã‚Šå½“ã¦ã‚‹ãƒ¡ãƒ¢ãƒªé‡ã‚’è¨­å®šã™ã‚‹ã€‚ æœ€å¤§10240MBã¾ã§å¢—è¨­ã§ãã€å¢—è¨­ã™ã‚‹ã»ã©ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä¸ŠãŒã‚‹ã€‚å‚è€ƒï¼šhttps://www.business-on-it.com/2003-aws-lambda-performance-check/ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ å®Ÿè¡Œãƒ­ãƒ¼ãƒ« Lambdaå†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹æ™‚ã«å¿…è¦ãªãƒãƒªã‚·ãƒ¼ã‚’æŒã¤ãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ æ—¢å­˜ãƒ­ãƒ¼ãƒ« Lambdaã«ãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒˆãƒªã‚¬ãƒ¼ Lambdaã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ è¨­å®šã•ã‚ŒãŸAWSãƒªã‚½ãƒ¼ã‚¹ã«å¿œã˜ã¦ã€Lambdaã®ãƒãƒªã‚·ãƒ¼ãŒè‡ªå‹•çš„ã«ä¿®æ­£ã•ã‚Œã‚‹ã€‚ ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ Lambdaã®ãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒˆãƒªã‚¬ãƒ¼ã®è¨­å®šã«å¿œã˜ã¦ã€Lambdaã®ãƒãƒªã‚·ãƒ¼ãŒè‡ªå‹•çš„ã«ä¿®æ­£ã•ã‚Œã‚‹ã€‚ é€ä¿¡å…ˆ Lambdaã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ é€ä¿¡å…ˆã®AWSãƒªã‚½ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼ã¯è‡ªå‹•çš„ã«ä¿®æ­£ã•ã‚Œãªã„ãŸã‚ã€åˆ¥é€”ã€æ‰‹å‹•ã§ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ç’°å¢ƒå¤‰æ•° Lambdaã®é–¢æ•°å†…ã«å‡ºåŠ›ã™ã‚‹ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ æ¨™æº–ã§ã¯ã€ç’°å¢ƒå¤‰æ•°ã¯AWSãƒãƒãƒ¼ã‚¸ãƒ‰å‹KMSã‚­ãƒ¼ã«ã‚ˆã£ã¦æš—å·åŒ–ã•ã‚Œã‚‹ã€‚ åŒæ™‚å®Ÿè¡Œæ•° åŒæ™‚å®Ÿè¡Œã®äºˆç´„ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸåŒæ™‚å®Ÿè¡Œè¨­å®š ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚° Lambdaã‚’CloudWatchã¾ãŸã¯X-Rayã‚’ç”¨ã„ã¦ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ æ¬¡ã®æ–¹æ³•ãŒã‚ã‚‹ãƒ»CloudWatchã«ã‚ˆã£ã¦ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ãƒ»CloudWatchã®Lambda Insightsã«ã‚ˆã£ã¦ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ãƒ»X-Rayã«ã‚ˆã£ã¦ã€APIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€Lambdaã‚³ãƒ¼ãƒ«ã€Lambdaã®ä¸‹æµã¨ã®ãƒ‡ãƒ¼ã‚¿é€šä¿¡ã‚’ãƒˆãƒ¬ãƒ¼ã‚¹ã—ã€ã“ã‚Œã‚‰ã‚’ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹åŒ–ã™ã‚‹ã€‚ ãƒ»è¨­å®šã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/best-practices.html#function-configuration Lambdaã¨é–¢æ•°ã®é–¢ä¿‚æ€§ ãƒ»Lambdaã‚µãƒ¼ãƒ“ã‚¹ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã®Lamdaã«ç›¸å½“ã™ã‚‹ã€‚ ãƒ»é–¢æ•°ã®å®Ÿè¡Œç’°å¢ƒ Lambdaã®å®Ÿè¡Œç’°å¢ƒã¯ã€APIï¼ˆãƒ©ãƒ³ã‚¿ã‚¤ãƒ APIã€ãƒ­ã‚°APIã€æ‹¡å¼µAPIï¼‰ã¨å®Ÿè¡Œç’°å¢ƒã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã€‚é–¢æ•°ã¯å®Ÿè¡Œç’°å¢ƒã«å­˜åœ¨ã—ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ APIã‚’ä»‹ã—ã¦ã€Lambdaã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/runtimes-extensions-api.html#runtimes-extensions-api-lifecycle å®Ÿè¡Œç’°å¢ƒã«ã¯ã€ï¼“ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/runtimes-context.html#runtimes-lifecycle ãƒ»Initãƒ•ã‚§ãƒ¼ã‚º LambdaãŒç™ºç«ã™ã‚‹ã€‚å®Ÿè¡Œç’°å¢ƒãŒæ§‹ç¯‰ã•ã‚Œã€é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®æº–å‚™ãŒè¡Œã‚ã‚Œã‚‹ã€‚ ãƒ»Invokeãƒ•ã‚§ãƒ¼ã‚º Lambdaã¯é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚å®Ÿè¡Œç’°å¢ƒå´ã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¯ã€APIã‚’ä»‹ã—ã¦Lambdaã‹ã‚‰é–¢æ•°ã«å¼•æ•°ã‚’æ¸¡ã™ã€‚ã¾ãŸé–¢æ•°ã®å®Ÿè¡Œå¾Œã«ã€APIã‚’ä»‹ã—ã¦è¿”å´å€¤ã‚’Lambdaã«æ¸¡ã™ã€‚ ãƒ»Shutdownãƒ•ã‚§ãƒ¼ã‚º ä¸€å®šæœŸé–“ã€Invokeãƒ•ã‚§ãƒ¼ã‚ºã«ãŠã‘ã‚‹é–¢æ•°å®Ÿè¡ŒãŒè¡Œã‚ã‚Œãªã‹ã£ãŸå ´åˆã€Lambdaã¯ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’çµ‚äº†ã—ã€å®Ÿè¡Œç’°å¢ƒã‚’å‰Šé™¤ã™ã‚‹ã€‚ Lambdaé–¢æ•° on Docker ãƒ»ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æº–å‚™ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/runtimes-images.html#runtimes-images-lp ãƒ»RICï¼šRuntime Interface Clients é€šå¸¸ã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¯ã‚³ãƒ³ãƒ†ãƒŠå†…é–¢æ•°ã¨é€šä¿¡ã§ããªã„ãŸã‚ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ä»£ã‚ã‚Šã«RICã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒ†ãƒŠå†…é–¢æ•°ã¨é€šä¿¡ã‚’è¡Œã†ã€‚è¨€èªåˆ¥ã«RICãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/runtimes-images.html#runtimes-api-client ãƒ»RIEï¼šRuntime Interface Emulator é–‹ç™ºç’°å¢ƒã®ã‚³ãƒ³ãƒ†ãƒŠã§ã€æ“¬ä¼¼çš„ã«Lambdaé–¢æ•°ã‚’å†ç¾ã™ã‚‹ã€‚å…¨ã¦ã®è¨€èªã§å…±é€šã®RIEãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws/aws-lambda-runtime-interface-emulator RIEã§ã‚ã£ã¦ã‚‚ã€ç¨¼åƒã•ã›ã‚‹ãŸã‚ã«AWSã®ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«æƒ…å ±ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰ãŒå¿…è¦ãªãŸã‚ã€ç’°å¢ƒå¤‰æ•°ã‚„credentialsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨ã„ã¦ã€Lambdaã«ã“ã‚Œã‚‰ã®å€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/images-test.html#images-test-env ï¼Šå‚è€ƒï¼Š $ docker run --rm \\ # ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‚’ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ã€‚ -v ~/.aws-lambda-rie:/aws-lambda \\ -p 9000:8080 \\ # ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚ --entrypoint /aws-lambda/aws-lambda-rie \\ : /go/bin/cmd # ãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•°ã®å¼•æ•°ã«åˆã£ãŸJSONãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã€‚ $ curl \\ -XPOST \"http://localhost:9000/2015-03-31/functions/function/invocations\" \\ -d '{}' ï¼Šå‚è€ƒï¼Š version: \"3.7\" services: lambda: build: context: . dockerfile: ./build/Dockerfile container_name: lambda # ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚ entrypoint: /aws-lambda/aws-lambda-rie env_file: - .docker.env image: : ports: - 9000:8080 # ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‚’ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ã€‚ volumes: - ~/.aws-lambda-rie:/aws-lambda $ docker-compose up lambda $ curl \\ -XPOST \"http://localhost:9000/2015-03-31/functions/function/invocations\" \\ -d '{}' Lambdaé–¢æ•° ãƒ»Goã®ä½¿ç”¨ä¾‹ ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/lambda-golang.html https://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws_lambda_function.html ãƒ»Node.jsã®ä½¿ç”¨ä¾‹ ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/lambda-nodejs.html https://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws_lambda_function.html åŒæ™‚å®Ÿè¡Œ ãƒ»åŒæ™‚å®Ÿè¡Œã®äºˆç´„ Lambdaã¯ã€é–¢æ•°ã®å®Ÿè¡Œä¸­ã«å†ã³ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã‚‹ã¨ã€é–¢æ•°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ–°ã—ãä½œæˆã™ã‚‹ã€‚ãã—ã¦ã€å„é–¢æ•°ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”¨ã„ã¦ã€åŒæ™‚ä¸¦è¡Œçš„ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¿œã˜ã‚‹ã€‚æ¨™æº–ã§ã¯ã€é–¢æ•°ã®ç¨®é¡ãŒã„ãã¤ã‚ã£ã¦ã‚‚ã€AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆå½“ãŸã‚Šã€åˆè¨ˆã§1000å€‹ã¾ã§ã—ã‹ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã—ã¦åŒæ™‚å®Ÿè¡Œã§ããªã„ã€‚é–¢æ•°ã”ã¨ã«åŒæ™‚å®Ÿè¡Œæ•°ã®ä½¿ç”¨æ ã‚’å‰²ã‚Šå½“ã¦ã‚‹ãŸã‚ã«ã¯ã€åŒæ™‚å®Ÿè¡Œã®äºˆç´„ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚åŒæ™‚å®Ÿè¡Œã®äºˆç´„æ•°ã‚’0å€‹ã¨ã—ãŸå ´åˆã€LambdãŒã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã—ãªããªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/configuration-concurrency.html#configuration-concurrency-reserved VPCå¤–ï¼VPCå†… ãƒ»VPCå¤–ã¸ã®é…ç½® Lambdaã¯æ¨™æº–ã§ã¯VPCå¤–ã«é…ç½®ã•ã‚Œã‚‹ã€‚ã“ã®å ´åˆã€Lambdaã«ENIãŒã‚¢ã‚¿ãƒƒãƒã•ã‚Œã€ENIã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒLambdaã«é©ç”¨ã•ã‚Œã‚‹ã€‚Lambdaã®å®Ÿè¡Œæ™‚ã«ENIã¯å†ä½œæˆã•ã‚Œã‚‹ãŸã‚ã€å®Ÿè¡Œã”ã¨ã«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å¤‰åŒ–ã™ã‚‹ãŒã€ä¸€å®šæ™‚é–“å†…ã®å†å®Ÿè¡Œã§ã‚ã‚Œã°ENIã¯å†åˆ©ç”¨ã•ã‚Œã‚‹ãŸã‚ã€å‰å›ã®å®Ÿè¡Œæ™‚ã¨åŒã˜IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãªã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ ãƒ»VPCå†…ã¸ã®é…ç½® Lambdaã‚’VPCå†…ã«é…ç½®ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚VPCå†…ã«é…ç½®ã—ãŸLambdaã«ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œãªã„ãŸã‚ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªé€šä¿¡ã‚’è¡Œã†ãŸã‚ã«ã¯ã€NAT Gatewayã‚’è¨­ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒãƒªã‚·ãƒ¼ ãƒ»å®Ÿè¡Œã®ãŸã‚ã®æœ€ä½é™ã®ãƒãƒªã‚·ãƒ¼ Lambdaã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸé–¢æ•°ã‚’ç”¨ã„ã‚‹æ¨©é™ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ãã®ãŸã‚ã€é–¢æ•°ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": \"lambda:InvokeFunction\", \"Resource\": \"arn:aws:lambda:::function:*\" } ] } ãƒ‡ãƒ—ãƒ­ã‚¤ ãƒ»ç›´æ¥ä¿®æ­£ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã‚ãšã«ã€é–¢æ•°ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç›´æ¥ä¿®æ­£ã—ã€ã€Deployã€ãƒœã‚¿ãƒ³ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚ ãƒ»S3ã«ãŠã‘ã‚‹zipãƒ•ã‚¡ã‚¤ãƒ« ãƒ“ãƒ«ãƒ‰å¾Œã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’zipãƒ•ã‚¡ã‚¤ãƒ«ã«ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚ãƒ­ãƒ¼ã‚«ãƒ«PCã¾ãŸã¯S3ã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/gettingstarted-package.html#gettingstarted-package-zip ãƒ»ECRã«ãŠã‘ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®é–¢æ•°ã§ã®ã¿æœ‰åŠ¹ã§ã‚ã‚‹ã€‚ãƒ“ãƒ«ãƒ‰å¾Œã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚ECRã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/gettingstarted-package.html#gettingstarted-package-images 21-02. Lambda@Edge Lambda@Edgeã¨ã¯ CloudFrontã«çµ±åˆã•ã‚ŒãŸLambdaã‚’ã€ç‰¹åˆ¥ã«Lambda@Edgeã¨ã„ã†ã€‚ è¨­å®šé …ç›® ãƒ»ãƒˆãƒªã‚¬ãƒ¼ã®ç¨®é¡ CloudFrontã®ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ã‚ªãƒªã‚¸ãƒ³ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€ã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã™ã‚‹ã€‚ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®CloudFrontã«ã€Lambdaã®ãƒ¬ãƒ—ãƒªã‚«ãŒæ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ ãƒˆãƒªã‚¬ãƒ¼ã®ç¨®é¡ ç™ºç«ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚° ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ CloudFrontãŒã€ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã—ãŸå¾Œï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç¢ºèªã™ã‚‹å‰ï¼‰ã€‚ ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆ CloudFrontãŒã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚ªãƒªã‚¸ãƒ³ã‚µãƒ¼ãƒãƒ¼ã«è»¢é€ã™ã‚‹å‰ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç¢ºèªã—ãŸå¾Œï¼‰ã€‚ ã‚ªãƒªã‚¸ãƒ³ãƒ¬ã‚¹ãƒãƒ³ã‚¹ CloudFrontãŒã€ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ä¿¡ã—ãŸå¾Œï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç¢ºèªã™ã‚‹å‰ï¼‰ã€‚ ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ CloudFrontãŒã€ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è»¢é€ã™ã‚‹å‰ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç¢ºèªã—ãŸå¾Œï¼‰ã€‚ ãƒ»å„ãƒˆãƒªã‚¬ãƒ¼ã®eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚° å„ãƒˆãƒªã‚¬ãƒ¼ã®eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã¯ã€ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/lambda-event-structure.html ãƒãƒªã‚·ãƒ¼ ãƒ»å®Ÿè¡Œã®ãŸã‚ã®æœ€ä½é™ã®ãƒãƒªã‚·ãƒ¼ Lambda@Edgeã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€æœ€ä½é™ã€ä»¥ä¸‹ã®æ¨©é™ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"iam:CreateServiceLinkedRole\" ], \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": [ \"lambda:GetFunction\", \"lambda:EnableReplication*\" ], \"Resource\": \"arn:aws:lambda:::function::\" }, { \"Effect\": \"Allow\", \"Action\": [ \"cloudfront:UpdateDistribution\" ], \"Resource\": \"arn:aws:cloudfront:::distribution/\" } ] } Node.jsã‚’ç”¨ã„ãŸé–¢æ•°ä¾‹ ãƒ»ã‚ªãƒªã‚¸ãƒ³ã®å‹•çš„ãªåˆ‡ã‚Šæ›¿ãˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®domainNameã¨host.valueã«ä»£å…¥ã•ã‚ŒãŸãƒã‚±ãƒƒãƒˆã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã«ã‚ˆã£ã¦ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã®ãƒã‚±ãƒƒãƒˆãŒæ±ºã¾ã‚‹ã€‚ãã®ãŸã‚ã€ã“ã®å€¤ã‚’åˆ‡ã‚Šæ›¿ãˆã‚Œã°ã€å‹•çš„ã‚ªãƒªã‚¸ãƒ³ã‚’å®Ÿç¾ã§ãã‚‹ã€‚ãªãŠã€å„ãƒã‚±ãƒƒãƒˆã«ã¯åŒã˜OAIã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ \"use strict\"; exports.handler = (event, context, callback) => { const request = event.Records[0].cf.request; // ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å¤‰æ•°ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ console.log(JSON.stringify({request}, null, 2)); const headers = request.headers; const s3Backet = getBacketBasedOnDeviceType(headers); request.origin.s3.domainName = s3Backet request.headers.host[0].value = s3Backet // ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å¤‰æ•°ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ console.log(JSON.stringify({request}, null, 2)); return callback(null, request); }; /** * ãƒ‡ãƒã‚¤ã‚¹ã‚¿ã‚¤ãƒ—ã«åŸºã¥ã„ã¦ã€ã‚ªãƒªã‚¸ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚ * * @param {Object} headers * @param {string} env * @returns {string} pcBucket|spBucket */ const getBacketBasedOnDeviceType = (headers) => { const pcBucket = env + \"-bucket.s3.amazonaws.com\"; const spBucket = env + \"-bucket.s3.amazonaws.com\"; if (headers[\"cloudfront-is-desktop-viewer\"] && headers[\"cloudfront-is-desktop-viewer\"][0].value === \"true\") { return pcBucket; } if (headers[\"cloudfront-is-tablet-viewer\"] && headers[\"cloudfront-is-tablet-viewer\"][0].value === \"true\") { return pcBucket; } if (headers[\"cloudfront-is-mobile-viewer\"] && headers[\"cloudfront-is-mobile-viewer\"][0].value === \"true\") { return spBucket; } return spBucket; }; ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ä»¥ä¸‹ã®eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®JSONãƒ‡ãƒ¼ã‚¿ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã€‚ãªãŠã€ä¸€éƒ¨ã®ã‚­ãƒ¼ã¯çœç•¥ã—ã¦ã„ã‚‹ã€‚ { \"Records\": [ { \"cf\": { \"request\": { \"body\": { \"action\": \"read-only\", \"data\": \"\", \"encoding\": \"base64\", \"inputTruncated\": false }, \"clientIp\": \"nnn.n.nnn.nnn\", \"headers\": { \"host\": [ { \"key\": \"Host\", \"value\": \"prd-sp-bucket.s3.ap-northeast-1.amazonaws.com\" } ], \"cloudfront-is-mobile-viewer\": [ { \"key\": \"CloudFront-Is-Mobile-Viewer\", \"value\": true } ], \"cloudfront-is-tablet-viewer\": [ { \"key\": \"loudFront-Is-Tablet-Viewer\", \"value\": false } ], \"cloudfront-is-smarttv-viewer\": [ { \"key\": \"CloudFront-Is-SmartTV-Viewer\", \"value\": false } ], \"cloudfront-is-desktop-viewer\": [ { \"key\": \"CloudFront-Is-Desktop-Viewer\", \"value\": false } ], \"user-agent\": [ { \"key\": \"User-Agent\", \"value\": \"Amazon CloudFront\" } ] }, \"method\": \"GET\", \"origin\": { \"s3\": { \"authMethod\": \"origin-access-identity\", \"customHeaders\": { \"env\": [ { \"key\": \"env\", \"value\": \"prd\" } ] }, \"domainName\": \"prd-sp-bucket.s3.amazonaws.com\", \"path\": \"\", \"port\": 443, \"protocol\": \"https\", \"region\": \"ap-northeast-1\" } }, \"querystring\": \"\", \"uri\": \"/images/12345\" } } } ] } 22. RDSï¼šRelational Database Service DBã‚¨ãƒ³ã‚¸ãƒ³ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ã‚¨ãƒ³ã‚¸ãƒ³ã‚¿ã‚¤ãƒ— DBã‚¨ãƒ³ã‚¸ãƒ³ã®ç¨®é¡ã‚’è¨­å®šã™ã‚‹ã€‚ Auroraã‹éAuroraã‹ã§æ©Ÿèƒ½ã«å·®ãŒã‚ã‚Šã€Auroraã®æ–¹ãŒè€éšœå®³æ€§ã‚„å¯ç”¨æ€§ãŒé«˜ã„ã€‚ãŸã ã€ãã®åˆ†è²»ç”¨ãŒé«˜ã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚å‚è€ƒï¼šhttps://www.ragate.co.jp/blog/articles/10234 ã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§Auroraã‚’é¸ã‚“ã å ´åˆã®äº’æ›æ€§ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ DBã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å†…ã®å…¨ã¦ã®DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«é©ç”¨ã•ã‚Œã‚‹ã€‚ ãƒ»Auroraã§ã‚ã‚Œã°ã€SELECT AURORA_VERSION()ã‚’ç”¨ã„ã¦ã€ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã§ãã‚‹ã€‚ RDBã€DBMS ãƒ»DBMS RDSã§ã¯ã€DBMSã€RDBã‚’é¸ã¹ã‚‹ã€‚ DBMSã®ç¨®é¡ RDBã®ç¨®é¡ MySQLï¼PostgreSQL Amazon Aurora MariaDB MariaDBãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ MySQL MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ PostgreSQL PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ 22-02. RDSï¼ˆAuroraï¼‰ è¨­å®šé …ç›® ãƒ»DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼è­˜åˆ¥å­ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼åã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åã¯ã€æœ€åˆã«è¨­å®šã§ããšã€RDSã®æ§‹ç¯‰å¾Œã«è¨­å®šã§ãã‚‹ã€‚ VPCã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’é…ç½®ã™ã‚‹VPCã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ DBãŒé…ç½®ã•ã‚Œã‚‹ã‚µãƒ–ãƒãƒƒãƒˆã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«ã™ã‚‹ã€ã“ã‚Œã«ã¯ã€data storeã‚µãƒ–ãƒãƒƒãƒˆã¨åä»˜ã‘ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä»¥å¤–ã¯ã€è¸ã¿å°ã‚µãƒ¼ãƒçµŒç”±ã§ã—ã‹DBã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ— ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ä½¿ç”¨ã›ãšã«ç‹¬è‡ªå®šç¾©ã™ã‚‹å ´åˆã€äº‹å‰ã«æ§‹ç¯‰ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ãŒã‚ã‚‹ãŒã€å…¨ã¦ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã¹ããªãŸã‚ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”¨ã„ã‚Œã°ã‚ˆã„ã€‚å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«é©ç”¨ã‚¿ã‚¤ãƒ—ï¼ˆdynamic/staticï¼‰ãŒã‚ã‚Šã€dynamicã‚¿ã‚¤ãƒ—ã¯è¨­å®šã®é©ç”¨ã«å†èµ·å‹•ãŒå¿…è¦ã§ã‚ã‚‹ã€‚æ–°ã—ãä½œæˆã—ãŸã‚¯ãƒ©ã‚¹ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¦ä»¥ä¸‹ã®å€¤ã‚’è¨­å®šã™ã‚‹ã¨ã‚ˆã„ã€‚ãƒ»time_zone=Asia/Tokyoãƒ»character_set_client=utf8mb4ãƒ»character_set_connection=utf8mb4ãƒ»character_set_database=utf8mb4ãƒ»character_set_results=utf8mb4ãƒ»character_set_server=utf8mb4ãƒ»server_audit_logging=1ï¼ˆç›£æŸ»ãƒ­ã‚°ã‚’CloudWatchã«é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ï¼‰ãƒ»server_audit_logs_upload=1ãƒ»general_log=1ï¼ˆé€šå¸¸ã‚¯ã‚¨ãƒªãƒ­ã‚°ã‚’CloudWatchã«é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ï¼‰ãƒ»slow_query_log=1ï¼ˆã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªãƒ­ã‚°ã‚’CloudWatchã«é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ï¼‰ãƒ»long_query_time=3ï¼ˆã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã¨è¦‹ãªã™æœ€çŸ­ç§’æ•°ï¼‰ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èªè¨¼ DBã«æ¥ç¶šã™ã‚‹ãŸã‚ã®èªè¨¼æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚ å„DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èªè¨¼ã‚’è¨­å®šã§ãã‚‹ãŒã€å…¨ã¦ã®DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«åŒã˜èªè¨¼æ–¹æ³•ã‚’è¨­å®šã™ã¹ããªãŸã‚ã€DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã§ã“ã‚Œã‚’è¨­å®šã™ã‚Œã°ã‚ˆã„ã€‚ ãƒã‚¹ã‚¿ãƒ¦ãƒ¼ã‚¶å DBã®rootãƒ¦ãƒ¼ã‚¶ã‚’è¨­å®š ãƒã‚¹ã‚¿ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ DBã®rootãƒ¦ãƒ¼ã‚¶ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®š ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿æŒæœŸé–“ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ ãŒãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä¿æŒã™ã‚‹æœŸé–“ã‚’è¨­å®šã™ã‚‹ã€‚ 7æ—¥é–“ã«ã—ã¦ãŠãã€‚ ãƒ­ã‚°ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ CloudWatchãƒ­ã‚°ã«é€ä¿¡ã™ã‚‹ãƒ­ã‚°ã‚’è¨­å®šã™ã‚‹ã€‚ å¿…ãšã€å…¨ã¦ã®ãƒ­ã‚°ã‚’é¸æŠã™ã‚‹ã“ã¨ã€‚ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‹ã‚‰ã®ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã®ã¿ã‚’è¨±å¯ã™ã‚‹ã‚ˆã†ã«ã€ã“ã‚Œã‚‰ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆn.n.n.n/32ï¼‰ã‚’è¨­å®šã™ã‚‹ã€‚ å‰Šé™¤ä¿è­· DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®å‰Šé™¤ã‚’é˜²ãã€‚ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã¨ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚‚å‰Šé™¤ã•ã‚Œã‚‹ãŸã‚ã€ã“ã‚Œã‚’é˜²ãã€‚ã¡ãªã¿ã«ã€DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®å‰Šé™¤ä¿è­·ã«ãªã£ã¦ã„ã¦ã‚‚DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯å‰Šé™¤ã§ãã‚‹ã€‚DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å‰Šé™¤ã—ã¦ã‚‚ã€å†ä½œæˆã™ã‚Œã°ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒœãƒªãƒ¥ãƒ¼ãƒ ã«æ¥ç¶šã•ã‚Œã¦å…ƒã€…ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/USER_DeleteCluster.html#USER_DeletionProtection ãƒ»DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹ DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¹ãƒšãƒƒã‚¯ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒãƒ¼ã‚¹ãƒˆå¯èƒ½ã‚¯ãƒ©ã‚¹ã‚’é¸ã¶ã“ã¨ã€‚ã¡ãªã¿ã«ã€Auroraã®DBå®¹é‡ã¯è‡ªå‹•ã§ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã€è¨­å®šã™ã‚‹å¿…è¦ãŒãªã„ã€‚ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã‹å¦ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã‚¿ã‚¤ãƒ— ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ ãƒãƒ«ãƒAZé…ç½® ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã¯åˆ¥ã«ã€ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã‚’ãƒãƒ«ãƒAZé…ç½®ã§è¿½åŠ ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ æœ€åˆã®DBå DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«è‡ªå‹•çš„ã«æ§‹ç¯‰ã•ã‚Œã‚‹DBåã‚’è¨­å®š ãƒã‚¤ãƒŠãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è‡ªå‹•ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®DBã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•çš„ã«æ›´æ–°ã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ é–‹ç™ºç’°å¢ƒã§ã¯æœ‰åŠ¹åŒ–ã€æœ¬ç•ªç’°å¢ƒã¨ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§ã¯ç„¡åŠ¹åŒ–ã—ã¦ãŠãã€‚é–‹ç™ºç’°å¢ƒã§æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å•é¡ŒãŒãªã‘ã‚Œã°ã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã«ã‚‚é©ç”¨ã™ã‚‹ã€‚ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ ãƒ»DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨ã¯ DBã‚¨ãƒ³ã‚¸ãƒ³ã«Auroraã‚’é¸ã‚“ã å ´åˆã«ã®ã¿ä½¿ç”¨ã§ãã‚‹ã€‚DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã€‚ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒåˆ†é›¢ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒèª¤ã£ã¦å…¨ã¦å‰Šé™¤ã•ã‚Œã¦ã—ã¾ã£ãŸã¨ã—ã¦ã‚‚ã€ãƒ‡ãƒ¼ã‚¿ã‚’å®ˆã‚ã‚‹ã€‚ã¾ãŸã€ä¸¡è€…ãŒåˆ†é›¢ã•ã‚Œã¦ã„ãªã„ã‚¨ãƒ³ã‚¸ãƒ³ã‚¿ã‚¤ãƒ—ã¨æ¯”è¼ƒã—ã¦ã€å†èµ·å‹•ãŒæ—©ã„ãŸã‚ã€å†èµ·å‹•ã«ä¼´ã†ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒçŸ­ã„ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html ãƒ»ç©ºã®DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã«ã¦ã€DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å†…ã®å…¨ã¦ã®DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã¨ã€DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚‚è‡ªå‹•ã§å‰Šé™¤ã•ã‚Œã‚‹ã€‚ä¸€æ–¹ã§ã€AWS-APIã‚’ã‚³ãƒ¼ãƒ«ã—ã¦å…¨ã¦ã®DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å‰Šé™¤ã™ã‚‹å ´åˆã€DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¯è‡ªå‹•ã§å‰Šé™¤ã•ã‚Œãšã«ã€ç©ºã®çŠ¶æ…‹ã«ãªã‚‹ã€‚ä¾‹ãˆã°ã€Terraformã‚’ç”¨ã„ã¦DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹æ™‚ã«ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ§‹ç¯‰ã«å¤±æ•—ã™ã‚‹ã¨DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãŒç©ºã«ãªã‚‹ã€ã“ã‚Œã¯ã€TerraformãŒAWS-APIã‚’ã‚³ãƒ¼ãƒ«ã—ãŸæ§‹ç¯‰ã‚’è¡Œã£ã¦ã„ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/USER_DeleteCluster.html#USER_DeleteCluster.DeleteCluster DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ãƒ»DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã¯ ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ©Ÿèƒ½ã‚’æŒã¡ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’æ“ä½œã§ãã‚‹ã€‚ ãƒ»DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç¨®é¡ ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚« ãƒ­ãƒ¼ãƒ« èª­ã¿å‡ºã—ï¼æ›¸ãè¾¼ã¿ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ èª­ã¿å‡ºã—ã‚ªãƒ³ãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ CRUDåˆ¶é™ åˆ¶é™ãªã—ã€‚ãƒ¦ãƒ¼ã‚¶æ¨©é™ã«ä¾å­˜ã™ã‚‹ã€‚ ãƒ¦ãƒ¼ã‚¶æ¨©é™ã®æ¨©é™ã«é–¢ä¿‚ãªãã€READã—ã‹å®Ÿè¡Œã§ããªã„ã€‚ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ å„DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ‹ã‚·ãƒ£ãƒ«ã«åˆã‚ã›ãŸã‚¨ãƒ³ãƒ‚ãƒã‚¤ãƒ³ãƒˆãŒå‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹ã€‚ å„DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ‹ã‚·ãƒ£ãƒ«ã«åˆã‚ã›ãŸã‚¨ãƒ³ãƒ‚ãƒã‚¤ãƒ³ãƒˆãŒå‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿åŒæœŸ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«å¯¾ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã‚’å—ã‘ã¤ã‘ã‚‹ã€‚ èª­ã¿å‡ºã—ï¼æ›¸ãè¾¼ã¿ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ãŒåŒæœŸã•ã‚Œã‚‹ã€‚ ãƒ»ZDPï¼ˆã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ãƒƒãƒé©ç”¨ï¼‰ Auroraã‚’ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«é¸ã‚“ã å ´åˆã«ä½¿ç”¨ã§ãã‚‹ã€‚ç‰¹å®šã®æ¡ä»¶ä¸‹ã«ãŠã„ã¦ã®ã¿ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ¥ç¶šã‚’ç¶­æŒã—ãŸã¾ã¾ã€ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ‘ãƒƒãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã§ãã‚‹ã€‚ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ãƒƒãƒé©ç”¨ãŒç™ºå‹•ã—ãŸå ´åˆã€RDSã®ã‚¤ãƒ™ãƒ³ãƒˆãŒè¨˜éŒ²ã•ã‚Œã‚‹ã€‚ãŸã ã—ã€ã“ã®æ©Ÿèƒ½ã«é ¼ã‚Šåˆ‡ã‚‰ãªã„æ–¹ãŒè‰¯ã„ã€‚ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ãƒƒãƒé©ç”¨ã®ç™ºå‹•ã¯AWSã‹ã‚‰äº‹å‰ã«ãŠçŸ¥ã‚‰ã›ã•ã‚Œã‚‹ã‚ã‘ã§ã‚‚ãªãã€ãƒ¦ãƒ¼ã‚¶ãŒæ¡ä»¶ã‚’è¦‹ã¦ç™ºå‹•ã®æœ‰ç„¡ã‚’åˆ¤æ–­ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã¾ãŸã€å®Ÿéš›ã«ç™ºå‹•ã—ã¦ã„ã¦ã‚‚ã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã—ãŸäº‹ä¾‹ãŒå ±å‘Šã•ã‚Œã¦ã„ã‚‹ã€‚ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ãƒƒãƒé©ç”¨æ™‚ã€ä»¥ä¸‹ã®æ‰‹é †ã§ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã€‚ ï¼ˆï¼‘ï¼‰ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã€ã“ã®æ™‚ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã—ãªã„ä»£ã‚ã‚Šã«ã€5ç§’ã»ã©ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä½ä¸‹ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ãŒå†èµ·å‹•ã•ã‚Œã€ã“ã®æ™‚ã«20ï½30ç§’ã»ã©ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ã“ã‚Œã‚‰ã®ä»•çµ„ã¿ã®ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯èª­ã¿å‡ºã—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æ¥ç¶šå…ˆã¨ã—ã¦ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼š https://qiita.com/tonishy/items/542f7dd10cc43fd299ab https://qiita.com/tmiki/items/7ade95c33b8e43c7cb5f https://noname.work/2407.html https://www.yuulinux.tokyo/8070/ ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ»ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã¨ã¯ Auroraã§ã¯ã€OSã€ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€MySQLãªã©ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ™‚ã«ã€DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å†èµ·å‹•ãŒå¿…è¦ã§ã‚ã‚‹ã€‚å†èµ·å‹•ã«ä¼´ã£ã¦ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰DBã«æ¥ç¶šã§ããªããªã‚‹ã€‚ã“ã®é–“ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç”¨è€…ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’å°ã•ãã§ãã‚‹ã‚ˆã†ã«ã€è¨ˆç”»çš„ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’ç™ºç”Ÿã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®ç™ºç”Ÿæ¡ä»¶ éAuroraã«è¨˜è¼‰ã•ã‚ŒãŸæƒ…å ±ã®ãŸã‚ã€å³å¯†ã«ã¯Auroraã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã§ã¯ãªã„ã€‚ãŸã ã€çµŒé¨“ä¸ŠåŒã˜é …ç›®ã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ãŸã‚ã€å‚è€ƒã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.Settings å¤‰æ›´ã™ã‚‹é …ç›® ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ‰ç„¡ è£œè¶³ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹ ã‚ã‚Š ãƒ»äºŒã¤ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§åŒæ™‚ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’ç¢ºèªã§ãã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¤‡æ•°å›å†èµ·å‹•ã™ã‚‹ã“ã¨ã‹ã‚‰ã‚ã‹ã‚‹é€šã‚Šã€é•·ã„ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ï¼ˆç´„6ï½8åˆ†ï¼‰ãŒç™ºç”Ÿã™ã‚‹ã€‚ãã®ãŸã‚ã€ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’åˆ©ç”¨ã—ãŸãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ€å°åŒ–ã‚’è¡Œã†ã€‚å‚è€ƒhttps://dev.classmethod.jp/articles/rds-scaleup-instancetype/ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã®ã‚¤ãƒ™ãƒ³ãƒˆ ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— ã‚ã‚Š ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ã‚ã‚Š 20ï½30ç§’ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ã“ã®æ™‚é–“ã¯ã€ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚µã‚¤ã‚ºã€ãƒã‚¤ãƒŠãƒªãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã®é‡ã€ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ãƒƒãƒé©ç”¨ã®ç™ºå‹•å¯å¦ã€ã«ã‚ˆã£ã¦å¤‰å‹•ã™ã‚‹ã€‚å‚è€ƒï¼šãƒ»https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.htmlãƒ»https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.Patching.html#AuroraMySQL.Updates.AMVU ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ æ¡ä»¶ä»˜ãã§ãªã— ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹æ“ä½œãŒä¿ç•™ä¸­ã«ãªã£ã¦ã„ã‚‹çŠ¶æ…‹ã§ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ™‚é–“ã‚’ç¾åœ¨ãŒå«ã¾ã‚Œã‚‹ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹ã¨ã€ä¿ç•™ä¸­ã®æ“ä½œãŒã™ãã«é©ç”¨ã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ æ¡ä»¶ä»˜ãã§ãªã— 0ã‹ã‚‰0ä»¥å¤–ã®å€¤ã€0ä»¥å¤–ã®å€¤ã‹ã‚‰0ã«å¤‰æ›´ã—ãŸå ´åˆã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ— ãªã— ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®å¤‰æ›´ã§ã¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã¯ç™ºç”Ÿã—ãªã„ã€‚ãŸã ã—ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®å¤‰æ›´ã‚’DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«åæ˜ ã•ã›ã‚‹ä¸Šã§å†èµ·å‹•ãŒå¿…è¦ãªãŸã‚ã€ã“ã“ã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— ãªã— ãƒã‚¤ãƒŠãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³è‡ªå‹•ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ ãªã— ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å¤‰æ›´ã«ã¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ãŒã€è‡ªå‹•ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã®è¨­å®šã«ã¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã—ãªã„ã€‚ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¤ãƒ³ã‚µã‚¤ãƒˆ æ¡ä»¶ä»˜ãã§ãªã— ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¤ãƒ³ã‚µã‚¤ãƒˆã®æœ‰åŠ¹åŒ–ã§ã¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã—ãªã„ã€‚ãŸã ã—ã€æœ‰åŠ¹åŒ–ã®ãŸã‚ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®performance_schemaã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®å¤‰æ›´ã‚’DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«åæ˜ ã•ã›ã‚‹ä¸Šã§å†èµ·å‹•ãŒå¿…è¦ãªãŸã‚ã€ã“ã“ã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ ãƒ»ã‚¨ãƒ³ã‚¸ãƒ³ã‚¿ã‚¤ãƒ—ã«ã‚ˆã‚‹ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ€å°åŒ– ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒåˆ†é›¢ã—ã¦ã„ã‚‹Auroraã¯ã‚¨ãƒ³ã‚¸ãƒ³ã‚¿ã‚¤ãƒ—ã®ä¸­ã§ã‚‚ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒçŸ­ã„ã€‚ ãƒ»ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®è¨ˆæ¸¬ä¾‹ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹æ–¹æ³•ã¨ã€RDSã«ç›´æ¥ã‚¯ã‚¨ãƒªã‚’é€ä¿¡ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨RDSã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‹ã‚‰ã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’è¨ˆæ¸¬ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š Aurora MySQLã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã«ä¼´ã†ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’è¨ˆæ¸¬ã™ã‚‹ã€‚è¸ã¿å°ã‚µãƒ¼ãƒã‚’çµŒç”±ã—ã¦RDSã«æ¥ç¶šã—ã€ç¾åœ¨æ™‚åˆ»ã‚’å–å¾—ã™ã‚‹SQLã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã®æ™‚ã€foræ–‡ã‚„watchã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã‚‹ã€‚ãŸã ã€watchã‚³ãƒãƒ³ãƒ‰ã¯æ¨™æº–ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚å¹³å¸¸ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®ã‚‚åŒæ™‚ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šæ­£ç¢ºãªãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’å–å¾—ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã¾ãŸã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®æ™‚åˆ»ã‚’æ­£ã—ããƒ­ã‚®ãƒ³ã‚°ã§ãã‚‹ã‚ˆã†ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰æ™‚åˆ»ã‚’å–å¾—ã™ã‚‹ã€‚ #!/bin/bash set -x BASTION_HOST=\"\" BASTION_USER=\"\" DB_HOST=\"\" DB_PASSWORD=\"\" DB_USER=\"\" SECRET_KEY=\"~/.ssh/xxx.pem\" SQL=\"SELECT NOW();\" ssh -o serveraliveinterval=60 -f -N -L 3306:${DB_HOST}:3306 -i ${SECRET_KEY} ${BASTION_USER}@${BASTION_HOST} -p 22 # ç´„15åˆ†é–“ã‚³ãƒãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã™ã€‚ for i in {1..900}; do echo \"---------- No. ${i} Local PC: $(date +\"%Y-%m-%d %H:%M:%S\") ------------\" >> health_check.txt echo ${SQL} | mysql -u ${DB_USER} -P 3306 -p${DB_PASSWORD} >> health_check.txt 2>&1 # 1ç§’å¾…æ©Ÿã™ã‚‹ã€‚ sleep 1 done #!/bin/bash set -x BASTION_HOST=\"\" BASTION_USER=\"\" DB_HOST=\"\" DB_PASSWORD=\"\" DB_USER=\"\" SECRET_KEY=\"~/.ssh/xxx.pem\" SQL=\"SELECT NOW();\" ssh -o serveraliveinterval=60 -f -N -L 3306:${DB_HOST}:3306 -i ${SECRET_KEY} ${BASTION_USER}@${BASTION_HOST} -p 22 # 1ç§’ã”ã¨ã«ã‚³ãƒãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã™ã€‚ watch -n 1 'echo \"---------- No. ${i} Local PC: $(date +\"%Y-%m-%d %H:%M:%S\") ------------\" >> health_check.txt && \\ echo ${SQL} | mysql -u ${DB_USER} -P 3306 -p${DB_PASSWORD} >> health_check.txt 2>&1' ä¸Šè¨˜ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚Šã€ä¾‹ãˆã°æ¬¡ã®ã‚ˆã†ãªãƒ­ã‚°ã‚’å–å¾—ã§ãã‚‹ã€‚ã“ã®ãƒ­ã‚°ã‹ã‚‰ã¯ã€15:23:09 ~ 15:23:14ã®é–“ã§ã€æ¥ç¶šã«å¤±æ•—ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã€‚ ---------- No. 242 Local PC: 2021-04-21 15:23:06 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. NOW() 2021-04-21 06:23:06 ---------- No. 243 Local PC: 2021-04-21 15:23:07 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. NOW() 2021-04-21 06:23:08 ---------- No. 244 Local PC: 2021-04-21 15:23:08 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. ERROR 2026 (HY000): SSL connection error: error:00000000:lib(0):func(0):reason(0) ---------- No. 245 Local PC: 2021-04-21 15:23:09 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. ERROR 2013 (HY000): Lost connection to MySQL server at 'reading initial communication packet', system error: 0 ---------- No. 246 Local PC: 2021-04-21 15:23:10 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. ERROR 2013 (HY000): Lost connection to MySQL server at 'reading initial communication packet', system error: 0 ---------- No. 247 Local PC: 2021-04-21 15:23:11 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. ERROR 2013 (HY000): Lost connection to MySQL server at 'reading initial communication packet', system error: 0 ---------- No. 248 Local PC: 2021-04-21 15:23:13 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. ERROR 2013 (HY000): Lost connection to MySQL server at 'reading initial communication packet', system error: 0 ---------- No. 249 Local PC: 2021-04-21 15:23:14 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. ERROR 2013 (HY000): Lost connection to MySQL server at 'reading initial communication packet', system error: 0 ---------- No. 250 Local PC: 2021-04-21 15:23:15 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. NOW() 2021-04-21 06:23:16 ---------- No. 251 Local PC: 2021-04-21 15:23:16 ------------ mysql: [Warning] Using a password on the command line interface can be insecure. NOW() 2021-04-21 06:23:17 ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ™‚ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®RDSã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã€ãƒ­ã‚°ã«ã‚ˆã‚‹ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã¯ã€å†èµ·å‹•ã‹ã‚‰ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã¾ã§ã®æœŸé–“ã¨ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚ ã¡ãªã¿ã«ã€ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã¯å†èµ·å‹•ã®ã¿ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ï¼DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®è¨­å®šã®å¤‰æ›´ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ã€‚ ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ã®çŠ¶æ…‹ ãƒ¡ãƒ³ãƒ†ãƒŠã‚¹ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ã«ã¯ã€ä»¥ä¸‹ã®çŠ¶æ…‹ãŒã‚ã‚‹ã€‚ çŠ¶æ…‹ èª¬æ˜ åˆ©ç”¨å¯èƒ½ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯å®Ÿè¡Œå¯èƒ½ã§ã‚ã‚‹ã€‚ã¾ãŸã€ä»¥é™ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é–“ã«è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ã¯ãªã„ã€‚ æ¬¡ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯å®Ÿè¡Œå¯èƒ½ã§ã‚ã‚‹ã€‚ã¾ãŸã€æ¬¡å›ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é–“ã«ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹ã€‚å¾Œã§ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹ã“ã¨ã§ã€ã€åˆ©ç”¨å¯èƒ½ã€ã®çŠ¶æ…‹ã«æˆ»ã™ã“ã¨ã‚‚å¯èƒ½ã€‚ å¿…é ˆ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯å®Ÿè¡Œå¯èƒ½ã§ã‚ã‚‹ã€‚ã¾ãŸã€æŒ‡å®šã•ã‚ŒãŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é–“ã«å¿…ãšå®Ÿè¡Œã•ã‚Œã€ã“ã‚Œã¯å»¶æœŸã§ããªã„ã€‚ é€²è¡Œä¸­ ç¾åœ¨æ™‚åˆ»ãŒãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å«ã¾ã‚Œã¦ãŠã‚Šã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œä¸­ã§ã‚ã‚‹ã€‚ ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ ãƒ»Auroraã®ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã¨ã¯ ç•°ãªã‚‹AZã«ã‚ã‚‹DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã§ã€ãƒ­ãƒ¼ãƒ«ï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ï¼‰ã®å‰²ã‚Šå½“ã¦ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ä»•çµ„ã¿ã€‚DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å†…ã®å…¨ã¦ã®DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒåŒã˜AZã«é…ç½®ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã‚ã‚‰ã‹ã˜ã‚ç•°ãªã‚‹AZã«ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã‚’æ–°ã—ãä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã¾ãŸã€ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼æ™‚ã«ã€ã‚‚ã—DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å†…ã«ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ãŒå­˜åœ¨ã—ã¦ã„ãªã„å ´åˆã€ç•°ãªã‚‹AZã«è‡ªå‹•çš„ã«ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ãŒå­˜åœ¨ã—ã¦ã„ã‚‹å ´åˆã€ã“ã‚ŒãŒãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ˜‡æ ¼ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html#Aurora.Managing.FaultTolerance ãƒ»ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã«ã‚ˆã‚‹ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ€å°åŒ– DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒãƒ«ãƒAZæ§‹æˆã®å ´åˆã€ä»¥ä¸‹ã®æ‰‹é †ã‚’ç”¨ã„ã¦ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æœ€å°åŒ–ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://lab.taf-jp.com/rds%E3%81%AE%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E6%99%82%E3%81%AE%E6%8C%99%E5%8B%95%E3%82%92%E7%90%86%E8%A7%A3%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B/ ï¼ˆï¼‘ï¼‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¥ç¶šå…ˆã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®ç™ºç”Ÿã™ã‚‹å¤‰æ›´ã‚’é©ç”¨ã™ã‚‹ã€‚Auroraã§ã¯ãƒ•ã‚§ãƒ¼ãƒ«ã‚ªãƒ¼ãƒãƒ¼ãŒè‡ªå‹•ã§å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼ˆï¼“ï¼‰ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼æ™‚ã«ç´„1ï½2åˆ†ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å†èµ·å‹•ã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ãŒã€ã“ã‚Œã‚ˆã‚Šã¯æ™‚é–“ãŒçŸ­ã„ãŸã‚ã€ç›¸å¯¾çš„ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’çŸ­ç¸®ã§ãã‚‹ã€‚ ãƒ»DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ˜‡æ ¼å„ªå…ˆé †ä½ Auroraã®å ´åˆã€ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã«ã‚ˆã£ã¦æ˜‡æ ¼ã™ã‚‹DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯æ¬¡ã®é †ç•ªã§æ±ºå®šã•ã‚Œã‚‹ã€‚DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã”ã¨ã«ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã®å„ªå…ˆåº¦ï¼ˆ0ï½15ï¼‰ã‚’è¨­å®šã§ãã€å„ªå…ˆåº¦ã®æ•°å€¤ã®å°ã•ã„DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ˜‡æ ¼å¯¾è±¡ã«ãªã‚‹ã€‚å„ªå…ˆåº¦ãŒåŒã˜ã ã¨ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹ãŒå¤§ãã„DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ˜‡æ ¼å¯¾è±¡ã«ãªã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹ãŒåŒã˜ã ã¨ã€åŒã˜ã‚µãƒ–ãƒãƒƒãƒˆã«ã‚ã‚‹DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ˜‡æ ¼å¯¾è±¡ã«ãªã‚‹ã€‚ å„ªå…ˆåº¦ã®é †ç•ª ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹ã®å¤§ãã• åŒã˜ã‚µãƒ–ãƒãƒƒãƒˆ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html ãƒ»ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æœ€å°åŒ–ã§ããªã„å ´åˆ ã‚¨ãƒ³ã‚¸ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¯ä¸¡æ–¹ã®DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§åŒæ™‚ã«å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã§ããšã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æœ€å°åŒ–ã§ããªã„ã€‚ è² è·å¯¾ç­– ãƒ»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä½¿ã„åˆ†ã‘ DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¿œã˜ãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã®CRUDã®ç¨®é¡ã«å¿œã˜ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹å…ˆã‚’æŒ¯ã‚Šåˆ†ã‘ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€è² è·ã‚’åˆ†æ•£ã•ã›ã‚‰ã‚Œã‚‹ã€‚èª­ã¿å‡ºã—ã‚ªãƒ³ãƒªãƒ¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã—ã¦ã€READä»¥å¤–ã®å‡¦ç†ã‚’è¡Œã†ã¨ã€ä»¥ä¸‹ã®é€šã‚Šã€ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹ã€‚ /* SQL Error (1290): The MySQL server is running with the --read-only option so it cannot execute this statement */ ç¨®é¡ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ã‚¯ã‚¨ãƒªã®ç¨®é¡ èª¬æ˜ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ .cluster-.ap-northeast-1.rds.amazonaws.com æ›¸ãè¾¼ã¿ï¼èª­ã¿å‡ºã— ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ¥ç¶šã§ãã‚‹ã€‚ èª­ã¿å‡ºã—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ .cluster-ro-.ap-northeast-1.rds.amazonaws.com èª­ã¿å‡ºã— ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã«æ¥ç¶šã§ãã‚‹ã€‚DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¤‡æ•°ã‚ã‚‹å ´åˆã€ã‚¯ã‚¨ãƒªãŒè‡ªå‹•çš„ã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹ã€‚ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ .cwgrq25vlygf.ap-northeast-1.rds.amazonaws.com é¸æŠã—ãŸDBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ¥ç¶šã§ãã‚‹ã€‚ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã«ã‚ˆã£ã¦èª­ã¿æ›¸ãã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨èª­ã¿å‡ºã—ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå…¥ã‚Œæ›¿ã‚ã£ã¦ã—ã¾ã†ãŸã‚ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æŒ‡å®šã—ãªã„æ–¹ãŒè‰¯ã„ã€‚ã“ã‚Œã¯ã€Redisã‚‚åŒã˜ã§ã‚ã‚‹ã€‚ ãƒ»ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®åˆ©ç”¨ MySQLã‚„Redisã®ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ã€‚ãŸã ã—ã€MySQLã®ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã¯ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³8ã§å»ƒæ­¢ã•ã‚Œã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã€‚ ãƒ»ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼ã¾ãŸã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®åˆ©ç”¨ ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã‚’æ¤œå‡ºã—ã€ãã®SQLã§å¯¾è±¡ã¨ã—ã¦ã„ã‚‹ã‚«ãƒ©ãƒ ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼ã‚„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã‚’æ¤œå‡ºã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã€RDSã®long_query_timeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«åŸºã¥ã„ãŸæ¤œå‡ºã‚„ã€EXPLAINå¥ã«ã‚ˆã‚‹äºˆæƒ³å®Ÿè¡Œæ™‚é–“ã®æ¯”è¼ƒãªã©ãŒã‚ã‚‹ã€‚ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€EXPLAINå¥ã€ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_middleware_database_mysql.html ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ­£è¦åŒ–ã—éããªã„ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ­£è¦åŒ–ã™ã‚‹ã¨ä¿å®ˆæ€§ãŒé«˜ã¾ã‚‹ãŒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®SQLã§JOINå¥ãŒå¿…è¦ã«ãªã‚‹ã€‚ã—ã‹ã—ã€JOINå¥ã‚’å«ã‚€SQLã¯ã€å«ã¾ãªã„SQLã¨æ¯”è¼ƒã—ã¦ã€å®Ÿè¡Œé€Ÿåº¦ãŒé…ããªã‚‹ã€‚ãã“ã§ã€æˆ¦ç•¥çš„ã«æ­£è¦åŒ–ã—éããªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ— ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã‚’ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ã•ã›ã‚‹ã“ã¨ã§ã€æ¥ç¶šéå¤šã®ã‚¨ãƒ©ãƒ¼ï¼ˆERROR 1040 (HY000): Too many connectionsï¼‰ã«å¯¾å‡¦ã™ã‚‹ã€‚ã¡ãªã¿ã«ç¾åœ¨ã®æœ€å¤§æ¥ç¶šæ•°ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®å€¤ã‹ã‚‰ç¢ºèªã§ãã‚‹ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‹ã‚‰ã¯ãŠãŠã‚ˆãã®å€¤ã—ã‹ã‚ã‹ã‚‰ãªã„ãŸã‚ã€SQLã§ç¢ºèªã—ãŸæ–¹ãŒè‰¯ã„ã€‚ MySQL > SHOW GLOBAL VARIABLES LIKE 'max_connections'; +-----------------+-------+ | Variable_name | Value | +-----------------+-------+ | max_connections | 640 | +-----------------+-------+ 1 row in set (0.00 sec) ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ ãƒ»èª¿æŸ»æ›¸ ä»¥ä¸‹ã®ã‚ˆã†ãªå ±å‘Šæ›¸ã®ã‚‚ã¨ã€èª¿æŸ»ã¨å¯¾å¿œã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.html ã¾ãŸãƒãƒ¼ã‚¸ã•ã‚Œã‚‹å†…å®¹ã®èª¿æŸ»ã®ãŸã‚ã€ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã®ç¢ºèªãŒå¿…è¦ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.11Updates.html # èª¿æŸ» ## ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®é•ã„ ã€SELECT AURORA_VERSION()ã€ã‚’ç”¨ã„ã¦ã€æ­£ç¢ºãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã™ã‚‹ã€‚ ## ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹å†…å®¹ ãƒ™ãƒ³ãƒ€ãƒ¼ã®ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã‚’ç¢ºèªã—ã€ã©ã®ã‚ˆã†ãªã€æ©Ÿèƒ½è¿½åŠ ã€ã€ãƒã‚°ä¿®æ­£ã€ã€æ©Ÿèƒ½å»ƒæ­¢ã€ã€éæ¨å¥¨æ©Ÿèƒ½ã€ãŒãƒãƒ¼ã‚¸ã•ã‚Œã‚‹ã‹ã‚’èª¿æŸ»ã™ã‚‹ã€‚ æ©Ÿèƒ½å»ƒæ­¢ã‚„éæ¨å¥¨æ©Ÿèƒ½ãŒã‚ã‚‹å ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®SQLæ–‡ã«å½±éŸ¿ãŒå‡ºã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ ## æƒ³å®šã•ã‚Œã‚‹ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’è¨ˆæ¸¬ã—ã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æƒ³å®šã™ã‚‹ã€‚ # æœ¬ç•ªç’°å¢ƒå¯¾å¿œ ## æ—¥æ™‚ã¨å‘¨çŸ¥ å¯¾å¿œæ—¥æ™‚ã¨å‘¨çŸ¥å†…å®¹ã‚’æ±ºå®šã™ã‚‹ã€‚ ## æƒ³å®šå¤–ã®çµæœ æœ¬ç•ªç’°å¢ƒã§ã®å¯¾å¿œã§èµ·ã“ã£ãŸæƒ³å®šå¤–ã®çµæœã‚’è¨˜è¼‰ã™ã‚‹ã€‚ 22-02. RDSï¼ˆéAuroraï¼‰ ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ»ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®ç™ºç”Ÿæ¡ä»¶ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.Settings ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ ãƒ»RDSã®ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã¨ã¯ ã‚¹ã‚¿ãƒ³ãƒã‚¤ãƒ¬ãƒ—ãƒªã‚«ãŒãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ˜‡æ ¼ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/Concepts.MultiAZ.html ãƒ»ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã«ã‚ˆã‚‹ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®æœ€å°åŒ– DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒãƒ«ãƒAZæ§‹æˆã®å ´åˆã€ä»¥ä¸‹ã®æ‰‹é †ã‚’ç”¨ã„ã¦ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æœ€å°åŒ–ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://lab.taf-jp.com/rds%E3%81%AE%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E6%99%82%E3%81%AE%E6%8C%99%E5%8B%95%E3%82%92%E7%90%86%E8%A7%A3%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B/ ï¼ˆï¼‘ï¼‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¥ç¶šå…ˆã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰ç‰¹å®šã®æ¡ä»¶ä¸‹ã§ã®ã¿ã€ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ãŒè‡ªå‹•çš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/Concepts.MultiAZ.html#Concepts.MultiAZ.Failover ï¼ˆ3ï¼‰éAuroraã®RDSã§ã¯æ¡ä»¶ã«å½“ã¦ã¯ã¾ã‚‰ãªã„å ´åˆã€ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã‚’æ‰‹å‹•ã§ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã•ã›ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.MySQL.html#USER_UpgradeDBInstance.MySQL.ReducedDowntime ï¼ˆ4ï¼‰ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼æ™‚ã«ç´„1ï½2åˆ†ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ã€‚ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å†èµ·å‹•ã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹ãŒã€ã“ã‚Œã‚ˆã‚Šã¯æ™‚é–“ãŒçŸ­ã„ãŸã‚ã€ç›¸å¯¾çš„ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’çŸ­ç¸®ã§ãã‚‹ã€‚ 23. Regionã¨Zone Region ãƒ»Regionã¨ã¯ ç‰©ç†ã‚µãƒ¼ãƒã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ã®åœ°åŸŸåã®ã“ã¨ã€‚ ãƒ»Globalã¨ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ Regionã¨ã¯åˆ¥ã«ã€ç‰©ç†ã‚µãƒ¼ãƒãŒä¸–ç•Œä¸­ã«ã‚ã‚Šã€ã“ã‚Œã‚‰ã®é–“ã§ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒæ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€Globalãªã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ç‰¹å®šã®Regionã«ä¾å­˜ã›ãšã«ã€å…¨ã¦ã®Regionã¨é€£æºã§ãã‚‹ã€‚ 24. Route53 Route53ã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰DNSã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦åƒãã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸå®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨EC2ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¦ã„ã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆ åå‰è§£æ±ºæ™‚ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’æ‰±ã†ã“ã¨ã‚‚å¯èƒ½ã€‚ ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ ãƒ»ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã®è¨­å®šå€¤ã®é•ã„ ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ— è£œè¶³ NS IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å•ã„åˆã‚ã›ã«å¿œãˆã‚‰ã‚Œã‚‹æ¨©å¨DNSã‚µãƒ¼ãƒã®åå‰ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚ A ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã—ãŸã„AWSãƒªã‚½ãƒ¼ã‚¹ã®ã€IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯DNSåã‚’è¨­å®šã™ã‚‹ã€‚ AAAA ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã—ãŸã„AWSãƒªã‚½ãƒ¼ã‚¹ã®ã€IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯DNSåã‚’è¨­å®šã™ã‚‹ã€‚ CNAME ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã—ãŸã„ä»»æ„ã®ã‚µãƒ¼ãƒã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ è»¢é€å…ˆã¯AWSãƒªã‚½ãƒ¼ã‚¹ã§ãªãã¨ã‚‚ã‚ˆã„ã€‚ MX ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã—ãŸã„ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ TXT ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã—ãŸã„ã‚µãƒ¼ãƒã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸæ–‡å­—åˆ—ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒªã‚½ãƒ¼ã‚¹ã®DNSåã€ãƒ‰ãƒ¡ã‚¤ãƒ³åã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå ãƒªã‚½ãƒ¼ã‚¹ã®DNSåã¯ã€ä»¥ä¸‹ã®æ§˜ã«æ±ºå®šã•ã‚Œã‚‹ã€‚ ç¨®åˆ¥ ãƒªã‚½ãƒ¼ã‚¹ ä¾‹ DNSå ALB -..elb.amazonaws.com EC2 ec2-..compute.amazonaws.com ãƒ‰ãƒ¡ã‚¤ãƒ³å CloudFront .cloudfront.net ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå S3 ..amazonaws.com ãƒ»ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã®åå‰è§£æ±ºæ–¹æ³•ã®é•ã„ ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ— åå‰è§£æ±ºæ–¹æ³•ï¼ˆ1ï¼‰ ï¼ˆ2ï¼‰ ï¼ˆ3ï¼‰ A å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³å â†’ ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPv4 â†’ - AAAA å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³å â†’ ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPv6 â†’ - CNAME å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³å â†’ ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼‰ â†’ ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPv4 ãƒ»CloudFrontã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° CloudFrontã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹å ´åˆã€CloudFrontã®CNAMEã‚’ãƒ¬ã‚³ãƒ¼ãƒ‰åã¨ã™ã‚‹ã¨ã€CloudFrontã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³åï¼ˆxxxxx.cloudfront.net.ï¼‰ãŒã€å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ãƒ»Route53ã‚’å«ã‚€å¤šæ•°ã®DNSã‚µãƒ¼ãƒã«ã‚ˆã£ã¦åå‰è§£æ±ºã•ã‚Œã‚‹ä»•çµ„ã¿ === ï¼ˆ1ï¼‰å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åã«å¯¾å¿œã™ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ === ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã¯ã€è‡ªèº«ã«ä¿å­˜ã•ã‚Œã‚‹www.example.jpï¼ˆå®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åï¼‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ¤œç´¢ã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒç„¡ã‘ã‚Œã°ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã¯www.example.jpã‚’ã€ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥DNSã‚µãƒ¼ãƒï¼‰ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€DNSã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ¤œç´¢ã™ã‚‹ã€‚ ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€ãƒ«ãƒ¼ãƒˆDNSã‚µãƒ¼ãƒã«www.example.jpã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å•ã„åˆã‚ã›ã‚‹ã€‚ ãƒ«ãƒ¼ãƒˆDNSã‚µãƒ¼ãƒã¯ã€NSãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦å®šç¾©ã•ã‚ŒãŸæ¨©å¨DNSã‚µãƒ¼ãƒåã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€www.example.jpã‚’ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚æ¬¡ã„ã§ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€DNSã‚µãƒ¼ãƒï¼ˆãƒãƒ¼ãƒ ã‚µãƒ¼ãƒï¼‰ã«www.example.jpã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å•ã„åˆã‚ã›ã‚‹ã€‚ DNSã‚µãƒ¼ãƒã¯ã€NSãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦å®šç¾©ã•ã‚ŒãŸæ¨©å¨DNSã‚µãƒ¼ãƒåã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€www.example.jpã‚’ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚æ¬¡ã„ã§ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªãƒ¼ã‚¸ãƒ§ãƒ³Route53ã«www.example.jpã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å•ã„åˆã‚ã›ã‚‹ã€‚ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªãƒ¼ã‚¸ãƒ§ãƒ³Route53ã¯DNSã‚µãƒ¼ãƒã¨ã—ã¦æ©Ÿèƒ½ã—ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚æ¬¡ã„ã§ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ä»£ç†ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ï¼ˆâ€» NATã«ã‚ˆã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“å¤‰æ›ãŒèµ·ã“ã‚‹ï¼‰ å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³å Route53 IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ http://www.example.com â‡„ 203.142.205.139 ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã«ä»£ç†ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã¯æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ === ï¼ˆ2ï¼‰æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾å¿œã™ã‚‹Webãƒšãƒ¼ã‚¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ === ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸæ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åŸºã«ã€Webãƒšãƒ¼ã‚¸ã‚’ã€ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€Webãƒšãƒ¼ã‚¸ã‚’ã€æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã«ä»£ç†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚ æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ALBã¯ã€EC2ã‚„Fargateã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ã€‚ EC2ã‚„Fargateã¯ã€Webãƒšãƒ¼ã‚¸ã‚’ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¯ã€Webãƒšãƒ¼ã‚¸ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆPCã«ä»£ç†ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚ ãƒ»AWSä»¥å¤–ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã—ãŸå ´åˆ DNSã‚µãƒ¼ãƒã«ã‚ˆã‚‹åå‰è§£æ±ºã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã—ãŸãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã§è¡Œã‚ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€AWSä»¥å¤–ï¼ˆä¾‹ï¼šãŠåå‰ãƒ‰ãƒƒãƒˆã‚³ãƒ ï¼‰ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã—ãŸå ´åˆã€Route53ã®NSãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã‚’ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å®Ÿéš›ã«è³¼å…¥ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã«ç™»éŒ²ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã«å¯¾ã—ã¦IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å•ã„åˆã‚ã›ãŒã‚ã£ãŸå ´åˆã¯ã€Route53ã®NSãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ãŒDNSã‚µãƒ¼ãƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚DNSã‚µãƒ¼ãƒãŒRoute53ã«å•ã„åˆã‚ã›ã‚‹ã¨ã€Route53ã¯ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒã¨ã—ã¦æ©Ÿèƒ½ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã€‚ ãƒ»Route53ã«ãŠã‘ã‚‹DNSã‚­ãƒ£ãƒƒã‚·ãƒ¥ ãƒ«ãƒ¼ãƒˆã‚µãƒ¼ãƒã¯ä¸–ç•Œã«13æ©Ÿã—ã‹å­˜åœ¨ã—ã¦ãŠã‚‰ãšã€ä¸–ç•Œä¸­ã®åå‰è§£æ±ºã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å…¨ã¦å‡¦ç†ã™ã‚‹ã“ã¨ã¯ç¾å®Ÿçš„ã«ä¸å¯èƒ½ã§ã‚ã‚‹ã€‚ãã“ã§ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³åã®é–¢ä¿‚ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥DNSã‚µãƒ¼ãƒï¼‰ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚åŸºæœ¬çš„ã«ã¯ã€ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¨DNSã‚µãƒ¼ãƒã¯åŒºåˆ¥ã•ã‚Œã‚‹ãŒã€Route53ã¯ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒã¨DNSã‚µãƒ¼ãƒã®æ©Ÿèƒ½ã‚’ä¸¡ç«‹ã—ã¦ã„ã‚‹ã€‚ ãƒªã‚¾ãƒ«ãƒãƒ¼ ãƒ»ãƒªã‚¾ãƒ«ãƒãƒ¼ã¨ã¯ è¦å‹‰å¼·ã€‚ 25. S3ï¼šSimple Storage Service S3ã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰å¤–ä»˜ã‘ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨ã—ã¦åƒãã€‚S3ã«ä¿å­˜ã™ã‚‹CSSãƒ•ã‚¡ã‚¤ãƒ«ã‚„ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç®¡ç†ã§ãã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ ãƒã‚±ãƒƒãƒˆ ãƒã‚±ãƒƒãƒˆã«é–¢ã—ã¦è¨­å®šã™ã‚‹ã€‚ ãƒãƒƒãƒã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ã‚¢ã‚¯ã‚»ã‚¹ã‚¢ãƒŠãƒ©ã‚¤ã‚¶ãƒ¼ ãƒ»ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° ã‚µãƒ¼ãƒã‚¢ã‚¯ã‚»ã‚¹ã®ãƒ­ã‚°è¨˜éŒ² é™çš„ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ã®ãƒ­ã‚°è¨˜éŒ² ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæš—å·åŒ– ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ­ãƒƒã‚¯ Transfer acceleration ã‚¤ãƒ™ãƒ³ãƒˆ ãƒªã‚¯ã‚¨ã‚¹ã‚¿æ”¯æ‰•ã„ ãƒ»å¤–éƒ¨ï¼å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒS3ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ™‚ã®è¨±å¦ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã¨ã€é …ç›®ã”ã¨ã®æ–¹æ³•ï¼ˆACLã€ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒã‚¤ãƒ³ãƒˆãƒãƒªã‚·ãƒ¼ï¼‰ã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãŒè¨±å¯ã•ã‚Œã‚‹ã€‚ã‚‚ã—ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹å ´åˆã¯ã€ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç„¡åŠ¹åŒ–ã—ãŸä¸Šã§ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã«è¨±å¯å¯¾è±¡ã‚’å®šç¾©ã™ã‚‹ã‹ã€ã‚ã‚‹ã„ã¯ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã§ã¯æ‹’å¦ã§ããªã„IAMãƒãƒªã‚·ãƒ¼ã‚’AWSãƒªã‚½ãƒ¼ã‚¹ã«è¨­å®šã™ã‚‹ã€‚ãƒ»ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’å…¨ã¦æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ã®å…¨ã‚¢ã‚¯ã‚»ã‚¹ã‚’é®æ–­ã§ãã‚‹ã€‚ãƒ»ç‰¹å®šã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒªã‚¹ãƒˆã‚’åˆ¶é™ã—ãŸå ´åˆã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã ã‘ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã«ãªã‚‰ãªã„ã€‚ ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ IAMãƒ¦ãƒ¼ã‚¶ï¼ˆã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚‚å¯ï¼‰ã¾ãŸã¯AWSãƒªã‚½ãƒ¼ã‚¹ãŒS3ã¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ãƒãƒªã‚·ãƒ¼ã§ç®¡ç†ã™ã‚‹ã€‚ ãƒ»ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç„¡åŠ¹ã«ã—ãŸã†ãˆã§ã€IAMãƒ¦ãƒ¼ã‚¶ï¼ˆã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚‚å¯ï¼‰ã‚„AWSãƒªã‚½ãƒ¼ã‚¹ãŒS3ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã‚ã‚‹ã€‚ãŸã ã—ä»£ã‚ã‚Šã«ã€IAMãƒãƒªã‚·ãƒ¼ã‚’AWSãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã“ã¨ã§ã‚‚ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã§ãã‚‹ã€‚å‚è€ƒï¼šhttps://awesome-linus.com/2020/02/04/s3-bucket-public-access/ãƒ»ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã§ããªã„CloudFrontã‚„ALBãªã©ã§ã¯ã€è‡ªèº«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«å¿…é ˆã§ã‚ã‚‹ã€‚ ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒªã‚¹ãƒˆ IAMãƒ¦ãƒ¼ã‚¶ï¼ˆã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚‚å¯ï¼‰ãŒS3ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ™‚ã®è¨±å¦ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã¨æ©Ÿèƒ½ãŒé‡è¤‡ã™ã‚‹ã€‚ãƒ»ä»®ã«ãƒã‚±ãƒƒãƒˆè‡ªä½“ã®ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç„¡åŠ¹åŒ–ã—ãŸã¨ã—ã¦ã‚‚ã€ç‰¹å®šã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒªã‚¹ãƒˆã‚’åˆ¶é™ã—ãŸå ´åˆã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã ã‘ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã«ãªã‚‰ãªã„ã€‚ CORSã®è¨­å®š ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¨­å®š ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã«åŸ‹ã‚è¾¼ã‚€HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚ è¨­å®šå¯èƒ½ãªãƒ˜ãƒƒãƒ€ãƒ¼ èª¬æ˜ è£œè¶³ ETag ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸€æ„ãªè­˜åˆ¥å­ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ¤œè¨¼ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ Cache-Control Expiresã¨åŒæ§˜ã«ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ‰åŠ¹æœŸé™ã‚’è¨­å®šã™ã‚‹ã€‚ å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ Content-Type ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®MIMEã‚¿ã‚¤ãƒ—ã‚’è¨­å®šã™ã‚‹ã€‚ å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ Expires Cache-Controlã¨åŒæ§˜ã«ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ‰åŠ¹æœŸé™ã‚’è¨­å®šã™ã‚‹ã€‚ãŸã ã—ã€Cache-Controlã®æ–¹ãŒå„ªå…ˆåº¦ãŒé«˜ã„ã€‚ Content-Disposition Content-Encoding x-amz-website-redirect-location ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã‚’è¨­å®šã™ã‚‹ã€‚ ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã®ä¾‹ ãƒ»S3ã®ARNã«ã¤ã„ã¦ ãƒãƒªã‚·ãƒ¼ã«ãŠã„ã¦ã€S3ã®ARã§ã¯ã€ã€arn:aws:s3:::/*ã€ã®ã‚ˆã†ã«ã€æœ€å¾Œã«ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ãŒå¿…è¦ã€‚ ãƒ»ALBã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®ä¿å­˜ã‚’è¨±å¯ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãŒç„¡åŠ¹åŒ–ã•ã‚ŒãŸS3ã«å¯¾ã—ã¦ã€ALBã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ä¿å­˜ã—ãŸã„å ´åˆã€ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã«ã¯ã€ALBã‹ã‚‰S3ã¸ã®ãƒ­ã‚°æ›¸ãè¾¼ã¿æ¨©é™ã‚’å®Ÿè£…ã™ã‚‹ã€‚ã€\"AWS\": \"arn:aws:iam::582318560864:root\"ã€ã«ãŠã„ã¦ã€582318560864ã¯ã€ALBã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã¨å‘¼ã°ã‚Œã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«å€¤ãŒæ±ºã¾ã£ã¦ã„ã‚‹ã€‚ã“ã‚Œã¯ã€æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã§ã‚ã‚‹ã€‚ãã®ä»–ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/load-balancer-access-logs.html#access-logging-bucket-permissions ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"arn:aws:iam::582318560864:root\" }, \"Action\": \"s3:PutObject\", \"Resource\": \"arn:aws:s3:::/*\" } ] } ãƒ»CloudFrontã®ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿å‡ºã—ã‚’è¨±å¯ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãŒç„¡åŠ¹åŒ–ã•ã‚ŒãŸS3ã«å¯¾ã—ã¦ã€CloudFrontã‹ã‚‰ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å‡ºã—ãŸã„å ´åˆã€ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"Version\": \"2008-10-17\", \"Id\": \"PolicyForCloudFrontPrivateContent\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity \" }, \"Action\": \"s3:GetObject\", \"Resource\": \"arn:aws:s3:::/*\" } ] } ãƒ»CloudFrontã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®ä¿å­˜ã‚’è¨±å¯ 2020-10-08æ™‚ç‚¹ã®ä»•æ§˜ã§ã¯ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãŒç„¡åŠ¹åŒ–ã•ã‚ŒãŸS3ã«å¯¾ã—ã¦ã€CloudFrontã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ä¿å­˜ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚ã‚ˆã£ã¦ã€å±é™ºã§ã¯ã‚ã‚‹ãŒã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ // ãƒãƒªã‚·ãƒ¼ã¯ä¸è¦ ãƒ»Lambdaã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ä»£ã‚ã‚Šã«ã€AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã®ã€AWSLambdaExecuteã€ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸãƒ­ãƒ¼ãƒ«ã‚’Lambdaã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã®ãƒãƒªã‚·ãƒ¼ã«ã¯ã€S3ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®ä»–ã€CloudWatchãƒ­ã‚°ã«ãƒ­ã‚°ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®æ¨©é™ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"logs:*\" ], \"Resource\": \"arn:aws:logs:*:*:*\" }, { \"Effect\": \"Allow\", \"Action\": [ \"s3:GetObject\", \"s3:PutObject\" ], \"Resource\": \"arn:aws:s3:::*\" } ] } ãƒ»ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ãŸã„å ´åˆã€ãã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒãƒªã‚·ãƒ¼ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Id\": \"S3PolicyId1\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": \"*\", \"Action\": \"s3:GetObject\", \"Resource\": \"arn:aws:s3:::/*\", \"Condition\": { \"IpAddress\": { \"aws:SourceIp\": \"/32\" } } } ] } CORSè¨­å®š ãƒ»æŒ‡å®šã—ãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰ã®GETé€ä¿¡ã‚’è¨±å¯ [ { \"AllowedHeaders\": [ \"Content-*\" ], \"AllowedMethods\": [ \"GET\" ], \"AllowedOrigins\": [ \"https://example.jp\" ], \"ExposeHeaders\": [], \"MaxAgeSeconds\": 3600 } ] ç½²åä»˜ãURL ãƒ»ç½²åä»˜ãURLã¨ã¯ èªè¨¼èªå¯æƒ…å ±ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«æŒã¤URLã®ã“ã¨ã€‚S3ã§ã¯ã€ç½²åä»˜ãURLã‚’ç™ºè¡Œã—ã€S3ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’å¤–éƒ¨ã®ãƒ¦ãƒ¼ã‚¶ã«ä¸€æ™‚çš„ã«ä»˜ä¸ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://atmarkit.itmedia.co.jp/ait/articles/2107/15/news009.html CLI ãƒ»ãƒã‚±ãƒƒãƒˆå†…ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤º ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š æŒ‡å®šã—ãŸãƒã‚±ãƒƒãƒˆå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ aws s3 ls s3:// ãƒ»ãƒã‚±ãƒƒãƒˆå†…å®¹é‡ã‚’åˆè¨ˆ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š æŒ‡å®šã—ãŸãƒã‚±ãƒƒãƒˆå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«å®¹é‡ã‚’åˆè¨ˆã™ã‚‹ã€‚ $ aws s3 ls s3:// --summarize --recursive --human-readable 26. Security Group Security Groupã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‘ã‚±ãƒƒãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‹ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨ã—ã¦åƒãã€‚ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å‘ãé€šä¿¡ï¼‰ã§ã¯ã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚„å—ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã§ãã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å‘ãé€šä¿¡ï¼‰ã§ã¯ã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚„é€ä¿¡å…ˆãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’è¨­å®šã§ãã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ«ã¨ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã§ãã‚‹ã€‚ ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ« ãƒ»ãƒ‘ã‚±ãƒƒãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‹ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« ãƒ‘ã‚±ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€æƒ…å ±ã«è¨˜è¼‰ã•ã‚ŒãŸé€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„ãƒãƒ¼ãƒˆç•ªå·ãªã©ã«ã‚ˆã£ã¦ã€ãƒ‘ã‚±ãƒƒãƒˆã‚’è¨±å¯ã™ã‚‹ã¹ãã‹ã©ã†ã‹ã‚’æ±ºå®šã™ã‚‹ã€‚é€Ÿåº¦ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯ã“ã¡ã‚‰ã€‚ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨Webã‚µãƒ¼ãƒã®é–“ã«ã¯ã€NATãƒ«ãƒ¼ã‚¿ã‚„NAPTãƒ«ãƒ¼ã‚¿ãŒè¨­ç½®ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œã‚‰ã«ã‚ˆã‚‹é€ä¿¡å…ƒãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰é€ä¿¡å…ƒã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®å¤‰æ›ã«ã¤ã„ã¦ã‚‚å‚è€ƒã«ã›ã‚ˆã€‚ ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—IDã®ç´ä»˜ã‘ ã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—IDã‚’è¨­å®šã—ãŸå ´åˆã€ãã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã‚‹ENIã¨ã€ã“ã®ENIã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’è¨±å¯ã§ãã‚‹ã€‚ãƒªã‚½ãƒ¼ã‚¹ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‹•çš„ã«å¤‰åŒ–ã™ã‚‹å ´åˆã€æœ‰åŠ¹ãªæ–¹æ³•ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/VPC_SecurityGroups.html#DefaultSecurityGroup ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³EC2ã®ä¾‹ ALBã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ã€ALBã®Security Groupã®IDã€ã¾ãŸã¯ã‚µãƒ–ãƒãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆ ã‚½ãƒ¼ã‚¹ èª¬æ˜ HTTP TCP 80 ALBã®Security Group ID HTTP access from ALB HTTPS TCP 443 è¸ã¿å°EC2ã®Security Group ID SSH access from bastion EC2 ãƒ»è¸ã¿å°EC2ã®ä¾‹ ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆ ã‚½ãƒ¼ã‚¹ èª¬æ˜ SSH TCP 22 ç¤¾å†…ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ SSH access from global ip addess ãƒ»EFSã®ä¾‹ EC2ã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ã€EC2ã®Security Groupã®IDã€ã¾ãŸã¯ã‚µãƒ–ãƒãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆ ã‚½ãƒ¼ã‚¹ èª¬æ˜ NFS TCP 2049 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³EC2ã®Security Group ID NFS access from app EC2 ãƒ»RDSã®ä¾‹ EC2ã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ã€EC2ã®Security Groupã®IDã€ã¾ãŸã¯ã‚µãƒ–ãƒãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆ ã‚½ãƒ¼ã‚¹ èª¬æ˜ MYSQL/Aurora TCP 3306 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³EC2ã®Security Group ID MYSQL access from app EC2 ãƒ»Redisã®ä¾‹ EC2ã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ã€EC2ã®Security Groupã®IDã€ã¾ãŸã¯ã‚µãƒ–ãƒãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆ ã‚½ãƒ¼ã‚¹ èª¬æ˜ ã‚«ã‚¹ã‚¿ãƒ TCP TCP 6379 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³EC2ã®Security Group ID TCP access from app EC2 ãƒ»ALBã®ä¾‹ CloudFrontã¨é€£æºã™ã‚‹å ´åˆã€CloudFrontã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ã€å…¨ã¦ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨±å¯ã™ã‚‹ã€‚ãã®ä»£ã‚ã‚Šã«ã€CloudFrontã«WAFã‚’ç´ä»˜ã‘ã€ALBã®å‰ã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åˆ¶é™ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚CloudFrontã¨ã¯é€£æºã—ãªã„å ´åˆã€ALBã®Security Groupã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åˆ¶é™ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆ ã‚½ãƒ¼ã‚¹ èª¬æ˜ HTTP TCP 80 0.0.0.0/0 HTTP access from CloudFront HTTPS TCP 443 0.0.0.0/0 HTTPS access from CloudFront ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ« ãƒ»ä»»æ„AWSãƒªã‚½ãƒ¼ã‚¹ã®ä¾‹ ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆ é€ä¿¡å…ˆ èª¬æ˜ ã™ã¹ã¦ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ ã™ã¹ã¦ ã™ã¹ã¦ 0.0.0.0/0 Full access Zone ãƒ»Availability Zoneã¨ã¯ Regionã¯ã€ã•ã‚‰ã«ã€å„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ã¯ç‰©ç†çš„ã«ç‹¬ç«‹ã—ãŸAvailability Zoneã¨ã„ã†ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã€‚ä¾‹ãˆã°ã€æ±äº¬Regionã«ã¯ã€3ã¤ã®Availability ZoneãŒã‚ã‚‹ã€‚AZã®ä¸­ã«ã€VPCã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½œã‚‹ã“ã¨ãŒã§ãã€ãã“ã«EC2ã‚’æ§‹ç¯‰ã§ãã‚‹ã€‚ 27. SESï¼šSimple Email Service SESã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒã¨ã—ã¦åƒãã€‚ãƒ¡ãƒ¼ãƒ«å—ä¿¡ã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Domain SESã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ è¨­å®šã—ãŸãƒ‰ãƒ¡ã‚¤ãƒ³åã«ã¯ã€ã€10 inbound-smtp.us-east-1.amazonaws.comã€ã¨ã„ã†MXãƒ¬ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã®å€¤ãŒç´ä»˜ãã€‚ Email Addresses é€ä¿¡å…ˆã¨ã—ã¦èªè¨¼ã™ã‚‹ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚è¨­å®šã™ã‚‹ã¨AWSã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ãŒå±Šãã®ã§ã€æŒ‡å®šã•ã‚ŒãŸãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã€‚ Sandboxãƒ¢ãƒ¼ãƒ‰ã®æ™‚ã ã‘æ©Ÿèƒ½ã™ã‚‹ã€‚ Sending Statistics SESã§åé›†ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã§ç¢ºèªã§ãã‚‹ã€‚ Request Increased Sending Limitsã®ãƒªãƒ³ã‚¯ã«ã¦ã€Sandboxãƒ¢ãƒ¼ãƒ‰ã®è§£é™¤ã‚’ç”³è«‹ã§ãã‚‹ã€‚ SMTP Settings SMTP-AUTHã®æ¥ç¶šæƒ…å ±ã‚’ç¢ºèªã§ãã‚‹ã€‚ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®25ç•ªãƒãƒ¼ãƒˆã¯é€ä¿¡åˆ¶é™ãŒã‚ã‚‹ãŸã‚ã€465ç•ªã‚’ç”¨ã„ã‚‹ã€‚ã“ã‚Œã«åˆã‚ã›ã¦ã€SESã‚‚å—ä¿¡ã§465ç•ªãƒãƒ¼ãƒˆã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ Rule Sets ãƒ¡ãƒ¼ãƒ«ã®å—ä¿¡ã—ãŸãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦å®Ÿè¡Œã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã§ãã‚‹ã€‚ IP Address Filters ãƒ»Rule Sets è¨­å®šé …ç›® èª¬æ˜ Recipiet å—ä¿¡ã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã€ä½•ã®å®›å…ˆã®æ™‚ã«ã“ã‚Œã‚’è¨±å¯ã™ã‚‹ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ Actions å—ä¿¡ã‚’è¨±å¯ã—ãŸå¾Œã«ã€ã“ã‚Œã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦å®Ÿè¡Œã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ ä»•æ§˜ä¸Šã®åˆ¶ç´„ ãƒ»æ§‹ç¯‰ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®åˆ¶ç´„ SESã¯é€£æºã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã¨åŒã˜ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«æ§‹ç¯‰ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ ãƒ»Sandboxãƒ¢ãƒ¼ãƒ‰ã®è§£é™¤ SESã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯Sandboxãƒ¢ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã‚‹ã€‚Sandboxãƒ¢ãƒ¼ãƒ‰ã§ã¯ä»¥ä¸‹ã®åˆ¶é™ãŒã‹ã‹ã£ã¦ãŠã‚Šã€‚ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼ã«è§£é™¤ç”³è«‹ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ åˆ¶é™ èª¬æ˜ é€ä¿¡åˆ¶é™ SESã§èªè¨¼ã—ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã¿ã«é€ä¿¡ã§ãã‚‹ã€‚ å—ä¿¡åˆ¶é™ 1æ—¥ã«200ãƒ¡ãƒ¼ãƒ«ã®ã¿å—ä¿¡ã§ãã‚‹ã€‚ SMTP-AUTH ãƒ»AWSã«ãŠã‘ã‚‹SMTP-AUTHã®ä»•çµ„ã¿ ä¸€èˆ¬çš„ãªSMTP-AUTHã§ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¦ãƒ¼ã‚¶ã®èªè¨¼ãŒå¿…è¦ã§ã‚ã‚‹ã€‚åŒæ§˜ã«ã—ã¦ã€AWSã«ãŠã„ã¦ã‚‚ã“ã‚ŒãŒå¿…è¦ã§ã‚ã‚Šã€IAMãƒ¦ãƒ¼ã‚¶ã‚’ç”¨ã„ã¦ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ã€‚é€ä¿¡å…ƒã¨ãªã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«IAMãƒ¦ãƒ¼ã‚¶ã‚’ç´ä»˜ã‘ã€ã“ã®IAMãƒ¦ãƒ¼ã‚¶ã«ã¯ãƒ¦ãƒ¼ã‚¶åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒSESã‚’ä»‹ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹æ™‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ã€SESãŒãƒ¦ãƒ¼ã‚¶åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸèªè¨¼ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¾Œã‹ã‚‰ç¢ºèªã§ããªã„ãŸã‚ã€ãƒ¡ãƒ¢ã—ã¦ãŠãã“ã¨ã€‚SMTP-AUTHã®ä»•çµ„ã¿ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhhttps://hiroki-it.github.io/tech-notebook-gitbook/public/network/network_osi_tcp_model.html?h=smtp 28. SNSï¼šSimple Notification Service SNSã¨ã¯ ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ã‹ã‚‰ç™ºä¿¡ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§å—ä¿¡ã—ã€ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒãƒ¼ã«è»¢é€ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã€‚ è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ ãƒˆãƒ”ãƒƒã‚¯ è¤‡æ•°ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãŸã‚‚ã®ã€‚ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§å—ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç¨®é¡ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ãƒˆãƒ”ãƒƒã‚¯ è¨­å®šé …ç›® èª¬æ˜ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç™»éŒ²ã™ã‚‹ã€‚ ã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼ ãƒˆãƒ”ãƒƒã‚¯ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’è¨­å®šã™ã‚‹ã€‚ é…ä¿¡å†è©¦è¡Œãƒãƒªã‚·ãƒ¼ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®HTTP/Sã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå¤±æ•—ã—ãŸæ™‚ã®ãƒªãƒˆãƒ©ã‚¤æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/sns/latest/dg/sns-message-delivery-retries.html é…ä¿¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ­ã‚°è¨˜éŒ² ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã¸ã®ç™ºä¿¡ã®ãƒ­ã‚°ã‚’CloudWatchLogsã«è»¢é€ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚ æš—å·åŒ– ãƒ»ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç¨®é¡ è»¢é€å…ˆ è£œè¶³ Kinesis Data Firehose Kinesis Data Firehose SQS SQS Lambda Lambda Eãƒ¡ãƒ¼ãƒ« ä»»æ„ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ HTTP/S ä»»æ„ã®ãƒ‰ãƒ¡ã‚¤ãƒ³å Chatbotã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã¯ã€https://global.sns-api.chatbot.amazonaws.comã€ JSONå½¢å¼ã®ãƒ¡ãƒ¼ãƒ« ä»»æ„ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ SMS SMS å—ä¿¡è€…ã®é›»è©±ç•ªå·ã‚’è¨­å®šã™ã‚‹ã€‚ 29. SQSï¼šSimple Queue Service SQSã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã¨ã—ã¦åƒãã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ãŒé€ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ä¸€æ—¦SQSã«è¿½åŠ ã•ã‚Œã‚‹ã€‚ãã®å¾Œã€ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒãƒ¼ã¯ã€SQSã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–ã‚Šå‡ºã™ã€‚ç•°ãªã‚‹VPCé–“ã§ã‚‚ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã‚’åŒæœŸã§ãã‚‹ã€‚ è¨­å®šé …ç›® ãƒ»SQSã®ç¨®é¡ è¨­å®šé …ç›® èª¬æ˜ ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰æ–¹å¼ ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒãƒ¼ã®å–å¾—ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾…ãŸãšã«ã€æ¬¡ã®ã‚­ãƒ¥ãƒ¼ã‚’éåŒæœŸçš„ã«è»¢é€ã™ã‚‹ã€‚ FIFOæ–¹å¼ ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒãƒ¼ã®å–å¾—ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾…ã¡ã€ã‚­ãƒ¥ãƒ¼ã‚’åŒæœŸçš„ã«è»¢é€ã™ã‚‹ã€‚ CLI ãƒ»ã‚­ãƒ¥ãƒ¼URLã‚’å–å¾— ã‚­ãƒ¥ãƒ¼ã®URLã‚’å–å¾—ã™ã‚‹ã€‚ $ aws sqs get-queue-url --queue-name ãƒ»ã‚­ãƒ¥ãƒ¼ã«å—ä¿¡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ ã‚­ãƒ¥ãƒ¼ã«å—ä¿¡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã™ã‚‹ã€‚ $ SQS_QUEUE_URL=$(aws sqs get-queue-url --queue-name ) $ aws sqs receive-message --queue-url ${SQS_QUEUE_URL} ã‚­ãƒ¥ãƒ¼ã«å—ä¿¡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã™ã‚‹ã€‚ã¾ãŸã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã™ã€‚ $ SQS_QUEUE_URL=$(aws sqs get-queue-url --queue-name ) $ aws sqs receive-message --queue-url ${SQS_QUEUE_URL} > receiveOutput.json { \"Messages\": [ { \"Body\": \"\", \"ReceiptHandle\": \"AQEBUo4y+XVuRSe4jMv0QM6Ob1viUnPbZ64WI01+Kmj6erhv192m80m+wgyob+zBgL4OMT+bps4KR/q5WK+W3tnno6cCFuwKGRM4OQGM9omMkK1F+ZwBC49hbl7UlzqAqcSrHfxyDo5x+xEyrEyL+sFK2MxNV6d0mF+7WxXTboyAu7JxIiKLG6cUlkhWfk3W4/Kghagy5erwRhwTaKtmF+7hw3Y99b55JLFTrZjW+/Jrq9awLCedce0kBQ3d2+7pnlpEcoY42+7T1dRI2s7um+nj5TIUpx2oSd9BWBHCjd8UQjmyye645asrWMAl1VCvHZrHRIG/v3vgq776e1mmi9pGxN96IW1aDZCQ1CSeqTFASe4=\", \"MD5OfBody\": \"6699d5711c044a109a6aff9fc193aada\", \"MessageId\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" } ] } 30. STSï¼šSecurity Token Service STSã¨ã¯ AWSãƒªã‚½ãƒ¼ã‚¹ã«ä¸€æ™‚çš„ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹èªè¨¼æƒ…å ±ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã‚’ç™ºè¡Œã™ã‚‹ã€‚ã“ã®èªè¨¼æƒ…å ±ã¯ã€ä¸€æ™‚çš„ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ STSã®è¨­å®šæ‰‹é † 1. IAMãƒ­ãƒ¼ãƒ«ã«ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒ å¿…è¦ãªãƒãƒªã‚·ãƒ¼ãŒè¨­å®šã•ã‚ŒãŸIAMãƒ­ãƒ¼ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ãã®æ™‚ã€ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã«ãŠã„ã¦ã€ãƒ¦ãƒ¼ã‚¶ã®ARNã‚’ä¿¡é ¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã—ã¦è¨­å®šã—ã¦ãŠãã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãã®ãƒ¦ãƒ¼ã‚¶ã«å¯¾ã—ã¦ã€ãƒ­ãƒ¼ãƒ«ã‚’ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"arn:aws:iam:::user/\" }, \"Action\": \"sts:AssumeRole\", \"Condition\": { \"StringEquals\": { \"sts:ExternalId\": \"\" } } } ] } 2. ãƒ­ãƒ¼ãƒ«ã‚’å¼•ãå—ã‘ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ä¿¡é ¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆãƒ¦ãƒ¼ã‚¶ï¼‰ã‹ã‚‰ã€STSï¼ˆhttps://sts.amazonaws.comï¼‰ã«å¯¾ã—ã¦ã€ãƒ­ãƒ¼ãƒ«ã®ã‚¢ã‚¿ãƒƒãƒã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã€‚ #!/bin/bash set -xeuo pipefail set -u # äº‹å‰ã«ç’°å¢ƒå¤‰æ•°ã«ã‚¤ãƒ³ãƒ•ãƒ©ç’°å¢ƒåã‚’ä»£å…¥ã™ã‚‹ã€‚ case $ENV in \"test\") aws_account_id=\"\" aws_access_key_id=\"\" aws_secret_access_key=\"\" aws_iam_role_external_id=\"\" ;; \"stg\") aws_account_id=\"\" aws_access_key_id=\"\" aws_secret_access_key=\"\" aws_iam_role_external_id=\"\" ;; \"prd\") aws_account_id=\"\" aws_access_key_id=\"\" aws_secret_access_key=\"\" aws_iam_role_external_id=\"\" ;; *) echo \"The parameter ${ENV} is invalid.\" exit 1 ;; esac # ä¿¡é ¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’è¨­å®šã™ã‚‹ã€‚ aws configure set aws_access_key_id \"$aws_account_id\" aws configure set aws_secret_access_key \"$aws_secret_access_key\" aws configure set aws_default_region \"ap-northeast-1\" # https://sts.amazonaws.com ã«ã€ãƒ­ãƒ¼ãƒ«ã®ã‚¢ã‚¿ãƒƒãƒã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã€‚ aws_sts_credentials=\"$(aws sts assume-role \\ --role-arn \"arn:aws:iam::${aws_access_key_id}:role/${ENV}-\" \\ --role-session-name \"\" \\ --external-id \"$aws_iam_role_external_id\" \\ --duration-seconds \"\" \\ --query \"Credentials\" \\ --output \"json\")\" STSã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®çµæœã€ãƒ­ãƒ¼ãƒ«ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸæ–°ã—ã„IAMãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã§ãã‚‹ã€‚ã“ã®æƒ…å ±ã«ã¯æœ‰åŠ¹ç§’æ•°ãŒå­˜åœ¨ã—ã€æœŸé™ãŒéãã‚‹ã¨æ–°ã—ã„IAMãƒ¦ãƒ¼ã‚¶ã«ãªã‚‹ã€‚ç§’æ•°ã®æœ€å¤§å€¤ã¯ã€è©²å½“ã™ã‚‹IAMãƒ­ãƒ¼ãƒ«ã®æ¦‚è¦ã®æœ€å¤§ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“ã‹ã‚‰å¤‰æ›´ã§ãã‚‹ã€‚ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚ { \"AssumeRoleUser\": { \"AssumedRoleId\": \":\", \"Arn\": \"arn:aws:sts::assumed-role//\" }, \"Credentials\": { \"SecretAccessKey\": \"\", \"SessionToken\": \"\", \"Expiration\": \"\", \"AccessKeyId\": \"\" } } 3-1. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—ï¼ˆï¼‘ï¼‰ jqã‚’ç”¨ã„ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸJSONãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦å‡ºåŠ›ã—ã€ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚ã‚‹ã„ã¯ã€AWSã®credentialsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://stedolan.github.io/jq/ #!/bin/bash cat assumed_user.sh export AWS_ACCESS_KEY_ID=\"$(echo \"$aws_sts_credentials\" | jq -r \".AccessKeyId\")\" export AWS_SECRET_ACCESS_KEY=\"$(echo \"$aws_sts_credentials\" | jq -r \".SecretAccessKey\")\" export AWS_SESSION_TOKEN=\"$(echo \"$aws_sts_credentials\" | jq -r \".SessionToken\")\" export AWS_ACCOUNT_ID=\"$aws_account_id\" export AWS_DEFAULT_REGION=\"ap-northeast-1\" EOF 3-2. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—ï¼ˆï¼’ï¼‰ jqã‚’ç”¨ã„ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸJSONãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã€‚ãƒ­ãƒ¼ãƒ«ã‚’å¼•ãå—ã‘ãŸæ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æƒ…å ±ã‚’ã€credentialsãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€ã€‚ #!/bin/bash aws configure --profile ${ENV}-repository > ~/.aws/credentials 4. æ¥ç¶šç¢ºèª ãƒ­ãƒ¼ãƒ«ã‚’å¼•ãå—ã‘ãŸæ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã€AWSãƒªã‚½ãƒ¼ã‚¹ã«æ¥ç¶šã§ãã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã®å–å¾—æ–¹æ³•ã¨ã—ã¦credentialsãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã‚’é¸ã‚“ã å ´åˆã€profileã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ #!/bin/bash # 3-2ã‚’é¸ã‚“ã å ´åˆã€credentialsãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå¿…è¦ãŒã‚ã‚‹ã€‚ aws s3 ls --profile 2020-xx-xx xx:xx:xx 31. Step Functions Step Functionsã¨ã¯ AWSã‚µãƒ¼ãƒ“ã‚¹ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã§ãã‚‹ã€‚ AWSãƒªã‚½ãƒ¼ã‚¹ã®APIã‚³ãƒ¼ãƒ« ãƒ»APIã‚³ãƒ¼ãƒ«ã§ãã‚‹ãƒªã‚½ãƒ¼ã‚¹ å‚è€ƒï¼šhttps://docs.aws.amazon.com/step-functions/latest/dg/connect-supported-services.html ãƒ»Lambda ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"StartAt\": \"Call Lambda\", \"States\": { \"Call Lambda\": { \"Type\": \"Task\", \"Resource\": \"arn:aws:states:::lambda:invoke.waitForTaskToken\", \"Parameters\": { \"FunctionName\": \"arn:aws:lambda:ap-northeast-1:xxxxx:foo-function:1\" }, \"Retry\": [ { \"ErrorEquals\": [ \"\" ], \"MaxAttempts\": 0 } ], \"End\": true, \"Comment\": \"The state that call Lambda\" } } } 32. VPCï¼šVirtual Private Cloud VPCã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã—ã¦åƒãã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸã€VPCã¨å‘¼ã°ã‚Œã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä»®æƒ³çš„ã«æ§‹ç¯‰ã§ãã‚‹ã€‚ç•°ãªã‚‹Availability Zoneã«æ¸¡ã£ã¦EC2ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒã‚’ãƒ‡ãƒ¥ã‚¢ãƒ«åŒ–ã™ã‚‹ã“ã¨ã§ãã‚‹ã€‚VPCã®ãƒ‘ã‚±ãƒƒãƒˆé€šä¿¡ã®ä»•çµ„ã¿ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://pages.awscloud.com/rs/112-TZM-766/images/AWS-08_AWS_Summit_Online_2020_NET01.pdf Internet Gatewayã€NAT Gateway ãƒ»Internet Gatewayã¨ã¯ VPCã®å‡ºå…¥ã‚Šå£ã«è¨­ç½®ã•ã‚Œã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ï¼ˆã“ã“ã§ã¯VPCï¼‰ã«ãŠã‘ã‚‹NATï¼ˆé™çš„NATï¼‰ã®æ©Ÿèƒ½ã‚’æŒã¤ã€‚ä¸€ã¤ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã«å¯¾ã—ã¦ã€ä¸€ã¤ã®EC2ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚NATï¼ˆé™çš„NATï¼‰ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhhttps://hiroki-it.github.io/tech-notebook-gitbook/public/network/network_osi_tcp_model.html ãƒ»NAT Gatewayã¨ã¯ NAPTï¼ˆå‹•çš„NATï¼‰ã®æ©Ÿèƒ½ã‚’æŒã¤ã€‚ä¸€ã¤ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã«å¯¾ã—ã¦ã€è¤‡æ•°ã®EC2ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã«ç½®ãã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®EC2ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘ä»˜ã‘ã‚‹ã€‚NAPTï¼ˆå‹•çš„NATï¼‰ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhhttps://hiroki-it.github.io/tech-notebook-gitbook/public/network/network_osi_tcp_model.html ãƒ»æ¯”è¼ƒè¡¨ Internet Gateway NAT Gateway æ©Ÿèƒ½ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ï¼ˆã“ã“ã§ã¯VPCï¼‰ã«ãŠã‘ã‚‹NATï¼ˆé™çš„NATï¼‰ NAPTï¼ˆå‹•çš„NATï¼‰ è¨­ç½®å ´æ‰€ VPCä¸Š ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆå†… Route Tableï¼ˆ= ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ ãƒ»ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ«ãƒ¼ã‚¿ã®ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦åƒãã€‚ãƒ«ãƒ¼ã‚¿ã«ã¤ã„ã¦ã¯ã€åˆ¥ãƒãƒ¼ãƒˆã®NATã¨NAPTã‚’å‚è€ƒã«ã›ã‚ˆã€‚ Destinationï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã®ç¯„å›²ï¼‰ Target xx.x.x.x/xx Destinationã®ç¯„å›²å†…ã ã£ãŸå ´åˆã®é€ä¿¡å…ˆ ãƒ»ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®ç¨®é¡ ç¨®é¡ èª¬æ˜ ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ« VPCã®æ§‹ç¯‰æ™‚ã«è‡ªå‹•ã§æ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ã©ã®ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚ç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ãªã„ã‚µãƒ–ãƒãƒƒãƒˆã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ« ç‰¹å®šã®ã‚µãƒ–ãƒãƒƒãƒˆã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»ä¾‹1 ä¸Šã®å›³ä¸­ã§ã€ã‚µãƒ–ãƒãƒƒãƒˆ2ã«ã¯ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«1ãŒç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ã‚µãƒ–ãƒãƒƒãƒˆ2å†…ã®EC2ã®é€ä¿¡å…ˆã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã€10.0.0.0/16ã®ç¯„å›²å†…ã«ã‚ã‚Œã°ã€ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã¨è¦‹ãªã—ã€localï¼ˆVPCå†…ã®ä»–ã‚µãƒ–ãƒãƒƒãƒˆï¼‰ã‚’é€ä¿¡å…ˆã«é¸ã³ã€ç¯„å›²å¤–ã«ã‚ã‚Œã°é€šä¿¡ã‚’ç ´æ£„ã™ã‚‹ã€‚ Destinationï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ï¼‰ Target 10.0.0.0/16 local æŒ‡å®šç¯„å›²ä»¥å¤–ã®å ´åˆ é€šä¿¡ç ´æ£„ ãƒ»ä¾‹2 ä¸Šã®å›³ä¸­ã§ã€ã‚µãƒ–ãƒãƒƒãƒˆ3ã«ã¯ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«2ãŒç´ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ã‚µãƒ–ãƒãƒƒãƒˆ3å†…ã®EC2ã®é€ä¿¡å…ˆã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã€10.0.0.0/16ã®ç¯„å›²å†…ã«ã‚ã‚Œã°ã€ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã¨è¦‹ãªã—ã€localï¼ˆVPCå†…ã®ä»–ã‚µãƒ–ãƒãƒƒãƒˆï¼‰ã‚’é€ä¿¡å…ˆã«é¸ã³ã€0.0.0.0/0ï¼ˆlocalä»¥å¤–ã®å…¨IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã®ç¯„å›²å†…ã«ã‚ã‚Œã°ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã¨è¦‹ãªã—ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’é€ä¿¡å…ˆã«é¸ã¶ã€‚ Destinationï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ï¼‰ Target 10.0.0.0/16 local 0.0.0.0/0 Internet Gateway Network ACLï¼šNetwork Access Control List ãƒ»Network ACLã¨ã¯ ã‚µãƒ–ãƒãƒƒãƒˆã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‘ã‚±ãƒƒãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‹ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨ã—ã¦åƒãã€‚ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã‚µãƒ–ãƒãƒƒãƒˆã®é–“ã«è¨­ç½®ã•ã‚Œã€åŒæ–¹å‘ã®ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ«ã¨ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ«ã‚’æ±ºå®šã™ã‚‹ã€‚ ãƒ»ACLãƒ«ãƒ¼ãƒ« ãƒ«ãƒ¼ãƒ«ã¯ä¸Šã‹ã‚‰é †ã«é©ç”¨ã•ã‚Œã‚‹ã€‚ä¾‹ãˆã°ã€ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ«ãŒä»¥ä¸‹ã ã£ãŸå ´åˆã€ãƒ«ãƒ¼ãƒ«100ãŒæœ€åˆã«é©ç”¨ã•ã‚Œã€ã‚µãƒ–ãƒãƒƒãƒˆã«å¯¾ã™ã‚‹ã€å…¨IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆ0.0.0.0/0ï¼‰ã‹ã‚‰ã®ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã‚’è¨±å¯ã—ã¦ã„ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ ãƒ«ãƒ¼ãƒ« # ã‚¿ã‚¤ãƒ— ãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ãƒˆç¯„å›² / ICMP ã‚¿ã‚¤ãƒ— ã‚½ãƒ¼ã‚¹ è¨±å¯ / æ‹’å¦ 100 ã™ã¹ã¦ã® ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ ã™ã¹ã¦ ã™ã¹ã¦ 0.0.0.0/0 ALLOW * ã™ã¹ã¦ã® ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ ã™ã¹ã¦ ã™ã¹ã¦ 0.0.0.0/0 DENY VPCã‚µãƒ–ãƒãƒƒãƒˆ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ãŠã‘ã‚‹ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¨ã—ã¦åƒãã€‚ ãƒ»ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¨ã¯ éæ­¦è£…åœ°å¸¯ã«ç›¸å½“ã™ã‚‹ã€‚æ”»æ’ƒã®å½±éŸ¿ãŒå†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«åºƒãŒã‚‹å¯èƒ½æ€§ã‚’é˜²ããŸã‚ã«ã€å¤–éƒ¨ã‹ã‚‰ç›´æ¥ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ã‚‹ã€ ãƒ»ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã¨ã¯ å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ç›¸å½“ã™ã‚‹ã€‚å¤–éƒ¨ã‹ã‚‰ç›´æ¥ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ãšã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã›ã‚‹ã‚ˆã†ã«ã€å†…ã®NATã‚’çµŒç”±ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»ã‚µãƒ–ãƒãƒƒãƒˆã®ç¨®é¡ ã‚µãƒ–ãƒãƒƒãƒˆã«ã¯ã€å½¹å‰²ã”ã¨ã«ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚‹ã€‚ åå‰ å½¹å‰² Public subnet (Frontend Subnet) NATGatewayã‚’é…ç½®ã™ã‚‹ã€‚ Private app subnet ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€Nginxãªã©ã‚’é…ç½®ã™ã‚‹ã€‚ Private datastore subnet RDSã€Redisãªã©ã‚’é…ç½®ã™ã‚‹ VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ãƒ»æ¦‚è¦ VPCã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆå†…ã®ãƒªã‚½ãƒ¼ã‚¹ãŒã€VPCå¤–ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚Gatewayå‹ã¨Interfaceå‹ãŒã‚ã‚‹ã€‚VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆå†…ã‹ã‚‰ã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰é€šä¿¡ã«ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¨NAT Gatewayã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šä¾‹ï¼Š ECS Fargateã‚’ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«ç½®ã„ãŸå ´åˆã€ECS Fargateã‹ã‚‰VPCå¤–ã«ã‚ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªé€šä¿¡ã®ãŸã‚ã«å¿…è¦ã€‚ï¼ˆä¾‹ï¼šCloudWatchãƒ­ã‚°ã€ECRã€S3ã€SSMï¼‰ ãƒ»ãƒ¡ãƒªãƒƒãƒˆ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¨NAT Gatewayã®ä»£ã‚ã‚Šã«ã€VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç”¨ã„ã‚‹ã¨ã€æ–™é‡‘ãŒå°‘ã—ã ã‘å®‰ããªã‚Šã€ã¾ãŸã€VPCå¤–ã®ãƒªã‚½ãƒ¼ã‚¹ã¨ã®é€šä¿¡ãŒã‚ˆã‚Šå®‰å…¨ã«ãªã‚‹ã€‚ ãƒ»ã‚¿ã‚¤ãƒ— ã‚¿ã‚¤ãƒ— èª¬æ˜ ãƒªã‚½ãƒ¼ã‚¹ä¾‹ Interfaceå‹ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒ³ã‚¯ã¨ã‚‚ã„ã†ã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã¤ENIã¨ã—ã¦æ©Ÿèƒ½ã—ã€AWSãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªé€šä¿¡ã‚’å—ä¿¡ã™ã‚‹ã€‚ S3ã€DynamoDBä»¥å¤–ã®å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ Gatewayå‹ ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹å®šç¾©ã«å¾“ã†ã€‚VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦æ©Ÿèƒ½ã—ã€AWSãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªé€šä¿¡ã‚’å—ä¿¡ã™ã‚‹ã€‚ S3ã€DynamoDBã®ã¿ ENIï¼šElastic Network Interface ãƒ»ENIã¨ã¯ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã—ã¦åƒãã€‚ç‰©ç†ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ãŠã‘ã‚‹NICã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhhttps://hiroki-it.github.io/tech-notebook-gitbook/public/network/network_osi_tcp_model.html ãƒ»ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹ ãƒªã‚½ãƒ¼ã‚¹ã®ç¨®é¡ å½¹å‰² è£œè¶³ ALB ENIã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ALBã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ EC2 ENIã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒEC2ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/using-eni.html#eni-basics Fargateç’°å¢ƒã®EC2 æ˜è¨€ã•ã‚Œã¦ã„ãªã„ãŸã‚æ¨æ¸¬ã§ã¯ã‚ã‚‹ãŒã€ENIã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸlocalã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒFargateç’°å¢ƒã§ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ›ã‚¹ãƒˆã¨ãªã‚‹EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ Fargateç’°å¢ƒã®ãƒ›ã‚¹ãƒˆãŒEC2ã¨ã¯æ˜è¨€ã•ã‚Œã¦ã„ãªã„ã€‚å‚è€ƒï¼šhttps://aws.amazon.com/jp/blogs/news/under-the-hood-fargate-data-plane/ Elastic IP ENIã«Elastic IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ã“ã®ENIã‚’ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ã«ç´ä»˜ã‘ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ENIã‚’ä»‹ã—ã¦ã€Elastic IPã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/using-eni.html#managing-network-interface-ip-addresses GlobalAccelerator NAT Gateway ENIã«ç´ä»˜ã‘ã‚‰ã‚ŒãŸãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒNAT Gatewayã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ RDS Security Group ENIã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ãŒç´ä»˜ã‘ã‚Œã‚‹ã€‚ã“ã®ENIã‚’ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ã«ç´ä»˜ã‘ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ENIã‚’ä»‹ã—ã¦ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ Interfaceå‹ã®VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã€‚ IPã‚¢ãƒ‰ãƒ¬ã‚¹ ãƒ»ç¨®é¡ IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¨®é¡ èª¬æ˜ è‡ªå‹•å‰²ã‚Šå½“ã¦ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆå‹•çš„IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ å‹•çš„ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã€EC2ã®å†æ§‹ç¯‰å¾Œã«å¤‰åŒ–ã™ã‚‹ã€‚ Elastic IPï¼ˆé™çš„IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ é™çš„ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã€å†æ§‹ç¯‰å¾Œã‚‚ä¿æŒã•ã‚Œã‚‹ã€‚ ãƒ»ç´ä»˜ã‘ ç¨®é¡ è£œè¶³ EC2ã¨ã®ç´ä»˜ã‘ éæ¨å¥¨ã®æ–¹æ³•ã§ã‚ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/vpc-eips.html#vpc-eip-overview ENIã¨ã®ç´ä»˜ã‘ æ¨å¥¨ã•ã‚Œã‚‹æ–¹æ³•ã§ã‚ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/vpc-eips.html#vpc-eip-overview VPCã®CIDRè¨­è¨ˆã®æ‰‹é † ä¸€ã¤ã®VPCå†…ã«ã¯è¤‡æ•°ã®ã‚µãƒ–ãƒãƒƒãƒˆãŒå…¥ã‚‹ã€‚ãã®ãŸã‚ã€ã‚µãƒ–ãƒãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã¯ã€ã‚µãƒ–ãƒãƒƒãƒˆã®å€‹æ•°ã ã‘å«ã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã¾ãŸã€VPCãŒã‚‚ã¤IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‹ã‚‰ã€VPCå†…ã®å„AWSãƒªã‚½ãƒ¼ã‚¹ã«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã¦ã„ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚VPCå†…ã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ¯æ¸‡ã—ãªã„ã‚ˆã†ã«ã€ä»¥ä¸‹ã®æ‰‹é †ã§ã€å‰²ã‚Šå½“ã¦ã‚’è€ƒãˆã‚‹ã€‚ å‚è€ƒï¼šhttps://note.com/takashi_sakurada/n/n502fb0299938 ï¼ˆï¼‘ï¼‰RFC1918ã®æ¨å¥¨ã™ã‚‹10.0.0.0/8ã€172.16.0.0/12ã€192.168.0.0/16ã‚’ç”¨ã„ã‚‹ã€‚VPCã®CIDRè¨­è¨ˆã§ã¯ã€ã“ã‚Œã‚‰ã®ç¯„å›²ã«å«ã¾ã‚Œã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ RFC1918æ¨å¥¨ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›² IPã‚¢ãƒ‰ãƒ¬ã‚¹ å€‹æ•° 10.0.0.0/8 10.0.0.0 ~ 10.255.255.255 16777216 172.16.0.0/12 172.16.0.0 ~ 172.31.255.255 1048576 192.168.0.0/16 192.168.0.0 ~ 192.168.255.255 65536 ï¼ˆï¼’ï¼‰ã‚ã‚‰ã‹ã˜ã‚ã€ä¼šç¤¾å†…ã®å…¨ã¦ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®CIDRã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãªã©ã§ä¸€æ‹¬ã§ç®¡ç†ã—ã¦ãŠãã€‚ ï¼ˆï¼“ï¼‰å„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã§Transit Gatewayã‚„ãƒ”ã‚¢ãƒªãƒ³ã‚°æ¥ç¶šã‚’å®Ÿè¡Œã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã¯ã€‚æ‹¡å¼µæ€§ã‚’è€ƒæ…®ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã®CIDRã¯é‡ãªã‚‰ãªã„ã‚ˆã†ã«ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ä¾‹ãˆã°ã€ä»¥å‰ã«é–‹ç™ºã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ10.200.47.0ã¾ã§ã‚’ç”¨ã„ã¦ã„ãŸå ´åˆã€10.200.48.0ã‹ã‚‰ä½¿ç”¨ã‚’å§‹ã‚ã‚‹ã€‚ã¾ãŸã€VPCã§è¨±å¯ã•ã‚Œã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å€‹æ•°ã¯æœ€å¤š65536å€‹ï¼ˆ/16ï¼‰ã§æœ€å°‘16å€‹ï¼ˆ/28ï¼‰ã§ã‚ã‚Šã€å®Ÿéš›ã¯512å€‹ï¼ˆ/23ï¼‰ã»ã©ã‚ã‚Œã°å•é¡Œãªã„ãŸã‚ã€10.200.48.0/23ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/VPC_Subnets.html#SubnetRouting ï¼ˆï¼”ï¼‰VPCã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‚’å†—é•·åŒ–ã™ã‚‹å ´åˆã¯ã€VPCã®IPã‚¢ãƒ‰ãƒ¬ã‚¹æ•°ã‚’ã‚µãƒ–ãƒãƒƒãƒˆæ•°ã§å‰²ã£ã¦å„ã‚µãƒ–ãƒãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹æ•°ã‚’ç®—å‡ºã—ã€CIDRãƒ–ãƒ­ãƒƒã‚¯ã‚’è¨­å®šã™ã‚‹ã€‚ä¾‹ãˆã°ã€VPCã®ã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ã‚’/16 ã¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€å„ã‚µãƒ–ãƒãƒƒãƒˆã®ã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ã¯/24ã¨ã™ã‚‹ã€‚ä¸€æ–¹ã§ã€VPCã‚’/23ã¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€å„ã‚µãƒ–ãƒãƒƒãƒˆã¯/27ã¨ã™ã‚‹ã€‚ã¾ãŸã€å„ã‚µãƒ–ãƒãƒƒãƒˆã®CIDRãƒ–ãƒ­ãƒƒã‚¯ã‚’åŒã˜ã«ã™ã‚‹å¿…è¦ã¯ãªãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç¨¼åƒã™ã‚‹ã‚µãƒ–ãƒãƒƒãƒˆã«IPã‚¢ãƒ‰ãƒ¬ã‚¹æ•°ãŒã‚„ã‚„å¤šããªã‚‹ã‚ˆã†ã«ã—ã€ãã®åˆ†DBã®ç¨¼åƒã™ã‚‹ã‚µãƒ–ãƒãƒƒãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å°‘ãªãã™ã‚‹ã‚ˆã†ãªè¨­è¨ˆã§ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://d0.awsstatic.com/events/jp/2017/summit/slide/D2T3-5.pdf ï¼ˆï¼•ï¼‰VPCå†…ã®å„AWSãƒªã‚½ãƒ¼ã‚¹ã®ç‰¹å¾´ã«åˆã‚ã›ã¦ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ å‚è€ƒï¼šhttps://dev.classmethod.jp/articles/amazon-vpc-5-tips/ AWSã‚µãƒ¼ãƒ“ã‚¹ã®ç¨®é¡ æœ€ä½é™ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹æ•° ALB ALB1ã¤å½“ãŸã‚Šã€8å€‹ ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚° æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æ™‚ã®EC2æœ€å¤§æ•°ã¨åŒã˜å€‹æ•° VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ1ã¤å½“ãŸã‚Šã€1å€‹ ECSã€EKS Elastic Network Interface æ•°ã¨åŒã˜å€‹æ•° Lambda Elastic Network Interface æ•°ã¨åŒã˜å€‹æ•° 32-02. VPCé–“ã€VPC-ã‚ªãƒ³ãƒ—ãƒ¬é–“ã®é€šä¿¡ VPCãƒ”ã‚¢ãƒªãƒ³ã‚°æ¥ç¶š ãƒ»VPCãƒ”ã‚¢ãƒªãƒ³ã‚°æ¥ç¶šã¨ã¯ ã€ä¸€å¯¾ä¸€ã€ã®é–¢ä¿‚ã§ã€ã€ç•°ãªã‚‹VPCé–“ã€ã®åŒæ–¹å‘é€šä¿¡ã‚’å¯èƒ½ã«ã™ã‚‹ã€‚ ãƒ»VPCãƒ”ã‚¢ãƒªãƒ³ã‚°æ¥ç¶šã®å¯å¦ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ VPCã®ã‚ã‚‹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ VPCå†…ã®CIDRãƒ–ãƒ­ãƒƒã‚¯ æ¥ç¶šã®å¯å¦ åŒã˜ï¼ç•°ãªã‚‹ åŒã˜ï¼ç•°ãªã‚‹ å…¨ã¦ç•°ãªã‚‹ ã€‡ åŒã˜ã‚‚ã®ãŒä¸€ã¤ã§ã‚‚ã‚ã‚‹ âœ• VPC ã«è¤‡æ•°ã® IPv4 CIDR ãƒ–ãƒ­ãƒƒã‚¯ãŒã‚ã‚Šã€ä¸€ã¤ã§ã‚‚ åŒã˜CIDR ãƒ–ãƒ­ãƒƒã‚¯ãŒã‚ã‚‹å ´åˆã¯ã€VPC ãƒ”ã‚¢ãƒªãƒ³ã‚°æ¥ç¶šã¯ã§ããªã„ã€‚ ãŸã¨ãˆã€IPv6ãŒç•°ãªã£ã¦ã„ã¦ã‚‚ã€åŒæ§˜ã§ã‚ã‚‹ã€‚ VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ ãƒ»VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã¨ã¯ VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã¯ç•°ãªã‚‹æ©Ÿèƒ½ãªã®ã§æ³¨æ„ã€‚Interfaceå‹ã®VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒ³ã‚¯ï¼‰ã‚’NLBã«ç´ä»˜ã‘ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã€ä¸€å¯¾å¤šã€ã®é–¢ä¿‚ã§ã€ã€ç•°ãªã‚‹VPCé–“ã€ã®åŒæ–¹å‘é€šä¿¡ã‚’å¯èƒ½ã«ã™ã‚‹ã€‚ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã‚µãƒ¼ãƒ“ã‚¹åã¯ã€ã€com.amazonaws.vpce.ap-northeast-1.vpce-svc-xxxxxã€ã«ãªã‚‹ã€‚API Gatewayã®VPCãƒªãƒ³ã‚¯ã¯ã€VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã«ç›¸å½“ã™ã‚‹ã€‚ Transit Gateway ãƒ»Transit Gatewayã¨ã¯ ã€å¤šå¯¾å¤šã€ã®é–¢ä¿‚ã§ã€ã€ç•°ãªã‚‹VPCé–“ã€ã‚„ã€ã‚ªãƒ³ãƒ—ãƒ¬-VPCé–“ã€ã®åŒæ–¹å‘é€šä¿¡ã‚’å¯èƒ½ã«ã™ã‚‹ã€‚ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ«ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦åƒãã€‚ å„ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®æ¯”è¼ƒ æ©Ÿèƒ½ VPCãƒ”ã‚¢ãƒªãƒ³ã‚°æ¥ç¶š VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ Transit gateway é€šä¿¡å¯èƒ½ãªVPCæ•° ä¸€å¯¾ä¸€ ä¸€å¯¾ä¸€ã€ä¸€å¯¾å¤š ä¸€å¯¾ä¸€ã€ä¸€å¯¾å¤šã€å¤šå¯¾å¤š é€šä¿¡å¯èƒ½ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¨®é¡ IPv4ã€IPv6 IPv4 IPv4ã€IPv6 æ¥ç¶šå¯èƒ½ãªãƒªã‚½ãƒ¼ã‚¹ åˆ¶é™ãªã— NLBã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ãã‚‹ãƒªã‚½ãƒ¼ã‚¹ã®ã¿ åˆ¶é™ãªã— CIDRãƒ–ãƒ­ãƒƒã‚¯ãŒVPCé–“ã§è¢«ã‚‹ã“ã¨ã«ã‚ˆã‚‹é€šä¿¡ã®å¯å¦ Ã— â—¯ Ã— ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ â—¯ â—¯ â—¯ ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ â—¯ Ã— â—¯ VPCé–“ â—¯ â—¯ â—¯ VPC-ã‚ªãƒ³ãƒ—ãƒ¬é–“ Ã— Ã— â—¯ 33. WAFï¼šWeb Applicarion Firewall è¨­å®šé …ç›® å®šç¾©ã§ãã‚‹ãƒ«ãƒ¼ãƒ«æ•°ã‚„æ–‡å­—æ•°ã«åˆ¶é™ãŒã‚ã‚‹ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/waf/latest/developerguide/limits.html è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Web ACLsï¼šWeb Access Control List å„ãƒˆãƒªã‚¬ãƒ¼ã¨è¨±å¯ï¼æ‹’å¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ç´ä»˜ã‘ã‚’ã€ãƒ«ãƒ¼ãƒ«ã€ã¨ã—ã€ã“ã‚Œã‚’ã‚»ãƒƒãƒˆã§è¨­å®šã™ã‚‹ã€‚ ã‚¢ã‚¿ãƒƒãƒã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã«åˆã‚ã›ã¦ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãŒç•°ãªã‚‹ã€‚ IP sets ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œã®ãƒˆãƒªã‚¬ãƒ¼ã¨ãªã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ ãƒ»è¨±å¯ã™ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã€æ„å‘³åˆã„ã«æ²¿ã£ã¦ç•°ãªã‚‹ã‚»ãƒƒãƒˆã¨ã—ã¦æ§‹ç¯‰ã™ã‚‹ã¹ãã€‚ä¾‹ãˆã°ã€ç¤¾å†…IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚»ãƒƒãƒˆã€å”åŠ›ä¼šç¤¾IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚»ãƒƒãƒˆã€ãªã©ãƒ»æ‹’å¦ã™ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã²ã¨ã¾ã¨ã‚ã«ã—ã¦ã‚‚ã‚ˆã„ã€‚ Regex pattern sets ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œã®ãƒˆãƒªã‚¬ãƒ¼ã¨ãªã‚‹URLãƒ‘ã‚¹ã®æ–‡å­—åˆ— ãƒ»è¨±å¯ï¼æ‹’å¦ã™ã‚‹æ–‡å­—åˆ—ã¯ã€æ„å‘³åˆã„ã«æ²¿ã£ã¦ç•°ãªã‚‹æ–‡å­—åˆ—ã‚»ãƒƒãƒˆã¨ã—ã¦æ§‹ç¯‰ã™ã‚‹ã¹ãã€‚ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚»ãƒƒãƒˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ã‚¹ã‚»ãƒƒãƒˆã€ãªã© Rule groups AWS Markets AWSãƒªã‚½ãƒ¼ã‚¹ vs. ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒ ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒã®ç¨®é¡ å¯¾æŠ—ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã®ç¨®é¡ ãƒãƒ«ã‚¦ã‚§ã‚¢ ãªã— å‚å—ã€ç›—è´ VPCå†…ã®ç‰¹ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆé–“ã®ãƒ”ã‚¢ãƒªãƒ³ã‚°æ¥ç¶šã€‚VPCå¤–ã‚’ä»‹ã•ãšã«ãƒ‡ãƒ¼ã‚¿ã‚’é€å—ä¿¡ã§ãã‚‹ã€‚ ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒ³ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— DDoS Shield ã‚¼ãƒ­ãƒ‡ã‚£ WAF ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ WAF XSS WAF ãƒ‡ãƒ¼ã‚¿æ¼æ´© KMSã€CloudHSM çµ„ç¹”å†…éƒ¨ã§ã®è£åˆ‡ã‚Š IAM è¨­å®šé …ç›® ãƒ»æ¦‚è¦ è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Web ACLs ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã¨æ‹’å¦ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ Bot Control Botã«é–¢ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã¨æ‹’å¦ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ IP Sets IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å…±é€šéƒ¨å“ã‚’ç®¡ç†ã™ã‚‹ã€‚ ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ãŸã„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚»ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹æ™‚ã€å…¨ã¦ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä¸€ã¤ã®ã‚»ãƒƒãƒˆã§ç®¡ç†ã—ã¦ã—ã¾ã†ã¨ã€ä½•ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚ã‚‰ãªã‚ããªã£ã¦ã—ã¾ã†ã€‚ãã“ã§ã€è¨±å¯ã™ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã‚»ãƒƒãƒˆã‚’ç¨®é¡ï¼ˆè‡ªç¤¾ã€å¤–éƒ¨ã®Aç¤¾ï¼Bç¤¾ã€ãªã©ï¼‰ã§åˆ†å‰²ã™ã‚‹ã¨ã‚ˆã„ã€‚ Regex pattern sets æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å…±é€šéƒ¨å“ã‚’ç®¡ç†ã™ã‚‹ã€‚ Rule groups ãƒ«ãƒ¼ãƒ«ã®å…±é€šéƒ¨å“ã‚’ç®¡ç†ã™ã‚‹ã€‚ å„WAFã«åŒã˜ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹å ´åˆã€ãƒ«ãƒ¼ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç”¨ã„ã‚‹ã¹ãã§ã‚ã‚‹ã€‚ãŸã ã€ãƒ«ãƒ¼ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç”¨ã„ã‚‹ã¨ã€ã“ã‚Œã‚‰ã®ãƒ«ãƒ¼ãƒ«ã‚’å…±é€šã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã§ç›£è¦–ã—ãªã‘ã‚Œã°ãªã‚‰ãªããªã‚‹ã€‚ãã®ãŸã‚ã€ã‚‚ã—ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åˆ†ã‘ã‚‹ã®ã§ã‚ã‚Œã°ã€ãƒ«ãƒ¼ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»Web ACLs è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Overview WAFã«ã‚ˆã£ã¦è¨±å¯ï¼æ‹’å¦ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ç¢ºèªã§ãã‚‹ã€‚ Rules é †ç•ªã«ãƒ«ãƒ¼ãƒ«ã‚’åˆ¤å®šã—ã€ä¸€è‡´ã™ã‚‹ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Œã°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã“ã®æ™‚ã€ä¸€è‡´ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã®å¾Œã«ã‚ã‚‹ãƒ«ãƒ¼ãƒ«ã¯ã€‚åˆ¤å®šã•ã‚Œãªã„ã€‚ AWSãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/waf/latest/developerguide/aws-managed-rule-groups-list.html Associated AWS resources WAFã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ CloudFrontã€ALBãªã©ã«ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã€‚ Logging and metrics ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’Kinesis Data Firehoseã«å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚ ãƒ»Overviewã«ãŠã‘ã‚‹Sampled requestsã®è¦‹æ–¹ ã€å…¨ã¦ã®ãƒ«ãƒ¼ãƒ«ã€ã¾ãŸã¯ã€å€‹åˆ¥ã®ãƒ«ãƒ¼ãƒ«ã€ã«ãŠã‘ã‚‹ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ï¼æ‹’å¦ã®å±¥æ­´ã‚’ç¢ºèªã§ãã‚‹ã€‚ALBã‚„CloudFrontã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚ˆã‚Šã‚‚è§£ã‚Šã‚„ã™ãã€æ§˜ã€…ãªãƒ‡ãƒãƒƒã‚°ã«å½¹ç«‹ã¤ã€‚ãŸã ã—ã€ï¼“æ™‚é–“åˆ†ã—ã‹æ®‹ã‚‰ãªã„ã€‚ä¸€ä¾‹ã¨ã—ã¦ã€CloudFrontã«ã‚¢ã‚¿ãƒƒãƒã—ãŸWAFã§å–å¾—ã§ãã‚‹ãƒ­ã‚°ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ GET /foo/ # ãƒ›ã‚¹ãƒˆ Host: example.jp Upgrade-Insecure-Requests: 1 # ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document # CORSã§ã‚ã‚‹ã‹å¦ã‹ Sec-Fetch-Site: same-origin Accept-Encoding: gzip, deflate, br Accept-Language: ja,en;q=0.9 # Cookieãƒ˜ãƒƒãƒ€ãƒ¼ Cookie: sessionid=; _gid=; __ulfpc=; _ga= ãƒ«ãƒ¼ãƒ« ãƒ»ãƒ«ãƒ¼ãƒ«ã®ç¨®é¡ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/waf/latest/developerguide/classic-web-acl-rules-creating.html ç¨®é¡ èª¬æ˜ ãƒ¬ãƒ¼ãƒˆãƒ™ãƒ¼ã‚¹ åŒã˜é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®ï¼•åˆ†é–“å½“ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°åˆ¶é™ã‚’ãƒ«ãƒ¼ãƒ«ã«ä»˜ä¸ã™ã‚‹ã€‚ ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã¯åˆ¶é™ã—ãªã„ã€‚ ãƒ»ãƒ«ãƒ¼ãƒ«ã®ç²’åº¦ã®ã‚³ãƒ„ ã‚ã‹ã‚Šã‚„ã™ã•ã®è¦³ç‚¹ã‹ã‚‰ã€å¯èƒ½ãªé™ã‚Šè¨­å®šã™ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’å°‘ãªãã—ã€ä¸€ã¤ã®ãƒ«ãƒ¼ãƒ«ã«ä¸€ã¤ã®æ„å‘³åˆã„ã ã‘ã‚’æŒãŸã›ã‚‹ã‚ˆã†ã«å‘½åã™ã‚‹ã€‚ ãƒ»Countï¼ˆæ¤œçŸ¥ï¼‰ãƒ¢ãƒ¼ãƒ‰ ãƒ«ãƒ¼ãƒ«ã«è©²å½“ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚’æ•°ãˆã€è¨±å¯ï¼æ‹’å¦ã›ãšã«æ¬¡ã®ãƒ«ãƒ¼ãƒ«ã‚’æ¤œè¨¼ã™ã‚‹ã€‚è¨ˆæ¸¬çµæœã«å¿œã˜ã¦ã€Countãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹åŒ–ã—ã€æ‹’å¦ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://oji-cloud.net/2020/09/18/post-5501/ ãƒ»ãƒ«ãƒ¼ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸Šæ›¸ã ãƒ«ãƒ¼ãƒ«ã®Countãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹å ´åˆã€Countã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ç¶šã‘ã¦ã€ãã®ãƒ«ãƒ¼ãƒ«ã®å…ƒã€…ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãã®ãŸã‚ã€Countã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã—ã¤ã¤ã€Blockã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ï¼ˆä»•æ§˜ãŒã‚„ã‚„ã“ã—ã™ãã‚‹ã®ã§ã€ãªã‚“ã¨ã‹ã—ã¦ã»ã—ã„ï¼‰ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/waf/latest/developerguide/web-acl-rule-group-override-options.html ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã®å…ƒã€…ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ Countãƒ¢ãƒ¼ãƒ‰ ä¸Šæ›¸ãã‚ªãƒ—ã‚·ãƒ§ãƒ³ çµæœ Block ON ON Countã—ã€ãã®å¾ŒBlockãŒå®Ÿè¡Œã™ã‚‹ã€‚ãã®ãŸã‚ã€ãã®å¾Œã®ãƒ«ãƒ¼ãƒ«ã¯æ¤œè¨¼ã›ãšã«çµ‚äº†ã™ã‚‹ã€‚ Block ON OFF Countã®ã¿ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ãã®å¾Œã®ãƒ«ãƒ¼ãƒ«ã‚‚æ¤œè¨¼ã™ã‚‹ã€‚ Block OFF ON ãã‚‚ãã‚‚Countãƒ¢ãƒ¼ãƒ‰ãŒç„¡åŠ¹ãªãŸã‚ã€ä¸Šæ›¸ãã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ©Ÿèƒ½ã›ãšã«ã€BlockãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ Block OFF OFF ãã‚‚ãã‚‚Countãƒ¢ãƒ¼ãƒ‰ãŒç„¡åŠ¹ãªãŸã‚ã€ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã®BlockãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ï¼ˆã¨æ€ã£ã¦ã„ãŸãŒã€çµæœã¨ã—ã¦Countã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹æ¨¡æ§˜...ï¼‰ ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã‚’ç”¨ã„ã‚‹ã‹ã©ã†ã‹ã®åˆ¤æ–­åŸºæº– ãƒ»ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã®å‹•ä½œç¢ºèªã®å¿…è¦æ€§ ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã‚’å°å…¥ã™ã‚‹æ™‚ã¯ã€äº‹å‰ã«ãƒ«ãƒ¼ãƒ«ã®ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ã‚«ã‚¦ãƒ³ãƒˆã§æ¤œçŸ¥ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã»ã¨ã‚“ã©ãŒæ‚ªæ„ã®ãªã„ã‚‚ã®ã§ã‚ã‚Œã°ã€è¨­å®šã—ãŸãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã®ä½¿ç”¨ã‚’ã‚„ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é€ä¿¡å…ƒã¨ã—ãŸå ´åˆ ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é€ä¿¡å…ƒã¨ã—ãŸå ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚„ãƒœãƒ‡ã‚£ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€ã“ã‚Œã«åŸºã¥ã„ãŸåˆ¤æ–­ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆè‡ªä½“ãŒæ‚ªæ„åˆ¤å®šã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ ã‚µã‚¤ãƒˆã®URLã®è¨˜æ³•ã«ã‚ˆã£ã¦ã€æ‚ªæ„åˆ¤å®šã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ é€ä¿¡å…ƒã®å›½åãŒã€æ—¥æœ¬ã€ã§ã‚ã‚‹ã®ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€æ‚ªæ„åˆ¤å®šã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ ã‚µã‚¤ãƒˆã«é€ä¿¡ã•ã‚ŒãŸå…¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã†ã¡ã€ã‚«ã‚¦ãƒ³ãƒˆã§æ¤œçŸ¥ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ•°ãŒå¤šã™ããªã„ã‹ã©ã†ã‹ ãƒ»é€£æºã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€ä¿¡å…ƒã¨ã—ãŸå ´åˆ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€ä¿¡å…ƒã¨ã—ãŸå ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚„ãƒœãƒ‡ã‚£ã¯é€£æºã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€ã“ã‚Œã«åŸºã¥ã„ãŸåˆ¤æ–­ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ ãƒ«ãƒ¼ãƒ«ã®ä¾‹ ãƒ»ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ‹’å¦ ï¼Šä¾‹ï¼Š æ‚ªæ„ã®ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ‹’å¦ã™ã‚‹ã€‚ ãƒ«ãƒ¼ãƒ«ï¼šblock-user-agents Statementã®é †ç•ª If a request Inspect Match type Regex pattern set Then æŒ™å‹• 0 matches URI path Matches pattern from regex pattern set æ–‡å­—åˆ—ã‚»ãƒƒãƒˆ Block æŒ‡å®šã—ãŸæ–‡å­—åˆ—ã‚’å«ã‚€ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å ´åˆã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã€‚ Default Action èª¬æ˜ Allow æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ãªã„å ´åˆã€å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ ãƒ»CI/CDãƒ„ãƒ¼ãƒ«ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ ï¼Šä¾‹ï¼Š ç¤¾å†…ã®é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã¿è¨±å¯ã—ãŸçŠ¶æ…‹ã§ã€CircleCIãªã©ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒç¤¾å†…ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ«ãƒ¼ãƒ«ï¼šallow-request-including-access-token Statementã®é †ç•ª If a request Inspect Header field name Match type String to match Then æŒ™å‹• 0 matches Header authorization Exactly matched string ã€Bearer ã€ã§æ–‡å­—åˆ—ã‚’è¨­å®šã™ã‚‹ Allow authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã«æŒ‡å®šã—ãŸæ–‡å­—åˆ—ã‚’å«ã‚€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã€‚ Default Action èª¬æ˜ Block æ­£ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æŒãŸãªã„ã‚¢ã‚¯ã‚»ã‚¹ã®å ´åˆã€å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã€‚ ãƒ»ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¤¾å†…ã‚¢ã‚¯ã‚»ã‚¹ã«é™å®š ï¼Šä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ç‰¹å®šã®URLãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ç¤¾å†…ã ã‘ã«åˆ¶é™ã™ã‚‹ã€‚äºŒã¤ã®ãƒ«ãƒ¼ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ«ãƒ¼ãƒ«ï¼šallow-access--to-url-path Statementã®é †ç•ª If a request Inspect IP set Match type Regex pattern set Then æŒ™å‹• 0 matches (AND) Originates from an IP address in ç¤¾å†…IPã‚»ãƒƒãƒˆ - - - ç¤¾å†…ã®é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å ´åˆã€æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ 1 matches URI path - Matches pattern from regex pattern set æ–‡å­—åˆ—ã‚»ãƒƒãƒˆ Allow 0ç•ªç›®ã‹ã¤ã€æŒ‡å®šã—ãŸæ–‡å­—åˆ—ã‚’å«ã‚€URLãƒ‘ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã®å ´åˆã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ ãƒ«ãƒ¼ãƒ«ï¼šblock-access-to-url-path Statementã®é †ç•ª If a request Inspect Match type Regex pattern set Then æŒ™å‹• 0 matches URI path Matches pattern from regex pattern set æ–‡å­—åˆ—ã‚»ãƒƒãƒˆ Block æŒ‡å®šã—ãŸæ–‡å­—åˆ—ã‚’å«ã‚€URLãƒ‘ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã®å ´åˆã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã€‚ Default Action èª¬æ˜ Allow æŒ‡å®šã—ãŸURLãƒ‘ã‚¹ä»¥å¤–ã®ã‚¢ã‚¯ã‚»ã‚¹ã®å ´åˆã€ãã®ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ ãƒ»ç¤¾å†…ã‚¢ã‚¯ã‚»ã‚¹ã«é™å®š ï¼Šä¾‹ï¼Š ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã ã‘ã«åˆ¶é™ã™ã‚‹ã€‚ ãƒ«ãƒ¼ãƒ«ï¼šallow-global-ip-addresses Statementã®é †ç•ª If a request Inspect IP set Originating address Then æŒ™å‹• 0 matches (OR) Originates from an IP address in ç¤¾å†…IPã‚»ãƒƒãƒˆ Source IP address - ç¤¾å†…ã®é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å ´åˆã€å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ 1 matches Originates from an IP address in å”åŠ›ä¼šç¤¾IPã‚»ãƒƒãƒˆ Source IP address Allow 0ç•ªç›®ã‚ã‚‹ã„ã¯ã€å”åŠ›ä¼šç¤¾ã®é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å ´åˆã€å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã€‚ Default Action èª¬æ˜ Block æŒ‡å®šã—ãŸé€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ä»¥å¤–ã®å ´åˆã€å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã€‚ ãƒ­ã‚° ãƒ»ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã®ãƒ­ã‚° WAFãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ãŒruleGroupListã‚­ãƒ¼ã«é…åˆ—ã¨ã—ã¦æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚ã‚‚ã—ã€Countã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚Œã°ã€excludedRulesã‚­ãƒ¼ã«ãã®æ—¨ã¨ãƒ«ãƒ¼ãƒ«IDãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ { # ï½ ä¸­ç•¥ ï½ \"ruleGroupList\": [ { \"ruleGroupId\": \"AWS#AWSManagedRulesCommonRuleSet#Version_1.2\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": [ { \"exclusionType\": \"EXCLUDED_AS_COUNT\", \"ruleId\": \"NoUserAgent_HEADER\" } ] }, { \"ruleGroupId\": \"AWS#AWSManagedRulesSQLiRuleSet#Version_1.1\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null }, { \"ruleGroupId\": \"AWS#AWSManagedRulesPHPRuleSet#Version_1.1\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null }, { \"ruleGroupId\": \"AWS#AWSManagedRulesKnownBadInputsRuleSet#Version_1.1\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null } ], # ï½ ä¸­ç•¥ ï½ } 34. WorkMail WorkMailã¨ã¯ Gmailã€ã‚µãƒ³ãƒ€ãƒ¼ãƒãƒ¼ãƒ‰ã€Yahooãƒ¡ãƒ¼ãƒ«ãªã©ã¨åŒé¡ã®ãƒ¡ãƒ¼ãƒ«ç®¡ç†ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚ è¨­å®šé …ç›® è¨­å®šé …ç›® èª¬æ˜ è£œè¶³ Users WorkMailã§ç®¡ç†ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ã‚’è¨­å®šã™ã‚‹ã€‚ Domains ãƒ¦ãƒ¼ã‚¶ã«å‰²ã‚Šå½“ã¦ã‚‹ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ @{çµ„ç¹”å}.awsapps.comã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨ã—ã¦ã‚‚ã‚‰ãˆã‚‹ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³åã®æ¤œè¨¼ãŒå®Œäº†ã—ãŸç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ Access Controle rules å—ä¿¡ã™ã‚‹ãƒ¡ãƒ¼ãƒ«ã€å—ä¿¡ã‚’é®æ–­ã™ã‚‹ãƒ¡ãƒ¼ãƒ«ã€ã®æ¡ä»¶ã‚’è¨­å®šã™ã‚‹ã€‚ 35. è² è·ãƒ†ã‚¹ãƒˆ Distributed Load Testingï¼ˆåˆ†æ•£è² è·ãƒ†ã‚¹ãƒˆï¼‰ ãƒ»åˆ†æ•£è² è·ãƒ†ã‚¹ãƒˆã¨ã¯ AWSã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹è² è·ã‚’ç™ºç”Ÿã•ã›ã‚‹ã‚¤ãƒ³ãƒ•ãƒ©ç’°å¢ƒã®ã“ã¨ã€‚CloudFormationã§æ§‹ç¯‰ã§ãã€Fargateã‚’ç”¨ã„ã¦ã€ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ“¬ä¼¼çš„ã«å†ç¾ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://d1.awsstatic.com/Solutions/ja_JP/distributed-load-testing-on-aws.pdf ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ 36. ã‚¿ã‚° ã‚¿ã‚°ä»˜ã‘æˆ¦ç•¥ ãƒ»ã‚ˆãã‚ã‚‹ã‚¿ã‚° ã‚¿ã‚°å ç”¨é€” Name ãƒªã‚½ãƒ¼ã‚¹è‡ªä½“ã«åå‰ã‚’ä»˜ã‘ã‚‰ã‚Œãªã„å ´åˆã€ä»£ã‚ã‚Šã«ã‚¿ã‚°ã§åä»˜ã‘ã‚‹ãŸã‚ã€‚ Environment åŒä¸€ã®AWSç’°å¢ƒå†…ã«ç•°ãªã‚‹å®Ÿè¡Œç’°å¢ƒãŒå­˜åœ¨ã—ã¦ã„ã‚‹å ´åˆã€ãã‚Œã‚‰ã‚’åŒºåˆ¥ã™ã‚‹ãŸã‚ã€‚ User åŒä¸€ã®AWSç’°å¢ƒå†…ã«ãƒªã‚½ãƒ¼ã‚¹åˆ¥ã«æ‰€æœ‰è€…ãŒå­˜åœ¨ã—ã¦ã„ã‚‹å ´åˆã€ãã‚Œã‚‰ã‚’åŒºåˆ¥ã™ã‚‹ãŸã‚ã€‚ ãƒ»ã‚¿ã‚°ä»˜ã‘ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° AWSã®å„ãƒªã‚½ãƒ¼ã‚¹ã«ã¯ã€ã‚¿ã‚°ã‚’ã¤ã‘ã‚‰ã‚Œã‚‹ã€‚ä¾‹ãˆã°ã€AWSã‚³ã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã«ã¦ã€ã“ã®ã‚¿ã‚°ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ä»»æ„ã®ã‚¿ã‚°ãŒä»˜ã„ãŸãƒªã‚½ãƒ¼ã‚¹ã®è«‹æ±‚åˆè¨ˆé¡ã‚’ç¢ºèªã§ãã‚‹ã€‚ "},"public/cloud_computing/cloud_computing_aws_api_gateway_import.html":{"url":"public/cloud_computing/cloud_computing_aws_api_gateway_import.html","title":"ğŸ“– ï¸API Gatewayã¸ã®ymlã‚¤ãƒ³ãƒãƒ¼ãƒˆ","keywords":"","body":"API Gatewayã¸ã®ymlã‚¤ãƒ³ãƒãƒ¼ãƒˆ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. APIGatewayæ‹¡å¼µæ©Ÿèƒ½ ãƒ»å¿…è¦ãªã‚­ãƒ¼ APIGatewayã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å½“ãŸã‚Šã€OpenAPIã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚­ãƒ¼ã‚’æ–°ãŸã«å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-swagger-extensions.html x-amazon-apigateway-integrationã‚­ãƒ¼ ãƒ»x-amazon-apigateway-integrationã‚­ãƒ¼ã¨ã¯ è©²å½“ã™ã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ã§çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„çµ±åˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã« x-amazon-apigateway-integrationã‚­ãƒ¼ ãŒå¿…è¦ã§ã‚ã‚‹ã€‚å„é …ç›®ã®èª¬æ˜ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-swagger-extensions-integration.html å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-swagger-extensions-integration-requestParameters.html çµ±åˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-swagger-extensions-integration-responseParameters.html ãƒ»è¨­å®šé …ç›®ï¼ˆVPCãƒªãƒ³ã‚¯&ãƒ—ãƒ­ã‚­ã‚·çµ±åˆï¼‰ paths: /users: get: # ï½ ä¸­ç•¥ ï½ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: \"GET\" # è»¢é€ã™ã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ uri: \"http:///api/v1/users/\" # è»¢é€å…ˆã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰URL requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" # è»¢é€ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ã¨APIã‚­ãƒ¼ integration.request.querystring.userId: method.request.querystring.userId # ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é–“ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã§ã‚ã‚Œã°ã€integration.request.path.userId: method.request.path.userId # ä»–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒœãƒ‡ã‚£ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã§ã‚ã‚Œã°ã€integration.request.header.userId: method.request.body.userId connectionType: VPC_LINK # VPCãƒªãƒ³ã‚¯ã‚’ä½¿ç”¨ connectionId: # VPCãƒªãƒ³ã‚¯ã®ID passthroughBehavior: when_no_match # ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã®å ´åˆã¯è¨­å®šã®å¤‰æ›´ä¸å¯ã§å›ºå®š type: http_proxy # ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’ä½¿ç”¨ responses: # ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã®å ´åˆã¯è¨­å®šã®å¤‰æ›´ä¸å¯ã§å›ºå®š default: statusCode: 200 ãƒ»è¨­å®šé …ç›®ï¼ˆVPCãƒªãƒ³ã‚¯&éãƒ—ãƒ­ã‚­ã‚·çµ±åˆã®å ´åˆï¼‰ ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼æ¡ä»¶ã‚„responseã‚­ãƒ¼ä»¥ä¸‹ã®çµ±åˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¨­å®šã§ãã‚‹ã€‚ paths: /users: post: x-amazon-apigateway-integration: httpMethod: POST uri: \"http:///api/v1/users/\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" requestTemplates: application/json: '{\"body\" : $input.json(\"$\")}' passthroughBehavior: when_no_templates # çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼æ¡ä»¶ã‚’é¸æŠ connectionType: VPC_LINK connectionId: type: http # éãƒ—ãƒ­ã‚­ã‚·çµ±åˆ responses: # çµ±åˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¨­å®š 200: statusCode: 200 responseTemplates: application/json: '{\"body\" : $input.json(\"$\")}' # ãƒ¬ã‚¹ãƒãƒ³ã‚¹çµ±åˆã®ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ 400: statusCode: 400 401: statusCode: 401 ãƒ»è¨­å®šé …ç›®ï¼ˆãƒ¢ãƒƒã‚¯çµ±åˆï¼‰ ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼æ¡ä»¶ã‚’è¨­å®šã§ãã‚‹ã€‚ãƒ¢ãƒƒã‚¯ã«å‡¦ç†ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ paths: /users: post: x-amazon-apigateway-integration: type: mock # ãƒ¢ãƒƒã‚¯çµ±åˆã‚’ä½¿ç”¨ requestTemplates: application/json: '{\"statusCode\": 200}' # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç† passthroughBehavior: when_no_templates # çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼æ¡ä»¶ã‚’é¸æŠ responses: 200: statusCode: 200 responseTemplates: application/json: '{\"id\": 1}' # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‡¦ç† 400: statusCode: 400 401: statusCode: 401 x-amazon-apigateway-request-validatorsã‚­ãƒ¼ ãƒ»x-amazon-apigateway-request-validatorsã‚­ãƒ¼ã¨ã¯ ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã€x-amazon-apigateway-request-validatorsã‚­ãƒ¼ãŒå¿…è¦ã§ã‚ã‚‹ã€‚å®Ÿéš›ã«å®šç¾©ã—ãŸã‚‚ã®ã‚’ç”¨ã„ã‚‹æ™‚ã¯ã€å¾Œè¿°ã®x-amazon-apigateway-request-validatorã‚­ãƒ¼ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ ãƒ»è¨­å®šé …ç›® å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã„ãšã‚Œã‚’ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å¯¾è±¡ã¨ã™ã‚‹ã‹ã‚’æŒ‡å®šã—ãŸã†ãˆã§ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒˆã§å®šç¾©ã™ã‚‹ã€‚ paths: /users: # ï½ ä¸­ç•¥ ï½ #=========================== # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒƒãƒˆã®å®šç¾© #=========================== x-amazon-apigateway-request-validators: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true # ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ˜ãƒƒãƒ€ãƒ¼ validateRequestBody: true # ãƒœãƒ‡ã‚£ ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true validateRequestBody: false x-amazon-apigateway-request-validatorã‚­ãƒ¼ ãƒ»x-amazon-apigateway-request-validatorã‚­ãƒ¼ã¨ã¯ ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€x-amazon-apigateway-request-validatorã‚­ãƒ¼ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ ãƒ»è¨­å®šé …ç›® äº‹å‰ã«å®šç¾©ã—ãŸx-amazon-apigateway-request-validatorsã‚­ãƒ¼ã®ä¸­ã‹ã‚‰ã€ç”¨ã„ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’å®£è¨€ã™ã‚‹ã€‚ paths: /users: post: # ï½ ä¸­ç•¥ ï½ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ # ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’å®£è¨€ # ï½ ä¸­ç•¥ ï½ #=========================== # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒƒãƒˆã®å®šç¾© #=========================== x-amazon-apigateway-request-validators: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true # ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ˜ãƒƒãƒ€ãƒ¼ validateRequestBody: true # ãƒœãƒ‡ã‚£ ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true validateRequestBody: false 02. ã‚µãƒ³ãƒ—ãƒ«YAML ã‚µãƒ³ãƒ—ãƒ«ã«ã¤ã„ã¦ ãƒ»æ³¨æ„ç‚¹ ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«ã‚ãŸã‚Šã€ä»¥ä¸‹ã«æ³¨æ„ã™ã‚‹ã€‚Swagger Editorã§APIã®ä»•æ§˜æ›¸ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://editor.swagger.io/ OpenAPIä»•æ§˜ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.0ã¨3.0ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚ x-amazon-apigateway-integrationã‚­ãƒ¼ã‚’å„HTTPãƒ¡ã‚½ãƒƒãƒ‰ã«å®šç¾©ã™ã‚‹ã€‚ API GatewayãŒsecurityã‚­ãƒ¼ã®ãƒ«ãƒ¼ãƒˆå®šç¾©ã«éå¯¾å¿œã®ãŸã‚ã€å†—é•·ã§ã¯ã‚ã‚‹ãŒã€å„HTTPãƒ¡ã‚½ãƒƒãƒ‰ã«å€‹åˆ¥ã«å®šç¾©ã™ã‚‹ã€‚ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã§å—ä¿¡ã™ã‚‹APIã‚­ãƒ¼ã®ãƒ˜ãƒƒãƒ€ãƒ¼åã¯ã€å°æ–‡å­—ã§ã€x-api-keyã€ä»¥å¤–ã¯è¨­å®šã§ããªã„ã€‚ãŸã ã—ã€çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è»¢é€ã™ã‚‹æ™‚ã«ä»˜ä¸ã™ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼åã¯ã€X-API-Keyã€ã¨è¨­å®šã§ãã‚‹ã€‚ çµ±åˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«è»¢é€ã™ã‚‹APIã‚­ãƒ¼ã¯ã€ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã§å›²ã†å¿…è¦ãŒã‚ã‚‹ã€‚ APIã‚­ãƒ¼ã®ä½œæˆã¯æ‰‹å‹•ã§è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚ ã‚¹ãƒ†ãƒ¼ã‚¸ã®ä½œæˆã¯æ‰‹å‹•ã§è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚ serversã‚­ãƒ¼ã®å®Ÿè£…ã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã‚‚åæ˜ ã§ããªã„ã€‚ ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯VTLã‚’ç”¨ã„ã¦å®šç¾©ã§ãã‚‹ã€‚ ãƒ»ãã®ä»–éå¯¾å¿œãªè¨˜æ³• ãã®ä»–ã®éå¯¾å¿œã®è¨˜è¿°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-known-issues.html#api-gateway-known-issues-rest-apis VPCãƒªãƒ³ã‚¯ï¼†ãƒ—ãƒ­ã‚­ã‚·çµ±åˆ å®Ÿè£…ä¾‹ openapi: 3.0.0 info: title: example-api-with-proxy-integration # APIå description: The API for example with proxy integration # APIã®èª¬æ˜ termsOfService: https://www.example.com/terms/ # åˆ©ç”¨è¦ç´„ contact: name: API support # é€£çµ¡å…ˆå url: https://www.example.com/support # é€£çµ¡å…ˆã«é–¢ã™ã‚‹URL email: support@example.com # ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ license: name: Apache 2.0 # ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ url: https://www.apache.org/licenses/LICENSE-2.0.html # URL version: 1.0.0 # APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ servers: - url: https://{env}.example.com/api/v1 description: | variables: env: default: stg description: API environment enum: - stg - www paths: #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: å…¨ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: query # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ Users: User: userId: 1 name: Hiroki schema: $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: GET uri: \"http:///api/v1/users/\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" integration.request.querystring.userId: method.request.querystring.userId # ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ connectionType: VPC_LINK connectionId: type: http_proxy passthroughBehavior: when_no_match responses: default: statusCode: 200 #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== post: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆ description: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’ä½œæˆã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: [ ] requestBody: # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ description: ãƒ¦ãƒ¼ã‚¶ID content: application/json: # MIME type example: # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: $ref: \"#/components/schemas/normal\" # æ­£å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: POST uri: \"http:///api/v1/users/\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" connectionType: VPC_LINK connectionId: type: http_proxy passthroughBehavior: when_no_match responses: default: statusCode: 200 #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users/{userId}: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: GET uri: \"http:///api/v1/users/{userId}\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" integration.request.path.userId: method.request.path.userId connectionType: VPC_LINK connectionId: type: http_proxy passthroughBehavior: when_no_match responses: default: statusCode: 200 #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== put: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±æ›´æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æ›´æ–° description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: PUT uri: \"http:///api/v1/users/{userId}\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" integration.request.path.userId: method.request.path.userId connectionType: VPC_LINK connectionId: type: http_proxy passthroughBehavior: when_no_match responses: default: statusCode: 200 #=========================== # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒƒãƒˆã®å®šç¾© #=========================== x-amazon-apigateway-request-validators: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true # ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ˜ãƒƒãƒ€ãƒ¼ validateRequestBody: true # ãƒœãƒ‡ã‚£ ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true validateRequestBody: false components: #=========================== # callbackã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== callbacks: { } #=========================== # linkã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== links: { } #=========================== # responseã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== responses: unauthorized: description: Unauthorized ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 401 title: Unauthorized errors: messages: [ \"èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # schemaã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== schemas: # ãƒ¦ãƒ¼ã‚¶ user: type: object properties: userId: type: string name: type: string # æ­£å¸¸ç³» normal: type: object properties: userId: type: string # ç•°å¸¸ç³» error: type: object properties: messages: type: array items: type: string #=========================== # securityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å…±é€šåŒ– #=========================== securitySchemes: # APIã‚­ãƒ¼èªè¨¼ apiKeyAuth: description: APIã‚­ãƒ¼èªè¨¼ type: apiKey name: x-api-key # ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼å in: header VPCãƒªãƒ³ã‚¯ï¼†éãƒ—ãƒ­ã‚­ã‚·çµ±åˆ å®Ÿè£…ä¾‹ openapi: 3.0.0 info: title: example-api-with-non-proxy-integration # APIå description: The API for example with non-proxy integration. # APIã®èª¬æ˜ termsOfService: https://www.example.com/terms/ # åˆ©ç”¨è¦ç´„ contact: name: API support # é€£çµ¡å…ˆå url: https://www.example.com/support # é€£çµ¡å…ˆã«é–¢ã™ã‚‹URL email: support@example.com # ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ license: name: Apache 2.0 # ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ url: https://www.apache.org/licenses/LICENSE-2.0.html # URL version: 1.0.0 # APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ servers: - url: https://{env}.example.com/api/v1 description: | variables: env: default: stg description: API environment enum: - stg - www paths: #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: å…¨ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: query # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ Users: User: userId: 1 name: Hiroki schema: $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: GET uri: \"http:///api/v1/users/\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" integration.request.querystring.userId: method.request.querystring.userId # ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ passthroughBehavior: when_no_templates connectionType: VPC_LINK connectionId: type: http responses: 200: statusCode: 200 responseTemplates: application/json: '{\"body\" : $input.json(\"$\")}' 400: statusCode: 400 401: statusCode: 401 #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== post: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆ description: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’ä½œæˆã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: [ ] requestBody: # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ description: ãƒ¦ãƒ¼ã‚¶ID content: application/json: # MIME type example: # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: $ref: \"#/components/schemas/normal\" # æ­£å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: POST uri: \"http:///api/v1/users/\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" requestTemplates: application/json: '{\"body\" : $input.json(\"$\")}' passthroughBehavior: when_no_templates connectionType: VPC_LINK connectionId: type: http responses: 200: statusCode: 200 responseTemplates: application/json: '{\"body\" : $input.json(\"$\")}' 400: statusCode: 400 401: statusCode: 401 # type: http #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users/{userId}: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: GET uri: \"http:///api/v1/users/{userId}\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" integration.request.path.userId: method.request.path.userId passthroughBehavior: when_no_templates connectionType: VPC_LINK connectionId: type: http responses: 200: statusCode: 200 responseTemplates: application/json: '{\"body\" : $input.json(\"$\")}' 400: statusCode: 400 401: statusCode: 401 404: statusCode: 404 #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== put: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±æ›´æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æ›´æ–° description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: httpMethod: PUT uri: \"http:///api/v1/users/{userId}\" requestParameters: integration.request.header.X-API-Key: \"'XXXXX'\" integration.request.path.userId: method.request.path.userId passthroughBehavior: when_no_templates connectionType: VPC_LINK connectionId: type: http responses: 200: statusCode: 200 responseTemplates: application/json: '{\"body\" : $input.json(\"$\")}' 400: statusCode: 400 401: statusCode: 401 #=========================== # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒƒãƒˆã®å®šç¾© #=========================== x-amazon-apigateway-request-validators: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true # ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ˜ãƒƒãƒ€ãƒ¼ validateRequestBody: true # ãƒœãƒ‡ã‚£ ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true validateRequestBody: false components: #=========================== # callbackã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== callbacks: { } #=========================== # linkã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== links: { } #=========================== # responseã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== responses: unauthorized: description: Unauthorized ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 401 title: Unauthorized errors: messages: [ \"èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # schemaã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== schemas: # ãƒ¦ãƒ¼ã‚¶ user: type: object properties: userId: type: string name: type: string # æ­£å¸¸ç³» normal: type: object properties: userId: type: string # ç•°å¸¸ç³» error: type: object properties: messages: type: array items: type: string #=========================== # securityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å…±é€šåŒ– #=========================== securitySchemes: # APIã‚­ãƒ¼èªè¨¼ apiKeyAuth: description: APIã‚­ãƒ¼èªè¨¼ type: apiKey name: x-api-key # ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼å in: header ãƒ¢ãƒƒã‚¯çµ±åˆ API Gatewayã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç¢ºèªã§ãã‚‹ã€‚ GET https://xxxxx.execute-api.ap-northeast-1.amazonaws.com/dev/users/?userId=1 X-API-Keyï¼šXXXXX å®Ÿè£…ä¾‹ openapi: 3.0.0 info: title: example-api-with-mock-integration # APIå description: The API for example with mock integration # APIã®èª¬æ˜ termsOfService: https://www.example.com/terms/ # åˆ©ç”¨è¦ç´„ contact: name: API support # é€£çµ¡å…ˆå url: https://www.example.com/support # é€£çµ¡å…ˆã«é–¢ã™ã‚‹URL email: support@example.com # ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ license: name: Apache 2.0 # ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ url: https://www.apache.org/licenses/LICENSE-2.0.html # URL version: 1.0.0 # APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ servers: - url: https://{env}.example.com/api/v1 description: | variables: env: default: stg description: API environment enum: - stg - www paths: #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: å…¨ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: query # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ Users: User: userId: 1 name: Hiroki schema: $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: requestTemplates: application/json: '{\"statusCode\": 200}' passthroughBehavior: when_no_templates type: mock responses: 200: statusCode: 200 responseTemplates: application/json: '{[{\"id\": 1,\"name\": test}]}' 400: statusCode: 400 401: statusCode: 401 #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== post: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ä½œæˆ description: ãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’ä½œæˆã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: [ ] requestBody: # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ description: ãƒ¦ãƒ¼ã‚¶ID content: application/json: # MIME type example: # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ userId: 1 schema: $ref: \"#/components/schemas/normal\" # æ­£å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: requestTemplates: application/json: '{\"statusCode\": 200}' passthroughBehavior: when_no_templates type: mock responses: 200: statusCode: 200 responseTemplates: application/json: '{\"id\": 1}' 400: statusCode: 400 401: statusCode: 401 # type: mock #=========================== # pathsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== /users/{userId}: #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== get: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾— description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: requestTemplates: application/json: '{\"statusCode\": 200}' passthroughBehavior: when_no_templates type: mock responses: 200: statusCode: 200 responseTemplates: application/json: '{[{\"id\": 1,\"name\": test}]}' 400: statusCode: 400 401: statusCode: 401 404: statusCode: 404 #=========================== # path itemã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #=========================== put: tags: - ãƒ¦ãƒ¼ã‚¶æƒ…å ±æ›´æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ summary: æŒ‡å®šãƒ¦ãƒ¼ã‚¶æ›´æ–° description: æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶æƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã€‚ #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #=========================== x-amazon-apigateway-request-validator: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼ security: - apiKeyAuth: [ ] # APIã‚­ãƒ¼ã®å¿…é ˆåŒ– parameters: - in: path # ãƒ‘ã‚¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ name: userId required: true description: ãƒ¦ãƒ¼ã‚¶ID schema: type: string example: # ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ userId=1 #=========================== # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ #=========================== responses: '200': description: OK ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ userId: 1 name: Hiroki schema: # ã‚¹ã‚­ãƒ¼ãƒ $ref: \"#/components/schemas/user\" # Userãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '400': description: Bad Request ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 400 title: Bad Request errors: messages: [ \"ãƒ¦ãƒ¼ã‚¶IDã¯å¿…ãšæŒ‡å®šã—ã¦ãã ã•ã„ã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ '401': $ref: \"#/components/responses/unauthorized\" # èªè¨¼ã‚¨ãƒ©ãƒ¼ã‚’å‚ç…§ã™ã‚‹ã€‚ '404': description: Not Found ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 404 title: Not Found errors: messages: [ \"å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # çµ±åˆ #=========================== x-amazon-apigateway-integration: requestTemplates: application/json: '{\"statusCode\": 200}' passthroughBehavior: when_no_templates type: mock responses: 200: statusCode: 200 responseTemplates: application/json: '{\"id\": 1}' 400: statusCode: 400 401: statusCode: 401 #=========================== # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒƒãƒˆã®å®šç¾© #=========================== x-amazon-apigateway-request-validators: æœ¬æ–‡ã€ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true # ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ˜ãƒƒãƒ€ãƒ¼ validateRequestBody: true # ãƒœãƒ‡ã‚£ ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŠã‚ˆã³ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œè¨¼: validateRequestParameters: true validateRequestBody: false components: #=========================== # callbackã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== callbacks: { } #=========================== # linkã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== links: { } #=========================== # responseã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== responses: unauthorized: description: Unauthorized ãƒ¬ã‚¹ãƒãƒ³ã‚¹ content: application/json: # MIME type example: # ãƒœãƒ‡ã‚£ä¾‹ status: 401 title: Unauthorized errors: messages: [ \"èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\" ] schema: $ref: \"#/components/schemas/error\" # ç•°å¸¸ç³»ãƒ¢ãƒ‡ãƒ«ã‚’å‚ç…§ã™ã‚‹ã€‚ #=========================== # schemaã‚­ãƒ¼ã®å…±é€šåŒ– #=========================== schemas: # ãƒ¦ãƒ¼ã‚¶ user: type: object properties: userId: type: string name: type: string # æ­£å¸¸ç³» normal: type: object properties: userId: type: string # ç•°å¸¸ç³» error: type: object properties: messages: type: array items: type: string #=========================== # securityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å…±é€šåŒ– #=========================== securitySchemes: # APIã‚­ãƒ¼èªè¨¼ apiKeyAuth: description: APIã‚­ãƒ¼èªè¨¼ type: apiKey name: x-api-key # ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼å in: header "},"public/cloud_computing/cloud_computing_aws_lambda_function.html":{"url":"public/cloud_computing/cloud_computing_aws_lambda_function.html","title":"ğŸ“– ï¸Lambdaé–¢æ•°ã®å®Ÿè£…","keywords":"","body":"Lambdaé–¢æ•°ã®å®Ÿè£… ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒãƒ³ãƒ‰ãƒ©é–¢æ•° ãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã¨ã¯ è‡ªèº«ã‹ã‚‰èµ·å‹•ã™ã‚‹ã“ã¨ã¯ãªãã€å¤–éƒ¨ã‹ã‚‰è¦æ±‚ã•ã‚Œã¦å®Ÿè¡Œã•ã‚Œã‚‹é–¢æ•°ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://garop.com/36/ Lambdaãƒãƒ³ãƒ‰ãƒ©é–¢æ•° ãƒ»éåŒæœŸãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ï¼ˆAsync handlersï¼‰ Lambdaã¯ãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’éåŒæœŸé–¢æ•°ã¨ã—ã¦ã‚³ãƒ¼ãƒ«ã—ã€å¼•æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆeventï¼‰ã«å€¤ã‚’ã‚ãŸã™ã€‚ãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã®åˆæœŸåã¯handlerãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚ã‚‹ãŒåˆ¥åã§ã‚‚ã‚ˆã„ã€‚returnã¾ãŸã¯throwã‚’ç”¨ã„ã¦ã€Lambdaã®ã‚³ãƒ¼ãƒ«å…ƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦ã€Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/lambda/latest/dg/nodejs-handler.html#nodejs-handler-async ï¼Šå®Ÿè£…ä¾‹ï¼Š Node.jsã®å ´åˆã‚’ç¤ºã™ã€‚ exports.handler = async (event) => { const response = { \"statusCode\": null, \"body\" : null }; response.statusCode = 200; response.body = \"Hello World!\" // ã‚‚ã—ãã¯throwã‚’ç”¨ã„ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ return response; } const aws = require(\"aws-sdk\"); const s3 = new aws.S3(); exports.handler = async function(event) { // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦é€ä¿¡ã™ã‚‹ã€‚ return s3.listBuckets().promise(); } exports.handler = async (event) => { // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦é€ä¿¡ã™ã‚‹ã€‚ return new Promise((resolve, reject) => { // ä½•ã‚‰ã‹ã®å‡¦ç† } } ãƒ»åŒæœŸãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ï¼ˆNon-async handlersï¼‰ Lambdaã¯ãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã‚’åŒæœŸé–¢æ•°ã¨ã—ã¦ã‚³ãƒ¼ãƒ«ã—ã€å¼•æ•°ï¼ˆeventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€callbacké–¢æ•°ï¼‰ã«å€¤ã‚’ã‚ãŸã™ã€‚ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ã€‚ãƒãƒ³ãƒ‰ãƒ©é–¢æ•°ã®åˆæœŸåã¯handlerã§ã‚ã‚‹ãŒåˆ¥åã§ã‚‚ã‚ˆã„ã€‚callbackãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã€Lambdaã®ã‚³ãƒ¼ãƒ«å…ƒã«Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/lambda/latest/dg/nodejs-handler.html#nodejs-handler-sync ï¼ˆâ€»ã€Nonã€ãŒç¿»è¨³ã‚’ãŠã‹ã—ãã—ã¦ã„ã‚‹ãŸã‚ã€è‹±èªç‰ˆã‚’æ¨å¥¨ï¼‰ ï¼Šå®Ÿè£…ä¾‹ï¼Š Node.jsã®å ´åˆã‚’ç¤ºã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã™ã‚‹ã«ã¯ã€doneãƒ¡ã‚½ãƒƒãƒ‰ã€succeedãƒ¡ã‚½ãƒƒãƒ‰ã€callbackãƒ¡ã‚½ãƒƒãƒ‰ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã¾ãŸã€å‡¦ç†ã‚’çµ‚ãˆã‚‹å ´åˆã¯returnã§è¿”å´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ exports.handler = (event, context, callback) => { // ãªã‚“ã‚‰ã‹ã®å‡¦ç† // contextä»¥å‰ã®å‡¦ç†ã‚’å¾…æ©Ÿã¯ã—ãªã„ context.done(null, /*ãƒ¬ã‚¹ãƒãƒ³ã‚¹*/); // å‡¦ç†ã‚’çµ‚ãˆã‚‹å ´åˆ // return context.done(null, /*ãƒ¬ã‚¹ãƒãƒ³ã‚¹*/) } exports.handler = (event, context, callback) => { // ãªã‚“ã‚‰ã‹ã®å‡¦ç† // contextä»¥å‰ã®å‡¦ç†ã‚’å¾…æ©Ÿã¯ã—ãªã„ context.succeed( /*ãƒ¬ã‚¹ãƒãƒ³ã‚¹*/ ); // å‡¦ç†ã‚’çµ‚ãˆã‚‹å ´åˆ // return context.succeed( /*ãƒ¬ã‚¹ãƒãƒ³ã‚¹*/ ) } exports.handler = (event, context, callback) => { // ãªã‚“ã‚‰ã‹ã®å‡¦ç† // callbackä»¥å‰ã®å‡¦ç†ã‚’å¾…æ©Ÿã™ã‚‹ã€‚ callback(null, /*ãƒ¬ã‚¹ãƒãƒ³ã‚¹*/); // å‡¦ç†ã‚’çµ‚ãˆã‚‹å ´åˆ // return callback(null, /*ãƒ¬ã‚¹ãƒãƒ³ã‚¹*/) } ãƒ»äºˆç´„ã•ã‚ŒãŸå¼•æ•°ã®èª¬æ˜ å¼•æ•° èª¬æ˜ è£œè¶³ eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒä»£å…¥ã•ã‚Œã¦ã„ã‚‹ã€‚ Lambdaã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã”ã¨ã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ãŒç•°ãªã‚‹ã€‚æ§‹é€ ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/lambda-services.html contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ Lambdaã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ï¼ˆåå‰ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©ï¼‰ã‚’å–å¾—ã§ãã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒä»£å…¥ã•ã‚Œã¦ã„ã‚‹ã€‚ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ã¯ä»¥ä¸‹ã®é€šã‚Šå‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/nodejs-context.html callbacké–¢æ•° ä»£å…¥ã•ã‚Œã¦ã„ã‚‹é–¢æ•°ã®å®Ÿä½“ã¯ä¸æ˜ã§ã‚ã‚‹ã€‚å…¨ã¦ã®å‡¦ç†ãŒçµ‚ã‚ã‚‹ã¾ã§å®Ÿè¡ŒãŒå¾…æ©Ÿã•ã‚Œã€Lambdaã®ã‚³ãƒ¼ãƒ«å…ƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/nodejs-handler.html ãƒ»ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚° Lambdaã§é–¢æ•°ã‚’ä½œæˆã™ã‚‹ã¨ã€CloudWatchãƒ­ã‚°ã®ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã«ã€ã€/aws/lambda/ã€ã¨ã„ã†ã‚°ãƒ«ãƒ¼ãƒ—ãŒè‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã‚‹ã€‚Lambdaã®é–¢æ•°å†…ã§ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã‚„console.logãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ­ã‚°ã¯ã“ã“ã«å‡ºåŠ›ã•ã‚Œã‚‹ãŸã‚ã€éƒ½åº¦ç¢ºèªã™ã‚‹ã“ã¨ã€‚ ãƒ»ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/best-practices.html#function-code 02. Goã«ã‚ˆã‚‹å®Ÿè£… ç™ºè¡¨ã‚¹ãƒ©ã‚¤ãƒ‰ aws-lambda-go ãƒ»aws-lambda-goã¨ã¯ Goã‚’ç”¨ã„ã¦ã€Lambda-APIã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€AWSãƒªã‚½ãƒ¼ã‚¹ã‚’æ“ä½œã§ãã‚‹ã€‚ ãƒ»Starté–¢æ•° Lamdaé–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®é–¢æ•°ã€‚Starté–¢æ•°ã«æ¸¡ã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¯ã€å¿…ãšä¸€ã¤ã§ã‚‚errorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã‚‚ã—å«ã¾ã‚Œã¦ã„ãªã„å ´åˆã¯ã€Lambdaã§å†…éƒ¨ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/golang-handler.html package main import ( \"context\" \"fmt\" \"github.com/aws/aws-lambda-go/lambda\" ) type MyEvent struct { Name string `json:\"name\"` } // HandleRequest ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚ func HandleRequest(ctx context.Context, name MyEvent) (string, error) { return fmt.Sprintf(\"Hello %s!\", name.Name), nil } func main() { // Lambdaé–¢æ•°ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ lambda.Start(HandleRequest) } ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/golang-context.html eventã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç¨®é¡ ãƒ»å…¨ç¨®é¡ å‚è€ƒï¼šhttps://github.com/aws/aws-lambda-go/tree/master/events#overview ãƒ»SNSã‚¤ãƒ™ãƒ³ãƒˆã®å ´åˆ package main import ( \"context\" \"github.com/aws/aws-lambda-go/events\" \"github.com/aws/aws-lambda-go/lambda\" \"github.com/aws/aws-lambda-go/lambdacontext\" ) /** * Lambdaãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•° */ func HandleRequest(context context.Context, event events.SNSEvent) (string, error) { } func main() { lambda.Start(HandleRequest) } ãƒ»CloudWatchã‚¤ãƒ™ãƒ³ãƒˆã®å ´åˆ package main import ( \"context\" \"github.com/aws/aws-lambda-go/events\" \"github.com/aws/aws-lambda-go/lambda\" \"github.com/aws/aws-lambda-go/lambdacontext\" ) /** * Lambdaãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•° */ func HandleRequest(context context.Context, event events.CloudWatchEvent) (string, error) { } func main() { lambda.Start(HandleRequest) } ãƒ»APIGatewayã‚¤ãƒ™ãƒ³ãƒˆã®å ´åˆ package main import ( \"context\" \"github.com/aws/aws-lambda-go/events\" \"github.com/aws/aws-lambda-go/lambda\" \"github.com/aws/aws-lambda-go/lambdacontext\" ) /** * Lambdaãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•° */ func HandleRequest(context context.Context, event events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) { } func main() { lambda.Start(HandleRequest) } ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ»æ­£å¸¸ç³» æ­£å¸¸ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ§‹æˆè¦ç´ ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/API_Invoke.html#API_Invoke_ResponseElements æ–‡å­—åˆ—ã‚’è¿”å´ã™ã‚‹ã¨ã€Lambdaã¯ãã®æ–‡å­—åˆ—ã‚’ãã®ã¾ã¾è¿”ä¿¡ã™ã‚‹ã€‚ã¾ãŸã€JSONã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/golang-handler.html#golang-handler-structs ãƒ»ç•°å¸¸ç³» Lambdaã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/API_Invoke.html#API_Invoke_Errors ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã«ã¯ä»¥ä¸‹ã®JSONãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/golang-exceptions.html#go-exceptions-createfunction { \"errorMessage\": \"\", \"errorType\": \"\" } errorsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®Newé–¢æ•°ã‚’ç”¨ã„ã‚‹ã¨ã€å†…éƒ¨ã§ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã§ãã‚‹ã€‚ package main import ( \"errors\" \"github.com/aws/aws-lambda-go/lambda\" ) func HandleRequest() (string, error) { return \"\", errors.New(\"something went wrong!\") } func main() { lambda.Start(OnlyErrors) } /* çµæœ { \"errorMessage\": \"something went wrong!\", \"errorType\": \"errorString\" } */ ãƒ­ã‚° ãƒ»ãƒ¬ãƒãƒ¼ãƒˆãƒ­ã‚° ç¨®é¡ RequestId ãƒªã‚¯ã‚¨ã‚¹ãƒˆID Duration ã‚¤ãƒ™ãƒ³ãƒˆã®å‡¦ç†æ™‚é–“ Billed Duration Lambdaã®èª²é‡‘å¯¾è±¡ã®æ™‚é–“ Memory Size Lambdaã®ãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚º Max Memory Used LambdaãŒå®Ÿéš›ã«ç”¨ã„ã‚‹ãƒ¡ãƒ¢ãƒªã®æœ€å¤§é‡ ãƒ»ãƒ­ã‚°ã®å‡ºåŠ›æ–¹æ³• æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®fmtã€ã¾ãŸã¯ä»»æ„ã®ãƒ­ã‚®ãƒ³ã‚°ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã€æ¨™æº–å‡ºåŠ›ï¼æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€‚CloudWatchãƒ­ã‚°ã«ã¦ã“ã‚Œã‚’ç¢ºèªã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/lambda/latest/dg/golang-logging.html 02-02. é–¢æ•°ä¾‹ Amplify -> EventBridge -> Lambda ->Slack-API å‚è€ƒï¼šhttps://github.com/hiroki-it/notify-slack-of-amplify-events 03. Node.jsã«ã‚ˆã‚‹å®Ÿè£… æ¨™æº–ã§ä½¿ç”¨å¯èƒ½ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã¯ã€npmã‚’ç”¨ã„ã‚‹å¿…è¦ã¯ãªã„ã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰æä¾›ã•ã‚Œã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®é–¢æ•°ã®ã»ã¨ã‚“ã©ãŒéåŒæœŸå‡¦ç†ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã€‚ã‚‚ã—å¾Œç¶šã®å‡¦ç†ã§éåŒæœŸå‡¦ç†ã®çµæœã‚’ç”¨ã„ãŸã„å ´åˆã€éåŒæœŸå‡¦ç†ã®çŠ¶æ…‹ã‚’Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å èª¬æ˜ è£œè¶³ Node.jsã®æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ Node.jsã«æ¨™æº–ã§çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹é–¢æ•°ã‚’ä½¿ç”¨ã§ãã‚‹ å‚è€ƒï¼šhttps://nodejs.org/api/index.html aws-sdk.js JavaScriptã‚’ç”¨ã„ã¦ã€AWS-APIã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€AWSãƒªã‚½ãƒ¼ã‚¹ã‚’æ“ä½œã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/index.html éåŒæœŸå‡¦ç†ã®çŠ¶æ…‹ç®¡ç† ãƒ»Node.jsã®æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å ´åˆ ãƒ»aws-sdk.jsã®å ´åˆ å„AWSã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å¾Œã«ã€promiseãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒã‚§ãƒ¼ãƒ³ã§ãã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å„ãƒ¡ã‚½ãƒƒãƒ‰ã®éåŒæœŸå‡¦ç†ã®çŠ¶æ…‹ã‚’Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/sdk-for-javascript/v2/developer-guide/using-promises.html \"use strict\"; const aws = require(\"aws-sdk\"); /** * @param event * @returns Promise */ exports.handler = async (event) => { const ec2 = new aws.EC2({apiVersion: '2014-10-01'}); // Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”å´ã™ã‚‹ const ec2Instances = ec2.describeInstances().promise(); ec2Instances.then( (data) => { // éåŒæœŸå‡¦ç†ãŒæˆåŠŸã—ãŸæ™‚ã®å¾Œç¶šå‡¦ç† }, (error) => { // éåŒæœŸå‡¦ç†ãŒå¤±æ•—ã—ãŸæ™‚ã®å¾Œç¶šå‡¦ç† } ) }; 03-02. é–¢æ•°ä¾‹ Amplify -> EventBridge -> Lambda -> Slack-API ï¼Šå®Ÿè£…ä¾‹ï¼Š Amplifyã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’EventBridgeã§ã‚­ãƒ£ãƒƒãƒã—ã€ã“ã‚Œã‚’Lambdaã«è»¢é€ã™ã‚‹ã€‚Lambdaã§ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ§‹æˆã—ã€Slack-APIã«é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼š https://stackoverflow.com/questions/38533580/nodejs-how-to-promisify-http-request-reject-got-called-two-times https://gist.github.com/ktheory/df3440b01d4b9d3197180d5254d7fb65#file-httppromise-js \"use strict\"; const aws = require(\"aws-sdk\"); const https = require(\"https\"); const {format} = require(\"util\"); /** * @param event * @returns Promise */ exports.handler = async (event) => { console.log(JSON.stringify({event}, null, 2)); const amplify = new aws.Amplify({apiVersion: \"2017-07-25\"}); const option = { appId: event.detail.appId, branchName: event.detail.branchName }; let result; try { // Amplifyã®ãƒ–ãƒ©ãƒ³ãƒæƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚ const app = await amplify.getBranch(option).promise(); console.log(JSON.stringify({app}, null, 2)); const message = buildMessage(event, app); console.log(message); result = await postMessageToSlack(message); } catch (error) { console.error(error); } console.log(JSON.stringify({result}, null, 2)); return result; }; /** * ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚ * * @param event * @param app * @returns string */ const buildMessage = (event, app) => { return JSON.stringify({ channel: process.env.SLACK_CHANNEL_ID, text: \"developç’°å¢ƒ é€šçŸ¥\", attachments: [{ color: event.detail.jobStatus === \"SUCCEED\" ? \"#00FF00\" : \"#ff0000\", blocks: [ { type: \"section\", text: { type: \"mrkdwn\", text: format( \"%sç’°å¢ƒ\", event.detail.appId === process.env.AMPLIFY_APP_ID_PC ? \":computer: PC\" : \":iphone: SP\" ) } }, { type: \"context\", elements: [{ type: \"mrkdwn\", text: format( \"*çµæœ*: %s\", event.detail.jobStatus === \"SUCCEED\" ? \"æˆåŠŸ\" : \"å¤±æ•—\", ) }] }, { type: \"context\", elements: [{ type: \"mrkdwn\", text: format( \"*ãƒ–ãƒ©ãƒ³ãƒå*: %s\", event.detail.branchName ) }] }, { type: \"context\", elements: [{ type: \"mrkdwn\", text: format( \"*ãƒ—ãƒ«ãƒªã‚¯URL*: https://github.com/foo-repository/compare/%s\", event.detail.branchName ) }] }, { type: \"context\", elements: [{ type: \"mrkdwn\", text: format( \"*æ¤œè¨¼URL*: https://%s.%s.amplifyapp.com\", app.branch.displayName, event.detail.appId ) }] }, { type: \"context\", elements: [{ type: \"mrkdwn\", text: format( \":amplify: \", event.region, event.region, event.detail.appId, app.branch.displayName, event.detail.jobId ) }] }, { type: \"divider\" } ] }] }); }; /** * ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ã€‚ * * @param message * @returns Promise */ const postMessageToSlack = (message) => { // éåŒæœŸå‡¦ç†ã‚’æŒã¤é–¢æ•°ã‚’ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«æ¸¡ã—ã€éåŒæœŸå‡¦ç†ã‚’ç®¡ç†ã—ã¾ã™ã€‚ return new Promise((resolve, reject) => { const options = { host: \"slack.com\", path: \"/api/chat.postMessage\", method: \"POST\", headers: { \"Content-Type\": \"application/json\", \"Authorization\": \"Bearer \" + process.env.SLACK_API_TOKEN, \"Content-Length\": Buffer.byteLength(message) } }; // éåŒæœŸå‡¦ç† const request = https.request(options, (response) => { console.info({response}, null, 2); let tmp; // æ­£å¸¸ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚ response.on(\"data\", (data) => { tmp = data; }); // ç•°å¸¸ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚ response.on(\"error\", (error) => { tmp = error; }); // dataã€errorã€endã€ã®é–“ã§awaitã®åŠ¹åŠ›ã¯æ¨ªæ–­ã§ããªã„ã€‚ // ãã®ãŸã‚ã€ã§ãã‚‹ã ã‘endã§äº‹å¾Œå‡¦ç†ã‚’å®Ÿè£…ã—ã€awaitã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ response.on(\"end\", async () => { tmp = param.toString(tmp); const body = JSON.parse(tmp); const result = { statusCode: response.statusCode, body: body }; if (!response.statusCode === 200 || !body.ok) { return reject(result); } return resolve(result); }); }); request.on(\"error\", (error) => { console.error(JSON.stringify({error}, null, 2)); }); // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒ‡ã‚£ã‚’è¨­å®šã—ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚ request.write(message); request.end(); console.log(JSON.stringify({request}, null, 2)); }); }; API Gateway -> Lambda -> S3 ï¼Šå®Ÿè£…ä¾‹ï¼Š API Gatewayã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã—ã€ãã‚Œã«å¿œã˜ã¦ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ã‚’S3ã«ä¿å­˜ã™ã‚‹ã€‚LambdaãŒS3ã«å¯¾ã—ã¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã€äº‹å‰ã«ã€AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã®ã€AWSLambdaExecuteã€ãŒã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸãƒ­ãƒ¼ãƒ«ã‚’Lambdaã«ã‚¢ã‚¿ãƒƒãƒã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ \"use strict\"; const aws = require(\"aws-sdk\"); const s3 = new aws.S3(); exports.handler = (event, context, callback) => { // API Gatewayã¨ã®ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã‚’æ„è­˜ã—ãŸJSONæ§‹é€ ã«ã™ã‚‹ // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®åˆæœŸå€¤ const response = { \"statusCode\": null, \"body\": null }; // èªè¨¼ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ if (event.headers[\"X-API-Key\"] !== process.env.X_API_KEY) { response.statusCode = 401; response.body = \"An API key is invalid.\"; return callback(null, response); } // ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ if (!event.headers || !event.body) { response.statusCode = 400; response.body = \"Parameters are not found.\"; return callback(null, response); } s3.putObject({ Bucket: \"\", Key: \"\", Body: \"\", }, (err, data) => { if (err) { response.statusCode = 500; response.body = \"[ERROR] \" + err; return callback(null, response); } response.statusCode = 200; response.body = \"OK\"; return callback(null, response); }); }; "},"public/cloud_computing/cloud_computing_aws_cost_management.html":{"url":"public/cloud_computing/cloud_computing_aws_cost_management.html","title":"ğŸ“– ï¸ã‚³ã‚¹ãƒˆç®¡ç†","keywords":"","body":"ã‚³ã‚¹ãƒˆç®¡ç† 01. ã‚³ã‚¹ãƒˆç®¡ç†ã®è¦³ç‚¹ ã‚¹ãƒšãƒƒã‚¯ã€æ™‚é–“å˜ä¾¡ã€æ•°é‡ã€æœˆé¡æ–™é‡‘ 02. Service Quotas Service Quotastã¨ã¯ å„ç¨®AWSãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã®ä¸Šé™å€¤ã‚’ä¸Šã’ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/servicequotas/latest/userguide/intro.html å„ç¨®AWSãƒªã‚½ãƒ¼ã‚¹ã®ä¸Šé™å€¤ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/general/latest/gr/aws-service-information.html æ–¹æ³• å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/servicequotas/latest/userguide/request-quota-increase.html 03. ãƒªã‚½ãƒ¼ã‚¹åˆ¥ã‚³ã‚¹ãƒˆ CloudFront ãƒ»è»¢é€ ã‚ªãƒªã‚¸ãƒ³ã«è»¢é€ã™ã‚‹å‰ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç”¨ã„ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ä¿¡ã§ãã‚‹ãŸã‚ã€ã‚ªãƒªã‚¸ãƒ³ã§ã‹ã‹ã‚‹æ–™é‡‘ã‚’æŠ‘ãˆã‚‰ã‚Œã‚‹ã€‚ EBS ãƒ»ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚µã‚¤ã‚º ãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ä½¿ç”¨ç‡ã«ã‹ã‹ã‚ã‚‰ãšã€æ§‹ç¯‰ã•ã‚ŒãŸãƒœãƒªãƒ¥ãƒ¼ãƒ ã®åˆè¨ˆã‚µã‚¤ã‚ºã«åŸºã¥ã„ã¦ã€æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹ã€‚ãã®ãŸã‚ã€å®‰æ˜“ã«500GiBã‚’é¸ã‚“ã§ã¯ã„ã‘ãªã„ã€‚ EC2 ãƒ»æ–™é‡‘ä½“ç³»ã®é¸æŠ ä½¿ã„æ–¹ã«å¿œã˜ãŸæ–™é‡‘ä½“ç³»ã‚’é¸ã¹ã‚‹ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è¿”ä¿¡æ™‚ã«æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/concepts.html#ec2-pricing ç¨®é¡ èª¬æ˜ è£œè¶³ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ å‚è€ƒï¼šhttps://aws.amazon.com/jp/ec2/pricing/on-demand/ Savings Plans ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä¸€å®šæœŸé–“åˆ†ã®ä½¿ç”¨æ–™é‡‘ã‚’å‰æ‰•ã„ã—ã€ãã®ä»£ã‚ã‚Šã«å®‰ãåˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ã‚¹ãƒãƒƒãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ãƒ»æ–™é‡‘ç™ºç”Ÿã®æ¡ä»¶ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã®çŠ¶æ…‹ã«å¿œã˜ã¦ã€æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ec2-instance-lifecycle.html ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®çŠ¶æ…‹ æ–™é‡‘ç™ºç”Ÿã®æœ‰ç„¡ è£œè¶³ pending ãªã— running ã‚ã‚Š stopping æ¡ä»¶ä»˜ãã§ãªã— åœæ­¢æº–å‚™ä¸­ã®é–“ã¯æ–™é‡‘ãŒç™ºç”Ÿã—ã€ä¼‘æ­¢æº–å‚™ä¸­ã®é–“ã¯ç™ºç”Ÿã—ãªã„ã€‚ stopped ãªã— shutting-down ãªã— terminated ãªã— ECS ãƒ»ECRã®å®¹é‡ 500MBã‚’è¶…ãˆã‚‹ã¨ã€è«‹æ±‚ãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€å¤ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å®šæœŸçš„ã«å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ Lambda ãƒ»å®Ÿè¡Œæ™‚é–“ã®å¾“é‡èª²é‡‘åˆ¶ é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹æ™‚é–“åˆ†ã ã‘æ–™é‡‘ãŒã‹ã‹ã‚‹ã€‚é–¢æ•°ã‚’ä½¿ç”¨ã›ãšã«è¨­ç½®ã—ã¦ã„ã‚‹ã ã‘ã§ã‚ã‚Œã°ã€æ–™é‡‘ã¯ã‹ã‹ã‚‰ãªã„ã€‚ RDS ãƒ»æ–™é‡‘ä½“ç³» ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/User_DBInstanceBilling.html ç¨®é¡ èª¬æ˜ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/USER_OnDemandDBInstances.html ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ RDSã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä¸€å®šæœŸé–“åˆ†ã®ä½¿ç”¨æ–™é‡‘ã‚’å‰æ‰•ã„ã—ã€ãã®ä»£ã‚ã‚Šã«å®‰ãåˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/USER_WorkingWithReservedDBInstances.html SES ãƒ»é€å—ä¿¡æ•° å—ä¿¡ã¯1000ä»¶/æœˆã¾ã§ã€é€ä¿¡ã¯62000/æœˆã¾ã§ç„¡æ–™ã§ã‚ã‚‹ã€‚ "},"public/cloud_computing/cloud_computing_gcp.html":{"url":"public/cloud_computing/cloud_computing_gcp.html","title":"ğŸ“– ï¸GCP","keywords":"","body":"GCPï¼šGoogle Cloud Platform ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. GCPã«ã‚ˆã‚‹Webã‚µãƒ¼ãƒ“ã‚¹ã®ãƒªãƒªãƒ¼ã‚¹ GCPã‹ã‚‰ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨å®Œå…¨ä¿®é£¾ãƒ‰ãƒ¡ã‚¤ãƒ³åãŒæä¾›ã•ã‚Œã€Webã‚µãƒ¼ãƒ“ã‚¹ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹ã€‚ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ä¾‹ ä»¥ä¸‹ã®ãƒ‡ã‚¶ã‚¤ãƒ³ä¾‹ã§ã¯ã€Dualã‚·ã‚¹ãƒ†ãƒ ãŒæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚ GAEï¼šGoogle App Engineï¼šGAE ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒ¼ãƒã¨ã—ã¦åƒãã€‚AWSã«ãŠã‘ã‚‹Elastic Beanstalkã«ç›¸å½“ã™ã‚‹ã€‚ GCEï¼šGoogle Compute Engine ã‚¯ãƒ©ã‚¦ãƒ‰Webã‚µãƒ¼ãƒã¨ã—ã¦åƒãã€‚AWSã«ãŠã‘ã‚‹EC2ã«ç›¸å½“ã™ã‚‹ã€‚ SSLè¨¼æ˜æ›¸ã®è¨­ç½®å ´æ‰€ ãƒ»èªè¨¼å±€ ã‚µãƒ¼ãƒæä¾›è€… è‡ªç¤¾ã®ä¸­é–“èªè¨¼å±€å ãƒ«ãƒ¼ãƒˆèªè¨¼å±€å GCP Google Trust Services "},"public/infrastructure_as_code/infrastructure_as_code.html":{"url":"public/infrastructure_as_code/infrastructure_as_code.html","title":"ğŸ“– ï¸Infrastructure as Code","keywords":"","body":"Infrastructure as Code ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ä»®æƒ³ã‚µãƒ¼ãƒ(ä»®æƒ³ãƒã‚·ãƒ³)ã®ã‚³ãƒ¼ãƒ‰åŒ– ä»®æƒ³ã‚µãƒ¼ãƒã®æ§‹æˆç®¡ç† ãƒ»ã‚³ãƒ¼ãƒ‰åŒ–ãƒ„ãƒ¼ãƒ«ã®ç¨®é¡ ãƒ„ãƒ¼ãƒ«å å¯¾è±¡ã®Provider Ansible è¦å‹‰å¼· Puppet è¦å‹‰å¼· Chef è¦å‹‰å¼· ãƒ»Ansible Ansibleã§ã¯ã€ymlã®æ–‡æ³•ã‚’ç”¨ã„ã¦é–¢æ•°å‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ ãƒ•ã‚¡ã‚¤ãƒ«å å½¹å‰² playbook.yml ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã®æ‰‹é † inventory/* åæ˜ å…ˆã®ã‚µãƒ¼ãƒã®æƒ…å ± group_vars/* è¤‡æ•°ã®ã‚µãƒ¼ãƒã¸ã®è¨­å®š host_vars/* å˜ä¸€ã®ã‚µãƒ¼ãƒã¸ã®è¨­å®š 02. ã‚³ãƒ³ãƒ†ãƒŠã®ã‚³ãƒ¼ãƒ‰åŒ– ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹æˆç®¡ç† ãƒ»ã‚³ãƒ¼ãƒ‰åŒ–ãƒ„ãƒ¼ãƒ«ã®ç¨®é¡ åå‰ å¯¾è±¡ã®Provider Dockerfile Docker Ansible Container è¦å‹‰å¼· 03. ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®ã‚³ãƒ¼ãƒ‰åŒ– ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ»ã‚³ãƒ¼ãƒ‰åŒ–ãƒ„ãƒ¼ãƒ«ã®ç¨®é¡ åå‰ å¯¾è±¡ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ Terraform ã„ã‚ã„ã‚ AWS CloudFormation AWS Azure Resource Manager Azure ãƒ¡ãƒªãƒƒãƒˆ ãƒ»å¤‰æ›´ã‚’ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯èƒ½ ç”»é¢ä¸Šã‹ã‚‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã€ç”»é¢å…±æœ‰ã—ãªãŒã‚‰æ“ä½œã—ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨å¤‰æ›´ã‚’åŒæ™‚ã«è¡Œã†ã“ã¨ã«ãªã‚‹ã€‚ã‚³ãƒ¼ãƒ‰åŒ–ã«ã‚ˆã‚Šã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’äº‹å‰ã«è¡Œã£ãŸã†ãˆã§å¤‰æ›´ã™ã‚‹ã€ã¨ã„ã†æ‰‹é †ã‚’è¸ã‚ã‚‹ã€‚ ãƒ»ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ã‚¨ãƒ©ãƒ¼ãŒæ¸›ã‚‹ ç”»é¢ä¸Šã‹ã‚‰ã®å¤‰æ›´ã§ã‚ã‚‹ã¨ã€ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ã¦ã—ã¾ã†ã€‚ã‚³ãƒ¼ãƒ‰åŒ–ã™ã‚Œã°ã€ã“ã‚ŒãŒæ¸›ã‚‹ã€‚ ãƒ»å†åˆ©ç”¨ã‚„å†—é•·åŒ–ãŒç°¡å˜ è¤‡æ•°ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«ã€åŒæ§˜ã®è¨­å®šã§åŒæ§˜ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã‚„ã€ä¸€ã¤ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚’å†—é•·åŒ–ã™ã‚‹å ´åˆã€ã„ãã¤ã‚‚æ‰‹å‹•ã§æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€åŠ´åŠ›ãŒã‹ã‹ã‚‹ã€‚ã‚³ãƒ¼ãƒ‰åŒ–ã™ã‚Œã°ã€ã“ã‚ŒãŒæ¥½ã«ãªã‚‹ã€‚ ãƒ»éå»ã®å¤‰æ›´ãŒè¨˜éŒ²ã«æ®‹ã‚‹ ç”»é¢ä¸Šã‹ã‚‰ã®å¤‰æ›´ã§ã‚ã‚‹ã¨ã€éå»ã®å¤‰æ›´å±¥æ­´ãŒæ®‹ã‚‰ãªã„ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã‚Œã°ã€Issueã¨ç´ä»˜ã‘ã¦ã€å±¥æ­´ã‚’æ®‹ã›ã‚‹ã€‚ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ ãƒ»é‹ç”¨ã®ã‚¹ãƒ”ãƒ¼ãƒ‰ãŒè½ã¡ã‚‹ é‹ç”¨æ™‚ã«ã€ç”»é¢ä¸Šã‹ã‚‰ã®æ“ä½œã§ã‚ã‚Œã°ã™ãã«çµ‚ã‚ã‚‹å¤‰æ›´ã§ã‚ã‚‹ã®ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ã‚³ãƒ¼ãƒ‰åŒ–ã«ã‚ˆã‚Šã€å¤‰æ›´ã¾ã§ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚ãã®ãŸã‚ä¾‹ãˆã°AWSã¨ã™ã‚‹ã¨ã€é‹ç”¨æ™‚ã«å¤‰æ›´ã™ã‚‹é »åº¦ãŒå¤šã„ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆä¾‹ï¼šAPI Gatewayï¼ˆVPCãƒªãƒ³ã‚¯ã‚’å«ã‚€ï¼‰ã€IAMãƒ¦ãƒ¼ã‚¶ï¼ˆç´ä»˜ã‘ã‚‹ãƒ­ãƒ¼ãƒ«ã‚„ãƒãƒªã‚·ãƒ¼ã‚’å«ã‚€ï¼‰ï¼‰ã¯ã‚³ãƒ¼ãƒ‰åŒ–ã›ãšã€ã‚ãˆã¦ç”»é¢ä¸Šã‹ã‚‰æ§‹ç¯‰ã™ã‚‹ã€‚ ãƒ»ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®æ©Ÿèƒ½è¿½åŠ ã«è¿½å¾“ã—ã«ãã„ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯æ—¥ã€…æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ã‚‹ã€‚ç”»é¢ä¸Šã‹ã‚‰ã®æ“ä½œã§ã‚ã‚Œã°ã™ãã«ã“ã®æ©Ÿèƒ½ã‚’æ”¯ãˆã‚‹ãŒã€ã‚³ãƒ¼ãƒ‰åŒ–ã«ã‚ˆã‚Šã€ãƒ„ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ãªã‘ã‚Œã°ã€ã“ã®æ©Ÿèƒ½ã‚’ä½¿ãˆãªã„ã€‚é‹ç”¨æ™‚ã«ä¾¿åˆ©ãªæ©Ÿèƒ½ã‚’ã™ãã«ä½¿ãˆãªã„ãŸã‚ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ”¹å–„ã§ããªã„ã“ã¨ã«ç¹‹ãŒã‚‹ã€‚ã¾ãŸã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã€æ–°æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã¿ãŸã„æ¬²ã€ãŒè¡Œãå ´ã‚’å¤±ã†ã€‚ ãƒ»ãƒªãƒªãƒ¼ã‚¹ã®å¿ƒç†çš„ãƒãƒ¼ãƒ‰ãƒ«ãŒé«˜ã„ ç”»é¢ä¸Šã‹ã‚‰å¤‰æ›´ã™ã‚Œã°ã€ã‚¤ãƒ³ãƒ•ãƒ©å¤‰æ›´ã®ãƒªãƒªãƒ¼ã‚¹ä¸­ã«äºˆæœŸã›ã¬ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹ã“ã¨ã¯ã¾ãšãªã„ã€‚ã—ã‹ã—ã€ã‚³ãƒ¼ãƒ‰åŒ–ãƒ„ãƒ¼ãƒ«ã§ã¯ã€å¤‰æ›´ã®ãƒªãƒªãƒ¼ã‚¹ä¸­ã«äºˆæœŸã›ã¬ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹å¯èƒ½æ€§ã¯æ±ºã—ã¦ä½ããªã„ãŸã‚ã€ãƒªãƒªãƒ¼ã‚¹ã®å¿ƒç†çš„ãƒãƒ¼ãƒ‰ãƒ«ãŒé«˜ããªã‚‹ã€‚ "},"public/infrastructure_as_code/infrastructure_as_code_terraform_command.html":{"url":"public/infrastructure_as_code/infrastructure_as_code_terraform_command.html","title":"ğŸ“– ï¸terraformã‚³ãƒãƒ³ãƒ‰","keywords":"","body":"terraformã‚³ãƒãƒ³ãƒ‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒãƒ³ãƒ‰ global option å‚è€ƒï¼šhttps://www.terraform.io/docs/cli/commands/index.html#switching-working-directory-with-chdir init ãƒ»-backend=false ãƒ­ãƒ¼ã‚«ãƒ«ã«stateãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.terraform.io/docs/language/settings/backends/index.html $ terraform init -backend=false # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ $ terraform -chdir= init -backend=false ãƒ»-backend=true, -backend-config å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã«stateãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ä»£ã‚ã‚Šã«ã€terraform settingsãƒ–ãƒ­ãƒƒã‚¯å†…ã®backendã§æŒ‡å®šã—ã¦ã‚‚è‰¯ã„ã€‚ãŸã ã—ã€terraform settingãƒ–ãƒ­ãƒƒã‚¯å†…ã§ã¯å¤‰æ•°ã‚’ä½¿ç”¨ã§ããªã„ãŸã‚ã€ã“ã¡ã‚‰ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæ¨å¥¨ã§ã‚ã‚‹ã€‚ $ terraform init \\ -backend=true \\ -reconfigure \\ # ãƒã‚±ãƒƒãƒˆå -backend-config=\"bucket=foo-tfstate-bucket\" \\ # tfstateãƒ•ã‚¡ã‚¤ãƒ«å -backend-config=\"key=terraform.tfstate\" \\ # credentialsãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å -backend-config=\"profile=bar\" \\ -backend-config=\"encrypt=true\" ãƒ»-reconfigure Terraformã‚’åˆæœŸåŒ–ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.terraform.io/docs/cli/commands/init.html#backend-initialization $ terraform init -reconfigure ãƒ»-upgrade ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«åŸºã¥ã„ã¦ã€lockãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://www.terraform.io/docs/cli/commands/init.html#upgrade $ terraform init -upgrade validate ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼ã‚’è¡Œã†ã€‚ $ terraform validate Success! The configuration is valid. # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ $ terraform -chdir= validate fmt ãƒ»-check ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã‚‹ã¹ãç®‡æ‰€ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ã€‚ã‚‚ã—å­˜åœ¨ã™ã‚‹å ´åˆã€1ã€ã€å­˜åœ¨ã—ãªã„å ´åˆã¯ã€0ã€ã‚’è¿”å´ã™ã‚‹ã€‚ $ terraform fmt -check ãƒ»-recursive è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã‚‹ã€‚å‡¦ç†ã‚’è¡Œã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ # -recursive: ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å«ã‚€å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ $ terraform fmt -recursive main.tf graph rosourceé–“ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚°ãƒ©ãƒ•åŒ–ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã©ã®resourceãŒä»–ã®ã©ã®resourceã‚’ç”¨ã„ã¦ã„ã‚‹ã‹ãŒã‚ã‹ã‚‹ã€‚Graphvizã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://graphviz.org/download/ $ terraform graph | dot -Tsvg > graph.svg import ãƒ»-var-file terraformã«ã‚ˆã‚‹æ§‹ç¯‰ã§ã¯ãªã„æ–¹æ³•ã§ã€ã™ã§ã«ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã«ãƒªã‚½ãƒ¼ã‚¹ãŒæ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã“ã‚Œã‚’terraformã®ç®¡ç†ä¸‹ã«ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã¨ãƒªã‚½ãƒ¼ã‚¹åã‚’æŒ‡å®šã—ã€stateãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®çŠ¶æ…‹ã‚’æ›¸ãè¾¼ã‚€ã€‚ç¾çŠ¶ã€å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä¸€æ‹¬ã—ã¦importã™ã‚‹æ–¹æ³•ã¯ç„¡ã„ã€‚ãƒªã‚½ãƒ¼ã‚¹IDã¯ã€ãƒªã‚½ãƒ¼ã‚¹ã«ã‚ˆã£ã¦ç•°ãªã‚‹ãŸã‚ã€ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã€Importã€ã¾ãŸã¯ã€Attributes Referenceã®idã€ã‚’ç¢ºèªã™ã‚‹ã“ã¨ï¼ˆä¾‹ãˆã°ã€ACMã«ã¨ã£ã¦ã®IDã¯ARNã ãŒã€S3ãƒã‚±ãƒƒãƒˆã«ã¨ã£ã¦ã®IDã¯ãƒã‚±ãƒƒãƒˆåã§ã‚ã‚‹ï¼‰ã€‚ $ terraform import \\ -var-file=foo.tfvars \\ . ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€æŒ‡å®šã®æ–¹æ³•ãŒç•°ãªã‚‹ã€‚ $ terraform import \\ -var-file=foo.tfvars \\ module... ä¾‹ãˆã°ã€AWSä¸Šã«ã™ã§ã«ECRãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã¨ã—ã¦ã€ã“ã‚Œã‚’terraformã®ç®¡ç†ä¸‹ã«ãŠãã€‚ $ terraform import \\ -var-file=foo.tfvars \\ module.ecr.aws_ecr_repository.www xxxxxxxxx ãã—ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®stateãƒ•ã‚¡ã‚¤ãƒ«ã¨å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®å·®åˆ†ãŒç„¡ããªã‚‹ã¾ã§ã€importã‚’ç¹°ã‚Šè¿”ã™ã€‚ $ terraform plan -var-file=foo.tfvars No changes. Infrastructure is up-to-date. ãƒ»importã‚’è¡Œã‚ãªã‹ã£ãŸå ´åˆã®ã‚¨ãƒ©ãƒ¼ ã‚‚ã—importã‚’è¡Œã‚ãªã„ã¨ã€ã™ã§ã«ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã«ãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ãŸã‚ã«ãƒªã‚½ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã§ããªã„ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ ï¼ˆã‚¨ãƒ©ãƒ¼ä¾‹1ï¼‰ Error: InvalidParameterException: Creation of service was not idempotent. ï¼ˆã‚¨ãƒ©ãƒ¼ä¾‹2ï¼‰ Error: error creating ECR repository: RepositoryAlreadyExistsException: The repository with name 'f' already exists in the registry with id 'XXXXXXXXXXXX' refresh ãƒ»-var-file ã‚¯ãƒ©ã‚¦ãƒ‰ã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã€ç¾åœ¨ã®ãƒªã‚½ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’tfstateãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜ ã™ã‚‹ã€‚ $ terraform refresh -var-file=foo.tfvars plan ãƒ»ã‚·ãƒ³ãƒœãƒ«ã®è¦‹æ–¹ æ§‹ç¯‰ï¼ˆ+ï¼‰ã€æ›´æ–°ï¼ˆ~ï¼‰ã€å‰Šé™¤ï¼ˆ-ï¼‰ã€å†æ§‹ç¯‰ï¼ˆ-/+ï¼‰ã§è¡¨ç¾ã•ã‚Œã‚‹ã€‚ + create ~ update in-place - destroy -/+ destroy and then create replacement ãƒ»å‡ºåŠ›å†…å®¹ã®èª­ã¿æ–¹ å‰åŠéƒ¨åˆ†ã¨å¾ŒåŠéƒ¨åˆ†ã«åŒºåˆ¥ã•ã‚Œã¦ã„ã‚‹ã€‚å‰åŠéƒ¨åˆ†ã¯ã€Terraformç®¡ç†å¤–ã®æ–¹æ³•ï¼ˆç”»é¢ä¸Šã€ä»–ãƒ„ãƒ¼ãƒ«ï¼‰ã«ã‚ˆã‚‹å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®å¤‰æ›´ã«ã¤ã„ã¦ã€ãã®å¤‰æ›´å‰å¾Œã‚’æ¤œå‡ºã™ã‚‹ã€‚ãŸã ã®æ¤œå‡ºã®ãŸã‚ã€applyã«ã‚ˆã£ã¦å¤‰æ›´ã•ã‚Œã‚‹å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã‚’è¡¨ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚ãã—ã¦å¾ŒåŠéƒ¨åˆ†ã¯ã€Terraformã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã«ã‚ˆã£ã¦ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ãŒã©ã®ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã‚‹ã‹ã€ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚çµæœã®æœ€å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹å¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹ã®æ•°ã‚’ç¢ºèªã—ã¦ã‚‚ã€å‰åŠéƒ¨åˆ†ã®ãƒªã‚½ãƒ¼ã‚¹ã¯å«ã¾ã‚Œã¦ã„ãªã„ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ Note: Objects have changed outside of Terraform Terraform detected the following changes made outside of Terraform since the last \"terraform apply\": # Terraformç®¡ç†å¤–ã®æ–¹æ³•ï¼ˆç”»é¢ä¸Šã€ä»–ãƒ„ãƒ¼ãƒ«ï¼‰ã«ã‚ˆã‚‹å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®å¤‰æ›´ã«ã¤ã„ã¦ã€ãã®å¤‰æ›´å‰å¾Œã‚’æ¤œå‡ºã€‚ Unless you have made equivalent changes to your configuration, or ignored the relevant attributes using ignore_changes, the following plan may include actions to undo or respond to these changes. â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols: ~ update in-place Terraform will perform the following actions: # Terraformã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã«ã‚ˆã£ã¦ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ãŒã©ã®ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã‚‹ã‹ã€‚ Plan: 0 to add, 1 to change, 0 to destroy. ãƒ»å·®åˆ†èªè­˜ã•ã‚Œã‚‹ï¼ã•ã‚Œãªã„å¤‰æ›´ å¤‰æ›´å†…å®¹ ã•ã‚Œã‚‹ï¼ã•ã‚Œãªã„ ãƒªã‚½ãƒ¼ã‚¹åã®å¤‰æ›´ ã•ã‚Œã‚‹ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã®å¤‰æ›´ ã•ã‚Œã‚‹ ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ãƒ‘ã‚¹ã®å¤‰æ›´ ã•ã‚Œãªã„ ãƒªã‚½ãƒ¼ã‚¹ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸå€¤ã‚’ç’°å¢ƒå¤‰æ•°ã«å¤‰æ›´ï¼ˆtfvarsãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»è¡Œï¼‰ ã•ã‚Œãªã„ ãƒ»-var-file ã‚¯ãƒ©ã‚¦ãƒ‰ã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã€ç¾åœ¨ã®ãƒªã‚½ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’tfstateãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯åæ˜ ã›ãšã«ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è¨˜è¿°ã¨ã®å·®åˆ†ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œæ™‚ã«ã€å¤‰æ•°ãŒå®šç¾©ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€variableã§å®£è¨€ã—ãŸå¤‰æ•°ã«ã€å€¤ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ $ terraform plan -var-file=foo.tfvars # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ # ç¬¬ä¸€å¼•æ•°ã§å¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ç›¸å¯¾ãƒ‘ã‚¹ã€ç¬¬äºŒå¼•æ•°ã§ã‚’ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ç›¸å¯¾ãƒ‘ã‚¹ $ terraform plan -chdir= \\ -var-file=/foo.tfvars å·®åˆ†ãŒãªã‘ã‚Œã°ã€ä»¥ä¸‹ã®é€šã‚Šã«ãªã‚‹ã€‚ No changes. Infrastructure is up-to-date. This means that Terraform did not detect any differences between your configuration and real physical resources that exist. As a result, no actions need to be performed. ãƒ»-target ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€planã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ terraform plan \\ -var-file=foo.tfvars \\ -target=. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€æŒ‡å®šã®æ–¹æ³•ãŒç•°ãªã‚‹ã€‚ $ terraform plan \\ -var-file=foo.tfvars \\ -target=module... ãƒ»-refresh ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚Œã°ã€refreshã‚³ãƒãƒ³ãƒ‰ã‚’åŒæ™‚ã«å®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã€‚ãŸã ã€æ¨™æº–ã§trueãªã®ã§ã€ä¸è¦ã§ã‚ã‚‹ã€‚ $ terraform plan \\ -var-file=foo.tfvars \\ -refresh=true https://github.com/hashicorp/terraform/issues/17311 ãƒ»-parallelism ä¸¦åˆ—å‡¦ç†æ•°ã‚’è¨­å®šã§ãã‚‹ã€‚æ¨™æº–å€¤ã¯10ã§ã‚ã‚‹ã€‚ $ terraform plan \\ -var-file=foo.tfvars \\ -parallelism=30 ãƒ»-out å®Ÿè¡Œãƒ—ãƒ©ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ã€‚applyã‚³ãƒãƒ³ãƒ‰ã®ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ã€‚ $ terraform plan \\ -var-file=foo.tfvars \\ # å®Ÿè¡Œãƒ—ãƒ©ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«å -out=foo.tfplan apply ãƒ»-var-file AWSä¸Šã«ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ $ terraform apply -var-file foo.tfvars # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ $ terraform -chdir= apply \\ -var-file=/foo.tfvars æˆåŠŸã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ Apply complete! Resources: 1 added, 0 changed, 0 destroyed. ãƒ»-target ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€applyã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ terraform apply \\ -var-file=foo.tfvars \\ -target=. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€æŒ‡å®šã®æ–¹æ³•ãŒç•°ãªã‚‹ã€‚ $ terraform apply \\ -var-file=foo.tfvars \\ -target=module... ãƒ»-parallelism ä¸¦åˆ—å‡¦ç†æ•°ã‚’è¨­å®šã§ãã‚‹ã€‚æ¨™æº–å€¤ã¯10ã§ã‚ã‚‹ã€‚ $ terraform apply \\ -var-file=foo.tfvars \\ -parallelism=30 ãƒ»å®Ÿè¡Œãƒ—ãƒ©ãƒ³ãƒ•ã‚¡ã‚¤ãƒ« äº‹å‰ã«ã€planã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸå®Ÿè¡Œãƒ—ãƒ©ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ã€applyã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚å®Ÿè¡Œãƒ—ãƒ©ãƒ³ã‚’æ¸¡ã™å ´åˆã¯ã€å¤‰æ•°ã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¨­å®šã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ $ terraform apply foo.tfplan taint ãƒ»-var-file stateãƒ•ã‚¡ã‚¤ãƒ«ã«ãŠã‘ã‚‹æŒ‡å®šã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®taintedãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹ã€‚ä¾‹ãˆã°ã€applyã—ãŸãŒã€é€”ä¸­ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã«ä¸­é€”åŠç«¯ã¯ãƒªã‚½ãƒ¼ã‚¹ãŒæ§‹ç¯‰ã•ã‚Œã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚ã“ã“ã§ã€taintedã‚’ç«‹ã¦ã¦ãŠãã¨ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ãŸã¨æƒ³å®šã—ãŸplanã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ $ terraform taint \\ -var-file=foo.tfvars \\ module... ã“ã®å¾Œã®planã‚³ãƒãƒ³ãƒ‰ã®ãƒ­ã‚°ã‹ã‚‰ã‚‚ã€-/+ã§å‰Šé™¤ãŒè¡Œã‚ã‚Œã‚‹æƒ³å®šã§ã€å·®åˆ†ã‚’æ¯”è¼ƒã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ $ terraform plan -var-file=foo.tfvars An execution plan has been generated and is shown below. Resource actions are indicated with the following symbols: -/+ destroy and then create replacement Terraform will perform the following actions: -/+ . (tainted) (new resource required) id: '1492336661259070634' => (forces new resource) Plan: 1 to add, 0 to change, 1 to destroy. state list ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§å®šç¾©ã—ã¦ã„ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ terraform state list ä»¥ä¸‹ã®é€šã‚Šã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚‚å«ã‚ã¦ã€ãƒªã‚½ãƒ¼ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ aws_instance.www-1a aws_instance.www-1c aws_key_pair.key_pair module.alb_module.aws_alb.alb module.ami_module.data.aws_ami.amazon_linux_2 module.route53_module.aws_route53_record.r53_record module.route53_module.aws_route53_zone.r53_zone module.security_group_module.aws_security_group.security_group_alb module.security_group_module.aws_security_group.security_group_ecs module.security_group_module.aws_security_group.security_group_instance module.vpc_module.aws_internet_gateway.internet_gateway module.vpc_module.aws_route_table.route_table_public module.vpc_module.aws_route_table_association.route_table_association_public_1a module.vpc_module.aws_route_table_association.route_table_association_public_1c module.vpc_module.aws_subnet.subnet_public_1a module.vpc_module.aws_subnet.subnet_public_1c module.vpc_module.aws_vpc.vpc "},"public/infrastructure_as_code/infrastructure_as_code_terraform_implementation.html":{"url":"public/infrastructure_as_code/infrastructure_as_code_terraform_implementation.html","title":"ğŸ“– ï¸Terraformã®å®Ÿè£…","keywords":"","body":"Terraformã®å®Ÿè£… ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† ãƒ»lockãƒ•ã‚¡ã‚¤ãƒ« ç¾åœ¨ä½¿ç”¨ä¸­ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå®šç¾©ã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä»–ã®äººãŒãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã‚‹æ™‚ã«ã€ç•°ãªã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’å®£è¨€ã§ããªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚‚ã—ã€ç•°ãªã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç”¨ã„ãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€lockãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ $ terraform init -upgrade Terraformï¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ 1. ç¾åœ¨ã®Terraformã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§applyã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¨åŒæ™‚ã«æ–°ã—ã„AWSãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã›ãšã«ã€ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã®ã¿ã«å°‚å¿µã™ã‚‹ã€‚ãã®ãŸã‚ã«ã€ç¾åœ¨ã®Terraformã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§applyã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€å·®åˆ†ãŒç„¡ã„ã‚ˆã†ã«ã—ã¦ãŠãã€‚ 2. ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ä»¥å¤–ã®ä½œæ¥­ã‚’æ¸ˆã¾ã›ã¦ãŠã ä½ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Terraformã«å¯¾ã—ã¦ã€ã‚ˆã‚Šé«˜ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã‚ã‚‹ã€‚åå¯¾ã«ã€é«˜ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Terraoformã«å¯¾ã—ã¦ã€ã‚ˆã‚Šä½ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ããªã„ã€‚ãã®ãŸã‚ã€ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦ã—ã¾ã†ã¨ã€ãã‚Œä»¥å¤–ã®Teraformãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç•°ãªã‚‹ä½œæ¥­ã«å½±éŸ¿ãŒå‡ºã‚‹ã€‚ 3. ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³å˜ä½ã§ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ Terraformã§ã¯ã€ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³å˜ä½ã§ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’è¡Œã†ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã©ã‚“ãªã«é›¢ã‚Œã¦ã„ã¦ã‚‚ã€å¿…ãšä¸€ã¤ãšã¤ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹ã‚ˆã†ã«æ°—ã‚’ã¤ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.terraform.io/upgrade-guides/1-0.html 4. planã‚³ãƒãƒ³ãƒ‰ã®è­¦å‘Šï¼ã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆ ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã«ä¼´ã£ã¦ã€éæ¨å¥¨ï¼å»ƒæ­¢ã®æ©Ÿèƒ½ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã€è­¦å‘Šï¼ã‚¨ãƒ©ãƒ¼ãŒå‡ºåŠ›ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚‹ã€‚è­¦å‘Šï¼ã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆã§ãã‚‹ã‚ˆã†ã«ã€è¨˜æ³•ã‚„ã‚ªãƒ—ã‚·ãƒ§ãƒ³å€¤ã‚’ä¿®æ­£ã™ã‚‹ã€‚å ´åˆã«ã‚ˆã£ã¦ã¯tfstateãƒ•ã‚¡ã‚¤ãƒ«ã®å·®åˆ†ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã ã‘ã§ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã¨ã®å·®åˆ†ã§ã¯ãªã„å ´åˆã‚‚ã‚ã‚‹ãŸã‚ã€planã§å·®åˆ†ãŒã‚ã£ãŸã¨ã—ã¦ã‚‚ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã«å½±éŸ¿ãŒãªã‘ã‚Œã°å•é¡Œãªã„ã€‚ 5. ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ãŸã„å ´åˆã¯Terraformã‚‚ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ Terraformã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ç‹¬ç«‹ã—ã¦ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ã€‚ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯TerraformãŒåœŸå°ã«ãªã£ã¦ç¨¼åƒã™ã‚‹ãŸã‚ã€ã‚‚ã—ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ãŸã„å ´åˆã¯ã€Terraformã‚‚ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹ã€‚ä¸€æ–¹ã§ã€Terraformã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ãŸã„å ´åˆã¯ã€å¿…ãšã—ã‚‚ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ 6. Terraformã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¯åˆ¥ã€…ã«ãƒªãƒªãƒ¼ã‚¹ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ãŸã„å ´åˆã¯Terraformã‚‚ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã“ã®å ´åˆã€å¯èƒ½ã§ã‚ã‚Œã°ãƒªãƒªãƒ¼ã‚¹ã¯åˆ†ã‘ãŸæ–¹ãŒè‰¯ã„ã€‚Terraformã¾ãŸã¯ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’åˆ¥ã€…ã«ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã‚ˆã†ã«ã™ã‚Œã°ã€ãƒªãƒªãƒ¼ã‚¹æ™‚ã«ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒèµ·ã“ã£ãŸæ™‚ã«ã€ã©ã¡ã‚‰ãŒåŸå› ãªã®ã‹ã‚’æ˜ç¢ºåŒ–ã§ãã‚‹ã€‚åå¯¾ã«ã€ä¸€ç·’ã«ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã—ã¾ã†ã¨ã©ã¡ã‚‰ãŒåŸå› ãªã®ã‹ã‚ã‹ã‚Šã«ãããªã£ã¦ã—ã¾ã†ã€‚ 01-02. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ§‹æˆ ãƒ»ç¨¼åƒç’°å¢ƒåˆ¥ ç¨¼åƒç’°å¢ƒåˆ¥ã«ã€foo.tfvarsãƒ•ã‚¡ã‚¤ãƒ«ã§å€¤ã‚’å®šç¾©ã™ã‚‹ã€‚ terraform_project/ â”œâ”€â”€ modules â”‚ â”œâ”€â”€ route53 # Route53 â”‚ â”‚ â”œâ”€â”€ dev # é–‹ç™º â”‚ | â”œâ”€â”€ prd # æœ¬ç•ª â”‚ | â””â”€â”€ stg # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚° â”‚ | â”‚ â”œâ”€â”€ ssm # SSM | | â”œâ”€â”€ dev â”‚ | â”œâ”€â”€ prd â”‚ | â””â”€â”€ stg â”‚ | â”‚ â””â”€â”€ waf # WAF | â”œâ”€â”€ dev â”‚ â”œâ”€â”€ prd â”‚ â””â”€â”€ stg | â”œâ”€â”€ dev # é–‹ç™ºç’°å¢ƒãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« â”‚ â”œâ”€â”€ dev.tfvars â”‚ â”œâ”€â”€ main.tf â”‚ â”œâ”€â”€ providers.tf â”‚ â”œâ”€â”€ tfnotify.yml â”‚ â””â”€â”€ variables.tf â”‚ â”œâ”€â”€ prd # æœ¬ç•ªç’°å¢ƒãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« â”‚ â”œâ”€â”€ prd.tfvars â”‚ â”œâ”€â”€ main.tf â”‚ â”œâ”€â”€ providers.tf â”‚ â”œâ”€â”€ tfnotify.yml â”‚ â””â”€â”€ variables.tf â”‚ â””â”€â”€ stg # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« â”œâ”€â”€ stg.tfvars â”œâ”€â”€ main.tf â”œâ”€â”€ providers.tf â”œâ”€â”€ tfnotify.yml â””â”€â”€ variables.tf ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ§‹æˆ ã€€ãƒ»å¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹åˆ¥ ä¸€ã¤ã®ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šãŒå¯¾è±¡ã®ãƒªã‚½ãƒ¼ã‚¹ã”ã¨ã«ç•°ãªã‚‹å ´åˆã€å†—é•·æ€§ã‚ˆã‚Šã‚‚ä¿å®ˆæ€§ã‚’é‡è¦–ã—ã¦ã€ãƒªã‚½ãƒ¼ã‚¹ã«å¿œã˜ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«åˆ†å‰²ã™ã‚‹ã€‚ terraform_project/ â””â”€â”€ modules â”œâ”€â”€ cloudwatch # CloudWatch â”‚ â”œâ”€â”€ alb # ALB | â”œâ”€â”€ cloudfront # CloudFront | â”œâ”€â”€ ecs # ECS | â”œâ”€â”€ lambda # Lambda | â””â”€â”€ rds # RDS | â””â”€â”€ waf # WAF â”œâ”€â”€ alb # ALB â”œâ”€â”€ api_gateway # API Gateway â””â”€â”€ cloudfront # CloudFront ãƒ»ç¨¼åƒç’°å¢ƒåˆ¥ ä¸€ã¤ã®ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šãŒç¨¼åƒç’°å¢ƒã”ã¨ã«ç•°ãªã‚‹å ´åˆã€å†—é•·æ€§ã‚ˆã‚Šã‚‚ä¿å®ˆæ€§ã‚’é‡è¦–ã—ã¦ã€ç¨¼åƒç’°å¢ƒã«å¿œã˜ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«åˆ†å‰²ã™ã‚‹ã€‚ terraform_project/ â””â”€â”€ modules â”œâ”€â”€ route53 # Route53 â”‚ â”œâ”€â”€ dev # é–‹ç™º | â”œâ”€â”€ prd # æœ¬ç•ª | â””â”€â”€ stg # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚° | â”œâ”€â”€ ssm # SSM | â”œâ”€â”€ dev | â”œâ”€â”€ prd | â””â”€â”€ stg | â””â”€â”€ waf # WAF â””â”€â”€ alb â”œâ”€â”€ dev â”œâ”€â”€ prd â””â”€â”€ stg ãƒ»ãƒªãƒ¼ã‚¸ãƒ§ãƒ³åˆ¥ ä¸€ã¤ã®ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šãŒãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«ç•°ãªã‚‹å ´åˆã€å†—é•·æ€§ã‚ˆã‚Šã‚‚ä¿å®ˆæ€§ã‚’é‡è¦–ã—ã¦ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«å¿œã˜ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«åˆ†å‰²ã™ã‚‹ã€‚ terraform_project/ â””â”€â”€ modules â””â”€â”€ acm # ACM â”œâ”€â”€ ap-northeast-1 # æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ â””â”€â”€ us-east-1 # ãƒãƒ¼ã‚¸ãƒ‹ã‚¢ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ ãƒ»å…±é€šã‚»ãƒƒãƒˆåˆ¥ WAFã§ç”¨ã„ã‚‹IPãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã¨æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã«ã¯ã€CloudFrontã‚¿ã‚¤ãƒ—ã¨Regionalã‚¿ã‚¤ãƒ—ãŒã‚ã‚‹ã€‚Regionalã‚¿ã‚¤ãƒ—ã¯ã€åŒã˜ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ç•°ãªã‚‹AWSãƒªã‚½ãƒ¼ã‚¹é–“ã§å…±é€šã—ã¦ä½¿ç”¨ã§ãã‚‹ãŸã‚ã€å…±é€šã‚»ãƒƒãƒˆã¨ã—ã¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåˆ†å‰²ã‚’è¡Œã†ã€‚ terraform_project/ â””â”€â”€ modules â””â”€â”€ waf # WAF â”œâ”€â”€ alb â”œâ”€â”€ api_gateway â”œâ”€â”€ cloudfront â””â”€â”€ regional_sets # Regionalã‚¿ã‚¤ãƒ—ã®ã‚»ãƒƒãƒˆ â”œâ”€â”€ ip_sets # IPã‚»ãƒƒãƒˆ | â”œâ”€â”€ prd | â””â”€â”€ stg | â””â”€â”€ regex_pattern_sets # æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ â”œâ”€â”€ prd â””â”€â”€ stg ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ‡ã‚Šåˆ†ã‘ ãƒãƒªã‚·ãƒ¼ã®ãŸã‚ã«JSONã‚’å®šç¾©ã™ã‚‹å ´åˆã€Terraformã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã›ãšã«ã€åˆ‡ã‚Šåˆ†ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã¾ãŸã€ã€ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã€ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã€ã€ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã€ã‚‚åŒºåˆ¥ã—ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åˆ†å‰²ã—ã¦ã„ã‚‹ã€‚ãªãŠã€templatefileãƒ¡ã‚½ãƒƒãƒ‰ã§ã“ã‚Œã‚’èª­ã¿ã“ã‚€æ™‚ã€bashãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãªãã€tplãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å®šç¾©ã—ã¦ãŠãå¿…è¦ã‚ã‚‹ãŸã‚ã€æ³¨æ„ã™ã‚‹ã€‚ terraform_project/ â””â”€â”€ modules â”œâ”€â”€ ecr #ECR â”‚ â””â”€â”€ ecr_lifecycle_policy.tpl # ECRãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« â”‚ â”œâ”€â”€ ecs # ECS â”‚ â””â”€â”€ container_definitions.tpl # ã‚³ãƒ³ãƒ†ãƒŠå®šç¾© â”‚ â”œâ”€â”€ iam # IAM â”‚ â””â”€â”€ policies | â”œâ”€â”€ customer_managed_policies # ã‚«ã‚¹ã‚¿ãƒ ç®¡ç†ãƒãƒªã‚·ãƒ¼ | | â”œâ”€â”€ aws_cli_executor_access_policy.tpl | | â”œâ”€â”€ aws_cli_executor_access_address_restriction_policy.tpl | | â”œâ”€â”€ cloudwatch_logs_access_policy.tpl | | â””â”€â”€ lambda_edge_execution_policy.tpl | | | â”œâ”€â”€ inline_policies # ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ | | â””â”€â”€ ecs_task_policy.tpl | | | â””â”€â”€ trust_policies # ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ | â”œâ”€â”€ cloudwatch_events_policy.tpl | â”œâ”€â”€ ecs_task_policy.tpl | â”œâ”€â”€ lambda_policy.tpl | â””â”€â”€ rds_policy.tpl | â””â”€â”€ s3 # S3 â””â”€â”€ policies # ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ â””â”€â”€ alb_bucket_policy.tpl CI/CDãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ãƒ»opsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª Terraformã®CI/CDã§å¿…è¦ãªã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€opsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ç®¡ç†ã™ã‚‹ã€‚ terraform_project/ â”œâ”€â”€ .circleci # CI/CDãƒ„ãƒ¼ãƒ«ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« â””â”€â”€ ops # Terraformã®CI/CDã®è‡ªå‹•åŒ–ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ 02. ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ãŠã‘ã‚‹å®Ÿè£… tfstateãƒ•ã‚¡ã‚¤ãƒ« ãƒ»tfstateãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®ã‚¤ãƒ³ãƒ•ãƒ©ã®çŠ¶æ…‹ãŒå®šç¾©ã•ã‚ŒãŸjsonãƒ•ã‚¡ã‚¤ãƒ«ã®ã“ã¨ã€‚åˆå›æ™‚ã€applyã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€æˆåŠŸã‚‚ã—ãã¯å¤±æ•—ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ç”Ÿæˆã•ã‚Œã‚‹ã€‚ terraform settings ãƒ»terraform settingsã¨ã¯ terraformã®å®Ÿè¡Œæ™‚ã«ã€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ ãƒ»required_providers AWSã‚„GCPãªã©ã€ç”¨ã„ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ—ãƒ­ãƒã‚¤ãƒ€ã«ã‚ˆã£ã¦ã€ç•°ãªã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ãŒæä¾›ã•ã‚Œã‚‹ã€‚ä¸€ç•ªæœ€åˆã«èª­ã¿ã“ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãŸã‚ã€å¤‰æ•°ã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ãªã©ãŒè¡Œãˆãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š terraform { required_providers { # awsãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’å®šç¾© aws = { # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚½ãƒ¼ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡å®š source = \"hashicorp/aws\" # ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´æ™‚ã¯ initã‚’å®Ÿè¡Œ version = \"3.0\" } } } ãƒ»backend stateãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç®¡ç†ã™ã‚‹å ´æ‰€ã‚’è¨­å®šã™ã‚‹ã€‚S3ãªã©ã®å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã§ç®¡ç†ã™ã‚‹å ´åˆã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ä»£ã‚ã‚Šã«ã€initã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã«æŒ‡å®šã—ã¦ã‚‚è‰¯ã„ã€‚æ¨™æº–å€¤ã¯localã§ã‚ã‚‹ã€‚å¤‰æ•°ã‚’ä½¿ç”¨ã§ããšã€ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ã‚‚ã—å€¤ã‚’å‹•çš„ã«å¤‰æ›´ã—ãŸã„å ´åˆã¯ã€initã‚³ãƒãƒ³ãƒ‰ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦å€¤ã‚’æ¸¡ã™ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.terraform.io/docs/language/settings/backends/s3.html#credentials-and-shared-configuration ï¼Šå®Ÿè£…ä¾‹ï¼Š terraform { # ãƒ­ãƒ¼ã‚«ãƒ«PCã§ç®¡ç†ã™ã‚‹ã‚ˆã†ã«è¨­å®š backend \"local\" { path = \"${path.module}/terraform.tfstate\" } } terraform { # S3ã§ç®¡ç†ã™ã‚‹ã‚ˆã†ã«è¨­å®š backend \"s3\" { # ãƒã‚±ãƒƒãƒˆå bucket = \"foo-tfstate-bucket\" # stateãƒ•ã‚¡ã‚¤ãƒ«å key = \"terraform.tfstate\" region = \"ap-northeast-1\" # credentialsãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ shared_credentials_file = \"$HOME/.aws/credentials\" # credentialsãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å profile = \"bar-profile\" } } ã©ã®ãƒ¦ãƒ¼ã‚¶ã‚‚ãƒã‚±ãƒƒãƒˆå†…ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤ã§ããªã„ã‚ˆã†ã«ã€ãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã—ã¦ãŠãã¨ã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"Version\": \"2008-10-17\", \"Statement\": [ { \"Effect\": \"Deny\", \"Principal\": \"*\", \"Action\": \"s3:DeleteObject\", \"Resource\": \"arn:aws:s3:::foo-tfstate-bucket/*\" } ] } provider ãƒ»providerã¨ã¯ Terraformã§æ“ä½œã™ã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ãƒ™ãƒ³ãƒ€ãƒ¼ã§ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼ã®ãŸã‚ã€ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«æƒ…å ±ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š terraform { required_version = \"0.13.5\" required_providers { # awsãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’å®šç¾© aws = { # ä½•ã‚‰ã‹ã®è¨­å®š } } backend \"s3\" { # ä½•ã‚‰ã‹ã®è¨­å®š } } # awsãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’æŒ‡å®š provider \"aws\" { # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼ã®è¨­å®š } multiple providers ãƒ»multiple providersã¨ã¯ è¤‡æ•°ã®providerã‚’å®Ÿè£…ã—ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ç”¨ã„ã¦ã€ã“ã‚Œã‚‰ã‚’å‹•çš„ã«åˆ‡ã‚Šæ›¿ãˆã‚‹æ–¹æ³•ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š terraform { required_version = \"0.13.5\" required_providers { aws = { source = \"hashicorp/aws\" version = \"3.0\" } } } provider \"aws\" { # æ¨™æº–å€¤ã¨ã™ã‚‹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ region = \"ap-northeast-1\" } provider \"aws\" { # åˆ¥ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ alias = \"ue1\" region = \"us-east-1\" } ãƒ»å­ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§providerã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ å­ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§providerã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã«ã¯ã€ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§providerã®å€¤ã‚’æ˜ç¤ºçš„ã«æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š module \"route53\" { source = \"../modules/route53\" providers = { aws = aws.ue1 } # ãã®ä»–ã®è¨­å®šå€¤ } ã•ã‚‰ã«å­ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã€providerã®å€¤ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # Route53 ############################################### resource \"aws_acm_certificate\" \"example\" { # CloudFrontã®ä»•æ§˜ã®ãŸã‚ã€us-east-1ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§SSLè¨¼æ˜æ›¸ã‚’ä½œæˆã—ã¾ã™ã€‚ provider = aws domain_name = \"example.co.jp\" subject_alternative_names = [\"*.example.co.jp\"] validation_method = \"DNS\" tags = { Name = \"prd-foo-example-cert\" } lifecycle { create_before_destroy = true } } ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã®è¨­å®šæ–¹æ³• ãƒ»ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«ã‚ˆã‚‹è¨­å®š ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ä»–ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§è¨­å®šã™ã‚‹ã€‚èª¤ã£ã¦ã‚³ãƒŸãƒƒãƒˆã—ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š terraform { required_version = \"0.13.5\" required_providers { aws = { source = \"hashicorp/aws\" version = \"3.0\" } } backend \"s3\" { bucket = \"foo-tfstate-bucket\" key = \"terraform.tfstate\" region = \"ap-northeast-1\" # ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ access_key = \"*****\" # ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ secret_key = \"*****\" } } provider \"aws\" { region = \"ap-northeast-1\" # ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ access_key = \"*****\" # ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ secret_key = \"*****\" } ãƒ»credentialsãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹è¨­å®š ã€€AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã¯ã€~/.aws/credentialsãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã€‚ # æ¨™æº–ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« [default] aws_access_key_id=***** aws_secret_access_key=***** # ç‹¬è‡ªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« [bar-profile] aws_access_key_id=***** aws_secret_access_key=***** credentialsãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å‡ºã—ã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¨­å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’å‚ç…§ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š terraform { required_version = \"0.13.5\" required_providers { aws = { source = \"hashicorp/aws\" version = \"3.0\" } } # credentialsãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã‚’èª­ã¿è¾¼ã‚€ backend \"s3\" { # ãƒã‚±ãƒƒãƒˆå bucket = \"foo-tfstate-bucket\" # stateãƒ•ã‚¡ã‚¤ãƒ«å key = \"terraform.tfstate\" region = \"ap-northeast-1\" # credentialsãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ shared_credentials_file = \"$HOME/.aws/credentials\" # credentialsãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å profile = \"bar-profile\" } } # credentialsãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã‚’èª­ã¿è¾¼ã‚€ provider \"aws\" { region = \"ap-northeast-1\" profile = \"foo\" shared_credentials_file = \"$HOME/.aws/\" } ãƒ»ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹è¨­å®š Credentialsãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãªãã€exportã‚’ç”¨ã„ã¦ã€å¿…è¦ãªæƒ…å ±ã‚’è¨­å®šã—ã¦ãŠãã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚å‚ç…§ã§ãã‚‹ç’°å¢ƒå¤‰æ•°åã¯æ±ºã¾ã£ã¦ã„ã‚‹ã€‚ # regionã®ä»£ã‚ã‚Š $ export AWS_DEFAULT_REGION=\"ap-northeast-1\" # access_keyã®ä»£ã‚ã‚Š $ export AWS_ACCESS_KEY_ID=\"*****\" # secret_keyã®ä»£ã‚ã‚Š $ export AWS_SECRET_ACCESS_KEY=\"*****\" # profileã®ä»£ã‚ã‚Š $ export AWS_PROFILE=\"bar-profile\" #tokenã®ä»£ã‚ã‚Šï¼ˆAmazonSTSã‚’ç”¨ã„ã‚‹å ´åˆï¼‰ $ export AWS_SESSION_TOKEN=\"*****\" ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ãŸä¸Šã§teraformã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€å€¤ãŒproviderã«è‡ªå‹•çš„ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚CircleCIã®ã‚ˆã†ãªã€ä¸€æ™‚çš„ã«ç’°å¢ƒå¤‰æ•°ãŒå¿…è¦ã«ãªã‚‹ã‚ˆã†ãªçŠ¶æ³ã§ã¯æœ‰åŠ¹ãªæ–¹æ³•ã§ã‚ã‚‹ã€‚ terraform { required_version = \"0.13.5\" required_providers { aws = { source = \"hashicorp/aws\" version = \"3.0\" } } # ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã¯ä¸è¦ backend \"s3\" { bucket = \"\" key = \"\" } } # ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã¯ä¸è¦ provider \"aws\" {} module ãƒ»moduleã¨ã¯ ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§å­ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ã€å­ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¯¾ã—ã¦å¤‰æ•°ã‚’æ¸¡ã™ã€‚ ãƒ»å®Ÿè£…æ–¹æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################### # ALB ############################### module \"alb\" { # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®Resourceã‚’å‚ç…§ source = \"../modules/alb\" # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä»–ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå€¤ã‚’æ¸¡ã™ã€‚ acm_certificate_api_arn = module.acm.acm_certificate_api_arn } 03. å¤‰æ•° ç’°å¢ƒå¤‰æ•° ãƒ»å„ªå…ˆé †ä½ ä¸Šã®é …ç›®ã»ã©å„ªå…ˆã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://www.terraform.io/docs/language/values/variables.html#variable-definition-precedence ãƒ»-varã€-var-file $ terraform plan -var=\"foo=foo\" $ terraform plan -var=\"foo=foo\" -var=\"bar=bar\" $ terraform plan -var-file=xxxxx.tfvars ãƒ»*.auto.tfvarsãƒ•ã‚¡ã‚¤ãƒ«ã€*.auto.tfvars.jsonãƒ•ã‚¡ã‚¤ãƒ« ãƒ»terraform.tfvars.jsonãƒ•ã‚¡ã‚¤ãƒ« ãƒ»terraform.tfvarsãƒ•ã‚¡ã‚¤ãƒ« #ã€€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ãªãã¨ã‚‚èª­ã¿è¾¼ã¾ã‚Œã‚‹ $ terraform plan ãƒ»TF_VAR_XXXXX ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ãŠãã¨è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚XXXXXã®éƒ¨åˆ†ãŒå¤‰æ•°åã¨ã—ã¦Terraformã«æ¸¡ã•ã‚Œã‚‹ã€‚ $ printenv TF_VAR_ecr_image_tag=foo tfvarsãƒ•ã‚¡ã‚¤ãƒ« ãƒ»tfvarsãƒ•ã‚¡ã‚¤ãƒ«ã®ç”¨é€” å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã«å…¥åŠ›ã—ãŸã„ç’°å¢ƒå¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚ã€terraform.tfvarsã€ã¨ã„ã†åå‰ã«ã™ã‚‹ã¨ã€terraformã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚å„ã‚µãƒ¼ãƒ“ã‚¹ã®é–“ã§å®Ÿè£…æ–¹æ³•ãŒåŒã˜ãŸã‚ã€VPCã®ã¿ä¾‹ã‚’ç¤ºã™ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################### # VPC ############################### vpc_cidr_block = \"n.n.n.n/n\" # IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›² ãƒ»å€¤ã®ãƒ‡ãƒ¼ã‚¿å‹ å˜ä¸€å€¤ã€listå‹ã€mapå‹ã§å®šç¾©ã§ãã‚‹ã€‚AZã€ã‚µãƒ–ãƒãƒƒãƒˆã®CIDRã€RDSã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—å€¤ã€ãªã©ã¯mapå‹ã¨ã—ã¦ä¿æŒã—ã¦ãŠãã¨ã‚ˆã„ã€‚ã¾ãŸã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã‚»ãƒƒãƒˆã€ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ãªã©ã¯listå‹ã¨ã—ã¦ä¿æŒã—ã¦ãŠãã¨ã‚ˆã„ã€‚ãªãŠã€RDSã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®é©æ­£å€¤ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws.html ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # RDS ############################################### variable \"rds_parameter_group_values\" { type = map(string) } ############################################### # VPC ############################################### variable \"vpc_availability_zones\" { type = map(string) } variable \"vpc_cidr\" { type = string } variable \"vpc_endpoint_port_https\" { type = number } variable \"vpc_subnet_private_datastore_cidrs\" { type = map(string) } variable \"vpc_subnet_private_app_cidrs\" { type = map(string) } variable \"vpc_subnet_public_cidrs\" { type = map(string) } ############################################### # WAF ############################################### variable \"waf_allowed_global_ip_addresses\" { type = list(string) } variable \"waf_blocked_user_agents\" { type = list(string) } ############################################### # RDS ############################################### rds_parameter_group_values = { time_zone = \"asia/tokyo\" character_set_client = \"utf8mb4\" character_set_connection = \"utf8mb4\" character_set_database = \"utf8mb4\" character_set_results = \"utf8mb4\" character_set_server = \"utf8mb4\" server_audit_events = \"connect,query,query_dcl,query_ddl,query_dml,table\" server_audit_logging = 1 server_audit_logs_upload = 1 general_log = 1 slow_query_log = 1 long_query_time = 3 } ############################################### # VPC ############################################### vpc_availability_zones = { a = \"a\", c = \"c\" } vpc_cidr = \"n.n.n.n/23\" vpc_subnet_private_datastore_cidrs = { a = \"n.n.n.n/27\", c = \"n.n.n.n/27\" } vpc_subnet_private_app_cidrs = { a = \"n.n.n.n/25\", c = \"n.n.n.n/25\" } vpc_subnet_public_cidrs = { a = \"n.n.n.n/27\", c = \"n.n.n.n/27\" } ############################################### # WAF ############################################### waf_allowed_global_ip_addresses = [ \"n.n.n.n/32\", \"n.n.n.n/32\", ] waf_blocked_user_agents = [ \"XXXXX\", \"YYYYY\" ] variable ãƒ»variableã¨ã¯ ãƒªã‚½ãƒ¼ã‚¹ã§ç”¨ã„ã‚‹å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # ECS ############################################### variable \"ecs_container_laravel_port_http\" { type = number } variable \"ecs_container_nginx_port_http\" { type = number } ############################################### # RDS ############################################### variable \"rds_auto_minor_version_upgrade\" { type = bool } variable \"rds_instance_class\" { type = string } variable \"rds_parameter_group_values\" { type = map(string) } 04. ãƒªã‚½ãƒ¼ã‚¹ã®å®Ÿè£… resource ãƒ»resourceã¨ã¯ AWSã®APIã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã®æ§‹ç¯‰ã‚’è¡Œã†ã€‚ ãƒ»å®Ÿè£…æ–¹æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # ALB ############################################### resource \"aws_lb\" \"this\" { name = \"prd-foo-alb\" load_balancer_type = \"application\" security_groups = [\"*****\"] subnets = [\"*****\",\"*****\"] } data ãƒ»dataã¨ã¯ AWSã®APIã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€‚ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ãŒã€å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å®Ÿè£…ã—ãŸæ–¹ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã€‚ ãƒ»å®Ÿè£…æ–¹æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€ã‚¿ã‚¹ã‚¯å®šç¾©åã‚’æŒ‡å®šã—ã¦ã€AWSã‹ã‚‰ ############################################### # ECS task definition ############################################### data \"aws_ecs_task_definition\" \"this\" { task_definition = \"prd-foo-ecs-task-definition\" } ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€AMIã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸä¸Šã§ã€AWSã‹ã‚‰ç‰¹å®šã®AMIã®å€¤ã‚’å–å¾—ã™ã‚‹ã€‚ ############################################### # AMI ############################################### data \"aws_ami\" \"bastion\" { most_recent = true owners = [\"amazon\"] filter { name = \"architecture\" values = [\"x86_64\"] } filter { name = \"root-device-type\" values = [\"ebs\"] } filter { name = \"name\" values = [\"amzn-ami-hvm-*\"] } filter { name = \"virtualization-type\" values = [\"hvm\"] } filter { name = \"block-device-mapping.volume-type\" values = [\"gp2\"] } } output ãƒ»outputã¨ã¯ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§æ§‹ç¯‰ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ãŒã‚‚ã¤ç‰¹å®šã®å€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚å¯èª­æ€§ã®è¦³ç‚¹ã‹ã‚‰ã€ãƒªã‚½ãƒ¼ã‚¹ä¸€æ‹¬ã§ã¯ãªãã€å…·ä½“çš„ãªattributeã‚’ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã™ã‚‹ã€‚ ãƒ»å®Ÿè£…æ–¹æ³• ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€ALBã‚’ç¤ºã™ã€‚resourceãƒ–ãƒ­ãƒƒã‚¯ã¨dataãƒ–ãƒ­ãƒƒã‚¯ã§ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®æ–¹æ³•ãŒç•°ãªã‚‹ã€‚ ############################################### # ALB ############################################### output \"alb_zone_id\" { value = aws_lb.this.zone_id } output \"elb_service_account_arn\" { value = data.aws_elb_service_account.this.arn } ãƒ»counté–¢æ•°ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ ãƒ»for_eaché–¢æ•°ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ 05. ãƒ¡ã‚¿å¼•æ•° ãƒ¡ã‚¿å¼•æ•°ã¨ã¯ å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã§ä½¿ç”¨ã§ãã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã“ã¨ã€‚ depends_on ãƒ»depends_onã¨ã¯ ãƒªã‚½ãƒ¼ã‚¹é–“ã®ä¾å­˜é–¢ä¿‚ã‚’æ˜ç¤ºçš„ã«å®šç¾©ã™ã‚‹ã€‚Terraformã§ã¯ã€åŸºæœ¬çš„ã«ãƒªã‚½ãƒ¼ã‚¹é–“ã®ä¾å­˜é–¢ä¿‚ãŒæš—é»™çš„ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚ã—ã‹ã—ã€è¤‡æ•°ã®ãƒªã‚½ãƒ¼ã‚¹ãŒé–¢ã‚ã‚‹ã¨ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’é©åˆ‡ãªé †ç•ªã§æ§‹ç¯‰ã§ããªã„å ´åˆãŒã‚ã‚‹ãŸã‚ã€ãã†ã„ã£ãŸã¨ãã«ç”¨ã„ã‚‹ã€‚ ãƒ»ALB target group vs. ALBã€ECS ä¾‹ã¨ã—ã¦ã€ALB target groupã‚’ç¤ºã™ã€‚ALB Target groupã¨ALBã®ãƒªã‚½ãƒ¼ã‚¹ã‚’é©åˆ‡ãªé †ç•ªã§æ§‹ç¯‰ã§ããªã„ãŸã‚ã€ECSã®æ§‹ç¯‰æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹ã€‚ALBã®å¾Œã«ALB target groupã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # ALB target group ############################################### resource \"aws_lb_target_group\" \"this\" { name = \"prd-foo-alb-tg\" port = 80 protocol = \"HTTP\" vpc_id = \"*****\" deregistration_delay = \"60\" target_type = \"ip\" slow_start = \"60\" health_check { interval = 30 path = \"/healthcheck\" protocol = \"HTTP\" timeout = 5 unhealthy_threshold = 2 matcher = 200 } depends_on = [aws_lb.this] } ãƒ»Internet Gateway vs. EC2ã€Elastic IPã€NAT Gateway ä¾‹ã¨ã—ã¦ã€NAT Gatewayã‚’ç¤ºã™ã€‚NAT Gatewayã€Internet Gatewayã€ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’é©åˆ‡ãªé †ç•ªã§æ§‹ç¯‰ã§ããªã„ãŸã‚ã€Internet Gatewayã®æ§‹ç¯‰å¾Œã«ã€NAT Gatewayã‚’æ§‹ç¯‰ã™ã‚‹ã‚ˆã†ã«å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # EC2 ############################################### resource \"aws_instance\" \"bastion\" { ami = \"*****\" instance_type = \"t2.micro\" vpc_security_group_ids = [\"*****\"] subnet_id = \"*****\" key_name = \"prd-foo-bastion\" associate_public_ip_address = true disable_api_termination = true tags = { Name = \"prd-foo-bastion\" } depends_on = [var.internet_gateway] } ############################################### # Elastic IP ############################################### resource \"aws_eip\" \"nat_gateway\" { for_each = var.vpc_availability_zones vpc = true tags = { Name = format( \"prd-foo-ngw-%s-eip\", each.value ) } depends_on = [aws_internet_gateway.this] } ############################################### # NAT Gateway ############################################### resource \"aws_nat_gateway\" \"this\" { for_each = var.vpc_availability_zones subnet_id = aws_subnet.public[each.key].id allocation_id = aws_eip.nat_gateway[each.key].id tags = { Name = format( \"prd-foo-%s-ngw\", each.value ) } depends_on = [aws_internet_gateway.this] } ãƒ»S3ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ vs. ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãƒ–ãƒ­ãƒƒã‚¯ãƒãƒªã‚·ãƒ¼ ä¾‹ã¨ã—ã¦ã€S3ã‚’ç¤ºã™ã€‚ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã¨ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãƒ–ãƒ­ãƒƒã‚¯ãƒãƒªã‚·ãƒ¼ã‚’åŒæ™‚ã«æ§‹ç¯‰ã§ããªã„ãŸã‚ã€æ§‹ç¯‰ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒé‡ãªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # S3 ############################################### # foo bucket resource \"aws_s3_bucket\" \"foo\" { bucket = \"prd-foo-foo-bucket\" acl = \"private\" } # Public access block resource \"aws_s3_bucket_public_access_block\" \"foo\" { bucket = aws_s3_bucket.foo.id block_public_acls = true block_public_policy = true ignore_public_acls = true restrict_public_buckets = true } # Bucket policy attachment resource \"aws_s3_bucket_policy\" \"foo\" { bucket = aws_s3_bucket.foo.id policy = templatefile( \"${path.module}/policies/foo_bucket_policy.tpl\", { foo_s3_bucket_arn = aws_s3_bucket.foo.arn s3_cloudfront_origin_access_identity_iam_arn = var.s3_cloudfront_origin_access_identity_iam_arn } ) depends_on = [aws_s3_bucket_public_access_block.foo] } count ãƒ»countã¨ã¯ æŒ‡å®šã—ãŸæ•°ã ã‘ã€ãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ã‚’ç¹°ã‚Šè¿”ã™ã€‚count.indexã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ•°ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # EC2 ############################################### resource \"aws_instance\" \"server\" { count = 4 ami = \"ami-a1b2c3d4\" instance_type = \"t2.micro\" tags = { Name = \"ec2-${count.index}\" } } ãƒ»listå‹ã§ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ ãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ã«counté–¢æ•°ã‚’ç”¨ã„ãŸå ´åˆã€ãã®ãƒªã‚½ãƒ¼ã‚¹ã¯listå‹ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ã‚­ãƒ¼åã‚’æŒ‡å®šã—ã¦ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã§ãã‚‹ã€‚ã“ã®æ™‚ã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã¯listå‹ã«ãªã‚‹ã€‚ã¡ãªã¿ã«ã€for_eaché–¢æ•°ã§æ§‹ç¯‰ã—ãŸãƒªã‚½ãƒ¼ã‚¹ã¯ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åã‚’æŒ‡å®šã§ããªã„ã®ã§ã€æ³¨æ„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€VPCã®ã‚µãƒ–ãƒãƒƒãƒˆã‚’ç¤ºã™ã€‚ã“ã“ã§ã¯ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã€applicationã‚µãƒ–ãƒãƒƒãƒˆã€datastoreã‚µãƒ–ãƒãƒƒãƒˆã€ã‚’counté–¢æ•°ã§æ§‹ç¯‰ã—ãŸã¨ã™ã‚‹ã€‚ ############################################### # Public subnet ############################################### resource \"aws_subnet\" \"public\" { count = 2 # ï½ ä¸­ç•¥ ï½ } ############################################### # Private subnet ############################################### resource \"aws_subnet\" \"private_app\" { count = 2 # ï½ ä¸­ç•¥ ï½ } resource \"aws_subnet\" \"private_datastore\" { count = 2 # ï½ ä¸­ç•¥ ï½ } ############################################### # Output VPC ############################################### output \"public_subnet_ids\" { value = aws_subnet.public[*].id } output \"private_app_subnet_ids\" { value = aws_subnet.private_app[*].id } output \"private_datastore_subnet_ids\" { value = aws_subnet.private_datastore[*].id } for_each ãƒ»for_eachã¨ã¯ äº‹å‰ã«for_eachã«æ ¼ç´ã—ãŸmapå‹ã®keyã®æ•°ã ã‘ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã™ã‚‹ã€‚ç¹°ã‚Šè¿”ã—å‡¦ç†ã‚’è¡Œã†æ™‚ã«ã€countã¨ã¯é•ã„ã€è¦ç´ åã‚’æŒ‡å®šã—ã¦å‡ºåŠ›ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€subnetã‚’ç¹°ã‚Šè¿”ã—æ§‹ç¯‰ã™ã‚‹ã€‚ ############################################### # Variables ############################################### vpc_availability_zones = { a = \"a\", c = \"c\" } vpc_cidr = \"n.n.n.n/23\" vpc_subnet_private_datastore_cidrs = { a = \"n.n.n.n/27\", c = \"n.n.n.n/27\" } vpc_subnet_private_app_cidrs = { a = \"n.n.n.n/25\", c = \"n.n.n.n/25\" } vpc_subnet_public_cidrs = { a = \"n.n.n.n/27\", c = \"n.n.n.n/27\" } ############################################### # Public subnet ############################################### resource \"aws_subnet\" \"public\" { for_each = var.vpc_availability_zones vpc_id = aws_vpc.this.id cidr_block = var.vpc_subnet_public_cidrs[each.key] availability_zone = \"${var.region}${each.value}\" map_public_ip_on_launch = true tags = { Name = format( \"prd-foo-pub-%s-subnet\", each.value ) } } ãƒ»å†—é•·åŒ–ã•ã‚ŒãŸAZã«ãŠã‘ã‚‹è¨­å®š å†—é•·åŒ–ã•ã‚ŒãŸAZã§å…±é€šã®ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã€ãã“ã§ã€for_eaché–¢æ•°ã‚’ç”¨ã„ã‚‹ã¨ã€å°‘ãªã„å®Ÿè£…ã§æ§‹ç¯‰ã§ãã‚‹ã€‚for_eaché–¢æ•°ã§æ§‹ç¯‰ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã¯applyä¸­ã«mapæ§‹é€ ã¨ã—ã¦æ‰±ã‚ã‚Œã€ãƒªã‚½ãƒ¼ã‚¹åã®ä¸‹å±¤ã«ã‚­ãƒ¼åã§ãƒªã‚½ãƒ¼ã‚¹ãŒä¸¦ã¶æ§‹é€ ã«ãªã£ã¦ã„ã‚‹ã€‚ã“ã‚Œã‚’å‚ç…§ã™ã‚‹ãŸã‚ã«ã€ã€.[each.key].ã€ã¨ã™ã‚‹ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«ç´ä»˜ãNAT Gatewayã®è¨­å®šãŒå†—é•·åŒ–ã•ã‚ŒãŸAZã§å…±é€šã®å ´åˆã€for_eaché–¢æ•°ã§æ§‹ç¯‰ã™ã‚‹ã€‚ ############################################### # Variables ############################################### vpc_availability_zones = { a = \"a\", c = \"c\" } ############################################### # Internet Gateway ############################################### resource \"aws_internet_gateway\" \"this\" { vpc_id = aws_vpc.this.id tags = { Name = \"prd-foo-igw\" } } ############################################### # Route table (public) ############################################### resource \"aws_route_table\" \"public\" { vpc_id = aws_vpc.this.id route { cidr_block = \"0.0.0.0/0\" gateway_id = aws_internet_gateway.this.id } tags = { Name = \"prd-foo-pub-rtb\" } } ############################################### # Route table (private) ############################################### resource \"aws_route_table\" \"private_app\" { for_each = var.vpc_availability_zones vpc_id = aws_vpc.this.id route { cidr_block = \"0.0.0.0/0\" nat_gateway_id = aws_nat_gateway.this[each.key].id } tags = { Name = format( \"prd-foo-pvt-%s-app-rtb\", each.value ) } } ############################################### # NAT Gateway ############################################### resource \"aws_nat_gateway\" \"this\" { for_each = var.vpc_availability_zones subnet_id = aws_subnet.public[each.key].id allocation_id = aws_eip.nat_gateway[each.key].id tags = { Name = format( \"prd-foo-%s-ngw\", each.value ) } depends_on = [aws_internet_gateway.this] } ãƒ»å˜ä¸€å€¤ã§ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ ãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ã«for_eaché–¢æ•°ã‚’ç”¨ã„ãŸå ´åˆã€ãã®ãƒªã‚½ãƒ¼ã‚¹ã¯mapå‹ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ã‚­ãƒ¼åã‚’æŒ‡å®šã—ã¦ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã§ãã‚‹ã€‚ ############################################### # Variables ############################################### vpc_availability_zones = { a = \"a\", c = \"c\" } ############################################### # Output VPC ############################################### output \"public_a_subnet_id\" { value = aws_subnet.public[var.vpc_availability_zones.a].id } output \"public_c_subnet_id\" { value = aws_subnet.public[var.vpc_availability_zones.c].id } ãƒ»mapå‹ã§ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # Variables ############################################### vpc_availability_zones = { a = \"a\", c = \"c\" } ############################################### # Output VPC ############################################### output \"public_subnet_ids\" { value = { a = aws_subnet.public[var.vpc_availability_zones.a].id, c = aws_subnet.public[var.vpc_availability_zones.c].id } } output \"private_app_subnet_ids\" { value = { a = aws_subnet.private_app[var.vpc_availability_zones.a].id, c = aws_subnet.private_app[var.vpc_availability_zones.c].id } } output \"private_datastore_subnet_ids\" { value = { a = aws_subnet.private_datastore[var.vpc_availability_zones.a].id, c = aws_subnet.private_datastore[var.vpc_availability_zones.c].id } } ############################################### # ALB ############################################### resource \"aws_lb\" \"this\" { name = \"prd-foo-alb\" subnets = values(private_app_subnet_ids) security_groups = [var.alb_security_group_id] internal = false idle_timeout = 120 enable_deletion_protection = true access_logs { enabled = true bucket = var.alb_s3_bucket_id } } dynamic ãƒ»dynamicã¨ã¯ æŒ‡å®šã—ãŸãƒ–ãƒ­ãƒƒã‚¯ã‚’ç¹°ã‚Šè¿”ã—æ§‹ç¯‰ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€RDSãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã®parameterãƒ–ãƒ­ãƒƒã‚¯ã‚’ã€mapå‹å¤‰æ•°ã‚’ç”¨ã„ã¦ç¹°ã‚Šè¿”ã—æ§‹ç¯‰ã™ã‚‹ã€‚ ############################################### # Variables ############################################### rds_parameter_group_values = { time_zone = \"asia/tokyo\" character_set_client = \"utf8mb4\" character_set_connection = \"utf8mb4\" character_set_database = \"utf8mb4\" character_set_results = \"utf8mb4\" character_set_server = \"utf8mb4\" server_audit_events = \"connect,query,query_dcl,query_ddl,query_dml,table\" server_audit_logging = 1 server_audit_logs_upload = 1 general_log = 1 slow_query_log = 1 long_query_time = 3 } ############################################### # RDS Cluster Parameter Group ############################################### resource \"aws_rds_cluster_parameter_group\" \"this\" { name = \"prd-foo-cluster-pg\" description = \"The cluster parameter group for prd-foo-rds\" family = \"aurora-mysql5.7\" dynamic \"parameter\" { for_each = var.rds_parameter_group_values content { name = parameter.key value = parameter.value } } } ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€WAFã®æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã®regular_expressionãƒ–ãƒ­ãƒƒã‚¯ã‚’ã€listå‹å¤‰æ•°ã‚’ç”¨ã„ã¦ç¹°ã‚Šè¿”ã—æ§‹ç¯‰ã™ã‚‹ã€‚ ############################################### # Variables ############################################### waf_blocked_user_agents = [ \"FooCrawler\", \"BarSpider\", \"BazBot\", ] ############################################### # WAF Regex Pattern Sets ############################################### resource \"aws_wafv2_regex_pattern_set\" \"cloudfront\" { name = \"blocked-user-agents\" description = \"Blocked user agents\" scope = \"CLOUDFRONT\" dynamic \"regular_expression\" { for_each = var.waf_blocked_user_agents content { regex_string = regular_expression.value } } } lifecycle ãƒ»lifecycleã¨ã¯ ãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ã€æ›´æ–°ã€ãã—ã¦å‰Šé™¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã€‚ ãƒ»create_before_destroy ãƒªã‚½ãƒ¼ã‚¹ã‚’æ–°ã—ãæ§‹ç¯‰ã—ãŸå¾Œã«å‰Šé™¤ã™ã‚‹ã‚ˆã†ã«ã€å¤‰æ›´ã§ãã‚‹ã€‚é€šå¸¸æ™‚ã€Terraformã®å‡¦ç†é †åºã¨ã—ã¦ã€ãƒªã‚½ãƒ¼ã‚¹ã®å‰Šé™¤å¾Œã«æ§‹ç¯‰ãŒè¡Œã‚ã‚Œã‚‹ã€‚ã—ã‹ã—ã€ä»–ã®ãƒªã‚½ãƒ¼ã‚¹ã¨ä¾å­˜é–¢ä¿‚ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€å…ˆã«å‰Šé™¤ãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ä»–ã®ãƒªã‚½ãƒ¼ã‚¹ã«å½±éŸ¿ãŒå‡ºã¦ã—ã¾ã†ã€‚ã“ã‚Œã«å¯¾å‡¦ã™ã‚‹ãŸã‚ã«ã€å…ˆã«æ–°ã—ã„ãƒªã‚½ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã—ã€ç´ä»˜ã‘ã—ç›´ã—ã¦ã‹ã‚‰ã€å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€ACMè¨¼æ˜æ›¸ã‚’ç¤ºã™ã€‚ACMè¨¼æ˜æ›¸ã¯ã€ALBã‚„CloudFrontã«ç´ä»˜ã„ã¦ãŠã‚Šã€æ–°ã—ã„è¨¼æ˜æ›¸ã«ç´ä»˜ã‘ç›´ã—ãŸå¾Œã«ã€æ—¢å­˜ã®ã‚‚ã®ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # For foo domain ############################################### resource \"aws_acm_certificate\" \"foo\" { # ï½ ä¸­ç•¥ ï½ # æ–°ã—ã„è¨¼æ˜æ›¸ã‚’æ§‹ç¯‰ã—ãŸå¾Œã«å‰Šé™¤ã™ã‚‹ã€‚ lifecycle { create_before_destroy = true } } ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€RDSã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç¤ºã™ã€‚ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«ç´ä»˜ã„ã¦ãŠã‚Šã€æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã«ç´ä»˜ã‘ç›´ã—ãŸå¾Œã«ã€æ—¢å­˜ã®ã‚‚ã®ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # RDS Cluster Parameter Group ############################################### resource \"aws_rds_cluster_parameter_group\" \"this\" { # ï½ ä¸­ç•¥ ï½ lifecycle { create_before_destroy = true } } ############################################### # RDS Subnet Group ############################################### resource \"aws_db_subnet_group\" \"this\" { # ï½ ä¸­ç•¥ ï½ lifecycle { create_before_destroy = true } ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€Redisã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç¤ºã™ã€‚ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€RDSã«ç´ä»˜ã„ã¦ãŠã‚Šã€æ–°ã—ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«ç´ä»˜ã‘ç›´ã—ãŸå¾Œã«ã€æ—¢å­˜ã®ã‚‚ã®ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # Redis Parameter Group ############################################### resource \"aws_elasticache_parameter_group\" \"redis\" { # ï½ ä¸­ç•¥ ï½ lifecycle { create_before_destroy = true } } ############################################### # Redis Subnet Group ############################################### resource \"aws_elasticache_subnet_group\" \"redis\" { # ï½ ä¸­ç•¥ ï½ lifecycle { create_before_destroy = true } } ãƒ»ignore_changes å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®ã¿ã§èµ·ã“ã£ãŸãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã‚’ç„¡è¦–ã—ã€tfstateãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜ ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ignore_changesã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ä»¥é™ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã¨tfstateãƒ•ã‚¡ã‚¤ãƒ«ã«å·®åˆ†ãŒã‚ã£ã¦ã‚‚ã€tfstateãƒ•ã‚¡ã‚¤ãƒ«ã®å€¤ãŒæ›´æ–°ã•ã‚Œãªããªã‚‹ã€‚ä¸€ã¤ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¨ã—ã¦ã€æ©Ÿå¯†æƒ…å ±ã‚’ignore_changesã«æŒ‡å®šã—ã€tfstateãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿ã‚’é˜²ãæ–¹æ³•ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€ECSã‚’ç¤ºã™ã€‚ECSã§ã¯ã€AutoScalingã«ã‚ˆã£ã¦ã‚¿ã‚¹ã‚¯æ•°ãŒå¢—åŠ ã™ã‚‹ã€‚ãã®ãŸã‚ã€ã“ã‚Œã‚‰ã‚’ç„¡è¦–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # ECS Service ############################################### resource \"aws_ecs_service\" \"this\" { # ï½ ä¸­ç•¥ ï½ lifecycle { ignore_changes = [ # AutoScalingã«ã‚ˆã‚‹ã‚¿ã‚¹ã‚¯æ•°ã®å¢—æ¸›ã‚’ç„¡è¦–ã€‚ desired_count, ] } } ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€Redisã‚’ç¤ºã™ã€‚Redisã§ã¯ã€AutoScalingã«ã‚ˆã£ã¦ãƒ—ãƒ©ã‚¤ãƒãƒªæ•°ã¨ãƒ¬ãƒ—ãƒªã‚«æ•°ãŒå¢—æ¸›ã™ã‚‹ã€‚ãã®ãŸã‚ã€ã“ã‚Œã‚‰ã‚’ç„¡è¦–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # Redis Cluster ############################################### resource \"aws_elasticache_replication_group\" \"redis\" { # ï½ ä¸­ç•¥ ï½ lifecycle { ignore_changes = [ # ãƒ—ãƒ©ã‚¤ãƒãƒªæ•°ã¨ãƒ¬ãƒ—ãƒªã‚«æ•°ã®å¢—æ¸›ã‚’ç„¡è¦–ã—ã¾ã™ã€‚ number_cache_clusters ] } } } ï¼Šå®Ÿè£…ä¾‹ï¼Š ä½¿ç”¨ä¾‹ã¯ã™ããªã„ãŒã€ã¡ãªã¿ã«ãƒªã‚½ãƒ¼ã‚¹å…¨ä½“ã‚’ç„¡è¦–ã™ã‚‹å ´åˆã¯allã‚’è¨­å®šã™ã‚‹ã€‚ resource \"aws_foo\" \"foo\" { # ï½ ä¸­ç•¥ ï½ lifecycle { ignore_changes = all } } 06. tplå½¢å¼ã®åˆ‡ã‚Šå‡ºã—ã¨èª­ã¿å‡ºã— templatefileé–¢æ•° ãƒ»templatefileé–¢æ•°ã¨ã¯ ç¬¬ä¸€å¼•æ•°ã§ãƒãƒªã‚·ãƒ¼ãŒå®šç¾©ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å‡ºã—ã€ç¬¬äºŒå¼•æ•°ã§ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ•°ã‚’æ¸¡ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã¯tplã¨ã™ã‚‹ã®ãŒã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€S3ã‚’ç¤ºã™ã€‚ ############################################### # S3 bucket policy ############################################### resource \"aws_s3_bucket_policy\" \"alb\" { bucket = aws_s3_bucket.alb_logs.id policy = templatefile( \"${path.module}/policies/alb_bucket_policy.tpl\", { aws_elb_service_account_arn = var.aws_elb_service_account_arn aws_s3_bucket_alb_logs_arn = aws_s3_bucket.alb_logs.arn } ) } ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã™ã‚‹tplå½¢å¼ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€stringå‹ã§å‡ºåŠ›ã™ã‚‹å ´åˆã¯\"${}\"ã§ã€intå‹ã§å‡ºåŠ›ã™ã‚‹å ´åˆã¯${}ã§å‡ºåŠ›ã™ã‚‹ã€‚ã“ã“ã§æ‹¡å¼µå­ã‚’jsonã«ã—ã¦ã—ã¾ã†ã¨ã€intå‹ã®å‡ºåŠ›ã‚’jsonã®æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦æ‰±ã‚ã‚Œã¦ã—ã¾ã†ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"${aws_elb_service_account_arn}/*\" }, \"Action\": \"s3:PutObject\", \"Resource\": \"${aws_s3_bucket_alb_logs_arn}/*\" } ] } ãƒãƒªã‚·ãƒ¼ã®ã‚¢ã‚¿ãƒƒãƒ containerDefinitionsã®è¨­å®š ãƒ»containerDefinitionsã¨ã¯ ã‚¿ã‚¹ã‚¯å®šç¾©ã®ã†ã¡ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’å®šç¾©ã™ã‚‹éƒ¨åˆ†ã®ã“ã¨ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š { \"ipcMode\": null, \"executionRoleArn\": \"\", \"containerDefinitions\": [ ], ~ ~ ~ ãã®ä»–ã®è¨­å®š ~ ~ ~ } ãƒ»è¨­å®šæ–¹æ³• intå‹ã‚’å¤‰æ•°ã¨ã—ã¦æ¸¡ã›ã‚‹ã‚ˆã†ã«ã€æ‹¡å¼µå­ã‚’jsonã§ã¯ãªãtplã¨ã™ã‚‹ã®ãŒè‰¯ã„ã€‚imageã‚­ãƒ¼ã§ã¯ã€ECRã‚¤ãƒ¡ãƒ¼ã‚¸ã®URLã‚’è¨­å®šã™ã‚‹ã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚°ã¯ä»»æ„ã§æŒ‡å®šã§ãã€ã‚‚ã—æŒ‡å®šã—ãªã„å ´åˆã¯ã€ã€latestã€ã¨ã„ã†åå‰ã®ã‚¿ã‚°ãŒè‡ªå‹•çš„ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚°ã«ãƒãƒƒã‚·ãƒ¥å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã€Terraformã§ã¯æ™‚ç³»åˆ—ã§æœ€æ–°ã®ã‚¿ã‚°åã‚’å–å¾—ã™ã‚‹æ–¹æ³•ãŒãªã„ãŸã‚ã€secretsã‚­ãƒ¼ã§ã¯ã€SSMã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã®å€¤ã‚’å‚ç…§ã§ãã‚‹ã€‚ãƒ­ã‚°åˆ†å‰²ã®ç›®å°ã‚’è¨­å®šã™ã‚‹awslogs-datetime-formatã‚­ãƒ¼ã§ã¯ã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’è¡¨ã™\\\\[%Y-%m-%d %H:%M:%S\\\\]ã‚’è¨­å®šã™ã‚‹ã¨è‰¯ã„ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åŒã˜æ™‚é–“ã«ç™ºç”Ÿã—ãŸãƒ­ã‚°ã‚’ä¸€ã¤ã®ãƒ­ã‚°ã¨ã—ã¦ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ãŸã‚ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒè¦‹ã‚„ã™ããªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [ { # ã‚³ãƒ³ãƒ†ãƒŠå \"name\": \"laravel\", # ECRã®URLã€‚ã‚¿ã‚°ã‚’æŒ‡å®šã—ãªã„å ´åˆã¯latestãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ \"image\": \"*****.dkr.ecr.ap-northeast-1.amazonaws.com/prd-foo-laravel-repository\", \"essential\": true, \"portMappings\": [ { \"containerPort\": 80, \"hostPort\": 80, \"protocol\": \"tcp\" } ], \"secrets\": [ { # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç’°å¢ƒå¤‰æ•°å \"name\": \"DB_HOST\", # SSMã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å \"valueFrom\": \"/prd-foo/DB_HOST\" }, { \"name\": \"DB_DATABASE\", \"valueFrom\": \"/prd-foo/DB_DATABASE\" }, { \"name\": \"DB_PASSWORD\", \"valueFrom\": \"/prd-foo/DB_PASSWORD\" }, { \"name\": \"DB_USERNAME\", \"valueFrom\": \"/prd-foo/DB_USERNAME\" }, { \"name\": \"REDIS_HOST\", \"valueFrom\": \"/prd-foo/REDIS_HOST\" }, { \"name\": \"REDIS_PASSWORD\", \"valueFrom\": \"/prd-foo/REDIS_PASSWORD\" }, { \"name\": \"REDIS_PORT\", \"valueFrom\": \"/prd-foo/REDIS_PORT\" } ], \"logConfiguration\": { \"logDriver\": \"awslogs\", \"options\": { # ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—å \"awslogs-group\": \"/prd-foo/laravel/log\", # ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼ˆåŒæ™‚åˆ»ãƒ­ã‚°ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼‰ \"awslogs-datetime-format\": \"\\\\[%Y-%m-%d %H:%M:%S\\\\]\", # ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ \"awslogs-region\": \"ap-northeast-1\", # ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ åã®ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ \"awslogs-stream-prefix\": \"/container\" } } } ] 07. å‘½åè¦å‰‡ module AWSãƒªã‚½ãƒ¼ã‚¹ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«moduleã‚’ä¸¦ã¹ã‚‹ã€‚ã¾ãŸã€å¤‰æ•°ã‚„ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå€¤ã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«æ¸¡ã™æ™‚ã‚‚AWSãƒªã‚½ãƒ¼ã‚¹ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã¨ã™ã‚‹ã€‚ å¤‰æ•°ã®å‘½å ãƒ»å˜æ•°å½¢ã¨è¤‡æ•°å½¢ã®å‘½ååˆ†ã‘ è¤‡æ•°ã®å€¤ã‚’æŒã¤listå‹ã®å¤‰æ•°ã§ã‚ã‚Œã°è¤‡æ•°å½¢ã§å‘½åã™ã‚‹ã€‚ä¸€æ–¹ã§ã€stringå‹ãªã©å€¤ãŒä¸€ã¤ã—ã‹ãªã‘ã‚Œã°å˜æ•°å½¢ã¨ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€VPCã‚’ç¤ºã™ã€‚ ############################################### # VPC variables ############################################### vpc_availability_zones = { a = \"a\", c = \"c\" } vpc_cidr = \"n.n.n.n/23\" vpc_subnet_private_datastore_cidrs = { a = \"n.n.n.n/27\", c = \"n.n.n.n/27\" } vpc_subnet_private_app_cidrs = { a = \"n.n.n.n/25\", c = \"n.n.n.n/25\" } vpc_subnet_public_cidrs = { a = \"n.n.n.n/27\", c = \"n.n.n.n/27\" } ç’°å¢ƒå¤‰æ•°ã®å‘½å AWSãƒªã‚½ãƒ¼ã‚¹ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ç’°å¢ƒå¤‰æ•°ã‚’ä¸¦ã¹ã‚‹ã€ç’°å¢ƒå¤‰æ•°ã®åå‰ã¯ã€ç”¨ã„ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã®åå‰ã‚’æœ€åˆã«ã¤ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚listå‹ã¾ãŸã¯mapå‹ã§ã‚ã‚Œã°è¤‡æ•°å½¢ã€ãã‚Œä»¥å¤–ã§ã‚ã‚Œã°å˜æ•°å½¢ã¨ã™ã‚‹ã€‚ ############################################### # Route53 ############################################### # ï½ ä¸­ç•¥ ï½ ############################################### # VPC ############################################### # ï½ ä¸­ç•¥ ï½ ############################################### # WAF ############################################### waf_blocked_user_agents = [ \"AdCrawler\", ] è¤‡æ•°ã®AWSãƒªã‚½ãƒ¼ã‚¹ã§ç”¨ã„ã‚‹å ´åˆã¯ã€ã€Generalã€ã¨ã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªåå‰ã«ã™ã‚‹ã€‚ ############################################### # General ############################################### camel_case_prefix = \"Bar\" region = \"ap-northeast-1\" environment = \"stg\" service = \"bar\" ãƒªã‚½ãƒ¼ã‚¹ã¨ãƒ‡ãƒ¼ã‚¿ãƒªã‚½ãƒ¼ã‚¹ã®å‘½å ãƒ»ãƒªã‚½ãƒ¼ã‚¹åã§ç¨®é¡ã‚’è¡¨ç¾ ãƒªã‚½ãƒ¼ã‚¹åã«ãŠã„ã¦ã€ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã‚’ç¹°ã‚Šè¿”ã•ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚‚ã—ç¨®é¡ãŒã‚ã‚‹å ´åˆã€ãƒªã‚½ãƒ¼ã‚¹åã§ãã®ç¨®é¡ã‚’è¡¨ç¾ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€VPCã‚’ç¤ºã™ã€‚ ############################################### # VPC route table ############################################### # è‰¯ã„ä¾‹ resource \"aws_route_table\" \"public\" { } resource \"aws_route_table\" \"private\" { } ############################################### # VPC route table ############################################### # æ‚ªã„ä¾‹ resource \"aws_route_table\" \"route_table_public\" { } resource \"aws_route_table\" \"route_table_private\" { } ãƒ»this ä¸€ã¤ã®ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã«ã€ä¸€ã¤ã®ãƒªã‚½ãƒ¼ã‚¹ã—ã‹ç¨®é¡ãŒå­˜åœ¨ã—ãªã„å ´åˆã€thisã§å‘½åã™ã‚‹ã€‚ãŸã ã—ã€å¾Œã‹ã‚‰ç¨®é¡ãŒå¢—ãˆã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚‹ãŸã‚ã€éæ¨å¥¨ã§ã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š resource \"aws_internet_gateway\" \"this\" { } ãƒ»AWSãƒªã‚½ãƒ¼ã‚¹å --ã¨ã™ã‚‹ã€‚ æ¥é ­è¾ã¯ã€ -ã¨ã™ã‚‹ã€‚ æ¥å°¾è¾ã¯ã€AWSãƒªã‚½ãƒ¼ã‚¹åã¨ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€CloudWatchã‚’ç¤ºã™ã€‚ã“ã®æ™‚ã€ä»–ã®resourceã¨æ¯”è¼ƒã—ã¦ã€ç¨®é¡ã¯ALBã®HTTPCode_TARGET_4XX_Countãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«é–¢ã™ã‚‹ã‚¢ãƒ©ãƒ¼ãƒ ã¨è¦‹ãªã›ã‚‹ã€‚ãã®ãŸã‚ã€alb_httpcode_4xx_countã¨åä»˜ã‘ã¦ã„ã‚‹ã€‚ resource \"aws_cloudwatch_metric_alarm\" \"alb_httpcode_target_4xx_count\" { alarm_name = \"prd-foo-alb-httpcode-target-4xx-count-alarm\" } ãƒ»è¨­å®šã®é †åºã€è¡Œé–“ æœ€åˆã«countã‚„for_eachã‚’è¨­å®šã—æ”¹è¡Œã™ã‚‹ã€‚ãã®å¾Œã€å„ãƒªã‚½ãƒ¼ã‚¹åˆ¥ã®è¨­å®šã‚’è¡Œé–“ã‚’ç©ºã‘ãšã«è¨˜è¿°ã™ã‚‹ï¼ˆã“ã®é †ç•ªã«ãƒ«ãƒ¼ãƒ«ã¯ãªã—ï¼‰ã€‚æœ€å¾Œã«å…±é€šã®è¨­å®šã¨ã—ã¦ã€tagsã€depends_onã€lifecycleã€ã®é †ã§é…ç½®ã™ã‚‹ã€‚ãŸã ã—å®Ÿéš›ã€ã“ã‚Œã‚‰ã®å…¨ã¦ã®è¨­å®šãŒå¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ã¯ãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # EXAMPLE ############################################### resource \"aws_baz\" \"this\" { for_each = var.vpc_availability_zones # æœ€åˆã«for_each # ã‚¹ãƒšãƒ¼ã‚¹ subnet_id = aws_subnet.public[*].id # å„è¨­å®šï¼ˆé †ç•ªã«ãƒ«ãƒ¼ãƒ«ãªã—ï¼‰ # ã‚¹ãƒšãƒ¼ã‚¹ tags = { Name = format( \"prd-foo-%d-baz\", each.value ) } # ã‚¹ãƒšãƒ¼ã‚¹ depends_on = [] # ã‚¹ãƒšãƒ¼ã‚¹ lifecycle { create_before_destroy = true } } ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå€¤ã®å‘½å ãƒ»åŸºæœ¬ãƒ«ãƒ¼ãƒ« ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå€¤ã®åå‰ã¯ã€ã€__ã€ã§å‘½åã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€CloudWatchã‚’ç¤ºã™ã€‚ãƒªã‚½ãƒ¼ã‚¹åã¯ecs_container_nginxã€ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã¯aws_cloudwatch_log_groupã€attributeã¯nameã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹ã€‚ output \"ecs_container_nginx_cloudwatch_log_group_name\" { value = aws_cloudwatch_log_group.ecs_container_nginx.name } ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€IAM Roleã‚’ç¤ºã™ã€‚ ############################################### # Output IAM Role ############################################### output \"ecs_task_execution_iam_role_arn\" { value = aws_iam_role.ecs_task_execution.arn } output \"lambda_execute_iam_role_arn\" { value = aws_iam_role.lambda_execute.arn } output \"rds_enhanced_monitoring_iam_role_arn\" { value = aws_iam_role.rds_enhanced_monitoring.arn } ãƒ»thisã¯çœç•¥ ãƒªã‚½ãƒ¼ã‚¹åãŒthisã§ã‚ã‚‹å ´åˆã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå€¤åã§ã¯ã“ã‚Œã‚’çœç•¥ã—ã¦ã‚‚ã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€ALBã‚’ç¤ºã™ã€‚ ############################################### # Output ALB ############################################### output \"alb_zone_id\" { value = aws_lb.this.zone_id } output \"alb_dns_name\" { value = aws_lb.this.dns_name } ãƒ»å†—é•·ãªattributeåã¯çœç•¥ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€ECRã‚’ç¤ºã™ã€‚ ############################################### # Output ECR ############################################### output \"laravel_ecr_repository_url\" { value = aws_ecr_repository.laravel.repository_url } output \"nginx_ecr_repository_url\" { value = aws_ecr_repository.nginx.repository_url } 08. ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰‹é † ï¼ˆï¼‘ï¼‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã«ãƒ­ã‚°ã‚¤ãƒ³ ãŸã ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’çœºã‚ã¦ã„ã‚‹ã‚ˆã‚Šã€ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã®ã©ã“ã«ç›¸å½“ã™ã‚‹ã®ã‹ã‚‚ä¸¦è¡Œã—ã¦ç¢ºèªã—ãŸæ–¹ãŒã€Terraformã‚’ç†è§£ã—ã‚„ã™ã„ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹. ï¼ˆï¼’ï¼‰AWSã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„æŠ€è¡“è¨˜äº‹ã‚’ç¢ºèª ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã®ç›¸å½“ã™ã‚‹è¨­å®šç®‡æ‰€ãŒã‚ã‹ã£ãŸã¨ã“ã‚ã§ã€è¨­å®šå€¤ãŒæ­£ã—ã„ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ä»¥ä¸‹ã‚’ç¢ºèªã™ã‚‹ã€‚ AWSã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ æŠ€è¡“è¨˜äº‹ ï¼ˆï¼“ï¼‰Terraformã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„æŠ€è¡“è¨˜äº‹ã‚’ç¢ºèª AWSã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã€Terraformã®AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã€‚ä»¥ä¸‹ã‚’ç¢ºèªã™ã‚‹ã€‚ Terraformã®AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼šhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs æŠ€è¡“è¨˜äº‹ æ³¨æ„ç‚¹ã¨ã—ã¦ã€AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã€ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®é–²è¦§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ä»¥ä¸‹ã®ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã€‚ å®Ÿè£…æ–¹æ³•ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®Ÿè£…ãƒ«ãƒ¼ãƒ«ã«å³ã—ã¦ã„ã‚‹ã‹ ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«éæ¨å¥¨ã¨æ³¨æ„æ›¸ãã•ã‚ŒãŸæ–¹æ³•ã§å®Ÿè£…ã—ã¦ã„ãªã„ã‹ ãƒªãƒªãƒ¼ã‚¹ã®ç²’åº¦ã¯é©åˆ‡ã‹ "},"public/infrastructure_as_code/infrastructure_as_code_terraform_aws_provider.html":{"url":"public/infrastructure_as_code/infrastructure_as_code_terraform_aws_provider.html","title":"ğŸ“– ï¸AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼","keywords":"","body":"AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ACM è¨¼æ˜æ›¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ï¼Šå®Ÿè£…ä¾‹ï¼Š Eãƒ¡ãƒ¼ãƒ«æ¤œè¨¼ã®å ´åˆã‚’ç¤ºã™ã€‚ ############################################### # For www domain ############################################### resource \"aws_acm_certificate\" \"www_an1\" { domain_name = var.route53_domain_www subject_alternative_names = [\"*.${var.route53_domain_www}\"] validation_method = \"EMAIL\" tags = { Name = \"${var.environment}-${var.service}-www-an1-cert\" } lifecycle { create_before_destroy = true } } ï¼Šå®Ÿè£…ä¾‹ï¼Š DNSæ¤œè¨¼ã®å ´åˆã‚’ç¤ºã™ã€‚ ############################################### # For www domain ############################################### resource \"aws_acm_certificate\" \"www_an1\" { domain_name = var.route53_domain_www subject_alternative_names = [\"*.${var.route53_domain_www}\"] validation_method = \"DNS\" tags = { Name = \"${var.environment}-${var.service}-www-an1-cert\" } lifecycle { create_before_destroy = true } } æ¤œè¨¼ã®å®Ÿè¡Œ ï¼Šå®Ÿè£…ä¾‹ï¼Š Eãƒ¡ãƒ¼ãƒ«æ¤œè¨¼ã®å ´åˆã‚’ç¤ºã™ã€‚ ############################################### # For www domain ############################################### # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ resource \"aws_acm_certificate_validation\" \"www_an1\" { certificate_arn = aws_acm_certificate.www_an1.arn } ï¼Šå®Ÿè£…ä¾‹ï¼Š DNSæ¤œè¨¼ã®å ´åˆã‚’ç¤ºã™ã€‚ ############################################### # For www domain ############################################### # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼’ï¼‰ resource \"aws_acm_certificate_validation\" \"www_an1\" { certificate_arn = aws_acm_certificate.www_an1.arn validation_record_fqdns = [for record in var.www_an1_route53_record : record.fqdn] } ï¼ˆï¼‘ï¼‰AWSä»¥å¤–ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã—ãŸå ´åˆã¯æ³¨æ„ AWSä»¥å¤–ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã—ãŸå ´åˆã¯AWSä»¥å¤–ã§ä½œæ¥­ã«ãªã‚‹ã€‚è¨¼æ˜æ›¸ã®DNSæ¤œè¨¼æ™‚ã«ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ãŒç®¡ç†ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒ©ã«ã€Route53ã®NSãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã‚’ç™»éŒ²ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰æ¤œè¨¼ã®ãŸã‚ã«ãƒ¡ãƒ¼ãƒ«å†é€ãŒå¿…è¦ è¨¼æ˜æ›¸ã®Eãƒ¡ãƒ¼ãƒ«æ¤œè¨¼æ™‚ã«ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ‰€æœ‰è€…ã«ãƒ¡ãƒ¼ãƒ«ãŒé€ä¿¡ã•ã‚Œãªã„ã“ã¨ãŒã‚ã‚‹ã€‚é€ä¿¡ã•ã‚Œãªã‹ã£ãŸå ´åˆã¯ã€ãƒ¡ãƒ¼ãƒ«ã®å†é€ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ â€» è¨¼æ˜æ›¸ã®æ¤œè¨¼æ–¹æ³•ã‚’å¤‰æ›´ã™ã‚‹ ã‚‚ã—ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‹ã‚‰è¨¼æ˜æ›¸ã®æ¤œè¨¼æ–¹æ³•ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã€æ¤œè¨¼æ–¹æ³•ã®ç•°ãªã‚‹è¨¼æ˜æ›¸ã‚’æ§‹ç¯‰ã—ã¦ã“ã‚Œã«åˆ‡ã‚Šæ›¿ãˆãŸã†ãˆã§ã€å¤ã„è¨¼æ˜æ›¸ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã‚Œã«åˆã‚ã›ã¦ã€Terraformã§ã‚‚ãƒªãƒªãƒ¼ã‚¹ã‚’äºŒå›ã«åˆ†ã‘ã‚‹ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/premiumsupport/knowledge-center/switch-acm-certificate/ 02. AMI ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # For bastion ############################################### data \"aws_ami\" \"bastion\" { # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ most_recent = false # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ owners = [\"amazon\"] filter { name = \"name\" values = [\"amzn-ami-hvm-2018.03.0.20201028.0-x86_64-gp2\"] } filter { name = \"image-id\" values = [\"ami-040c9333a9c90b2b6\"] } } ï¼ˆï¼‘ï¼‰å–å¾—ã™ã‚‹AMIã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®š å–å¾—ã™ã‚‹AMIãŒå¸¸ã«æœ€æ–°ã«ãªã£ã¦ã„ã‚‹ã¨ã€EC2ãŒå†æ§‹ç¯‰ã•ã‚Œãªã­ãªã„ã€‚ãã“ã§ã€ç‰¹å®šã®AMIã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã€‚most_recentã¯ç„¡åŠ¹åŒ–ã—ã¦ãŠãã€ç‰¹å®šã®AMã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã€‚ 03. API Gateway ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # REST API ############################################### resource \"aws_api_gateway_rest_api\" \"foo\" { name = \"prd-foo-api-for-foo\" description = \"The API that enables two-way communication with prd-foo\" # VPCãƒªãƒ³ã‚¯ã®ãƒ—ãƒ­ã‚­ã‚·çµ±åˆã®APIã‚’å®šç¾©ã—ãŸOpenAPIä»•æ§˜ # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ body = templatefile( \"${path.module}/open_api.yaml\", { api_gateway_vpc_link_foo_id = aws_api_gateway_vpc_link.foo.id nlb_dns_name = var.nlb_dns_name } ) endpoint_configuration { types = [\"REGIONAL\"] } lifecycle { ignore_changes = [ policy ] } } ############################################### # Deployment ############################################### resource \"aws_api_gateway_deployment\" \"foo\" { rest_api_id = aws_api_gateway_rest_api.foo.id # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ triggers = { redeployment = sha1(aws_api_gateway_rest_api.foo.body) } lifecycle { create_before_destroy = true } } ############################################### # Stage ############################################### resource \"aws_api_gateway_stage\" \"foo\" { deployment_id = aws_api_gateway_deployment.foo.id rest_api_id = aws_api_gateway_rest_api.foo.id stage_name = var.environment } ï¼ˆï¼‘ï¼‰OpenAPIä»•æ§˜ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨å·®åˆ†èªè­˜ ã‚ã‚‰ã‹ã˜ã‚ç”¨æ„ã—ãŸOpenAPIä»•æ§˜ã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’bodyã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã€ã“ã‚Œã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€APIã‚’å®šç¾©ã§ãã‚‹ã€‚YAMLãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ•°ã‚’æ¸¡ã™ã“ã¨ã‚‚ã§ãã‚‹ã€‚APIã®å†ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦ã€redeploymentãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«bodyãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æ¸¡ã™ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆå…ƒã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã«å·®åˆ†ãŒã‚ã£ãŸå ´åˆã€TerraformãŒredeploymentãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã®å¤‰åŒ–ã‚’èªè­˜ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€å†ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ ï¼ˆâ€»ï¼‰ã‚¹ãƒ†ãƒ¼ã‚¸åã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã¯ãªã„ API Gatewayã®ã‚¹ãƒ†ãƒ¼ã‚¸åã‚’å‚ç…§ã™ã‚‹ãŸã‚ã«ã¯ã€resourceã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã€dataã§ã¯ã“ã‚Œã‚’å–å¾—ã§ããªã„ã€‚ã‚‚ã—ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ä¸Šã‹ã‚‰æ§‹ç¯‰ã—ã¦ã„ã‚‹å ´åˆã€ã‚¹ãƒ†ãƒ¼ã‚¸ã®ARNã‚’å‚ç…§ã§ããªã„ãŸã‚ã€ARNã‚’è‡ªåŠ›ã§ä½œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚API Gatewayã®å„ARNã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/arn-format-reference.html ï¼Šå®Ÿè£…ä¾‹ï¼Š WAFã«API Gatewayã‚’ç´ä»˜ã‘ã‚‹ãŸã‚ã«ã€ã‚¹ãƒ†ãƒ¼ã‚¸ã®ARNãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã“ã‚Œã¯è‡ªåŠ›ã§ä½œã‚‹ã€‚ ############################################### # Web ACL Association ############################################### resource \"aws_wafv2_web_acl_association\" \"api_gateway\" { resource_arn = \"${var.api_gateway_rest_arn}/stages/prd\" web_acl_arn = aws_wafv2_web_acl.api_gateway.arn } 04. CloudFront ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š resource \"aws_cloudfront_distribution\" \"this\" { price_class = \"PriceClass_200\" web_acl_id = var.cloudfront_wafv2_web_acl_arn aliases = [var.route53_domain_foo] comment = \"prd-foo-cf-distribution\" enabled = true # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ retain_on_delete = true viewer_certificate { acm_certificate_arn = var.foo_acm_certificate_arn ssl_support_method = \"sni-only\" minimum_protocol_version = \"TLSv1.2_2019\" } logging_config { bucket = var.cloudfront_s3_bucket_regional_domain_name include_cookies = true } restrictions { geo_restriction { restriction_type = \"none\" } } # ï½ ä¸­ç•¥ ï½ } ï¼ˆï¼‘ï¼‰å‰Šé™¤ä¿æŒæ©Ÿèƒ½ Terraformã§ã¯ã€retain_on_deleteã§è¨­å®šã§ãã‚‹ã€‚å›ºæœ‰ã®è¨­å®šã§ã€AWSã«å¯¾å¿œã™ã‚‹ã‚‚ã®ã¯ç„¡ã„ã€‚ originãƒ–ãƒ­ãƒƒã‚¯ Originsç”»é¢ã«è¨­å®šã™ã‚‹ã‚ªãƒªã‚¸ãƒ³ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š resource \"aws_cloudfront_distribution\" \"this\" { # ï½ ä¸­ç•¥ ï½ # ã‚ªãƒªã‚¸ãƒ³ï¼ˆã“ã“ã§ã¯S3ã¨ã—ã¦ã„ã‚‹ï¼‰ origin { domain_name = var.s3_bucket_regional_domain_name origin_id = \"S3-${var.s3_bucket_id}\" s3_origin_config { origin_access_identity = aws_cloudfront_origin_access_identity.s3_foo.cloudfront_access_identity_path } } # ï½ ä¸­ç•¥ ï½ } resource \"aws_cloudfront_distribution\" \"this\" { # ï½ ä¸­ç•¥ ï½ # ã‚ªãƒªã‚¸ãƒ³ï¼ˆã“ã“ã§ã¯ALBã¨ã—ã¦ã„ã‚‹ï¼‰ origin { domain_name = var.alb_dns_name origin_id = \"ELB-${var.alb_name}\" custom_origin_config { origin_ssl_protocols = [\"TLSv1.2\"] origin_protocol_policy = \"match-viewer\" origin_read_timeout = 30 origin_keepalive_timeout = 5 http_port = var.alb_listener_port_http https_port = var.alb_listener_port_https } } # ï½ ä¸­ç•¥ ï½ } ordered_cache_behaviorãƒ–ãƒ­ãƒƒã‚¯ Behaviorç”»é¢ã«è¨­å®šã™ã‚‹ã‚ªãƒªã‚¸ãƒ³ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ãƒ‘ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š resource \"aws_cloudfront_distribution\" \"this\" { # ï½ ä¸­ç•¥ ï½ ordered_cache_behavior { path_pattern = \"/images/*\" target_origin_id = \"S3-${var.s3_bucket_id}\" viewer_protocol_policy = \"redirect-to-https\" allowed_methods = [\"GET\", \"HEAD\", \"OPTIONS\", \"PUT\", \"POST\", \"PATCH\", \"DELETE\"] cached_methods = [\"GET\", \"HEAD\"] min_ttl = 0 max_ttl = 31536000 default_ttl = 86400 compress = true forwarded_values { query_string = true cookies { forward = \"none\" } } } # ï½ ä¸­ç•¥ ï½ } default_cache_behavior Behaviorç”»é¢ã«è¨­å®šã™ã‚‹ã‚ªãƒªã‚¸ãƒ³ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹æ¨™æº–ãƒ‘ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š resource \"aws_cloudfront_distribution\" \"this\" { default_cache_behavior { target_origin_id = \"ELB-${var.alb_name}\" viewer_protocol_policy = \"redirect-to-https\" allowed_methods = [\"GET\", \"HEAD\", \"OPTIONS\", \"PUT\", \"POST\", \"PATCH\", \"DELETE\"] cached_methods = [\"GET\", \"HEAD\"] min_ttl = 0 max_ttl = 31536000 default_ttl = 86400 compress = true forwarded_values { query_string = true headers = [\"*\"] cookies { forward = \"all\" } } } # ï½ ä¸­ç•¥ ï½ } 05. ECR ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ ECRã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æœ‰åŠ¹æœŸé–“ã‚’å®šç¾©ã™ã‚‹ãƒãƒªã‚·ãƒ¼ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‹ã‚‰å…¥åŠ›ã§ãã‚‹ãŸã‚ã€åŸºæœ¬çš„ã«ãƒãƒªã‚·ãƒ¼ã®å®Ÿè£…ã¯ä¸è¦ã§ã‚ã‚‹ãŒã€Terraformãªã©ã®IaCãƒ„ãƒ¼ãƒ«ã§ã¯å¿…è¦ã«ãªã‚‹ã€‚ { \"rules\": [ { \"rulePriority\": 1, \"description\": \"Keep last 10 images untagged\", \"selection\": { \"tagStatus\": \"untagged\", \"countType\": \"imageCountMoreThan\", \"countNumber\": 10 }, \"action\": { \"type\": \"expire\" } }, { \"rulePriority\": 2, \"description\": \"Keep last 10 images any\", \"selection\": { \"tagStatus\": \"any\", \"countType\": \"imageCountMoreThan\", \"countNumber\": 10 }, \"action\": { \"type\": \"expire\" } } ] } 06. ECS ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # ECS Service ############################################### resource \"aws_ecs_service\" \"this\" { name = \"prd-foo-ecs-service\" cluster = aws_ecs_cluster.this.id launch_type = \"FARGATE\" platform_version = \"1.4.0\" desired_count = var.ecs_service_desired_count deployment_maximum_percent = 200 deployment_minimum_healthy_percent = 100 # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ health_check_grace_period_seconds = 330 # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼’ï¼‰ task_definition = \"${aws_ecs_task_definition.this.family}:${max(aws_ecs_task_definition.this.revision, data.aws_ecs_task_definition.this.revision)}\" network_configuration { security_groups = [var.ecs_security_group_id] subnets = [var.private_a_app_subnet_id, var.private_c_app_subnet_id] assign_public_ip = false } load_balancer { target_group_arn = var.alb_target_group_arn container_name = \"nginx\" container_port = 80 } load_balancer { target_group_arn = var.nlb_target_group_arn container_name = \"nginx\" container_port = 80 } depends_on = [ # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼“ï¼‰ var.alb_listener_https, var.nlb_listener ] lifecycle { ignore_changes = [ # â€»å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆï¼ˆï¼”ï¼‰ desired_count, ] } } ï¼ˆï¼‘ï¼‰ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯çŒ¶äºˆæœŸé–“ ã‚¿ã‚¹ã‚¯ã®èµ·å‹•ãŒå®Œäº†ã™ã‚‹å‰ã«ã‚µãƒ¼ãƒ“ã‚¹ãŒãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’æ¤œè¨¼ã—ã€Unhealthyã¨èª¤èªã—ã¦ã—ã¾ã†ãŸã‚ã€ã‚¿ã‚¹ã‚¯ã®èµ·å‹•å®Œäº†ã‚’å¾…æ©Ÿã™ã‚‹ã€‚ä¾‹ãˆã°ã€ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ãŒ30ç§’é–“éš”ã§ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯ã€30ç§’å˜ä½ã§å¾…æ©Ÿæ™‚é–“ã‚’å¢—ã‚„ã—ã€é©åˆ‡ãªå¾…æ©Ÿæ™‚é–“ã‚’è¦‹ã¤ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ã®è¿½è·¡ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ˆã£ã¦ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã®ã‚¿ã‚¹ã‚¯å®šç¾©ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ãŒå¢—åŠ ã™ã‚‹ãŸã‚ã€ã“ã‚Œã‚’è¿½è·¡ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ecs_task_definition ï¼ˆï¼“ï¼‰ALB/NLBãƒªã‚¹ãƒŠãƒ¼ã®æ§‹ç¯‰ã‚’å¾…æ©Ÿ Teraformã¯ã€ç‰¹ã«ä¾å­˜é–¢ä¿‚ã‚’å®Ÿè£…ã—ãªã„å ´åˆã€ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— â†’ ALB/NLB â†’ ãƒªã‚¹ãƒŠãƒ¼ã€ã®é †ã§ãƒªã‚½ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚å•é¡Œã¨ã—ã¦ã€ALB/NLBã‚„ãƒªã‚¹ãƒŠãƒ¼ã®æ§‹ç¯‰ãŒçµ‚ã‚ã‚‹å‰ã«ã€ECSã‚µãƒ¼ãƒ“ã‚¹ã®æ§‹ç¯‰ãŒå§‹ã¾ã£ã¦ã—ã¾ã†ã€‚ALB/NLBã®æ§‹ç¯‰ï¼ˆâ€»ãƒªã‚¹ãƒŠãƒ¼ã‚‚å«ã‚€å¯èƒ½æ€§ï¼‰ãŒå®Œå…¨ã«å®Œäº†ã—ãªã„çŠ¶æ…‹ã§ã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã¯ECSã‚µãƒ¼ãƒ“ã‚¹ã«ç´ä»˜ã‘ã‚‰ãšã€ã“ã‚ŒãŒå®Œäº†ã™ã‚‹å‰ã«ECSã‚µãƒ¼ãƒ“ã‚¹ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’å‚ç…§ã—ã‚ˆã†ã¨ã™ã‚‹ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ãƒªã‚¹ãƒŠãƒ¼ã®å¾Œã«ECSã‚µãƒ¼ãƒ“ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ã‚ˆã†ã«ã—ã€ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— â†’ ALB/NLB â†’ ãƒªã‚¹ãƒŠãƒ¼ â†’ ECSã‚µãƒ¼ãƒ“ã‚¹ã€ã®é †ã§ãƒªã‚½ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/hashicorp/terraform/issues/12634#issuecomment-313215022 ï¼ˆï¼”ï¼‰AutoScalingã«ã‚ˆã‚‹ã‚¿ã‚¹ã‚¯æ•°ã®å¢—æ¸›ã‚’ç„¡è¦– AutoScalingã«ã‚ˆã£ã¦ã€ã‚¿ã‚¹ã‚¯æ•°ãŒå¢—æ¸›ã™ã‚‹ãŸã‚ã€ã“ã‚Œã‚’ç„¡è¦–ã™ã‚‹ã€‚ ï¼ˆâ€»ï¼‰ã‚¿ã‚¹ã‚¯å®šç¾©ã®æ›´æ–° Terraformã§ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’æ›´æ–°ã™ã‚‹ã¨ã€ç¾åœ¨å‹•ã„ã¦ã„ã‚‹ECSã§ç¨¼åƒã—ã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ã¯ãã®ã¾ã¾ã«ã€æ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ã®ã‚¿ã‚¹ã‚¯å®šç¾©ãŒä½œæˆã•ã‚Œã‚‹ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã®ã€æ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®ä½œæˆã€ã¨åŒã˜æŒ™å‹•ã§ã‚ã‚‹ã€‚å®Ÿéš›ã«ã‚¿ã‚¹ã‚¯ãŒå¢—ãˆã¦ã„ã‚‹ã“ã¨ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã«ç´ä»˜ãã‚¿ã‚¹ã‚¯å®šç¾©ä¸€è¦§ã‹ã‚‰ç¢ºèªã§ãã‚‹ã€‚æ¬¡ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«ã€ã“ã®ã‚¿ã‚¹ã‚¯ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã€‚ ï¼ˆâ€»ï¼‰ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®å‰Šé™¤æ™‚é–“ ECSã‚µãƒ¼ãƒ“ã‚¹ã®å‰Šé™¤ã«ã¯ã€ãƒ‰ãƒ¬ã‚¤ãƒ‹ãƒ³ã‚°ã€ã®æ™‚é–“ãŒç™ºç”Ÿã™ã‚‹ã€‚ç´„2åˆ†30ç§’ã‹ã‹ã‚‹ãŸã‚ã€æ°—é•·ã«å¾…ã¤ã“ã¨ã€‚ ï¼ˆâ€»ï¼‰ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ applyã§ã€æ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ã®ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’ä½œæˆã™ã‚‹ã¨ã€ã“ã‚Œã‚’ç”¨ã„ã¦ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒè‡ªå‹•ã§å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ãŸã ã€ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®ä»•çµ„ã¿ä¸Šã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãŒå¤±æ•—ã™ã‚Œã°ã€æ—¢å­˜ã®ã‚¿ã‚¹ã‚¯ã¯åœæ­¢ã›ãšã«ãã®ã¾ã¾ç¨¼åƒã™ã‚‹ãŸã‚ã€å®‰å¿ƒã§ã¯ã‚ã‚‹ãŒã€‚ 07. EC2 ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # For bastion ############################################### resource \"aws_instance\" \"bastion\" { ami = \"*****\" instance_type = \"t2.micro\" vpc_security_group_ids = [\"*****\"] subnet_id = \"*****\" associate_public_ip_address = true # â€»å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆï¼ˆï¼‘ï¼‰ key_name = \"prd-foo-bastion\" disable_api_termination = true tags = { Name = \"prd-foo-bastion\" } # â€»å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆï¼ˆï¼’ï¼‰ depends_on = [var.internet_gateway] } ï¼ˆï¼‘ï¼‰ã‚­ãƒ¼ãƒšã‚¢ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã§è¨­å®š èª¤ã£ã¦å‰Šé™¤ã—ãªã„ã‚ˆã†ã«ã€ã¾ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«æ©Ÿå¯†æƒ…å ±ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãªã„ã‚ˆã†ã«ã€ã‚­ãƒ¼ãƒšã‚¢ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã§ä½œæˆã—ãŸå¾Œã€key_nameã§ã‚­ãƒ¼åã‚’æŒ‡å®šã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®å¾Œã«æ§‹ç¯‰ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®å¾Œã«EC2ã‚’æ§‹ç¯‰ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/internet_gateway#argument-reference 08. IAMãƒ¦ãƒ¼ã‚¶ ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’æŒã¤ãƒ­ãƒ¼ãƒ« äº‹å‰ã«ã€tplå½¢å¼ã®ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã—ã¦ãŠãã€‚æ§‹ç¯‰æ¸ˆã¿ã®IAMãƒ­ãƒ¼ãƒ«ã«ã€aws_iam_policyãƒªã‚½ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦ã€AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’IAMãƒ¦ãƒ¼ã‚¶ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰AWS CLIã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€ã‚³ãƒãƒ³ãƒ‰ã‚’ç‰¹å®šã®é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç‰¹å®šã®ã‚‚ã®ã«é™å®šã™ã‚‹ã€‚äº‹å‰ã«ã€listå‹ã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚ ############################################### # IP addresses ############################################### global_ip_addresses = [ \"nn.nnn.nnn.nnn/32\", \"nn.nnn.nnn.nnn/32\" ] ã¾ãŸäº‹å‰ã«ã€æŒ‡å®šã—ãŸé€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ä»¥å¤–ã‚’æ‹’å¦ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": { \"Effect\": \"Deny\", \"Action\": \"*\", \"Resource\": \"*\", \"Condition\": { \"NotIpAddress\": { \"aws:SourceIp\": ${global_ip_addresses} } } } } ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã§ä½œæˆæ¸ˆã¿ã®IAMãƒ¦ãƒ¼ã‚¶ã®åå‰ã‚’å–å¾—ã™ã‚‹ã€‚tplå½¢å¼ã®ãƒãƒªã‚·ãƒ¼ã«listå‹ã®å€¤ã‚’æ¸¡ã™æ™‚ã€jsonencodeé–¢æ•°ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ############################################### # For IAM User ############################################### data \"aws_iam_user\" \"aws_cli_command_executor\" { user_name = \"aws_cli_command_executor\" } resource \"aws_iam_policy\" \"aws_cli_command_executor_ip_address_restriction\" { name = \"prd-aws-cli-command-executor-ip-address-restriction-policy\" description = \"Allow global IP addresses\" policy = templatefile( \"${path.module}/policies/customer_managed_policies/aws_cli_command_executor_ip_address_restriction_policy.tpl\", { global_ip_addresses = jsonencode(var.global_ip_addresses) } ) } AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ IAMãƒ¦ãƒ¼ã‚¶ã«AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # For IAM User ############################################### resource \"aws_iam_user_policy_attachment\" \"aws_cli_command_executor_s3_read_only_access\" { user = data.aws_iam_user.aws_cli_command_executor.user_name policy_arn = \"arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess\" } 09. IAMãƒ­ãƒ¼ãƒ« ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’æŒã¤ãƒ­ãƒ¼ãƒ« ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã§ãƒ­ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹å ´åˆã¯æ„è­˜ã™ã‚‹ã“ã¨ã¯ãªã„ãŒã€ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã«ãƒ­ãƒ¼ãƒ«ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ­ãƒ¼ãƒ«ã«ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’çµ„ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚‹ã€‚äº‹å‰ã«ã€tplå½¢å¼ã®ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã—ã¦ãŠãã€‚aws_iam_roleãƒªã‚½ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦ã€IAMãƒ­ãƒ¼ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã¨åŒæ™‚ã«ã€ã“ã‚Œã«ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š äº‹å‰ã«ã€ECSã‚¿ã‚¹ã‚¯ã®ãŸã‚ã®ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"Service\": \"ecs-tasks.amazonaws.com\" }, \"Action\": \"sts:AssumeRole\" } ] } ECSã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã¨ECSã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã«ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ############################################### # IAM Role For ECS Task Execution ############################################### resource \"aws_iam_role\" \"ecs_task_execution\" { name = \"prd-foo-ecs-task-execution-role\" description = \"The role for prd-foo-ecs-task\" assume_role_policy = templatefile( \"${path.module}/policies/trust_policies/ecs_task_policy.tpl\", {} ) } ############################################### # IAM Role For ECS Task ############################################### resource \"aws_iam_role\" \"ecs_task\" { name = \"prd-foo-ecs-task-role\" description = \"The role for prd-foo-ecs-task\" assume_role_policy = templatefile( \"${path.module}/policies/trust_policies/ecs_task_policy.tpl\", {} ) } ï¼Šå®Ÿè£…ä¾‹ï¼Š äº‹å‰ã«ã€Lambda@Edgeã®ãŸã‚ã®ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"\", \"Effect\": \"Allow\", \"Principal\": { \"Service\": [ \"lambda.amazonaws.com\", \"edgelambda.amazonaws.com\" ] }, \"Action\": \"sts:AssumeRole\" } ] } Lambdaå®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã«ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ############################################### # IAM Role For Lambda@Edge ############################################### # ãƒ­ãƒ¼ãƒ«ã«ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã—ã¾ã™ã€‚ resource \"aws_iam_role\" \"lambda_execute\" { name = \"prd-foo-lambda-execute-role\" assume_role_policy = templatefile( \"${path.module}/policies/lambda_execute_role_trust_policy.tpl\", {} ) } ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’æŒã¤ãƒ­ãƒ¼ãƒ« äº‹å‰ã«ã€tplå½¢å¼ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã—ã¦ãŠãã€‚aws_iam_role_policyãƒªã‚½ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹ã¨åŒæ™‚ã«ã€ã“ã‚Œã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š äº‹å‰ã«ã€ECSã‚¿ã‚¹ã‚¯ã«å¿…è¦æœ€ä½é™ã®æ¨©é™ã‚’ä¸ãˆã‚‹ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"ssm:GetParameters\" ], \"Resource\": \"*\" } ] } ECSã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã¨ECSã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ############################################### # IAM Role For ECS Task ############################################### resource \"aws_iam_role_policy\" \"ecs_task\" { name = \"prd-foo-ssm-read-only-access-policy\" role = aws_iam_role.ecs_task_execution.id policy = templatefile( \"${path.module}/policies/inline_policies/ecs_task_policy.tpl\", {} ) } AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’æŒã¤ãƒ­ãƒ¼ãƒ« äº‹å‰ã«ã€tplå½¢å¼ã®AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã—ã¦ãŠãã€‚aws_iam_role_policy_attachmentãƒªã‚½ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦ã€å®Ÿã‚¤ãƒ³ãƒ•ãƒ©ã«ã‚ã‚‹AWSç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’æ§‹ç¯‰æ¸ˆã¿ã®IAMãƒ­ãƒ¼ãƒ«ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ãƒãƒªã‚·ãƒ¼ã®ARNã¯ã€AWSã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‚’ç¢ºèªã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # IAM Role For ECS Task Execution ############################################### resource \"aws_iam_role_policy_attachment\" \"ecs_task_execution\" { role = aws_iam_role.ecs_task_execution.name policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\" } ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’æŒã¤ãƒ­ãƒ¼ãƒ« äº‹å‰ã«ã€tplå½¢å¼ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã—ã¦ãŠãã€‚aws_iam_role_policyãƒªã‚½ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦ã€ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚aws_iam_role_policy_attachmentãƒªã‚½ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦ã€ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’æ§‹ç¯‰æ¸ˆã¿ã®IAMãƒ­ãƒ¼ãƒ«ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š äº‹å‰ã«ã€ECSã‚¿ã‚¹ã‚¯ã«å¿…è¦æœ€ä½é™ã®æ¨©é™ã‚’ä¸ãˆã‚‹ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"logs:CreateLogStream\", \"logs:PutLogEvents\" ], \"Resource\": [ \"arn:aws:logs:*:*:*\" ] } ] } ECSã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã‚«ã‚¹ã‚¿ãƒãƒ¼ç®¡ç†ãƒãƒªã‚·ãƒ¼ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚ ############################################### # IAM Role For ECS Task ############################################### resource \"aws_iam_policy\" \"ecs_task\" { name = \"prd-foo-cloudwatch-logs-access-policy\" description = \"Provides access to CloudWatch Logs\" policy = templatefile( \"${path.module}/policies/customer_managed_policies/cloudwatch_logs_access_policy.tpl\", {} ) } resource \"aws_iam_role_policy_attachment\" \"ecs_task\" { role = aws_iam_role.ecs_task.name policy_arn = aws_iam_policy.ecs_task.arn } ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ« ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ«ã¯ã€AWSãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰æ™‚ã«è‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã€ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€Terraformã®ç®¡ç†å¤–ã§ã‚ã‚‹ã€‚aws_iam_service_linked_roleãƒªã‚½ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦ã€æ‰‹å‹•ã§æ§‹ç¯‰ã§ãã‚‹ãŒã€æ•°ãŒå¤šãå®Ÿè£…ã®è² æ‹…ã«ã‚‚ãªã‚‹ãŸã‚ã€ã‚ãˆã¦ç®¡ç†å¤–ã¨ã—ã¦ã‚‚å•é¡Œãªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚µãƒ¼ãƒ“ã‚¹åã‚’æŒ‡å®šã—ã¦ã€Application Auto Scalingã®ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ ############################################### # IAM Role For ECS Service ############################################### # Service Linked Role resource \"aws_iam_service_linked_role\" \"ecs_service_auto_scaling\" { aws_service_name = \"ecs.application-autoscaling.amazonaws.com\" } ############################################### # Output IAM Role ############################################### output \"ecs_service_auto_scaling_iam_service_linked_role_arn\" { value = aws_iam_service_linked_role.ecs_service_auto_scaling.arn } Application Auto Scalingã«ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã€‚æ‰‹å‹•ã§è¨­å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ãŒã€Terraformã®ç®¡ç†å¤–ã§è‡ªå‹•çš„ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ãŸã‚ã€ã‚ãˆã¦å¦¥å”ã—ã¦ã‚‚è‰¯ã„ã€‚ ######################################### # Application Auto Scaling For ECS ######################################### resource \"aws_appautoscaling_target\" \"ecs\" { service_namespace = \"ecs\" resource_id = \"service/prd-foo-ecs-cluster/prd-foo-ecs-service\" scalable_dimension = \"ecs:service:DesiredCount\" max_capacity = 4 min_capacity = 2 # ã“ã®è¨­å®šãŒãªãã¨ã‚‚ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ«ãŒè‡ªå‹•çš„ã«æ§‹ç¯‰ã•ã‚Œã€AutoScalingã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€‚ role_arn = var.ecs_service_auto_scaling_iam_service_linked_role_arn } 10. LBãƒªã‚¹ãƒŠãƒ¼ã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # NLB target group ############################################### resource \"aws_lb_target_group\" \"this\" { name = \"prd-foo-nlb-tg\" port = 80 protocol = \"TCP\" vpc_id = \"*****\" deregistration_delay = \"60\" target_type = \"ip\" # â€»å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆï¼ˆï¼‘ï¼‰ slow_start = \"0\" # â€»å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆï¼ˆï¼’ï¼‰ health_check { protocol = \"HTTP\" healthy_threshold = 3 path = \"/healthcheck\" } # stickiness â€»å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆï¼ˆï¼“ï¼‰ # https://registry.terraform.io/providers/hashicorp/aws/3.16.0/docs/resources/lb_target_group#stickiness lifecycle { create_before_destroy = false } } ï¼ˆï¼‘ï¼‰NLBã¯ã‚¹ãƒ­ãƒ¼ã‚¹ã‚¿ãƒ¼ãƒˆã«éå¯¾å¿œ NLBã«ç´ä»˜ãã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã¯ã‚¹ãƒ­ãƒ¼ã‚¹ã‚¿ãƒ¼ãƒˆã«éå¯¾å¿œã®ãŸã‚ã€ã“ã‚Œã‚’æ˜ç¤ºçš„ã«ç„¡åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼ˆï¼’ï¼‰NLBãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã«ã¯è¨­å®šå¯èƒ½ãªé …ç›®ãŒå°‘ãªã„ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã®è»¢é€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒTCPã®å ´åˆã¯ã€è¨­å®šã§ããªã„ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã„ãã¤ã‹ã‚ã‚‹ã€‚ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒHTTPã¾ãŸã¯HTTPSã®æ™‚ã®ã¿ã€ãƒ‘ã‚¹ã‚’è¨­å®šã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_target_group#health_check ï¼ˆï¼“ï¼‰NLBã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ãƒã‚¹ã¯æ˜ç¤ºçš„ã«ç„¡åŠ¹åŒ– ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒã‚¹æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹å ´åˆã€AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ™‚ã«å•é¡ŒãŒèµ·ã“ã‚‰ãªã„ã‚ˆã†ã«ã€ã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè£…ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ãƒªãƒ³ã‚¯å…ˆã®NOTEæ–‡ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://registry.terraform.io/providers/hashicorp/aws/3.16.0/docs/resources/lb_target_group#stickiness ï¼ˆâ€»ï¼‰ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã®å‰Šé™¤æ™‚ã«ãƒªã‚¹ãƒŠãƒ¼ã‚’å…ˆã«å‰Šé™¤ã§ããªã„ã€‚ LBãƒªã‚¹ãƒŠãƒ¼ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«ä¾å­˜ã—ã¦ã„ã‚‹ãŒã€TerraformãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã®å‰Šé™¤æ™‚ã«ãƒªã‚¹ãƒŠãƒ¼ã‚’å…ˆã«å‰Šé™¤ã—ã‚ˆã†ã¨ã—ãªã„ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã€‚ Error deleting Target Group: ResourceInUse: Target group 'arn:aws:elasticloadbalancing:ap-northeast-1:123456789:targetgroup/xxxxx-tg/xxxxx' is currently in use by a listener or a rule status code: 400, request id: xxxxx ã“ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ä¸Šã§LBãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ã—ãŸã†ãˆã§ã€ã‚‚ã†ä¸€åº¦applyã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/hashicorp/terraform-provider-aws/issues/1315#issuecomment-415423529 11. RDSï¼ˆAurora MySQLã®å ´åˆï¼‰ ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ######################################### # RDS Cluster ######################################### resource \"aws_rds_cluster\" \"this\" { engine = \"aurora-mysql\" engine_version = \"5.7.mysql_aurora.2.08.3\" cluster_identifier = \"prd-foo-rds-cluster\" # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼‘ï¼‰ master_username = var.rds_db_master_username_ssm_parameter_value master_password = var.rds_db_master_password_ssm_parameter_value port = var.rds_db_port_ssm_parameter_value database_name = var.rds_db_name_ssm_parameter_value vpc_security_group_ids = [var.rds_security_group_id] db_subnet_group_name = aws_db_subnet_group.this.name db_cluster_parameter_group_name = aws_rds_cluster_parameter_group.this.id storage_encrypted = true backup_retention_period = 7 preferred_backup_window = \"00:00-00:30\" copy_tags_to_snapshot = true final_snapshot_identifier = \"final-db-snapshot\" skip_final_snapshot = false enabled_cloudwatch_logs_exports = [\"audit\", \"error\", \"general\", \"slowquery\"] preferred_maintenance_window = \"sun:01:00-sun:01:30\" # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼’ï¼‰ apply_immediately = true # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼“ï¼‰ availability_zones = [\"${var.region}${var.vpc_availability_zones.a}\", \"${var.region}${var.vpc_availability_zones.c}\"] deletion_protection = true lifecycle { ignore_changes = [ # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼”ï¼‰ availability_zones ] } } ############################################### # RDS Cluster Instance ############################################### resource \"aws_rds_cluster_instance\" \"this\" { for_each = var.vpc_availability_zones engine = \"aurora-mysql\" engine_version = \"5.7.mysql_aurora.2.08.3\" identifier = \"prd-foo-rds-instance-${each.key}\" cluster_identifier = aws_rds_cluster.this.id db_subnet_group_name = aws_db_subnet_group.this.id db_parameter_group_name = aws_db_parameter_group.this.id monitoring_interval = 60 monitoring_role_arn = var.rds_iam_role_arn auto_minor_version_upgrade = var.rds_auto_minor_version_upgrade preferred_maintenance_window = \"sun:01:00-sun:01:30\" apply_immediately = true # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼•ï¼‰ instance_class = var.rds_instance_class[each.key] # å¾Œè¿°ã®èª¬æ˜ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ï¼ˆï¼–ï¼‰ # preferred_backup_window } ï¼ˆï¼‘ï¼‰SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ Terraformã«å€¤ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãŸããªã„å ´åˆã¯ã€SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã§å€¤ã‚’ç®¡ç†ã—ã€ã“ã‚Œã‚’ãƒ‡ãƒ¼ã‚¿ãƒªã‚½ãƒ¼ã‚¹ã§å–å¾—ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦æ™‚ã«å¤‰æ›´é©ç”¨ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦æ™‚ã®å¤‰æ›´é©ç”¨ã‚’Terraformã§è¡Œã†å ´åˆã€ä¸€æ®µéšç›®ã«apply_immediatelyã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’falseã«å¤‰æ›´ã—ã¦applyã—ã€äºŒæ®µéšç›®ã«ä¿®æ­£ã‚’applyã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«ã¯AZãŒï¼“ã¤å¿…è¦ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã§ã¯ã€ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«ã€ï¼“ã¤ã®AZãŒå¿…è¦ã§ã‚ã‚‹ã€‚ãã®ãŸã‚ã€æŒ‡å®šã—ãŸAZãŒï¼’ã¤ã§ã‚ã£ã¦ã‚‚ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ä¸Šã§ï¼“ã¤ã®AZãŒè‡ªå‹•çš„ã«è¨­å®šã•ã‚Œã‚‹ã€‚TerraformãŒã“ã‚Œã‚’èªè­˜ã—ãªã„ã‚ˆã†ã«ã€ignore_changesã§AZã‚’æŒ‡å®šã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼š https://github.com/hashicorp/terraform-provider-aws/issues/7307#issuecomment-457441633 https://github.com/hashicorp/terraform-provider-aws/issues/1111 ï¼ˆï¼”ï¼‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’é…ç½®ã™ã‚‹AZã¯é¸ã¹ãªã„ äº‹å‰ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«AZã‚’è¡¨ã™è­˜åˆ¥å­ã‚’å…¥ã‚ŒãŸã¨ã—ã¦ã‚‚ã€Terraformã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’é…ç½®ã™ã‚‹AZã‚’é¸ã¹ãªã„ã€‚ãã®ãŸã‚ã€AZã¨è­˜åˆ¥å­ã®é–¢ä¿‚ãŒé€†ã«ãªã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚å¤šãã®å ´åˆã€ Cã‚¾ãƒ¼ãƒ³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæœ€åˆã«æ§‹ç¯‰ã•ã‚Œã‚‹ãŸã‚ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¾ãƒ¼ãƒ³åã¨é…ç½®ã•ã‚Œã‚‹A/Cã‚¾ãƒ¼ãƒ³ãŒé€†ã«ãªã‚‹ã€‚ãã®å ´åˆã¯ã€ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«æ‰‹å‹•ã§åå‰ã‚’å¤‰æ›´ã™ã‚Œã°ã‚ˆã„ã€‚ã“ã®å¤‰æ›´ã¯ã€TerraformãŒå·®åˆ†ã¨ã—ã¦èªè­˜ã—ãªã„ã®ã§å•é¡Œãªã„ã€‚ ï¼ˆï¼•ï¼‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã¯åˆ¥ã€…ã«è¨­å®šã™ã‚‹ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã«eachã§å€¤ã‚’æ¸¡ã•ãªã„å ´åˆã€å„DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã‚’åŒæ™‚ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã“ã®å ´åˆã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã§ããšã€ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æœ€å°åŒ–ã§ããªã„ã€‚ãã®ãŸã‚ã€eachã‚’ç”¨ã„ã¦ã€DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã”ã¨ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã‚’è¨­å®šã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã”ã¨ã«ç•°ãªã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã‚’è¨­å®šã™ã‚‹å ´åˆã¯ã€eachã§å‰²ã‚Šå½“ã¦ã‚‹å€¤ã®é †ç•ªã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€é…ç½®ã•ã‚Œã¦ã„ã‚‹AZã‚’äº‹å‰ã«ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼ˆï¼–ï¼‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ã¯è¨­å®šã—ãªã„ DBã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä¸¡æ–¹ã«ã€preferred_backup_windowã‚’è¨­å®šã§ãã‚‹ãŒã€RDSã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«è¨­å®šã—ã¦ã¯ã„ã‘ãªã„ã€‚ 12. Route53 ã¾ã¨ã‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # For foo domain ############################################### resource \"aws_route53_zone\" \"foo\" { name = var.route53_domain_foo } resource \"aws_route53_record\" \"foo\" { zone_id = aws_route53_zone.foo.id name = var.route53_domain_foo type = \"A\" alias { name = var.alb_dns_name zone_id = var.alb_zone_id evaluate_target_health = false } } 13. Route Table ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¯è‡ªå‹•æ§‹ç¯‰ Terraformã‚’ç”¨ã„ã¦VPCã‚’æ§‹ç¯‰ã—ãŸæ™‚ã€ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ãŒè‡ªå‹•çš„ã«æ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ã“ã‚Œã¯Terraformã®ç®¡ç†å¤–ã§ã‚ã‚‹ã€‚ 14. S3 ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ S3ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€è‡ªèº«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ã®ã“ã¨ã€‚å®šç¾©ã—ãŸãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã¯ã€aws_s3_bucket_policyã§ãƒ­ãƒ¼ãƒ«ã«ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã€‚ ALBã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚° ALBãŒãƒã‚±ãƒƒãƒˆã«ãƒ­ã‚°ã‚’æ›¸ãè¾¼ã‚ã‚‹ã‚ˆã†ã«ã€ã€ELBã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã€ã‚’è¨±å¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # S3 bucket policy ############################################### # S3ã«ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã—ã¾ã™ã€‚ resource \"aws_s3_bucket_policy\" \"alb\" { bucket = aws_s3_bucket.alb_logs.id policy = templatefile( \"${path.module}/policies/alb_bucket_policy.tpl\", {} ) } ALBã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ãƒã‚±ãƒƒãƒˆå†…ã«ã¯ã€è‡ªå‹•çš„ã«ã€/AWSLogs/ã€ã®åå‰ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ã€arn:aws:s3:::/*ã€ã®éƒ¨åˆ†ã‚’æœ€å°æ¨©é™ã¨ã—ã¦ã€ã€arn:aws:s3:::/AWSLogs//;*ã€ã«ã—ã¦ã‚‚ã‚ˆã„ã€‚æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ELBã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã¯ã€ã€582318560864ã€ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/load-balancer-access-logs.html#access-logging-bucket-permissions { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"arn:aws:iam::582318560864:root\" }, \"Action\": \"s3:PutObject\", \"Resource\": \"arn:aws:s3:::/*\" } ] } NLBã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚° ALBãŒãƒã‚±ãƒƒãƒˆã«ãƒ­ã‚°ã‚’æ›¸ãè¾¼ã‚ã‚‹ã‚ˆã†ã«ã€ã€delivery.logs.amazonaws.comã€ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ############################################### # S3 bucket policy ############################################### # S3ã«ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã—ã¾ã™ã€‚ resource \"aws_s3_bucket_policy\" \"nlb\" { bucket = aws_s3_bucket.nlb_logs.id policy = templatefile( \"${path.module}/policies/nlb_bucket_policy.tpl\", {} ) } NLBã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ãƒã‚±ãƒƒãƒˆå†…ã«ã¯ã€è‡ªå‹•çš„ã«ã€/AWSLogs/ã€ã®åå‰ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ã€arn:aws:s3:::/*ã€ã®éƒ¨åˆ†ã‚’æœ€å°æ¨©é™ã¨ã—ã¦ã€ã€arn:aws:s3:::/AWSLogs//;*ã€ã«ã—ã¦ã‚‚ã‚ˆã„ã€‚ { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"AWSLogDeliveryWrite\", \"Effect\": \"Allow\", \"Principal\": { \"Service\": \"delivery.logs.amazonaws.com\" }, \"Action\": \"s3:PutObject\", \"Resource\": \"arn:aws:s3:::/*\", \"Condition\": { \"StringEquals\": { \"s3:x-amz-acl\": \"bucket-owner-full-control\" } } }, { \"Sid\": \"AWSLogDeliveryAclCheck\", \"Effect\": \"Allow\", \"Principal\": { \"Service\": \"delivery.logs.amazonaws.com\" }, \"Action\": \"s3:GetBucketAcl\", \"Resource\": \"arn:aws:s3:::\" } ] } 15. WAF ruleãƒ–ãƒ­ãƒƒã‚¯ ï¼Šå®Ÿè£…ä¾‹ï¼Š API Gatewayç”¨ã®WAFã«ã€ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ‹’å¦ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ resource \"aws_wafv2_web_acl\" \"api_gateway\" { rule { name = \"block-user-agents\" priority = 0 statement { regex_pattern_set_reference_statement { # åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®main.tfãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†å‰²ã—ãŸæ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã‚’å‚ç…§ã™ã‚‹ã€‚ arn = var.wafv2_regex_pattern_set_regional_block_user_agents_arn field_to_match { # ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ¤œè¨¼ã™ã‚‹ã€‚ single_header { name = \"user-agent\" } } text_transformation { priority = 0 type = \"NONE\" } } } action { block {} } visibility_config { cloudwatch_metrics_enabled = true metric_name = \"APIGatewayWAFBlockUserAgentsRule\" sampled_requests_enabled = true } } default_action { allow {} } visibility_config { cloudwatch_metrics_enabled = true metric_name = \"APIGatewayALBWAFRules\" sampled_requests_enabled = true } # ï½ ä¸­ç•¥ ï½ } ï¼Šå®Ÿè£…ä¾‹ï¼Š API Gatewayç”¨ã®WAFã«ã€ç‰¹å®šã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ‹’å¦ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ resource \"aws_wafv2_web_acl\" \"api_gateway\" { rule { name = \"block-global-ip-addresses\" priority = 0 statement { ip_set_reference_statement { # åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®main.tfãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†å‰²ã—ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚»ãƒƒãƒˆã‚’å‚ç…§ã™ã‚‹ã€‚ arn = var.waf_blocked_global_ip_addresses } } action { block {} } visibility_config { cloudwatch_metrics_enabled = true metric_name = \"APIGatewayWAFBlockGlobalIPAddressesRule\" sampled_requests_enabled = true } } default_action { allow {} } visibility_config { cloudwatch_metrics_enabled = true metric_name = \"APIGatewayWAFRules\" sampled_requests_enabled = true } # ï½ ä¸­ç•¥ ï½ } ï¼Šå®Ÿè£…ä¾‹ï¼Š API Gatewayç”¨ã®WAFã«ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ‹’å¦ã™ã‚‹ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ resource \"aws_wafv2_web_acl\" \"api_gateway\" { rule { name = \"block-sql-injection\" priority = 0 statement { # ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ«ãƒ¼ãƒ«ã‚’ç”¨ã„ã‚‹ã€‚ managed_rule_group_statement { vendor_name = \"AWS\" name = \"AWSManagedRulesSQLiRuleSet\" } } override_action { count {} } visibility_config { cloudwatch_metrics_enabled = true metric_name = \"APIGatewayWAFBlockSQLInjectionRule\" sampled_requests_enabled = true } } default_action { allow {} } visibility_config { cloudwatch_metrics_enabled = true metric_name = \"APIGatewayWAFRules\" sampled_requests_enabled = true } # ï½ ä¸­ç•¥ ï½ } ï¼Šå®Ÿè£…ä¾‹ï¼Š ALBç”¨ã®WAFã«ã€APIã‚­ãƒ¼ã¾ãŸã¯Bearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’ORæ¡ä»¶ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ã‚ãã¾ã§ä¾‹ã¨ã—ã¦ã§ã€æœ¬æ¥ã§ã‚ã‚Œã°ã€åˆ¥ã€…ã®ãƒ«ãƒ¼ãƒ«ã¨ã—ãŸæ–¹ãŒè‰¯ã„ã€‚ resource \"aws_wafv2_web_acl\" \"api_gateway\" { # x-api-keyãƒ˜ãƒƒãƒ€ãƒ¼ã«APIã‚­ãƒ¼ã‚’å«ã‚€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã—ã¾ã™ã€‚ rule { name = \"allow-request-including-api-key\" priority = 3 statement { or_statement { # APIã‚­ãƒ¼ã‚’æŒã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã—ã¾ã™ã€‚ statement { byte_match_statement { positional_constraint = \"EXACTLY\" search_string = var.waf_api_key_ssm_parameter_value field_to_match { single_header { name = \"x-api-key\" } } text_transformation { priority = 0 type = \"NONE\" } } } # Bearerãƒˆãƒ¼ã‚¯ãƒ³ã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã—ã¾ã™ã€‚ statement { byte_match_statement { positional_constraint = \"EXACTLY\" search_string = var.waf_bearer_token_ssm_parameter_value field_to_match { single_header { name = \"authorization\" } } text_transformation { priority = 0 type = \"NONE\" } } } } } action { allow {} } visibility_config { cloudwatch_metrics_enabled = true metric_name = \"APIGatewayWAFAllowRequestIncludingAPIKeyRule\" sampled_requests_enabled = true } } # ï½ ä¸­ç•¥ ï½ } IPã‚»ãƒƒãƒˆã®ä¾å­˜é–¢ä¿‚ WAFã®IPã‚»ãƒƒãƒˆã¨ä»–è¨­å®šã®ä¾å­˜é–¢ä¿‚ã«ç™–ãŒã‚ã‚‹ã€‚æ–°ã—ã„IPã‚»ãƒƒãƒˆã¸ã®ä»˜ã‘æ›ãˆã¨å¤ã„IPã‚»ãƒƒãƒˆã®å‰Šé™¤ã‚’åŒæ™‚ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚‚ã—åŒæ™‚ã«è¡Œã£ãŸå ´åˆã€Terraformã¯å¤ã„IPã‚»ãƒƒãƒˆã®å‰Šé™¤å‡¦ç†ã‚’å…ˆã«å®Ÿè¡Œã™ã‚‹ãŒã€ã“ã‚Œã¯WAFã«ç´ä»˜ã„ã¦ã„ã‚‹ãŸã‚ã€ã“ã“ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ã¦ã—ã¾ã†ã€‚ãã®ãŸã‚ã€IPã‚»ãƒƒãƒˆã‚’æ–°ã—ãè¨­å®šã—ç›´ã™å ´åˆã¯ã€ä»¥ä¸‹ã®é€šã‚ŠäºŒã¤ã®æ®µéšã«åˆ†ã‘ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã¡ãªã¿ã«ã€IPã‚»ãƒƒãƒˆã®åå‰ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€æ›´æ–°å‡¦ç†ã§ã¯ãªãå‰Šé™¤ã‚’ä¼´ã†å†æ§‹ç¯‰å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚æ³¨æ„ã™ã‚‹ã€‚ æ–°ã—ã„IPã‚»ãƒƒãƒˆã®resourceã‚’å®Ÿè£…ã—ã€ACLã«ç´ä»˜ã‘ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚ å¤ã„IPã‚»ãƒƒãƒˆã®resourceã‚’å‰Šé™¤ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚ ã‚‚ã—ã€ã“ã‚Œã‚’å¿˜ã‚Œã¦ã—ã¾ã£ãŸå ´åˆã¯ã€ç”»é¢ä¸Šã§é©å½“ãªIPã‚»ãƒƒãƒˆã«ä»˜ã‘æ›ãˆã¦ã€å‰Šé™¤å‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ 16. å…±é€šã®è¨­å®š Terraformç®¡ç†å¤–ã®AWSãƒªã‚½ãƒ¼ã‚¹ ä»¥ä¸‹ã®AWSãƒªã‚½ãƒ¼ã‚¹ã¯Terraformã§ç®¡ç†ã—ãªã„æ–¹ãŒä¾¿åˆ©ã§ã‚ã‚‹ã€‚ã¾ãŸã€AWSã®ä»•æ§˜ä¸Šã®ç†ç”±ã§ã€ç®¡ç†å¤–ã«ãªã£ã¦ã—ã¾ã†ã‚‚ã®ã‚‚ã‚ã‚‹ã€‚Terraformã®ç®¡ç†å¤–ã®ãƒªã‚½ãƒ¼ã‚¹ã«ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ä¸Šã‹ã‚‰ã€ã€Not managed by = Terraformã€ã¨ã„ã†ã‚¿ã‚°ã‚’ã¤ã‘ãŸæ–¹ãŒè‰¯ã„ã€‚ AWSãƒªã‚½ãƒ¼ã‚¹ ç®¡ç†å¤–ã®éƒ¨åˆ† ç®¡ç†å¤–ã®ç†ç”± API Gatewayã€ç´ä»˜ãVPCãƒªãƒ³ã‚¯ å…¨ã¦ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒãƒ¼ãƒ ãŒã‚¹ãƒ ãƒ¼ã‚ºã«APIã‚’æ§‹ç¯‰ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã€‚ Chatbot å…¨ã¦ AWSãŒAPIã‚’å…¬é–‹ã—ã¦ã„ãªã„ãŸã‚ã€Terraformã§æ§‹ç¯‰ã§ããªã„ã€‚ EC2 ç§˜å¯†éµ Terraformã§æ§‹ç¯‰ã™ã‚‹æ™‚ã«GitHubã§ç§˜å¯†éµã‚’ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§å´ä¸‹ã™ã‚‹ã€‚ Global Accelerator ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— ãƒªã‚½ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®ã¿Terraformã§ç®¡ç†ã§ããªã„ã€‚ IAMãƒ¦ãƒ¼ã‚¶ å…¨ã¦ IAMãƒ¦ãƒ¼ã‚¶ã‚°ãƒ«ãƒ¼ãƒ— å…¨ã¦ IAMãƒ­ãƒ¼ãƒ« ãƒ»ãƒ¦ãƒ¼ã‚¶ã«ç´ä»˜ããƒ­ãƒ¼ãƒ«ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ« ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒ³ã‚¯ãƒ­ãƒ¼ãƒ«ã¯ã€AWSãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ã«ä¼´ã£ã¦ã€è‡ªå‹•çš„ã«ä½œã‚‰ã‚Œã‚‹ãŸã‚ã€Terraformã§ç®¡ç†ã§ããªã„ã€‚ãŸã ã—ã€æ•°ãŒå¤šã„ãŸã‚ã‚ãˆã¦è¡Œã‚ãªã„ãŒã€Terraformã§æ§‹ç¯‰ã—ã¦AWSãƒªã‚½ãƒ¼ã‚¹ã«ç´ä»˜ã‘ã‚‹ã“ã¨ã‚‚ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚ Network Interface å…¨ã¦ ä»–ã®AWSãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ã«ä¼´ã£ã¦ã€è‡ªå‹•çš„ã«æ§‹ç¯‰ã•ã‚Œã‚‹ãŸã‚ã€Terraformã§ç®¡ç†ã§ããªã„ã€‚ RDS adminä»¥å¤–ã®ãƒ¦ãƒ¼ã‚¶ å€‹åˆ¥ã®ãƒ¦ãƒ¼ã‚¶ä½œæˆã®ãŸã‚ã«ã€mysql providerã¨ã„ã†æ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã—ã‹ã—ã€ç”¨ã„ã‚‹ä¸Šã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆæˆ¦ç•¥ã¨ç›¸æ€§ãŒæ‚ªã„ã€‚ Route53 ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚³ãƒ¼ãƒ‰ ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã‚’ä½œæˆã™ã‚‹ã¨ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦ã€ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¬ã‚³ãƒ¼ãƒ‰ã®æƒ…å ±ãŒè‡ªå‹•çš„ã«è¨­å®šã•ã‚Œã‚‹ã€‚ã“ã‚Œã¯ã€Terraformã®ç®¡ç†å¤–ã§ã‚ã‚‹ã€‚ S3 tfstateã®ç®¡ç†ãƒã‚±ãƒƒãƒˆ tfstateãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã€Terraformã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚ˆã‚Šå…ˆã«å­˜åœ¨ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ å…¨ã¦ ECSã«æ©Ÿå¯†ãªç’°å¢ƒå¤‰æ•°ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã€‚ å‰Šé™¤ä¿è­·æ©Ÿèƒ½ã®ã‚ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ å‰Šé™¤ä¿è­·è¨­å®šã®ã‚ã‚‹AWSãƒªã‚½ãƒ¼ã‚¹ã«ç™–ãŒã‚ã‚‹ã€‚å‰Šé™¤ä¿è­·ã®ç„¡åŠ¹åŒ–ã¨ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã‚’åŒæ™‚ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚‚ã—åŒæ™‚ã«è¡Œã£ãŸå ´åˆã€å‰Šé™¤å‡¦ç†ã‚’å…ˆã«å®Ÿè¡Œã™ã‚‹ãŒã€å‰Šé™¤ã¯ä¿è­·ã•ã‚ŒãŸã¾ã¾ãªã®ã§ã€ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ãã®ãŸã‚ã€ã“ã®AWSãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹æ™‚ã¯ã€ä»¥ä¸‹ã®é€šã‚ŠäºŒã¤ã®æ®µéšã«åˆ†ã‘ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ å‰Šé™¤ä¿è­·ã‚’ç„¡åŠ¹åŒ–ï¼ˆfalseï¼‰ã«å¤‰æ›´ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚ ã‚‚ã—ã€ã“ã‚Œã‚’å¿˜ã‚Œã¦ã—ã¾ã£ãŸå ´åˆã¯ã€ç”»é¢ä¸Šã§å‰Šé™¤å‡¦ç†ã‚’ç„¡åŠ¹åŒ–ã—ã€å‰Šé™¤å‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ AWSãƒªã‚½ãƒ¼ã‚¹å Terraformä¸Šã§ã®è¨­å®šå ALB enable_deletion_protection EC2 disable_api_termination RDS deletion_protection "},"public/infrastructure_as_code/infrastructure_as_code_terraform_ci_cd.html":{"url":"public/infrastructure_as_code/infrastructure_as_code_terraform_ci_cd.html","title":"ğŸ“– ï¸Terraformã®CICDãƒ•ãƒ­ãƒ¼","keywords":"","body":"Terraformã®CICDãƒ•ãƒ­ãƒ¼ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. CircleCIã‚’ç”¨ã„ãŸCICD è¦ç´  ãƒ»ç’°å¢ƒ env èª¬æ˜ dev ãƒ—ãƒ«ãƒªã‚¯ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã«ã€ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ãƒ•ãƒ©ç’°å¢ƒ stg ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ prd æœ¬ç•ªç’°å¢ƒ ãƒ»ã‚¸ãƒ§ãƒ– jobs èª¬æ˜ plan aws-cliã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‹ã‚‰terraform plan -outã‚³ãƒãƒ³ãƒ‰ã¾ã§ã®ä¸€é€£ã®å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ æ‰¿èªã‚¸ãƒ§ãƒ– apply stgç’°å¢ƒã¾ãŸã¯prdç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ ãƒ»ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ workflows èª¬æ˜ feature featureãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰devç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop developãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰stgç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main mainãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰prdç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ config.ymlãƒ•ã‚¡ã‚¤ãƒ« version: 2.1 executors: primary_container: parameters: env: type: enum enum: [ \"dev\", \"stg\", \"prd\" ] docker: - image: hashicorp/terraform:x.xx.x working_directory: ~/foo_infrastructure environment: ENV: > commands: # AWSã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã®ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ aws_setup: steps: - run: name: Install jq command: | apk add curl curl -o /usr/bin/jq -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-linux64 chmod +x /usr/bin/jq - run: name: Install aws-cli command: | apk add python3 apk add py-pip pip3 install awscli aws --version - run: name: Assume role command: | set -x source ./ops/assume.sh # terraform initã‚’è¡Œã„ã¾ã™ã€‚ terraform_init: steps: - run: name: Terraform init command: | set -x source ./ops/terraform_init.sh # terraform fmtã‚’è¡Œã„ã¾ã™ã€‚ terraform_fmt: steps: - run: name: Terraform fmt command: | set -x source ./ops/terraform_fmt.sh # terraform validateã‚’è¡Œã„ã¾ã™ã€‚ terraform_validate: steps: - run: name: Terraform validate command: | set -x source ./export_aws_envs.sh source ./ops/terraform_validate.sh # terraform planã‚’è¡Œã„ã¾ã™ã€‚ terraform_plan: steps: - run: name: Terraform plan command: | set -x source ./export_aws_envs.sh source ./ops/terraform_plan.sh ls -la # terraform applyã‚’è¡Œã„ã¾ã™ã€‚ terraform_apply: steps: - run: name: Terraform apply command: | set -x ls -la source ./export_aws_envs.sh source ./ops/terraform_apply.sh jobs: plan: parameters: exr: type: executor executor: > steps: - checkout - aws_setup - terraform_init - terraform_fmt - terraform_validate - terraform_plan - persist_to_workspace: root: . paths: - . apply: parameters: exr: type: executor executor: > steps: - attach_workspace: at: . - terraform_apply workflows: # Development env feature: jobs: - plan: name: plan_dev exr: name: primary_container env: dev filters: branches: only: - /feature.*/ - apply: name: apply_dev exr: name: primary_container env: dev requires: - plan_dev # Staging env develop: jobs: - plan: name: plan_stg exr: name: primary_container env: stg filters: branches: only: - develop - hold_apply: name: hold_apply_stg type: approval requires: - plan_stg - apply: name: apply_stg exr: name: primary_container env: stg requires: - hold_apply_stg # Production env main: jobs: - plan: name: plan_prd exr: name: primary_container env: prd filters: branches: ignore: /.*/ tags: only: /release\\/.*/ - hold_apply: name: hold_apply_prd type: approval requires: - plan_prd filters: branches: ignore: /.*/ tags: only: /release\\/.*/ - apply: name: apply_prd exr: name: primary_container env: prd requires: - hold_apply_prd filters: branches: ignore: /.*/ tags: only: /release\\/.*/ ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ»assume_role.shãƒ•ã‚¡ã‚¤ãƒ« å‚è€ƒï¼š ãƒ»terraform_apply.shãƒ•ã‚¡ã‚¤ãƒ« #!/bin/bash set -xeuo pipefail # credentialsã®æƒ…å ±ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ source ./aws_envs.sh terraform -chdir=./${ENV} apply \\ -parallelism=30 \\ ${ENV}.tfplan | ./ops/tfnotify --config ./${ENV}/tfnotify.yml apply ãƒ»terraform_fmt.shãƒ•ã‚¡ã‚¤ãƒ« #!/bin/bash set -xeuo pipefail terraform fmt \\ -recursive \\ -check ãƒ»terraform_init.shãƒ•ã‚¡ã‚¤ãƒ« #!/bin/bash set -xeuo pipefail # credentialsã®æƒ…å ±ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ source ./aws_envs.sh terraform -chdir=./${ENV} init \\ -upgrade \\ -reconfigure \\ -backend=true \\ -backend-config=\"bucket=${ENV}-tfstate-bucket\" \\ -backend-config=\"key=terraform.tfstate\" \\ -backend-config=\"encrypt=true\" ãƒ»terraform_plan.shãƒ•ã‚¡ã‚¤ãƒ« #!/bin/bash set -xeuo pipefail # credentialsã®æƒ…å ±ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ source ./aws_envs.sh terraform -chdir=./${ENV} plan \\ -var-file=./${ENV}/foo.tfvars \\ -out=${ENV}.tfplan \\ -parallelism=30 | ./ops/tfnotify --config ./${ENV}/tfnotify.yml plan ãƒ»terraform_validate.shãƒ•ã‚¡ã‚¤ãƒ« #!/bin/bash set -xeuo pipefail terraform -chdir=./${ENV} validate 02. tfnotify tfnotifyã¨ã¯ terraformã®planã¾ãŸã¯applyã®å‡¦ç†çµæœã‚’ã€POSTã§é€ä¿¡ã™ã‚‹ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ã“ã¨ã€‚URLã‚„é€ä¿¡å†…å®¹ã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã™ã‚‹ã€‚ ã‚³ãƒãƒ³ãƒ‰ CircleCIã§åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€commandã®ä¸­ã§ã€ä»¥ä¸‹ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸtfnotifyã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ç’°å¢ƒåˆ¥ã«tfnotifyã‚’é…ç½®ã—ã¦ãŠãã¨ã‚ˆã„ã€‚ https://github.com/mercari/tfnotify/releases/tag/v0.7.0 #!/bin/bash set -xeuo pipefail terraform -chdir=./${ENV} plan | ./ops/tfnotify --config ./${ENV}/tfnotify.yml plan è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« ã‚ã‚‰ã‹ã˜ã‚ã€GitHubã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ã€CIãƒ„ãƒ¼ãƒ«ã®ç’°å¢ƒå¤‰æ•°ã«ç™»éŒ²ã—ã¦ãŠãã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ã¨ã—ã¦ã€GitHubã®ç‰¹å®šã®ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«POSTã§é€ä¿¡ã™ã‚‹ã€‚ # https://github.com/mercari/tfnotify --- ci: circleci notifier: github: # ç’°å¢ƒå¤‰æ•°ã«ç™»éŒ²ã—ãŸãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ token: $GITHUB_TOKEN repository: # é€ä¿¡å…ˆã®ãƒ¦ãƒ¼ã‚¶åã‚‚ã—ãã¯çµ„ç¹”å owner: \"foo-company\" name: \"foo-repository\" terraform: plan: template: | {{ .Title }} for staging [CI link]( {{ .Link }} ) {{ .Message }} {{if .Result}} {{ .Result }} {{end}} Details (Click me) {{ .Body }} apply: template: | {{ .Title }} {{ .Message }} {{if .Result}} {{ .Result }} {{end}} Details (Click me) {{ .Body }} 03. ãƒªãƒªãƒ¼ã‚¹ ãƒªãƒªãƒ¼ã‚¹ã®ç²’åº¦ ãƒ»æ—¢å­˜ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€æ–°ã—ã„ãƒªã‚½ãƒ¼ã‚¹ã‚’ç´ã¥ã‘ã‚‹å ´åˆ æ—¢å­˜ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€æ–°ã—ã„ãƒªã‚½ãƒ¼ã‚¹ã‚’ç´ã¥ã‘ã‚‹å ´åˆã€æ–°ã—ã„ãƒªã‚½ãƒ¼ã‚¹ã®æ§‹ç¯‰ã¨ç´ã¥ã‘ã‚’åˆ¥ã€…ã«ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã€‚çµŒé¨“å‰‡ã§createå‡¦ç†ã‚„destroyå‡¦ç†ã‚ˆã‚Šã‚‚updateå‡¦ç†ã®æ–¹ãŒã‚¨ãƒ©ãƒ¼ãŒå°‘ãªã„ãŸã‚ã€ã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§å•é¡ŒãŒèµ·ã“ã‚Šã«ãã„ã€‚ã¾ãŸã€Terraformã§å•é¡ŒãŒèµ·ã“ã£ãŸã¨ã—ã¦ã‚‚ã€å¤‰æ›´ç‚¹ãŒç´ã¥ã‘ã ã‘ãªã®ã§ã€åŸå› ã‚’è¿½ç©¶ã—ã‚„ã™ã„ã€‚ ãƒ»Terraformã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä¸¡æ–¹ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹å ´åˆ Terraformã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä¸¡æ–¹ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹å ´åˆã€Teraformã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’åˆ¥ã€…ã«ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/infrastructure_as_code/infrastructure_as_code_terraform.html ãƒªãƒªãƒ¼ã‚¹å¾Œã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ Terraformã«ã¯ã€ã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ãŒãªã„ã€‚ãã“ã§ã€ä¸€ã¤å‰ã®ãƒªãƒªãƒ¼ã‚¹ã‚¿ã‚°ã‚’Rerunã™ã‚‹ã“ã¨ã§ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ä»Šå›ã®ãƒªãƒªãƒ¼ã‚¹ã®createå‡¦ç†ãŒå°‘ãªã„ã»ã©Rerunã§destroyå‡¦ç†ãŒå°‘ãªãã€åå¯¾ã«destroyå‡¦ç†ãŒå°‘ãªã„ã»ã©createå‡¦ç†ãŒå°‘ãªããªã‚‹ã€‚ã‚‚ã—ãƒªãƒªãƒ¼ã‚¹æ™‚ã«å•é¡ŒãŒèµ·ã“ã£ãŸå ´åˆã€ã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ãŒã€çµŒé¨“å‰‡ã§createå‡¦ç†ã‚„destroyå‡¦ç†ã‚ˆã‚Šã‚‚updateå‡¦ç†ã®æ–¹ãŒã‚¨ãƒ©ãƒ¼ãŒå°‘ãªã„ãŸã‚ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«ã‚‚ãŸã¤ãã«ãã„ã€‚ãã®ãŸã‚ã€Rerunæ™‚ã«ã©ã®ãã‚‰ã„ã®createå‡¦ç†ã‚„destroyå‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‹ã¨è€ƒæ…®ã—ã€ä¸€ã¤å‰ã®ãƒªãƒªãƒ¼ã‚¹ã‚¿ã‚°ã‚’Rerunã™ã‚‹ã‹å¦ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã€‚ "},"public/infrastructure_as_code/infrastructure_as_code_serverless_framework_serverless_command.html":{"url":"public/infrastructure_as_code/infrastructure_as_code_serverless_framework_serverless_command.html","title":"ğŸ“– ï¸serverlessã‚³ãƒãƒ³ãƒ‰","keywords":"","body":"serverlessã‚³ãƒãƒ³ãƒ‰ 01. ã‚³ãƒãƒ³ãƒ‰ print ãƒ»printã¨ã¯ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/cli-reference/print ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— $ serverless print ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ‰ $ serverless print --FOO foo deploy ãƒ»deployã¨ã¯ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/cli-reference/deploy ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ $ serverless deploy ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’serverless.ymlãƒ•ã‚¡ã‚¤ãƒ«ã«æ¸¡ã—ã€deployã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ serverless deploy --FOO foo ãƒ»-v å®Ÿè¡Œãƒ­ã‚°ã‚’è¡¨ç¤ºã—ã¤ã¤ã€deployã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ serverless deploy -v "},"public/infrastructure_as_code/infrastructure_as_code_serverless_framework_serverless_yml.html":{"url":"public/infrastructure_as_code/infrastructure_as_code_serverless_framework_serverless_yml.html","title":"ğŸ“– ï¸serverless.yml","keywords":"","body":"serverless.ymlï¼ˆawsã®å ´åˆï¼‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. configValidationMode configValidationModeã¨ã¯ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œæ™‚ã«ã€ã‚¨ãƒ©ãƒ¼ã‚’å‡ºåŠ›ã™ã‚‹ãƒ¬ãƒ™ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/serverless.yml ï¼Šå®Ÿè£…ä¾‹ï¼Š configValidationMode: warn 02. custom customã¨ã¯ ã‚¹ã‚³ãƒ¼ãƒ—ãŒserverless.ymlãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ã¿ã®å¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/variables ï¼Šå®Ÿè£…ä¾‹ï¼Š custom: foo: foo 03. frameworkVersion frameworkVersionã¨ã¯ Serverless Frameworkã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/serverless.yml ï¼Šå®Ÿè£…ä¾‹ï¼Š frameworkVersion: '2' 04. functions functionsã¨ã¯ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/functions description Lambdaé–¢æ•°ã®èª¬æ˜æ–‡ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: description: The function that do foo environment Lambdaé–¢æ•°ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/functions#environment-variables ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: environment: FOO: foo BAR: bar BAz: baz events ãƒ»eventBridge Lambdaé–¢æ•°ã«ç´ã¥ã‘ã¦æ§‹ç¯‰ã™ã‚‹EventBridgeã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/events/event-bridge ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦ã€JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ functions: main: events: - eventBridge: pattern: ${file(./event_bridge/patterns/pattern.json)} ãƒ»sqs Lambdaé–¢æ•°ã«ç´ã¥ã‘ã‚‹SQSã‚’è¨­å®šã™ã‚‹ã€‚æ–°ã—ãSQSã‚’æ§‹ç¯‰ã§ããšã€æ—¢å­˜ã®SQSã¨ç´ã¥ã‘ã‚‹æ©Ÿèƒ½ã—ã‹ãªã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/events/sqs ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: events: - sqs:arn:aws:sqs:region:****:prd-foo-queue image ãƒ»name Lambdaé–¢æ•°ã§ä½¿ç”¨ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: image: name: base maximumRetryAttempts Lambdaé–¢æ•°ã®å†è©¦è¡Œå›æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/functions#maximum-event-age-and-maximum-retry-attempts ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: maximumRetryAttempts: 1 memorySize Lambdaé–¢æ•°ã®ãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚ºã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: memorySize: 512 name Lambdaé–¢æ•°ã®åå‰ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: name: role Lambdaé–¢æ•°ã«ç´ã¥ã‘ã‚‹IAMãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š åˆ¥ã«resources.Resourcesã‚’ç”¨ã„ã¦æ§‹ç¯‰ã—ãŸIAMãƒ­ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ functions: main: role: !GetAtt LambdaRole.Arn runtime Lambdaé–¢æ•°ã§ä½¿ç”¨ã™ã‚‹è¨€èªã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š functions: main: runtime: 05. package packageã¨ã¯ ç”Ÿæˆã•ã‚Œã‚‹ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/packaging patterns ï¼Šå®Ÿè£…ä¾‹ï¼Š package: patterns: - ./bin/** 06. provider providerã¨ã¯ Serverless Frameworkã§æ“ä½œã™ã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼ã‚’è¨­å®šã™ã‚‹ã€‚ãƒ™ãƒ³ãƒ€ãƒ¼ã§ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼ã®ãŸã‚ã€ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«æƒ…å ±ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã€‚ ecr ãƒ»scanOnPush ï¼Šå®Ÿè£…ä¾‹ï¼Š provider: ecr: scanOnPush: true ãƒ»images Lambdaé–¢æ•°ã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŒ‡å®šã—ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’ä»˜ã‘ã‚‹ã€‚åå‰ã¯å…¨ã¦å°æ–‡å­—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š provider: ecr: images: base: uri: /@ eventBridge ãƒ»useCloudFormation EventBridgeã‚’CloudFormationã§æ§‹ç¯‰ã™ã‚‹ã‹å¦ã‹ã‚’è¨­å®šã™ã‚‹ã€‚ provider: eventBridge: useCloudFormation: true lambdaHashingVersio Lambdaé–¢æ•°ã®ãƒãƒƒã‚·ãƒ¥ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š provider: lambdaHashingVersion: 20201221 name ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼åã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š provider: name: aws region ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ§‹ç¯‰ã™ã‚‹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ provider: region: ap-northeast-1 stackName CloudFormationã®ã‚¹ã‚¿ãƒƒã‚¯åã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š provider: stackName: stage ã‚¹ãƒ†ãƒ¼ã‚¸åã‚’è¨­å®šã™ã‚‹ã€‚ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã®å®Ÿè¡Œç’°å¢ƒåã¨è€ƒãˆã¦ã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š provider: stage: 07. resources resourcesã¨ã¯ï¼ˆawsãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®å ´åˆï¼‰ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/resources IAMãƒ­ãƒ¼ãƒ« IAMãƒ­ãƒ¼ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š IAMãƒ­ãƒ¼ãƒ«ã«ç´ã¥ã‘ã‚‹IAMãƒãƒªã‚·ãƒ¼ã¯ã€JSONãƒ•ã‚¡ã‚¤ãƒ«ã§åˆ‡ã‚Šåˆ†ã‘ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã„ã€‚ resources: Resources: LambdaRole: Type: AWS::IAM::Role Properties: RoleName: prd-foo-lambda-role Description: The role for prd-foo-lambda AssumeRolePolicyDocument: ${file(./iam_role/policies/trust_policies/lambda_policy.json)} # ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒªã‚·ãƒ¼ Policies: - PolicyName: prd-foo-lambda-execution-policy PolicyDocument: ${file(./iam_role/policies/custom_managed_policies/lambda_execution_policy.json)} # ç®¡ç†ãƒãƒªã‚·ãƒ¼ ManagedPolicyArns: - arn:aws:iam::aws:policy/AWSLambdaExecute 08. service serviceã¨ã¯ï¼ˆawsãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®å ´åˆï¼‰ å‚è€ƒï¼šhttps://www.serverless.com/framework/docs/providers/aws/guide/services ï¼Šå®Ÿè£…ä¾‹ï¼Š service: foo-service 09. useDotenv useDotenvã¨ã¯ ï¼Šå®Ÿè£…ä¾‹ï¼Š useDotenv: true 10. variablesResolutionMode variablesResolutionModeã¨ã¯ ï¼Šå®Ÿè£…ä¾‹ï¼Š variablesResolutionMode: null "},"public/virtualization/virtualization.html":{"url":"public/virtualization/virtualization.html","title":"ğŸ“– ï¸ä»®æƒ³åŒ–","keywords":"","body":"ä»®æƒ³åŒ– ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ä»®æƒ³åŒ– ä»®æƒ³åŒ–ã¨ã¯ è‡ªèº«ã®é–‹ç™ºç’°å¢ƒã§Webã‚µã‚¤ãƒˆã‚’å‹•ã‹ã—ãŸã„å ´åˆã€ã¾ãšã€ãƒ‘ã‚½ã‚³ãƒ³å†…ã«Linuxç’°å¢ƒã®Webã‚µãƒ¼ãƒã€Appã‚µãƒ¼ãƒã€DBã‚µãƒ¼ãƒãªã©ã®ç‰©ç†ã‚µãƒ¼ãƒã‚’ä»®æƒ³çš„ã«æ§‹ç¯‰ã™ã‚‹ã€‚ãã—ã¦ã€è‡ªèº«ã®ãƒ‘ã‚½ã‚³ãƒ³ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€å„ä»®æƒ³ã‚µãƒ¼ãƒã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã«è¦‹ç«‹ã¦ã¦ã€SSHãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”¨ã„ã¦ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒã«ãƒªãƒ¢ãƒ¼ãƒˆãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã€‚ä»®æƒ³ç’°å¢ƒã®æ§‹ç¯‰æ–¹æ³•ã«ã¯ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚‹ã€‚ ãƒ›ã‚¹ãƒˆå‹ä»®æƒ³åŒ– ãƒ»ãƒ›ã‚¹ãƒˆå‹ä»®æƒ³åŒ–ã¨ã¯ ãƒ›ã‚¹ãƒˆOSä¸Šã§ã€å„ã‚µãƒ¼ãƒã‚’ä»®æƒ³çš„ã«æ§‹ç¯‰ã™ã‚‹ã€‚ ãƒ»Providerä¾‹ VMware Workstationã€Oracle VM VirtualBoxã€ãªã© ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼å‹ä»®æƒ³åŒ– ãƒ»ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼å‹ä»®æƒ³åŒ–ã¨ã¯ BIOSã‹ã‚‰èµ·å‹•ã—ãŸãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ä¸Šã§ã€å„ã‚µãƒ¼ãƒã‚’ä»®æƒ³çš„ã«æ§‹ç¯‰ã™ã‚‹ï¼ˆâ€»ãƒ›ã‚¹ãƒˆOSã¯ç”¨ã„ãªã„ï¼‰ã€‚ ãƒ»Providerä¾‹ VMware vSphere Hypervisorã€Xenã€KVMã€ãªã© ã‚³ãƒ³ãƒ†ãƒŠå‹ä»®æƒ³åŒ– ãƒ»ã‚³ãƒ³ãƒ†ãƒŠå‹ä»®æƒ³åŒ–ã¨ã¯ ãƒ›ã‚¹ãƒˆOSä¸Šã§ã€ã‚µãƒ¼ãƒã§ã¯ãªãã€ã‚µãƒ¼ãƒã¨ã—ã¦ã®æ©Ÿèƒ½ã‚’æŒã¤ã‚³ãƒ³ãƒ†ãƒŠã‚’ä»®æƒ³çš„ã«æ§‹ç¯‰ã™ã‚‹ã€‚ã‚«ãƒ¼ãƒãƒ«ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’åˆ†å‰²ã§ãã‚‹Namespaceï¼ˆPID namespaceã€Network namespaceã€UID namespaceï¼‰ã¨Control Groupsã‚’ç”¨ã„ã¦ã€å˜ä¸€ã®OSä¸Šã«ç‹¬ç«‹ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ â†’ DockerToolboxãŒã¡ã‚‡ã„é•ã† ãƒ»Providerä¾‹ Dockerã€LXCã€OpenVZã€ãªã© 01-02. å„ä»®æƒ³åŒ–ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æ¯”è¼ƒ èµ·å‹•é€Ÿåº¦ã®é•ã„ ãƒ›ã‚¹ãƒˆå‹ã¨ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶å‹ã§ã¯ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ï¼ˆCPUã€ãƒ¡ãƒ¢ãƒªã€ãƒãƒ¼ãƒ‰ãƒ‡ã‚£ã‚¹ã‚¯ï¼‰ã¨ã‚²ã‚¹ãƒˆOSã‚’ä»®æƒ³åŒ–ã™ã‚‹ã“ã¨ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ä¸€æ–¹ã§ã€ã‚³ãƒ³ãƒ†ãƒŠå‹ã§ã¯ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã¨ã‚²ã‚¹ãƒˆOSã®ä»®æƒ³åŒ–ã¯è¡Œã‚ãšã€namespaceã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹æˆã™ã‚‹ãŸã‚ã€ãã®åˆ†èµ·å‹•ãŒé€Ÿã„ã€‚ å‡¦ç†é€Ÿåº¦ã®é•ã„ ãƒ»Overheadã®å°ã•ã• ã‚²ã‚¹ãƒˆOSä¸Šã®ã‚¢ãƒ—ãƒªã‚’æ“ä½œã™ã‚‹å ´åˆã€ãƒ›ã‚¹ãƒˆå‹ã¨ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶å‹ã§ã¯ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚„ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ã‚’çµŒç”±ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã®åˆ†ã ã‘ã€æ™‚é–“ï¼ˆOverheadï¼‰ã‚’è¦ã™ã‚‹ã€‚ä¸€æ–¹ã§ã€ã‚³ãƒ³ãƒ†ãƒŠå‹ã§ã¯ã€å„ã‚³ãƒ³ãƒ†ãƒŠãŒãƒ›ã‚¹ãƒˆOSã¨ã‚«ãƒ¼ãƒãƒ«ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã€OverheadãŒå°ã•ã„ã€‚ ãƒ»Overheadã®æ¯”è¼ƒ sysbenchã¨ã„ã†ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ„ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã€CPUãƒ»ãƒ¡ãƒ¢ãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«I/Oã«ç€ç›®ã—ã€ç‰©ç†ãƒã‚·ãƒ³ãƒ»ã‚³ãƒ³ãƒ†ãƒŠå‹ä»®æƒ³åŒ–ï¼ˆDockerï¼‰ãƒ»ãƒ›ã‚¹ãƒˆå‹ä»®æƒ³åŒ–ï¼ˆVirtualBoxï¼‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ¯”è¼ƒã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠå‹ã§ã‚ã‚‹Dockerã¯æœ€ã‚‚OverheadãŒå°ã•ã„ã€‚ "},"public/virtualization/virtualization_container_docker_command.html":{"url":"public/virtualization/virtualization_container_docker_command.html","title":"ğŸ“– ï¸dockerã‚³ãƒãƒ³ãƒ‰","keywords":"","body":"dockerã‚³ãƒãƒ³ãƒ‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Dockerã®æ§‹æˆè¦ç´  å…¨ä½“åƒ å‚è€ƒï¼šhttps://www.slideshare.net/zembutsu/docker-underlying-and-containers-lifecycle Dockerã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ãƒ»Dockerã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã¯ Dockerã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€dockerã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³APIã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ»Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã¨ã¯ ãƒ›ã‚¹ãƒˆOSä¸Šã§ç¨¼åƒã—ã€ã‚³ãƒ³ãƒ†ãƒŠã®æ“ä½œã‚’æ‹…ã†å¸¸é§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒdockerã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€dockerãƒ‡ãƒ¼ãƒ¢ãƒ³APIãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€ã‚³ãƒãƒ³ãƒ‰ã«æ²¿ã£ã¦ã‚³ãƒ³ãƒ†ãƒŠãŒæ“ä½œã•ã‚Œã‚‹ã€‚ 02. ã‚³ãƒãƒ³ãƒ‰ attach ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦ã€èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã™ã‚‹ã€‚ $ docker attach build ãƒ»-force-rmã€--no-cache ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡ã—ã§ã€æŒ‡å®šã®Dockerfileã‚’åŸºã«ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã€‚å¤±æ•—ã—ãŸæ™‚ã¯å‰Šé™¤ã™ã‚‹ã‚ˆã†ã«ã€--force-rmã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ $ docker build --file Dockerfile --tag : --force-rm=true --no-cache . commit ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— åœæ­¢ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ docker commit $ docker commit /: container ãƒ»prune åœæ­¢ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã®ã¿ã‚’å…¨ã¦å‰Šé™¤ã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ docker container prune cp ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— Dockerfileã®COPYã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒ†ãƒŠå†…ã«é…ç½®ã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢ã—ã¦ã€å¤‰æ›´ã®ãŸã³ã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã†ã“ã¨ã¯é¢å€’ã®ãŸã‚ã€ãƒ›ã‚¹ãƒˆOSã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã«ã‚³ãƒ”ãƒ¼ã—ã€å†èª­ã¿è¾¼ã¿ã‚’è¡Œã†ã€‚ãŸã ã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’å†æ§‹ç¯‰ã™ã‚‹ã¨å…ƒã«æˆ»ã£ã¦ã—ã¾ã†ã“ã¨ã«æ³¨æ„ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š # ãƒ›ã‚¹ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ†ãƒŠã«ã‚³ãƒ”ãƒ¼ $ docker cp ./docker/www/nginx.conf :/etc/nginx/nginx.conf # ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šå¾Œã«ã€nginxã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†èª­ã¿è¾¼ã¿ã€‚ $ docker exec -it bin/bash # ã‚‚ã—ãã¯bin/sh [root@:~] $ nginx -s reload [root@:~] $ exit # ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ç¢ºèª $ docker logs create ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç”Ÿæˆã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã€‚èµ·å‹•ã¯ã—ãªã„ã€‚ $ docker create : exec ãƒ»-it ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦ã€èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãŒbashã‚„bashã®å ´åˆã€ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã§ãã‚‹ã€‚ # iï¼šinteractiveã€tï¼šttyï¼ˆå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼‰ $ docker exec -it /bin/bash # ã‚¤ãƒ¡ãƒ¼ã‚¸å†…ã«/bin/bash ãŒãªã„å ´åˆ $ docker exec -it /bin/sh ãƒ»attachã€execã®é•ã„ ã¾ãšattachã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã™ã‚‹ã€‚exitã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠã¨ã®æ¥ç¶šã‚’åˆ‡æ–­ã—ãŸå¾Œã€ã‚³ãƒ³ãƒ†ãƒŠãŒåœæ­¢ã—ã¦ã—ã¾ã†ã€‚ # ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹èµ·å‹• $ docker run -d -it --name : /bin/bash # ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶š $ docker attach # PID=1ã§ã€1ã¤ã®/bin/bashãƒ—ãƒ­ã‚»ã‚¹ãŒç¨¼åƒã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ [root@:~] ps aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.1 16152 3872 pts/0 Ss+ 18:06 0:00 /bin/bash root 33 0.0 0.1 45696 3732 pts/1 R+ 18:22 0:00 ps aux # ã‚³ãƒ³ãƒ†ãƒŠã¨ã®æ¥ç¶šã‚’åˆ‡æ–­ [root@:~] exit # ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ã‚’ç¢ºèª $ docker container ps -a --no-trunc # ==> ã‚³ãƒ³ãƒ†ãƒŠã®STATUSãŒEXITedã«ãªã£ã¦ã„ã‚‹ ä¸€æ–¹ã§execã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãŒbashã‚„bashã®å ´åˆã€ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã§ãã‚‹ã€‚exitã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠã¨ã®æ¥ç¶šã‚’åˆ‡æ–­ã—ãŸå¾Œã§ã‚‚ã€ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ç¶šã‘ã‚‹ã€‚ # ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹èµ·å‹• $ docker run -d -it --name : /bin/bash # å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã€ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶š $ docker exec -it /bin/bash # ã‚‚ã—ãã¯bin/sh # PID=1,17ã§ã€2ã¤ã®/bin/bashãƒ—ãƒ­ã‚»ã‚¹ãŒç¨¼åƒã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ [root@:~] ps aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.1 16152 3872 pts/0 Ss+ 18:06 0:00 /bin/bash root 17 0.0 0.1 16152 4032 pts/1 Ss 18:21 0:00 /bin/bash root 34 0.0 0.1 45696 3732 pts/1 R+ 18:22 0:00 ps aux # ã‚³ãƒ³ãƒ†ãƒŠã¨ã®æ¥ç¶šã‚’åˆ‡æ–­ [root@:~] exit # ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ã‚’ç¢ºèª $ docker container ps -a --no-trunc # ==> ã‚³ãƒ³ãƒ†ãƒŠã®STATUSãŒUPã«ãªã£ã¦ã„ã‚‹ search ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ¬ã‚¸ã‚¹ãƒˆãƒªå´ã«ä¿ç®¡ã•ã‚Œã¦ã„ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ¤œç´¢ã™ã‚‹ã€‚ $ docker search images ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ›ã‚¹ãƒˆOSã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¢ºèªã™ã‚‹ã€‚ $ docker images ãƒ»prune ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ã‚³ãƒ³ãƒ†ãƒŠã«ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä¸€æ‹¬ã§å‰Šé™¤ $ docker image prune ãƒ»rmi ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ã‚¿ã‚°åã®ãªã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã¿ã‚’å…¨ã¦å‰Šé™¤ã™ã‚‹ã€‚ $ docker rmi --force $(sudo docker images --filter \"dangling=true\" --all --quiet) inspect ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š èµ·å‹•ä¸­ã‚³ãƒ³ãƒ†ãƒŠã®å…¨ã¦ã®è¨­å®šå†…å®¹ã‚’è¡¨ç¤ºã™ã‚‹ã€‚grepã¨ã‚‚çµ„ã¿åˆã‚ã›ã‚‰ã‚Œã‚‹ã€‚ $ docker inspect $ docker inspect | grep IPAddress ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š json-fileãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ç”¨ã„ã¦ã„ã‚‹æ™‚ã«ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡ºåŠ›å…ˆã‚’ç¢ºèªã™ã‚‹ã€‚ $ docker inspect | grep 'LogPath' \"LogPath\": \"/var/lib/docker/containers/*****-json.log\", network ãƒ»ls ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ docker network ls NETWORK ID NAME DRIVER SCOPE ae25b9b7740b bridge bridge local aeef782b227d tech-notebook_default bridge local ãƒ»prune $ docker network prune ãƒ»inspect è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ã¦ã„ã‚‹æ™‚ã«ã€ã‚³ãƒ³ãƒ†ãƒŠãŒã„ãšã‚Œã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ $ docker network inspect ps ãƒ»-a ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ã¨åœæ­¢ã«ã‹ã‹ã‚ã‚‰ãšã€IDãªã©ã‚’ä¸€è¦§ã§è¡¨ç¤ºã€‚ $ docker ps -a pull ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ¬ã‚¸ã‚¹ãƒˆãƒªå´ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ $ docker pull : push ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ›ã‚¹ãƒˆOSã§ä½œæˆã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã€æŒ‡å®šã—ãŸDockerHubã®ãƒ¦ãƒ¼ã‚¶ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚ $ docker push /: ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ›ã‚¹ãƒˆOSã§ä½œæˆã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã€æŒ‡å®šã—ãŸECRã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚ECRã¯ã‚¿ã‚°åãŒã‚„ã‚„ç‰¹æ®Šã®ãŸã‚ã€äº‹å‰ã«ã‚¿ã‚°ã‚’ä»˜ã‘æ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ $ docker tag : /: $ docker push /: rm ãƒ»--force ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š èµ·å‹•ä¸­ï¼åœæ­¢ä¸­ã®å…¨ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’å¼·åˆ¶çš„ã«å‰Šé™¤ã™ã‚‹ã€‚ $ docker rm --force $(docker ps --all --quiet) run ãƒ»--hostname ã‚³ãƒ³ãƒ†ãƒŠå†…ã®etc/hostsãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèªã§ãã‚‹ã€‚hostnameã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å‘½åã—ã¦ã„ã‚Œã°ãã®åå‰ã€æŒ‡å®šã—ã¦ã„ãªã‘ã‚Œã°ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ docker run -d -it --hostname --name --publish=8080:80 : /bin/bash $ docker exec -it /bin/bash [root@:/] cat /etc/hosts 127.0.0.1 localhost ::1 localhost ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters 172.18.0.2 ãƒ»--publish æŒ‡å®šã—ãŸãƒ›ã‚¹ãƒˆãƒãƒ¼ãƒˆã¨ã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚--publish-allã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã¯ãƒ›ã‚¹ãƒˆãƒãƒ¼ãƒˆã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã‚“ã§ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.whitesourcesoftware.com/free-developer-tools/blog/docker-expose-port/ $ docker run -d -it --name --publish=8080:80 : /bin/bash ãƒ»--expose ã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆå…¬é–‹ã‚’exposeã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§è¨­å®šã§ãã‚‹ã€‚ã“ã‚Œã¯Dockerfileã§EXPOSEå‘½ä»¤ã¨ã—ã¦è¨­å®šã—ã¦ã‚‚ã‚ˆã„ã€‚ãªãŠã€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ãƒãƒ¼ãƒˆã¨åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.whitesourcesoftware.com/free-developer-tools/blog/docker-expose-port/ $ docker run -d -it --name --expose=80 : /bin/bash ãƒ»-aã€-d ã™ã§ã«åœæ­¢ä¸­ã¾ãŸã¯èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠãŒå­˜åœ¨ã—ã¦ã„ã¦ã‚‚ã€ã“ã‚Œã¨ã¯åˆ¥ã«ã‚³ãƒ³ãƒ†ãƒŠã‚’æ–°ã—ãæ§‹ç¯‰ã—ã€èµ·å‹•ã™ã‚‹ã€‚ã•ã‚‰ã«ãã®ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚èµ·å‹•æ™‚ã«bashãƒ—ãƒ­ã‚»ã‚¹ã‚„bashãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã§ãã‚‹ã€‚ä½•ã‚‚æ¸¡ã•ãªã„å ´åˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦bashãƒ—ãƒ­ã‚»ã‚¹ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚runã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã¨ãƒ‡ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã‚’é¸ã¶ã“ã¨ãŒã§ãã‚‹ã€‚æ–°ã—ãèµ·å‹•ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢å¾Œã«è‡ªå‹•å‰Šé™¤ã™ã‚‹å ´åˆã¯ã€rmã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š # ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹èµ·å‹•ã€‚ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã™ã‚‹ã€‚ $ docker run -a -it --rm --name : /bin/bash # ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹èµ·å‹•ã€‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã™ã‚‹ã€‚ $ docker run -d -it --rm --name : /bin/bash ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹æ™‚ã«ã€bashãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãã®å ´åˆã¯ã€bashãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ docker: Error response from daemon: OCI runtime create failed: container_linux.go:370: starting container process caused: exec: \"/bin/bash\": stat /bin/bash: no such file or directory: unknown. ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã¯ã€ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰èµ·å‹•ã§ã‚ã‚‹ã€‚ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œãªã„ãŸã‚ã€åŒä¸€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã§ãã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š # -aï¼šatattch mode $ docker run -a -it --name : /bin/bash ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã¯ã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰èµ·å‹•ã§ã‚ã‚‹ã€‚ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œç¶šã‘ã‚‹ãŸã‚ã€åŒä¸€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã§ããªã„ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ­ã‚°ã‚’ç›£è¦–ã§ãã‚‹ãŒã€ä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’å…¥åŠ›ã™ã‚‹ãŸã‚ã«ã¯ã€ãã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š # -dï¼›detached mode $ docker run -d -it --name : /bin/bash start ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ã€‚startã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹èµ·å‹•ã—ã‹ã§ããªã„ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š åœæ­¢ä¸­ã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦èµ·å‹•ã™ã‚‹ã€‚ $ docker start -i stop ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š èµ·å‹•ä¸­ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã™ã‚‹ã€‚ $ docker stop ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã™ã‚‹ã€‚ $ docker stop $(docker ps --all --quiet) volume ãƒ»create Volumeãƒã‚¦ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚dockerã‚³ãƒãƒ³ãƒ‰ã§ã¯ãªãã€docker-composeã‚³ãƒãƒ³ãƒ‰ã§ä½œæˆã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ›ã‚¹ãƒˆOSã®Dockerã‚¨ãƒªã‚¢ã«Volumeã‚’ä½œæˆ $ docker volume create ãƒ»ls ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š Dockerã‚¨ãƒªã‚¢ã®Volumeã®ä¸€è¦§ã‚’è¡¨ç¤º $ docker volume ls ãƒ»rm ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š Dockerã‚¨ãƒªã‚¢ã®Volumeã‚’å‰Šé™¤ $ docker volume rm ãƒ»inspect ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š Dockerã‚¨ãƒªã‚¢ã®Volumeã®è©³ç´°ã‚’è¡¨ç¤º $ docker volume inspect [ { \"CreatedAt\": \"2020-09-06T15:04:02Z\", \"Driver\": \"local\", \"Labels\": { \"com.docker.compose.project\": \"\", \"com.docker.compose.version\": \"1.26.2\", \"com.docker.compose.volume\": \"foo\" }, \"Mountpoint\": \"/var/lib/docker/volumes/_foo/_data\", \"Name\": \"_foo\", \"Options\": null, \"Scope\": \"local\" } ] # Dockerã‚¨ãƒªã‚¢ã‚’Volumeãƒã‚¦ãƒ³ãƒˆã—ã¦èµ·å‹• # ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã®Volumeåã‚’ä½¿ç”¨ $ docker run -d -it --name /bin/bash \\ --mount type=volume, src= volume-driver=local, dst= ï¼Šå®Ÿè£…ä¾‹ï¼Š Dockerfileã§Volumeãƒã‚¦ãƒ³ãƒˆã‚’è¡Œã†å ´åˆã€ãƒã‚¦ãƒ³ãƒˆå…ˆã®ã‚³ãƒ³ãƒ†ãƒŠå´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’è¨­å®šã™ã‚‹ã€‚Dockerã‚¨ãƒªã‚¢ã®ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã¯ã€è‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã‚‹ã€‚Docker Composeã§è¡Œã†ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ FROM ubuntu RUN mkdir /myvol RUN echo \"hello world\" > /myvol/greeting # ãƒã‚¦ãƒ³ãƒˆå…ˆã®ã‚³ãƒ³ãƒ†ãƒŠå´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå VOLUME /myvol 03. ãƒ­ã‚®ãƒ³ã‚° log ãƒ»--follow ãƒ­ã‚°ã‚’è¡¨ç¤ºã—ç¶šã‘ã‚‹ã€‚ãƒ­ã‚®ãƒ³ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒjson-fileã®å ´åˆã®ã¿æœ‰åŠ¹ã€‚ $ docker logs -f ãƒ»--tail ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š æŒ‡å®šã—ãŸè¡Œæ•°ã ã‘ã€ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ãƒ­ã‚®ãƒ³ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒjson-fileã®å ´åˆã®ã¿æœ‰åŠ¹ã€‚ $ docker logs --follow=true --tail=500 --log-driver ãƒ»ãƒ­ã‚®ãƒ³ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¨ã¯ ã‚³ãƒ³ãƒ†ãƒŠå†…ã®æ¨™æº–å‡ºåŠ›ï¼ˆ/dev/stdoutï¼‰ã¨æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ï¼ˆ/dev/stderrï¼‰ã«å‡ºåŠ›ã•ã‚ŒãŸãƒ­ã‚°ã‚’ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚„APIã«å¯¾ã—ã¦è»¢é€ã™ã‚‹ã€‚ $ docker run -d -it --log-driver --name : /bin/bash ãƒ»json-file æ¨™æº–å‡ºåŠ›ï¼æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚ŒãŸãƒ­ã‚°ã‚’ã€/var/lib/docker/containers/ï¼œã‚³ãƒ³ãƒ†ãƒŠIDï¼/ï¼œã‚³ãƒ³ãƒ†ãƒŠIDï¼-json.logãƒ•ã‚¡ã‚¤ãƒ«ã«è»¢é€ã™ã‚‹ã€‚æ¨™æº–ã®è¨­å®šå€¤ã§ã‚ã‚‹ã€‚ { \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"10m\", \"max-file\": \"3\" } } ãƒ»fluentd æ§‹é€ åŒ–ãƒ­ã‚°ã«å¤‰æ›ã—ã€ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã¨ã—ã¦ç¨¼åƒã™ã‚‹Fluentdã‚³ãƒ³ãƒ†ãƒŠã«é€ä¿¡ã™ã‚‹ã€‚ECSã‚³ãƒ³ãƒ†ãƒŠã®awsfirelensãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¯ã€fluentdãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ãƒ©ãƒƒãƒ”ãƒ³ã‚°ã—ãŸã‚‚ã®ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://docs.docker.com/config/containers/logging/fluentd/ https://aws.amazon.com/jp/blogs/news/under-the-hood-firelens-for-amazon-ecs-tasks/ { \"log-driver\": \"fluentd\", \"log-opts\": { \"fluentd-address\": \":24224\" } } ãƒ»none æ¨™æº–å‡ºåŠ›ï¼æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚ŒãŸãƒ­ã‚°ã‚’ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚„APIã«è»¢é€ã—ãªã„ã€‚ ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ãªã„ã“ã¨ã§ã€é–‹ç™ºç’°å¢ƒã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºã®è‚¥å¤§åŒ–ã‚’é˜²ãã€‚ ãƒ»awslogs æ¨™æº–å‡ºåŠ›ï¼æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚ŒãŸãƒ­ã‚°ã‚’CloudWatch-APIã«é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.docker.com/config/containers/logging/awslogs/ { \"log-driver\": \"awslogs\", \"log-opts\": { \"awslogs-region\": \"us-east-1\" } } ãƒ»gcplogs æ¨™æº–å‡ºåŠ›ï¼æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚ŒãŸãƒ­ã‚°ã‚’ã€Google Cloud Loggingã®APIã«è»¢é€ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.docker.com/config/containers/logging/gcplogs/ { \"log-driver\": \"gcplogs\", \"log-opts\": { \"gcp-meta-name\": \"example-instance-12345\" } } å„ãƒ™ãƒ³ãƒ€ãƒ¼ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ­ã‚°å‡ºåŠ›å…ˆ ãƒ»Dockerã‚³ãƒ³ãƒ†ãƒŠã®æ¨™æº–å‡ºåŠ›ï¼æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ› Linuxã§ã¯ã€æ¨™æº–å‡ºåŠ›ã¯ã€/proc//fd/1ã€ã€æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã¯ã€/proc//fd/2ã€ã§ã‚ã‚‹ã€‚Dockerã‚³ãƒ³ãƒ†ãƒŠã§ã¯ã€ã€/dev/stdoutã€ãŒã€/proc/self/fd/1ã€ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã€ã¾ãŸã€/dev/stderrã€ãŒã€/proc//fd/2ã€ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã¨ã—ã¦è¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ [root@*****:/dev] ls -la total 4 drwxr-xr-x 5 root root 340 Oct 14 11:36 . drwxr-xr-x 1 root root 4096 Oct 14 11:28 .. lrwxrwxrwx 1 root root 11 Oct 14 11:36 core -> /proc/kcore lrwxrwxrwx 1 root root 13 Oct 14 11:36 fd -> /proc/self/fd crw-rw-rw- 1 root root 1, 7 Oct 14 11:36 full drwxrwxrwt 2 root root 40 Oct 14 11:36 mqueue crw-rw-rw- 1 root root 1, 3 Oct 14 11:36 null lrwxrwxrwx 1 root root 8 Oct 14 11:36 ptmx -> pts/ptmx drwxr-xr-x 2 root root 0 Oct 14 11:36 pts crw-rw-rw- 1 root root 1, 8 Oct 14 11:36 random drwxrwxrwt 2 root root 40 Oct 14 11:36 shm lrwxrwxrwx 1 root root 15 Oct 14 11:36 stderr -> /proc/self/fd/2 # æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ› lrwxrwxrwx 1 root root 15 Oct 14 11:36 stdin -> /proc/self/fd/0 lrwxrwxrwx 1 root root 15 Oct 14 11:36 stdout -> /proc/self/fd/1 # æ¨™æº–å‡ºåŠ› crw-rw-rw- 1 root root 5, 0 Oct 14 11:36 tty crw-rw-rw- 1 root root 1, 9 Oct 14 11:36 urandom crw-rw-rw- 1 root root 1, 5 Oct 14 11:36 zero ãƒ»nginxã‚¤ãƒ¡ãƒ¼ã‚¸ å…¬å¼ã®nginxã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã€/dev/stdoutã¨ã„ã†ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ã€/var/log/nginx/access.logãƒ•ã‚¡ã‚¤ãƒ«ã«ä½œæˆã—ã¦ã„ã‚‹ã€‚ã¾ãŸã€/dev/stderrã¨ã„ã†ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ã€/var/log/nginx/error.logãƒ•ã‚¡ã‚¤ãƒ«ã«ä½œæˆã—ã¦ã„ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã™ã‚‹ãƒ­ã‚°ã®å‡ºåŠ›ã¯ã€/dev/stdoutã¨/dev/stderrã«è»¢é€ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.docker.com/config/containers/logging/ ãƒ»php-fpmã‚¤ãƒ¡ãƒ¼ã‚¸ è¦å‹‰å¼·ã€‚ "},"public/virtualization/virtualization_container_docker_dockerfile.html":{"url":"public/virtualization/virtualization_container_docker_dockerfile.html","title":"ğŸ“– ï¸Dockerfile","keywords":"","body":"Dockerfile ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã™ã‚‹ã¾ã§ã®æ‰‹é † æ‰‹é †ã®æµã‚Œ Docker Hubã‹ã‚‰ã€ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ DockerfileãŒã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‹ã‚‰ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã€‚ ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ä¸Šã«ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç”Ÿæˆã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã€‚ ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ã€åœæ­¢ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã€‚ ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ã€èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã€‚ 02. Dockerfileã®å®Ÿè£… ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç©ã¿é‡ã­ ãƒ»Dockerfileã®ä»•çµ„ã¿ ä»»æ„ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã€æ–°ã—ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä¸Šã«ã€ä»–ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç©ã¿é‡ã­ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã“ã®æ™‚ã€Dockerfileã‚’ç”¨ã„ã¦ã€å„å‘½ä»¤ã«ã‚ˆã£ã¦ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç©ã¿é‡ã­ã¦ã„ãã€‚ ãƒ»Dockerfileã®è¨˜è¿°æ–¹æ³• ä»»æ„ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã€æ–°ã—ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®5ã¤é †ç•ªã§å‘½ä»¤ã‚’ç”¨ã„ã¦ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç©ã¿é‡ã­ã¦ã„ãã€‚å‘½ä»¤ã¯ã€æ…£ä¾‹çš„ã«å¤§æ–‡å­—ã§è¨˜è¿°ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š FROM php:7.4.9-fpm as base RUN apt-get update -y \\ && apt-get install -y \\ git \\ vim \\ unzip \\ zip \\ && docker-php-ext-install \\ bcmath \\ pdo_mysql \\ && apt-get clean COPY --from=composer:1.10.23 /usr/bin/composer /usr/bin/composer #=================== # Development Stage #=================== FROM base as development LABEL mantainer=${LABEL} #=================== # Production Stage #=================== FROM base as production LABEL mantainer=${LABEL} # æœ¬ç•ªç’°å¢ƒã§ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸å†…ã«ã‚³ãƒ”ãƒ¼ã€‚ # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸¸ã”ã¨ã‚³ãƒ³ãƒ†ãƒŠå†…ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹å ´åˆã¯ã€ã€/ã€ã§çµ‚ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ COPY ./ /var/www/foo/ ï¼Šå®Ÿè£…ä¾‹ï¼Š Nginxã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã®Dockerfileã‚’ç¤ºã™ã€‚å‘½ä»¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨˜è¿°å½¢å¼ã«ã¯ã€æ–‡å­—åˆ—å½¢å¼ã€JSONå½¢å¼ãŒã‚ã‚‹ã€‚ã“ã“ã§ã¯ã€JSONå½¢å¼ã§è¨˜è¿°ã™ã‚‹ã€‚ # ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆCentOSï¼‰ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« FROM centos:8 # ubuntuä¸Šã«ã€nginxã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« RUN yum update -y \\ && yum install -y \\ nginx # ãƒ›ã‚¹ãƒˆOSã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠå´ã®æŒ‡å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ COPY infra/docker/web/nginx.conf /etc/nginx/nginx.conf # nginxã‚’ãƒ‡ãƒ¼ãƒ¢ãƒ³èµ·å‹• CMD [\"/usr/sbin/nginx\", \"-g\", \"daemon off;\"] # ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã‚’æ˜ç¤ºã™ã‚‹ã€‚ã“ã‚Œã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã®æ©Ÿèƒ½ã—ã‹ãªã„ã€‚ EXPOSE 80 å‘½ä»¤ å‡¦ç† FROM ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«. RUN ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ä¸Šã«ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«. COPY ãƒ»ãƒ›ã‚¹ãƒˆOSå´ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ†ãƒŠå´ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã‚³ãƒ”ãƒ¼.ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸¸ã”ã¨ã‚³ãƒ³ãƒ†ãƒŠå†…ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹å ´åˆã¯ã€ã€/ã€ã§çµ‚ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãƒ»ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã ã‘ã§ã€ãƒ“ãƒ«ãƒ‰å¾Œã®ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã¯åæ˜ ã•ã‚Œãªã„ã€‚ãƒ»nginx.confãƒ•ã‚¡ã‚¤ãƒ«ã€php.iniãƒ•ã‚¡ã‚¤ãƒ«ã€ãªã©ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ›ã‚¹ãƒˆOSã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã«ã‚³ãƒ”ãƒ¼ã—ãŸã„æ™‚ã«ã‚ˆãä½¿ã†ã€‚ CMD ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚»ã‚¹ã®èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã€‚runã‚³ãƒãƒ³ãƒ‰ã®å¼•æ•°ã¨ã—ã¦ã€ä¸Šæ›¸ãã§ãã‚‹ã€‚ VOLUME ãƒ»Volumeãƒã‚¦ãƒ³ãƒˆã‚’è¡Œã†ã€‚å‚è€ƒï¼šhttps://qiita.com/namutaka/items/f6a574f75f0997a1bb1d EXPOSE ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã™ã‚‹ã€‚ã¾ãŸã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®åˆ©ç”¨è€…ã«ã¨ã£ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚‚ã‚ã‚Šã€ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã«ä½¿ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆã¨ã—ã¦ä¿è¨¼ã™ã‚‹æ©Ÿèƒ½ã‚‚ã‚ã‚‹ã€‚å‚è€ƒï¼šãƒ»https://docs.docker.com/engine/reference/builder/#exposeãƒ»https://www.whitesourcesoftware.com/free-developer-tools/blog/docker-expose-port/ã¾ãŸåŠ ãˆã¦ã€ãƒ—ãƒ­ã‚»ã‚¹è‡ªä½“ãŒå‘½ä»¤ã‚’ãƒªãƒƒã‚¹ãƒ³ã§ãã‚‹ã‚ˆã†ã«ãƒãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãŸã ã—ã€å¤šãã®å ´åˆæ¨™æº–ã§ã“ã‚ŒãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚ï¼ˆä¾‹ï¼šPHP-FPMã§ã¯ã€/usr/local/etc/www.conf.defaultãƒ•ã‚¡ã‚¤ãƒ«ã¨/usr/local/etc/php-fpm.d/www.confãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€listen = 127.0.0.1:9000ã®è¨­å®šãŒã‚ã‚‹ï¼‰ ENTRYPOINT ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚»ã‚¹ã®èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã€‚CMDã¨ã¯ç•°ãªã‚Šã€å¾Œã‹ã‚‰ä¸Šæ›¸ãå®Ÿè¡Œã§ããªã„ã€‚ä½¿ç”¨è€…ã«ã€ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•æ–¹æ³•ã‚’å¼·åˆ¶ã•ã›ãŸã„å ´åˆã«é©ã™ã‚‹ã€‚ ENV OSä¸Šã®ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã§æ‰±ãˆã‚‹å¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚Dockerfileã®å‘½ä»¤ã§ã¯æ‰±ãˆãªã„ã€‚ARGã¨ã®é•ã„ã®ä¾‹ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã€‚ ARG Dockerfikeã®å‘½ä»¤ã§æ‰±ãˆã‚‹å¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚OSä¸Šã®ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã§ã¯æ‰±ãˆãªã„ã€‚ENVã¨ã®é•ã„ã®ä¾‹ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã€‚ ADD ãƒ»ãƒ›ã‚¹ãƒˆOSã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠã®æŒ‡å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ï¼ˆCOPYã¨åŒã˜ï¼‰ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€è§£å‡ã‚‚è¡Œã†ã€‚ãƒ»ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã ã‘ã§ã€ãƒ“ãƒ«ãƒ‰å¾Œã®ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã¯åæ˜ ã•ã‚Œãªã„ã€‚ WORKDIR çµ¶å¯¾ãƒ‘ã‚¹ã«ã‚ˆã‚‹æŒ‡å®šã§ã€ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¤‰æ›´. ãƒ»CMDã®æ±ºã‚æ–¹ Dockerfileã§CMDã‚’æŒ‡å®šã—ãªã„å ´åˆã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ä¸€æ—¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ãŸå¾Œã«ã€ã“ã‚Œã‚’Dockerfileã«æ˜ç¤ºçš„ã«å®Ÿè£…ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 2b2d3dfafee8 xxxxx \"/bin/sh\" 11 seconds ago Up 8 seconds 0.0.0.0:8000->8000/tcp xxxxx é™çš„å‹ä»˜ã‘è¨€èªã§ã¯ãƒ—ãƒ­ã‚»ã‚¹ã®èµ·å‹•æ™‚ã«ã€ä»£ã‚ã‚Šã«ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã—ã¦ã‚‚è‰¯ã„ã€‚ãã®å ´åˆã€binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’é…ç½®ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã—ã‹ã—ã€binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒãªã„ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€ãã®å ´åˆã¯ã€ä¸€ã¤ä¸‹ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ãã“ã«ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã‚ˆã†ã«ã™ã‚‹ã€‚ # /go/bin ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„æ™‚ã¯ã€/go/bin/cmdã«ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ç½®ãã€‚ ERROR: for xxx-container Cannot start service go: OCI runtime create failed: container_linux.go:367: starting container process caused: exec: \"/go/bin\": permission denied: unknown ãƒ»ENTRYPOINTã®æ³¨æ„ç‚¹ ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚»ã‚¹ã®èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ã‚’å¾Œã‹ã‚‰ä¸Šæ›¸ãã§ããªããªã‚‹ãŸã‚ã€runã‚³ãƒãƒ³ãƒ‰ã®å¼•æ•°ã¨ã—ã¦æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ã‚’æ¸¡ã›ãšã«ã€ãƒ‡ãƒãƒƒã‚°ãŒã§ããªã„ã“ã¨ãŒã‚ã‚‹ã€‚ # ä¸Šæ›¸ãã§ããšã€å¤±æ•—ã—ã¦ã—ã¾ã†ã€‚ $ docker run --rm -it /bin/bash ãƒ»ENVã¨ARGã®é•ã„ ä¸€ã¤ç›®ã«ã€ENVãŒä½¿ãˆã¦ã€ARGãŒä½¿ãˆãªã„ä¾‹ã€‚ # ENVã¯ã€OSä¸Šã®ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã§æ‰±ãˆã‚‹å¤‰æ•°ã‚’å®šç¾© ARG PYTHON_VERSION=\"3.8.0\" RUN pyenv install ${PYTHON_VERSION} # ARGã¯ã€OSä¸Šã®ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã§ã¯æ‰±ãˆãªã„ ARG PYTHON_VERSION=\"3.8.0\" RUN pyenv install ${PYTHON_VERSION} # ===> å¤‰æ•°ã‚’å±•é–‹ã§ããªã„ äºŒã¤ç›®ã«ã€ARGãŒä½¿ãˆã¦ã€ENVãŒä½¿ãˆãªã„ä¾‹ã€‚ # ARGã¯,Dockerfikeã®å‘½ä»¤ã§æ‰±ãˆã‚‹å¤‰æ•°ã‚’å®šç¾© ARG OS_VERSION=\"8\" FROM centos:${OS_VERSION} # ENVã¯ã€OSä¸Šã®ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã§ã¯æ‰±ãˆãªã„ ENV OS_VERSION \"8\" FROM centos:${OS_VERSION} # ===> å¤‰æ•°ã‚’å±•é–‹ã§ããªã„ ä¸‰ã¤ç›®ã«ã€ã“ã‚Œã‚‰ã®é•ã„ã«ã‚ˆã‚‹å¯èª­æ€§ã®æ‚ªã•ã®å¯¾ç­–ã¨ã—ã¦ã€ENVã¨ARGã‚’çµ„ã¿åˆã‚ã›ãŸä¾‹ã€‚ # æœ€åˆã«å…¨ã¦ã€ARGã§å®šç¾© ARG CENTOS_VERSION=\"8\" ARG PYTHON_VERSION=\"3.8.0\" # å¤‰æ•°å±•é–‹ã§ãã‚‹ FROM centos:${OS_VERSION} # ARGã‚’äº‹å‰ã«å®£è¨€ ARG PYTHON_VERSION # å¿…è¦ã«å¿œã˜ã¦ã€äº‹å‰ã«ENVã«è©°ã‚æ›¿ãˆã‚‹ã€‚ ENV PYTHON_VERSION ${PYTHON_VERSION} # å¤‰æ•°å±•é–‹ã§ãã‚‹ RUN pyenv install ${PYTHON_VERSION} ãƒ»Docker Hubã«å¯¾ã™ã‚‹ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ æ–¹æ³• ä»•çµ„ã¿ GitHub Actions GitHubãŒã€Docker Hubã«å¯¾ã—ã¦ã€pushã‚’è¡Œã†ã€‚ Circle CI GitHubãŒã€Circle CIã«å¯¾ã—ã¦ã€é€ä¿¡WebHookã‚’è¡Œã†ã€‚ Docker Hub Auto Build GitHubãŒã€Docker Hubã«å¯¾ã—ã¦ã€é€ä¿¡WebHookã‚’è¡Œã†ã€‚ ãƒ»Dockerfileã‚’ç”¨ã„ã‚‹ãƒ¡ãƒªãƒƒãƒˆ Dockerfileã‚’ç”¨ã„ãªã„å ´åˆã€å„ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ‰‹å‹•ã§è¡Œã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã—ã‹ã—ã€Dockerfileã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ã“ã‚Œã‚’è‡ªå‹•åŒ–ã§ãã‚‹ã€‚ ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ‡ãƒãƒƒã‚° ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ãƒ“ãƒ«ãƒ‰ã«å¤±æ•—ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã—ã€æ¥ç¶šã™ã‚‹ã€‚rmã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã€æ¥ç¶šã®åˆ‡æ–­å¾Œã«ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã™ã‚‹ã€‚Dockerfileã«ãŠã„ã¦ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚»ã‚¹ã®èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ã‚’ENTRYPOINTã§è¨­å®šã—ã¦ã„ã‚‹å ´åˆã¯ã€å¾Œã‹ã‚‰ä¸Šæ›¸ãã§ããªããªã‚‹ãŸã‚ã€runã‚³ãƒãƒ³ãƒ‰ã®å¼•æ•°ã¨ã—ã¦æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ã‚’æ¸¡ã›ãšã«ã€ãƒ‡ãƒãƒƒã‚°ãŒã§ããªã„ã“ã¨ãŒã‚ã‚‹ã€‚ $ docker run --rm -it /bin/bash # ã‚³ãƒ³ãƒ†ãƒŠã®ä¸­ root@xxxxxxxxxx: ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ ãƒ»ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã¯ ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä¸Šã«ç©ã¿é‡ã­ã‚‰ã‚Œã‚‹ 02-02. ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒªãƒã‚¸ãƒˆãƒª ãƒ»ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒªãƒã‚¸ãƒˆãƒªã¨ã¯ ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã€å®Ÿè¡ŒOSã«ã‚ˆã‚‰ãšã«ä¸€è²«ã—ã¦ãƒ“ãƒ«ãƒ‰ã§ãã‚‹ãŸã‚ã€é…å¸ƒã§ãã‚‹ã€‚å„ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒªãƒã‚¸ãƒˆãƒªï¼ˆDockerHubã€ECRã€ãªã©ï¼‰ã«ã¯ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ä¸Šã§ã®ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚ ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ ãƒ»ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ç¨®é¡ ã‚¤ãƒ¡ãƒ¼ã‚¸ ç‰¹å¾´ ç›¸æ€§ã®è‰¯ã„ã‚·ã‚¹ãƒ†ãƒ ä¾‹ scratch ä»¥ä¸‹ã®é€šã‚Šã€ä½•ã‚‚æŒã£ã¦ã„ãªã„ãƒ»OSï¼šç„¡ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼šç„¡ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ï¼šç„¡ ï¼Ÿ BusyBox ãƒ»OSï¼šLinuxï¼ˆâ€»ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãªã„ï¼‰ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼šåŸºæœ¬ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ï¼šç„¡ çµ„ã¿è¾¼ã¿ã‚·ã‚¹ãƒ†ãƒ  Alpine Linux ãƒ»OSï¼šLinuxï¼ˆâ€»ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãªã„ï¼‰ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼šåŸºæœ¬ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ï¼šApk ï¼Ÿ ãƒ»å¯¾å¿œå¯èƒ½ãªCPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç¨®é¡ Dockerã¯å…¨ã¦ã®PCã§ç¨¼åƒã§ãã‚‹ã‚ã‘ã§ã¯ãªãã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã”ã¨ã«å¯¾å¿œå¯èƒ½ãªCPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆAMDç³»ã€ARMç³»ã€ãªã©ï¼‰ãŒã‚ã‚‹ã€‚åŒã˜OSã§ã‚‚ã€æ©Ÿç¨®ã”ã¨ã«æ­è¼‰ã•ã‚Œã‚‹CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ç•°ãªã‚‹ã€‚ä¾‹ãˆã°ã€MacBook 2020 ã«ã¯Intelã€ã¾ãŸMacBook 2021ï¼ˆM1 Macï¼‰ã«ã¯ARMãƒ™ãƒ¼ã‚¹ã®ç‹¬è‡ªCPUãŒæ­è¼‰ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ARMã«å¯¾å¿œã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’é¸ã¶å¿…è¦ãŒã‚ã‚‹ã€‚ãŸã ã—ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒOSã®CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’é–‹ç™ºè€…ãŒæ°—ã«ã™ã‚‹å¿…è¦ã¯ãªãã€docker pullæ™‚ã«ã€OSã®CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å¯¾å¿œã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ãŒè‡ªå‹•çš„ã«é¸æŠã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/docker-library/official-images#architectures-other-than-amd64 ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¯ç¨®é¡ãŒã‚ã‚Šã€è¿½è·¡ã§ãã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ãŒç•°ãªã‚‹ã€‚ã“ã“ã§ã¯ã€composerã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä¾‹ã«æŒ™ã’ã‚‹ã€‚ å‚è€ƒï¼šhttps://hub.docker.com/_/composer/?tab=description&page=1&ordering=last_updated composerãƒãƒ¼ã‚¸ãƒ§ãƒ³ è¿½è·¡ã§ãã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ— 2.0.9 ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç›´æŒ‡å®šã—ã€è¿½è·¡ã—ãªã„ã€‚ 2.0 ã€2.0.Xã€ã®ãƒã‚¤ãƒŠãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®ã¿ã‚’è¿½è·¡ã™ã‚‹ã€‚ 2 ã€2.Xã€ã¨ã€2.0.Xã€ã®ãƒã‚¤ãƒŠãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®ã¿ã‚’è¿½è·¡ã™ã‚‹ã€‚ latest ãƒ¡ã‚¸ãƒ£ãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¨ãƒã‚¤ãƒŠãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’è¿½è·¡ã™ã‚‹ã€‚ 03-02 ã‚¤ãƒ¡ãƒ¼ã‚¸ã®è»½é‡åŒ– ãƒ—ãƒ­ã‚»ã‚¹å˜ä½ã«ã‚ˆã‚‹Dockerfileã®åˆ†å‰² ã“ã‚Œã¯ã€Dockerã®åŸå‰‡ã§ã‚ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¨¼åƒã•ã›ã‚‹ã«ã¯ã€æœ€ä½é™ã€Webã‚µãƒ¼ãƒãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€DBMSãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã“ã‚Œã‚‰ã‚’ã€å€‹åˆ¥ã®ã‚³ãƒ³ãƒ†ãƒŠã§ç¨¼åƒã•ã›ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§æ¥ç¶šã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ Unixãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ®‹ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š FROM centos:8 RUN dnf upgrade -y \\ && dnf install -y \\ curl \\ # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ && dnf clean all \\ # ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤ && rm -rf /var/cache/dnf RUNã‚³ãƒãƒ³ãƒ‰ã‚’ã¾ã¨ã‚ã‚‹ Dockerfileã®å„å‘½ä»¤ã«ã‚ˆã£ã¦ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒä¸€ã¤å¢—ãˆã¦ã—ã¾ã†ãŸã‚ã€åŒã˜å‘½ä»¤ã«ç•°ãªã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¸ãˆã‚‹æ™‚ã¯ã€ã“ã‚Œã‚’ä¸€ã¤ã«ã¾ã¨ã‚ã¦ã—ã¾ã†æ–¹ãŒè‰¯ã„ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ™‚ã€ # ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ä¸Šã«ã€è¤‡æ•°ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« RUN yum -y isntall httpd RUN yum -y install php RUN yum -y install php-mbstring RUN yum -y install php-pear ã“ã‚Œã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ä¸€è¡Œã§ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå°‘ãªããªã‚Šã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’è»½é‡åŒ–ã§ãã‚‹ã€‚ # ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ä¸Šã«ã€è¤‡æ•°ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« RUN yum -y install httpd php php-mbstring php-pear ã•ã‚‰ã«ã€ã“ã‚Œã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚‚æ›¸ãã“ã¨ãŒã§ãã‚‹ã€‚ # ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ä¸Šã«ã€è¤‡æ•°ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« RUN yum -y install \\ httpd \\ php \\ php-mbstring \\ php-pear ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ ãƒ»ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ã¨ã¯ ä¸€ã¤ã®Dockerfileå†…ã«è¤‡æ•°ã®ç‹¬ç«‹ã—ãŸã‚¹ãƒ†ãƒ¼ã‚¸ã‚’å®šç¾©ã™ã‚‹æ–¹æ³•ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§ä½œæˆã™ã‚‹ã€‚ ã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ã«æˆåŠŸã™ã‚‹Dockerfileã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ãŒã©ã“ã«é…ç½®ã•ã‚Œã‚‹ã‹ã‚’å ´æ‰€ã‚’èª¿ã¹ã‚‹ã€‚ Dockerfileã§ã€äºŒã¤ç›®ã®FROMã‚’å®£è¨€ã™ã‚‹ã€‚ ä¸€ã¤ç›®ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã§ã€ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã ã‘ã§çµ‚ã‚ã‚‰ã›ã‚‹ã€‚ äºŒã¤ç›®ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã§ã€Unixãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ã¾ãŸã€ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€ã¤ç›®ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚ ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†åˆ©ç”¨ ï¼Šå®Ÿè£…ä¾‹ï¼Š # ä¸­é–“ã‚¤ãƒ¡ãƒ¼ã‚¸ FROM golang:1.7.3 AS builder WORKDIR /go/src/github.com/alexellis/href-counter/ RUN go get -d -v golang.org/x/net/html COPY app.go . RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o app . # æœ€çµ‚ã‚¤ãƒ¡ãƒ¼ã‚¸ FROM alpine:latest RUN apk --no-cache add ca-certificates WORKDIR /root/ COPY --from=builder /go/src/github.com/alexellis/href-counter/app . CMD [\"./app\"] ãƒ»å®Ÿè¡Œç’°å¢ƒåˆ¥ã«ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’åˆ†ã‘ã‚‹ ï¼Šå®Ÿè£…ä¾‹ï¼Š #=================== # Global ARG #=================== ARG NGINX_VERSION=\"1.19\" ARG LABEL=\"Hiroki \" #=================== # Build Stage #=================== FROM nginx:${NGINX_VERSION} as build RUN apt-get update -y \\ && apt-get install -y \\ curl \\ vim \\ # ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤ && apt-get clean #=================== # Develop Stage #=================== FROM build as develop LABEL mantainer=${LABEL} COPY ./infra/docker/www/develop.nginx.conf /etc/nginx/nginx.conf CMD [\"/usr/sbin/nginx\", \"-g\", \"daemon off;\"] #=================== # Production Stage #=================== FROM build as production LABEL mantainer=${LABEL} COPY ./infra/docker/www/production.nginx.conf /etc/nginx/nginx.conf CMD [\"/usr/sbin/nginx\", \"-g\", \"daemon off;\"] å¯èƒ½ãªé™ã‚ŠOSã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãªã„ ãƒ»OSã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸå ´åˆï¼ˆæ‚ªã„ä¾‹ï¼‰ OSãƒ™ãƒ³ãƒ€ãƒ¼ãŒæä¾›ã™ã‚‹ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã¨ã€ä¸è¦ãªãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ã—ã¾ã†ã€‚åŸå‰‡ã¨ã—ã¦ã€ä¸€ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã§ä¸€ã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã—ã‹å®Ÿè¡Œã›ãšã€OSå…¨ä½“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ä¸è¦ãªãŸã‚ã€OSã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š # CentOSã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« FROM centos:8 # PHPã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã«ã€EPELã¨Remiãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦æœ‰åŠ¹åŒ–ã€‚ RUN dnf upgrade -y \\ && dnf install -y \\ https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm \\ https://rpms.remirepo.net/enterprise/remi-release-8.rpm \\ && dnf module enable php:remi-${PHP_VERSION} \\ # ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®è¦ä»¶ã®PHPæ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« && dnf install -y \\ php \\ php-bcmath \\ php-ctype \\ php-fileinfo \\ php-json \\ php-mbstring \\ php-openssl \\ php-pdo \\ php-tokenizer \\ php-xml \\ && dnf clean all \\ && rm -Rf /var/cache/dnf # DockerHubã®Composerã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾— COPY --from=composer /usr/bin/composer /usr/bin/composer ï¼Šå®Ÿè£…ä¾‹ï¼Š # CentOSã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« FROM centos:8 # nginxã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« RUN dnf upgrade -y \\ ã€€ã€€&& dnf install -y \\ ã€€ã€€ nginx \\ ã€€ã€€ curl \\ ã€€ã€€&& dnf clean all \\ ã€€ã€€&& rm -Rf /var/cache/dnf COPY infra/docker/web/nginx.conf /etc/nginx/nginx.conf CMD [\"/usr/sbin/nginx\", \"-g\", \"daemon off;\"] EXPOSE 80 ãƒ»ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸå ´åˆï¼ˆè‰¯ã„ä¾‹ï¼‰ ä»£ã‚ã‚Šã«ã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒ™ãƒ³ãƒ€ãƒ¼ãŒæä¾›ã™ã‚‹ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š # Nginxã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« FROM nginx:1.19 # Nginxã‚¤ãƒ¡ãƒ¼ã‚¸ãŒUbuntuãƒ™ãƒ¼ã‚¹ãªãŸã‚ã«apt-getã‚³ãƒãƒ³ãƒ‰ RUN apt-get updatedocke -y \\ && apt-get install -y \\ curl \\ && apt-get clean COPY ./infra/docker/www/production.nginx.conf /etc/nginx/nginx.conf ãƒ»è¨€èªã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸå ´åˆ ä»£ã‚ã‚Šã«ã€è¨€èªãƒ™ãƒ³ãƒ€ãƒ¼ãŒæä¾›ã™ã‚‹ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ # ã“ã“ã«å®Ÿè£…ä¾‹ ãƒ»alpineã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸå ´åˆ # ã“ã“ã«å®Ÿè£…ä¾‹ 04. ãƒ›ã‚¹ãƒˆã¨ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒã‚¦ãƒ³ãƒˆ Bindãƒã‚¦ãƒ³ãƒˆ ãƒ»Bindãƒã‚¦ãƒ³ãƒˆã¨ã¯ ãƒ›ã‚¹ãƒˆOSã®/Usersãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚³ãƒ³ãƒ†ãƒŠå´ã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹æ–¹æ³•ã€‚ãƒ›ã‚¹ãƒˆOSã§ä½œæˆã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ãŒç¶™ç¶šçš„ã«å¤‰åŒ–ã™ã‚‹å ´åˆã«é©ã—ã¦ãŠã‚Šã€ä¾‹ãˆã°ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ›ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒŠé–“ã¨å…±æœ‰ã™ã‚‹æ–¹æ³•ã¨ã—ã¦æ¨å¥¨ã§ã‚ã‚‹ã€‚ã—ã‹ã—ã€ãƒ›ã‚¹ãƒˆOSã®ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ–ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã¯ä¸é©ã§ã‚ã‚‹ã€‚ã¾ãŸã€Dockerfileã¾ãŸã¯docker-composeãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ãŒã€å¾Œè€…ãŒæ¨å¥¨ã§ã‚ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š # ãƒ›ã‚¹ãƒˆOSã‚’ã‚³ãƒ³ãƒ†ãƒŠå´ã«bindãƒã‚¦ãƒ³ãƒˆ $ docker run -d -it --name /bin/bash \\ --mount type=bind, src=home/projects/, dst=/var/www/ ãƒ»ãƒã‚¦ãƒ³ãƒˆå…ƒã¨ã—ã¦æŒ‡å®šã§ãã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ä»¥ä¸‹ã®é€šã‚Šã€ãƒ›ã‚¹ãƒˆOSã®ãƒã‚¦ãƒ³ãƒˆå…ƒã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã„ãã¤ã‹é¸æŠè‚¢ãŒã‚ã‚‹ã€‚ ãƒ»æœ¬ç•ªç’°å¢ƒã§ã¯Bindãƒã‚¦ãƒ³ãƒˆã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¨¼åƒã•ã›ã‚‹ãª ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿è¨€èªã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ç¨¼åƒã•ã›ã‚‹å ´åˆã€é–‹ç™ºç’°å¢ƒã§ã‚ã‚Œã°Bindãƒã‚¦ãƒ³ãƒˆã§ãƒ›ã‚¹ãƒˆå´ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ³ãƒ†ãƒŠã«å…±æœ‰ã™ã‚Œã°ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ç¨¼åƒã§ãã‚‹ã€‚ã—ã‹ã—ã€æœ¬ç•ªç’°å¢ƒã§ã¯ã€Bindãƒã‚¦ãƒ³ãƒˆãŒæ©Ÿèƒ½ã—ãªã„ãŸã‚ã€ä½¿ç”¨ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿è¾¼ã‚“ã§ãŠãã€‚æ–¹æ³•ã¨ã—ã¦ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ã€ãƒ›ã‚¹ãƒˆã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸å´ã«COPYã—ã¦ãŠãã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æœ¬ç•ªç’°å¢ƒã§ã¯ã“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«ã—ã•ãˆã™ã‚Œã°ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼š https://docs.docker.com/develop/dev-best-practices/#differences-in-development-and-production-environments https://www.reddit.com/r/docker/comments/m4dk8g/in_production_wouldnt_bind_mount_be_better/ https://www.nyamucoro.com/entry/2018/03/15/200412 https://blog.fagai.net/2018/02/22/docker%E3%81%AE%E7%90%86%E8%A7%A3%E3%82%92%E3%81%84%E3%81%8F%E3%82%89%E3%81%8B%E5%8B%98%E9%81%95%E3%81%84%E3%81%97%E3%81%A6%E3%81%84%E3%81%9F%E8%A9%B1/ Volumeãƒã‚¦ãƒ³ãƒˆ ãƒ»Volumeï¼ˆData Volumeï¼‰ã€Dockerã‚¨ãƒªã‚¢ã¨ã¯ ãƒ›ã‚¹ãƒˆOSã®Dockerã‚¨ãƒªã‚¢ï¼ˆ/var/lib/docker/volumesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã«ä¿å­˜ã•ã‚Œã‚‹æ°¸ç¶šãƒ‡ãƒ¼ã‚¿ã®ã“ã¨ã€‚Data Volumeã¨ã‚‚ã„ã†ã€‚Volumeã¸ã®ãƒ‘ã‚¹ï¼ˆ/var/lib/docker/volumes//_dataï¼‰ã¯ã€ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã¨ã„ã†ã€‚ ãƒ»Volumeãƒã‚¦ãƒ³ãƒˆã¨ã¯ ãƒ›ã‚¹ãƒˆOSã«ã‚ã‚‹Dockerã‚¨ãƒªã‚¢ã®ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã‚’ã‚³ãƒ³ãƒ†ãƒŠå´ã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹æ–¹æ³•ã€‚ãƒ›ã‚¹ãƒˆOSã§ä½œæˆã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã£ãŸã«å¤‰æ›´ã—ãªã„å ´åˆã«é©ã—ã¦ãŠã‚Šã€ä¾‹ãˆã°DBã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ›ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒŠé–“ã¨å…±æœ‰ã™ã‚‹æ–¹æ³•ã¨ã—ã¦æ¨å¥¨ã§ã‚ã‚‹ã€‚ã—ã‹ã—ã€ä¾‹ãˆã°ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã„ã£ãŸã‚ˆã†ãªå¤‰æ›´ã•ã‚Œã‚„ã™ã„ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã¯ä¸é©ã§ã‚ã‚‹ã€‚ ãƒ»Data Volumeã‚³ãƒ³ãƒ†ãƒŠã«ã‚ˆã‚‹æ°¸ç¶šåŒ–ãƒ‡ãƒ¼ã‚¿ã®æä¾› Volumeã‚’ç”¨ã„ã‚‹å ´åˆã®ã‚³ãƒ³ãƒ†ãƒŠé…ç½®æ‰‹æ³•ã®ä¸€ã¤ã€‚Dockerã‚¨ãƒªã‚¢ã®Volumeã‚’Data Volumeã‚’ã‚³ãƒ³ãƒ†ãƒŠ ï¼ˆData Volumeã‚³ãƒ³ãƒ†ãƒŠï¼‰ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒã‚¦ãƒ³ãƒˆã—ã¦ãŠãã€‚Volumeã‚’ç”¨ã„ã‚‹æ™‚ã¯ã€Dockerã‚¨ãƒªã‚¢ã‚’å‚ç…§ã™ã‚‹ã®ã§ã¯ãªãã€Data Volumeã‚³ãƒ³ãƒ†ãƒŠã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ 05. ãƒ›ã‚¹ãƒˆã¨ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶š bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ãƒ»bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã¯ è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠé–“ã«å¯¾ã—ã¦ã€ä»®æƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§æ¥ç¶šã•ã›ã‚‹ã€‚ã¾ãŸã€ä»®æƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç‰©ç†ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é–“ã‚’ã€ä»®æƒ³ãƒ–ãƒªãƒƒã‚¸ã‚’ç”¨ã„ã¦bridgeæ¥ç¶šã™ã‚‹ã€‚ã»ã¨ã‚“ã©ã®å ´åˆã€ã“ã®æ–¹æ³•ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://www.itmedia.co.jp/enterprise/articles/1609/21/news001.html ç‰©ç†ã‚µãƒ¼ãƒã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚³ãƒ³ãƒ†ãƒŠã«å±Šãã¾ã§ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ç‰©ç†ã‚µãƒ¼ãƒã®8080ç•ªãƒãƒ¼ãƒˆã¨ã€WWWã‚³ãƒ³ãƒ†ãƒŠã®80ç•ªãƒãƒ¼ãƒˆã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é–“ã§ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¡Œã†ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã€http://:8080ã€ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã¨ã€WWWã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆç•ªå·ã«è»¢é€ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‡¦ç†å ´æ‰€ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æµã‚Œ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ä¾‹ ãƒãƒ¼ãƒˆç•ªå·ä¾‹ ã‚³ãƒ³ãƒ†ãƒŠå†…ãƒ—ãƒ­ã‚»ã‚¹ ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ãƒãƒ¼ãƒˆ :80 â†‘ ã‚³ãƒ³ãƒ†ãƒŠ ã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆ ãƒ»http://127.0.0.1ãƒ»http:// :80 â†‘ ãƒ›ã‚¹ãƒˆOS ä»®æƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ http://172.XX.XX.XX â†‘ ãƒ›ã‚¹ãƒˆOS ä»®æƒ³ãƒ–ãƒªãƒƒã‚¸ â†‘ ãƒ›ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ ç‰©ç†ã‚µãƒ¼ãƒã®NICï¼ˆ Ethernetã‚«ãƒ¼ãƒ‰ï¼‰ http://127.0.0.1 :8080 noneãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ãƒ»noneãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã¯ ç‰¹å®šã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ã€ãƒ›ã‚¹ãƒˆOSã‚„ä»–ã®ã‚³ãƒ³ãƒ†ãƒŠã¨ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã•ã›ãªã„ã€‚ $ docker network list NETWORK ID NAME DRIVER SCOPE 7edf2be856d7 none null local hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ãƒ»hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã¯ ç‰¹å®šã®ã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ã€ãƒ›ã‚¹ãƒˆOSã¨åŒã˜ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æƒ…å ±ã‚’ã‚‚ãŸã›ã‚‹ã€‚ $ docker network list NETWORK ID NAME DRIVER SCOPE ac017dda93d6 host host local ã‚³ãƒ³ãƒ†ãƒŠé–“ã®æ¥ç¶šæ–¹æ³• ãƒ»ã€ãƒ›ã‚¹ãƒˆOSã€ã‹ã‚‰ã€ãƒ›ã‚¹ãƒˆOSï¼ˆlocalhostï¼‰ã€ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ã€ãƒ›ã‚¹ãƒˆOSã€ã‹ã‚‰ã€ãƒ›ã‚¹ãƒˆOSã€ã«å¯¾ã—ã¦ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã“ã§ã®ãƒ›ã‚¹ãƒˆOSã®ãƒ›ã‚¹ãƒˆåã¯ã€ã€localhostã€ã¨ãªã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠã«è»¢é€ã•ã‚Œã‚‹ã€‚ãƒ›ã‚¹ãƒˆOSã¨ã‚³ãƒ³ãƒ†ãƒŠã®é–“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®æˆå¦ã‚’ç¢ºèªã§ãã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ã€ãƒ›ã‚¹ãƒˆOSã€ã‹ã‚‰ã€ãƒ›ã‚¹ãƒˆOSã€ã«å¯¾ã—ã¦ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ›ã‚¹ãƒˆOSã¨appã‚³ãƒ³ãƒ†ãƒŠã®é–“ã®æˆå¦ã‚’ç¢ºèªã™ã‚‹ã€‚ # ãƒ›ã‚¹ãƒˆOSã§å®Ÿè¡Œ $ curl --fail http://localhost:8080/ ãƒ»ã€ã‚³ãƒ³ãƒ†ãƒŠã€ã‹ã‚‰ã€ã‚³ãƒ³ãƒ†ãƒŠã€ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ã€ã‚³ãƒ³ãƒ†ãƒŠã€ã‹ã‚‰ã€ã‚³ãƒ³ãƒ†ãƒŠã€ã«å¯¾ã—ã¦ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã“ã§ã®ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ›ã‚¹ãƒˆåã¯ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã®ã€/etc/hostsã€ã«å®šç¾©ã•ã‚ŒãŸã‚‚ã®ã¨ãªã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ãƒ›ã‚¹ãƒˆOSã‚’çµŒç”±ã›ãšã€ãã®ã¾ã¾ã‚³ãƒ³ãƒ†ãƒŠã«é€ä¿¡ã•ã‚Œã‚‹ã€‚ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®æˆå¦ã‚’ç¢ºèªã§ãã‚‹ã€‚ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ›ã‚¹ãƒˆåã®å®šç¾©æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/virtualization/virtualization_container_orchestration.html ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š ã€appã‚³ãƒ³ãƒ†ãƒŠã€ã‹ã‚‰ã€nginxã‚³ãƒ³ãƒ†ãƒŠã€ã«å¯¾ã—ã¦ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€appã‚³ãƒ³ãƒ†ãƒŠã¨nginxã‚³ãƒ³ãƒ†ãƒŠã®é–“ã®æˆå¦ã‚’ç¢ºèªã™ã‚‹ã€‚ # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ $ curl --fail http://:80/ ãƒ»ã€ã‚³ãƒ³ãƒ†ãƒŠã€ã‹ã‚‰ã€ãƒ›ã‚¹ãƒˆOSï¼ˆhost.docker.internalï¼‰ã€ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ ã€ã‚³ãƒ³ãƒ†ãƒŠã€ã‹ã‚‰ã€ãƒ›ã‚¹ãƒˆOSã€ã«å¯¾ã—ã¦ã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ã“ã“ã§ã®ãƒ›ã‚¹ãƒˆOSã®ãƒ›ã‚¹ãƒˆåã¯ã€ã€host.docker.internalã€ã«ãªã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ãƒ›ã‚¹ãƒˆOSã‚’çµŒç”±ã—ã¦ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠã«è»¢é€ã•ã‚Œã‚‹ã€‚ãƒ›ã‚¹ãƒˆOSã¨ã‚³ãƒ³ãƒ†ãƒŠã®é–“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®æˆå¦ã‚’ç¢ºèªã§ãã‚‹ã€‚ # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ $ curl --fail http://host.docker.internal:8080/ "},"public/virtualization/virtualization_container_orchestration.html":{"url":"public/virtualization/virtualization_container_orchestration.html","title":"ğŸ“– ï¸ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³","keywords":"","body":"ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡ å˜ä¸€ãƒ›ã‚¹ãƒˆOSä¸Šã®ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ å˜ä¸€ãƒ›ã‚¹ãƒˆOSä¸Šã®ã‚³ãƒ³ãƒ†ãƒŠãŒå¯¾è±¡ã§ã‚ã‚‹ã€‚ç•°ãªã‚‹Dockerfileã«åŸºã¥ã„ã¦ã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã€ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç”Ÿæˆã€ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹ç¯‰ã€ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ã€ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ ãƒ„ãƒ¼ãƒ«å ãƒ™ãƒ³ãƒ€ãƒ¼ Docker Compose Docker ECSï¼šElastic Container Service Amazon è¤‡æ•°ãƒ›ã‚¹ãƒˆOSã«æ¸¡ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ è¤‡æ•°ãƒ›ã‚¹ãƒˆOSä¸Šã®ã‚³ãƒ³ãƒ†ãƒŠãŒå¯¾è±¡ã§ã‚ã‚‹ã€‚ã©ã®ãƒ›ã‚¹ãƒˆOSã®Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã«å¯¾ã—ã¦ã€ã©ã®ã‚³ãƒ³ãƒ†ãƒŠã«é–¢ã™ã‚‹æ“ä½œã‚’è¡Œã†ã®ã‹ã‚’é¸æŠçš„ã«å‘½ä»¤ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://www.techrepublic.com/article/simplifying-the-mystery-when-to-use-docker-docker-compose-and-kubernetes/ ãƒ„ãƒ¼ãƒ«å ãƒ™ãƒ³ãƒ€ãƒ¼ Docker Swarm Docker Kubernetes Google EKSï¼šElastic Kubernetes Service Amazon 02. ã‚³ãƒ³ãƒ†ãƒŠãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ»ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã‚’è£œåŠ©ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦ã€åŒã˜ECSã‚¿ã‚¹ã‚¯ã‚„Podå†…ã«é…ç½®ã™ã‚‹ã€‚ ãƒ»ãƒ­ã‚®ãƒ³ã‚°ã‚³ãƒ³ãƒ†ãƒŠã®é…ç½® FluentBitã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦ç¨¼åƒã•ã›ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒ­ã‚°ã‚’ä»–ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability_fluentbit.html ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ã‚³ãƒ³ãƒ†ãƒŠã®é…ç½® Datadogã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦ç¨¼åƒã•ã›ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability_datadog_metrics.html ã‚¢ãƒ³ãƒã‚µãƒ€ãƒ¼ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ "},"public/virtualization/virtualization_container_orchestration_docker_compose_command.html":{"url":"public/virtualization/virtualization_container_orchestration_docker_compose_command.html","title":"ğŸ“– ï¸docker-composeã‚³ãƒãƒ³ãƒ‰","keywords":"","body":"docker-composeã‚³ãƒãƒ³ãƒ‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚³ãƒãƒ³ãƒ‰ config ãƒ»configã¨ã¯ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã€docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã‚’å±•é–‹ã™ã‚‹ã€‚ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ã‚„å¤‰æ•°ã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€ã“ã‚Œã‚‰ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã§ãã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— $ docker-compose config build ãƒ»buildã¨ã¯ ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã€‚ ãƒ»--no-cache ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã›ãšã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã€‚ $ docker-compose build --no-cache up ãƒ»upã¨ã¯ æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã€ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ç”Ÿæˆã€ã‚³ãƒ³ãƒ†ãƒŠæ§‹ç¯‰ã€ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ã‚’è¡Œã†ã€‚ã‚³ãƒ³ãƒ†ãƒŠæ§‹ç¯‰ã¾ã§ãŒå®Œäº†ã—ã¦ã„ã¦åœæ­¢ä¸­ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ã“ã‚Œã‚’ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ã€‚ã¾ãŸèµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠãŒã‚ã‚Œã°ã€ã“ã‚Œã‚’å†èµ·å‹•ã™ã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šèµ·å‹•ãƒ¢ãƒ¼ãƒ‰ãŒç•°ãªã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã€ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ç”Ÿæˆã€ã‚³ãƒ³ãƒ†ãƒŠæ§‹ç¯‰ã€ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ã‚’è¡Œã†ã€‚ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ã€‚ # ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ $ docker-compose up ãƒ»-d æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã€ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¤ãƒ¤ãƒ¼ç”Ÿæˆã€ã‚³ãƒ³ãƒ†ãƒŠæ§‹ç¯‰ã€ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ã‚’è¡Œã†ã€‚ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ã€‚ # ãƒ‡ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ $ docker-compose up -d ãƒ»--build ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ $ docker-compose up --build -d run ãƒ»runã¨ã¯ ã™ã§ã«åœæ­¢ä¸­ã¾ãŸã¯èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠãŒå­˜åœ¨ã—ã¦ã„ã¦ã‚‚ã€ã“ã‚Œã¨ã¯åˆ¥ã«ã‚³ãƒ³ãƒ†ãƒŠã‚’æ–°ã—ãæ§‹ç¯‰ã—ã€èµ·å‹•ã™ã‚‹ã€‚ã•ã‚‰ã«ãã®ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚èµ·å‹•æ™‚ã«bashãƒ—ãƒ­ã‚»ã‚¹ã‚„bashãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã§ãã‚‹ã€‚ä½•ã‚‚æ¸¡ã•ãªã„å ´åˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦bashãƒ—ãƒ­ã‚»ã‚¹ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚runã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã¨ãƒ‡ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã‚’é¸ã¶ã“ã¨ãŒã§ãã‚‹ã€‚æ–°ã—ãèµ·å‹•ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢å¾Œã«è‡ªå‹•å‰Šé™¤ã™ã‚‹å ´åˆã¯ã€rmã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚service-portsã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ãªã„ã¨ã€ãƒ›ã‚¹ãƒˆOSã¨ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æœ‰åŠ¹åŒ–ã§ããªã„ãŸã‚æ³¨æ„ã™ã‚‹ã€‚ ãƒ»--service-ports æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒŠã‚’æ®‹ã—ã¦ã€æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®æ–°ã—ã„ã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã™ã‚‹ã€‚ã¾ãŸã€ãƒ›ã‚¹ãƒˆOSã¨ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ # ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ $ docker-compose run --rm --service-ports ãƒ»-d --service-ports æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒŠã‚’æ®‹ã—ã¦ã€æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®æ–°ã—ã„ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ‡ã‚¿ãƒƒãƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã™ã‚‹ã€‚ã¾ãŸã€ãƒ›ã‚¹ãƒˆOSã¨ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ # ãƒ‡ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ $ docker-compose run --rm -d --service-ports stop ãƒ»stopã¨ã¯ æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•ä¸­ã‚³ãƒ³ãƒ†ãƒŠã‚’å…¨ã¦åœæ­¢ã™ã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— $ docker-compose stop down ãƒ»downã¨ã¯ æŒ‡å®šã—ãŸãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã€‚ ãƒ»--rmi --volumes --remove-orphans å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã‚³ãƒ³ãƒ†ãƒŠã€ãƒœãƒªãƒ¥ãƒ¼ãƒ ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ docker-compose down --rmi all --volumes --remove-orphans logs ãƒ»logsã¨ã¯ ã‚³ãƒ³ãƒ†ãƒŠå†…ã«å…¥ã‚‹ã“ã¨ãªãã€èµ·å‹•ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ãã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ docker-compose logs ãƒ»-f ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ docker-compose logs -f "},"public/virtualization/virtualization_container_orchestration_docker_compose_yml.html":{"url":"public/virtualization/virtualization_container_orchestration_docker_compose_yml.html","title":"ğŸ“– ï¸docker-compose.yml","keywords":"","body":"docker-compose.yml 01. services servicesã¨ã¯ ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ä¸€ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’å®šç¾©ã™ã‚‹ã€‚ã‚³ãƒ³ãƒ†ãƒŠåã¨ç•°ãªã‚Šã€ã‚µãƒ¼ãƒ“ã‚¹åã¯ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨é‡è¤‡ã—ã¦ã‚‚ã‚ˆã„ã€‚docker-composeã‚³ãƒãƒ³ãƒ‰ã®å¼•æ•°ã¨ã—ã¦æŒ‡å®šã™ã‚‹ãŸã‚ã€ã§ãã‚‹ã ã‘ç°¡æ½”ã«ã™ã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä¸€è¦§ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.docker.jp/compose/compose-file.html args Dockerfileã®ARGSã«å±•é–‹ã™ã‚‹å¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚Dockerfileã«ç›´æ¥å®Ÿè£…ã™ã‚‹ã“ã¨ã¨ã®ä½¿ã„åˆ†ã‘ã¨ã—ã¦ã€Dockerfileã®å®Ÿè£…ã¯ç°¡å˜ã«å¤‰æ›´ã§ããªã„ãŒã€docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã«ãŠã‘ã‚‹å®šç¾©ã¯å¤‰æ›´ã—ã‚„ã™ã„ã€‚ãã®ãŸã‚ã€ä½¿ç”¨è€…ã«å¤‰æ›´ã—ã¦æ¬²ã—ããªã„å¤‰æ•°ã¯Dockerfileã«å®Ÿè£…ã—ã€å¤‰æ›´ã—ã¦ã‚‚å•é¡Œãªã„å¤‰æ•°ã¯ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã€‚ä»–ã«ã€ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ã‚’ç”¨ã„ã¦ãŠã‚Šã€å…¨ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã§å…±é€šã—ãŸå¤‰æ•°ã‚’å±•é–‹ã—ãŸã„å ´åˆã€ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã¨å±•é–‹ã™ã‚‹å¤‰æ•°ã‚’å…±é€šåŒ–ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: build: - PARAM=$PARAM ARG PARAM ENV PARAM=${PARAM} ï¼Šå®Ÿè£…ä¾‹ï¼Š # ã“ã“ã«å®Ÿè£…ä¾‹ build ãƒ»dockerfile Dockerfileã¾ã§ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: build: dockerfile: ./docker/app/Dockerfile ãƒ»context æŒ‡å®šã—ãŸDockerfileã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã—ã¦ã€Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ï¼ˆDockerã‚¨ãƒ³ã‚¸ãƒ³ï¼‰ã«é€ä¿¡ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: build: context: . ãƒ»target ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¸åã€‚ä¸»ã«ã€ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ã®æ™‚ã«ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: build: target: develop command ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•æ™‚ã«æœ€åˆã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚Dockerfileã‚’å¿…è¦ã¨ã›ãšã€ãƒ™ãƒ³ãƒ€ãƒ¼ãŒæä¾›ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãã®ã¾ã¾ç”¨ã„ã‚‹ã‚ˆã†ãªå ´åˆã«å½¹ç«‹ã¤ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š mysqlã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã™ã‚‹ã¨ãã«ã€æœ€åˆã«æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ services: db: command: mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci container_name ã‚³ãƒ³ãƒ†ãƒŠåã‚’å‘½åã™ã‚‹ã€‚ã‚µãƒ¼ãƒ“ã‚¹åã¨ã¯ç•°ãªã‚Šã€ã‚³ãƒ³ãƒ†ãƒŠåã¯ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨é‡è¤‡ã—ãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ã¤ã‘ã‚‹ã¨ã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: web: container_name: foo-nginx depends_on ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã™ã‚‹é †ç•ªã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š DBã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•å¾Œã«ã€è©²å½“ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ services: app: depends_on: - db env_fileã€environment ã‚³ãƒ³ãƒ†ãƒŠã§å±•é–‹ã™ã‚‹ç’°å¢ƒå¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚Dockerfileå†…ã§ã®ç’°å¢ƒå¤‰æ•°ã¨ã¯ç•°ãªã‚Šã€ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ã®å…¨ã‚¹ãƒ†ãƒ¼ã‚¸ã§ä½¿ç”¨ã§ãã‚‹ã€‚dotenvç³»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ãªãã¦ã‚‚ã‚ˆããªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š mysqlã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ãŸå ´åˆã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç’°å¢ƒå¤‰æ•°ã®è¨­å®šãŒå¿…è¦ã§ã‚ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç’°å¢ƒå¤‰æ•°ã¯ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã§ã‚‚å¿…è¦ãªãŸã‚ã€environmentã‚­ãƒ¼ã«ç›´æ¥ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã›ãšã«ã€envãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã—ãŸç’°å¢ƒå¤‰æ•°ã‚’environmentã‚­ãƒ¼ã§å‚ç…§ã™ã‚‹ã¨ã‚ˆã„ã€‚ services: db: env_file: - .env environment: MYSQL_ROOT_PASSWORD: ${DB_ROOT_PASSWORD} # rootãƒ¦ãƒ¼ã‚¶ã®ãƒ‘ã‚¹ MYSQL_DATABASE: ${DB_DATABASE} # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å MYSQL_USER: ${DB_USER} # ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶å MYSQL_PASSWORD: ${DB_PASSWORD} # ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ã®ãƒ‘ã‚¹ # .envãƒ•ã‚¡ã‚¤ãƒ« MYSQL_ROOT_PASSWORD=foo # rootãƒ¦ãƒ¼ã‚¶ã®ãƒ‘ã‚¹ MYSQL_DATABASE=bar # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å MYSQL_USER=baz # ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶å MYSQL_PASSWORD=qux # ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ã®ãƒ‘ã‚¹ mysqlã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã¯ã€ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã«å¿œã˜ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•æ™‚ã«SQLãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã®ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€CREATE DATABASEã€ã€ã¾ãŸãƒ¦ãƒ¼ã‚¶åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€CREATE USERã€ã¨ã€GRANT ALLã€ã®SQLãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/docker-library/mysql/blob/master/5.7/docker-entrypoint.sh#L308-L322 ãƒ«ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶åã¯å®šç¾©ã§ããšã€ã€rootã€ã¨ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/docker-library/mysql/blob/master/5.7/docker-entrypoint.sh#L156 extra_host ã‚³ãƒ³ãƒ†ãƒŠã«ã€ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã€ã“ã‚Œã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚ŒãŸãƒ›ã‚¹ãƒˆåã‚’è¨­å®šã™ã‚‹ã€‚ãƒãƒƒãƒ”ãƒ³ã‚°ã¯ã€/etc/hostsãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¾ã‚Œã‚‹ã€‚ã‚‚ã—è¨­å®šã—ãªã‹ã£ãŸå ´åˆã€ã‚µãƒ¼ãƒ“ã‚¹åã¾ãŸã¯ã‚³ãƒ³ãƒ†ãƒŠåãŒãƒ›ã‚¹ãƒˆåã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ã€‚ services: web: extra_hosts: - web:162.242.195.82 $ cat /etc/hosts 127.0.0.1 localhost ::1 localhost ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters # ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã€ã“ã‚Œã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚ŒãŸãƒ›ã‚¹ãƒˆå 162.242.195.82 web 172.23.0.3 c9bd8ace335d hostname ï¼Šå®Ÿè£…ä¾‹ï¼Š ã‚³ãƒ³ãƒ†ãƒŠã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã€æŒ‡å®šã—ãŸãƒ›ã‚¹ãƒˆåã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã€‚ãƒãƒƒãƒ”ãƒ³ã‚°ã¯ã€/etc/hostsãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¾ã‚Œã‚‹ã€‚ã‚‚ã—è¨­å®šã—ãªã‹ã£ãŸå ´åˆã€ã‚µãƒ¼ãƒ“ã‚¹åã¾ãŸã¯ã‚³ãƒ³ãƒ†ãƒŠåãŒãƒ›ã‚¹ãƒˆåã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: web: hostname: web $ cat /etc/hosts 127.0.0.1 localhost ::1 localhost ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters # ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚ŒãŸãƒ›ã‚¹ãƒˆå 172.18.0.3 web image ã‚¤ãƒ¡ãƒ¼ã‚¸ã«åå‰ã‚’ã¤ã‘ã‚‹ã€‚æ¨™æº–ã§ã¯ã€ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå_ã‚µãƒ¼ãƒ“ã‚¹åã€ã¨ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: image: foo-app: logging ãƒ»fluentd ã‚³ãƒ³ãƒ†ãƒŠã§ç”Ÿæˆã•ã‚ŒãŸãƒ­ã‚°ã‚’Fluentdã‚³ãƒ³ãƒ†ãƒŠã«è»¢é€ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentd.org/container-deployment/docker-compose#step-0-create-docker-compose.yml ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: logging: driver: fluentbit options: fluentd-address: localhost:24224 tag: app log_router: build: ./docker/fluentd/Dockerfile ports: - \"24224:24224\" networks ã‚³ãƒ³ãƒ†ãƒŠã‚’æ¥ç¶šã™ã‚‹å†…éƒ¨ï¼å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’è¨­å®šã™ã‚‹ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã§ã¯ãªãã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š networks: # å†…éƒ¨ï¼å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’è¨­å®šã™ã‚‹ã€‚ - foo-network ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã¯ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã§ãã‚‹ã€‚ # æŒ‡å®šã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚’ç¢ºèªã™ã‚‹ã€‚ $ docker network inspect foo-network [ { \"Name\": \"foo-network\", # ï½ ä¸­ç•¥ ï½ \"Containers\": { \"e681fb35e6aa5c94c85acf3522a324d7d75aad8eada13ed1779a4f8417c3fb44\": { \"Name\": \"\", \"EndpointID\": \"ef04da88901646359086eeb45aab81d2393c2f71b4266ccadc042ae49d684409\", \"MacAddress\": \"**:**:**:**:**:**\", \"IPv4Address\": \"nnn.nn.n.n/nn\", \"IPv6Address\": \"\" \"33632947e4210126874a7c26dce281642a6040e1acbebbdbbe8ba333c281dff8\": { \"Name\": \"\", \"EndpointID\": \"ef04da88901646359086eeb45aab81d2393c2f71b4266ccadc042ae49d684409\", \"MacAddress\": \"**:**:**:**:**:**\", \"IPv4Address\": \"nnn.nn.n.n/nn\", \"IPv6Address\": \"\" } }, # ï½ ä¸­ç•¥ ï½ \"Labels\": { \"com.docker.compose.network\": \"foo-network\", \"com.docker.compose.project\": \"\", \"com.docker.compose.version\": \"1.29.0\" } } ] ãªãŠã€æ¥ç¶šã™ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯æ˜ç¤ºçš„ã«æŒ‡å®šã—ãªãã¦ã‚‚ã‚ˆã„ã€‚ãã®å ´åˆã€ã€_defaultã€ã¨ã„ã†ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã€ã€defaultã€ã¨ã„ã†ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã§ä½œæˆã•ã‚Œã‚‹ã€‚ services: web: networks: # defaultã¯ã€æ˜ç¤ºçš„ã«æŒ‡å®šã—ã¦ã‚‚ã—ãªãã¦ã‚‚ã©ã¡ã‚‰ã§ã‚‚ã‚ˆã„ã€‚ - default $ docker network inspect _default [ { \"Name\": \"_default\", # ï½ ä¸­ç•¥ ï½ \"Containers\": { \"e681fb35e6aa5c94c85acf3522a324d7d75aad8eada13ed1779a4f8417c3fb44\": { \"Name\": \"\", \"EndpointID\": \"ef04da88901646359086eeb45aab81d2393c2f71b4266ccadc042ae49d684409\", \"MacAddress\": \"**:**:**:**:**:**\", \"IPv4Address\": \"nnn.nn.n.n/nn\", \"IPv6Address\": \"\" \"33632947e4210126874a7c26dce281642a6040e1acbebbdbbe8ba333c281dff8\": { \"Name\": \"\", \"EndpointID\": \"ef04da88901646359086eeb45aab81d2393c2f71b4266ccadc042ae49d684409\", \"MacAddress\": \"**:**:**:**:**:**\", \"IPv4Address\": \"nnn.nn.n.n/nn\", \"IPv6Address\": \"\" } }, # ï½ ä¸­ç•¥ ï½ \"Labels\": { \"com.docker.compose.network\": \"default\", \"com.docker.compose.project\": \"\", \"com.docker.compose.version\": \"1.29.0\" } } ] platform ã‚³ãƒ³ãƒ†ãƒŠã®CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: platform: linux/amd64 ports ãƒ›ã‚¹ãƒˆOSã¨ã‚³ãƒ³ãƒ†ãƒŠã®é–“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¨­å®šã™ã‚‹ã€‚ã‚³ãƒ³ãƒ†ãƒŠã®ã¿ãƒãƒ¼ãƒˆç•ªå·ã‚’æŒ‡å®šã—ãŸå ´åˆã€ãƒ›ã‚¹ãƒˆOSå´ã®ãƒãƒ¼ãƒˆç•ªå·ã¯ãƒ©ãƒ³ãƒ€ãƒ ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: web: ports: - \"8080:80\" # : stdin_open docker-composeã‚³ãƒãƒ³ãƒ‰ã®è£å´ã§å®Ÿè¡Œã•ã‚Œã‚‹runã‚³ãƒãƒ³ãƒ‰ã«ãŠã„ã¦ã€iã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: stdin_open: true tty docker-composeã‚³ãƒãƒ³ãƒ‰ã®è£å´ã§å®Ÿè¡Œã•ã‚Œã‚‹runã‚³ãƒãƒ³ãƒ‰ã«ãŠã„ã¦ã€tã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ç–‘ä¼¼ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã«ã‚ˆã£ã¦ã€exitã®å¾Œã‚‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã•ã›ç¶šã‘ã‚‰ã‚Œã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: tty: true volumesï¼ˆBindãƒã‚¦ãƒ³ãƒˆï¼‰ æœ€ä¸Šå±¤ã¨serviceå†…ã§ã€ç•°ãªã‚‹Volumeåã‚’è¨˜è¿°ã—ãŸå ´åˆã€Bindãƒã‚¦ãƒ³ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ãƒ›ã‚¹ãƒˆOSã«ã‚ã‚‹/Usersãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚³ãƒ³ãƒ†ãƒŠå´ã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: volumes: - ./web:/var/www/foo # : volumesï¼ˆVolumeãƒã‚¦ãƒ³ãƒˆï¼‰ æœ€ä¸Šå±¤ã¨serviceå†…ã®ä¸¡æ–¹ã«ã€åŒã˜Volumeåã‚’è¨˜è¿°ã—ãŸå ´åˆã€Volumeãƒã‚¦ãƒ³ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚Dockerã‚¨ãƒªã‚¢ã«VolumeãŒä½œæˆã•ã‚Œã€serviceã‚ªãƒ—ã‚·ãƒ§ãƒ³å†…ã«è¨­å®šã—ãŸvolumesã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§Volumeãƒã‚¦ãƒ³ãƒˆã‚’è¡Œã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š service: db: volumes: # volumeãƒã‚¦ãƒ³ãƒˆ - mysql_volume:/var/www/lib/mysql volumes: # volumeå mysql_volume: # localã§ã€ãƒ›ã‚¹ãƒˆOSã®Dockerã‚¨ãƒªã‚¢ã‚’æŒ‡å®š driver: local å¤‰æ•°å±•é–‹ ç’°å¢ƒå¤‰æ•°ã‚’docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã«å±•é–‹ã™ã‚‹ã€‚å¤‰æ•°ã®å±•é–‹ã«ã‚ãŸã‚Šã€docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜éšå±¤ã«ã‚ã‚‹.envãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚ã“ã®å±•é–‹ã«env_fileã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚ãã®ãŸã‚ã€ä¾‹ãˆã°.envãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ã®åå‰ã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ•°å±•é–‹ã®ãŸã‚ã«ç”¨ã„ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š services: app: build: # å‡ºåŠ›å…ƒã®å€¤ã¯ã€.envãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ target: ${APP_ENV} image: ${APP_ENV}-foo-app 02. networks networksã¨ã¯ æ¨™æº–ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½œæˆã™ã‚‹ã€‚ãŸã ã—å®šç¾©ã—ãªãã¨ã‚‚è‡ªå‹•çš„ã«æ§‹ç¯‰ã•ã‚Œã‚‹ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã¯ã€æŒ‡å®šã—ãªã„å ´åˆã«ã€_defaultã€ã«ãªã‚‹ã€‚ ãƒ»name ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã‚’ãƒ¦ãƒ¼ã‚¶å®šç¾©åã«ã™ã‚‹ã€‚ networks: default: # ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹å name: foo-network ãªãŠã€ã“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ˜ç¤ºçš„ã«è¨­å®šã™ã‚‹å ´åˆã¯ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹åï¼ˆdefaultï¼‰ã§è¨­å®šã™ã‚‹ã€‚ services: web: networks: # defaultã¯ã€æ˜ç¤ºçš„ã«æŒ‡å®šã—ã¦ã‚‚ã—ãªãã¦ã‚‚ã©ã¡ã‚‰ã§ã‚‚ã‚ˆã„ã€‚ - default $ docker network ls NETWORK ID NAME DRIVER SCOPE ************ foo-network bridge local $ docker network inspect foo-network [ { \"Name\": \"foo-network\", # ï½ ä¸­ç•¥ ï½ \"Containers\": { \"e681fb35e6aa5c94c85acf3522a324d7d75aad8eada13ed1779a4f8417c3fb44\": { \"Name\": \"\", \"EndpointID\": \"ef04da88901646359086eeb45aab81d2393c2f71b4266ccadc042ae49d684409\", \"MacAddress\": \"**:**:**:**:**:**\", \"IPv4Address\": \"nnn.nn.n.n/nn\", \"IPv6Address\": \"\" \"33632947e4210126874a7c26dce281642a6040e1acbebbdbbe8ba333c281dff8\": { \"Name\": \"\", \"EndpointID\": \"ef04da88901646359086eeb45aab81d2393c2f71b4266ccadc042ae49d684409\", \"MacAddress\": \"**:**:**:**:**:**\", \"IPv4Address\": \"nnn.nn.n.n/nn\", \"IPv6Address\": \"\" } }, # ï½ ä¸­ç•¥ ï½ \"Labels\": { \"com.docker.compose.network\": \"foo-network\", \"com.docker.compose.project\": \"\", \"com.docker.compose.version\": \"1.29.0\" } } ] ãƒ»external ç•°ãªã‚‹docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ¥ç¶šã§ãã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½œæˆã™ã‚‹ã€‚ä½œæˆã•ã‚Œã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã¯ã€externalã‚­ãƒ¼ã®ä¸Šéƒ¨ã§è¨­å®šã—ãŸã‚‚ã®ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒç•°ãªã‚‹docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã§ãã‚‹ã‚ˆã†ã«ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½œæˆã™ã‚‹ã€‚ # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®Docker-compose services: app: container_name: backend-container # ï½ ä¸­ç•¥ ï½ networks: # ä½œæˆã—ãŸã„å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹å backend: external: true ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã«ã¦ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã‚’æŒ‡å®šã—ã¦ã€ # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®Docker-compose services: app: container_name: frontend-container # å†…éƒ¨ï¼å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã„ãšã‚Œã‹ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã‚’è¨­å®šã™ã‚‹ã€‚ networks: - backend # ï½ ä¸­ç•¥ ï½ networks: default: external: # æ¥ç¶šã—ãŸã„å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹å name: backend ä½œæˆã—ãŸå†…éƒ¨ï¼å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã§ãã‚‹ã€‚ã€_defaultã€ã¨ã„ã†ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã«ãªã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ docker network ls NETWORK ID NAME DRIVER SCOPE ************ backend bridge local 04. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ Volumeãƒ—ãƒ©ã‚°ã‚¤ãƒ³ ãƒ»NFSã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ NFSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€æ°¸ç¶šåŒ–ãƒ‡ãƒ¼ã‚¿ã‚’/var/lib/docker/volumesã§ã¯ãªãã€NFSã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š ä»¥ä¸‹ã«docker-composeã‚’ç”¨ã„ãŸå ´åˆã‚’ç¤ºã™ã€‚ version: \"3.7\" services: app: build: # ï½ ä¸­ç•¥ ï½ ports: # ï½ ä¸­ç•¥ ï½ depends_on: # ï½ ä¸­ç•¥ ï½ volumes: - example:/data # ä¸‹æ–¹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒé©ç”¨ã•ã‚Œã‚‹ã€‚ volumes: example: driver_opts: # NFSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã€NFSã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã€‚ type: \"nfs\" o: \"addr=10.40.0.199,nolock,soft,rw\" device: \":/nfs/example\" 05. ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ¥Tips mysqlã‚¤ãƒ¡ãƒ¼ã‚¸ ãƒ»ãƒ“ãƒ«ãƒ‰æ™‚ã«SQLå®Ÿè¡Œ mysqlã‚³ãƒ³ãƒ†ãƒŠã«ã¯docker-entrypoint-initdb.dãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒã‚ã‚‹ã€‚ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚ŒãŸsqlãƒ•ã‚¡ã‚¤ãƒ«ã‚„bashãƒ—ãƒ­ã‚»ã‚¹ã¯ã€mysqlã‚³ãƒ³ãƒ†ãƒŠã®ãƒ“ãƒ«ãƒ‰æ™‚ã«docker-entrypoint.shãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€Bindãƒã‚¦ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã“ã¨ã§ã€åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥ã‚„è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä½œæˆã‚’å®Ÿç¾ã§ãã‚‹ã€‚å…·ä½“çš„ãªå®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://github.com/docker-library/mysql/blob/master/8.0/Dockerfile.debian#L92-L93 ï¼Šå®Ÿè£…ä¾‹ï¼Š mysqlã‚³ãƒ³ãƒ†ãƒŠã«ã€PHPUnitã®å®Ÿè¡Œæ™‚ã®ã¿ç”¨ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªã€docker-compose.ymlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ version: \"3.7\" services: db: container_name: foo-mysql hostname: foo-mysql image: mysql:5.7 ports: - \"3307:3306\" volumes: - mysql_volume:/var/www/lib/mysql # docker-entrypoint-initdb.dãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«Bindãƒã‚¦ãƒ³ãƒˆã‚’è¡Œã†ã€‚ - ./infra/docker/mysql/init:/docker-entrypoint-initdb.d environment: MYSQL_ROOT_PASSWORD: foo MYSQL_DATABASE: foo MYSQL_USER: foo MYSQL_PASSWORD: foo TZ: \"Asia/Tokyo\" command: mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci networks: - default volumes: mysql_volume: ã¾ãŸã€docker-entrypoint-initdb.dãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã€ä»¥ä¸‹ã®sqlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€testã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®SQLã‚’å®Ÿè£…ã™ã‚‹ã€‚ -- /infra/docker/mysql/initã«SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã€‚ CREATE DATABASE IF NOT EXISTS `test` COLLATE 'utf8mb4_general_ci' CHARACTER SET 'utf8mb4'; GRANT ALL ON *.* TO 'foo'@'%' ; PHPUnitã§æ¥ç¶šã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_php_testing_based_on_code.html "},"public/virtualization/virtualization_container_orchestration_kubernetes_command.html":{"url":"public/virtualization/virtualization_container_orchestration_kubernetes_command.html","title":"ğŸ“– ï¸kubernetesã‚³ãƒãƒ³ãƒ‰","keywords":"","body":"kubernetesã‚³ãƒãƒ³ãƒ‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Kubernetesã®æ§‹æˆè¦ç´  å…¨ä½“åƒ å‚è€ƒï¼š https://medium.com/easyread/step-by-step-introduction-to-basic-concept-of-kubernetes-e20383bdd118 https://qiita.com/baby-degu/items/ce26507bd954621d6dc5 Kubernetesã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ãƒ»Kubernetesã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã¯ Kubernetesã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€kubectlã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€Kubernetesãƒã‚¹ã‚¿ãƒ¼APIã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã€‚ Kubernetesãƒã‚¹ã‚¿ãƒ¼ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ï¼‰ ãƒ»Kubernetesãƒã‚¹ã‚¿ãƒ¼ã¨ã¯ ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã®æ“ä½œã‚’æ‹…ã†ã€‚ã€ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ã€ã¨ã‚‚ã„ã†ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒkubectlã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã™ã‚‹ã¨ã€apiserverãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã€ã‚³ãƒãƒ³ãƒ‰ã«æ²¿ã£ã¦ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ãŒæ“ä½œã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/ja/docs/concepts/#kubernetes%E3%83%9E%E3%82%B9%E3%82%BF%E3%83%BC ãƒ»apiserver Kubernetesã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã‚³ãƒãƒ³ãƒ‰ã®APIã‚’æä¾›ã™ã‚‹ã€‚ ãƒ»controller-manager ãƒ»scheduler ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¨ã¯ ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã®ç®¡ç†å˜ä½ã®ã“ã¨ã€‚ ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ ãƒ»ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã¨ã¯ ãƒãƒƒãƒ‰ãŒç¨¼åƒã™ã‚‹ã‚µãƒ¼ãƒå˜ä½ã“ã¨ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/ja/docs/concepts/architecture/nodes/ ãƒ»Kubelet ãƒ»ã‚³ãƒ³ãƒ†ãƒŠã‚¨ãƒ³ã‚¸ãƒ³ ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•åœæ­¢ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ«ã€ãªã©ã‚’è¡Œã†ã€‚ ãƒ»Kubeãƒ—ãƒ­ã‚­ã‚· å—ä¿¡ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒãƒƒãƒ‰ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹ã€‚ ãƒ»ãƒãƒƒãƒ‰ã¨ã¯ ã‚³ãƒ³ãƒ†ãƒŠã®æœ€å°ã‚°ãƒ«ãƒ¼ãƒ—å˜ä½ã®ã“ã¨ã€‚Podã‚’å˜ä½ã¨ã—ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ï¼åœæ­¢ã‚„æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ï¼ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/ja/docs/concepts/workloads/pods/ AWS ECSã‚¿ã‚¹ã‚¯ã«ãŠã‘ã‚‹é¡ä¼¼ã™ã‚‹essentialæ©Ÿèƒ½ã‚„ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/cloud_computing/cloud_computing_aws.html ï¼Šä¾‹ï¼Š PHP-FPMã‚³ãƒ³ãƒ†ãƒŠã¨Nginxã‚³ãƒ³ãƒ†ãƒŠã‚’ç¨¼åƒã•ã›ã‚‹å ´åˆã€ã“ã‚Œã‚‰åŒã˜Podã«é…ç½®ã™ã‚‹ã€‚ ã‚µãƒ¼ãƒ“ã‚¹ ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã¨ã¯ ãƒãƒƒãƒ‰ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã®ã“ã¨ã€‚ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚ã‚‹ã€ã‚µãƒ¼ãƒ“ã‚¹ã€ã¨ã¯åŒºåˆ¥ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/ja/docs/concepts/services-networking/service/ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ ãƒ»ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¨ã¯ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã—ã€ã‚³ãƒ³ãƒ†ãƒŠã«é¸æŠçš„ã«æä¾›ã™ã‚‹ã€‚ ãƒ¬ãƒ—ãƒªã‚«ã‚»ãƒƒãƒˆï¼ˆãƒ¬ãƒ—ãƒªã‚«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ï¼‰ ãƒ»ãƒ¬ãƒ—ãƒªã‚«ã‚»ãƒƒãƒˆã¨ã¯ ãƒœãƒªãƒ¥ãƒ¼ãƒ  ãƒ»PersistentVolume ãƒãƒ¼ãƒ‰ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ãŸãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ã“ã¨ã€‚ãƒãƒƒãƒ‰ãŒPersistentVolumeã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã¯ã€PersistentVolumeClaimã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«PersistentVolumeã‚’è¦æ±‚ã•ã›ã¦ãŠãã€ãƒãƒƒãƒ‰ã§ã“ã®PersistentVolumeClaimã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://thinkit.co.jp/article/14195 ãƒ»EmptyDir ãƒãƒƒãƒ‰ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ãŸãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ã“ã¨ã€‚ãƒãƒƒãƒ‰ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ãƒãƒƒãƒ‰ãŒå‰Šé™¤ã•ã‚Œã‚‹ã¨ã€ã“ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚‚åŒæ™‚ã«å‰Šé™¤ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://zenn.dev/suiudou/articles/31ab107f3c2de6#%E2%96%A0kubernetes%E3%81%AE%E3%81%84%E3%82%8D%E3%82%93%E3%81%AA%E3%83%9C%E3%83%AA%E3%83%A5%E3%83%BC%E3%83%A0 ãƒ»å¤–éƒ¨ãƒœãƒªãƒ¥ãƒ¼ãƒ  Kuberneteså¤–ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ãŸãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ã“ã¨ã€‚ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ™ãƒ³ãƒ€ãƒ¼ã€NFSã€ãªã©ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://zenn.dev/suiudou/articles/31ab107f3c2de6#%E2%96%A0kubernetes%E3%81%AE%E3%81%84%E3%82%8D%E3%82%93%E3%81%AA%E3%83%9C%E3%83%AA%E3%83%A5%E3%83%BC%E3%83%A0 02. ã‚³ãƒãƒ³ãƒ‰ apply ãƒ»applyã¨ã¯ åŒã˜è­˜åˆ¥å­ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåï¼‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€å­˜åœ¨ã™ã‚‹å ´åˆã¯ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å·®åˆ†ã‚’æ›´æ–°ã™ã‚‹ã€‚å…¨ã¦ã®é …ç›®ã‚’æ›´æ–°ã§ãã‚‹ã‚ã‘ã§ãªã„ã€‚ ãƒ»-f ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã€applyã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ kubectl apply -f ./kubernetes-manifests/foo-pod.yml pod/foo-pod created # ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å¤‰æ›´ $ kubectl apply -f ./kubernetes-manifests/foo-pod.yml pod/foo-pod configured config ãƒ»config Kubernetesè‡ªä½“ã®è¨­å®šã‚’æ“ä½œã™ã‚‹ã€‚ ãƒ»view Kubernetesè‡ªä½“ã®è¨­å®šãŒå®Ÿè£…ã•ã‚ŒãŸ~/.kude/configãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ kubectl config view apiVersion: v1 clusters: - cluster: certificate-authority-data: DATA+OMITTED server: https://kubernetes.docker.internal:6443 name: docker-desktop contexts: - context: cluster: docker-desktop user: docker-desktop name: docker-desktop current-context: docker-desktop kind: Config preferences: {} users: - name: docker-desktop user: client-certificate-data: REDACTED client-key-data: REDACTED cp ãƒ›ã‚¹ãƒˆPCã®ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ãŸãƒãƒƒãƒ‰å†…ã®ã‚³ãƒ³ãƒ†ãƒŠã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚ $kubectl cp /: $kubectl cp /:/ create ãƒ»createã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚åŒã˜è­˜åˆ¥å­ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåï¼‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯é‡è¤‡ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ ãƒ»-f ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã€createã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ kubectl create -f ./kubernetes-manifests/foo-pod.yml pod/foo-pod created $ kubectl create -f ./kubernetes-manifests/foo-service.yml service/foo-service created deploment ãƒ»deploymentã¨ã¯ ãƒãƒƒãƒ‰ã‚’ç®¡ç†ã™ã‚‹ãƒ¬ãƒ—ãƒªã‚«ã‚»ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ»-f ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã€deploymentã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ kubectl create deployment -f ./kubernetes-manifests/foo-deployment.yml get ãƒ»getã¨ã¯ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‚ç…§ã™ã‚‹ã€‚ ãƒ»node æ§‹ç¯‰æ¸ˆã¿ã®ãƒãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ kubectl get nodes NAME STATUS ROLES AGE VERSION docker-desktop Ready control-plane,master 12h v1.21.5 # ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ ãƒ»pod æ§‹ç¯‰æ¸ˆã¿ã®ãƒãƒƒãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ kubectl get pods NAME READY STATUS RESTARTS AGE foo-pod 0/2 ImagePullBackOff 0 7m52s ãƒ»services æ§‹ç¯‰æ¸ˆã¿ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ kubectl get services NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE foo-service ClusterIP nn.nnn.nnn.n 80/TCP 10s kubernetes ClusterIP nn.nn.n.n 443/TCP 12h logs ãƒ»logsã¨ã¯ æŒ‡å®šã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã— ï¼Šå®Ÿè¡Œä¾‹ï¼Š ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ $ kubectl logs 2021/11/27 08:34:01 [emerg] ***** proxy ãƒ»proxyã¨ã¯ Kubeãƒ—ãƒ­ã‚­ã‚·ã‚’ä½œæˆã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/ja/docs/concepts/cluster-administration/proxies/ ãƒ»--addressã€--accept-hosts $ kubectl proxy --address=0.0.0.0 --accept-hosts='.*' Starting to serve on [::]:8001 03. minikubeã‚³ãƒãƒ³ãƒ‰ minikubeã‚³ãƒãƒ³ãƒ‰ã¨ã¯ ä»®æƒ³ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã€ã¾ãŸä»®æƒ³ç’°å¢ƒä¸‹ã§å˜ä¸€ã®ãƒãƒ¼ãƒ‰ã‚’æŒã¤ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’ä½œæˆã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã€‚ å‚è€ƒï¼šhttps://minikube.sigs.k8s.io/docs/commands/ dashboard ãƒ»dashboardã¨ã¯ Kubernetesã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ç™ºç’°å¢ƒã«æ§‹ç¯‰ã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ minikube dashboard &#x1F914; Verifying dashboard health ... &#x1F680; Launching proxy ... &#x1F914; Verifying proxy health ... &#x1F389; Opening http://127.0.0.1:55712/*****/ in your default browser... docker-env ãƒ»docker-envã¨ã¯ ãƒ›ã‚¹ãƒˆPCã§dockerã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸæ™‚ã«ã€ãƒ›ã‚¹ãƒˆPCã®dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã§ãªãã€minikubeã®ä»®æƒ³ç’°å¢ƒã®dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’ã‚³ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã€ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚°ãŒlatestã§ã‚ã‚‹ã¨ã€ä»®æƒ³ç’°å¢ƒå¤–ã«å¯¾ã—ã¦ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«ã—ã¦ã—ã¾ã†ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://minikube.sigs.k8s.io/docs/commands/docker-env/ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ minikube docker-env export DOCKER_TLS_VERIFY=\"1\" export DOCKER_HOST=\"tcp://127.0.0.1:52838\" export DOCKER_CERT_PATH=\"/Users/***/.minikube/certs\" export MINIKUBE_ACTIVE_DOCKERD=\"minikube\" # To point your shell to minikube's docker-daemon, run: # eval $(minikube -p minikube docker-env) ip ãƒ»ipã¨ã¯ minikubeã®ç¨¼åƒã™ã‚‹ãƒãƒ¼ãƒ‰ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã— $ minikube ip 192.168.49.2 start ãƒ»startã¨ã¯ ä»®æƒ³ç’°å¢ƒã‚’VMã§æ§‹ç¯‰ã—ã€VMå†…ã§å˜ä¸€ã®ãƒãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã— ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ minikube start &#x1F604; minikube v1.24.0 on Darwin 11.3.1 âœ¨ Automatically selected the docker driver. Other choices: virtualbox, ssh &#x1F44D; Starting control plane node minikube in cluster minikube &#x1F69C; Pulling base image ... &#x1F4BE; Downloading Kubernetes v1.22.3 preload ... > preloaded-images-k8s-v13-v1...: 501.73 MiB / 501.73 MiB 100.00% 2.93 MiB > gcr.io/k8s-minikube/kicbase: 355.78 MiB / 355.78 MiB 100.00% 1.71 MiB p/ &#x1F525; Creating docker container (CPUs=2, Memory=7911MB) ... &#x1F433; Preparing Kubernetes v1.22.3 on Docker 20.10.8 ... â–ª Generating certificates and keys ... â–ª Booting up control plane ... â–ª Configuring RBAC rules ... &#x1F50E; Verifying Kubernetes components... â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5 &#x1F31F; Enabled addons: storage-provisioner, default-storageclass &#x1F3C4; Done! kubectl is now configured to use \"minikube\" cluster and \"default\" namespace by default ãƒãƒ¼ãƒ‰ãŒæ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã€‚ $ kubectl get nodes NAME STATUS ROLES AGE VERSION minikube Ready control-plane,master 14m v1.22.3 ãƒ»--driver ä»®æƒ³ç’°å¢ƒã®æ§‹ç¯‰æ–¹æ³•ã‚’æŒ‡å®šã—ã€startã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šå®Ÿè¡Œä¾‹ï¼Š $ minikube start --driver docker "},"public/virtualization/virtualization_container_orchestration_kubernetes_manifest_yml.html":{"url":"public/virtualization/virtualization_container_orchestration_kubernetes_manifest_yml.html","title":"ğŸ“– ï¸manifest.yml","keywords":"","body":"manifest.yml ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. apiVersion Kubernetes-APIã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã€‚ apiVersion: v1 02. kind ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç¨®é¡ã‚’è¨­å®šã™ã‚‹ã€‚ kind: Service 03. metadata name ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹ãŸã‚ã®åå‰ã‚’è¨­å®šã™ã‚‹ã€‚ metadata: name: foo-service 05. specï¼ˆDeploymentã®å ´åˆï¼‰ template ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æ™‚ã«è¤‡è£½ã®é‹³å‹ã¨ã™ã‚‹ãƒãƒƒãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚ spec: template: metadata: labels: app: foo spec: containers: - name: foo-lumen image: foo-lumen:dev ports: - containerPort: 9000 - name: foo-nginx image: foo-nginx:dev ports: - containerPort: 8000 05-02. specï¼ˆPersistentVolumeã®å ´åˆï¼‰ accessModes ãƒ»ReadWriteMany è¤‡æ•°ãƒãƒ¼ãƒ‰ã‹ã‚‰èª­ã¿å‡ºã—ï¼æ›¸ãè¾¼ã¿ã§ãã‚‹ã€‚ãƒãƒ¼ãƒ‰é–“ã§DBã‚’å…±æœ‰ã—ãŸã„å ´åˆã«ä½¿ç”¨ã™ã‚‹ã€‚ spec: accessModes: - ReadWriteMany ãƒ»ReadOnlyMany è¤‡æ•°ãƒãƒ¼ãƒ‰ã‹ã‚‰èª­ã¿å‡ºã—ã§ãã€ã¾ãŸå˜ä¸€ãƒãƒ¼ãƒ‰ã®ã¿ã‹ã‚‰æ›¸ãè¾¼ã¿ã§ãã‚‹ã€‚ãƒãƒ¼ãƒ‰é–“ã§èª­ã¿å‡ºã—å‡¦ç†ã®ã¿DBã‚’å…±æœ‰ã—ãŸã„å ´åˆã«ä½¿ç”¨ã™ã‚‹ã€‚ spec: accessModes: - ReadOnlyMany ãƒ»ReadWriteOnce å˜ä¸€ãƒãƒ¼ãƒ‰ã‹ã‚‰ã®ã¿èª­ã¿å‡ºã—ï¼æ›¸ãè¾¼ã¿ã§ãã‚‹ã€‚ãƒãƒ¼ãƒ‰ã”ã¨ã«DBã‚’åˆ†å‰²ã—ãŸã„å ´åˆã«ä½¿ç”¨ã™ã‚‹ã€‚ spec: accessModes: - ReadWriteOnce capacity spec: capacity: storage: 10G mountOptions spec: mountOptions: - hard nfs spec: nfs: server: nnn.nnn.nnn.nnn path: /nfs/foo persistentVolumeReclaimPolicy spec: persistentVolumeReclaimPolicy: Retain storageClassName spec: storageClassName: slow 05-03. specï¼ˆPersistentVolumeClaimã®å ´åˆï¼‰ accessModes spec: accessModes: - ReadWriteMany resources spec: resources: - ReadWriteMany 05-04. specï¼ˆPodã®å ´åˆï¼‰ containers ãƒ»nameã€imageã€port ãƒãƒƒãƒ‰ã‚’æ§‹æˆã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®åå‰ã€ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã€å—ä¿¡ãƒãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ spec: containers: - name: foo-lumen image: foo-lumen:dev ports: - containerPort: 9000 - name: foo-nginx image: foo-nginx:dev ports: - containerPort: 8000 ãƒ»volumeMount volumeãƒã‚¦ãƒ³ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚spec.volumeã§è¨­å®šã•ã‚ŒãŸãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ã†ã¡ã‹ã‚‰ã€ã‚³ãƒ³ãƒ†ãƒŠã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’è¨­å®šã™ã‚‹ã€‚ spec: containers: - name: foo-lumen image: foo-lumen:dev ports: - containerPort: 9000 volumeMounts: - name: foo-nginx mountPath: /var/www/foo - name: foo-lumen image: foo-lumen:dev ports: - containerPort: 9000 volumeMounts: - name: foo-nginx mountPath: /var/www/foo hostname ãƒãƒƒãƒ‰ã®ãƒ›ã‚¹ãƒˆåã‚’è¨­å®šã™ã‚‹ã€‚ã¾ãŸã€spec.hostnameãŒè¨­å®šã•ã‚Œã¦ã„ãªã„æ™‚ã¯ã€metadata.nameãŒãƒ›ã‚¹ãƒˆåã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/ja/docs/concepts/services-networking/dns-pod-service/#pod%E3%81%AEhostname%E3%81%A8subdomain%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89 spec: hostname: foo-pod volume ãƒ»name ãƒœãƒªãƒ¥ãƒ¼ãƒ åã‚’è¨­å®šã™ã‚‹ã€‚ ãƒ»persistentVolumeClaim.claimName ä½¿ç”¨ã™ã‚‹PersistentVolumeClaimã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åå‰ã‚’è¨­å®šã™ã‚‹ã€‚ãƒãƒƒãƒ‰ãŒå‰Šé™¤ã•ã‚Œã¦ã‚‚ã€ã“ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¯å‰Šé™¤ã•ã‚Œãªã„ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/ja/docs/concepts/storage/persistent-volumes/ spec: volumes - name: foo-db persistentVolumeClaim: claimName: foo-persistent-volume ãƒ»emptyDir EmptyDirãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹ã€‚ãƒãƒƒãƒ‰ãŒå‰Šé™¤ã•ã‚Œã‚‹ã¨ã€ã“ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚‚åŒæ™‚ã«å‰Šé™¤ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://kubernetes.io/docs/concepts/storage/volumes/#emptydir spec: volumes - name: foo-lumen emptyDir: {} - name: foo-nginx emptyDir: {} ãƒ»HostDir HostDirãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹ã€‚ spec: volumes - name: foo-lumen emptyDir: {} - name: foo-nginx emptyDir: {} 05-05. specï¼ˆServiceã®å ´åˆï¼‰ ports ãƒ»protocol ã‚µãƒ¼ãƒ“ã‚¹ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ãŸã‚ã«ã€å—ä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ spec: ports: - protocol: TCP ãƒ»port ã‚µãƒ¼ãƒ“ã‚¹ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã™ã‚‹ãŸã‚ã«ã€å—ä¿¡ãƒãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ spec: ports: - port: 80 ãƒ»targetPort ãƒãƒƒãƒ‰ã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹ãŸã‚ã«ã€è»¢é€å…ˆãƒãƒ¼ãƒˆã‚’è¨­å®šã™ã‚‹ã€‚ spec: ports: - targetPort: 9376 selector ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è»¢é€å…ˆã¨ã™ã‚‹ãƒãƒƒãƒ‰ã®ãƒ©ãƒ™ãƒ«ã®ã‚­ãƒ¼åã¨å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://v1-18.docs.kubernetes.io/ja/docs/concepts/overview/working-with-objects/labels/ spec: selector: app: foo type ãƒãƒƒãƒ‰ã®å…¬é–‹æ–¹æ³•ã®ç¨®é¡ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://zenn.dev/smiyoshi/articles/c86fc3532b4f8a https://www.netone.co.jp/knowledge-center/netone-blog/20210715-01/ å€¤ ãƒãƒƒãƒ‰ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆè»¢é€æ–¹æ³• IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å…¬é–‹ç¯„å›² ClusterIP ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã€ã“ã‚Œã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒãƒƒãƒ‰ã«è»¢é€ã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å†…éƒ¨ã‹ã‚‰ã®ã¿ NodePort ãƒãƒ¼ãƒ‰ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãŠã‘ã‚‹ç‰¹å®šã®ãƒãƒ¼ãƒˆã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒãƒƒãƒ‰ã«è»¢é€ã™ã‚‹ã€‚ãƒãƒ¼ãƒ‰ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯åˆ¥ã«ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å¤–éƒ¨ï¼å†…éƒ¨ LoadBalancer ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã€ã“ã‚Œã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒãƒƒãƒ‰ã«è»¢é€ã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å¤–éƒ¨ï¼å†…éƒ¨ "},"public/virtualization/virtualization_container_orchestration_kubernetes_istio.html":{"url":"public/virtualization/virtualization_container_orchestration_kubernetes_istio.html","title":"ğŸ“– ï¸Istio","keywords":"","body":"Istio 01. Istio Istioã¨ã¯ ãƒ»ç‰¹å¾´ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹ä»¥ä¸‹ã®å•é¡Œã‚’è§£æ±ºã§ãã‚‹ã€‚ãŸã ã—ã€Istioã‚’å¿…ãšã—ã‚‚ç”¨ã„ã‚‹å¿…è¦ã¯ãªãã€Kubernetesã®æ¨™æº–ã®æ©Ÿèƒ½ã§ã“ã‚Œã‚’å®Ÿç¾ã—ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://qiita.com/Ladicle/items/4ba57078128d6affadd5 ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“é€šä¿¡ã‚’åˆ¶å¾¡ã—ãã‚Œãªã„ã€‚ éšœå®³æ™‚ã«ä½•ãŒèµ·ã“ã‚‹ã‹åˆ†ã‹ã‚‰ãªã„ã€‚ éµã¨è¨¼æ˜æ›¸ã‚’ç®¡ç†ã—ãã‚Œãªã„ã€‚ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å…¨ä½“åƒãŒæŠŠæ¡ã§ããªã„ ãƒ»ä¾å­˜é–¢ä¿‚ã®è§£æ±º æ©Ÿèƒ½ã€A ---> B ---> C ---> Dã€ã‚’æŒã¤ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã¨ã™ã‚‹ã€‚ã“ã‚Œã‚’ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã—ã¦ã€ABCDã‚’åˆ¥ã€…ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆ†å‰²ã™ã‚‹ã€‚ãã‚Œãã‚Œã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒPodä¸Šã§ç¨¼åƒã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã—ã‹ã—ã€ã“ã‚Œã ã‘ã§ã¯ABCDãŒç‹¬ç«‹ã—ã¦ãŠã‚‰ãšã€å„æ©Ÿèƒ½ã¯ä¸€ã¤å‰ã®æ©Ÿèƒ½ã«ä¾å­˜ã—ã¦ã„ã‚‹ã€‚ã“ã®ä¾å­˜é–¢ä¿‚ã‚’è§£æ±ºã™ã‚‹ã€‚ 02. Istiod Istiodã¨ã¯ Envoyã‚’ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã®ã“ã¨ã€‚Envoyã¯ã€å„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰é€šä¿¡ã‚’å§”è­²ã•ã‚Œã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã®é€šä¿¡ã‚’ä»£ç†ã§è¡Œã†ã€‚ "},"public/virtualization/virtualization_container_orchestration_docker_swarm.html":{"url":"public/virtualization/virtualization_container_orchestration_docker_swarm.html","title":"ğŸ“– ï¸Docker Swarm","keywords":"","body":"Docker Swarm ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. æ¦‚å¿µ "},"public/virtualization/virtualization_server.html":{"url":"public/virtualization/virtualization_server.html","title":"ğŸ“– ï¸ä»®æƒ³ã‚µãƒ¼ãƒï¼ˆä»®æƒ³ãƒã‚·ãƒ³ï¼‰","keywords":"","body":"ä»®æƒ³ã‚µãƒ¼ãƒï¼ˆä»®æƒ³ãƒã‚·ãƒ³ï¼‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Providerã«ã‚ˆã‚‹ä»®æƒ³ã‚µãƒ¼ãƒï¼ˆä»®æƒ³ãƒã‚·ãƒ³ï¼‰ã®æ§‹ç¯‰ Providerã®æ“ä½œ ãƒ»Providerã¨ã¯ åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«ãŠã‘ã‚‹åˆ¶å¾¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚„ä¸€é€£ã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚’ä»®æƒ³çš„ã«æ§‹ç¯‰ã§ãã‚‹ã€‚ã“ã‚Œã‚’ã€ä»®æƒ³ã‚µãƒ¼ãƒï¼ˆä»®æƒ³ãƒã‚·ãƒ³ã¨ã‚‚ï¼‰ã¨ã„ã†ã€‚æ§‹ç¯‰æ–¹æ³•ã®é•ã„ã«ã‚ˆã£ã¦ã€ã€ãƒ›ã‚¹ãƒˆå‹ã€ã€ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶å‹ã€ã«åˆ†é¡ã§ãã‚‹ã€‚ Provisionerã®æ“ä½œ ãƒ»Provisionerã¨ã¯ Providerã«ã‚ˆã£ã¦æ§‹ç¯‰ã•ã‚ŒãŸä»®æƒ³ã‚µãƒ¼ãƒã«ã€Webé–‹ç™ºã®ãŸã‚ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ï¼ˆæ§‹æˆç®¡ç†ã§ãã‚‹ï¼‰ã€‚å…·ä½“çš„ã«ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚„ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ Vagrantã«ã‚ˆã‚‹Providerã¨Provisionerã®æ“ä½œ ãƒ»Vagrantã¨ã¯ Providerã¨Provisionerã®æ“ä½œã‚’è‡ªå‹•åŒ–ã§ãã‚‹ã€‚ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ãŒåˆ¥ã€…ã«ä»®æƒ³ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã€Providerã¨Provisionerã®å‡¦ç†ã«ã‚ˆã£ã¦ä½œã‚‰ã‚Œã‚‹ä»®æƒ³ã‚µãƒ¼ãƒã®ç’°å¢ƒã«ã€é•ã„ãŒç”Ÿã˜ã¦ã—ã¾ã†ã€‚Vagrantã‚’ä½¿ã†å ´åˆã€Providerã¨Provisionerã«ã‚ˆã‚‹å‡¦ç†æ–¹æ³•ã¯ã€Vagrantfileã«è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã®ãŸã‚ã«ã€Vagrantã‚’ç”¨ã„ã‚Œã°ã€ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ãŒåŒã˜ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä¸‹ã§ã€ä»®æƒ³ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã—ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã€‚ ãƒ»ã‚µãƒ¼ãƒã®æƒ…å ±ã®ç®¡ç†æ–¹æ³• ã‚µãƒ¼ãƒã®æƒ…å ±ã¯ã€.envãƒ•ã‚¡ã‚¤ãƒ«ã§ä»¥ä¸‹ã®æ§˜ã«ç®¡ç†ã™ã‚‹ã€‚å…¨ã¦ã®å€¤ãŒæ–‡å­—åˆ—ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ãŸã‚ã€æ•°å€¤ã‚„çœŸå½å€¤ã¯ä½¿ç”¨ã§ããªã„ã€‚ #======================================= # Webã‚µãƒ¼ãƒæƒ…å ± #======================================= WEB_HOST= #======================================= # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒæƒ…å ± #======================================= DB_HOST=foo-db DB_NAME=foo DB_USER=foo DB_PASSWORD=***** ãƒ»ä¸»ãªvagrantã‚³ãƒãƒ³ãƒ‰ ã‚³ãƒãƒ³ãƒ‰ å‡¦ç† vagrant up ä»®æƒ³ã‚µãƒ¼ãƒèµ·å‹• vagrant halt ä»®æƒ³ã‚µãƒ¼ãƒåœæ­¢ vagrant ssh ä»®æƒ³ã‚µãƒ¼ãƒã¸ã®ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶š vagrant global-status èµ·å‹•ä¸­ä»®æƒ³ã‚µãƒ¼ãƒã®ä¸€è¦§ 02. ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚µãƒ¼ãƒã®æ§‹ç¯‰ "},"public/ci_cd/ci_cd.html":{"url":"public/ci_cd/ci_cd.html","title":"ğŸ“– ï¸CICD","keywords":"","body":"CIï¼CD ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. CICDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ãƒ»CICDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ã¯ Commitã‹ã‚‰æœ¬ç•ªç’°å¢ƒã¸ã®Deployã¾ã§ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€ç¶™ç¶šçš„ã«ã€è¡Œã†ã“ã¨ã‚’ã€CIï¼šContinuous Integrationã€ã¨ã„ã†ã€‚ã¾ãŸã€å¤‰æ›´å†…å®¹ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒãªã©ã«è‡ªå‹•çš„ã«åæ˜ ã—ã€ã€ç¶™ç¶šçš„ã«ã€ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã“ã¨ã‚’ã€CDï¼šContinuous Deliveryã¨ã„ã†ã€‚ ãƒ»è‡ªå‹•åŒ–ã§ãã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã¨ã§ããªã„ãƒ—ãƒ­ã‚»ã‚¹ ãƒ—ãƒ­ã‚»ã‚¹ è‡ªå‹•åŒ–ã®å¯å¦ èª¬æ˜ Build ã€‡ CI/CDãƒ„ãƒ¼ãƒ«ã¨IaCãƒ„ãƒ¼ãƒ«ã§è‡ªå‹•åŒ–å¯èƒ½ Unitãƒ†ã‚¹ãƒˆã€Functionalãƒ†ã‚¹ãƒˆ ã€‡ CI/CDãƒ„ãƒ¼ãƒ«ã¨ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§è‡ªå‹•åŒ–å¯èƒ½ã€‚ Integrationãƒ†ã‚¹ãƒˆ âœ• ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸ã‚’ä½œæˆã—ã€å‹•ä½œã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«é–¢ã™ã‚‹Review ã€‡ CI/Cdãƒ„ãƒ¼ãƒ«ã¨é™çš„è§£æãƒ„ãƒ¼ãƒ« ä»•æ§˜ã«é–¢ã™ã‚‹Review âœ• GitHubä¸Šã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ ã€‡ CI/CDãƒ„ãƒ¼ãƒ«ã§è‡ªå‹•åŒ–å¯èƒ½ã€‚ æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ ã€‡ CI/CDãƒ„ãƒ¼ãƒ«ã§è‡ªå‹•åŒ–å¯èƒ½ã€‚ "},"public/ci_cd/ci_cd_circleci.html":{"url":"public/ci_cd/ci_cd_circleci.html","title":"ğŸ“– ï¸CircleCI","keywords":"","body":"CircleCI ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. CircleCIã¨ã¯ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ https://circleci.com/docs/reference-2-1/#circleci-2-1-reference è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒãƒƒã‚° ãƒ»ãƒ‡ãƒãƒƒã‚°ã®äº‹å‰æº–å‚™ ãƒ‡ãƒãƒƒã‚°ã§ã¯è¡Œæ•°ãŒã‚ã‹ã‚‰ãªã„ä»•æ§˜ã«ãªã£ã¦ã„ã‚‹ã€‚ãã“ã§ã€Workflowã®jobã®ã©ã“ã§å¤±æ•—ã—ã¦ã„ã‚‹ã®ã‹ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ã€æ¤œè¨¼ã—ãªã„jobã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãŠãã€‚ workflows: # buildä»¥å¤–ã‚’å®Ÿè¡Œã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã€buildã®ã¿ã‚’æ¤œè¨¼ã§ãã‚‹ã€‚ build-test-and-deploy: jobs: - build # - test1: # requires: # - build # - test2: # requires: # - test1 # - deploy: # requires: # - test2 ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ›ã‚¹ãƒˆOSå´ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ circleci config validate # ä»¥ä¸‹ã®æ–‡ç« ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°å•é¡Œãªã„ã€‚ # Config file at .circleci/config.yml is valid. ãƒ»å‡¦ç†ã®å±•é–‹ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã—ãŸæ™‚ã®å‡¦ç†ã‚’å±•é–‹ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã§ãã‚‹ $ circleci config process .circleci/config.yml > .circleci/process.yml ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚Šã€ãƒ†ã‚¹ãƒˆã«å¿…è¦ãªDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’pullã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ç¶šã„ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§CircleCIã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.1ä»¥é™ã§ã¯ã€äº‹å‰ã«ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ã‚’å±•é–‹ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ # ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.1ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ã‚’å±•é–‹ $ circleci config process .circleci/config.yml > .circleci/process.yml # å°‚ç”¨ã®Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã—ã€å±•é–‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ $ circleci local execute -c .circleci/process.yml --job ãƒ»CircleCIã‚³ãƒ³ãƒ†ãƒŠã«sshæ¥ç¶š CircleCIã‚³ãƒ³ãƒ†ãƒŠã«sshæ¥ç¶šã—ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã§ãã‚‹ã€‚ $ -i ~/.ssh/ ãƒ»Test Insights å„ãƒ†ã‚¹ãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚„æˆåŠŸå¤±æ•—ç‡ã‚’ç¢ºèªã§ãã‚‹ã€‚ https://circleci.com/docs/2.0/insights-tests/ PHPUnitã®è‡ªå‹•å®Ÿè¡Œ ãƒ»ä»•çµ„ã¿ ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ãŸã†ãˆã§ã€æ–°æ©Ÿèƒ½ã‚’è¨­è¨ˆå®Ÿè£…ã™ã‚‹ã€‚ ãƒªãƒã‚¸ãƒˆãƒªã¸Pushã™ã‚‹ã¨ã€CIãƒ„ãƒ¼ãƒ«ãŒGituHubã‹ã‚‰ãƒ–ãƒ©ãƒ³ãƒã®çŠ¶æ…‹ã‚’å–å¾—ã™ã‚‹ã€‚ CIãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦ã€DockerHubã‹ã‚‰å–å¾—ã—ãŸDockerfileã®ãƒ“ãƒ«ãƒ‰ã€PHPUnitãªã©ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ çµæœã‚’é€šçŸ¥ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã€‚ PHPStanã®è‡ªå‹•å®Ÿè¡Œ ãƒ»ä»•çµ„ã¿ 02-02. version versionã¨ã¯ CircleCIã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å®£è¨€ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 02-03. parameters parameters ãƒ»parametersã¨ã¯ ç¨®é¡ å‚ç…§ç¯„å›² å€¤ã‚’è¨­å®šã™ã‚‹å ´æ‰€ command parameters commandå†…ã§å®šç¾©ã™ã‚‹ã€‚å®šç¾©ã•ã‚ŒãŸcommandå†…ã®ã¿ã§å®šç¾©ã§ãã‚‹ã€‚ workflows job parameters jobå†…ã§å®šç¾©ã™ã‚‹ã€‚å®šç¾©ã•ã‚ŒãŸjobå†…ã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚ workflows executors parameter executorså†…ã§å®šç¾©ã™ã‚‹ã€‚å®šç¾©ã•ã‚ŒãŸexecutoså†…ã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚ job pipeline parameters ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§å®šç¾©ã™ã‚‹ã€‚ãƒªãƒã‚¸ãƒˆãƒªå†…ã§ã®ã¿å‚ç…§ã§ãã‚‹ã€‚ workflows command parameters ãƒ»å€¤ã®å‡ºåŠ›æ–¹æ³• å¼•æ•°åã‚’ç”¨ã„ã¦ã€parametersã‹ã‚‰å€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ > ãƒ»job parameterã‚’å‚ç…§ å®šç¾©ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã¯ã€job parameterã¨åŒã˜ã€‚å®šç¾©ã•ã‚ŒãŸcommandå†…ã®ã¿ã§å®šç¾©ã§ãã‚‹ã€‚ version: 2.1 commands: sayhello: description: \"Echo hello world\" # å¼•æ•°ã®å®šç¾© parameters: to: type: string # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ default: \"Hello World\" steps: - run: echo > job parameters ãƒ»å€¤ã®å‡ºåŠ›æ–¹æ³• å¼•æ•°åã‚’ç”¨ã„ã¦ã€parametersã‹ã‚‰å€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ > ãƒ»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ã¤ã„ã¦ å¼•æ•°ãŒä¸ãˆã‚‰ã‚Œãªã‹ã£ãŸå ´åˆã«é©ç”¨ã•ã‚Œã‚‹defaultã‚’è¨­å®šã§ãã‚‹ã€‚defaultã‚’è¨­å®šã—ãªã„å ´åˆã€å¼•æ•°ãŒå¿…é ˆã¨è¦‹ãªã•ã‚Œã‚‹ã€‚ version: 2.1 commands: sayhello: description: \"Echo hello world\" parameters: to: type: string default: \"Hello World\" steps: - run: echo > ãƒ»stringå‹ å¼•æ•°ã¨ã—ã¦ã€ä»»æ„ã®æ–‡å­—åˆ—ã‚’æ¸¡ã—ãŸã„ã¨ãã«ç”¨ã„ã‚‹ã€‚workflowsã«ã¦ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 commands: print: # å¼•æ•°ã‚’å®šç¾© parameters: message: # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒç„¡ã„å ´åˆã¯å¿…é ˆ type: string steps: - run: echo > jobs: cat-file: parameters: file: type: string steps: - print: # parametersã®å€¤ã‚’æ¸¡ã™ message: Printing > - run: cat > workflows: my-workflow: jobs: - cat-file: # workflowã«ã¦æ–‡å­—åˆ—å‹ã®å€¤ã‚’è¨­å®š file: test.txt ãƒ»booleanå‹ å¤šãã®å ´åˆã€å¼•æ•°ãŒTrueã®å ´åˆã®ã¿ã€ç‰¹å®šã®stepã‚’å®Ÿè¡Œã—ãŸã„æ™‚ã«ç”¨ã„ã‚‹ã€‚jobã§å®šç¾©ã—ãŸå¾Œã€workflowsã«ã¦å€¤ã‚’è¨­å®šã™ã‚‹ã€‚workflowsã«ã¦ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: job_with_optional_custom_checkout: # å¼•æ•°ã®å®šç¾© parameters: custom_checkout: type: boolean # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ default: false machine: true steps: - when: # å¼•æ•°ãŒtrueã®å ´åˆ condition: > steps: - run: echo \"my custom checkout\" - unless: # å¼•æ•°ã®falseã®å ´åˆ condition: > steps: - checkout workflows: build-test-deploy: jobs: - job_with_optional_custom_checkout: # workflowã«ã¦boolå‹ã®å€¤ã‚’è¨­å®š custom_checkout: true ãƒ»enumå‹ å¼•æ•°ã¨ã—ã¦ã€ç‰¹å®šã®æ–‡å­—åˆ—ã‚„æ•´æ•°ã®ã¿ã‚’æ¸¡ã—ãŸã„ã¨ãã«ç”¨ã„ã‚‹ã€‚workflowsã«ã¦ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: deploy: parameters: # å¼•æ•°ã‚’å®šç¾© environment: # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ default: \"test\" type: enum enum: [\"test\", \"stg\", \"prd\"] steps: - run: # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤testã‚’ä¸ãˆã‚‹ã¨ãã¯ä½•ã‚‚è¨­å®šã—ãªã„ name: Deploy to > command: # ä½•ã‚‰ã‹ã®å‡¦ç† workflows: deploy: jobs: - deploy: # workflowã«ã¦enumå‹ã®å€¤ã‚’è¨­å®š environment: stg executors parameter ãƒ»å€¤ã®å‡ºåŠ›æ–¹æ³• å¼•æ•°åã‚’ç”¨ã„ã¦ã€parametersã‹ã‚‰å€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ > ãƒ»job parametersã‚’å‚ç…§ å¼•æ•°ã¨ã—ã¦ã€ä»»æ„ã®æ–‡å­—åˆ—ã‚’executorsã«æ¸¡ã—ãŸã„ã¨ãã«ç”¨ã„ã‚‹ã€‚ä»–ã®parametersã¨ã¯ç•°ãªã‚Šã€jobã«ã¦ã€å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ version: 2.1 executors: python: # å¼•æ•°ã®å®šç¾© parameters: tag: type: string # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ default: latest myspecialvar: type: string docker: - image: circleci/python:> environment: MYPRECIOUS: > jobs: build: executor: name: python tag: \"2.7\" # jobã«ã¦æ–‡å­—åˆ—å‹ã®å€¤ã‚’è¨­å®š myspecialvar: \"myspecialvalue\" ãƒ»workflowã§å€¤ã‚’è¨­å®šã™ã‚‹ å…¬å¼ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«ã¯è¼‰ã£ã¦ã„ãªã„ãŸã‚ã€æ–¹æ³•ã¨ã—ã¦ã¯éæ¨å¥¨ã€‚parameterã‚’æ¸¡ã—ãŸã„executorã‚’ä½¿ã„ã¾ã‚ã—ãŸã„æ™‚ã«ç”¨ã„ã‚‹ã€‚ version: 2.1 executors: python: # å¼•æ•°ã®å®šç¾© parameters: env: type: enum enum: [ \"2.7\", \"3.5\" ] myspecialvar: type: string docker: - image: circleci/python:> environment: MYPRECIOUS: > jobs: build: # å¼•æ•°ã®å®šç¾© parameters: # executorã‚’ãƒ‡ãƒ¼ã‚¿å‹ã¨ã—ã¦é¸æŠ executor_param: type: executor executor: > workflows: version: 2.1 build-push: jobs: - build: # jobã«ã¦executoråã‚’è¨­å®šã—ã€ã•ã‚‰ã«executorã«å€¤ã‚’æ¸¡ã™ executor_param: name: python # ãƒãƒ¼ã‚¸ãƒ§ãƒ³3.5ã‚’è¨­å®š tag: \"2.7\" myspecialvar: \"myspecialvalue\" - build: executor_param: name: python # ãƒãƒ¼ã‚¸ãƒ§ãƒ³3.5ã‚’è¨­å®š tag: \"3.5\" myspecialvar: \"myspecialvalue\" pipeline parameters ãƒ»å€¤ã®å‡ºåŠ›æ–¹æ³• å¼•æ•°åã‚’ç”¨ã„ã¦ã€pipeline.parametersã‹ã‚‰å€¤ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ > ãƒ»job parametersã‚’å‚ç…§ å®šç¾©ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã¯ã€job parameterã¨åŒã˜ã€‚ãƒªãƒã‚¸ãƒˆãƒªå†…ã§ã®ã¿å‚ç…§ã§ãã‚‹ã€‚ version: 2.1 parameters: # å¼•æ•°ã‚’å®šç¾© image-tag: type: string # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ default: \"latest\" workingdir: type: string default: \"~/main\" jobs: build: docker: - image: circleci/node:> auth: username: mydockerhub-user password: $DOCKERHUB_PASSWORD environment: IMAGETAG: > working_directory: > steps: - run: echo \"Image tag used was ${IMAGETAG}\" - run: echo \"$(pwd) == >\" workflows: my-workflow: jobs: - build: # å¼•æ•°å: æ¸¡ã™å€¤ image-tag: \"1.0\" workdir: \"/tmp\" 02-04. jobs jobs ãƒ»jobsã¨ã¯ è¤‡æ•°ã®jobã‚’å®šç¾©ã™ã‚‹ã€‚Workflowsã‚’ä½¿ã‚ãªã„å ´åˆã¯ã€å°‘ãªãã¨ã‚‚ä¸€ã¤ã®jobã«ã¯buildã¨ã„ã†åå‰ã‚’ä½¿ç”¨ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ ãƒ»jobã®ç²’åº¦ ç²’åº¦ èª¬æ˜ å‚™è€ƒ build ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ã€‚ buildã¨testã‚’åˆ†å‰²ã—ã«ãã„å ´åˆã¯ã€åŒã˜jobã§å®šç¾©ã—ã¦ã‚‚ã‚ˆã„ã€‚ test ç¨®ã€…ã®ãƒ†ã‚¹ãƒˆï¼ˆUnitãƒ†ã‚¹ãƒˆã€Functionalãƒ†ã‚¹ãƒˆã€ãªã©ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ deploy ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã¾ãŸã¯æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ dockerã€machine ãƒ»ä»®æƒ³ç’°å¢ƒã®é¸æŠ jobã‚’å®Ÿè¡Œã™ã‚‹ä»®æƒ³ç’°å¢ƒã‚’é¸æŠã§ãã‚‹ã€‚ ãƒ»dockerã‚¿ã‚¤ãƒ—ã¨ã¯ Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œç’°å¢ƒã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚ã“ã‚Œã‚’é¸æŠã—ãŸã†ãˆã§ã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ï¼ˆDocker composeã‚’å«ã‚€ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã€å®Ÿè¡Œç’°å¢ƒDockerã‚³ãƒ³ãƒ†ãƒŠã®ä¸­ã§Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã™ã‚‹ã¨ã„ã†å…¥ã‚Œå­æ§‹é€ ã«ãªã‚‹ã€‚ã“ã‚Œã¯éæ¨å¥¨ã®ãŸã‚ã€setup_remote_dockerã‚’ç”¨ã„ã¦ã€å®Ÿè¡Œç’°å¢ƒDockerã‚³ãƒ³ãƒ†ãƒŠã¨ã¯åˆ¥ã®ç’°å¢ƒã§jobã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚ã¾ãŸã€dockerã‚³ãƒãƒ³ãƒ‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã§åˆã£ãŸå ´åˆã€setup_remote_dockerã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã¨ã€ã“ã‚Œã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚machineã‚¿ã‚¤ãƒ—ã‚’é¸ã‚“ã å ´åˆã€setup_remote_dockerã¯ä¸è¦ã§ã‚ã‚‹ã€‚ãŸã ã—ã€ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã§ããªããªã‚‹ã®ã§æ³¨æ„ã™ã‚‹ã€‚ã¾ãŸã€Dockerfileã®COPYã‚³ãƒãƒ³ãƒ‰ãŒæ©Ÿèƒ½ã—ãªããªã‚‹ã€‚ å‚è€ƒï¼šhttps://circleci.com/docs/ja/2.0/building-docker-images/ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: build: docker: - image: circleci/foo steps: - checkout # ã‚³ãƒ³ãƒ†ãƒŠãŒå…¥ã‚Œå­ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ - setup_remote_docker - run: | # DockerHubã¸ã®ãƒ­ã‚°ã‚¤ãƒ³ echo \"$DOCKER_PASS\" | docker login --username $DOCKER_USER --password-stdin docker run -d --name db company/proprietary-db:1.2.3 # Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ - run: docker build -t company/app:$CIRCLE_BRANCH . # Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®DockerHubã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ - run: docker push company/app:$CIRCLE_BRANCH ãƒ»machineã‚¿ã‚¤ãƒ—ã¨ã¯ Linuxã‚µãƒ¼ãƒã‚’å®Ÿè¡Œç’°å¢ƒã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: build: machine: true steps: - checkout - run: | # DockerHubã¸ã®ãƒ­ã‚°ã‚¤ãƒ³ echo \"$DOCKER_PASS\" | docker login --username $DOCKER_USER --password-stdin docker run -d --name db company/proprietary-db:1.2.3 # Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ - run: docker build -t company/app:$CIRCLE_BRANCH . # Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®DockerHubã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ - run: docker push company/app:$CIRCLE_BRANCH steps ãƒ»stepsã¨ã¯ å‡¦ç†ã‚’Mapå‹ã§å®šç¾©ã™ã‚‹ã€‚ ãƒ»whenã€unless ifæ–‡ã‚’å®šç¾©ã™ã‚‹ã€‚whenã§ã¯æ¡ä»¶ãŒtrueã®å ´åˆã€ã¾ãŸunlessã§ã¯falseã®å ´åˆã«å®Ÿè¡Œã™ã‚‹stepã‚’å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: custom_checkout: parameters: custom_checkout_parameters: type: bool # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯false default: false machine: true steps: # å¼•æ•°ãŒtrueã®å ´åˆ - when: condition: > steps: - run: echo \"ç‹¬è‡ªã®ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆå‡¦ç†\" # å¼•æ•°ãŒfalseã®å ´åˆ - unless: condition: > steps: - checkout workflows: version: 2.1 build-test-deploy: jobs: - custom_checkout: # å¼•æ•°å: æ¸¡ã™å€¤ custom_checkout_parameters: true ãƒ»restore_cacheã€save_cache ãƒ“ãƒ«ãƒ‰ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆã™ã‚‹ã€‚ã“ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ãªã„å ´åˆã€ä¾‹ãˆã°ã€CircleCIã‚³ãƒ³ãƒ†ãƒŠã§composer installã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æ¯å›ã®Workflowã§åŒã˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚ã—ã‹ã—ã€Workflowã®ãŸã³ã«ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ã¯éåŠ¹ç‡ã§ã‚ã‚‹ã€‚ãã“ã§ã€composer.jsonãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè£…ãŒå¤‰æ›´ã•ã‚Œãªã„é™ã‚Šã€å‰å›ã®Workflowã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ã€vendorãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚ŒãŸã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’å†åˆ©ç”¨ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã®æ©Ÿèƒ½ã¯ã€è¤‡æ•°ã®Workflowã®é–“ã ã‘ã§ãªãã€ä¸€ã¤ã®Workflowã®ä¸­ã§ã‚‚åˆ©ç”¨ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://circleci.com/docs/ja/2.0/caching/#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5 ï¼Šå®Ÿè£…ä¾‹ï¼Š composerã‚’ç”¨ã„ã¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ™‚ã«ã€å‰å›ã®çµæœã‚’å†åˆ©ç”¨ã™ã‚‹ã€‚ version: 2.1 jobs: build: steps: # composer.jsonãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ã€‚ - restore_cache: key: - v1-dependecies-{{ checksum \"composer.json\" }} - v1-dependencies- # å–å¾—ã—ãŸcomposer.jsonã‚’å…ƒã«ã€å·®åˆ†ã®vendorã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« - run: name: Run composer install commands: | composer install -n --prefer-dist # æœ€æ–°ã®vendorãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½œæˆ - save_cache: key: v1-dependecies-{{ checksum \"composer.json\" }} paths: - ./vendor ï¼Šå®Ÿè£…ä¾‹ï¼Š yarnã‚’ç”¨ã„ã¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ™‚ã«ã€å‰å›ã®çµæœã‚’å†åˆ©ç”¨ã™ã‚‹ã€‚ version: 2.1 jobs: build_and_test: docker: - image: circleci/python:3.8-node steps: - checkout - restore_cache: keys: - v1-dependencies-{{ checksum \"package.json\" }} - v1-dependencies- - run: name: Run yarn install commands: | yarn install - save_cache: paths: - node_modules key: v1-dependencies-{{ checksum \"yarn.lock\" }} - run: name: Run yarn build commands : | yarn build - run: name: Run yarn test commands : | yarn test ãŸã ã€ã“ã®æ©Ÿèƒ½ã¯commandsã§å…±é€šåŒ–ã—ãŸæ–¹ãŒå¯èª­æ€§ãŒè‰¯ã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 commands: restore_vendor: steps: # composer.jsonã®å®Ÿè£…ãŒå¤‰æ›´ã•ã‚Œã¦ã„ãªã„å ´åˆã¯å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ã€‚ - restore_cache: key: - v1-dependencies-{{ checksum \"composer.json\" }} - v1-dependencies- save_vendor: steps: # æœ€æ–°ã®vendorã‚’ä¿å­˜ã€‚ - save_cache: key: v1-dependencies-{{ checksum \"composer.json\" }} paths: - ./vendor jobs: build: steps: - restore_vendor # å–å¾—ã—ãŸcomposer.jsonã‚’å…ƒã«ã€å·®åˆ†ã®vendorã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« - run: name: Run composer install commands: | composer install -n --prefer-dist - save_vendor ãƒ»persist_to_workspaceã€attach_workspace CircleCIã§ã¯ã€jobã”ã¨ã«ç•°ãªã‚‹ä»®æƒ³ç’°å¢ƒãŒæ§‹ç¯‰ã•ã‚Œã‚‹ãŸã‚ã€ä»–ã®jobã§ä½¿ç”¨ã•ã‚ŒãŸä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†åˆ©ç”¨ã—ãŸã„å ´åˆã€ã“ã‚Œã‚’ä½¿ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: jobA: steps: # Workspaceã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ - persist_to_workspace: # jobAã«ã¦ã€Workspaceã¨ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®root root: /tmp/workspace # Rootãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åŸºæº–ã¨ã—ãŸç›¸å¯¾ãƒ‘ã‚¹ï¼ˆ\"./\"ä»¥å¤–ã®å ´åˆã¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆãŒå¿…è¦ï¼‰ # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦å‡ºåŠ›ã§ããªã„ã®ã§æ³¨æ„ paths: - target/application.jar - build/* jobB: steps: # persist_to_workspaceã§ä½œæˆã•ã‚ŒãŸWorkspaceã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ - attach_workspace: # jobAã¨ã¯ç•°ãªã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ã‚ˆã„ at: /tmp/workspace å…¨ã¦ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä¿æŒã™ã‚‹ã‚ˆã†ãªå ´åˆãŒã»ã¨ã‚“ã©ã¨æ€ã‚ã‚Œã‚‹ãŸã‚ã€ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ï¼ˆ.ï¼‰ã‚’æŒ‡å®šã™ã‚‹ã®ãŒã‚ˆã„ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: jobA: steps: - persist_to_workspace: root: . paths: - . jobB: steps: - attach_workspace: at: . 02-04. commands commandsã¨ã¯ è¨­å®šã‚’éƒ¨å“åŒ–ã—ã€ç•°ãªã‚‹jobã§stepã¨ã—ã¦ç¹°ã‚Šè¿”ã—åˆ©ç”¨ã§ãã‚‹ã€‚ éƒ¨å“åŒ–ã¨å†åˆ©ç”¨ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 commands: sayhello: description: \"Echo hello world\" parameters: text: type: string default: \"Hello World\" steps: # parametersã®å€¤ã‚’æ¸¡ã™ - run: echo > jobs: myjob: docker: - image: \"circleci/node:9.6.1\" steps: # commandå - sayhello: # å¼•æ•°å: æ¸¡ã™å€¤ text: \"Lev\" 02-05. executors executors ãƒ»executorsã¨ã¯ å®Ÿè¡Œç’°å¢ƒã«é–¢ã™ã‚‹è¨­å®šã‚’éƒ¨å“åŒ–ã—ã€ç•°ãªã‚‹jobã§ç¹°ã‚Šè¿”ã—åˆ©ç”¨ã§ãã‚‹ã€‚ éƒ¨å“åŒ–ã¨å†åˆ©ç”¨ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 executors: # ãƒ›ã‚¹ãƒˆOSç’°å¢ƒå my-executor: # ãƒ›ã‚¹ãƒˆOSç’°å¢ƒ docker: - image: circleci/ruby:2.5.1-node-browsers working_directory: ~/foo_project environment: XX: xx YY: yy jobs: my-job: executor: my-executor steps: - run: echo \"${XX}ã¨${YY}ã§ã™\" 02-06. Workflow Workflowã®ç²’åº¦ ãƒ»ãƒ–ãƒ©ãƒ³ãƒåˆ¥ ï¼Šå®Ÿè£…ä¾‹ï¼Š workflows: # Featureãƒ–ãƒ©ãƒ³ãƒã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ feature: jobs: - build: name: build_feat filters: branches: only: - /feature.*/ - test: name: test_feat requires: - build_feat # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop: jobs: - build: name: build_stg filters: branches: only: - develop - test: name: test_stg requires: - build_stg - deploy: name: deploy_stg requires: - test_stg # æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main: jobs: - build: name: build_prd filters: branches: only: - main - test: name: test_prd requires: - build_prd - deploy: name: deploy_prd requires: - test_prd ç‰¹æ®Šãªsteps ãƒ»pre-stepsã€post-steps äº‹å‰ã«jobã«å®šç¾©ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚workspaceã§ã€ã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹jobã®å¼•æ•°ã¨ã—ã¦è¨­å®šã™ã‚‹ã“ã¨ã§ã€ãã®jobå†…ã®æœ€åˆã¨æœ€å¾Œã«ã€stepsã‚’è¿½åŠ ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: bar: machine: true steps: - checkout - run: command: echo \"building\" - run: command: echo \"testing\" workflows: build: jobs: - bar: # Workspaceå‰ã«è¡Œã†å‡¦ç† pre-steps: - run: command: echo \"install custom dependency\" # Workspaceå¾Œã«è¡Œã†å‡¦ç† post-steps: - run: command: echo \"upload artifact to s3\" Orbsã‚’ä½¿ã†å ´åˆã¯ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«å¼•æ•°ã‚’æ¸¡ã™å‰ã«å®šç¾©ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š workflows: build: jobs: - aws-foo/build-push-yyy: # Workspaceå‰ã«è¡Œã†å‡¦ç† pre-steps: - run: command: echo \"FOO\" # Workspaceå¾Œã«è¡Œã†å‡¦ç† post-steps: - run: command: echo \"FOO\" # Orbsã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ name: foo dockerfile: foo tag: foo filters ãƒ»filtersã¨ã¯ ã‚³ãƒŸãƒƒãƒˆã•ã‚ŒãŸæ™‚ã«jobãŒç™ºç«ã™ã‚‹ãƒ–ãƒ©ãƒ³ãƒåã€ã‚ã‚‹ã„ã¯ç™ºç«ã—ãªã„ãƒ–ãƒ©ãƒ³ãƒåã€ã‚’è¨­å®šã™ã‚‹ã€‚æ­£è¦è¡¨ç¾ã§å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»onlyã€ignore ã‚ˆãã‚ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ èª¬æ˜ /.*/ å…¨ã¦ã®ãƒ–ãƒ©ãƒ³ãƒã‚’æ˜ç¤ºçš„ã«æŒ‡å®š /feature\\/.*/ ã€feature/ã€ã¨åå‰ã®ã¤ã„ãŸãƒ–ãƒ©ãƒ³ãƒã‚’æŒ‡å®š ï¼Šå®Ÿè£…ä¾‹ï¼Š workflows: version: 2.1 build: jobs: - foo: filters: branches: only: - /.*/ workflows: version: 2.1 build: jobs: - foo: filters: branches: ignore: - /feature\\/.*/ ãƒ»tags ã‚¿ã‚°ã‚’ã¤ã‘ãŸã‚³ãƒŸãƒƒãƒˆã«å¯¾ã—ã¦ç™ºç«ã™ã‚‹ã€‚ignoreã‚­ãƒ¼ã§å…¨ã¦ã®ãƒ–ãƒ©ãƒ³ãƒã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ãƒãƒ¼ã‚¸ã«ã‚ˆã‚‹ç™ºç«ã‚’é˜²ã’ã‚‹ã€‚ workflows: version: 2.1 build: jobs: - foo: filters: branches: ignore: /.*/ tags: only: /release\\/.*/ 02-07. ç’°å¢ƒå¤‰æ•° CircleCIã«ãŠã‘ã‚‹ç’°å¢ƒå¤‰æ•°ã¨ã¯ ãƒ»ç’°å¢ƒå¤‰æ•°ã®ç¨®é¡ã¨å‚ç…§ç¯„å›² å‚ç…§ãƒ¬ãƒ™ãƒ« æ–¹æ³• èª¬æ˜ Bash exportã€sourceã€$BASH_ENV runã«ãŠã‘ã‚‹commandå†…ã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚ãŸã ã—ã€$BASH_ENVã‚’ç”¨ã„ã‚Œã°ã€ç•°ãªã‚‹commandsé–“ã§å€¤ã‚’å…±æœ‰å¯èƒ½ã€‚ Container environment jobå†…ã®ç‰¹å®šã®ã‚³ãƒ³ãƒ†ãƒŠã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚ Job environment jobå†…ã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚ Project Environment Variablesæ©Ÿèƒ½ ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ã¿å‚ç…§ã§ãã‚‹ã€‚ Global Contextsæ©Ÿèƒ½ ç•°ãªã‚‹ãƒªãƒã‚¸ãƒˆãƒªé–“ã§å‚ç…§ã§ãã‚‹ã€‚ ãƒ»ç’°å¢ƒå¤‰æ•°ã®å‡ºåŠ›æ–¹æ³• ç’°å¢ƒå¤‰æ•°ã‚’echoã®å¼•æ•°ã«è¨­å®šã™ã‚‹ã€‚ã‚ã‚‰ã‹ã˜ã‚ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸç’°å¢ƒå¤‰æ•°ã‚’ç®¡ç†ã—ã¦ãŠãã€base64 --decodeã‚’å®Ÿè¡Œã—ã¦å‡ºåŠ›ã™ã‚‹ã¨ã€å®‰å…¨ã«ç’°å¢ƒå¤‰æ•°ã‚’ç®¡ç†ã§ãã‚‹ã€‚ã“ã“ã§å‡ºåŠ›ã—ã¦ã„ã‚‹ç’°å¢ƒå¤‰æ•°ã¯ã€ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆã‚’å‚è€ƒã«ã›ã‚ˆ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/software/software_application_object_oriented_language_js_framework_nuxtjs.html jobs: build_and_ docker: - image: circleci/python:3.8-node steps: - checkout - run: name: Make env file command: | echo $API_URL_BROWSER | base64 --decode > .env echo $API_URL | base64 --decode >> .env echo $OAUTH_CLIENT_ID | base64 --decode >> .env echo $OAUTH_CLIENT_SECRET | base64 --decode >> .env echo $GOOGLE_MAP_QUERY_URL | base64 --decode >> .env - run: name: Install node module commands: | yarn install - run: name: Generate nuxt-ts commands: | yarn nuxt-ts generate ãªãŠã€æ–‡å­—åˆ—ã®ä¸­ã«å€¤ã‚’å‡ºåŠ›ã™ã‚‹å¤‰æ•°å±•é–‹ã®å ´åˆã€${}ã‚’ç”¨ã„ã‚‹ã€‚ # å¤‰æ•°å±•é–‹ã®å ´åˆ steps: - checkout - run: name: FOO commands: | echo \"This is ${FOO}\" Bashãƒ¬ãƒ™ãƒ« ãƒ»commandã‚­ãƒ¼ã«ã‚ˆã‚‹è¨­å®š ä¸€ç•ªå‚ç…§ç¯„å›²ãŒå°ã•ãã€runã«ãŠã‘ã‚‹åŒã˜commandå†…ã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚commandå†…ã§ç”¨ã„ã‚‹ç’°å¢ƒå¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã¯ã€ã€$BASH_ENVã€ã«exportå‡¦ç†ã‚’æ ¼ç´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å®šç¾©ã—ãŸã‚‚ã®ã‚’ç”¨ã„ã‚‹ãŸã‚ã«ã¯ã€ã€$BASH_ENVã€ã‚’sourceã§èª­ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚‹ãŸã‚ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://circleci.com/docs/ja/2.0/env-vars/#%E3%82%B7%E3%82%A7%E3%83%AB-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%A7%E3%81%AE%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%81%AE%E8%A8%AD%E5%AE%9A ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: build: docker: - image: smaant/lein-flyway:2.7.1-4.0.3 auth: username: mydockerhub-user password: $DOCKERHUB_PASSWORD steps: - run: name: Update PATH and Define Environment Variable at Runtime command: | echo \"export PATH=/path/to/foo/bin:$PATH\" >> $BASH_ENV echo \"export VERY_IMPORTANT=$(cat important_value)\" >> $BASH_ENV source $BASH_ENV echo \"$PATH\" echo \"$VERY_IMPORTANT\" CircleCIã§ã¯runã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã«ã€$BASH_ENVã€ãŒsourceã§è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€ã€$BASH_ENVã€ã¯è¤‡æ•°ã®runé–“ã€ã§å…±æœ‰ã§ãã‚‹ã€‚ãŸã ã—ã€Alpineãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã¯ã€ã“ã®å…±æœ‰æ©Ÿèƒ½ã‚’ä½¿ãˆãªã„ãŸã‚æ³¨æ„ã™ã‚‹ï¼ˆã‹ãªã‚ŠãŸãã•ã‚“ã‚ã‚‹ï¼‰ã€‚ å‚è€ƒï¼šhttps://github.com/circleci/circleci-docs/issues/1650 version: 2.1 jobs: build: docker: - image: smaant/lein-flyway:2.7.1-4.0.3 auth: username: mydockerhub-user password: $DOCKERHUB_PASSWORD steps: - run: name: Update PATH and Define Environment Variable at Runtime command: | echo \"export PATH=/path/to/foo/bin:$PATH\" >> $BASH_ENV echo \"export VERY_IMPORTANT=$(cat important_value)\" >> $BASH_ENV - run: name: Echo # BASH_ENVãŒè‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚ command: | echo \"$PATH\" echo \"$VERY_IMPORTANT\" ãƒ»ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹è¨­å®š ç’°å¢ƒå¤‰æ•°ã«å€¤ã‚’è¨­å®šã™ã‚‹å‡¦ç†ã‚’ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«åˆ‡ã‚Šåˆ†ã‘ã€ç’°å¢ƒå¤‰æ•°ã‚’ç”¨ã„ã‚‹å‰ã«ã“ã‚Œã‚’èª­ã¿è¾¼ã‚€ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: build: docker: - image: smaant/lein-flyway:2.7.1-4.0.3 auth: username: mydockerhub-user password: $DOCKERHUB_PASSWORD steps: - run: name: Update PATH and Define Environment Variable at Runtime command: | source export_envs.sh echo \"$PATH\" echo \"$VERY_IMPORTANT\" #!/bin/bash set -xeuo pipefail echo \"export PATH=/path/to/foo/bin:$PATH\" >> $BASH_ENV echo \"export VERY_IMPORTANT=$(cat important_value)\" >> $BASH_ENV # ç’°å¢ƒå¤‰æ•°ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ source $BASH_ENV ãƒ»ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ä½œæˆã—ãŸã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹è¨­å®š ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã€ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã§ãã‚‹ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã€ã“ã‚Œã‚’èª­ã¿è¾¼ã‚€ã€‚ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€å„è¡Œã§echoãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€echoã®å®Ÿè£…ãŒä¸è¦ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š cat \"export_envs.sh\" #!/bin/bash set -xeuo pipefail \"export PATH=/path/to/foo/bin:$PATH\" >> $BASH_ENV \"export VERY_IMPORTANT=$(cat important_value)\" >> $BASH_ENV source $BASH_ENV EOF Containerãƒ¬ãƒ™ãƒ« Bashãƒ¬ãƒ™ãƒ«ã‚ˆã‚Šå‚ç…§ç¯„å›²ãŒå¤§ããã€jobå†…ã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚environmentã‚’imageã¨åŒã˜éšå±¤ã§å®šç¾©ã™ã‚‹ã€‚ version: 2.1 jobs: build: docker: - image: postgres:9.4.1 # imageã¨åŒã˜éšå±¤ã§å®šç¾©ï¼ˆï¼‰ environment: POSTGRES_USER: root Projectãƒ¬ãƒ™ãƒ« Containerãƒ¬ãƒ™ãƒ«ã‚ˆã‚Šå‚ç…§ç¯„å›²ãŒå¤§ããã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã€ã™ãªã‚ã¡ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ã¿ã§å‚ç…§ã§ãã‚‹ã€‚Environment Variablesæ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã®å€¤ãŒï¼”æ–‡å­—æœªæº€ã€ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ã®å€¤ãŒ trueã€Trueã€falseã€False ã®ã„ãšã‚Œã‹ã®å ´åˆã€CircleCIã®å‡¦ç†ã§å‡ºåŠ›ã•ã‚Œã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç’°å¢ƒå¤‰æ•°ã¯ãƒã‚¹ã‚­ãƒ³ã‚°ã•ã‚Œãªã„ãŸã‚ã€æ³¨æ„ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ Grobalãƒ¬ãƒ™ãƒ« Projectãƒ¬ãƒ™ãƒ«ã‚ˆã‚Šå‚ç…§ç¯„å›²ãŒå¤§ããã€ç•°ãªã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“ã€ã™ãªã‚ã¡ãƒªãƒã‚¸ãƒˆãƒªé–“ã§å‚ç…§ã§ãã‚‹ã€‚Contextsæ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ã€‚ 02-08. Docker Compose in CircleCI docker-composeã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ãƒ»dockerã‚¿ã‚¤ãƒ—ã®å ´åˆ è‡ªåˆ†ã§docker-composeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å®Ÿè¡Œç’°å¢ƒã¨ã—ã¦ã®Dockerã‚³ãƒ³ãƒ†ãƒŠã¨ã€ãƒ“ãƒ«ãƒ‰ã—ãŸDockerã‚³ãƒ³ãƒ†ãƒŠãŒå…¥ã‚Œå­ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã€setup_remote_dockerã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãŸã ã—ã€ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã§ããªããªã‚‹ã®ã§æ³¨æ„ã™ã‚‹ã€‚ version: 2.1 jobs: build: machine: image: circleci/classic:edge steps: - checkout - setup_remote_docker - run: name: Install Docker Compose command: | set -x curl -L https://github.com/docker/compose/releases/download/1.11.2/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose chmod +x /usr/local/bin/docker-compose - run: name: docker-compose up command: | set -x docker-compose up --build -d ãƒ»machineã‚¿ã‚¤ãƒ—ã®å ´åˆï¼ˆæ¨å¥¨ï¼‰ å®Ÿè¡Œç’°å¢ƒã«machineã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ãŸå ´åˆã€ã™ã§ã«docker-composeãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://circleci.com/docs/ja/2.0/configuration-reference/#%E4%BD%BF%E7%94%A8%E5%8F%AF%E8%83%BD%E3%81%AA-machine-%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8 docker-compose & dockerize ãƒ»docker/install-dockerize CircleCIã§Docker Composeã‚’ç”¨ã„ã‚‹å ´åˆã«å¿…è¦ã§ã‚ã‚‹ã€‚Docker Composeã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹ç¯‰ã®é †ç•ªã‚’åˆ¶å¾¡ã§ãã‚‹ã‚‚ã®ã®ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã®ãƒ—ãƒ­ã‚»ã‚¹ã®çŠ¶æ…‹ã‚’æ°—ã«ã—ãªã„ã€‚ãã®ãŸã‚ã€ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹ç¯‰å¾Œã«ã€ãƒ—ãƒ­ã‚»ã‚¹ãŒå®Œå…¨ã«èµ·å‹•ã—ã¦ã„ãªã„ã®ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€æ¬¡ã®ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹ç¯‰ã‚’é–‹å§‹ã—ã¦ã—ã¾ã†ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ—ãƒ­ã‚»ã‚¹ãŒå®Œå…¨ã«èµ·å‹•ã—ã¦ã„ãªã„ã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ã€æ¬¡ã«æ§‹ç¯‰ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠãŒæ¥ç¶šå‡¦ç†ã‚’è¡Œã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚ã“ã‚Œã‚’é˜²ããŸã‚ã«ã€ãƒ—ãƒ­ã‚»ã‚¹ã®èµ·å‹•ã‚’å¾…æ©Ÿã—ã¦ã‹ã‚‰ã€æ¥ç¶šå‡¦ç†ã‚’è¡Œã†ã‚ˆã†ã«ã™ã‚‹ã€‚dockerizeã®ä»£ã‚ã‚Šã®æ–¹æ³•ã¨ã—ã¦ã€sleepã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¦ã‚‚ã‚ˆã„ã€‚ å‚è€ƒï¼šhttps://github.com/docker/compose/issues/374#issuecomment-126312313 ï¼Šå®Ÿè£…ä¾‹ï¼Š Laravelã‚³ãƒ³ãƒ†ãƒŠã¨MySQLã‚³ãƒ³ãƒ†ãƒŠã®å ´åˆã‚’ç¤ºã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠå†…ã«å¯¾ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹æ™‚ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã€Dockerfileã®WORKDIRã«ã‚ˆã£ã¦æ±ºã¾ã‚‹ã®ã§æ³¨æ„ã™ã‚‹ã€‚ version: 2.1 orbs: docker: circleci/docker@x.y.z commands: restore_vendor: steps: - restore_cache: key: - v1-dependecies-{{ checksum composer.json }} - v1-dependencies- save_vendor: steps: - save_cache: key: v1-dependecies-{{ checksum composer.json }} paths: - /vendor jobs: build_and_test: # Docker Composeã®æ™‚ã¯machineã‚¿ã‚¤ãƒ—ã‚’ç”¨ã„ã‚‹ machine: image: ubuntu-1604:201903-01 steps: - checkout - run: name: Make env file command: | echo $ENV | base64 --decode > .env - run: name: Make env docker file command: | cp .env.docker.example .env.docker - run: name: Docker config command: | docker-compose config - run: name: Docker compose up command: | set -xe docker network create foo-network docker-compose up --build -d - restore_vendor # Dockerã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦comspoerã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡ - run: name: Composer install command: | docker-compose exec laravel-container composer install -n --prefer-dist - save_vendor # Dockerizeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« - docker/install-dockerize: version: v0.6.1 - run: name: Wait for MySQL to be ready command: | # ä»£ã‚ã‚Šã«sleepã‚³ãƒãƒ³ãƒ‰ã§ã‚‚ã‚ˆã„ã€‚ dockerize -wait tcp://localhost:3306 -timeout 1m # Dockerã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡ - run: name: Run artisan migration command: | docker-compose exec laravel-container php artisan migrate --force # Dockerã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦PHP-Unitã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡ - run: name: Run unit test command: | dockercompose exec laravel-container ./vendor/bin/phpunit # Dockerã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦PHP-Stanã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡ - run: name: Run static test command: | docker-compose exec laravel-container ./vendor/bin/phpstan analyse --memory-limit=512M DLCï¼šDocker Layer Cache ãƒ»DLCã¨ã¯ CircleCIã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ãŸå¾Œã€å„ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’DLCãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ä½œæˆã™ã‚‹ã€‚ãã—ã¦ã€æ¬¡å›ä»¥é™ã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ã€å·®åˆ†ãŒãªã„ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’DLCãƒœãƒªãƒ¥ãƒ¼ãƒ ã‹ã‚‰ãƒ—ãƒ«ã—ã¦å†åˆ©ç”¨ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰æ™‚é–“ã‚’çŸ­ç¸®ã§ãã‚‹ã€‚ ãƒ»ä½¿ç”¨ä¾‹ machineã‚¿ã‚¤ãƒ—ã§ç”¨ã„ã‚‹å ´åˆã€machineã‚­ãƒ¼ã®ä¸‹ã§docker_layer_cachingã‚’ä½¿ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 orbs: docker: circleci/docker@x.y.z jobs: build_and_test: # Docker Composeã®æ™‚ã¯machineã‚¿ã‚¤ãƒ—ã‚’ç”¨ã„ã‚‹ machine: image: ubuntu-1604:201903-01 # DLCã‚’æœ‰åŠ¹åŒ– docker_layer_caching: true steps: - checkout - run: name: Make env file command: | echo $ENV_TESTING | base64 --decode > .env - run: name: Make env docker file command: | cp .env.docker.example .env.docker - run: name: Docker compose up command: | set -xe docker network create foo-network docker-compose up --build -d dockerã‚¿ã‚¤ãƒ—ã§ç”¨ã„ã‚‹å ´åˆã€dockerã‚­ãƒ¼ã®ä¸‹ã§docker_layer_cachingã‚’ä½¿ã†ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 jobs: build_and_push: executor: docker/docker steps: - setup_remote_docker # DLCã‚’æœ‰åŠ¹åŒ– docker_layer_caching: true - checkout - docker/check - docker/build: image: / - docker/push: image: / 02-09. CircleCIãƒ©ã‚¤ãƒ–ãƒ©ãƒª orbs ãƒ»orbsã¨ã¯ CircleCIã‹ã‚‰æä¾›ã•ã‚Œã‚‹æ±ç”¨çš„ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½¿ç”¨ã‚’èª­ã¿è¾¼ã‚€ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 orbs: hello: circleci/hello-build@0.0.5 workflows: \"Hello Workflow\": jobs: - hello/hello-build ãƒ»jobsã€commandsã€executors æ§‹é€  èª¬æ˜ jobs workflowsã«ã¦ã€Orbsã‹ã‚‰jobã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ commands jobã«ã¦ã€stepã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ executors exexutorã«ã¦ã€äº‹å‰å®šç¾©ã•ã‚ŒãŸexecutorsã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¸ã®å¼•æ•°ã®æ¸¡ã—æ–¹ã¨æ³¨æ„ç‚¹ AWSèªè¨¼æƒ…å ±ã¯ã€CircleCIã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåã¨åŒã˜ç’°å¢ƒå¤‰æ•°åã§ç™»éŒ²ã—ã¦ãŠã‘ã°ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æ¸¡ã•ãªãã¨ã‚‚ã€è‡ªå‹•ã§å…¥åŠ›ã—ã¦ãã‚Œã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒenv_var_nameå‹ã¯ã€åŸºæœ¬çš„ã«å…¨ã¦ã®ã‚¹ã‚³ãƒ¼ãƒ—ãƒ¬ãƒ™ãƒ«ã®ç’°å¢ƒå¤‰æ•°ã‚’å—ã‘ä»˜ã‘ã‚‹ã€‚ãŸã ã—Alpineãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã¯ã€ã€$BASH_ENVã€ã‚’ç”¨ã„ã¦ã€è¤‡æ•°ã®runé–“ã§ç’°å¢ƒå¤‰æ•°ã‚’å…±æœ‰ã§ããšã€orbsã®ã‚¹ãƒ†ãƒƒãƒ—ã«ç’°å¢ƒå¤‰æ•°ã‚’æ¸¡ã›ãªã„ãŸã‚æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/circleci/circleci-docs/issues/1650 ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 orbs: aws-foo: circleci/aws-foo@x.y.z jobs: foo_bar_baz: docker: - image: circleci/python:x.y.z steps: - attach_workspace: at: . - setup_remote_docker: - aws-cli/install - aws-cli/setup - aws-foo/foo-bar-baz: # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåã§ã‚ã‚Œã°ã€è¨˜è¿°ã—ãªãã¦ã‚‚è‡ªå‹•çš„ã«å…¥åŠ›ã—ã¦ãã‚Œã‚‹ã€‚ account-url: $AWS_ECR_ACCOUNT_URL_ENV_VAR_NAME aws-access-key-id: $ACCESS_KEY_ID_ENV_VAR_NAME aws-secret-access-key: $SECRET_ACCESS_KEY_ENV_VAR_NAME region: $AWS_REGION_ENV_VAR_NAME aws-cli ãƒ»commands: install aws-cliã‚³ãƒãƒ³ãƒ‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã†ã€‚ ãƒ»commands: setup aws-cliã‚³ãƒãƒ³ãƒ‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã€Credentialsæƒ…å ±ã®è¨­å®šã‚’è¡Œã†ã€‚AWSãƒªã‚½ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š CloudFrontã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã™ã‚‹ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã¨ã—ã¦ã‚‚ã€CloudFrontã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã—ãªã„é™ã‚Šã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒHitã—ãŸãƒ¦ãƒ¼ã‚¶ã«ã¯éå»ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã¦ã—ã¾ã†ã€‚ãã®ãŸã‚ã€S3ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ version: 2.1 orbs: aws-cli: circleci/aws-cli@1.3.1 jobs: cloudfront_create_invalidation: docker: - image: cimg/python:3.9-node steps: - checkout - aws-cli/setup - run: name: Run create invalidation command: | echo $AWS_CLOUDFRONT_ID | base64 --decode | aws cloudfront create-invalidation --distribution-id $AWS_CLOUDFRONT_ID --paths \"/*\" workflows: # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop: jobs: # ç›´å‰ã«æ‰¿èªã‚¸ãƒ§ãƒ–ã‚’æŒ¿å…¥ã™ã‚‹ - hold: name: hold_create_invalidation_stg type: approval - cloudfront_create_invalidation: name: cloudfront_create_invalidation_stg filters: branches: only: - develop # æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main: jobs: # ç›´å‰ã«æ‰¿èªã‚¸ãƒ§ãƒ–ã‚’æŒ¿å…¥ã™ã‚‹ - hold: name: hold_create_invalidation_prd type: approval - cloudfront_create_invalidation: name: cloudfront_create_invalidation_prd filters: branches: only: - main ãŸã ã—ã€credentialsãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã§ã¯ã€orbsã‚’ä½¿ç”¨ã—ãªã„æ–¹ãŒã‚ˆã‚Šç°¡æ½”ã«æ¡ä»¶åˆ†å²ã‚’å®Ÿè£…ã§ãã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚ #!/bin/bash set -xeuo pipefail case \"$APP_ENV\" in \"stg\") AWS_ACCESS_KEY_ID=$STG_AWS_ACCESS_KEY_ID AWS_SECRET_ACCESS_KEY=$STG_AWS_SECRET_ACCESS_KEY ;; \"prd\") AWS_ACCESS_KEY_ID=\"$PRD_AWS_ACCESS_KEY_ID\" AWS_SECRET_ACCESS_KEY=\"$PRD_AWS_SECRET_ACCESS_KEY\" ;; *) echo \"The parameter ${APP_ENV} is invalid.\" exit 1 ;; esac # defaultãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«æƒ…å ±ã‚’è¨­å®šã™ã‚‹ã€‚ aws configure aws-ecr ãƒ»jobsï¼šbuild-and-push-image CircleCIã‚³ãƒ³ãƒ†ãƒŠã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã€ECRã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚remote-docker-layer-cachingã‚’ç”¨ã„ã¦ã€Docker Layer Cacheã‚’æœ‰åŠ¹åŒ–ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 orbs: aws-cli: circleci/aws-cli@1.3.1 aws-ecr: circleci/aws-ecr@6.15.2 jobs: aws-ecr/build-and-push-image: name: ecr_build_and_push_image # Docker Layer Cacheã‚’ç”¨ã„ã‚‹ã‹ã©ã†ã‹ï¼ˆæœ‰æ–™ï¼‰ remote-docker-layer-caching: true # ãƒªãƒã‚¸ãƒˆãƒªãŒãªã„æ™‚ã«ä½œæˆã™ã‚‹ã‹ã©ã†ã‹ã€‚ create-repo: true no-output-timeout: 20m # projectã‚’ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã—ãŸæ™‚ã®ç›¸å¯¾ãƒ‘ã‚¹ dockerfile: ./infra/docker/Dockerfile path: \".\" profile-name: myProfileName repo: \"{$SERVICE}-repository\" # CircleCIã®ãƒãƒƒã‚·ãƒ¥å€¤ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° tag: $CIRCLE_SHA1 # jobå†…ã«ã¦ã€attach_workspaceã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã€‚ attach-workspace: true # attach_workspaceã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œæ™‚ã®rootãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª workspace-root: aws-ecs ãƒ»jobsï¼šdeploy-update-serviceï¼ˆãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆä½¿ç”¨æ™‚ï¼‰ ECRã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦ã€æ–°ã—ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ã®ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’ä½œæˆã—ã€ã¾ãŸã“ã‚Œã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚verify-revision-is-deployedã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦ã€ECSã‚µãƒ¼ãƒ“ã‚¹ãŒæ›´æ–°ã•ã‚ŒãŸå¾Œã€å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ãŒã‚¿ã‚¹ã‚¯å®šç¾©ã«åˆè‡´ã—ã¦ã„ã‚‹ã‹ã‚’ç›£è¦–ã™ã‚‹ã€‚ä¾‹ãˆã°ã€ã‚¿ã‚¹ã‚¯ãŒã€Runnningã€ã«ãªã‚‰ãšã«ã€Stoppedã€ã«ãªã£ã¦ã—ã¾ã†å ´åˆã‚„ã€æ—¢å­˜ã®ã‚¿ã‚¹ã‚¯ãŒã€Stoppedã€ã«ãªã‚‰ãšã«ã€Runningã€ã®ã¾ã¾ã«ãªã£ã¦ã—ã¾ã†å ´åˆã€ã“ã®çŠ¶æ…‹ã¯ã‚¿ã‚¹ã‚¯å®šç¾©ã«åˆè‡´ã—ãªã„ã®ã§ã€æ¤œçŸ¥ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://circleci.com/docs/ja/2.0/ecs-ecr/#deploy-the-new-docker-image-to-an-existing-aws-ecs-service ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 orbs: aws-cli: circleci/aws-cli@1.3.1 aws-ecs: circleci/aws-ecs@2.2.1 jobs: aws-ecs/deploy-update-service: name: ecs_update_service_by_rolling_update # ã‚¿ã‚¹ã‚¯å®šç¾©åã‚’æŒ‡å®š family: \"${SERVICE}-ecs-task-definition\" # ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼åã‚’æŒ‡å®š cluster-name: \"${SERVICE}-cluster\" # ã‚µãƒ¼ãƒ“ã‚¹åã‚’æŒ‡å®š service-name: \"${SERVICE}-service\" # ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã®ã‚³ãƒ³ãƒ†ãƒŠåã¨ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚°ã‚’ä¸Šæ›¸ãã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯CircleCIã®ãƒãƒƒã‚·ãƒ¥å€¤ã§ã‚¿ã‚°ä»˜ã‘ã—ã¦ã„ã‚‹ã®ã§å¿…é ˆã€‚ container-image-name-updates: \"container=laravel,tag=${CIRCLE_SHA1},container=nginx,tag=${CIRCLE_SHA1}\" # ã‚µãƒ¼ãƒ“ã‚¹æ›´æ–°å¾Œã®ã‚¿ã‚¹ã‚¯ç›£è¦– verify-revision-is-deployed: true workflows: # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop: jobs: - ecs_update_service_by_rolling_update: name: ecs_update_service_by_rolling_update_stg filters: branches: only: - develop # æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main: jobs: - ecs_update_service_by_rolling_update: name: ecs_update_service_by_rolling_update_production filters: branches: only: - main ãƒ»jobsï¼šdeploy-update-serviceï¼ˆB/Gãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆä½¿ç”¨æ™‚ï¼‰ ECSã‚¿ã‚¹ã‚¯å®šç¾©ã‚’æ›´æ–°ã™ã‚‹ã€‚ã•ã‚‰ã«ã€Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãŒãã®ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’æŒ‡å®šã—ã€ECSã‚µãƒ¼ãƒ“ã‚¹ã‚’æ›´æ–°ã™ã‚‹ã€‚ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¨åŒæ§˜ã«ã—ã¦ã€verify-revision-is-deployedã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 orbs: aws-cli: circleci/aws-cli@1.3.1 aws-ecs: circleci/aws-ecs@2.2.1 jobs: aws-ecs/deploy-update-service: name: ecs_update_service_by_code_deploy # ã‚¿ã‚¹ã‚¯å®šç¾©åã‚’æŒ‡å®š family: \"${SERVICE}-ecs-task-definition\" # ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼åã‚’æŒ‡å®š cluster-name: \"${SERVICE}-cluster\" # ã‚µãƒ¼ãƒ“ã‚¹åã‚’æŒ‡å®š service-name: \"${SERVICE}-service\" # CodeDeployã«ãŠã‘ã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤ã®ä½œæˆã‚’è¨­å®š deployment-controller: CODE_DEPLOY codedeploy-application-name: $SERVICE codedeploy-deployment-group-name: \"${SERVICE}-deployment-group\" codedeploy-load-balanced-container-name: www-container codedeploy-load-balanced-container-port: 80 # ã‚³ãƒ³ãƒ†ãƒŠåã¨ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¿ã‚°ã‚’æŒ‡å®šã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯CircleCIã®ãƒãƒƒã‚·ãƒ¥å€¤ã§ã‚¿ã‚°ä»˜ã‘ã—ã¦ã„ã‚‹ã®ã§å¿…é ˆã€‚ container-image-name-updates: \"container=laravel,tag=${CIRCLE_SHA1},container=nginx,tag=${CIRCLE_SHA1}\" # ã‚µãƒ¼ãƒ“ã‚¹æ›´æ–°å¾Œã®ã‚¿ã‚¹ã‚¯ç›£è¦– verify-revision-is-deployed: true workflows: # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop: jobs: - ecs_update_service_by_code_deploy: name: ecs_update_service_by_code_deploy_stg filters: branches: only: - develop # æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main: jobs: - ecs_update_service_by_code_deploy: name: ecs_update_service_by_code_deploy_production filters: branches: only: - main ãƒ»jobsï¼šrun-task ç¾åœ¨èµ·å‹•ä¸­ã®ECSã‚¿ã‚¹ã‚¯ã¨ã¯åˆ¥ã«ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’ä¸€æ™‚çš„ã«èµ·å‹•ã™ã‚‹ã€‚èµ·å‹•æ™‚ã«ã€overridesã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦ã€æŒ‡å®šã—ãŸã‚¿ã‚¹ã‚¯å®šç¾©ã®ã‚³ãƒ³ãƒ†ãƒŠè¨­å®šã‚’ä¸Šæ›¸ãã§ãã‚‹ã€‚æ­£è¦è¡¨ç¾ã§è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã•ã‚‰ã«JSONã§ã¯ã€\\ã€ã‚’ã€\\\\ã€ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚ŒãŸå¾Œã«ã€ã‚¿ã‚¹ã‚¯ã¯è‡ªå‹•çš„ã«StoppedçŠ¶æ…‹ã«ãªã‚‹ã€‚ ä¸Šæ›¸ãã§ãã‚‹ã‚­ãƒ¼ã®å‚ç…§ãƒªãƒ³ã‚¯ï¼šhttps://docs.aws.amazon.com/cli/latest/reference/ecs/run-task.html ï¼Šå®Ÿè£…ä¾‹ï¼Š ä¾‹ãˆã°ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å¯¾ã—ã¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ECSã‚¿ã‚¹ã‚¯ã‚’èµ·å‹•ã™ã‚‹ã€‚overridesã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä¸Šæ›¸ãã™ã‚‹ã€‚ version: 2.1 orbs: aws-cli: circleci/aws-cli@1.3.1 aws-ecs: circleci/aws-ecs@2.2.1 jobs: aws-ecs/run-task: name: ecs_run_task_for_migration cluster: \"${SERVICE}-ecs-cluster\" # LATESTã¨ã™ã‚‹ã¨ãã®æ™‚ç‚¹ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•ã§å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã¦ã—ã¾ã†ã€‚ platform-version: 1.4.0 awsvpc: true launch-type: FARGATE subnet-ids: $AWS_SUBNET_IDS security-group-ids: $AWS_SECURITY_GROUPS # ã‚¿ã‚¹ã‚¯å®šç¾©åã€‚æœ€æ–°ãƒªãƒ“ã‚¸ãƒ§ãƒ³ç•ªå·ãŒè‡ªå‹•è£œå®Œã•ã‚Œã‚‹ã€‚ task-definition: \"${SERVICE}-ecs-task-definition\" # ã‚¿ã‚¹ã‚¯èµ·å‹•æ™‚ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã€Laravelã‚³ãƒ³ãƒ†ãƒŠã®ã€€commandã‚­ãƒ¼ã‚’ä¸Šæ›¸ã overrides: \"{\\\\\\\"containerOverrides\\\\\\\":[{\\\\\\\"name\\\\\\\": \\\\\\\"laravel-container\\\\\\\",\\\\\\\"command\\\\\\\": [\\\\\\\"php\\\\\\\", \\\\\\\"artisan\\\\\\\", \\\\\\\"migrate\\\\\\\", \\\\\\\"--force\\\\\\\"]}]}\" workflows: # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop: jobs: - ecs_run_task_for_migration: name: ecs_run_task_for_migration_stg filters: branches: only: - develop # æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main: jobs: - ecs_run_task_for_migration: name: ecs_run_task_for_migration_production filters: branches: only: - main aws-code-deploy ãƒ»jobsï¼šdeploy S3ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨appspecãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹ã€‚ã¾ãŸã€CodeDeployã‚’ç”¨ã„ã¦ã€ã“ã‚Œã‚’EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š version: 2.1 orbs: aws-code-deploy: circleci/aws-code-deploy@1.0.1 jobs: aws-code-deploy/deploy: name: code_deploy application-name: $SERVICE} # appspecãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ãƒã‚±ãƒƒãƒˆå bundle-bucket: \"${SERVICE}-bucket\" # appspecãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ bundle-source: ./infra/aws_codedeploy # appspecãƒ•ã‚¡ã‚¤ãƒ«ã‚’zipãƒ•ã‚©ãƒ«ãƒ€ã§ä¿å­˜ bundle-type: zip # zipãƒ•ã‚©ãƒ«ãƒ€å bundle-key: foo-bundle deployment-config: CodeDeployDefault.ECSAllAtOnce deployment-group: \"${SERVICE}-deployment-group\" # ECSã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹CodeDeployã‚µãƒ¼ãƒ“ã‚¹ãƒ­ãƒ¼ãƒ« service-role-arn: $CODE_DEPLOY_ROLE_FOR_ECS workflows: # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop: jobs: - code_deploy: name: code_deploy_stg filters: branches: only: - develop # æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main: jobs: - code_deploy: name: code_deploy_production filters: branches: only: - main slack ãƒ»commandsï¼šnotify ã‚¸ãƒ§ãƒ–ã®çµ‚äº†æ™‚ã«ã€æˆåŠŸã¾ãŸã¯å¤±æ•—ã«åŸºã¥ã„ã¦ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’é€šçŸ¥ã™ã‚‹ã€‚ã‚¸ãƒ§ãƒ–ã®æœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦è¨­å®šã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ version: 2.1 orbs: slack: circleci/slack@4.1 commands: # ä»–ã®ã‚¸ãƒ§ãƒ–å†…ã§ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«commandã¨ã—ã¦å®šç¾© notify_of_failure: steps: - slack/notify: event: fail template: basic_fail_1 jobs: deploy: steps: # ï½ ä¸­ç•¥ ï½ workflows: # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ develop: jobs: - deploy: name: deploy_stg filters: branches: only: - develop # å¤±æ•—æ™‚ã«é€šçŸ¥ post-steps: - notify_of_failure: # æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ main: jobs: - deploy: name: deploy_production filters: branches: only: - main # å¤±æ•—æ™‚ã«é€šçŸ¥ post-steps: - notify_of_failure: "},"public/ci_cd/ci_cd_capistrano.html":{"url":"public/ci_cd/ci_cd_capistrano.html","title":"ğŸ“– ï¸Capistrano","keywords":"","body":"Capistrano ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ Capistranoã¨ã¯ ãƒ»ä»•çµ„ã¿ è‡ªèº«ã®ãƒ‘ã‚½ã‚³ãƒ³ã‹ã‚‰ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒ¼ãƒã«ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šã™ã‚‹ã€‚ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒ¼ãƒã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ„ãƒ¼ãƒ«ï¼ˆä¾‹ï¼šCapistranoï¼‰ãŒã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒ¼ãƒã‹ã‚‰ã‚¯ãƒ©ã‚¦ãƒ‰Webã‚µãƒ¼ãƒã«ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šã™ã‚‹ã€‚ è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ„ãƒ¼ãƒ«ãŒã€ã‚¯ãƒ©ã‚¦ãƒ‰Webã‚µãƒ¼ãƒã®Gitã‚’æ“ä½œã—ã€pullã‚ã‚‹ã„ã¯cloneã‚’å®Ÿè¡Œã™ã‚‹ã€‚ãã®çµæœã€GitHubã‹ã‚‰ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒ¼ãƒã«æŒ‡å®šã®ãƒ–ãƒ©ãƒ³ãƒã®çŠ¶æ…‹ãŒå–ã‚Šè¾¼ã¾ã‚Œã‚‹ã€‚ "},"public/observability_monitering/observability.html":{"url":"public/observability_monitering/observability.html","title":"ğŸ“– ï¸å¯è¦³æ¸¬æ€§","keywords":"","body":"å¯è¦³æ¸¬æ€§ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. å¯è¦³æ¸¬æ€§ å¯è¦³æ¸¬æ€§ã¨ã¯ ã€åé›†ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹æƒ³å®šå¤–ã®ä¸å…·åˆã‚’ã©ã‚Œã ã‘æ­£ç¢ºã«æ¨æ¸¬ã§ãã‚‹ã‹ã€ã‚’è¡¨ã™ç¨‹åº¦ã®ã“ã¨ã€‚ã‚·ã‚¹ãƒ†ãƒ ã®æƒ³å®šå†…ã®ä¸å…·åˆã¯ã€ç›£è¦–ã€ã‚„ã€ãƒ†ã‚¹ãƒˆã€ã«ã‚ˆã£ã¦æ¤œçŸ¥ã§ãã‚‹ãŒã€æƒ³å®šå¤–ã®ã‚‚ã®ã‚’æ¤œçŸ¥ã§ããªã„ã€‚ã—ã‹ã—ã€å¯è¦³æ¸¬æ€§ã‚’é«˜ã‚ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€æƒ³å®šå¤–ã®ä¸å…·åˆã‚’è¡¨é¢åŒ–ã§ãã‚‹ã€‚æƒ³å®šå¤–ã®ä¸å…·åˆã¯ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®åŸå› ã«ãªã‚‹ãŸã‚ã€æƒ³å®šå¤–ã®ä¸å…·åˆã®è¡¨é¢åŒ–ã¯ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®äºˆé˜²ã«ã¤ãªãŒã‚‹ã€‚ å‚è€ƒï¼š https://blog.thundra.io/observability-driven-development-for-serverless https://sookocheff.com/post/architecture/testing-in-production/ https://www.sentinelone.com/blog/observability-production-systems-why-how/ å¯è¦³æ¸¬æ€§ã‚’é«˜ã‚ã‚‹æ–¹æ³• ãƒ»ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å ´åˆ ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã‚’ååˆ†ã«åé›†ã—ã€ã“ã‚Œã‚‰ã‚’ç´ä»˜ã‘ã¦å¯è¦–åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»ãƒ¢ãƒãƒªã‚¹ã«ãŠã‘ã‚‹å¯è¦³æ¸¬æ€§ å¯è¦³æ¸¬æ€§ã¯ã€åŸºæœ¬çš„ã«ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ–‡è„ˆã§èªã‚‰ã‚Œã‚‹ã€‚ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã«ãŠã„ã¦ã€ã©ã®ã‚ˆã†ã«ã—ã¦å¯è¦³æ¸¬æ€§ã‚’é«˜ã‚ã‚‹ã®ã‹ã‚’èª¿æŸ»ä¸­...ï¼ˆæƒ…å ±ãŒå…¨ç„¶è¦‹ã¤ã‹ã‚‰ãªã„ï¼‰ ç™ºè¡¨ã‚¹ãƒ©ã‚¤ãƒ‰ 01-02. ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã¨ã¯ å¯è¦³æ¸¬æ€§ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«åé›†ã™ã‚‹å¿…è¦ã®ã‚ã‚‹ï¼“ã¤ã®ãƒ‡ãƒ¼ã‚¿è¦ç´ ï¼ˆã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ã€ãƒ­ã‚°ã€ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã€ï¼‰ã®ã“ã¨ã€‚NewRelicã‚„Datadogã¯ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã®è¦ç´ ã‚’å…¨ã¦æŒã¤ã€‚ã¾ãŸã€AWSã§ã¯CloudWatchï¼ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼‹ãƒ­ã‚°ï¼‰ã¨X-Rayï¼ˆåˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ï¼‰ã‚’ä¸¡æ–¹åˆ©ç”¨ã™ã‚‹ã¨ã€ã“ã‚Œã‚‰ã®è¦ç´ ã‚’æº€ãŸã›ãŸã“ã¨ã«ãªã‚Šã€å¯è¦³æ¸¬æ€§ã‚’å®Ÿç¾ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://www.forbes.com/sites/andythurai/2021/02/02/aiops-vs-observability-vs-monitoringwhat-is-the-difference-are-you-using-the-right-one-for-your-enterprise/ https://knowledge.sakura.ad.jp/26395/ 02. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã¯ ã¨ã‚ã‚‹åˆ†æã«ã¦ã€ä¸€å®šæœŸé–“ã«ç™ºç”Ÿã—ãŸè¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®é›†è¨ˆå€¤ã®ã“ã¨ã€‚ã€å¹³å‡ã€ã€åˆè¨ˆã€ã€æœ€å°ï¼æœ€å¤§ã€ã€å¹³æ–¹æ ¹ã€ãªã©ã‚’ç”¨ã„ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’é›†è¨ˆã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/cloudwatch_concepts.html#Metric ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆ ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¨ã¯ åˆ†æå¯¾è±¡ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹æœ€å°å˜ä½ã®æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã®ã“ã¨ã€‚ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¯ã€åˆ†æã”ã¨ã«å­˜åœ¨ã—ã¦ã„ã‚‹ã€‚ä¾‹ãˆã°ã€ã¨ã‚ã‚‹åˆ†æã§ä¸€åˆ†ã”ã¨ã«å¯¾è±¡ãŒæ¸¬å®šã•ã‚Œã‚‹å ´åˆã€ä¸€åˆ†ã”ã¨ã«å¾—ã‚‰ã‚Œã‚‹æ•°å€¤ãƒ‡ãƒ¼ã‚¿ãŒãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹ã€‚ä¸€æ–¹ã§ã€ä¸€æ™‚é–“ã”ã¨ã®æ¸¬å®šã®å ´åˆã€ä¸€æ™‚é–“ã”ã¨ã«å¾—ã‚‰ã‚Œã‚‹æ•°å€¤ãƒ‡ãƒ¼ã‚¿ãŒãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã§ã‚ã‚‹ã€‚ å‚è€ƒï¼š https://whatis.techtarget.com/definition/data-point https://aws.amazon.com/jp/about-aws/whats-new/2017/12/amazon-cloudwatch-alarms-now-alerts-you-when-any-m-out-of-n-metric-datapoints-in-an-interval-are-above-your-threshold/ ï¼”å¤§ã‚·ã‚°ãƒŠãƒ« ãƒ»ï¼”å¤§ã‚·ã‚°ãƒŠãƒ«ã¨ã¯ ç‰¹ã«é‡è¦ãªãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ã€ã‚¨ãƒ©ãƒ¼ã€ã‚µãƒãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã®ã“ã¨ã€‚ ãƒ»ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ ã‚µãƒ¼ãƒç›£è¦–å¯¾è±¡ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å±ã™ã‚‹ã€‚ ãƒ»ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ ã‚µãƒ¼ãƒç›£è¦–å¯¾è±¡ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å±ã™ã‚‹ã€‚ ãƒ»ã‚¨ãƒ©ãƒ¼ ã‚µãƒ¼ãƒç›£è¦–å¯¾è±¡ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å±ã™ã‚‹ã€‚ ç¨®é¡ èª¬æ˜ æ˜ç¤ºçš„ã‚¨ãƒ©ãƒ¼ 400/500ç³»ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ æš—é»™çš„ã‚¨ãƒ©ãƒ¼ SLOã«æº€ãŸãªã„200/300ç³»ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€APIä»•æ§˜ã«åˆã£ã¦ã„ãªã„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ»ã‚µãƒãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨ç‡ï¼ˆCPUåˆ©ç”¨ç‡ã€ãƒ¡ãƒ¢ãƒªç†å®¹å®¤ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åˆ©ç”¨ç‡ã€ãªã©ï¼‰ã®é£½å’Œåº¦ã®ã“ã¨ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®é£½å’Œåº¦ãŒã‚ã‚‹ã€‚60ï½70%ã§ã€è­¦å‘Šãƒ©ã‚¤ãƒ³ã‚’è¨­ã‘ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ã‚µãƒ¼ãƒç›£è¦–å¯¾è±¡ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å±ã™ã‚‹ã€‚ 02-02. æœ‰ç”¨ãªCloudWatchãƒ¡ãƒˆãƒªã‚¯ã‚¹ ECS ãƒ»ECSãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¸€è¦§ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/cloudwatch-metrics.html#available_cloudwatch_metrics ãƒ»RunningTaskCount RDS ãƒ»RDSãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¸€è¦§ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/monitoring-cloudwatch.html#rds-metrics ãƒ»CPUUtilization ãƒ»FreeableMemory API Gateway ãƒ»API Gatewayãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¸€è¦§ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/apigateway/latest/developerguide/api-gateway-metrics-and-dimensions.html#api-gateway-metrics ãƒ»Latency ãƒ»IntegrationLatency ãƒ»4XXError ãƒ»5XXError ALB ãƒ»ALBãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¸€è¦§ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/load-balancer-cloudwatch-metrics.html ãƒ»HTTPCode_ELB_4XX_Count ãƒ»HTTPCode_ELB_5XX_Count ãƒ»HTTPCode_TARGET_4XX_Count ãƒ»HTTPCode_TARGET_5XX_Count ãƒ»RejectedConnectionCount ãƒ»HealthyHostCount ãƒ»TargetConnectionErrorCount ãƒ»TargetTLSNegotiationErrorCount 03. ãƒ­ã‚° ãƒ­ã‚°ã¨ã¯ ç‰¹å®šã®ç¬é–“ã«ç™ºç”Ÿã—ãŸã‚¤ãƒ™ãƒ³ãƒˆãŒè¨˜è¼‰ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://newrelic.com/jp/blog/how-to-relic/metrics-events-logs-and-traces æ§‹é€ ã‹ã‚‰ã¿ãŸç¨®é¡ ãƒ»éæ§‹é€ åŒ–ãƒ­ã‚° ã‚¤ãƒ™ãƒ³ãƒˆã®å€¤ã ã‘ãŒè¡¨ç¤ºã•ã‚ŒãŸãƒ­ã‚°ã®ã“ã¨ã€‚æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã§å®šç¾©ã•ã‚Œã‚‹ã€‚ 192.168.0.1 [2021-01-01 12:00:00] GET /foos/1 200 ãƒ»æ§‹é€ åŒ–ãƒ­ã‚° ã‚¤ãƒ™ãƒ³ãƒˆã®é …ç›®åã¨å€¤ãŒè¡¨ç¤ºã•ã‚ŒãŸãƒ­ã‚°ã®ã“ã¨ã€‚JSONå‹ã§å®šç¾©ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚ { \"client_ip\": \"192.168.0.1\", \"timestamp\": \"2021-01-01 12:00:00\", \"method\": \"GET\", \"url\": \"/foos/1\", \"status_code\": 200 } ãƒ­ã‚®ãƒ³ã‚° ãƒ»Distributed loggingï¼ˆåˆ†æ•£ãƒ­ã‚®ãƒ³ã‚°ï¼‰ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã„ã¦ã€å„ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰åé›†ã•ã‚ŒãŸãƒ­ã‚°ã‚’ã€ãƒãƒ©ãƒãƒ©ã«åˆ†æï¼ç®¡ç†ã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://www.splunk.com/ja_jp/data-insider/what-is-distributed-tracing.html#centralized-logging ãƒ»Centralized loggingï¼ˆé›†ä¸­ãƒ­ã‚®ãƒ³ã‚°ï¼‰ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã„ã¦ã€å„ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰åé›†ã•ã‚ŒãŸãƒ­ã‚°ã‚’ã€ä¸€å…ƒçš„ã«åˆ†æï¼ç®¡ç†ã™ã‚‹æ–¹æ³•ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://www.splunk.com/ja_jp/data-insider/what-is-distributed-tracing.html#centralized-logging 04. åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ã¯ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã„ã¦ã€è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰åé›†ã•ã‚ŒãŸã‚¹ãƒ‘ãƒ³ã®ã‚»ãƒƒãƒˆã®ã“ã¨ã€‚ã‚¹ãƒ‘ãƒ³ã‚’ç´ä»˜ã‘ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ç•°ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ¨ªæ–­ã™ã‚‹å‡¦ç†ã‚’ã€ä¸€ç¹‹ããªã‚‚ã®ã¨ã—ã¦èªè­˜ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼š https://www.dynatrace.com/news/blog/open-observability-part-1-distributed-tracing-and-observability/ https://docs.newrelic.com/jp/docs/distributed-tracing/concepts/introduction-distributed-tracing/ https://medium.com/nikeengineering/hit-the-ground-running-with-distributed-tracing-core-concepts-ff5ad47c7058 åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®èª­ã¿æ–¹ ä¸Šã‹ã‚‰ä¸‹ã«èª­ã‚€ã¨ã€ä¸Šæµã‚µãƒ¼ãƒ“ã‚¹ï¼ˆä¸Šä½ã‚¹ãƒ‘ãƒ³ï¼‰ãŒä¸‹æµã‚µãƒ¼ãƒ“ã‚¹ï¼ˆä¸‹ä½ã‚¹ãƒ‘ãƒ³ï¼‰ã‚’å‡¦ç†ã‚’ã‚³ãƒ¼ãƒ«ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã€‚ä¸‹ã‹ã‚‰ä¸Šã«èª­ã‚€ã¨ã€ä¸‹æµã‚µãƒ¼ãƒ“ã‚¹ï¼ˆä¸‹ä½ã‚¹ãƒ‘ãƒ³ï¼‰ã‹ã‚‰ä¸Šæµã‚µãƒ¼ãƒ“ã‚¹ï¼ˆä¸Šä½ã‚¹ãƒ‘ãƒ³ï¼‰ã«çµæœã‚’è¿”å´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://cloud.google.com/architecture/using-distributed-tracing-to-observe-microservice-latency-with-opencensus-and-stackdriver-trace ãƒ¢ãƒãƒªã‚¹ã«ãŠã‘ã‚‹åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ ãƒ¢ãƒãƒªã‚¹ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ãŒåˆ†æ•£ã—ã¦ã„ãªã„ãŸã‚ã€å˜ãªã‚‹ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://deepsource.io/blog/distributed-tracing/#monolithic-observability ï¼Šä¾‹ï¼Š ï¼ˆï¼‘ï¼‰a1ï¼šã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰a1ï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ã«åˆ°é”ã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰a1ï½a2ï¼šãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ã§å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼ˆï¼”ï¼‰a2ï¼šãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µï¼ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è»¢é€ã™ã‚‹ã€‚ ï¼ˆï¼•ï¼‰a2ï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆ°é”ã™ã‚‹ã€‚ ï¼ˆï¼–ï¼‰a2ï½a3ï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ ï¼ˆï¼—ï¼‰a3ï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ä¿¡ã™ã‚‹ã€‚ ã‚¹ãƒ‘ãƒ³ ãƒ»ã‚¹ãƒ‘ãƒ³ã¨ã¯ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã„ã¦ã€ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã§ç™ºç”Ÿã—ãŸãƒ‡ãƒ¼ã‚¿ã®ã‚»ãƒƒãƒˆã®ã“ã¨ã€‚JSONå‹ã§å®šç¾©ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚SaaSãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦JSONå‹ã®æ§‹é€ ãŒç•°ãªã‚‹ã€‚ å‚è€ƒï¼š https://opentracing.io/docs/overview/spans/ https://docs.datadoghq.com/ja/tracing/guide/send_traces_to_agent_by_api/#%E3%83%A2%E3%83%87%E3%83%AB https://docs.newrelic.com/jp/docs/distributed-tracing/trace-api/report-new-relic-format-traces-trace-api/#new-relic-guidelines ãƒ»ã‚¹ãƒ‘ãƒ³é–“ã®ç´ä»˜ã‘ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã‚„ãƒœãƒ‡ã‚£ã«IDã‚’å‰²ã‚Šå½“ã¦ã€ç•°ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¹ãƒ‘ãƒ³é–“ã‚’ç´ä»˜ã‘ã‚‹ã€‚AWSã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€ä¾‹ãˆã°ALBãŒX-Amzn-Trace-Idãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆIDã‚’ä»˜ä¸ã—ã¦ãã‚Œã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆIDã‚’å®Ÿè£…ã›ãšã«åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’å®Ÿç¾ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/load-balancer-request-tracing.html ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆåŒ– ã‚¹ãƒ‘ãƒ³ãŒæŒã¤ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦é›†è¨ˆã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã€‚ "},"public/observability_monitering/monitering.html":{"url":"public/observability_monitering/monitering.html","title":"ğŸ“– ï¸ç›£è¦–","keywords":"","body":"ç›£è¦– ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ç›£è¦– ç›£è¦–ã¨ã¯ æ—¢çŸ¥ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ãƒ­ã‚°ã«åŸºã¥ã„ã¦ã€ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹æƒ³å®šå†…ã®ä¸å…·åˆã®ç™ºç”Ÿã‚’æœªç„¶ã«é˜²ãã“ã¨ã€‚æƒ³å®šå†…ã¨ã„ã†ç‚¹ã§ã€å¯è¦³æ¸¬æ€§ã¨åŒºåˆ¥ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://en.wikipedia.org/wiki/Website_monitoring https://blog.thundra.io/observability-driven-development-for-serverless ç›£è¦–ã‚’æ§‹æˆã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ç›£è¦–ã¯ã€ä»¥ä¸‹ã®è¦ç´ ã‹ã‚‰ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/4873118646 ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ èª¬æ˜ ãƒ‡ãƒ¼ã‚¿ã®åé›† ç›£è¦–å¯¾è±¡ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã™ã‚‹ã€‚ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã¯ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ­ã‚°ã€ãƒ¦ãƒ¼ã‚¶ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã€ãªã©ãŒã‚ã‚‹ã€‚ â†“ ãƒ‡ãƒ¼ã‚¿ã®ä¿ç®¡ ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿ç®¡ã™ã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ– ãƒ‡ãƒ¼ã‚¿ã‚’ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«è¡¨ç¤ºã—ã€ç›®è¦–ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿ã®åˆ†æ ãƒ‡ãƒ¼ã‚¿ã‚’æ•°å­¦çš„ã«åˆ†æã—ã€é›†è¨ˆçµæœã‚’ç®—å‡ºã™ã‚‹ã€‚ ãƒ¬ãƒãƒ¼ãƒˆã®ä½œæˆ ç®—å‡ºå€¤ã‚’ã‚°ãƒ©ãƒ•åŒ–ã¨ã—ã¦ã€ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ â†“ ã‚¢ãƒ©ãƒ¼ãƒˆ ãƒ‡ãƒ¼ã‚¿ã‚„ç®—å‡ºå€¤ã«ç•°å¸¸ãŒã‚ã‚‹å ´åˆã€ã“ã‚Œã‚’ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ã®é–‹ç™ºè€…ã«é€šçŸ¥ã™ã‚‹ã€‚ ç›£è¦–ã®ã‚¢ãƒ©ãƒ¼ãƒˆå¾Œã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ èª¬æ˜ ã‚ªãƒ³ã‚³ãƒ¼ãƒ« é€šçŸ¥ã‚’å—ã‘ãŸã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‹å¦ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã€‚ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç† ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ã¯ã€ã‚¨ãƒ©ãƒ¼ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã€å®Œäº†ã•ã›ã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ãŒã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®å ´åˆã€æ‹…å½“è€…ã¯ã“ã‚Œã‚’è¿…é€Ÿã«è§£æ±ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ SLAã¨ã®ç…§åˆ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã«ã‚ˆã£ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨è€…ã«æä¾›ã§ããŸã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ¬ãƒ™ãƒ«ãŒSLAã«æº€ãŸãªã‹ã£ãŸå ´åˆã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨è€…ã«åˆ©ç”¨æ–™ã‚’è¿”é‡‘ã™ã‚‹ã€‚ 01-02. ç›£è¦–ã®ç¨®é¡ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç›£è¦– ãƒ»ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç›£è¦–ã¨ã¯ ãƒ–ãƒ©ã‚¦ã‚¶ã«é–¢ã™ã‚‹ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç›£è¦–ã™ã‚‹ã€‚ ãƒ»ãƒªã‚¢ãƒ«ãƒ¦ãƒ¼ã‚¶ç›£è¦–ï¼ˆRUMï¼‰ ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€Webãƒšãƒ¼ã‚¸ã®ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã€Navigation-timing-APIã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€Webãƒšãƒ¼ã‚¸ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚ãƒªã‚¢ãƒ«ãƒ¦ãƒ¼ã‚¶ç›£è¦–ã§ã¯ã€ã“ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç›£è¦–ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/ja/docs/Web/API/Navigation_timing_API ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚é–“ã¯ç‰¹ã«é‡è¦ã§ã‚ã‚‹ã€‚Amazonã®è‡ªç¤¾èª¿æŸ»ã§ã¯ã€ãƒ­ãƒ¼ãƒ‰æ™‚é–“ãŒ100msçŸ­ããªã‚‹ã”ã¨ã«ã€å£²ã‚Šä¸Šã’ãŒ1%å¢—åŠ ã™ã‚‹ã“ã¨ãŒæ˜ã‚‰ã‹ã«ãªã£ãŸã€‚4ç§’ä»¥ä¸‹ã‚’ç›®æŒ‡ã™ã¨è‰¯ã„ã€‚ å‚è€ƒï¼šhttps://bit.ly/2y494hq ãƒ»åˆæˆç›£è¦–ï¼ˆå¤–éƒ¨ç›£è¦–ï¼‰ ã€å¤–éƒ¨ç›£è¦–ã€ã¨ã‚‚ã„ã†ã€‚SaaSã¯ã€å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ã®ä¸€é€£ã®æ“ä½œã‚’æ¨¡ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é€ä¿¡ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã€‚åˆæˆç›£è¦–ã§ã¯ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç›£è¦–ã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶ã‚’æ¨¡ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã¨ã„ã†æ„å‘³åˆã„ã§ã€ã€åˆæˆã€ã¨ã„ã†ã€‚ãƒ¦ãƒ¼ã‚¶è¦–ç‚¹ã§ç›£è¦–ã§ãã‚‹ã€‚ å‚è€ƒï¼š https://takehora.hatenadiary.jp/entry/2019/07/05/012036 https://www.manageengine.jp/products/Applications_Manager/solution_synthetic-monitoring.html ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–ï¼ˆAPMï¼‰ ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–ã¨ã¯ ã€APMï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ï¼‰ã€ã¨ã‚‚ã„ã†ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã«å¸¸é§ã•ã›ãŸSaaSã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€ã‚µãƒ¼ãƒå†…ã§ç¨¼åƒä¸­ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚’åé›†ã—ã€SaaSã«é€ä¿¡ã™ã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–ã§ã¯ã€ã“ã‚Œã‚‰ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚’ç›£è¦–ã™ã‚‹ã€‚ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ä¾‹ã¯ä»¥ä¸‹ã«ç¤ºã™ã€‚ SQLã«ã‹ã‹ã‚‹æ™‚é–“ ãƒ“ãƒ«ãƒ‰ã¾ãŸã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã®é–‹å§‹ï¼çµ‚äº†æ™‚é–“ å¤–éƒ¨APIã‚³ãƒ¼ãƒ«ã«ã‹ã‹ã‚‹æ™‚é–“ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å—ä¿¡æ•° ãƒ­ã‚°ã‚¤ãƒ³æ•° ãƒ»StatsDã‚’ç”¨ã„ãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ä½œæˆ ã‚µãƒ¼ãƒå†…ã«StatsDã‚’å¸¸é§ã•ã›ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§StatsDãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç”¨ã„ã‚‹ã¨ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã€‚ã“ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’SaaSã«é€ä¿¡ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/statsd/statsd/wiki CloudWatchã§ã¯StatsDã‹ã‚‰ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®é€ä¿¡ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-custom-metrics-statsd.html https://qiita.com/murata-tomohide/items/9bd1320865b2eba47538 ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠç›£è¦– ãƒ»ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠç›£è¦–ã¨ã¯ ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®OSã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã—ã€ã“ã‚Œã‚’SaaSã«é€ä¿¡ã™ã‚‹ã€‚ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠç›£è¦–ã§ã¯ã€ã“ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç›£è¦–ã™ã‚‹ã€‚ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ä¾‹ã¯ä»¥ä¸‹ã«ç¤ºã™ã€‚ CPU ãƒ¡ãƒ¢ãƒª ãƒ­ãƒ¼ãƒ‰ã‚¢ãƒ™ãƒ¬ãƒ¼ã‚¸ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ãƒ‡ã‚£ã‚¹ã‚¯ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦– ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦– 02. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç† ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã¨ã¯ ã‚µãƒ¼ãƒ“ã‚¹ã®åœæ­¢ã‚’èµ·ã“ã—å¾—ã‚‹æƒ³å®šå¤–ã®ã‚¤ãƒ™ãƒ³ãƒˆã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://www.atlassian.com/ja/incident-management/devops/incident-vs-problem-management MTTxãƒ¡ãƒˆãƒªã‚¯ã‚¹ ãƒ»MTTxãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã¯ åŒºåˆ† èª¬æ˜ æ¤œå‡ºæ™‚é–“ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒèµ·ã“ã£ã¦ã‹ã‚‰ã€ã“ã‚ŒãŒã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ã«ã‚¢ãƒ©ãƒ¼ãƒˆã•ã‚Œã‚‹ã¾ã§ã€‚ ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸æ™‚é–“ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ã«ã‚¢ãƒ©ãƒ¼ãƒˆã•ã‚Œã€ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“æœ¬äººï¼ã‚¢ã‚µã‚¤ãƒ³ã•ã‚ŒãŸã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒã‚¿ã‚¹ã‚¯ã¨ã—ã¦ç€æ‰‹ã™ã‚‹ã¾ã§ã€‚ ä¿®æ­£æ™‚é–“ ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ãŒã‚¿ã‚¹ã‚¯ã«ç€æ‰‹ã—ã¦ã‹ã‚‰ã€ã“ã‚Œã‚’å®Œäº†ã™ã‚‹ã¾ã§ã€‚ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ã«è¦ã—ãŸæ™‚é–“ã‚’è¨ˆæ¸¬ã—ãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã“ã¨ã€‚ å‚è€ƒï¼š https://www.amazon.co.jp/dp/4873119618 https://medium.com/@yoannutc/setting-objectives-for-incident-response-634fff2d8262 ãƒ»ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ MTTxãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åŒ–ã™ã‚‹ã€‚å®Ÿéš›ã«æ™‚é–“ã¨ç›®æ¨™æ™‚é–“ã‚’æ¯”è¼ƒã™ã‚Œã°ã€ä»Šå›ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ã®è‰¯ã—æ‚ªã—ã‚’åˆ¤æ–­ã§ãã‚‹ãŸã‚ã€ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†è‡ªä½“ã‚’ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã¨åŒæ§˜ã«åå¾©çš„ã«æ”¹å–„ã—ã‚„ã™ãã«ãªã‚‹ã€‚DRI Hopsï¼ˆã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®ç›´æ¥è²¬ä»»è€…ï¼‰ã®å€¤ã‚’ç”¨ã„ã¦äººçš„ã‚³ã‚¹ãƒˆã‚’å¯è¦–åŒ–ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãƒãƒãƒ¼ã‚¸ãƒ£ãŒã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ã‚’æ‰±ã„ã‚„ã™ããªã‚‹ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/4873119618 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã«åŸºã¥ãå½¹å‰²åˆ†é›¢ ãƒ»ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã¨ã¯ ç½å®³ã‚„äº‹æ•…ã®ç™ºç”Ÿæ™‚ã«ã€çµ„ç¹”ãŒæ··ä¹±ã›ãšã«å•é¡Œã«å¯¾å‡¦ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ãƒãƒãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ‰‹æ³•ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://fastalert.jp/column/disaster-prevention/incident-command-system ãƒ»æŒ‡æ® ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®çŠ¶æ³æŠŠæ¡ã‚’æ‹…å½“ã™ã‚‹ã€‚ã¾ãŸã€ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆæ‹…å½“ãƒãƒ¼ãƒ ã‚’çµ„ç¹”ã—ã€å„æ‹…å½“è€…ã«ã‚¿ã‚¹ã‚¯ã‚’å‰²ã‚ŠæŒ¯ã‚‹ã€‚ ãƒ»å®Ÿè¡Œ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®è§£æ±ºã‚’æ‹…å½“ã™ã‚‹ã€‚ ãƒ»è¨ˆç”» ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ã¸ã®çŠ¶æ³å ±å‘Šã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä½œæˆã‚’æ‹…å½“ã™ã‚‹ã€‚ ãƒ»å¾Œæ–¹æ”¯æ´ ä½œæ¥­è€…ã®ã‚µãƒãƒ¼ãƒˆã‚’æ‹…å½“ã™ã‚‹ã€‚ä½œæ¥­è€…é–“å¼•ç¶™ãã®èª¿æ•´ã€å¤•é£Ÿã®ç™ºæ³¨ã€ãªã©ãŒã‚ã‚‹ã€‚ ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ  ãƒ»ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã¨ã¯ ã‚¢ãƒ©ãƒ¼ãƒˆã§é€šçŸ¥ã•ã‚ŒãŸã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒãƒ“ã‚¸ãƒã‚¹ã«å¤§ããªå½±éŸ¿ã‚’ä¸ãˆãŸå ´åˆã€æŒ¯ã‚Šè¿”ã‚Šã¨ã—ã¦ã€ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã‚’ä½œæˆã™ã‚‹ã€‚ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã¯ã€éšœå®³å ±å‘Šæ›¸ã¨ã¯ç•°ãªã‚Šã€åŸå› ç‰¹å®šã¨ã‚·ã‚¹ãƒ†ãƒ æ”¹å–„ã«é‡ãã‚’ç½®ã„ãŸå ±å‘Šæ›¸ã§ã‚ã‚‹ã€‚éšœå®³å ±å‘Šæ›¸ã¯ã€è²¬ä»»ã®å ±å‘Šã®æ„å‘³åˆã„ãŒå¼·ããªã£ã¦ã—ã¾ã†ã€‚ ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ å‚è€ƒï¼šhttps://ueokande.github.io/incident-response-docs-ja/after/post_mortem_template/ # ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ  ## ã‚¿ã‚¤ãƒˆãƒ« ## æ—¥ä»˜ ## æ‹…å½“è€… **â€»æ‹…å½“è€…ã‚’çµ¶å¯¾ã«è²¬ã‚ãšã€éšœå®³ã¯èª°ã®ã›ã„ã§ã‚‚ãªã„ã¨ã„ã†æ„è­˜ã‚’å¼·ãæŒã¤ã€‚** ## åŸå› ã¨å¯¾å¿œ **â€»åŸå› ç‰¹å®šã¨ã‚·ã‚¹ãƒ†ãƒ æ”¹å–„ã«é‡ãã‚’ç½®ãã“ã¨ã€‚** ## ã‚·ã‚¹ãƒ†ãƒ çš„/åç›Šçš„ãªå½±éŸ¿ç¯„å›² ## å¹¸é‹ã ã£ãŸã“ã¨ ## ä»•çµ„ã¿ã®æ”¹å–„ç­– **â€»ã€ä»¥å¾Œã¯æ³¨æ„ã™ã‚‹ã€ã§ã¯ãªãã€å†ç™ºã—ãªã„ä»•çµ„ã¿ä½œã‚Šã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚** ## éšœå®³ç™ºç”Ÿã‹ã‚‰å¯¾å¿œã¾ã§ã®ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ ãƒ»ä»–ç¤¾äº‹ä¾‹ å‚è€ƒï¼šhttps://ueokande.github.io/incident-response-docs-ja/after/post_mortem_process/#_6 ã‚µãƒ¼ãƒ“ã‚¹ ãƒªãƒ³ã‚¯ AWS https://aws.amazon.com/jp/message/5467D2/ Heroku https://status.heroku.com/incidents/151 Twilio https://www.twilio.com/blog/2013/07/billing-incident-post-mortem-breakdown-analysis-and-root-cause.html 03. ç›£è¦–ã«åŸºã¥ãæ„æ€æ±ºå®š SLIï¼šService Level Indicatorï¼ˆã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«æŒ‡æ¨™ï¼‰ ãƒ»SLIã¨ã¯ ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«ã®æŒ‡æ¨™ã¨ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã“ã¨ã€‚ ãƒ»SLIã®ä¾‹ ã‚µãƒ¼ãƒç¨¼åƒç‡ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¨¼åƒç‡ ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ  ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ç‡ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ SLOï¼šService Level Objectiveï¼ˆã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«ç›®æ¨™ï¼‰ ãƒ»SLOã¨ã¯ SLIã¨ã—ã¦æ¡ç”¨ã—ãŸæŒ‡æ¨™ã®ç›®æ¨™å€¤ã®ã“ã¨ã€‚ãƒ¦ãƒ¼ã‚¶ã®è¦–ç‚¹ã§è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚99.9%ã®æˆåŠŸç‡ã‚’ç›®æ¨™ã¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚ ãƒ»SLOã®ä¾‹ æŒ‡æ¨™ ç›®æ¨™å€¤ã®ä¾‹ ã‚µãƒ¼ãƒç¨¼åƒç‡ æ—¥å½“ãŸã‚Š0.1%ä»¥ä¸‹ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¨¼åƒç‡ æ—¥å½“ãŸã‚Š0.1%ä»¥ä¸‹ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ æ—¥å½“ãŸã‚Š0.1%ä»¥ä¸‹ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ç‡ æ—¥å½“ãŸã‚Š99.9%ä»¥ä¸Šã®200ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ æ—¥å½“ãŸã‚Š0.1%ä»¥ä¸‹ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆä½ä¸‹ ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆ ãƒ»ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆã¨ã¯ å¹´æœˆå½“ãŸã‚Šã§è¨±å®¹ã™ã‚‹ã‚¨ãƒ©ãƒ¼ã‚„ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®ç¨‹åº¦ã®ã“ã¨ã€‚ã‚¨ãƒ©ãƒ¼ã‚„ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã®ç™ºç”Ÿã«ã‚ˆã£ã¦ãƒ“ã‚¸ãƒã‚¹ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã£ãŸã¨ã—ã¦ã‚‚ã€SLOã®é–¾å€¤ã‚’è¶…ãˆãªã„é™ã‚Šã¯ã“ã‚Œã‚’è¨±å®¹ã—ã€æŠ€è¡“ã‚’å„ªå…ˆã™ã‚‹ã€‚ãƒ“ã‚¸ãƒã‚¹ã‚ˆã‚ŠæŠ€è¡“ã‚’å„ªå…ˆã™ã‚‹æ™‚ã«ã€ç´ æ—©ãæ„æ€æ±ºå®šã§ãã‚‹ã€‚ SLAï¼šService Level Agreement ãƒ»SLAã¨ã¯ ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«åˆæ„ã¨è¨³ã›ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹ã«æœ€ä½é™ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ¬ãƒ™ãƒ«ã‚’ä¿è¨¼ã—ã€ã“ã‚Œã‚’ä¸‹å›ã£ãŸå ´åˆã«ã¯è¿”é‡‘ã§ãã‚‹ã‚ˆã†ã«åˆæ„ã™ã‚‹ã‚‚ã®ã€‚SLAã¨ã—ã¦ã€ä¾‹ãˆã°ä»¥ä¸‹ãŒã‚ã‚‹ã€‚ é …ç›® èª¬æ˜ ãƒ¬ãƒ™ãƒ«ä¾‹ è¿”é‡‘ç‡ ã‚µãƒ¼ãƒç¨¼åƒç‡ ã‚µãƒ¼ãƒã®æ™‚é–“å½“ãŸã‚Šã®ç¨¼åƒç‡ 99.9%ä»¥ä¸Š 10% éšœå®³å›å¾©æ™‚é–“ éšœå®³ãŒèµ·ã“ã£ã¦ã‹ã‚‰å›å¾©ã™ã‚‹ã¾ã§ã®æ™‚é–“ 2æ™‚é–“ä»¥å†… 10% éšœå®³ãŠå•ã„åˆã‚ã› éšœå®³ç™ºç”Ÿæ™‚ã®ãŠå•ã„åˆã‚ã›å¯èƒ½æ™‚é–“å¸¯ 24æ™‚é–“365æ—¥ 10% ãƒ»AWSã®SLA AWSã§ã¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«ã®é …ç›®ã¨ã—ã¦ã€ã‚µãƒ¼ãƒç¨¼åƒç‡ã‚’æ¡ç”¨ã—ã¦ã„ã‚‹ã€‚ã“ã‚Œã«å¯¾ã—ã¦ã€ã»ã¨ã‚“ã©ã®AWSãƒªã‚½ãƒ¼ã‚¹ã§ã€ä»¥ä¸‹ã®SLAãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚å„ãƒªã‚½ãƒ¼ã‚¹ã«SLAãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/legal/service-level-agreements/ ï¼Šä¾‹ï¼Š EC2ã€EBSã€ECSã€EKSã€ã®ä¾‹ã‚’ç¤ºã™ã€‚ æ¯æœˆã®ç¨¼åƒç‡ ç™ºç”Ÿã—ãŸãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ  è¿”é‡‘ç‡ 99.0ï¼…ä»¥ä¸Šã€99.99%æœªæº€ 87.6ï½0.876æ™‚é–“ 10% 95.0ï¼…ä»¥ä¸Šã€99.0ï¼…æœªæº€ 438ï½87.6æ™‚é–“ 30% 95.0%æœªæº€ 438æ™‚é–“ä»¥ä¸Š 100% "},"public/observability_monitering/observability_fluentd_and_fluentbit.html":{"url":"public/observability_monitering/observability_fluentd_and_fluentbit.html","title":"ğŸ“– ï¸Fluentdï¼FluentBit","keywords":"","body":"Fluentdï¼FluentBit ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Fluentdï¼FluentBitã¨ã¯ æ¦‚è¦ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ãƒ­ã‚°ã‚’åé›†ã—ã€ã“ã‚Œã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸå¾Œã€è¤‡æ•°ã®å®›å…ˆã«è»¢é€ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/about/fluentd-and-fluent-bit Fluentd vs. FluentBit Fluentd FluentBit ã‚¹ã‚³ãƒ¼ãƒ— ã‚³ãƒ³ãƒ†ãƒŠï¼ã‚µãƒ¼ãƒ çµ„ã¿è¾¼ã¿Linuxï¼ã‚³ãƒ³ãƒ†ãƒŠï¼ã‚µãƒ¼ãƒ è¨€èª C & Ruby NS ãƒ¡ãƒ¢ãƒªæœ€å¤§ä½¿ç”¨é‡ 40MB 650KB ä¾å­˜é–¢ä¿‚ æ¨™æº–ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ä¸€å®šæ•°ã®Ruby gemã«ä¾å­˜ã™ã‚‹ã€‚ æ¨™æº–ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ä¾å­˜ã—ãªã„ã€‚ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ é«˜ é«˜ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ•° 1000å€‹ä»¥ä¸Š 70å€‹ "},"public/observability_monitering/observability_fluentbit.html":{"url":"public/observability_monitering/observability_fluentbit.html","title":"ğŸ“– ï¸FluentBit","keywords":"","body":"FluentBit 01. ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ã¯ FluentBitã«ã¦ã€ãƒ­ã‚°ã‚’å‡¦ç†ã™ã‚‹ä¸€é€£ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã“ã¨ã€‚ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¨­å®š ãƒ»confãƒ•ã‚¡ã‚¤ãƒ« confãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/administration/configuring-fluent-bit/configuration-file è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã‹ã‚‰è¡Œã†ã€‚ å‚è€ƒï¼šhttps://cloud.calyptia.com/visualizer ãƒ»ã‚³ãƒãƒ³ãƒ‰ ã‚³ãƒãƒ³ãƒ‰ã§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚ Available Options -b --storage_path=PATH specify a storage buffering path -c --config=FILE specify an optional configuration file -d, --daemon run Fluent Bit in background mode -D, --dry-run dry run -f, --flush=SECONDS flush timeout in seconds (default: 5) -F --filter=FILTER set a filter -i, --input=INPUT set an input -m, --match=MATCH set plugin match, same as '-p match=abc' -o, --output=OUTPUT set an output -p, --prop=\"A=B\" set plugin configuration property -R, --parser=FILE specify a parser configuration file -e, --plugin=FILE load an external plugin (shared lib) -l, --log_file=FILE write log info to a file -t, --tag=TAG set plugin tag, same as '-p tag=abc' -T, --sp-task=SQL define a stream processor task -v, --verbose increase logging verbosity (default: info) -w, --workdir set the working directory -H, --http enable monitoring HTTP server -P, --port set HTTP server TCP port (default: 2020) -s, --coro_stack_size set coroutines stack size in bytes (default: 24576) -q, --quiet quiet mode -S, --sosreport support report for Enterprise customers -V, --version show version number -h, --help print this help 02. ã‚»ã‚¯ã‚·ãƒ§ãƒ³ SERVICE ãƒ»SERVICEã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¨ä½“ã®è¨­å®šã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã‚’å®šç¾©ã™ã‚‹ã€‚å„è¨­å®šã®é ­æ–‡å­—ã¯å¤§æ–‡å­—ã¨ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š [SERVICE] Flush 1 # çŒ¶äºˆæ™‚é–“ Grace 30 # FluentBitè‡ªä½“ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« Log_Level info # èª­ã¿è¾¼ã¾ã‚Œã‚‹Parsers Multilineãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ Parsers_File parsers_multiline.conf # èª­ã¿è¾¼ã¾ã‚Œã‚‹Stream Processorãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ Streams_File stream_processor.conf ãƒ»å®Ÿè¡Œãƒ­ã‚°ã®ç¢ºèª Log_Levelå€¤ã§FluentBitã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’åˆ¶å¾¡ã§ãã‚‹ã€‚debugã‚’å‰²ã‚Šå½“ã¦ã‚‹ã¨ã€FluentBitã®ãƒ­ã‚°ãŒã‚ˆã‚Šè©³ç´°ã«ãªã‚Šã€å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¨­å®šå€¤ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè¡Œãƒ­ã‚°ä¾‹ï¼Š Fluent Bit v1.8.6 * Copyright (C) 2019-2021 The Fluent Bit Authors * Copyright (C) 2015-2018 Treasure Data * Fluent Bit is a CNCF sub-project under the umbrella of Fluentd * https://fluentbit.io [2021/01/01 12:00:00] [ info] Configuration: [2021/01/01 12:00:00] [ info] flush time | 1.000000 seconds [2021/01/01 12:00:00] [ info] grace | 30 seconds [2021/01/01 12:00:00] [ info] daemon | 0 [2021/01/01 12:00:00] [ info] ___________ [2021/01/01 12:00:00] [ info] inputs: [2021/01/01 12:00:00] [ info] forward [2021/01/01 12:00:00] [ info] ___________ [2021/01/01 12:00:00] [ info] filters: [2021/01/01 12:00:00] [ info] stdout.0 [2021/01/01 12:00:00] [ info] ___________ [2021/01/01 12:00:00] [ info] outputs: [2021/01/01 12:00:00] [ info] null.0 [2021/01/01 12:00:00] [ info] ___________ [2021/01/01 12:00:00] [ info] collectors: [2021/01/01 12:00:00] [ info] [engine] started (pid=1) [2021/01/01 12:00:00] [debug] [engine] coroutine stack size: 24576 bytes (24.0K) [2021/01/01 12:00:00] [debug] [storage] [cio stream] new stream registered: forward.0 [2021/01/01 12:00:00] [ info] [storage] version=1.1.1, initializing... [2021/01/01 12:00:00] [ info] [storage] in-memory [2021/01/01 12:00:00] [ info] [storage] normal synchronization mode, checksum disabled, max_chunks_up=128 [2021/01/01 12:00:00] [ info] [cmetrics] version=0.2.1 [2021/01/01 12:00:00] [debug] [in_fw] Listen='0.0.0.0' TCP_Port=24224 [2021/01/01 12:00:00] [ info] [input:forward:forward.0] listening on 0.0.0.0:24224 [2021/01/01 12:00:00] [debug] [null:null.0] created event channels: read=21 write=22 [2021/01/01 12:00:00] [debug] [router] match rule forward.0:null.0 [2021/01/01 12:00:00] [ info] [sp] stream processor started INPUT ãƒ»INPUTã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ãƒ­ã‚°ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¸ã®å…¥åŠ›æ–¹æ³•ã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/concepts/data-pipeline/input ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç”¨ã„ã¦ã€ãƒ­ã‚°ã®å…¥åŠ›æ–¹æ³•ã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/inputs ã‚³ãƒãƒ³ãƒ‰ã®-iã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§INPUTåã‚’æŒ‡å®šã—ã€å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ Inputs cpu CPU Usage mem Memory Usage thermal Thermal kmsg Kernel Log Buffer proc Check Process health disk Diskstats systemd Systemd (Journal) reader netif Network Interface Usage docker Docker containers metrics docker_events Docker events node_exporter_metrics Node Exporter Metrics (Prometheus Compatible) fluentbit_metrics Fluent Bit internal metrics tail Tail files dummy Generate dummy data head Head Input health Check TCP server health http HTTP collectd collectd input plugin statsd StatsD input plugin serial Serial input stdin Standard Input syslog Syslog exec Exec Input tcp TCP mqtt MQTT, listen for Publish messages forward Fluentd in-forward random Random ãƒ»dummyãƒ—ãƒ©ã‚°ã‚¤ãƒ³ ãƒ€ãƒŸãƒ¼ã®æ§‹é€ åŒ–ãƒ­ã‚°ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«å…¥åŠ›ã™ã‚‹ã€‚éæ§‹é€ åŒ–ãƒ­ã‚°ã¯å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ç”¨ã§ããªã„ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«å½¹ç«‹ã¤ã€‚ å‚è€ƒï¼š https://docs.fluentbit.io/manual/pipeline/inputs/dummy https://docs.fluentbit.io/manual/local-testing/logging-pipeline { \"message\": \"dummy\" } ï¼Šå®Ÿè£…ä¾‹ï¼Š [INPUT] Name dummy # ãƒ€ãƒŸãƒ¼JSONãƒ‡ãƒ¼ã‚¿ Dummy {\"message\":\"dummy\"} ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š fluent-bit/bin/fluent-bit -i dummy -o stdout ãƒ»forwardãƒ—ãƒ©ã‚°ã‚¤ãƒ³ å—ä¿¡ã—ãŸãƒ­ã‚°ã‚’æŒ‡å®šã•ã‚ŒãŸãƒãƒ¼ãƒˆã§ãƒªãƒƒã‚¹ãƒ³ã—ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«å…¥åŠ›ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/inputs/forward ï¼Šå®Ÿè£…ä¾‹ï¼Š [INPUT] # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å Name forward Listen 0.0.0.0 # ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªãƒƒã‚¹ãƒ³ãƒãƒ¼ãƒˆ ï¼Šå®Ÿè¡Œãƒ­ã‚°ä¾‹ï¼Š Fluent Bit v1.8.6 * Copyright (C) 2019-2021 The Fluent Bit Authors * Copyright (C) 2015-2018 Treasure Data * Fluent Bit is a CNCF sub-project under the umbrella of Fluentd * https://fluentbit.io [2021/01/01 12:00:00] [ info] [engine] started (pid=1) [2021/01/01 12:00:00] [ info] [storage] version=1.1.1, initializing... [2021/01/01 12:00:00] [ info] [storage] in-memory [2021/01/01 12:00:00] [ info] [storage] normal synchronization mode, checksum disabled, max_chunks_up=128 [2021/01/01 12:00:00] [ info] [cmetrics] version=0.2.1 [2021/01/01 12:00:00] [ info] [input:forward:forward.0] listening on 0.0.0.0:24224 [2021/01/01 12:00:00] [ info] [sp] stream processor started ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ fluent-bit/bin/fluent-bit \\ -i forward \\ -o stdout ãƒ»tailãƒ—ãƒ©ã‚°ã‚¤ãƒ³ æŒ‡å®šã—ãŸãƒ‘ã‚¹ã«ç¶™ç¶šçš„ã«å‡ºåŠ›ã•ã‚Œã‚‹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é †æ¬¡çµåˆã—ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«å…¥åŠ›ã™ã‚‹ã€‚ã‚ã‚‰ã‹ã˜ã‚ã€FluentBitã‚³ãƒ³ãƒ†ãƒŠå†…ã«ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€Pathã§ã“ã‚Œã‚’æŒ‡å®šã™ã‚‹ã€‚v1.8ã‚’å¢ƒã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/inputs/tail ï¼Šå®Ÿè£…ä¾‹ï¼Š [INPUT] # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å Name tail # FluentBitã‚³ãƒ³ãƒ†ãƒŠå†…ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã€‚ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã§ãã‚‹ã€‚ Path /var/www/foo/storage/logs/*.log # ç”¨ã„ã‚‹ãƒ‘ãƒ¼ã‚µãƒ¼å multiline.parser laravel-multiline-parser log_router: container_name: fluentbit build: dockerfile: ./docker/fluentbit/Dockerfile context: . volumes: # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®Volumeãƒã‚¦ãƒ³ãƒˆ - ./storage/logs:/var/www/foo/storage/logs ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/inputs/tail#command-line $ fluent-bit -i tail -p path=/var/www/foo/storage/logs/*.log -o stdout ï¼Šå®Ÿè¡Œãƒ­ã‚°ä¾‹ï¼Š * Copyright (C) 2019-2021 The Fluent Bit Authors * Copyright (C) 2015-2018 Treasure Data * Fluent Bit is a CNCF sub-project under the umbrella of Fluentd * https://fluentbit.io [2021/01/01 12:00:00] [ info] [engine] started (pid=1) [2021/01/01 12:00:00] [ info] [storage] version=1.1.1, initializing... [2021/01/01 12:00:00] [ info] [storage] in-memory [2021/01/01 12:00:00] [ info] [storage] normal synchronization mode, checksum disabled, max_chunks_up=128 [2021/01/01 12:00:00] [ info] [cmetrics] version=0.2.1 [2021/01/01 12:00:00] [ info] [sp] stream processor started [2021/01/01 12:00:00] [ info] [input:tail:tail.0] inotify_fs_add(): inode=31621169 watch_fd=1 name=/var/www/foo/storage/logs/laravel.log [0] tail.0: [1634640932.010306200, {\"log\"=>\"[2021-01-01 12:00:00] local.INFO: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\"}] [1] tail.0: [1634640932.013139300, {\"log\"=>\"[2021-01-01 12:00:00] local.INFO: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\"}] [2] tail.0: [1634640932.013147300, {\"log\"=>\"[2021-01-01 12:00:00] local.INFO: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\"}] PARSE ãƒ»PARSEã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ãƒ»MULTILINE_PARSERã‚»ã‚¯ã‚·ãƒ§ãƒ³ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/administration/configuring-fluent-bit/multiline-parsing ï¼Šå®Ÿè£…ä¾‹ï¼Š Laravelã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’çµåˆã™ã‚‹ã€‚ [MULTILINE_PARSER] # ãƒ‘ãƒ¼ã‚µãƒ¼å name laravel # ãƒ‘ãƒ¼ã‚µãƒ¼ã‚¿ã‚¤ãƒ— type regex flush_timeout 1000 # ãƒ‘ãƒ¼ã‚µãƒ¼ãƒ«ãƒ¼ãƒ«ã€‚ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®æ–‡é ­ã‚’start_stateã€ã¾ãŸä»¥é™ã«çµåˆã™ã‚‹æ–‡å­—åˆ—ã‚’contã§æŒ‡å®šã™ã‚‹ã€‚ # [%Y-%m-%d %H:%M:%S] ã‚’ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®é–‹å§‹åœ°ç‚¹ã¨ã™ã‚‹ã€‚ rule \"start_state\" \"/\\[[12]\\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])\\s+([01]?\\d|2[0-3]):([0-5]\\d):([0-5]\\d)\\].*/\" \"cont\" # [stacktrace]ã€[previous exception]ã€#ã€è¡Œé–“ã€\"} ã€ã§å§‹ã¾ã‚‹æ–‡å­—ã®å ´åˆã«çµåˆã™ã‚‹ã€‚ rule \"cont\" \"/(\\[(stacktrace|previous exception)\\]|#|\\n\\n|\"\\}).*/\" \"cont\" FILTER ãƒ»FILTERã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ç‰¹å®šã®æ–‡å­—åˆ—ã‚’æŒã¤ãƒ­ã‚°ã®ã¿ã‚’BUFFERã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è»¢é€ã™ã‚‹ã€‚ ãƒ»multilineãƒ—ãƒ©ã‚°ã‚¤ãƒ³ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/filters/multiline-stacktrace [FILTER] # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å name multiline match * multiline.key_content log # ç”¨ã„ã‚‹ãƒ‘ãƒ¼ã‚µãƒ¼å multiline.parser laravel ã‚³ãƒãƒ³ãƒ‰ã®-fã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§INPUTåã‚’æŒ‡å®šã—ã€å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ Filters alter_size Alter incoming chunk size aws Add AWS Metadata checklist Check records and flag them record_modifier modify record throttle Throttle messages using sliding window algorithm kubernetes Filter to append Kubernetes metadata modify modify records by applying rules multiline Concatenate multiline messages nest nest events by specified field values parser Parse events expect Validate expected keys and values grep grep events by specified field values rewrite_tag Rewrite records tags lua Lua Scripting Filter stdout Filter events to STDOUT geoip2 add geoip information to records ãƒ»stdoutãƒ—ãƒ©ã‚°ã‚¤ãƒ³ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/filters/standard-output [FILTER] # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å Name stdout Match * ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ fluent-bit/bin/fluent-bit \\ -i \\ -F stdout \\ -m '*' \\ -o null ï¼Šå®Ÿè¡Œãƒ­ã‚°ä¾‹ï¼Š Fluent Bit v1.8.6 * Copyright (C) 2019-2021 The Fluent Bit Authors * Copyright (C) 2015-2018 Treasure Data * Fluent Bit is a CNCF sub-project under the umbrella of Fluentd * https://fluentbit.io [2021/01/01 06:18:52] [ info] [engine] started (pid=40) [2021/01/01 06:18:52] [ info] [storage] version=1.1.1, initializing... [2021/01/01 06:18:52] [ info] [storage] in-memory [2021/01/01 06:18:52] [ info] [storage] normal synchronization mode, checksum disabled, max_chunks_up=128 [2021/01/01 06:18:52] [ info] [cmetrics] version=0.2.1 [2021/01/01 06:18:52] [ info] [sp] stream processor started [0] cpu.0: [1634710733.114477665, {\"cpu_p\"=>0.166667, \"user_p\"=>0.000000, \"system_p\"=>0.166667, \"cpu0.p_cpu\"=>0.000000, \"cpu0.p_user\"=>0.000000, \"cpu0.p_system\"=>0.000000, \"cpu1.p_cpu\"=>1.000000, \"cpu1.p_user\"=>0.000000, \"cpu1.p_system\"=>1.000000, \"cpu2.p_cpu\"=>0.000000, \"cpu2.p_user\"=>0.000000, \"cpu2.p_system\"=>0.000000, \"cpu3.p_cpu\"=>0.000000, \"cpu3.p_user\"=>0.000000, \"cpu3.p_system\"=>0.000000, \"cpu4.p_cpu\"=>0.000000, \"cpu4.p_user\"=>0.000000, \"cpu4.p_system\"=>0.000000, \"cpu5.p_cpu\"=>0.000000, \"cpu5.p_user\"=>0.000000, \"cpu5.p_system\"=>0.000000}] [0] cpu.0: [1634710734.115201385, {\"cpu_p\"=>0.333333, \"user_p\"=>0.166667, \"system_p\"=>0.166667, \"cpu0.p_cpu\"=>0.000000, \"cpu0.p_user\"=>0.000000, \"cpu0.p_system\"=>0.000000, \"cpu1.p_cpu\"=>0.000000, \"cpu1.p_user\"=>0.000000, \"cpu1.p_system\"=>0.000000, \"cpu2.p_cpu\"=>0.000000, \"cpu2.p_user\"=>0.000000, \"cpu2.p_system\"=>0.000000, \"cpu3.p_cpu\"=>0.000000, \"cpu3.p_user\"=>0.000000, \"cpu3.p_system\"=>0.000000, \"cpu4.p_cpu\"=>0.000000, \"cpu4.p_user\"=>0.000000, \"cpu4.p_system\"=>0.000000, \"cpu5.p_cpu\"=>0.000000, \"cpu5.p_user\"=>0.000000, \"cpu5.p_system\"=>0.000000}] [0] cpu.0: [1634710735.114646610, {\"cpu_p\"=>1.500000, \"user_p\"=>0.666667, \"system_p\"=>0.833333, \"cpu0.p_cpu\"=>0.000000, \"cpu0.p_user\"=>0.000000, \"cpu0.p_system\"=>0.000000, \"cpu1.p_cpu\"=>3.000000, \"cpu1.p_user\"=>2.000000, \"cpu1.p_system\"=>1.000000, \"cpu2.p_cpu\"=>2.000000, \"cpu2.p_user\"=>1.000000, \"cpu2.p_system\"=>1.000000, \"cpu3.p_cpu\"=>1.000000, \"cpu3.p_user\"=>0.000000, \"cpu3.p_system\"=>1.000000, \"cpu4.p_cpu\"=>1.000000, \"cpu4.p_user\"=>0.000000, \"cpu4.p_system\"=>1.000000, \"cpu5.p_cpu\"=>2.000000, \"cpu5.p_user\"=>1.000000, \"cpu5.p_system\"=>1.000000}] BUFFERã‚»ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»BUFFERã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ãƒãƒƒãƒ•ã‚¡ãƒ¼ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ãƒ¡ãƒ¢ãƒªï¼ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ãƒãƒ£ãƒ³ã‚¯åŒ–ã•ã‚ŒãŸãƒ­ã‚°ãƒ†ã‚­ã‚¹ãƒˆã¯ä¸€æ—¦ã‚¹ãƒ†ãƒ¼ã‚¸ã«è“„ãˆã‚‰ã‚Œã‚‹ã€‚ã‚¹ãƒ†ãƒ¼ã‚¸ã«ä¸€å®šé‡ã®ãƒãƒ£ãƒ³ã‚¯ãŒè“„ãˆã‚‰ã‚Œã‚‹ã¨ã€ãƒãƒ£ãƒ³ã‚¯ã¯ã‚­ãƒ¥ãƒ¼ã«æ ¼ç´ã•ã‚Œã‚‹ã€‚ã‚­ãƒ¥ãƒ¼ã¯ã€ãƒ­ã‚°ãƒ†ã‚­ã‚¹ãƒˆã‚’æŒ‡å®šã•ã‚ŒãŸå½¢å¼ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«é †ç•ªã«è»¢é€ã™ã‚‹ã€‚Fluentdã‹ã‚‰æ¦‚å¿µå›³ã‚’æ‹å€Ÿã—ãŸã€‚ã¡ãªã¿ã«ã€AWS Kinesis Data Firehoseã‚‚ä¼¼ãŸã‚ˆã†ãªãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ã¨è»¢é€ã®ä»•çµ„ã¿ã‚’æŒã£ã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://docs.fluentbit.io/manual/administration/buffering-and-storage https://atmarkit.itmedia.co.jp/ait/articles/1402/06/news007.html https://www.alpha.co.jp/blog/202103_01 ãƒ»ãƒ¡ãƒ¢ãƒªä¸Šã§ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚° å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/administration/buffering-and-storage#input-section-configuration ï¼Šå®Ÿè£…ä¾‹ï¼Š [SERVICE] flush 1 log_Level info [INPUT] name cpu # ãƒ¡ãƒ¢ãƒªä¸Šã§ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ï¼ˆæ¨™æº–å€¤ï¼‰ã€‚ storage.type memory ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ä¸Šã§ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚° å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/administration/buffering-and-storage#input-section-configuration ï¼Šå®Ÿè£…ä¾‹ï¼Š [SERVICE] flush 1 log_Level info # ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ storage.path /var/log/fluentbit/ [INPUT] name cpu # ãƒ•ã‚¡ã‚¤ãƒ«ä¸Šã§ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ storage.type filesystem æŒ‡å®šã—ãŸå ´æ‰€ã«cpu.0ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã€ãã“ã«ã‚ã‚‹flbãƒ•ã‚¡ã‚¤ãƒ«ä¸Šã§ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ $ ls -ls /var/log/fluentbit/cpu.0 -rw------- 1 root root 4096 Oct 20 15:51 1-1634745095.575805200.flb STREAM_TASKã‚»ã‚¯ã‚·ãƒ§ãƒ³ ãƒ»STREAM_TASKã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ãƒãƒ£ãƒ³ã‚¯åŒ–ã•ã‚ŒãŸãƒ­ã‚°ã«ã‚¿ã‚°ä»˜ã‘ã‚’è¡Œã†ã€‚ã‚¿ã‚°ä»˜ã‘ã•ã‚ŒãŸãƒ­ã‚°ã¯ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®INPUTã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å†åº¦å–ã‚Šè¾¼ã¾ã‚Œã€å‡¦ç†ã—ç›´ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/stream-processing/overview#stream-processor STREAM_TASKã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ã€ãƒ­ã‚°SQLã§å®šç¾©ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/stream-processing/getting-started/fluent-bit-sql [STREAM_TASK] Name foo Exec CREATE STREAM foo AS SELECT * FROM TAG:'foo'; OUTPUT ãƒ»OUTPUTã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ ãƒãƒ£ãƒ³ã‚¯ã¨ã—ã¦è“„ãˆã‚‰ã‚ŒãŸãƒ­ã‚°ã®å‡ºåŠ›å…ˆã‚’å®šç¾©ã™ã‚‹ã€‚è¨­å®šå¯èƒ½ãªå‡ºåŠ›å…ˆã®ç¨®é¡ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/outputs ã‚³ãƒãƒ³ãƒ‰ã®-oã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§INPUTåã‚’æŒ‡å®šã—ã€å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ Outputs azure Send events to Azure HTTP Event Collector azure_blob Azure Blob Storage bigquery Send events to BigQuery via streaming insert counter Records counter datadog Send events to DataDog HTTP Event Collector es Elasticsearch exit Exit after a number of flushes (test purposes) file Generate log file forward Forward (Fluentd protocol) http HTTP Output influxdb InfluxDB Time Series logdna LogDNA loki Loki kafka Kafka kafka-rest Kafka REST Proxy nats NATS Server nrlogs New Relic null Throws away events plot Generate data file for GNU Plot slack Send events to a Slack channel splunk Send events to Splunk HTTP Event Collector stackdriver Send events to Google Stackdriver Logging stdout Prints events to STDOUT syslog Syslog tcp TCP Output td Treasure Data flowcounter FlowCounter gelf GELF Output websocket Websocket cloudwatch_logs Send logs to Amazon CloudWatch kinesis_firehose Send logs to Amazon Kinesis Firehose kinesis_streams Send logs to Amazon Kinesis Streams prometheus_exporter Prometheus Exporter prometheus_remote_write Prometheus remote write s3 Send to S3 ãƒ»AWSã®ä»»æ„ã®ãƒªã‚½ãƒ¼ã‚¹ã«å‡ºåŠ› AWSã‹ã‚‰æä¾›ã•ã‚Œã‚‹ä»–ã®å…¨ã¦ã®FluentBitã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŸã­ãŸãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws/amazon-cloudwatch-logs-for-fluent-bit ãƒ»Cloudwatchãƒ­ã‚°ã¸ã®å‡ºåŠ› cloudwatch_logsãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã‚‰ã‹ã˜ã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws/amazon-cloudwatch-logs-for-fluent-bit è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«äºˆç´„ã•ã‚ŒãŸAWSå¤‰æ•°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://github.com/aws/amazon-cloudwatch-logs-for-fluent-bit#templating-log-group-and-stream-names ######################### # CloudWatchãƒ­ã‚°ã¸ã®è»¢é€ ######################### [OUTPUT] # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å Name cloudwatch_logs # è»¢é€å¯¾è±¡ã¨ã™ã‚‹ãƒ­ã‚°ã®ã‚¿ã‚° Match laravel # ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆJSONã®ã†ã¡ã€å®›å…ˆã«è»¢é€ã™ã‚‹ã‚­ãƒ¼å log_key log region ap-northeast-1 # äºˆç´„å¤‰æ•°ã‚ã‚Šã€‚ log_group_name /prd-foo-ecs-container/laravel/log # ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ åã€‚äºˆç´„å¤‰æ•°ã‚ã‚Šã€‚ã‚¿ã‚¹ã‚¯IDãªã©å‡ºåŠ›ã§ãã‚‹ã€‚ log_stream_name container/laravel/$(ecs_task_id) [OUTPUT] Name cloudwatch_logs Match nginx log_key log region ap-northeast-1 log_group_name /prd-foo-ecs-container/nginx/log log_stream_name container/nginx/$(ecs_task_id) CloudWatchãƒ­ã‚°ã«é€ä¿¡ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯JSONå‹ã§ã‚ã‚‹ã€‚logã‚­ãƒ¼ã«ãƒ­ã‚°ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ç‰¹å®šã®ã‚­ãƒ¼ã®å€¤ã®ã¿ã‚’CloudWatchãƒ­ã‚°ã«é€ä¿¡ã™ã‚‹å ´åˆã€log_keyã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚­ãƒ¼åã‚’è¨­å®šã™ã‚‹ã€‚ä¾‹ãˆã°ã€logã‚­ãƒ¼ã®ã¿ã‚’é€ä¿¡ã™ã‚‹å ´åˆã€ã€logã€ã¨è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://blog.msysh.me/posts/2020/07/split_logs_into_multiple_target_with_firelens_and_rewrite_tag.html { \"container_id\": \"*****\", \"container_name\": \"prd-foo-ecs-container\", \"ecs_cluster\": \"prd-foo-ecs-cluster\", \"ecs_task_arn\": \"arn:aws:ecs:ap-northeast-1:****:task/cluster-name/*****\", \"ecs_task_definition\": \"prd-foo-ecs-task-definition:1\", \"log\": \"\", \"source\": \"stdout\", \"ver\": \"1.5\" } ãƒ»Datadogã¸ã®å‡ºåŠ› å…¨ã¦ã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã«æ¨™æº–ã§datadogãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€datadogãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/DataDog/fluent-plugin-datadog ######################### # Datadogã¸ã®è»¢é€ ######################### [OUTPUT] # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å Name datadog # è»¢é€å¯¾è±¡ã¨ã™ã‚‹ãƒ­ã‚°ã®ã‚¿ã‚° Match laravel # è»¢é€å…ˆãƒ›ã‚¹ãƒˆ Host http-intake.logs.datadoghq.com TLS on compress gzip # Datadogã®APIã‚­ãƒ¼ã€‚ apikey ***** # Datadogãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã«ãŠã‘ã‚‹Serviceå dd_service prd-foo # Datadogãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã«ãŠã‘ã‚‹Sourceå dd_source prd-foo dd_message_key log # è¿½åŠ ã‚¿ã‚° dd_tags env:prd-foo [OUTPUT] Name datadog Match nginx Host http-intake.logs.datadoghq.com TLS on compress gzip apikey ***** dd_service prd-foo dd_source prd-foo dd_message_key log dd_tags env:prd-foo ä»£ã‚ã‚Šã«ã€åŒã˜è¨­å®šã‚’FireLensã®logConfigurationã‚­ãƒ¼ã¨ã—ã¦ã‚‚é©ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws-samples/amazon-ecs-firelens-examples/blob/mainline/examples/fluent-bit/datadog/README.md \"logConfiguration\": { \"logDriver\":\"awsfirelens\", \"options\": { \"Name\": \"datadog\", \"Host\": \"http-intake.logs.datadoghq.com\", \"TLS\": \"on\", \"apikey\": \"\", \"dd_service\": \"prd-foo\", \"dd_source\": \"prd-foo\", \"dd_tags\": \"env:prd-foo\", \"provider\": \"ecs\" } }, ãƒ»Kinesis Firehoseã¸ã®å‡ºåŠ› kinesis_firehoseãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã‚‰ã‹ã˜ã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws/amazon-kinesis-firehose-for-fluent-bit ãƒ»Kinesis Streamsã¸ã®å‡ºåŠ› kinesis_streamsãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã‚‰ã‹ã˜ã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws/amazon-kinesis-streams-for-fluent-bit ãƒ»NewRelicã¸ã®å‡ºåŠ› newRelicãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã‚‰ã‹ã˜ã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç”¨ã„ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/newrelic/newrelic-fluent-bit-output ãƒ»æ¨™æº–å‡ºåŠ›ã¸ã®å‡ºåŠ› æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã™ã‚‹ã€FluentBitã®å®Ÿè¡Œãƒ­ã‚°ã§ã“ã‚Œã‚’ç¢ºèªã§ãã‚‹ã€‚ [OUTPUT] Name stdout match * ãƒ»ç ´æ£„ å‡ºåŠ›ã‚’ç ´æ£„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/outputs/null ï¼Šå®Ÿè£…ä¾‹ï¼Š [OUTPUT] Name null match * ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼Š $ fluent-bit/bin/fluent-bit \\ -i \\ -F stdout \\ -m '*' \\ -o null 03. Fargateã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã®ãƒ­ã‚°åé›† FireLensã‚³ãƒ³ãƒ†ãƒŠ ãƒ»FireLensã‚³ãƒ³ãƒ†ãƒŠã¨ã¯ AWSãŒæä¾›ã™ã‚‹FluentBitï¼Fluentdã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã‚ˆã£ã¦æ§‹ç¯‰ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒŠã§ã‚ã‚Šã€Fargateã‚³ãƒ³ãƒ†ãƒŠã®ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦é…ç½®ã•ã‚Œã‚‹ã€‚Fargateã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒ­ã‚°ãŒé€ä¿¡ã•ã‚Œã‚‹ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ç¨¼åƒã™ã‚‹FluentBitï¼FluentdãŒã“ã‚Œã‚’åé›†ã—ã€ã“ã‚Œã‚’ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«è»¢é€ã™ã‚‹ã€‚æ§‹ç¯‰ã®ãŸã‚ã®å®Ÿè£…ä¾‹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://github.com/aws-samples/amazon-ecs-firelens-examples https://aws.amazon.com/jp/blogs/news/announcing-firelens-a-new-way-to-manage-container-logs/ ãƒ»ãƒ­ã‚°ã®è»¢é€å…ˆ FluentBitï¼FluentdãŒå¯¾å¿œã™ã‚‹ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ãƒ­ã‚°ã‚’è»¢é€ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.fluentbit.io/manual/pipeline/outputs ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠãƒ‘ã‚¿ãƒ¼ãƒ³ ãƒ»ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å«ã‚€ã‚³ãƒ³ãƒ†ãƒŠãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/virtualization/virtualization_container_orchestration.html ãƒ»ãƒ­ã‚°ã®åé›†ï¼è»¢é€ã®ä»•çµ„ã¿ ä»¥ä¸‹ã®é †ç•ªã§ãƒ­ã‚°ã®åé›†ï¼è»¢é€ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/blogs/news/under-the-hood-firelens-for-amazon-ecs-tasks/ awsfirelensãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¯Fluentdãƒ­ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ãƒ©ãƒƒãƒ”ãƒ³ã‚°ã—ãŸã‚‚ã®ã§ã‚ã‚Šã€ãƒ­ã‚°ã‚’FireLensã‚³ãƒ³ãƒ†ãƒŠã«é€ä¿¡ã™ã‚‹ã€‚Fluentdãƒ­ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.docker.com/config/containers/logging/fluentd/ FireLensã‚³ãƒ³ãƒ†ãƒŠã¯ã€ã“ã‚Œã‚’å—ä¿¡ã™ã‚‹ã€‚ ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ç¨¼åƒã™ã‚‹FluentBitã®ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®INPUTã«æ¸¡ã•ã‚Œã€FluentBitã¯ãƒ­ã‚°ã‚’å‡¦ç†ã™ã‚‹ã€‚ OUTPUTã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«æ¸¡ã•ã‚Œã€FluentBitã¯æŒ‡å®šã—ãŸå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«ãƒ­ã‚°ã‚’è»¢é€ã™ã‚‹ã€‚ ãƒ»ãƒ­ã‚°è»¢é€ãƒ—ãƒ­ã‚»ã‚¹ FireLensã‚³ãƒ³ãƒ†ãƒŠã§ã¯ã€FluentBitã¾ãŸã¯FlunetdãŒãƒ­ã‚°è»¢é€ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç¨¼åƒã™ã‚‹ã€‚FireLensã‚³ãƒ³ãƒ†ãƒŠã‚’ä½¿ç”¨ã›ãšã«ã€ç‹¬è‡ªã®ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹ç¯‰ã—ã¦ç¨¼åƒã•ã›ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ãŒã€FireLensã‚³ãƒ³ãƒ†ãƒŠã‚’ç”¨ã„ã‚Œã°ã€ä¸»è¦ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚ˆã‚Šç°¡å˜ãªè¨­å®šã§FluentBitã¾ãŸã¯Flunetdã‚’ä½¿ç”¨ã§ãã‚‹ã€‚FluentBitã®æ–¹ãŒã‚ˆã‚Šä½è² è·ã§ç¨¼åƒã™ã‚‹ãŸã‚ã€FluentBitãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ å‚è€ƒï¼š https://aws.amazon.com/jp/blogs/news/under-the-hood-firelens-for-amazon-ecs-tasks/ https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/userguide/using_firelens.html ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ ãƒ»FluentBitã‚¤ãƒ¡ãƒ¼ã‚¸ FireLensã‚³ãƒ³ãƒ†ãƒŠã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ãªã‚‹FluentBitã‚¤ãƒ¡ãƒ¼ã‚¸ãŒAWSã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚AWSãƒªã‚½ãƒ¼ã‚¹ã«ãƒ­ã‚°ã‚’è»¢é€ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã™ã§ã«å«ã¾ã‚Œã¦ã„ã‚‹ã€‚ãªãŠã€Datadogãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯FluentBitè‡ªä½“ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã§ã‚ã‚‹ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ECRãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãƒ—ãƒ«ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãã®ã¾ã¾ç”¨ã„ã‚‹å ´åˆã¨ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã§å†ç®¡ç†ã—ã¦ã‹ã‚‰ç”¨ã„ã‚‹å ´åˆãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/firelens-using-fluentbit.html [/fluent-bit]$ ls -la -rw-r--r-- 1 root root 26624256 Sep 1 18:04 cloudwatch.so # æ—§cloudwatch_logsãƒ—ãƒ©ã‚°ã‚¤ãƒ³ -rw-r--r-- 1 root root 26032656 Sep 1 18:04 firehose.so # kinesis_firehoseãƒ—ãƒ©ã‚°ã‚¤ãƒ³ -rw-r--r-- 1 root root 30016544 Sep 1 18:03 kinesis.so # kinesis_streamsãƒ—ãƒ©ã‚°ã‚¤ãƒ³ ... ãƒ»ãƒ‘ãƒ–ãƒªãƒƒã‚¯ECRãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã‚‹å ´åˆ ECSã®ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã«ã¦ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ECRãƒªãƒã‚¸ãƒˆãƒªã®URLã‚’æŒ‡å®šã—ã€ECRã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã€‚æ¨™æº–ã§å†…è”µã•ã‚Œã¦ã„ã‚‹confãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã‚’ãã®ã¾ã¾ç”¨ã„ã‚‹å ´åˆã¯ã€ã“ã¡ã‚‰ã‚’æ¡ç”¨ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/firelens-using-fluentbit.html#firelens-image-ecr ãƒ»ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã‚‹å ´åˆ ã‚ã‚‰ã‹ã˜ã‚ã€DockerHubã‹ã‚‰FluentBitã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«ã™ã‚‹ãŸã‚ã®Dockerfileã‚’ä½œæˆã—ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã—ã¦ãŠãã€‚ECSã®ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã«ã¦ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã®URLã‚’æŒ‡å®šã—ã€ECRã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã€‚æ¨™æº–ã§å†…è”µã•ã‚Œã¦ã„ã‚‹confãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã‚’ä¸Šæ›¸ãã—ãŸã„å ´åˆã¯ã€ã“ã¡ã‚‰ã‚’æ¡ç”¨ã™ã‚‹ã€‚ FROM amazon/aws-for-fluent-bit:latest å‚è€ƒï¼š https://hub.docker.com/r/amazon/aws-for-fluent-bit https://github.com/aws/aws-for-fluent-bit https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/firelens-using-fluentbit.html#firelens-image-dockerhub æ¨™æº–è¨­å®šã®ä¸Šæ›¸ã ãƒ»æ¨™æº–è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ aws-for-fluent-bitã‚¤ãƒ¡ãƒ¼ã‚¸ã®/fluent-bit/etcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯æ¨™æº–ã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚è¿½åŠ è¨­å®šã‚’å®Ÿè¡Œã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã“ã«é…ç½®ã™ã‚‹ã€‚ [/fluent-bit/etc]$ ls -la -rw-r--r-- 1 root root 251 Sep 1 17:57 fluent-bit.conf -rw-r--r-- 1 root root 1564 Sep 27 02:15 fluent-bit_custom.conf # è¿½åŠ è¨­å®šç”¨ -rw-r--r-- 1 root root 4664 Sep 1 18:07 parsers.conf -rw-r--r-- 1 root root 584 Sep 1 18:07 parsers_ambassador.conf -rw-r--r-- 1 root root 226 Sep 1 18:07 parsers_cinder.conf -rw-r--r-- 1 root root 2798 Sep 1 18:07 parsers_extra.conf -rw-r--r-- 1 root root 240 Sep 1 18:07 parsers_java.conf -rw-r--r-- 1 root root 845 Sep 1 18:07 parsers_mult.conf -rw-r--r-- 1 root root 291 Sep 27 02:15 parsers_multiline.conf -rw-r--r-- 1 root root 2954 Sep 1 18:07 parsers_openstack.conf -rw-r--r-- 1 root root 579 Sep 27 02:15 stream_processor.conf # è¿½åŠ è¨­å®šç”¨ FireLensã‚³ãƒ³ãƒ†ãƒŠã®/fluent-bit/etc/fluent-bit.confãƒ•ã‚¡ã‚¤ãƒ«ã¯ä»¥ä¸‹ã®é€šã‚Šã¨ãªã‚Šã€ãƒ­ãƒ¼ã‚«ãƒ«PCã§FluentBitã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ãŸå ´åˆã¨ç•°ãªã‚‹æ§‹æˆã«ãªã£ã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://dev.classmethod.jp/articles/check-fluent-bit-conf/ [INPUT] Name tcp Listen 127.0.0.1 Port 8877 Tag firelens-healthcheck [INPUT] Name forward unix_path /var/run/fluent.sock [INPUT] Name forward Listen 127.0.0.1 Port 24224 [FILTER] Name record_modifier Match * Record ecs_cluster sample-test-cluster Record ecs_task_arn arn:aws:ecs:ap-northeast-1:123456789012:task/sample-test-cluster/d4efc1a0fdf7441e821a3683836ad69a Record ecs_task_definition sample-test-webapp-taskdefinition:15 [OUTPUT] Name null Match firelens-healthcheck ãƒ»fluent-bit_custom.confãƒ•ã‚¡ã‚¤ãƒ« FireLensã‚³ãƒ³ãƒ†ãƒŠã®/fluent-bit/etc/fluent-bit.confãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã®config-file-valueã‚­ãƒ¼ã§æŒ‡å®šã—ã€è¿½åŠ è¨­å®šã‚’å®Ÿè¡Œã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€FireLensã‚³ãƒ³ãƒ†ãƒŠã«INCLUDEæ–‡ãŒæŒ¿å…¥ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://dev.classmethod.jp/articles/check-fluent-bit-conf/ [INPUT] Name tcp Listen 127.0.0.1 Port 8877 Tag firelens-healthcheck [INPUT] Name forward unix_path /var/run/fluent.sock [INPUT] Name forward Listen 127.0.0.1 Port 24224 [FILTER] Name record_modifier Match * Record ecs_cluster prd-foo-ecs-cluster Record ecs_task_arn arn:aws:ecs:ap-northeast-1::task/prd-foo-ecs-cluster/***** Record ecs_task_definition prd-foo-ecs-task-definition:1 # INCLUDEæ–‡ãŒæŒ¿å…¥ã•ã‚Œã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚ @INCLUDE /fluent-bit/etc/fluent-bit_custom.conf [OUTPUT] Name laravel Match laravel-firelens* [OUTPUT] Name nginx Match nginx-firelens* ã¡ãªã¿ã«ã€æ¨™æº–ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€INPUTã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒã™ã§ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€fluent-bit_custom.confãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯INPUTã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã—ãªãã¦ã‚‚å•é¡Œãªã„ã€‚ å‚è€ƒï¼šhttps://github.com/aws/aws-for-fluent-bit/blob/mainline/fluent-bit.conf [INPUT] Name forward Listen 0.0.0.0 Port 24224 [OUTPUT] Name cloudwatch Match ** region us-east-1 log_group_name fluent-bit-cloudwatch log_stream_prefix from-fluent-bit- auto_create_group true ãƒ»stream_processor.confãƒ•ã‚¡ã‚¤ãƒ« STREAM_TASKã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¦ã€ãƒ­ã‚°ã®ã‚¿ã‚°ä»˜ã‘ã‚’å®šç¾©ã™ã‚‹ã€‚FireLensã‚³ãƒ³ãƒ†ãƒŠã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã¯ã€ã€-firelens-ã€ã¨ã„ã†åå‰ã§ãƒ­ã‚°ãŒå‡¦ç†ã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€Stream Processorã§ãƒ­ã‚°ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¯ã‚¨ãƒªã§ã€FROM TAG:'*-firelens-*'ã€ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã¡ãªã¿ã«ã€STREAM_TASKã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚¿ã‚°ä»˜ã‘ã•ã‚ŒãŸãƒ­ã‚°ã¯ã€INPUTã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰å†ã³å‡¦ç†ã—ç›´ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://aws.amazon.com/jp/blogs/news/under-the-hood-firelens-for-amazon-ecs-tasks/ # appã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã¸ã®ã‚¿ã‚°ä»˜ã‘ [STREAM_TASK] Name laravel Exec CREATE STREAM web WITH (tag='laravel') AS SELECT log FROM TAG:'*-firelens-*' WHERE container_name = 'laravel'; # webã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã¸ã®ã‚¿ã‚°ä»˜ã‘ [STREAM_TASK] Name nginx Exec CREATE STREAM web WITH (tag='nginx') AS SELECT log FROM TAG:'*-firelens-*' WHERE container_name = 'nginx'; # å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã¸ã®ã‚¿ã‚°ä»˜ã‘ [STREAM_TASK] Name containers Exec CREATE STREAM container WITH (tag='containers') AS SELECT * FROM TAG:'*-firelens-*'; [SERVICE] Flush 1 Grace 30 Log_Level info # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ Parsers_File parsers_multiline.conf Streams_File stream_processor.conf ãƒ»parsers_multiline.confãƒ•ã‚¡ã‚¤ãƒ« MULTILINE_PARSERã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¦ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ­ã‚°ã®å„è¡Œã®çµåˆã‚’å®šç¾©ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://github.com/aws-samples/amazon-ecs-firelens-examples/blob/mainline/examples/fluent-bit/filter-multiline/README.md [MULTILINE_PARSER] name laravel type regex flush_timeout 1000 rule \"start_state\" \"/(Dec \\d+ \\d+\\:\\d+\\:\\d+)(.*)/\" \"cont\" rule \"cont\" \"/^\\s+at.*/\" \"cont\" [SERVICE] flush 1 log_level info parsers_file /parsers_multiline.conf [FILTER] name multiline match * multiline.key_content log # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã€‚çµ„ã¿è¾¼ã¿ãƒ‘ãƒ¼ã‚µï¼ˆgoãªã©ï¼‰ã‚’ç”¨ã„ã‚‹ã“ã¨ã‚‚å¯èƒ½ã€‚ multiline.parser go, laravel FireLensã‚³ãƒ³ãƒ†ãƒŠã®ã‚³ãƒ³ãƒ†ãƒŠå®šç¾© ãƒ»å…¨ä½“ [ { \"name\": \"\", \"image\": \"\", \"essential\": true, \"portMappings\": [ { \"containerPort\": 80, \"hostPort\": 80, \"protocol\": \"tcp\" } ], \"logConfiguration\": { \"logDriver\": \"awsfirelens\", \"options\": { \"Name\": \"forward\" } } }, { # FireLensã‚³ãƒ³ãƒ†ãƒŠåãŒlog_routerã¨ãªã‚‹ã“ã¨ã¯å›ºå®š \"name\": \"log_router\", \"image\": \"\", \"essential\": false, \"logConfiguration\": { \"logDriver\": \"awslogs\", \"options\": { # FireLensã‚³ãƒ³ãƒ†ãƒŠè‡ªä½“ãŒCloudWatchãƒ­ã‚°ã«ãƒ­ã‚°å‡ºåŠ› \"awslogs-group\": \"\", \"awslogs-region\": \"\", \"awslogs-stream-prefix\": \"\" } }, \"firelensConfiguration\": { # FireLensã‚³ãƒ³ãƒ†ãƒŠã§FluentBitã‚’ç¨¼åƒã•ã›ã‚‹ \"type\": \"fluentbit\", \"options\": { \"config-file-type\": \"file\", # è¨­å®šä¸Šæ›¸ãã®ãŸã‚èª­ã¿è¾¼ã¿ \"config-file-value\": \"/fluent-bit/etc/fluent-bit_custom.conf\" # ECSã®æƒ…å ±ã‚’FireLensã«é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ \"enable-ecs-log-metadata\": \"true\" } }, \"portMappings\": [], \"memoryReservation\": 50, \"secrets\": [ { \"name\": \"DD_API_KEY\", \"valueFrom\": \"\" }, { \"name\": \"DD_ENV\", \"valueFrom\": \"\" } ] } ] ãƒ»name FireLensã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã¨ã—ã¦æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ã€ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã‚’å®Ÿè£…ã™ã‚‹ã€‚FireLensã‚³ãƒ³ãƒ†ãƒŠã¯ã€log_routeterã€ã¨ã™ã‚‹ã€‚ ãƒ»logConfiguration å‚è€ƒï¼šhttps://docs.aws.amazon.com/ja_jp/AmazonECS/latest/userguide/firelens-example-taskdefs.html#firelens-example-forward é …ç›® èª¬æ˜ type ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰FireLensã‚³ãƒ³ãƒ†ãƒŠã«ãƒ­ã‚°ã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ã€ãƒ­ã‚°ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®ã‚¿ã‚¤ãƒ—ã¨ã—ã¦ã€fluentbitã€ã‚’è¨­å®šã™ã‚‹ã€‚ config-file-type FluentBitã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã«ã€fileã¨ã™ã‚‹ã€‚ config-file-value optionsã‚­ãƒ¼ã«ã¦ã€ãƒ­ã‚°è»¢é€ã‚’è¨­å®šã§ãã‚‹ãŒã€ãã‚Œã‚‰ã¯fluent-bit.confãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚‚è¨­å®šå¯èƒ½ã§ã‚ã‚‹ãŸã‚ã€è»¢é€ã®è¨­å®šã¯ã§ãã‚‹ã ã‘fluent-bit.confãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã™ã‚‹ã€‚FireLensã‚³ãƒ³ãƒ†ãƒŠè‡ªä½“ã®ãƒ­ã‚°ã¯ã€CloudWatchãƒ­ã‚°ã«é€ä¿¡ã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã€ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰å—ä¿¡ã—ãŸãƒ­ã‚°ã¯ç›£è¦–ãƒ„ãƒ¼ãƒ«ï¼ˆDatadogãªã©ï¼‰ã«è»¢é€ã™ã‚‹ã€‚ enable-ecs-log-metadataï¼ˆæ¨™æº–ã§æœ‰åŠ¹åŒ–ï¼‰ æœ‰åŠ¹ã«ã—ãŸå ´åˆã€Datadogã®ãƒ­ã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚°ãŒä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚åå¯¾ã«ç„¡åŠ¹ã«ã—ãŸå ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚°ãŒä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚å‚è€ƒï¼šhttps://tech.spacely.co.jp/entry/2020/11/28/173356 environmentã€secrets ã‚³ãƒ³ãƒ†ãƒŠå†…ã®fluent-bit.confãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ•°ã‚’å‡ºåŠ›ã§ãã‚‹ã‚ˆã†ã«ã€ã‚³ãƒ³ãƒ†ãƒŠã®ç’°å¢ƒå¤‰æ•°ã«å€¤ã‚’å®šç¾©ã™ã‚‹ã€‚ "},"public/observability_monitering/observability_datadog_metrics.html":{"url":"public/observability_monitering/observability_datadog_metrics.html","title":"ğŸ“– ï¸ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†","keywords":"","body":"ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›† ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. Ec2ã«ãŠã‘ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›† Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ on EC2ã¨ã¯ ãƒ»Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ on EC2ã¨ã¯ å¸¸é§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã—ã€Datadogã«è»¢é€ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/agent/amazon_ecs/?tab=awscli 02. Fargateã«ãŠã‘ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›† Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ on Fargate ãƒ»Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ on Fargateã¨ã¯ å¸¸é§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’Datadogã«è»¢é€ã™ã‚‹ã€‚EC2ç”¨ã®Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã¯ç•°ãªã‚Šã€ãƒ­ã‚°ã¯è»¢é€ã—ãªã„ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/integrations/ecs_fargate/?tab=fluentbitandfirelens#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97 ãƒ»ç’°å¢ƒå¤‰æ•° ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦å½¹ç«‹ã¤ç’°å¢ƒå¤‰æ•°ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/agent/docker/?tab=%E6%A8%99%E6%BA%96#%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3 å¤‰æ•°å èª¬æ˜ è£œè¶³ Datadogã‚³ãƒ³ã‚½ãƒ¼ãƒ«URL DD_API_KEY Datadogã‚³ãƒ³ãƒ†ãƒŠãŒã‚ã‚‰ã‚†ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’Datadogã«é€ä¿¡ã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã‚ã‚‹ã€‚ DD_ENV APMã‚’ç”¨ã„ã‚‹å ´åˆã€ã‚µãƒ¼ãƒ“ã‚¹ã‚„ãƒˆãƒ¬ãƒ¼ã‚¹ç”»é¢ã«ã¦ã€envã‚¿ã‚°ã«å€¤ã‚’è¨­å®šã™ã‚‹ã€‚ ã‚µãƒ¼ãƒ“ã‚¹å˜ä½ã§çµã‚Šè¾¼ã‚ã‚‹ã‚ˆã†ã«ã€prd-fooã‚„stg-fooã¨ã—ãŸæ–¹ãŒè‰¯ã„ã€‚ https://app.datadoghq.com/apm/services DD_HOSTNAME ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ›ã‚¹ãƒˆåã‚’è¨­å®šã™ã‚‹ã€‚ Fargateã‚’ç”¨ã„ã‚‹å ´åˆã¯ã€ã“ã‚Œã‚’ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/integrations/ecs_fargate/?tab=fluentbitandfirelens#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0 https://app.datadoghq.com/infrastructure/map ECS_FARGATE Fargateã‚’ç”¨ã„ã‚‹å ´åˆã€ã“ã‚Œã‚’å®£è¨€ã™ã‚‹ã€‚ ä»»æ„ã§é¸æŠã§ãã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†ã¨ã—ã¦å½¹ç«‹ã¤ç’°å¢ƒå¤‰æ•°ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ä¸€éƒ¨ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¯ã€æ¨™æº–ã§ã¯åé›†ã—ãªã„ã‚ˆã†ã«ãªã£ã¦ãŠã‚Šã€åé›†ã™ã‚‹ãŸã‚ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/agent/docker/?tab=%E6%A8%99%E6%BA%96#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E5%8F%8E%E9%9B%86-agent å¤‰æ•°å èª¬æ˜ è£œè¶³ Datadogã‚³ãƒ³ã‚½ãƒ¼ãƒ«URL DD_APM_ENABLED APMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ Fargateã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€APMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã ã‘ã§ãªãã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ã€ã‚µãƒ¼ãƒ“ã‚¹ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã‚ã‚‹ã€‚å‚è€ƒï¼šãƒ»https://app.datadoghq.com/apm/docs?architecture=host-based&framework=php-fpm&language=phpãƒ»https://docs.datadoghq.com/ja/tracing/#datadog-%E3%81%B8%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E9%80%81%E4%BF%A1 https://app.datadoghq.com/apm/home DD_LOGS_ENABLED - DD_PROCESS_AGENT_ENABLED ãƒ©ã‚¤ãƒ–ãƒ—ãƒ­ã‚»ã‚¹ã‚’æœ‰åŠ¹åŒ–ã—ã€å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åé›†ã™ã‚‹ã€‚å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/infrastructure/process/?tab=linuxwindows https://app.datadoghq.com/containers ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†ã¨ã—ã¦å½¹ç«‹ã¤ç’°å¢ƒå¤‰æ•°ã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/agent/docker/?tab=%E6%A8%99%E6%BA%96#dogstatsd-%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9 å¤‰æ•°å èª¬æ˜ Datadogã‚³ãƒ³ã‚½ãƒ¼ãƒ«URL DD_DOGSTATSD_NON_LOCAL_TRAFFIC Datadogã‚³ãƒ³ãƒ†ãƒŠã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å—ä¿¡ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒ»ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã¯ Dockerã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã¦ã€DD_APM_ENABLEDã®ç’°å¢ƒå¤‰æ•°ã«trueã‚’å‰²ã‚Šå½“ã¦ã‚‹ã¨ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæœ‰åŠ¹ã«ãªã‚‹ã€‚APMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æœ‰åŠ¹åŒ–ã—ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’åé›†ã§ãã‚‹ã€‚APMã§ã¯ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’å…ƒã«ã—ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹é–“ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—ã¨ã—ã¦ç¢ºèªã§ãã‚‹ã€‚ å‚è€ƒï¼š https://docs.datadoghq.com/ja/agent/docker/apm/?tab=linux https://docs.datadoghq.com/ja/tracing/#datadog-apm-%E3%81%AE%E7%A2%BA%E8%AA%8D ãƒ»ç’°å¢ƒå¤‰æ•° ä¸€éƒ¨ã®ç’°å¢ƒå¤‰æ•°ã¯ã€Dockerã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç’°å¢ƒå¤‰æ•°ã¨é‡ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/agent/docker/apm/?tab=linux#docker-apm-agent-%E3%81%AE%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0 å¤‰æ•°å èª¬æ˜ è£œè¶³ DD_LOG_LEVEL APMã«é€ä¿¡ã™ã‚‹ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’è¨­å®šã™ã‚‹ã€‚ Datadogã‚³ãƒ³ãƒ†ãƒŠ ãƒ»Datadogã‚³ãƒ³ãƒ†ãƒŠã¨ã¯ DatadogãŒæä¾›ã™ã‚‹datadogã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã‚ˆã£ã¦æ§‹ç¯‰ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒŠã§ã‚ã‚Šã€ã‚³ãƒ³ãƒ†ãƒŠã®ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦é…ç½®ã•ã‚Œã‚‹ã€‚ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ç¨¼åƒã™ã‚‹Datadog Dockerã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã€ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã—ã€Datadogã«ã“ã‚Œã‚’è»¢é€ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/integrations/ecs_fargate/?tab=fluentbitandfirelens#%E6%A6%82%E8%A6%81 ãƒ»Datadogã‚³ãƒ³ãƒ†ãƒŠã®é…ç½® [ { # laravelã‚³ãƒ³ãƒ†ãƒŠ }, { # nginxã‚³ãƒ³ãƒ†ãƒŠ }, { # datadogã‚³ãƒ³ãƒ†ãƒŠ \"name\": \"datadog\", \"image\": \"datadog/agent:latest\", \"essential\": false, \"portMappings\": [ { \"containerPort\": 8126, \"hostPort\": 8126, \"protocol\": \"tcp\" } ], \"logConfiguration\": { \"logDriver\": \"awslogs\", \"options\": { \"awslogs-group\": \"/prd-foo/laravel/log\", \"awslogs-region\": \"ap-northeast-1\" \"awslogs-stream-prefix\": \"/container\" } }, \"cpu\": 10, \"memory\": 256, \"environment\": [ { \"name\": \"ECS_FARGATE\", \"value\": \"true\" }, { \"name\": \"DD_PROCESS_AGENT_ENABLED\", \"value\": \"true\" }, { \"name\": \"DD_DOGSTATSD_NON_LOCAL_TRAFFIC\", \"value\": \"true\" }, { \"name\": \"DD_APM_ENABLED\", \"value\": \"true\" }, { \"name\": \"DD_LOGS_ENABLED\", \"value\": \"true\" }, { # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã™ã‚‹envã‚¿ã‚° \"name\": \"DD_ENV\", \"value\": \"foo\" }, { # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã™ã‚‹serviceã‚¿ã‚° \"name\": \"DD_SERVICE\", \"value\": \"foo\" }, { # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã™ã‚‹versionã‚¿ã‚° \"name\": \"DD_VERSION\", \"value\": \"latest\" } ], \"secrets\": [ { \"name\": \"DD_API_KEY\", \"valueFrom\": \"/prd-foo/DD_API_KEY\" } ], \"dockerLabels\": { # ECSã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã™ã‚‹envã‚¿ã‚° \"com.datadoghq.tags.env\": \"prd\", # ECSã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã™ã‚‹serviceã‚¿ã‚° \"com.datadoghq.tags.service\": \"foo\", # ECSã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã™ã‚‹versionã‚¿ã‚° \"com.datadoghq.tags.version\": \"1.0.0\" } } ] ãƒ»IAMãƒ­ãƒ¼ãƒ« Datadogã‚³ãƒ³ãƒ†ãƒŠãŒã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã‚ˆã†ã«ã€ECSã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã«ãƒãƒªã‚·ãƒ¼ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/integrations/ecs_fargate/?tab=fluentbitandfirelens#iam-%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E4%BF%AE%E6%AD%A3 { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": [ \"ecs:ListClusters\", \"ecs:ListContainerInstances\", \"ecs:DescribeContainerInstances\" ], \"Effect\": \"Allow\", \"Resource\": \"*\" } ] } 03. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ è¨€èªï¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ãƒ„ãƒ¼ãƒ«ã€ãªã©ã«é–¢ã—ã¦ã€å°‚ç”¨ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ç”¨ã„ã‚‰ã‚Œã‚‹è¨€èªï¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®å ´åˆã€Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’æŒã¤ãŸã‚ã€ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã‚ã‚‹ã€‚Datedogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚³ãƒ³ãƒ†ãƒŠï¼ã‚µãƒ¼ãƒã§ç¨¼åƒã™ã‚‹è¨€èªï¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ãƒ„ãƒ¼ãƒ«ã‚’è‡ªå‹•ã§èªè­˜ã—ã¦ãã‚Œã‚‹ã€‚ ç¨®é¡ ãƒ»PHP-FPMã®å ´åˆ PHP-FPMã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã—ãŸå ´åˆã€ä»¥ä¸‹ã®å°‚ç”¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/integrations/php_fpm/?tab=host#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9 ãƒ»Nginxã®å ´åˆ Nginxã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã—ãŸå ´åˆã€ä»¥ä¸‹ã®å°‚ç”¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/integrations/nginx/?tab=host#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9 04. ãƒ¡ãƒˆãƒªã‚¯ã‚¹é€ä¿¡ è¨­å®šæ–¹æ³• ã„ãã¤ã‹ã®æ–¹æ³•ã§ã€åé›†ã•ã‚ŒãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’é€ä¿¡ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/metrics/#datadog-%E3%81%B8%E3%81%AE%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9%E3%81%AE%E9%80%81%E4%BF%A1 ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— Datadogã§ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã¨åŒæ™‚ã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å‰Šé™¤ Datadogã«é€ä¿¡ã•ã‚Œãªããªã£ãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¯ã€æ™‚é–“çµŒéã¨ã¨ã‚‚ã«Datadogã‹ã‚‰å‰Šé™¤ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/dashboards/faq/historical-data/ 05. ä»–ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã¨ã®ç›¸é–¢ä»˜ã‘ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/guide/correlate-logs-with-metrics/ "},"public/observability_monitering/observability_datadog_log.html":{"url":"public/observability_monitering/observability_datadog_log.html","title":"ğŸ“– ï¸ãƒ­ã‚°åé›†","keywords":"","body":"ãƒ­ã‚°åé›† ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ­ã‚°åé›†ã®ä»•çµ„ã¿ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ ï¼ˆï¼‘ï¼‰ã‚µãƒ¼ãƒã®å ´åˆã€ç¨¼åƒã™ã‚‹Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã€Datadog-APIã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ã€‚ã‚³ãƒ³ãƒ†ãƒŠã®å ´åˆã€FluentBitãŒä»£ã‚ã‚Šã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰Datadogã«ã¦ã€ãƒ­ã‚°ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§å‡¦ç†ã•ã‚Œã€æ§‹é€ åŒ–ãƒ­ã‚°ã«ãªã‚‹ã€‚ ï¼ˆï¼“ï¼‰ãƒ¦ãƒ¼ã‚¶ã¯ã€ãƒ­ã‚°ã®å±æ€§å€¤ã«åŸºã¥ã„ã¦ã€ãƒ­ã‚°ã‚’æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://developers.cyberagent.co.jp/blog/archives/12565/ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ ï¼ˆï¼‘ï¼‰ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã•ã‚Œã‚‹ãƒ­ã‚°ã‚’åé›†ã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰Datadogã«ã¦ã€ãƒ­ã‚°ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§å‡¦ç†ã•ã‚Œã€æ§‹é€ åŒ–ãƒ­ã‚°ã«ãªã‚‹ã€‚ ï¼ˆï¼“ï¼‰ãƒ¦ãƒ¼ã‚¶ã¯ã€ãƒ­ã‚°ã®å±æ€§å€¤ã«åŸºã¥ã„ã¦ã€ãƒ­ã‚°ã‚’æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/komtaki/items/a2d3f06e2265e55b0c08#2-js%E3%83%AD%E3%82%AC%E3%83%BC%E3%81%AE%E6%A7%8B%E7%AF%89 02. Ec2ã«ãŠã‘ã‚‹ãƒ­ã‚°åé›† Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ on EC2ã¨ã¯ ãƒ»Datadogã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ on EC2ã¨ã¯ å¸¸é§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚’åé›†ã—ã€Datadogã«è»¢é€ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/agent/amazon_ecs/?tab=awscli ãƒ»ãƒ­ã‚°åé›†ã®æœ‰åŠ¹åŒ– ãƒ­ã‚°ã®åé›†ã¯æ¨™æº–ã§ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã€‚/etc/datadog-agent/datadog.yamlãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ã“ã‚Œã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚ logs_enabled: true 03. Fargateã«ãŠã‘ã‚‹ãƒ­ã‚°åé›† FireLensã‚³ãƒ³ãƒ†ãƒŠ ãƒ»FireLensã‚³ãƒ³ãƒ†ãƒŠã¨ã¯ Datadogã‚³ãƒ³ãƒ†ãƒŠã¯ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãƒ­ã‚°ã‚’åé›†ã§ããªã„ãŸã‚ã€ä»£ã‚ã‚Šã«FireLensã‚³ãƒ³ãƒ†ãƒŠã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://docs.datadoghq.com/ja/integrations/ecs_fargate/?tab=fluentbitandfirelens https://hiroki-it.github.io/tech-notebook-gitbook/public/summary.html?q=firelens FireLensã‚³ãƒ³ãƒ†ãƒŠã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ ãƒ»Datadogã‚¤ãƒ¡ãƒ¼ã‚¸ Datadogã‚³ãƒ³ãƒ†ãƒŠã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ãªã‚‹Datadogã‚¤ãƒ¡ãƒ¼ã‚¸ãŒDatadogå…¬å¼ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ECRãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãƒ—ãƒ«ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãã®ã¾ã¾ç”¨ã„ã‚‹å ´åˆã¨ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã§å†ç®¡ç†ã—ã¦ã‹ã‚‰ç”¨ã„ã‚‹å ´åˆãŒã‚ã‚‹ã€‚ ãƒ»ãƒ‘ãƒ–ãƒªãƒƒã‚¯ECRãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã‚‹å ´åˆ ECSã®ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã«ã¦ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ECRãƒªãƒã‚¸ãƒˆãƒªã®URLã‚’æŒ‡å®šã—ã€ECRã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã€‚æ¨™æº–ã§å†…è”µã•ã‚Œã¦ã„ã‚‹yamlãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã‚’ãã®ã¾ã¾ç”¨ã„ã‚‹å ´åˆã¯ã€ã“ã¡ã‚‰ã‚’æ¡ç”¨ã™ã‚‹ã€‚ å‚è€ƒï¼š https://gallery.ecr.aws/datadog/agent https://github.com/DataDog/datadog-agent ãƒ»ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã‚’ç”¨ã„ã‚‹å ´åˆ ã‚ã‚‰ã‹ã˜ã‚ã€DockerHubã‹ã‚‰datadogã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«ã™ã‚‹ãŸã‚ã®Dockerfileã‚’ä½œæˆã—ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã—ã¦ãŠãã€‚ECSã®ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©ã«ã¦ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆECRãƒªãƒã‚¸ãƒˆãƒªã®URLã‚’æŒ‡å®šã—ã€ECRã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã€‚æ¨™æº–ã§å†…è”µã•ã‚Œã¦ã„ã‚‹yamlãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã‚’ä¸Šæ›¸ãã—ãŸã„å ´åˆã¯ã€ã“ã¡ã‚‰ã‚’æ¡ç”¨ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://hub.docker.com/r/datadog/agent FROM data/agent:latest æ¨™æº–è¨­å®šã®ä¸Šæ›¸ã å‚è€ƒï¼šhttps://github.com/DataDog/datadog-agent/blob/main/pkg/config/config_template.yaml 04. ãƒ­ã‚°ã®è­˜åˆ¥å­ attributeï¼ˆå±æ€§ï¼‰ ãƒ»äºˆç´„æ¸ˆã¿å±æ€§ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/log_configuration/attributes_naming_convention/ å±æ€§å èª¬æ˜ è£œè¶³ ä¾‹ host ãƒ­ã‚°ã®ç”Ÿæˆå…ƒã®ãƒ›ã‚¹ãƒˆåã‚’ç¤ºã™ã€‚ ãƒ­ã‚°ãŒç”Ÿæˆå…ƒã¨ã¯åˆ¥ã®å ´æ‰€ã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ã„ã‚‹å ´åˆã«å½¹ç«‹ã¤ã€‚Datadogã‚³ãƒ³ãƒ†ãƒŠã®ç’°å¢ƒå¤‰æ•°ã«ã¦ã€DD_HOSTNAMEã‚’ç”¨ã„ã¦hostå±æ€§ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ›ã‚¹ãƒˆãƒãƒƒãƒ—ã§ãƒ›ã‚¹ãƒˆã‚’ä¿¯ç°ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã ã‘ã§ãªãã€ãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ã§ãƒ›ã‚¹ãƒˆã‚¿ã‚°ãŒå±æ€§ã¨ã—ã¦ä»˜ä¸ã•ã‚Œã‚‹ã€‚ä»–ã«AWSã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€é€ä¿¡å…ƒã®ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—åã‚„ãƒã‚±ãƒƒãƒˆåãŒä»˜ä¸ã•ã‚Œã‚‹ã€‚ ãƒ»fooãƒ»foo-backendãƒ»foo-frontendãƒ»foo-log-groupãƒ»foo-bucket source ãƒ­ã‚°ã®ç”Ÿæˆå…ƒã®åå‰ã‚’ç¤ºã™ã€‚ ãƒ™ãƒ³ãƒ€ãƒ¼åã‚’ç”¨ã„ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„ã€‚ ãƒ»laravelãƒ»nginxãƒ»redis status ãƒ­ã‚°ã®ãƒ¬ãƒ™ãƒ«ã‚’ç¤ºã™ã€‚ service ãƒ­ã‚°ã®ç”Ÿæˆå…ƒã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åã‚’ç¤ºã™ã€‚ ãƒ­ã‚°ã¨APMåˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç´ä»˜ã‘ã‚‹ãŸã‚ã€ä¸¡æ–¹ã«åŒã˜åå‰ã‚’å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»fooãƒ»bar-backendãƒ»baz-frontend trace_id ãƒ­ã‚°ã‚’åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚„ã‚¹ãƒ‘ãƒ³ã¨ç´ä»˜ã‘ã‚‹IDã‚’ç¤ºã™ã€‚ message ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¤ºã™ã€‚ ãƒ»æ¨™æº–å±æ€§ æ¨™æº–ã§ç”¨æ„ã•ã‚ŒãŸå±æ€§ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/log_configuration/attributes_naming_convention/#%E6%A8%99%E6%BA%96%E5%B1%9E%E6%80%A7 ï¼Šä¾‹ï¼Š Laravelã®å ´åˆ { \"container_id\": \"*****\", \"container_name\": \"/prd-foo-ecs-container\", \"date\": 12345, \"log_status\": \"NOTICE\", \"service\": \"foo\", \"source\": \"laravel\", \"timestamp\": 12345 } ï¼Šä¾‹ï¼Š Nginxã®å ´åˆ { \"content\": { \"attributes\": { \"date_access\": 12345, \"http\": { \"method\": \"GET\", \"referer\": \"-\", \"status_category\": \"info\", \"status_code\": 200, \"url\": \"/healthcheck\", \"url_details\": { \"path\": \"/healthcheck\" }, \"useragent\": \"ELB-HealthChecker/2.0\", \"useragent_details\": { \"browser\": { \"family\": \"Other\" }, \"device\": { \"category\": \"Other\", \"family\": \"Other\" }, \"os\": { \"family\": \"Other\" } }, \"version\": \"1.1\" }, \"network\": { \"bytes_written\": 17, \"client\": { \"ip\": \"nn.nnn.nn.nnn\" } }, \"service\": \"foo\", \"timestamp\": 12345 }, \"message\": \"nn.nnn.nn.nnn - - [01/Sep/2021:00:00:00 +0000] \\\"GET /healthcheck HTTP/1.1\\\" 200 17 \\\"-\\\" \\\"ELB-HealthChecker/2.0\\\"\", \"service\": \"foo\", \"tags\": [ \"source:nginx\", \"env:prd\" ], \"timestamp\": \"2021-09-01T00:00:00.000Z\" }, \"id\": \"*****\" } ãƒ»ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹å±æ€§ ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ­ã‚°ã‚’æ§‹æˆã™ã‚‹è¦ç´ ã«ä»˜ä¸ã•ã‚Œã‚‹å±æ€§ã®ã“ã¨ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/log_collection/?tab=host#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%AE%E5%B1%9E%E6%80%A7 å±æ€§å èª¬æ˜ logger.name ãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åå‰ã‚’ç¤ºã™ã€‚ logger.thread_name ã‚¹ãƒ¬ãƒƒãƒ‰åã‚’ç¤ºã™ã€‚ error.stack ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ­ã‚°å…¨ä½“ã‚’ç¤ºã™ã€‚ error.message ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ­ã‚°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸éƒ¨åˆ†ã‚’ç¤ºã™ã€‚ error.kind ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ï¼ˆExceptionã€OSErrorã€ãªã©ï¼‰ã‚’ç¤ºã™ã€‚ ã‚¿ã‚° å±æ€§å env 05. åé›†ã•ã‚ŒãŸãƒ­ã‚°ã®é€ä¿¡ EC2ã«ãŠã‘ã‚‹ãƒ­ã‚°ã®é€ä¿¡ ãƒ»PHP Monologã®å ´åˆ Logãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«Monologã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€/etc/datadog-agent/conf.d/php.dãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸‹ã«conf.yamlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ã“ã“ã«ã€Datadogã«ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã®è¨­å®šã‚’è¡Œã†ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/log_collection/php/?tab=phpmonolog#agent-%E3%81%AE%E6%A7%8B%E6%88%90 ï¼Šå®Ÿè£…ä¾‹ï¼Š init_config: instances: ## Log section logs: - type: file path: \"/path/to/laravel.log\" service: php source: php sourcecategory: sourcecode Fargateã«ãŠã‘ã‚‹ãƒ­ã‚°ã®é€ä¿¡ FireLensã‚³ãƒ³ãƒ†ãƒŠã§ç¨¼åƒã™ã‚‹FluentBitãŒã€Datadogã«ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability_fluentd_and_fluentbit.html 06. ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ã¯ Datadogã«é€ä¿¡ã•ã‚ŒãŸãƒ­ã‚°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰å€¤ã‚’æŠ½å‡ºã—ã€æ§‹é€ åŒ–ãƒ­ã‚°ã®å„å±æ€§ã«å‰²ã‚Šå½“ã¦ã‚‹ã€‚ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ãƒ«ãƒ¼ãƒ«ã«å½“ã¦ã¯ã¾ã‚‰ãªã‹ã£ãŸã•ã‚Œãªã‹ã£ãŸãƒ­ã‚°ã¯ã€ãã®ã¾ã¾æµå…¥ã™ã‚‹ã€‚å±æ€§ã”ã¨ã«ãƒ•ã‚¡ã‚»ãƒƒãƒˆã«å¯¾å¿œã—ã¦ãŠã‚Šã€å„ãƒ•ã‚¡ã‚»ãƒƒãƒˆã®å€¤åˆ¤å®šãƒ«ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ã€ãƒ­ã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€‚ ãƒªãƒãƒƒãƒ‘ãƒ¼ç³» ãƒ»ãƒªãƒãƒƒãƒ‘ãƒ¼ æŒ‡å®šã—ãŸå±æ€§ï¼ã‚¿ã‚°ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸå€¤ã‚’ã€åˆ¥ã®å±æ€§ã«å‰²ã‚Šå½“ã¦ç›´ã™ã€‚å†å‰²ã‚Šå½“ã¦æ™‚ã«ã€å…ƒã€…ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å¤‰æ›´ã§ãã‚‹ã€‚ ï¼Šä¾‹ï¼Š CloudWatchãƒ­ã‚°ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªAPI Gatewayã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®æ§‹é€ åŒ–ãƒ­ã‚°ã‚’å—ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ { \"content\": { \"attributes\": { \"aws\": { \"awslogs\": { \"logGroup\": \"prd-foo-api-access-log\", \"logStream\": \"be4fcfca38da39f3ad4190e2f325e5d8\", \"owner\": \"123456789\" }, \"function_version\": \"$LATEST\", \"invoked_function_arn\": \"arn:aws:lambda:ap-northeast-1:123456789:function:datadog-ForwarderStack-*****-Forwarder-*****\" }, \"caller\": \"-\", \"host\": \"prd-foo-api-access-log\", \"httpMethod\": \"GET\", \"id\": \"36472822677180929652719686832176844832038235205288853504\", \"ip\": \"nnn.nn.nnn.nnn\", \"protocol\": \"HTTP/1.1\", \"requestId\": \"4d0c0105-7c89-4384-8b3b-fcc63f701652\", \"requestTime\": \"01/Jan/2021:12:00:00 +0000\", \"resourcePath\": \"/users/{userId}\", \"responseLength\": \"26\", \"service\": \"apigateway\", \"status\": 200, \"timestamp\": 1635497933028, \"user\": \"-\" }, \"host\": \"prd-foo-api-access-log\", \"service\": \"apigateway\", \"tags\": [ \"forwardername:datadog-forwarderstack-*****-forwarder-*****\", \"source:apigateway\", \"sourcecategory:aws\", \"forwarder_memorysize:1024\", \"forwarder_version:3.39.0\" ], \"timestamp\": \"2021-01-01T12:00:00.000Z\" }, \"id\": \"AQAAAXzLRfjkXhzqsgAAAABBWHpMUmxPM0FBQTFWVnRrNTVXbkx3QUE\" } ã“ã‚Œã«å¯¾ã—ã¦ã€ãƒªãƒãƒƒãƒ‘ãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚ä¾‹ãˆã°ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢ã™ã‚‹å±æ€§å€¤ã‚’httpå±æ€§å†…ã®å„å±æ€§ã«å‰²ã‚Šå½“ã¦ç›´ã™ã€‚ { \"content\": { \"attributes\": { \"aws\": { \"awslogs\": { \"logGroup\": \"prd-foo-api-access-log\", \"logStream\": \"be4fcfca38da39f3ad4190e2f325e5d8\", \"owner\": \"123456789\" }, \"function_version\": \"$LATEST\", \"invoked_function_arn\": \"arn:aws:lambda:ap-northeast-1:123456789:function:datadog-ForwarderStack-*****-Forwarder-*****\" }, \"date_access\": \"01/Jan/2021:12:00:00 +0000\", \"host\": \"prd-foo-api-access-log\", \"http\": { \"auth\": \"-\", \"ident\": \"-\", \"method\": \"GET\", \"request_id\": \"4d0c0105-7c89-4384-8b3b-fcc63f701652\", \"status_category\": \"OK\", \"status_code\": 200, \"url\": \"/users/{userId}\", \"url_details\": { \"path\": \"/users/{userId}\" }, \"version\": \"HTTP/1.1\" }, \"id\": \"36472822677180929652719686832176844832038235205288853504\", \"network\": { \"bytes_written\": \"26\", \"client\": { \"ip\": \"nnn.nn.nnn.nnn\" } }, \"service\": \"apigateway\", \"timestamp\": 1635497933028 }, \"host\": \"prd-foo-api-access-log\", \"service\": \"apigateway\", \"tags\": [ \"forwardername:datadog-forwarderstack-*****-forwarder-*****\", \"source:apigateway\", \"sourcecategory:aws\", \"forwarder_memorysize:1024\", \"forwarder_version:3.39.0\" ], \"timestamp\": \"2021-01-01T12:00:00.000Z\" }, \"id\": \"AQAAAXzLRfjkXhzqsgAAAABBWHpMUmxPM0FBQTFWVnRrNTVXbkx3QUE\" } ãƒ»ãƒ­ã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒªãƒãƒƒãƒ‘ãƒ¼ æŒ‡å®šã—ãŸå±æ€§ï¼ã‚¿ã‚°ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸå€¤ã‚’ã€ãƒ«ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚¡ã‚»ãƒƒãƒˆã®å„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆINFOã€WARNINGã€ERRORã€ãªã©ï¼‰ã¨ã—ã¦ç™»éŒ²ã™ã‚‹ã€‚ãƒ­ã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã«ã¦ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚¡ã‚»ãƒƒãƒˆã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã€‚åˆ¤å®šãƒ«ãƒ¼ãƒ«ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/logs/log_configuration/processors/?tab=ui#log-status-remapper ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒãƒƒãƒ‘ãƒ¼ æŒ‡å®šã—ãŸå±æ€§ï¼ã‚¿ã‚°ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸå€¤ã‚’ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚»ãƒƒãƒˆã®ã‚µãƒ¼ãƒ“ã‚¹åã¨ã—ã¦ç™»éŒ²ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/logs/log_configuration/processors/?tab=ui#service-remapper ãƒ‘ãƒ¼ã‚µãƒ¼ç³» ãƒ»Grokãƒ‘ãƒ¼ã‚µãƒ¼ ãƒ‘ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ«ï¼ˆ%{MATCHER:EXTRACT:FILTER}ï¼‰ã‚’ç”¨ã„ã¦ã€å±æ€§ã«ãƒ­ã‚°å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ å‚è€ƒï¼š https://docs.datadoghq.com/ja/logs/processing/parsing/?tab=matcher https://docs.datadoghq.com/logs/log_configuration/processors/?tab=ui#grok-parser Laravelã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªéæ§‹é€ åŒ–ãƒ­ã‚°ã‚’å—ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ [2021-01-01 00:00:00] staging.ERROR: ãƒ­ã‚°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ [2021-01-01 00:00:00] production.ERROR: ãƒ­ã‚°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ä»¥ä¸‹ã®ã‚ˆã†ãªGrokãƒ‘ãƒ¼ã‚µãƒ¼ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚dateãƒãƒƒãƒãƒ£ãƒ¼ã‚’ç”¨ã„ã¦ã€dateå±æ€§ã«ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ã¾ãŸã€wordãƒãƒƒãƒãƒ£ãƒ¼ã‚’ç”¨ã„ã¦ã€log_statusã‚«ã‚¹ã‚¿ãƒ å±æ€§ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ä»»æ„ã®ãƒ«ãƒ¼ãƒ«åã‚’è¨­å®šã§ãã‚‹ã€‚ FooRule \\[%{date(\"yyyy-MM-dd HH:mm:ss\"):date}\\]\\s+(production|staging).%{word:log_status}\\:.+ ã“ã‚Œã«ã‚ˆã‚Šã€æ§‹é€ åŒ–ãƒ­ã‚°ã®å„å±æ€§ã«å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ { \"date\": 1630454400000, \"log_status\": \"INFO\" } ãƒ»Urlãƒ‘ãƒ¼ã‚µãƒ¼ æ§‹é€ åŒ–ãƒ­ã‚°ã®URLå€¤ã‹ã‚‰ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚„ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¤œå‡ºã—ã€è©³ç´°ãªå±æ€§ã¨ã—ã¦æ–°ã—ãä»˜ä¸ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/processing/processors/?tab=ui#url-%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC ï¼Šä¾‹ï¼Š ã¨ã‚ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªéæ§‹é€ åŒ–ãƒ­ã‚°ã‚’å—ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ 192.168.0.1 [2021-01-01 12:00:00] GET /users?paginate=10&fooId=1 200 ä»¥ä¸‹ã®ã‚ˆã†ãªGrokãƒ‘ãƒ¼ã‚µã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚å„ãƒãƒƒãƒãƒ£ãƒ¼ã§ã‚«ã‚¹ã‚¿ãƒ å±æ€§ã«å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ FooRule %{ipv4:network.client.ip}\\s+\\[%{date(\"yyyy-MM-dd HH:mm:ss\"):date}\\]\\s+%{word:http.method}\\s+%{notSpace:http.url}\\s+%{integer:http.status_code} ã“ã‚Œã«ã‚ˆã‚Šã€æ§‹é€ åŒ–ãƒ­ã‚°ã®å„å±æ€§ã«å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ { \"date\": 1609502400000, \"http\": { \"method\": \"GET\", \"status_code\": 200, \"url\": \"/users?paginate=10&fooId=1\" }, \"network\": { \"client\": { \"ip\": \"192.168.0.1\" } } } ã“ã‚Œã«å¯¾ã—ã¦ã€Urlãƒ‘ãƒ¼ã‚µã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚http.urlå±æ€§ã‹ã‚‰ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚„ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¤œå‡ºã—ã€http.url_detailså±æ€§ã¨ã—ã¦æ–°ã—ãä»˜ä¸ã™ã‚‹ã€‚ { \"date\": 1609502400000, \"http\": { \"method\": \"GET\", \"status_code\": 200, \"url\": \"/users?paginate=10&fooId=1\", \"url_details\": { \"path\": \"/users\", \"queryString\": { \"fooId\": 1, \"paginate\": 10 } } }, \"network\": { \"client\": { \"ip\": \"192.168.0.1\" } } } ï¼Šä¾‹ï¼Š CloudWatchãƒ­ã‚°ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªAPI Gatewayã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®æ§‹é€ åŒ–ãƒ­ã‚°ã‚’å—ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ { \"content\": { \"attributes\": { \"aws\": { \"awslogs\": { \"logGroup\": \"prd-foo-api-access-log\", \"logStream\": \"be4fcfca38da39f3ad4190e2f325e5d8\", \"owner\": \"123456789\" }, \"function_version\": \"$LATEST\", \"invoked_function_arn\": \"arn:aws:lambda:ap-northeast-1:123456789:function:datadog-ForwarderStack-*****-Forwarder-*****\" }, \"caller\": \"-\", \"host\": \"prd-foo-api-access-log\", \"httpMethod\": \"GET\", \"id\": \"36472822677180929652719686832176844832038235205288853504\", \"ip\": \"nnn.nn.nnn.nnn\", \"protocol\": \"HTTP/1.1\", \"requestId\": \"4d0c0105-7c89-4384-8b3b-fcc63f701652\", \"requestTime\": \"01/Jan/2021:12:00:00 +0000\", \"resourcePath\": \"/users/{userId}\", \"responseLength\": \"26\", \"service\": \"apigateway\", \"status\": 200, \"timestamp\": 1635497933028, \"user\": \"-\" }, \"host\": \"prd-foo-api-access-log\", \"service\": \"apigateway\", \"tags\": [ \"forwardername:datadog-forwarderstack-*****-forwarder-*****\", \"source:apigateway\", \"sourcecategory:aws\", \"forwarder_memorysize:1024\", \"forwarder_version:3.39.0\" ], \"timestamp\": \"2021-01-01T12:00:00.000Z\" }, \"id\": \"AQAAAXzLRfjkXhzqsgAAAABBWHpMUmxPM0FBQTFWVnRrNTVXbkx3QUE\" } ã“ã‚Œã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚«ãƒ†ã‚´ãƒªãƒ‘ãƒ¼ã‚µãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚aws.invoked_function_arnå±æ€§ã®Lambdaã®ARNå¿œã˜ã¦ã€serviceå±æ€§ã«ã‚µãƒ¼ãƒ“ã‚¹å€¤ï¼ˆfoo-apigatewayã€bar-apigatewayã€baz-apigatewayï¼‰ã‚’ä»˜ä¸ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã®å±æ€§ã‚’ç”¨ã„ã‚‹ç†ç”±ã¯ã€æ§˜ã€…ãªAWSãƒªã‚½ãƒ¼ã‚¹ã®æ§‹é€ åŒ–ãƒ­ã‚°ãŒæŒã£ã¦ã„ã‚‹ãŸã‚ã§ã‚ã‚‹ï¼ˆownerå±æ€§ã§ã‚‚ã‚ˆã„ã€‚ãŸã ã—ã€ãŠãã‚‰ãS3ã‹ã‚‰ãƒ­ã‚°ã‚’åé›†ã™ã‚‹å ´åˆã¯ã“ã‚ŒãŒãªã„ï¼Ÿï¼‰ã€‚å…ƒã®æ§‹é€ åŒ–ãƒ­ã‚°ã«ã™ã§ã«serviceå±æ€§ãŒã‚ã‚‹ãŸã‚ã€ã“ã®å€¤ãŒä¸Šæ›¸ãã•ã‚Œã‚‹ã€‚ foo-apigateway @aws.invoked_function_arn:\"arn:aws:lambda:ap-northeast-1:123456789:function:datadog-ForwarderStack-*****-Forwarder-*****\" bar-apigateway @aws.invoked_function_arn:\"arn:aws:lambda:ap-northeast-1:987654321:function:datadog-ForwarderStack-*****-Forwarder-*****\" baz-apigateway @aws.invoked_function_arn:\"arn:aws:lambda:ap-northeast-1:192837465:function:datadog-ForwarderStack-*****-Forwarder-*****\" ã“ã‚Œã«ã‚ˆã‚Šã€æ§‹é€ åŒ–ãƒ­ã‚°ã®serviceå±æ€§ã«ã‚µãƒ¼ãƒ“ã‚¹å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ãªãŠã€serviceå±æ€§ä»¥å¤–ã¯å…ƒã®æ§‹é€ åŒ–ãƒ­ã‚°ã¨åŒã˜ãŸã‚ã€çœç•¥ã—ã¦ã„ã‚‹ã€‚ { \"content\": { # ï½ ä¸­ç•¥ ï½ \"service\": \"foo-apigateway\", # ï½ ä¸­ç•¥ ï½ }, # ï½ ä¸­ç•¥ ï½ } ã“ã‚Œã«å¯¾ã—ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒãƒƒãƒ‘ãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚serviceå±æ€§ã®ã‚µãƒ¼ãƒ“ã‚¹å€¤ãŒã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚»ãƒƒãƒˆã¨ã—ã¦ç™»éŒ²ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ»ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ‘ãƒ¼ã‚µãƒ¼ ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ–‡å­—åˆ—ã‚’è§£æã—ã€è©³ç´°ãªé …ç›®ã”ã¨ã«åˆ†è§£ã—ãŸæ§‹é€ åŒ–ãƒ­ã‚°ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š Nginxã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªéæ§‹é€ åŒ–ãƒ­ã‚°ã‚’å—ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ nn.nnn.nn.nn - - [01/Sep/2021:00:00:00 +0000] \"GET /healthcheck HTTP/1.1\" 200 17 \"-\" \"ELB-HealthChecker/2.0\" ã“ã‚Œã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªGrokãƒ‘ãƒ¼ã‚µãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚http.useragentå±æ€§ã«ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) access.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.* error.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})? ã“ã‚Œã«ã‚ˆã‚Šã€æ§‹é€ åŒ–ãƒ­ã‚°ã®å„å±æ€§ã«å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ { \"date_access\": 12345, \"http\": { \"method\": \"GET\", \"referer\": \"-\", \"status_code\": 200, \"url\": \"/healthcheck\", \"useragent\": \"ELB-HealthChecker/2.0\", \"version\": \"1.1\" }, \"network\": { \"bytes_written\": 17, \"client\": { \"ip\": \"nn.nnn.nnn.nn\" } } } ã“ã‚Œã«å¯¾ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ‘ãƒ¼ã‚µãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚http.useragentå±æ€§ã®å€¤ã‚’åˆ†è§£ã—ã€useragent_detailså±æ€§ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ§‹é€ åŒ–ãƒ­ã‚°ã®å„å±æ€§ã«å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ { # ï½ ä¸­ç•¥ ï½ \"useragent_details\": { \"browser\": { \"family\": \"Chrome\" }, \"device\": { \"category\": \"Other\", \"family\": \"Other\" }, \"os\": { \"family\": \"Linux\" } } # ï½ ä¸­ç•¥ ï½ } ãƒ»ã‚¹ãƒˆãƒªãƒ³ã‚°ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ æ§‹é€ åŒ–ãƒ­ã‚°ã®å±æ€§ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãƒ«ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦å±æ€§å€¤ã‚’å‡ºåŠ›ã—ã€æ–°ã—ã„æ–‡å­—åˆ—ã‚’ç”Ÿæˆã™ã‚‹ã€‚é…åˆ—å€¤ã®ã‚­ãƒ¼åã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚ˆã†ã«ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã—ãŸå ´åˆã€ãã®ã‚­ãƒ¼ã®å…¨ã¦ã®å€¤ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å‡ºåŠ›ã§ãã‚‹ã€‚ã¾ãŸã€é…åˆ—çŠ¶ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚­ãƒ¼åã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚ˆã†ã«ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã—ãŸå ´åˆã€å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åŒã‚­ãƒ¼ã®å€¤ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å‡ºåŠ›ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/logs/log_configuration/processors/?tab=ui#string-builder-processor ï¼Šä¾‹ï¼Š ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’çµŒã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ åŒ–ãƒ­ã‚°ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã¨ã™ã‚‹ã€‚ { \"date\": 1609502400000, \"http\": { \"method\": \"GET\", \"status_code\": 200, \"url\": \"/users?paginate=10&fooId=1\", \"url_details\": { \"path\": \"/users\", \"queryString\": { \"fooId\": 1, \"paginate\": 10 } } }, \"network\": { \"client\": { \"ip\": \"192.168.0.1\" } } } ã“ã‚Œã«å¯¾ã—ã¦ã€ã‚¹ãƒˆãƒªãƒ³ã‚°ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚æ§‹é€ åŒ–ãƒ­ã‚°ã®http.urlã®å€¤ã‚’å‡ºåŠ›ã—ã¦å®Œå…¨ãªURLã‚’ç”Ÿæˆã—ã€ã“ã‚Œã‚’http.url_fullå±æ€§ã¨ã—ã¦æ–°ã—ãä»˜ä¸ã™ã‚‹ã€‚ https://exmaple.jp%{http.url} ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®æ§‹é€ åŒ–ãƒ­ã‚°ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚ { \"date\": 1609502400000, # ï½ ä¸­ç•¥ ï½ \"http\": { # ï½ ä¸­ç•¥ ï½ \"url_full\": \"https://exmaple.jp/users?paginate=10&fooId=1\" }, # ï½ ä¸­ç•¥ ï½ } ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ç³» ãƒ»ã‚«ãƒ†ã‚´ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ æ¤œç´¢æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹å±æ€§ã‚’æŒã¤æ§‹é€ åŒ–ãƒ­ã‚°ã«å¯¾ã—ã¦ã€å±æ€§ã‚’æ–°ã—ãä»˜ä¸ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š Nginxã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªéæ§‹é€ åŒ–ãƒ­ã‚°ã‚’å—ä¿¡ã™ã‚‹ä¾‹ã‚’è€ƒãˆã‚‹ã€‚ nn.nnn.nn.nn - - [01/Sep/2021:00:00:00 +0000] \"GET /healthcheck HTTP/1.1\" 200 17 \"-\" \"ELB-HealthChecker/2.0\" ä»¥ä¸‹ã®ã‚ˆã†ãªGrokãƒ‘ãƒ¼ã‚µãƒ¼ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚http.status_codeå±æ€§ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã€‚ access.common %{_client_ip} %{_ident} %{_auth} \\[%{_date_access}\\] \"(?>%{_method} |)%{_url}(?> %{_version}|)\" %{_status_code} (?>%{_bytes_written}|-) access.combined %{access.common} (%{number:duration:scale(1000000000)} )?\"%{_referer}\" \"%{_user_agent}\"( \"%{_x_forwarded_for}\")?.* error.format %{date(\"yyyy/MM/dd HH:mm:ss\"):date_access} \\[%{word:level}\\] %{data:error.message}(, %{data::keyvalue(\": \",\",\")})? ã“ã‚Œã«ã‚ˆã‚Šã€æ§‹é€ åŒ–ãƒ­ã‚°ã®å„å±æ€§ã«å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ { \"date_access\": 12345, \"http\": { \"method\": \"GET\", \"referer\": \"-\", \"status_code\": 200, \"url\": \"/healthcheck\", \"useragent\": \"ELB-HealthChecker/2.0\", \"version\": \"1.1\" }, \"network\": { \"bytes_written\": 17, \"client\": { \"ip\": \"nn.nnn.nnn.nn\" } } } ã“ã‚Œã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚«ãƒ†ã‚´ãƒªãƒ‘ãƒ¼ã‚µãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚http.status_codeå±æ€§ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰å€¤ã«å¿œã˜ã¦ã€http.status_categoryå±æ€§ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ãƒ™ãƒ«å€¤ï¼ˆinfoã€noticeã€warningã€errorï¼‰ã‚’ä»˜ä¸ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ info @http.status_code:[200 TO 299] notice @http.status_code:[300 TO 399] warning @http.status_code:[400 TO 499] error @http.status_code:[500 TO 599] ã“ã‚Œã«ã‚ˆã‚Šã€æ§‹é€ åŒ–ãƒ­ã‚°ã®http.status_categoryå±æ€§ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ãƒ™ãƒ«å€¤ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ãªãŠã€http.status_categoryå±æ€§ä»¥å¤–ã¯å…ƒã®æ§‹é€ åŒ–ãƒ­ã‚°ã¨åŒã˜ãŸã‚ã€çœç•¥ã—ã¦ã„ã‚‹ã€‚ { # ï½ ä¸­ç•¥ ï½ \"http\": { # ï½ ä¸­ç•¥ ï½ status_category: \"info\" }, # ï½ ä¸­ç•¥ ï½ } ã“ã‚Œã«å¯¾ã—ã¦ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒªãƒãƒƒãƒ‘ãƒ¼ã®ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚http.status_categoryå±æ€§ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ãƒ™ãƒ«å€¤ãŒã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚¡ã‚»ãƒƒãƒˆï¼ˆINFOã€WARNINGã€ERRORã€ãªã©ï¼‰ã¨ã—ã¦ç™»éŒ²ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ ãƒ‘ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ«ã®æ§‹æˆ ãƒ»ãƒãƒƒãƒãƒ£ãƒ¼ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/processing/parsing/?tab=matcher#%E3%83%9E%E3%83%83%E3%83%81%E3%83%A3%E3%83%BC%E3%81%A8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/processing/parsing/?tab=filter#%E3%83%9E%E3%83%83%E3%83%81%E3%83%A3%E3%83%BC%E3%81%A8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC 06-02. ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã€ãªã©ã®ãƒ­ã‚°ã‚’é›†ç´„çš„ã«åé›†ã—ã‚„ã™ããªã‚‹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æä¾›ã™ã‚‹ã€‚ ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª ãƒ»ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã¯ ãƒ­ã‚°ã®ç”Ÿæˆå…ƒã«åˆã‚ã›ã¦ã€ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã®ã‚»ãƒƒãƒˆãŒçµ„ã¿è¾¼ã¾ã‚ŒãŸãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æä¾›ã—ã¦ãã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://docs.datadoghq.com/logs/log_configuration/pipelines/?tab=source#integration-pipelines https://docs.datadoghq.com/integrations/#cat-log-collection ãƒ»AWSã®å ´åˆ AWSãƒªã‚½ãƒ¼ã‚¹ã§ç”Ÿæˆã•ã‚ŒãŸãƒ­ã‚°ã‚’Daadogã«è»¢é€ã§ãã‚‹ã‚ˆã†ã«ã—ã€ã¾ãŸæ§‹é€ åŒ–ãƒ­ã‚°ã¨ã—ã¦æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚æ¬¡ã®æ–¹æ³•ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã€‚ ï¼ˆï¼‘ï¼‰Datadogã®AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ç™»éŒ²ç”»é¢ã§ã€CloudFormationã«ã‚ˆã‚‹è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é¸æŠã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://app.datadoghq.com/account/settings#integrations/amazon-web-services ï¼ˆï¼’ï¼‰CloudFormationã«ã‚ˆã‚Šã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ãƒ­ã‚°ï¼åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è»¢é€ã™ã‚‹Lambdaã‚„IAMãƒ­ãƒ¼ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚æ§‹ç¯‰ã•ã‚ŒãŸIAMãƒ­ãƒ¼ãƒ«ï¼ˆDatadogIntegrationRoleï¼‰ã‚’Datadogã®IAMãƒ¦ãƒ¼ã‚¶ï¼ˆ464622532012ï¼‰ã«å§”è­²ã§ãã‚‹ã‚ˆã†ã«ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã¨ãƒ­ãƒ¼ãƒ«åã‚’Datadogã®è¨­å®šç”»é¢ã«å…¥åŠ›ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://app.datadoghq.com/account/settings#integrations/amazon-web-services ï¼ˆï¼“ï¼‰ã“ã“ã§ã¯ãƒ­ã‚°ã‚’è»¢é€ã§ãã‚‹ã‚ˆã†ã«ã€Lambdaã®ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦CloudWatchãƒ­ã‚°ã‚„S3ã‚’è¨­å®šã™ã‚‹ã€‚ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦è¨­å®šã›ãšã«ã€è‡ªå‹•ã§è»¢é€ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ãŒã€è‡ªå‹•èªè­˜ã•ã‚Œã‚‹ãƒ­ã‚°ã®ç¨®é¡ãŒå°‘ãªã„ã®ã§ã€æ‰‹å‹•ã§è¨­å®šã—ãŸæ–¹ãŒè‰¯ã„ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/logs/guide/send-aws-services-logs-with-the-datadog-lambda-function/?tab=awsconsole#automatically-set-up-triggers ï¼ˆï¼”ï¼‰é€ä¿¡å…ƒã®AWSãƒªã‚½ãƒ¼ã‚¹ã®å‘½åã«ã‚ˆã£ã¦ã€ãƒ­ã‚°ã®serviceå±æ€§ã®å€¤ãŒå¤‰ã‚ã‚‹ã€‚ä¾‹ãˆã°ã€CloudWatchãƒ­ã‚°ã®ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—åãŒã€api-gateway-***ã€ã‹ã‚‰å§‹ã¾ã‚‹å ´åˆã€å±æ€§å€¤ã¯apigatewayã«ãªã‚‹ã€‚ 06-03. ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å¾Œå‡¦ç† æ¨™æº–å±æ€§ã®ä»˜ä¸ 06-04. ã‚ªãƒ—ã‚·ãƒ§ãƒ³å‡¦ç† ãƒ­ã‚°ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ ãƒ»ãƒ­ã‚°ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã¯ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§å‡¦ç†ã‚’çµ‚ãˆãŸãƒ­ã‚°ã«é–¢ã—ã¦ã€å±æ€§ï¼ã‚¿ã‚°ã«åŸºã¥ããƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ä½œæˆã—ã¦ãŠãã¨ã€ãƒ­ã‚°ã®ãƒ¬ãƒãƒ¼ãƒˆã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://www.amazon.co.jp/dp/1800568738 ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã¯ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§å‡¦ç†ã‚’çµ‚ãˆãŸãƒ­ã‚°ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã€ãƒ­ã‚°ã®ç ´æ£„ãƒ«ãƒ¼ãƒ«ã‚„ä¿ç®¡æœŸé–“ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«å®šç¾©ã§ãã‚‹ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨ã„ã‚Œã°ã€Datadogã®ãƒ­ã‚°ä¿ç®¡ã®ãƒãƒƒã‚¯ã«ãªã‚‹ä¿ç®¡æ–™é‡‘ã‚’æŠ‘ãˆã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼š https://docs.datadoghq.com/ja/logs/indexes/ https://tech-blog.abeja.asia/entry/why-datadog ã‚¢ãƒ¼ã‚«ã‚¤ãƒ– ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ« 07. ãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ© Live Tail ãƒ»Live Tailã¨ã¯ ãƒ­ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†å¾Œã®ãƒ­ã‚°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèªã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/explorer/live_tail/ ãƒ­ã‚°ã‚¯ã‚¨ãƒª ãƒ»ãƒ­ã‚°ã‚¯ã‚¨ãƒª æ§‹é€ åŒ–ãƒ­ã‚°ã®å±æ€§åã¨å€¤ã«åŸºã¥ã„ã¦ã€ãƒ­ã‚°ã‚’çµã‚Šè¾¼ã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/explorer/search_syntax/ ãƒ»ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ å…¥åŠ›æ¬„å³ã®ã‚¢ã‚¤ã‚³ãƒ³ã§åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚æ¤œç´¢æ¡ä»¶ã¨ã—ã¦å±æ€§åã¨å€¤ã‚’è£œå®Œå…¥åŠ›ã§ãã‚‹ã€‚ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã‚’ã®ä½¿ç”¨æ™‚ã¯ã€å°æ–‡å­—ã§å…¥åŠ›ã—ãŸå±æ€§åã®é ­æ–‡å­—ãŒç”»é¢ä¸Šã§å¤§æ–‡å­—ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ ï¼Šä¾‹ï¼Š ã€service:fooã€ã‚’ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã§å…¥åŠ›ã™ã‚‹ã€‚ ãƒ»éã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ å…¥åŠ›æ¬„å³ã®ã‚¢ã‚¤ã‚³ãƒ³ã§åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚æ¤œç´¢æ¡ä»¶ã¨ã—ã¦å±æ€§åã¨å€¤ã‚’ãã®ã¾ã¾å…¥åŠ›ã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š ã€service:fooã€ã‚’éã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã§å…¥åŠ›ã™ã‚‹ã€‚ ãƒ•ã‚¡ã‚»ãƒƒãƒˆ ãƒ»ãƒ•ã‚¡ã‚»ãƒƒãƒˆã¨ã¯ å±æ€§ï¼ã‚¿ã‚°ã®å€¤ã«åŸºã¥ã„ã¦ã€ãƒ­ã‚°ã‚’ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã—ãŸã‚‚ã®ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/logs/explorer/facets/#%E3%83%AD%E3%82%B0%E3%82%B5%E3%82%A4%E3%83%89%E3%83%91%E3%83%8D%E3%83%AB ãƒ»å±æ€§ã®ãƒ•ã‚¡ã‚»ãƒƒãƒˆåŒ– Pathã®å€¤ã«å±æ€§ã¾ã§ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã€@ã€ã‹ã‚‰å…¥åŠ›ã™ã‚‹ã¨ã€ãƒ­ã‚°ã®å±æ€§ãŒãƒ•ã‚¡ã‚»ãƒƒãƒˆã®å€¤ã«ç™»éŒ²ã•ã‚Œã‚‹ã€‚ ãƒ»ã‚¿ã‚°ã®ãƒ•ã‚¡ã‚»ãƒƒãƒˆåŒ– Pathã®å€¤ã«ã‚¿ã‚°åã‚’ãã®ã¾ã¾å…¥åŠ›ã™ã‚‹ã¨ã€ã‚¿ã‚°ãŒãƒ•ã‚¡ã‚»ãƒƒãƒˆã®å€¤ã«ç™»éŒ²ã•ã‚Œã‚‹ã€‚ "},"public/observability_monitering/observability_datadog_distributed_trace.html":{"url":"public/observability_monitering/observability_datadog_distributed_trace.html","title":"ğŸ“– ï¸åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹åé›†","keywords":"","body":"åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹åé›† ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ ãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ã¨ã¯ APMæ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹æ™‚ã«ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç¨¼åƒã™ã‚‹Datadogã‚³ãƒ³ãƒ†ãƒŠã«åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã€ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒŠã§ãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦èª­ã¿è¾¼ã¾ã‚ŒãŸå¾Œã€ã€http://localhost:8126ã€ã‚’æŒ‡å®šã—ã¦ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’é€ä¿¡ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/#datadog-%E3%81%B8%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E9%80%81%E4%BF%A1 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¸€è¦§ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/developers/libraries/#apm-%E3%81%A8%E5%88%86%E6%95%A3%E5%9E%8B%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%B3%E3%82%B0%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA PHPãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« å„ã‚µãƒ¼ãƒ“ã‚¹ã®Dockerfileã«ã¦ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/tracing/setup_overview/setup/php/?tab=containers ENV DD_TRACE_VERSION=0.63.0 # GitHubã‹ã‚‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ RUN curl -Lo https://github.com/DataDog/dd-trace-php/releases/download/${DD_TRACE_VERSION}/datadog-php-tracer_${DD_TRACE_VERSION}_amd64.deb \\ # è§£å‡ && dpkg -i datadog-php-tracer.deb \\ # æ®‹éª¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ && rm datadog-php-tracer.deb ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚“ã ã‹å¦ã‹ã‚’ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã§ãã‚‹ã€‚ # æˆåŠŸã®å ´åˆ root@*****:/ php --ri=ddtrace ddtrace Datadog PHP tracer extension For help, check out the documentation at https://docs.datadoghq.com/tracing/languages/php/ (c) Datadog 2020 ... ã¾ã ã¾ã ç¶šã # å¤±æ•—ã®å ´åˆ root@*****:/ php --ri=ddtrace Extension 'ddtrace' not present. ãƒ»ç’°å¢ƒå¤‰æ•° ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã§ãã‚‹ã€‚åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ã‚¿ã‚°åã«åæ˜ ã•ã‚Œã‚‹ã€‚ç’°å¢ƒå¤‰æ•°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/setup_overview/setup/php/?tab=%E3%82%B3%E3%83%B3%E3%83%86%E3%83%8A#%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%82%B3%E3%83%B3%E3%83%95%E3%82%A3%E3%82%AE%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3 å¤‰æ•°å èª¬æ˜ ç”»é¢ DD_SERVICE_MAPPING åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã«ã‚µãƒ¼ãƒ“ã‚¹åã‚’è¨­å®šã™ã‚‹ã€‚ã‚µãƒ¼ãƒ“ã‚¹åã¯æ¨™æº–ã®ã§ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åã«ãªã‚‹ãŒã€ã“ã‚Œã‚’ä¸Šæ›¸ãã§ãã‚‹ï¼ˆä¾‹ï¼‰laravel:foo-laravel,pdo:foo-pdo https://app.datadoghq.com/apm/services DD_SERVICE_NAME åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã«ã‚µãƒ¼ãƒ“ã‚¹åã‚’è¨­å®šã™ã‚‹ã€‚DD_SERVICE_MAPPINGãŒnullã®å ´åˆã€ã“ã®ç’°å¢ƒå¤‰æ•°ã®å€¤ãŒä»£ã‚ã‚Šã«ã‚µãƒ¼ãƒ“ã‚¹åã«ãªã‚‹ï¼ˆä»•çµ„ã¿ãŒã‚ˆãã‚ã‹ã‚‰ã‚“ï¼‰ã€‚ DD_TRACE__ENABLED æœ‰åŠ¹åŒ–ã™ã‚‹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚æ¨™æº–ã§å…¨ã¦ã®ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€è¨­å®šã¯ä¸è¦ã§ã‚ã‚‹ã€‚Datadogã®ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹å ´åˆã¯ DD__DISABLED ç„¡åŠ¹åŒ–ã™ã‚‹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åã‚’è¨­å®šã™ã‚‹ã€‚ ãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ã®è¨­å®šã®çŠ¶æ…‹ã¯ã€php --ri=ddtraceã‚³ãƒãƒ³ãƒ‰ã®çµæœå¾—ã‚‰ã‚Œã‚‹JSONã‚’æ•´å½¢ã™ã‚‹ã“ã¨ã§ç¢ºèªã§ãã‚‹ã€‚ root@*****:/ php --ri=ddtrace Datadog tracing support => enabled Version => 0.57.0 DATADOG TRACER CONFIGURATION => { ..... } # Node.jsãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ ãƒ»TypeScriptã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ«ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆ ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹nuxt.config.jsãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€ä¸€ç•ªæœ€åˆã«Datadogã®ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ã€åˆæœŸåŒ–ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/setup_overview/setup/nodejs/?tab=%E3%82%B3%E3%83%B3%E3%83%86%E3%83%8A#typescript-%E3%81%A8%E3%83%90%E3%83%B3%E3%83%89%E3%83%A9%E3%83%BC import 'dd-trace/init' // ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å«ã‚€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒç¶šã ã¾ãŸã€åˆæœŸåŒ–æ™‚ã«è¨­å®šã—ãŸç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã§ãã‚‹ã€‚APMã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¿ã‚°åã«åæ˜ ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/setup_overview/setup/nodejs/?tab=%E3%82%B3%E3%83%B3%E3%83%86%E3%83%8A#%E3%82%B3%E3%83%B3%E3%83%95%E3%82%A3%E3%82%AE%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3 02. åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ç”Ÿæˆ åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ ãƒ»åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability.html ãƒ»æ§‹é€  Datadogã«ãŠã„ã¦ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã¯ã‚¹ãƒ‘ãƒ³ã‚’æŒã¤é…åˆ—ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/tracing/guide/send_traces_to_agent_by_api/ [ span1, span2, span3 ] ã¾ãŸã€è¤‡æ•°ã®åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’é…åˆ—ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å®šç¾©ã§ãã‚‹ã€‚ [ trace1, trace2, trace3 ] ã‚¹ãƒ‘ãƒ³ ãƒ»ã‚¹ãƒ‘ãƒ³ã¨ã¯ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/public/observability_monitering/observability.html ãƒ»æ§‹é€  Datadogã«ãŠã„ã¦ã€ã‚¹ãƒ‘ãƒ³ã¯JSONå‹ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®ãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ã«ãŠã„ã¦ã€æŒ‡å®šã•ã‚ŒãŸJSONå‹ã®ã‚¹ãƒ‘ãƒ³ãŒä½œæˆã•ã‚Œã€ã‚¹ãƒ‘ãƒ³ã¯Datadog-APIã«é€ä¿¡ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/tracing/guide/send_traces_to_agent_by_api/ ï¼Šå®Ÿè£…ä¾‹ï¼Š [ [ { \"duration\": 123, # å‡¦ç†ã®æ‰€è¦æ™‚é–“ \"error\": 0, # ã‚¨ãƒ©ãƒ¼ã®æœ‰ç„¡ \"meta\": { \"env\": \"prd\" # ã‚¿ã‚°ã®ã‚Š }, \"metrics\": { \"baz-sum\": 123 # ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ }, \"name\": \"laravel.request\", # ã‚¹ãƒ‘ãƒ³å \"parent_id\": 123, # è¦ªã‚¹ãƒ‘ãƒ³ID \"resource\": \"/foos\", # ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ \"service\": \"laravel\", # ã‚µãƒ¼ãƒ“ã‚¹å \"span_id\": 123456789, # ã‚¹ãƒ‘ãƒ³ID \"start\": 0, # å‡¦ç†é–‹å§‹æ™‚é–“ \"trace_id\": 123456789, # ãƒˆãƒ¬ãƒ¼ã‚¹ID \"type\": \"web\" # ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¿ã‚¤ãƒ— } ] ] ãƒ»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ ã‚¹ãƒ‘ãƒ³ã®metaã‚­ãƒ¼ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ã‚»ãƒƒãƒˆã‚’å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¯ã‚¿ã‚°ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š PHPãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ã§laravelå†…ã‹ã‚‰ã‚¿ã‚°ã‚’åé›†ã—ãŸä¾‹ { \"env\": \"prd\", \"http\": { \"host\": \"example.co.jp\", \"method\": \"GET\", \"path_group\": \"/foos\", \"status_code\": 200, \"url\": \"https://example.co.jp/foos/1\" }, \"laravel\": { \"route\": { \"action\": \"App\\Http\\Controllers\\Foo\\FooController@get\", \"name\": \"foos.get\" } }, \"php\" : { \"compilation\": { \"total_time_ms\": 123.45 } }, \"process_id\": 100 } ã‚¹ãƒ‘ãƒ³ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ ãƒ»ã‚¹ãƒ‘ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆåŒ– ã‚¹ãƒ‘ãƒ³ã®æŒã¤ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦é›†è¨ˆã™ã‚‹ã¨ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/generate_metrics/ ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹åã®æ§‹æˆè¦ç´  ãƒ¡ãƒˆãƒªã‚¯ã‚¹åã¯ã€trace..ã€ã®åå‰ã§æ§‹æˆã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/guide/metrics_namespace/ ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã‚¹ãƒ‘ãƒ³å ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¨ãªã£ãŸã‚¹ãƒ‘ãƒ³åãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ ï¼Šä¾‹ï¼Š trace.web.request. trace.db.query. trace.db.commit. ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹å ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ç¨®é¡ã«å¿œã˜ãŸã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹åãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/guide/metrics_namespace/#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9%E3%82%B5%E3%83%95%E3%82%A3%E3%83%83%E3%82%AF%E3%82%B9 ï¼Šä¾‹ï¼Š trace..hits.***ï¼ˆè©²å½“ã‚¹ãƒ‘ãƒ³ã®ãƒ’ãƒƒãƒˆæ•°ï¼‰ trace..durationï¼ˆè©²å½“ã‚¹ãƒ‘ãƒ³ã®å‡¦ç†æ™‚é–“ï¼‰ trace..duration.by.***ï¼ˆè©²å½“ã‚¹ãƒ‘ãƒ³ã®å‡¦ç†æ™‚é–“ã®å‰²åˆï¼‰ trace..errors.***ï¼ˆè©²å½“ã‚¹ãƒ‘ãƒ³ã«ãŠã‘ã‚‹ã‚¨ãƒ©ãƒ¼æ•°ï¼‰ 03. ã‚µãƒ¼ãƒ“ã‚¹ã®è­˜åˆ¥ ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¤ãƒ— ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¤ãƒ—ã¨ã¯ ãƒˆãƒ¬ãƒ¼ã‚µã«ã‚ˆã£ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€Webã€ã€DBã€ã€Cacheã€ã€Cacheã€ã®ï¼”ã¤ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚å„ã‚µãƒ¼ãƒ“ã‚¹ã®span.typeå±æ€§ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã‚¿ã‚¤ãƒ—åã‹ã‚‰è‡ªå‹•çš„ã«å‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹ã€‚ã‚¿ã‚¤ãƒ—åã®ç¨®é¡ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼š https://github.com/DataDog/dd-trace-php/blob/master/src/api/Type.php https://docs.datadoghq.com/ja/tracing/visualization/services_list/#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%97 ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¿ã‚° ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¿ã‚°ã¨ã¯ ãƒˆãƒ¬ãƒ¼ã‚µã«ã‚ˆã£ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¿ã‚°ã‚’è¿½åŠ ã§ãã‚‹ã€‚PHPãƒˆãƒ¬ãƒ¼ã‚µã®å„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã€PHPãƒˆãƒ¬ãƒ¼ã‚µãƒ¼ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã©ã®ã‚ˆã†ã«æƒ…å ±ã‚’æŠœãå‡ºã—ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ã‚¿ã‚°ã®å€¤ã‚’æ±ºå®šã—ã¦ã„ã‚‹ã‹ãŒã‚ã‹ã‚‹ã€‚ å‚è€ƒï¼š https://github.com/DataDog/dd-trace-php/tree/master/src/DDTrace/Integrations https://github.com/DataDog/dd-trace-php/blob/master/src/api/Tag.php 04. åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ è¨€èªï¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ãƒ„ãƒ¼ãƒ«ã€ãªã©ã«é–¢ã—ã¦ã€å°‚ç”¨ã®åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’åé›†ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ç”¨ã„ã‚‰ã‚Œã‚‹è¨€èªï¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®å ´åˆã€ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’æŒã¤ãŸã‚ã€ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã‚ã‚‹ã€‚ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã›ã‚ˆã€‚ å‚è€ƒï¼šhttps://github.com/DataDog/dd-trace-php/tree/master/src/DDTrace/Integrations "},"public/observability_monitering/observability_datadog_telemetry_association.html":{"url":"public/observability_monitering/observability_datadog_telemetry_association.html","title":"ğŸ“– ï¸ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼é–“ã®ç´ã¥ã‘","keywords":"","body":"ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼é–“ã®ç´ä»˜ã‘ 01. ã‚¿ã‚° ã‚¿ã‚°ã®ç¨®é¡ å‚è€ƒï¼š https://docs.datadoghq.com/ja/getting_started/tagging/ https://www.datadoghq.com/ja/blog/tagging-best-practices/ ã‚¿ã‚°å èª¬æ˜ host ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®é€ä¿¡å…ƒã®ãƒ›ã‚¹ãƒˆåã‚’ç¤ºã™ã€‚ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãŒç”Ÿæˆå…ƒã¨ã¯åˆ¥ã®å ´æ‰€ã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ã„ã‚‹å ´åˆã«å½¹ç«‹ã¤ã€‚ device source ãƒ­ã‚°ã®ç”Ÿæˆå…ƒã®ãƒ™ãƒ³ãƒ€ãƒ¼åã‚’ç¤ºã™ã€‚ service ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ç”Ÿæˆå…ƒã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åã‚’ç¤ºã™ã€‚ env ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ç”Ÿæˆå…ƒã®å®Ÿè¡Œç’°å¢ƒåã‚’ç¤ºã™ã€‚ version ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ç”Ÿæˆå…ƒã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åã‚’ç¤ºã™ã€‚ çµ±åˆã‚¿ã‚°ä»˜ã‘ çµ±åˆã‚¿ã‚°ï¼ˆserviceã€envã€versionï¼‰ã«åŒã˜å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã¨ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼é–“ã‚’ç´ã¥ã‘ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/getting_started/tagging/unified_service_tagging/?tab=kubernetes å„ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã§ã®ä½¿ã„æ–¹ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/getting_started/tagging/using_tags/ 02. æ§‹é€ åŒ–ãƒ­ã‚°ã¨ä»–ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼é–“ã®ç´ä»˜ã‘ åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹å…¨ä½“ã¨ã®ç´ä»˜ã‘ ã‚¹ãƒ‘ãƒ³ã¨æ§‹é€ åŒ–ãƒ­ã‚°ã®çµ±åˆã‚¿ã‚°ï¼ˆserviceã€envã€versionï¼‰ã«åŒã˜å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã¨ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹å…¨ä½“ã¨æ§‹é€ åŒ–ãƒ­ã‚°é–“ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/tracing/connect_logs_and_traces/ ã‚¹ãƒ‘ãƒ³ã¨ã®ç´ä»˜ã‘ ã‚¹ãƒ‘ãƒ³ã¨æ§‹é€ åŒ–ãƒ­ã‚°ã«ã€åŒã˜ãƒˆãƒ¬ãƒ¼ã‚¹IDã¨ã‚¹ãƒ‘ãƒ³IDã‚’å‰²ã‚Šå½“ã¦ã‚‹ã¨ã€ã‚¹ãƒ‘ãƒ³ã¨æ§‹é€ åŒ–ãƒ­ã‚°é–“ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãã®æ§‹é€ åŒ–ãƒ­ã‚°ãŒã€ã„ãšã‚Œã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã€ã¾ãŸã©ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ç™ºç”Ÿã—ãŸã‚‚ã®ã‹ã‚’ç¢ºèªã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/tracing/visualization/trace/?tab=logs 03. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ä»–ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼é–“ã®ç´ä»˜ã‘ ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã®ç´ä»˜ã‘ ã‚¹ãƒ‘ãƒ³ã¨ã‚³ãƒ³ãƒ†ãƒŠã®DockerLabelã®çµ±åˆã‚¿ã‚°ï¼ˆserviceã€envã€versionï¼‰ã«ã€åŒã˜å€¤ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã¨ã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã¨ã‚µãƒ¼ãƒï¼ã‚³ãƒ³ãƒ†ãƒŠã®OSã«é–¢ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚ "},"public/observability_monitering/observability_datadog_monitering.html":{"url":"public/observability_monitering/observability_datadog_monitering.html","title":"ğŸ“– ï¸ç›£è¦–","keywords":"","body":"ç›£è¦– ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ¢ãƒ‹ã‚¿ãƒ¼ ãƒ¢ãƒ‹ã‚¿ãƒ¼ã¨ã¯ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ãƒ­ã‚°ã‚’ç›£è¦–ã—ã€ã‚·ã‚¹ãƒ†ãƒ ã®äºˆæ¸¬å¯èƒ½ãªä¸å…·åˆã®ç™ºç”Ÿã‚’æœªç„¶ã«é˜²ãã€‚ ãƒ­ã‚°ãƒ¢ãƒ‹ã‚¿ãƒ¼ ãƒ»ãƒ­ã‚°ã‚¯ã‚¨ãƒªã®å‹•ä½œç¢ºèª ãƒ­ã‚°ãƒ¢ãƒ‹ã‚¿ãƒ¼ã®ã‚¯ã‚¨ãƒªã¯ã€ãƒ­ã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¨åŒã˜ä»•çµ„ã¿ã§æ©Ÿèƒ½ã™ã‚‹ã€‚ãã®ãŸã‚ã€æœ€åˆã¯ãƒ­ã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å¿…è¦ãªãƒ­ã‚°ã‚’çµã‚Šè¾¼ã‚ã‚‹ã‹ã‚’ç¢ºèªã—ã€å•é¡Œãªã‘ã‚Œã°ãƒ­ã‚°ãƒ¢ãƒ‹ã‚¿ãƒ¼ã®ã‚¯ã‚¨ãƒªã‚’è¨­å®šã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/monitors/monitor_types/log/#%E6%A4%9C%E7%B4%A2%E3%82%AF%E3%82%A8%E3%83%AA%E3%82%92%E5%AE%9A%E7%BE%A9%E3%81%99%E3%82%8B ãƒ»ã‚·ãƒ³ã‚°ãƒ«ã‚¢ãƒ©ãƒ¼ãƒˆ ãƒ»ãƒãƒ«ãƒã‚¢ãƒ©ãƒ¼ãƒˆ ãƒ­ã‚°ã‚¯ã‚¨ãƒªã§group byå¥ã‚’å®šç¾©ã™ã‚‹ã¨ã€é¸æŠã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ 01-02. é€šçŸ¥å†…å®¹ã®å®šç¾© ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ•° å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/monitors/notify/variables/?tab=is_alert#template-variables ãƒãƒ«ãƒã‚¢ãƒ©ãƒ¼ãƒˆå¤‰æ•° ãƒ»ãƒãƒ«ãƒã‚¢ãƒ©ãƒ¼ãƒˆå¤‰æ•°ã¨ã¯ ã‚¯ã‚¨ãƒªã®group byå¥ã«å‰²ã‚Šå½“ã¦ãŸã‚¿ã‚°ã‚„ãƒ•ã‚¡ã‚»ãƒƒãƒˆã‚’å¤‰æ•°ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚ãƒãƒ«ãƒã‚¢ãƒ©ãƒ¼ãƒˆãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚’ç”¨ã„ã‚‹å ´åˆã®ã¿ã€ä½¿ç”¨ã§ãã‚‹ã€‚ ã‚¿ã‚°å¤‰æ•° ãƒ»ã‚¿ã‚°å¤‰æ•°ã¨ã¯ æ§‹é€ åŒ–ãƒ­ã‚°ã®å±æ€§å€¤ã¾ãŸã¯ã‚¿ã‚°å€¤ã‚’å¤‰æ•°ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚{{log.attributes.}} ã¾ãŸã¯{{log.tags.}}ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/monitors/notify/variables/?tab=is_alert#matching-attributetag-variables ã‚³ãƒ³ãƒã‚¸ãƒƒãƒˆãƒ¢ãƒ‹ã‚¿ãƒ¼å¤‰æ•° ãƒ»ã‚³ãƒ³ãƒã‚¸ãƒƒãƒˆãƒ¢ãƒ‹ã‚¿ãƒ¼å¤‰æ•°ã¨ã¯ å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/monitors/notify/variables/?tab=is_alert#composite-monitor-variables æ¡ä»¶å¤‰æ•° å‚è€ƒï¼šhttps://docs.datadoghq.com/ja/monitors/notify/variables/?tab=is_alert#conditional-variables ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ§‹æˆ ãƒ»ã‚¿ã‚¤ãƒˆãƒ« é€šçŸ¥å…ˆã«ã‚¿ã‚¤ãƒˆãƒ«ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ã‚¿ã‚¤ãƒˆãƒ«ã«å¤‰æ•°ã‚’å‡ºåŠ›ã§ãã‚‹ã€‚ ã€{{log.attributes.service}}ã€‘ï½ˆç’°å¢ƒã§ã‚¨ãƒ©ãƒ¼ã‚’æ¤œçŸ¥ã—ã¾ã—ãŸ ãƒ»æœ¬æ–‡ é€šçŸ¥å…ˆã¨ãƒ†ã‚­ã‚¹ãƒˆã‚’å®šç¾©ã™ã‚‹ã€‚ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³è¨˜æ³•ã‚’ä½¿ç”¨ã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://www.datadoghq.com/ja/blog/tagging-best-practices/#%e3%83%81%e3%83%bc%e3%83%a0%e7%94%a8%e3%81%ae%e8%87%aa%e5%8b%95%e7%9a%84%e3%81%8b%e3%81%a4%e5%8b%95%e7%9a%84%e3%81%aa%e3%82%a2%e3%83%a9%e3%83%bc%e3%83%88%e3%82%92%e4%bd%9c%e6%88%90%e3%81%99%e3%82%8b {{#is_alert}} @ ç’°å¢ƒåï¼š{{log.attributes.env}} ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åï¼š{{log.attributes.service}} ãƒ­ã‚°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼š{{log.attributes.log_status}} ã‚½ãƒ¼ã‚¹åï¼š{{log.tags.source}} ãƒªãƒ¼ã‚¸ãƒ§ãƒ³åï¼š{{log.attributes.region}} {{/is_alert}} 02. ãƒªã‚¢ãƒ«ãƒ¦ãƒ¼ã‚¶ç›£è¦–ï¼ˆRUMï¼‰ ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ©ãƒ¼ ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ©ãƒ¼ã¨ã¯ Datadogã«ãŠã„ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¨ãƒ©ãƒ¼ã¯ä»¥ä¸‹ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/real_user_monitoring/browser/collecting_browser_errors/?tab=npm ã‚¨ãƒ©ãƒ¼ã®ã‚½ãƒ¼ã‚¹ ã‚¨ãƒ©ãƒ¼ã®ä¾‹ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ä¸Š ãƒ»ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã•ã‚Œãšã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ä¸Šã«è¡¨ç¤ºã•ã‚ŒãŸä¾‹å¤–ãƒ»ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã•ã‚Œãšã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ä¸Šã«è¡¨ç¤ºã•ã‚ŒãŸPromiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®rejectãƒ¡ã‚½ãƒƒãƒ‰ã®çµæœ ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Š console.errorãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«å‡ºåŠ›ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ ã‚«ã‚¹ã‚¿ãƒ  @datadog/browser-rumãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®addErrorãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ã€Datadog-APIã«é€ä¿¡ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ 03. åˆæˆç›£è¦– ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆ ãƒ»é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ Datadogç¤¾ã®ã‚µãƒ¼ãƒã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã‚‹ã€‚ã‚µãƒ¼ãƒè‡ªä½“ã¯AWSã‚„Azureã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¦ãŠã‚Šã€ç”¨ã„ã‚‹ã‚µãƒ¼ãƒã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠã§ãã‚‹ã€‚ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«æ•°å€‹ãšã¤ã‚µãƒ¼ãƒãŒå­˜åœ¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚‚ã—åˆæˆç›£è¦–å¯¾è±¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§IPåˆ¶é™ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒã®IPã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨±å¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ å‚è€ƒï¼šhttps://docs.datadoghq.com/synthetics/guide/identify_synthetics_bots/?tab=singleandmultistepapitests ãƒ»ãƒ˜ãƒƒãƒ€ãƒ¼ å‚è€ƒï¼š https://docs.datadoghq.com/synthetics/guide/identify_synthetics_bots/?tab=singleandmultistepapitests#default-headers https://docs.datadoghq.com/synthetics/apm/#how-are-traces-linked-to-tests ãƒ˜ãƒƒãƒ€ãƒ¼ å€¤ user-agent ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆã§è¨­å®šã—ãŸãƒ–ãƒ©ã‚¦ã‚¶ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ sec-datadog ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆã®IDãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ x-datadog-trace-id ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å ´åˆã€åé›†ã§ãã‚‹åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç´ä»˜ã‘ã‚‹IDãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ x-datadog-parent-id ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å ´åˆã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã®ãƒ«ãƒ¼ãƒˆã‚¹ãƒ‘ãƒ³ã¨ã—ã¦ã€0ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ x-datadog-origin ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å ´åˆã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ãŒAPMã‚¯ã‚ªãƒ¼ã‚¿ã«å½±éŸ¿ã—ãªã„ã‚ˆã†ã«ã€synthetics-browserãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ x-datadog-sampling-priority ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å ´åˆã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ãŒåé›†ã•ã‚Œã‚‹å„ªå…ˆåº¦ã¨ã—ã¦ã€1ãŒå‰²ã‚Šå½“ã¦ã‚Œã‚‹ã€‚ APIãƒ†ã‚¹ãƒˆ ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—APIãƒ†ã‚¹ãƒˆ 04. ã‚°ãƒ©ãƒ• å›³ã®ç¨®é¡ ã‚¹ã‚±ãƒ¼ãƒ«ã®ç¨®é¡ ãƒ»logï¼ˆå¯¾æ•°ï¼‰ã‚¹ã‚±ãƒ¼ãƒ« ãƒ»linearï¼ˆç·šå½¢ï¼‰ã‚¹ã‚±ãƒ¼ãƒ« ãƒ»ï¼’ã®ç´¯ä¹—ã‚¹ã‚±ãƒ¼ãƒ« ãƒ»sqrtï¼ˆå¹³æ–¹æ ¹ï¼‰ã‚¹ã‚±ãƒ¼ãƒ« "},"public/software_development_methodology/software_development_methodology.html":{"url":"public/software_development_methodology/software_development_methodology.html","title":"ğŸ“– ï¸ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³•è«–","keywords":"","body":"ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³•è«– ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«å‹é–‹ç™º ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«å‹é–‹ç™ºã¨ã¯ å¤–éƒ¨è¨­è¨ˆã®è©³ç´° å¤–éƒ¨è¨­è¨ˆã§ã¯ã€ãƒ¦ãƒ¼ã‚¶å‘ã‘ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¨­è¨ˆãŒè¡Œã‚ã‚Œã‚‹ã€‚ 02. ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å‹é–‹ç™º ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å‹é–‹ç™ºã¨ã¯ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¨­è¨ˆã«å…¥ã‚‹ã¾ã§ã«è©¦ä½œå“ã‚’ä½œã‚Šã€è¦ä»¶å®šç¾©ã‚’ã‚ˆã‚Šæ­£ç¢ºã«ã™ã‚‹é–‹ç™ºæ–¹æ³•ã€‚ 03. ãƒ¬ãƒ“ãƒ¥ãƒ¼ ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ã¯ å„å·¥ç¨‹ãŒå®Œäº†ã—ãŸæ®µéšã§ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡Œã†é–‹ç™ºæ–¹æ³•ã€‚ 04. RADï¼ˆRapid Application Developmentï¼‰ RADã¨ã¯ Visual Basicãªã©ã®é–‹ç™ºæ”¯æ´ãƒ„ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã€çŸ­æœŸé–“ã§è¨­è¨ˆï½ãƒ†ã‚¹ãƒˆã¾ã§ã‚’ç¹°ã‚Šè¿”ã™é–‹ç™ºæ–¹æ³•ã€‚ 05. ã‚¹ãƒ‘ã‚¤ãƒ©ãƒ«å‹é–‹ç™º ã‚¹ãƒ‘ã‚¤ãƒ©ãƒ«å‹é–‹ç™ºã¨ã¯ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã„ãã¤ã‹ã®ã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ ã«åˆ†å‰²ã—ã€ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«å‹é–‹ç™ºã§å„ã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹ç™ºã—ã¦ã„ãæ–¹æ³•ã€‚ 06. ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«å‹é–‹ç™º ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«å‹é–‹ç™ºã¨ã¯ ã‚¹ãƒ‘ã‚¤ãƒ©ãƒ«ãƒ¢ãƒ‡ãƒ«ã®æ´¾ç”Ÿå‹ã€‚ã‚¹ãƒ‘ã‚¤ãƒ©ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šã‚‚çŸ­ã„æœŸé–“ã§ã€è¨­è¨ˆï½ãƒ†ã‚¹ãƒˆã¾ã§ã‚’ç¹°ã‚Šè¿”ã™é–‹ç™ºæ–¹æ³•ã€‚ 07. CASEãƒ„ãƒ¼ãƒ«ï¼šComputer Aided Software Enginnering CASEãƒ„ãƒ¼ãƒ«ã¨ã¯ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãƒ„ãƒ¼ãƒ«ç¾¤ã®ã“ã¨ã€‚ ä¸ŠæµCASEãƒ„ãƒ¼ãƒ« ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³ã€ERå›³ ä¸‹æµCASEãƒ„ãƒ¼ãƒ« ãƒ†ã‚¹ãƒˆæ”¯æ´ãƒ„ãƒ¼ãƒ« ä¿å®ˆCASEãƒ„ãƒ¼ãƒ« ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚° "},"public/software_development_methodology/software_development_methodology_project_management.html":{"url":"public/software_development_methodology/software_development_methodology_project_management.html","title":"ğŸ“– ï¸ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†","keywords":"","body":"ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç† ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç† ç®¡ç†æŒ‡æ¨™ ã€é–‹ç™ºè¦æ¨¡ï¼ˆã‹ï¼‰ã€ã€ã€å·¥æ•°ï¼ˆã“ï¼‰ã€ã€ã€ç”Ÿç”£æ€§ï¼ˆã›ï¼‰ã€ã®å˜ä½é–“ã®é–¢ä¿‚ã¯ã€ã€ã¿ã¯ã˜ã€ã¨åŒã˜ã§ã‚ã‚‹ã€‚ ãƒ»é–‹ç™ºè¦æ¨¡ï¼ˆã‹ï¼‰ ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬æ•°ã«ã‚ˆã‚‹é–‹ç™ºè¦æ¨¡ï¼‰ï¼ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬æ•°ï¼‰ ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ è¡Œæ•°ã«ã‚ˆã‚‹é–‹ç™ºè¦æ¨¡ï¼‰ï¼ï¼ˆï½‹ã‚¹ãƒ†ãƒƒãƒ—è¡Œæ•°ï¼‰ ãƒ»å·¥æ•°ï¼ˆã“ï¼‰ ï¼ˆäººæ™‚ã«ã‚ˆã‚‹å·¥æ•°ï¼‰ï¼ï¼ˆäººæ•°ãƒ»æ™‚ï¼‰ï¼ï¼ˆäººæ•° Ã— æ™‚é–“ï¼‰ ï¼ˆäººæ™‚ã«ã‚ˆã‚‹æ¨™æº–å·¥æ•°ï¼‰ï¼ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¸€æœ¬å½“ãŸã‚Šã®äººæ•°ãƒ»æ™‚ï¼‰ï¼ï¼ˆäººæ•°ãƒ»æ™‚ï¼æœ¬ï¼‰ ä¸€æœŸé–‹ç™º å¤–éƒ¨è¨­è¨ˆ å†…éƒ¨è¨­è¨ˆ é–‹ç™º çµåˆãƒ†ã‚¹ãƒˆ ç·åˆãƒ†ã‚¹ãƒˆ å·¥æ•° 42ï¼ˆæ™‚é–“ï¼‰ 70 140 52.5 42.0 é…åˆ†æœˆæ•° 3ï¼ˆãƒ¶æœˆï¼‰ 3 5 2 3 Aç¤¾å‹•å“¡æ•° 12ï¼ˆäººï¼‰ 20 0 12 12 Bç¤¾å‹•å“¡æ•° 2ï¼ˆäººï¼‰ 4 28 15 2 ãƒ»ç”Ÿç”£æ€§ï¼ˆã›ï¼‰ ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬æ•°ã®ç”Ÿç”£æ€§ï¼‰ ï¼ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬æ•°ï¼äººæ™‚ï¼‰ ï¼ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬æ•°ã«ã‚ˆã‚‹é–‹ç™ºè¦æ¨¡ï¼‰Ã·ï¼ˆå·¥æ•°ï¼‰ ï¼ˆkã‚¹ãƒ†ãƒƒãƒ—è¡Œæ•°ã®ç”Ÿç”£æ€§ï¼‰ ï¼ï¼ˆï½‹ã‚¹ãƒ†ãƒƒãƒ—è¡Œæ•°ï¼äººæ™‚ï¼‰ ï¼ï¼ˆï½‹ã‚¹ãƒ†ãƒƒãƒ—è¡Œæ•°ã«ã‚ˆã‚‹é–‹ç™ºè¦æ¨¡ï¼‰Ã·ï¼ˆå·¥æ•°ï¼‰ ãƒ»é€²æ—ç‡ Arrow ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¿…è¦ãªæ—¥æ•° å…¨ä½“çš„ãªå·¥ç¨‹ã«å¿…è¦ãªæ—¥æ•°ã¯ã€æ‰€è¦æ—¥æ•°ãŒæœ€ã‚‚å¤šã„çµŒè·¯ã«å½±éŸ¿ã•ã‚Œã‚‹ã€‚ã“ã®çµŒè·¯ã‚’ã€Critical Path ã¨ã„ã†ã€‚ ãƒ»æœ€æ—©çµåˆç‚¹æ™‚åˆ» å…¨ä½“çš„ãªå·¥ç¨‹ã®ä¸­ã§ã€ä»»æ„ã®çµåˆç‚¹ã«å–ã‚Šæ›ã‹ã‚‹ãŸã‚ã«å¿…è¦ãªæœ€å°‘æ—¥æ•°ã®ã“ã¨ã€‚Critical Path ã«å½±éŸ¿ã•ã‚Œã‚‹ã®ã§ã€æ³¨æ„ã€‚ ãƒ»æœ€é…çµåˆç‚¹æ™‚åˆ» å…¨ä½“çš„ãªå·¥ç¨‹ã®ä¸­ã§ã€ä»»æ„ã®çµåˆç‚¹ã«å–ã‚Šæ›ã‹ã‚‹ãŸã‚ã«å¿…è¦ãªæœ€å¤šæ—¥æ•°ã®ã“ã¨ã€‚ "},"public/software_development_methodology/software_development_methodology_github.html":{"url":"public/software_development_methodology/software_development_methodology_github.html","title":"ğŸ“– ï¸GitHub","keywords":"","body":"GitHub ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ä½œæ¥­è€…ã®å ´åˆ Issue ãƒ»ä½œæˆ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å…ƒã«ã€Issueã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ»å‰Šé™¤ ãƒªãƒã‚¸ãƒˆãƒªã®ç®¡ç†è€…æ¨©é™ãŒã‚ã‚Œã°å‰Šé™¤ã§ãã‚‹ã€‚ PullReq ãƒ»ä½œæˆ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å…ƒã«ã€PullReqã‚’ä½œæˆã™ã‚‹ã€‚ ãƒ»å‰Šé™¤ ä¸å¯èƒ½ã®ãŸã‚ã€ã‚¯ãƒ­ãƒ¼ã‚ºã™ã‚‹ã—ã‹ãªã„ã€‚çŠ¯ã—ãŸç½ªã¯èƒŒè² ã£ã¦ç”Ÿãã¦ã„ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ å‚ç…§ï¼šhttps://stackoverflow.com/questions/18318097/delete-a-closed-pull-request-from-github 02. ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã®å ´åˆ ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹ ãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚„ä»•æ§˜é€šã‚Šã‹ å®Ÿè£…ã®æ¡ä»¶æ–‡ã‚„ã€ã‚³ãƒ¡ãƒ³ãƒˆã‹ã‚‰ã€ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚„ä»•æ§˜ã‚’ç†è§£ã™ã‚‹ã€‚ æ¡ä»¶æ–‡ã§var_dump() ã‚’è¡Œã†ã€‚ ã©ã†ã„ã£ãŸå…¥åŠ›ãŒã•ã‚ŒãŸæ™‚ã«true ã¨ã—ã¦åˆ¤æ–­ã—ã¦ã„ã‚‹ã®ã‹ã‚’ç¢ºèªã€‚ä¾‹ãˆã°ã€å—æ³¨æ¸ˆåŒºåˆ†å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã¨ãã«ã€ãã‚ŒãŒå¤±æ³¨åŒºåˆ†å€¤ã«å¤‰ã‚ã£ãŸå ´åˆã€å€¤ã‚’è¿”å´ã—ã¦ã„ã‚‹ãªã‚‰ã°ã€ãã“ã‹ã‚‰ã€ã€å¤±æ³¨ã€ã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ãŒå£é–“è¦‹ãˆã‚‹ã€‚ å®šæ•°ã«æ·»ãˆã‚‰ã‚ŒãŸã‚³ãƒ¡ãƒ³ãƒˆã‹ã‚‰ã€ä»•æ§˜ã‚’ç†è§£ã€‚ ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯é©åˆ‡ã‹ empty() ã€isset() ãªã©ã‚’æ­£ã—ãåŒºåˆ¥ã—ã¦ä½¿ãˆã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ ãƒ»å†—é•·ã«ãªã£ã¦ã„ãªã„ã‹ é‡è¤‡ã™ã‚‹å‡¦ç†ã‚’foreach()ã«ã¾ã¨ã‚ã‚‰ã‚Œãªã„ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ã¾ãŸã€å¤‰æ•°ã®æ ¼ç´ãŒé‡è¤‡ã—ã¦ã„ãªã„ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ 03. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ é…ç½®å ´æ‰€ ãƒªãƒã‚¸ãƒˆãƒªã®ç›´ä¸‹ã«.githubãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’é…ç½®ã—ã€ISSUE_TEMPLATE.mdã‚„PULL_REQUEST_TEMPLATE.mdã®åå‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã€‚Issueã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«é–¢ã—ã¦ã€ä»£ã‚ã‚Šã«ISSUE_TEMPLATEãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç½®ãã€ä»»æ„ã®åå‰ã®mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã¨ã€è¤‡æ•°ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã§ãã‚‹ã€‚ å‚è€ƒï¼šhttps://qiita.com/nyamogera/items/3fe6985b45fbd5377184 project/ â””â”€â”€ .github â”œâ”€â”€ ISSUE_TEMPLATE.md â””â”€â”€ PULL_REQUEST_TEMPLATE.md project/ â””â”€â”€ .github â”œâ”€â”€ ISSUE_TEMPLATE | â”œâ”€â”€ FIX.md | â””â”€â”€ UPDATE.md | â””â”€â”€ PULL_REQUEST_TEMPLATE.md Issue ãƒ»Issueã®åˆ†å‰² ä¸€ã¤ã®Issueã¨ãƒ–ãƒ©ãƒ³ãƒã«ãŸãã•ã‚“ã®å®Ÿè£…ã‚’Commitã™ã‚‹ã“ã¨ã¯æœ›ã¾ã—ããªã„ã€‚ãã“ã§ã€å¤§ããªå¯¾å¿œã‚’å€‹ã€…ã®å¯¾å¿œã«åˆ†å‰²ã™ã‚‹ã€‚ãã—ã¦ã€å¤§ããªå¯¾å¿œã«é–¢ã™ã‚‹åŸºç‚¹Issueã¨åŸºç‚¹ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã€å€‹ã€…ã®å¯¾å¿œã«é–¢é€£ã™ã‚‹å­Issueã¨å­ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã¦ã„ãã€‚å€‹åˆ¥ã®å¯¾å¿œãŒçµ‚ã‚ã£ãŸã‚‰ã€è¦ªãƒ–ãƒ©ãƒ³ãƒã¸ãƒãƒ¼ã‚¸ã—ã¦ã„ãã€‚ ãƒ»ã‚¿ã‚¤ãƒˆãƒ« ã‚¿ã‚¤ãƒˆãƒ«ã¯ã€ã€‡ã€‡ã™ã‚‹ã€‚ã€ã¨ã™ã‚‹ã€‚å¥èª­ç‚¹ã®æœ‰ç„¡ã¯å¥½ã¿ã€‚ ãƒ»å†…å®¹ å†…å®¹ã¯ã€èƒŒæ™¯ã€ã¨ã€å¯¾å¿œæ–¹é‡ã€ã•ãˆä¼ã‚ã‚Œã°ã€æ–‡è¨€è‡ªä½“ã¯ãã®ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ«ãƒ¼ãƒ«ã«åˆã‚ã›ã‚‹ã€‚ ï¼Šä¾‹ï¼Š # èƒŒæ™¯ # å¯¾å¿œæ–¹é‡ PullReq ãƒ»ã‚¿ã‚¤ãƒˆãƒ« ã‚¿ã‚¤ãƒˆãƒ«ã¯ã€ã€‡ã€‡ã—ãŸã€‚ã€ã¨ã™ã‚‹ã€‚å¥èª­ç‚¹ã®æœ‰ç„¡ã¯å¥½ã¿ã€‚ ãƒ»WIP å®Ÿè£…é€”ä¸­ã®PullReqã§ã‚ã‚Šã€å®Ÿè£…æ–¹æ³•ãªã©ã‚’è³ªå•ã—ãŸã„å ´åˆã€ã‚¿ã‚¤ãƒˆãƒ«ã«ã€WIPã€ã¨ã¤ã‘ã¦ãŠãã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã‚‚ã‚‰ã„ãŸããªã£ãŸã‚‰ã€ã“ã‚Œã‚’ã¯ãšã™ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¿®æ­£æ™‚ã«ã€å®Ÿè£…ã«æ™‚é–“ãŒã‹ã‹ã‚Šãã†ã§ã‚ã£ãŸã‚‰ã€å†ã³ä»˜ã‘ã¦ã‚‚è‰¯ã„ã€‚ ãƒ»å†…å®¹ å†…å®¹ã¯ã€å¯¾å¿œå†…å®¹ã€ã¨ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã»ã—ã„ã¨ã“ã‚ã€ã•ãˆä¼ã‚ã‚Œã°ã€æ–‡è¨€è‡ªä½“ã¯ãã®ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ«ãƒ¼ãƒ«ã«åˆã‚ã›ã‚‹ã€‚ã‚‚ã—ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼æœŸé™ã‚„å‹•ä½œç¢ºèªæ‰‹é †ã‚’çŸ¥ã‚‰ã›ã‚‹å¿…è¦ãŒã‚ã‚Œã°ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼æœŸé™ã€ã€ç¢ºèªæ‰‹é †ã€ã®é …ç›®ã‚’è¨­ã‘ã‚‹ã€‚ ï¼Šä¾‹ï¼Š # ãƒªãƒªãƒ¼ã‚¹äºˆå®šæ—¥ # å¯¾å¿œå†…å®¹ # ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã„ãŸã ããŸã„ã¨ã“ã‚ 04. Tips åŸºç‚¹ãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰äºŒå›æ´¾ç”Ÿã™ã‚‹ãƒ–ãƒ©ãƒ³ãƒãƒãƒ¼ã‚¸ã™ã‚‹æ™‚ã®æ³¨æ„ç‚¹ ï¼ˆï¼‘ï¼‰åŸºç‚¹ãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ã€ä¸€ã¤ç›®ã®ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã—ã€ã“ã‚Œã‚’pushã™ã‚‹ã€‚ã“ã“ã§pushã—ãªã„ã¨ã€2ç•ªç›®ã®ãƒ–ãƒ©ãƒ³ãƒãŒä¸€ã¤ç›®ã®ãƒ–ãƒ©ãƒ³ãƒã¨ã®å·®åˆ†ã‚’æ¤œå‡ºã—ã¦ã—ã¾ã„ã€å¤§é‡ã®å·®åˆ†ã‚³ãƒŸãƒƒãƒˆãŒgithubã«è¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†ã€‚ ï¼ˆï¼’ï¼‰ä¸€ã¤ç›®ã®ãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰äºŒã¤ç›®ã®ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã—ã€‚ã“ã‚Œã‚’pushã™ã‚‹ã€‚ Conflictã®è§£æ±ºæ–¹æ³•ã¨ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã®ä½œæˆ ï¼ˆï¼‘ï¼‰git statusã‚’è¡Œã„ã€ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ Unmerged paths: (use \"git restore --staged ...\" to unstage) (use \"git add ...\" to mark resolution) both modified: XXX/YYY.twig ï¼ˆï¼’ï¼‰ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã—ã¦ã„ãŸã‚³ãƒ¼ãƒ‰è¡Œã‚’å–æ¨é¸æŠã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰ä¸€åº¦addã‚’è¡Œã„ã€ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã®ä¿®æ­£ã‚’Gitã«èªè­˜ã•ã›ã‚‹ã€‚ $ git add XXX/YYY.twig ï¼ˆï¼”ï¼‰git statusã‚’è¡Œã„ã€ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãŒè§£æ±ºã•ã‚ŒãŸãŒã€ãƒãƒ¼ã‚¸ã•ã‚Œã¦ã„ãªã„ã¨å‡ºåŠ›ã•ã‚Œã‚‹ã€‚å·®åˆ†ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒãŸãã•ã‚“è¡¨ç¤ºã•ã‚Œã‚‹å ´åˆãŒã‚ã‚‹ãŒã€å•é¡Œãªã„ã€‚ All conflicts fixed but you are still merging. Changes to be committed: modified: XXX modified: XXX ï¼ˆï¼•ï¼‰git commitï¼ˆ-mã¯ã¤ã‘ã¦ã¯ã„ã‘ãªã„ï¼‰ã‚’è¡Œã„ã€vimã‚¨ãƒ‡ã‚£ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ Merge branch \"ãƒ–ãƒ©ãƒ³ãƒå\" into ãƒ–ãƒ©ãƒ³ãƒå ï¼ˆï¼–ï¼‰:wqã§ã‚¨ãƒ‡ã‚£ã‚¿ã‚’çµ‚äº†ã™ã‚Œã°ã€ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’è§£æ¶ˆã—ãŸãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆãŒä½œæˆã•ã‚Œã‚‹ã€‚ ï¼ˆï¼—ï¼‰git statusã‚’è¡Œã†ã€‚å ´åˆã«ã‚ˆã£ã¦ã¯ã€å·®åˆ†ã®ã‚³ãƒŸãƒƒãƒˆæ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŒå•é¡Œãªã„ã€‚ Your branch is ahead of \"origin/feature/XXXX\" by 10 commits. ï¼ˆï¼˜ï¼‰pushã™ã‚‹ã€‚ã“ã®æ™‚ã€ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆã™ã‚‹æ™‚ã€åŸºç‚¹ãƒ–ãƒ©ãƒ³ãƒä»¥å¤–ã‹ã‚‰ãƒãƒ¼ã‚¸ã—ã¦ã„ã‚‹ã¨ã€å·®åˆ†ã®ã‚³ãƒŸãƒƒãƒˆãŒä¸€ã¤ã«ã¾ã¨ã¾ã‚‰ãšã€ å‚è€ƒï¼šhttp://www-creators.com/archives/1938 Commitã®ç²’åº¦ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ•ãƒ­ãƒ³ãƒˆå‡ºåŠ›ã¾ã§ã«è‡³ã‚‹å®Ÿè£…ã‚’Commitã™ã‚‹å ´åˆã€ä»¥ä¸‹ã®3ã¤ã‚’æ„è­˜ã™ã‚‹ã€‚ ï¼ˆï¼‘ï¼‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰Commit ï¼ˆï¼’ï¼‰é–¢é€£æ€§ã®ã‚ã‚‹å®Ÿè£…ã‚’ã¾ã¨ã‚ã¦Commit ï¼ˆï¼“ï¼‰ä¸€å›ã®CommitãŒã‚‚ã¤ã‚³ãƒ¼ãƒ‰é‡ãŒå°‘ãªããªã‚‹ã‚ˆã†ã«Commit hotfixãƒ–ãƒ©ãƒ³ãƒã®ä½œæˆ ãƒªãƒªãƒ¼ã‚¹å¾Œã«ä¿®æ­£ç‚¹ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã€ä¿®æ­£ç”¨ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã€ã“ã‚Œã‚’é€Ÿã‚„ã‹ã«ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ï¼ˆï¼‘ï¼‰Issueã‚’ä½œæˆã™ã‚‹ã€‚ ï¼ˆï¼’ï¼‰mainãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ã€ã€hotfix/ã€ã®åå‰ã§ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã™ã‚‹ã€‚ ï¼ˆï¼“ï¼‰ãƒ—ãƒ«ãƒªã‚¯ã‚’ä½œæˆã—ã€ãƒãƒ¼ã‚¸ã®å‘ãå…ˆã‚’mainãƒ–ãƒ©ãƒ³ãƒã¨ã™ã‚‹ã€‚ ï¼ˆï¼”ï¼‰é€Ÿæ”»ã§approveã‚’ã‚‚ã‚‰ã„ã€mainãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã™ã‚‹ã€‚ã“ã®æ™‚ã€hotfixãƒ–ãƒ©ãƒ³ãƒã¯å¾Œã§developãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã™ã‚‹ãŸã‚ã€å‰Šé™¤ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ ï¼ˆï¼•ï¼‰ãƒ‘ãƒƒãƒç•ªå·ã‚’ä¸€ã¤å¢—ã‚„ã—ãŸã‚¿ã‚°ã‚’ä»˜ä¸ã—ã€å†ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã€‚ ï¼ˆï¼–ï¼‰ãƒªãƒªãƒ¼ã‚¹å¾Œã€ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆã•ã‚ŒãŸã‚‰ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã§hotfixãƒ–ãƒ©ãƒ³ãƒã‚’developãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã™ã‚‹ã€‚ "},"public/software_development_methodology/software_development_methodology_git_command.html":{"url":"public/software_development_methodology/software_development_methodology_git_command.html","title":"ğŸ“– ï¸Gitã‚³ãƒãƒ³ãƒ‰","keywords":"","body":"Gitã‚³ãƒãƒ³ãƒ‰ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ 01. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç³»ã‚³ãƒãƒ³ãƒ‰ clone ãƒ»clone ä¸€ç•ªã€ã‚¯ãƒ­ãƒ¼ãƒ³ã®é€Ÿåº¦ãŒé€Ÿãã€ã‚³ãƒãƒ³ãƒ‰ã®å¼•æ•°ã‚‚ç°¡å˜ã€‚ $ git clone https://github.com//.git ãƒ»clone ã‚µãƒ¼ãƒæ¥ç¶šåã¯ã€SSHæ¥ç¶šã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ~/.ssh/configï¼‰ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Githubã®æ¥ç¶šåã¯ã€ã€github.comã€ã«ãªã£ã¦ã„ã‚‹ã€‚ $ git clone git@:/.git config ãƒ» è¨­å®šã®å½±éŸ¿ç¯„å›²ã®ç¨®é¡ å½±éŸ¿ç¯„å›² æ„å‘³ ä¸Šæ›¸ãé † è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ system å…¨PCãƒ¦ãƒ¼ã‚¶ã®å…¨ãƒªãƒã‚¸ãƒˆãƒª 1 /etc/gitconfig global ç¾åœ¨ã®PCãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¨ãƒªãƒã‚¸ãƒˆãƒª 2 ~/.gitconfig local ç¾åœ¨ã®ãƒªãƒã‚¸ãƒˆãƒª 3 /.git/config ãƒ»config -- --list æŒ‡å®šã—ãŸå½±éŸ¿ç¯„å›²ã§é©ç”¨ã•ã‚Œã¦ã„ã‚‹è¨­å®šå€¤ã‚’è¡¨ç¤ºã™ã‚‹ã€‚--localã§è¨­å®šã•ã‚Œã¦ã„ãªã„é …ç›®ã¯ã€--globalã®è¨­å®šå€¤ãŒé©ç”¨ã•ã‚Œã‚‹ã€‚ $ git config --local --list Macã§ã¯ã€ä¸€ã¤ã®PCã§äºŒã¤ã®GutHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”¨ã„ã‚‹å ´åˆã€ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã¨ã„ã†æ©Ÿèƒ½ã§è¨­å®šãŒå¿…è¦ã«ãªã‚‹ã€‚ å‚è€ƒï¼šhttps://sy-base.com/myrobotics/others/git-push_403error/ ãƒ»config -- user.name Authorã¨Committerã®åå‰ã‚’è¨­å®šã™ã‚‹ã€‚localãŒä¸€ç•ªæœ€å¾Œã«ä¸Šæ›¸ãã•ã‚Œã€é©ç”¨ã•ã‚Œã‚‹ã€‚ $ git config --local user.name \"hiroki-it\" ãƒ»config -- user.email Authorã¨Committerã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹ã€‚localãŒä¸€ç•ªæœ€å¾Œã«ä¸Šæ›¸ãã•ã‚Œã€é©ç”¨ã•ã‚Œã‚‹ã€‚ $ git config --local user.email \"example@gmail.com\" Authorã®æƒ…å ±ã¯ã€ã‚³ãƒŸãƒƒãƒˆæ™‚ã«åæ˜ ã•ã‚Œã‚‹ã€‚ï¼ˆCommitterã¯è¡¨ç¤ºã•ã‚Œãªã„ï¼‰ $ git log commit ee299250a4741555eb5027ad3e56ce782fe90ccb Author: hiroki-it Date: Sat Sep 12 00:00:00 2020 +0900 add â—¯â—¯ã‚’å®Ÿè£…ã—ãŸã€‚ ãƒ»config --global core.autocrlf æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ã€ç‰¹å®šã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è‡ªå‹•å¤‰æ›ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚inputã¨ã—ã¦ãŠãã®ãŒè‰¯ã„ã€‚ $ git config --global core.autocrlf è¨­å®šå€¤ ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ™‚ ã‚³ãƒŸãƒƒãƒˆæ™‚ input å¤‰æ›ã—ãªã„ CRLF -> LF true LF -> CRLF CRLF -> LF false å¤‰æ›ã—ãªã„ å¤‰æ›ã—ãªã„ ãƒ»config --global core.editor gitã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’è¨­å®šã™ã‚‹ã€‚ã“ã“ã§ã¯ã€Vimã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ã™ã‚‹ã€‚ $ git config --global core.editor \"vim -c \"set fenc=utf-8\"\" remote ãƒ»remote set-url origin ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«æ¥ç¶šã™ã‚‹ã€‚configãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶åã¨æ¥ç¶šåã‚’è¨­å®šã™ã‚‹ã€‚ä¸€ã¤ã®PCã§è¤‡æ•°ã®GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”¨ã„ã¦ã„ã‚‹å ´åˆã€è¨­å®šãŒå¿…é ˆã§ã‚ã‚‹ã€‚ $ git remote set-url origin @:/.git # ãƒªãƒã‚¸ãƒˆãƒªï¼‘ Host User Port 22 HostName IdentityFile # ãƒªãƒã‚¸ãƒˆãƒªï¼’ Host User Port 22 HostName IdentityFile ãƒªãƒã‚¸ãƒˆãƒªã«å¯¾ã—ã¦pushã‚’å®Ÿè¡Œã—ã¦ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸå ´åˆã€ç•°ãªã‚‹æ¥ç¶šåãŒé¸ã°ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€URLã®ã€æ¥ç¶šåã€ã®éƒ¨åˆ†ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚ $ git push ERROR: Permission to hiroki-it/*****.git denied to Foo. fatal: Could not read from remote repository. Please make sure you have the correct access rights and the repository exists. 02. é–‹ç™ºç³»ã‚³ãƒãƒ³ãƒ‰ add ãƒ»add --all å¤‰æ›´ã—ãŸå…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’addã™ã‚‹ã€‚ branch ãƒ»branch --all ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã¨ãƒªãƒ¢ãƒ¼ãƒˆè¿½è·¡ãƒ–ãƒ©ãƒ³ãƒã‚’è¡¨ç¤ºã€‚ ãƒ»branch --delete --force ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒå} ãƒ—ãƒƒã‚·ãƒ¥ã¨ãƒãƒ¼ã‚¸ã®çŠ¶æ…‹ã«é–¢ä¿‚ãªãã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã‚’å‰Šé™¤ã€‚ ãƒ»branch --move ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã®åå‰ã‚’å¤‰æ›´ã€‚ ãƒ»branch --delete --remote origin/ ãƒªãƒ¢ãƒ¼ãƒˆè¿½è·¡ãƒ–ãƒ©ãƒ³ãƒã‚’å‰Šé™¤ã€‚ ï¼ˆï¼‘ï¼‰ã¾ãšã€branch --allã§ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã¨ãƒªãƒ¢ãƒ¼ãƒˆè¿½è·¡ãƒ–ãƒ©ãƒ³ãƒã‚’è¡¨ç¤ºã€‚ $ git branch --all * master remotes/origin/2019/Symfony_Nyumon/master remotes/origin/master ï¼ˆï¼’ï¼‰remotes/origin/2019/Symfony_Nyumon/masterã‚’å‰Šé™¤ã€‚ $ git branch -d -r origin/2019/Symfony_Nyumon/master Deleted remote-tracking branch origin/2019/Symfony_Nyumon/master (was 18a31b5). ï¼ˆï¼“ï¼‰å†ã³ã€branch --allã§å‰Šé™¤ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã€‚ $ git branch --all * master remotes/origin/master ãƒ»branch checkout -b $ git checkout -b feature/3 d7e49b04 æŒ‡å®šã®ã‚³ãƒŸãƒƒãƒˆã‹ã‚‰æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒã‚’ç”Ÿã‚„ã™ã“ã¨ãŒã§ãã‚‹ã€‚ cherry-pick ãƒ»cherry-pick -m 1 ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒã«å¯¾ã—ã¦ã€æŒ‡å®šã—ãŸã‚³ãƒŸãƒƒãƒˆãã‚Œå˜ä½“ã‚’ãƒãƒ¼ã‚¸ã™ã‚‹ã€‚ $ git cherry-pick 1d0ddeb9e52 ãƒ—ãƒ«ãƒªã‚¯ã®ãƒãƒ¼ã‚¸ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãã®ãƒ—ãƒ«ãƒªã‚¯ã§å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ãŒã‚³ãƒŸãƒƒãƒˆã®å†…å®¹ã¨ã—ã¦å–å¾—ã§ãã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€developãƒ–ãƒ©ãƒ³ãƒä¸Šã®å¿…è¦ãªå¤‰æ›´ã®ã¿ã‚’ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚ãŸã ã—ã€ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡å®šã™ã‚‹æ™‚ã¯mã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã—ãªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã€‚ # mã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒãªã„ã¨ã‚¨ãƒ©ãƒ¼ $ git cherry-pick d7e49b04 error: commit d7e49b04 is a merge but no -m option was given. fatal: cherry-pick failed # mã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ $ git cherry-pick -m 1 d7e49b04 [master a9ebcb4] Merge pull request #276 from feature/123 Author: hiroki-it Date: Wed Sep 15 00:00:00 2021 +0900 1 file changed, 7 insertions(+) stash ãƒ»stashã¨ã¯ ãƒ•ã‚¡ã‚¤ãƒ«ãŒã€ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ï¼ˆ=addï¼‰ã‚ã‚‹ã„ã¯ã€HEADã€ï¼ˆ=commitï¼‰ã«å­˜åœ¨ã—ã¦ã„ã‚‹çŠ¶æ…‹ã§ã€ç•°ãªã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã‚’checkoutã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€‚ $ git checkout 2019/Symfony2_Ny umon/master error: Your local changes to the following files would be overwritten by checkout: app/config/config.yml src/AppBundle/Entity/Inquiry.php Please commit your changes or stash them before you switch branches. Aborting ã“ã®å ´åˆã€ä¸€åº¦stashã‚’è¡Œã„ã€ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ï¼ˆ=addï¼‰ã‚ã‚‹ã„ã¯ã€HEADã€ï¼ˆ=commitï¼‰ã‚’æ¨ªã«ç½®ã„ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ»stash -u --include-untracked ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å«ã‚ã¦ã€å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€€é¿ã€‚ git statusã‚’ã—ãŸã¨ã“ã‚ã€ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«ãŒï¼“ã¤ã€ãƒˆãƒ©ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒï¼‘ã¤ã‚ã‚‹ã€‚ $ git status On branch 2019/Symfony2_Nyumon/feature/6 Your branch is up to date with \"origin/2019/Symfony2_Nyumon/feature/6\". Changes not staged for commit: (use \"git add ...\" to update what will be committed) (use \"git checkout -- ...\" to discard changes in working directory) modified: app/Resources/views/Inquiry/index.html.twig modified: app/config/config.yml modified: src/AppBundle/Entity/Inquiry.php Untracked files: (use \"git add ...\" to include in what will be committed) app/Resources/views/Toppage/menu.html.twig no changes added to commit (use \"git add\" and/or \"git commit -a\") ã“ã‚Œã‚’ã€stash -uã™ã‚‹ $ git stash -u Saved working directory and index state WIP on 2019/Symfony2_Nyumon/feature/6: 649995e update #6 xxx ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ç‚¹ã‚’ä¸€æ™‚çš„ã«é€€é¿ã§ãã‚‹ã€‚ ãƒ»stash -- ç‰¹å®šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿stashã§ãã‚‹ã€‚ git stash -- src/... ãƒ»stash list é€€é¿ã—ã¦ã„ã‚‹ã€ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·ãƒ–ãƒ©ãƒ³ãƒè¦ªã‚³ãƒŸãƒƒãƒˆã¨ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚’ä¸€è¦§ã§è¡¨ç¤ºã€‚ $ git stash list stash@{0}: WIP on 2019/Symfony2_Nyumon/feature/6: 649995e update #6 xxx ãƒ»stash pop stash@{} é€€é¿ã—ã¦ã„ã‚‹æŒ‡å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¾©å…ƒã€‚ $ git stash pop stash@{0} On branch 2019/Symfony2_Nyumon/feature/8 Changes not staged for commit: (use \"git add ...\" to update what will be committed) (use \"git checkout -- ...\" to discard changes in working directory) modified: app/Resources/views/Inquiry/index.html.twig modified: app/config/config.yml modified: src/AppBundle/Entity/Inquiry.php Untracked files: (use \"git add ...\" to include in what will be committed) app/Resources/views/Toppage/menu.html.twig no changes added to commit (use \"git add\" and/or \"git commit -a\") ãƒ»stash drop stash@{} é€€é¿ã—ã¦ã„ã‚‹æŒ‡å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¾©å…ƒã›ãšã«å‰Šé™¤ã€‚ $ git stash drop stash@{0} Dropped refs/stash@{0} (1d0ddeb9e52a737dcdbff7296272080e9ff71815) ãƒ»stash clear é€€é¿ã—ã¦ã„ã‚‹å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¾©å…ƒã›ãšã«å‰Šé™¤ã€‚ $ git stash clear revert ãƒ»revertã¨ã¯ ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã„ã¦ã€æŒ‡å®šã®å±¥æ­´ã‚’å‰Šé™¤ã€‚ ãƒ»revert --no-edit æŒ‡å®šã—ãŸã‚³ãƒŸãƒƒãƒˆã®ã¿ã‚’æ‰“ã¡æ¶ˆã™æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€æ‰“ã¡æ¶ˆã™ã‚³ãƒŸãƒƒãƒˆã¨åŒã˜ã‚‚ã®ã«ãªã‚‹ã€‚ãƒªãƒªãƒ¼ã‚¹å¾Œã«å…ƒã«æˆ»ã—ãŸã„æ™‚ã«å½¹ç«‹ã¤ã€‚ $ git revert --no-edit ãƒ»revert --edit æŒ‡å®šã—ãŸã‚³ãƒŸãƒƒãƒˆã®ã¿ã‚’æ‰“ã¡æ¶ˆã™æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã€‚vimãŒèµ·å‹•ã™ã‚‹ã®ã§ã€ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ–°ã—ã„ã‚‚ã®ã«å¤‰æ›´ã™ã‚‹ã€‚ $ git revert --edit ãƒ»revert -m æŒ‡å®šã—ãŸãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã®ã¿ã‚’æ‰“ã¡æ¶ˆã™æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã€‚ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€æ‰“ã¡æ¶ˆã™ã‚³ãƒŸãƒƒãƒˆã¨åŒã˜ã‚‚ã®ã«ãªã‚‹ã€‚ãƒãƒ¼ã‚¸ãƒŠãƒ³ãƒãƒ¼ã‚’äº‹å‰ã«ç¢ºèªã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ $ git show commit xyz Merge: 1a1a1a 2b2b2b #ã“ã“ã«æ³¨ç›® Author: xxxx xxxx Date: Thu Jul 13 09:00:00 2017 +0000 Merge commit $ git revert -m 1 xyz reset ãƒ»resetã¨ã¯ ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã„ã¦ã€æŒ‡å®šã®å±¥æ­´ã¾ã§æˆ»ã—ã€ãã‚Œä»¥é™ã‚’å‰Šé™¤ã€‚ ãƒ»reset HEAD ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰ã€æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã€‚ $ git reset HEAD ãƒ»reset --soft ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã„ã¦ã€æœ€æ–°ã®HEADï¼ˆ=commitå¾Œï¼‰ã‚’æŒ‡å®šã®å±¥æ­´ã¾ã§æˆ»ã—ã€ãã‚Œä»¥é™ã‚’å‰Šé™¤ã™ã‚‹ã€‚commitã®ã¿ã‚’å–ã‚Šæ¶ˆã—ãŸã„å ´åˆã¯ã“ã‚Œã€‚ $ git reset --soft ãƒ»reset --mixed ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã„ã¦ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ=addå¾Œï¼‰ã€HEADï¼ˆ=commitå¾Œï¼‰ã‚’æŒ‡å®šã®å±¥æ­´ã¾ã§æˆ»ã—ã€ãã‚Œä»¥é™ã‚’å‰Šé™¤ã€‚addã¨commitã‚’å–ã‚Šæ¶ˆã—ãŸã„å ´åˆã¯ã“ã‚Œã€‚ $ git reset --mixed ãƒ»reset --hard ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã„ã¦ã€æœ€æ–°ã®ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ï¼ˆ=ãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ=addå¾Œï¼‰ã€HEADï¼ˆ=commitå¾Œï¼‰ã‚’æŒ‡å®šã®å±¥æ­´ã¾ã§æˆ»ã—ã€ãã‚Œä»¥é™ã‚’å‰Šé™¤ã€‚ **ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ï¼ˆ=ãƒ•ã‚©ãƒ«ãƒ€ï¼‰å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®çŠ¶æ…‹ã‚‚æˆ»ã£ã¦ã—ã¾ã†ã®ã§ã€å–ã‚Šæ‰±ã„æ³¨æ„ï¼ï¼** $ git reset --hard ãƒ»resetã®ä½¿ç”¨ä¾‹ ã¾ãšã€logã‚³ãƒãƒ³ãƒ‰ã§ã€ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã‘ã‚‹ã‚³ãƒŸãƒƒãƒˆIDã‚’ç¢ºèªã€‚ $ git log commit f17f68e287b7d84318b4c49e133b2d1819f6c3db (HEAD -> master, 2019/Symfony2_Nyumon/master) Merge: 41cc21b f81c813 Author: hiroki-it Date: Wed Mar 20 22:56:32 2019 +0900 Merge remote-tracking branch \"refs/remotes/origin/master\" commit 41cc21bb53a8597270b5deae3259751df18bce81 Author: hiroki-it Date: Wed Mar 20 20:54:34 2019 +0900 add #0 xxxã•ã‚“ã®README_2ã‚’è¿½åŠ  commit f81c813a1ead9a968c109671e6d83934debcab2e Author: hiroki-it Date: Wed Mar 20 20:54:34 2019 +0900 add #0 xxxã•ã‚“ã®README_1ã‚’è¿½åŠ  æŒ‡å®šã®ã‚³ãƒŸãƒƒãƒˆã¾ã§å±¥æ­´ã‚’æˆ»ã™ã€‚ $ git reset --soft f81c813a1ead9a968c109671e6d83934debcab2e logã‚³ãƒãƒ³ãƒ‰ã§ã€æ­£ã—ãå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã€‚ $ git log commit f81c813a1ead9a968c109671e6d83934debcab2e (HEAD -> master) Author: Hiroki Hasegawa Date: Wed Mar 20 20:54:34 2019 +0900 add æ–°ã—ã„READMEã‚’è¿½åŠ  push --forceã§ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã®å¤‰æ›´ã‚’ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«å¼·åˆ¶çš„ã«åæ˜ ã€‚**ã€å¼·åˆ¶çš„ã«pushã—ãŸã€ã¨ã„ã†ãƒ­ã‚°ã‚‚ã€ãƒªãƒ¢ãƒ¼ãƒˆå´ã«ã¯æ®‹ã‚‰ãªã„ã€‚** $ git push --force Total 0 (delta 0), reused 0 (delta 0) To github.com:hiroki-it/Symfony2_Nyumon.git + f0d8b1a...f81c813 master -> master (forced update) rebase ãƒ»rebaseã¨ã¯ï¼ˆæ³¨æ„ç‚¹ã‚ã‚Šï¼‰ ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã„ã¦ã€ãƒ–ãƒ©ãƒ³ãƒã®æ´¾ç”Ÿå…ƒã‚’å¤‰æ›´ã€‚ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã«pushã—ãŸå¾Œã¯ä½¿ã£ã¦ã¯ãªã‚‰ãšã€ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã€‚ ãƒ»rebase --interactive æ´¾ç”Ÿå…ƒã‚’å¤‰æ›´ã™ã‚‹æ©Ÿèƒ½ã‚’å¿œç”¨ã—ã¦ã€éå»ã®ã‚³ãƒŸãƒƒãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¤‰æ›´ã€å‰Šé™¤ã€çµ±åˆãªã©ã‚’è¡Œã†ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å¤‰æ›´ï¼‰ï¼Š ã¾ãšã€logã‚³ãƒãƒ³ãƒ‰ã§ã€ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã‘ã‚‹ã‚³ãƒŸãƒƒãƒˆIDã‚’ç¢ºèªã€‚ $ git log commit f17f68e287b7d84318b4c49e133b2d1819f6c3db (HEAD -> master, 2019/Symfony2_Nyumon/master) Merge: 41cc21b f81c813 Author: Hiroki Hasegawa Date: Wed Mar 20 22:56:32 2019 +0900 Merge remote-tracking branch \"refs/remotes/origin/master\" commit 41cc21bb53a8597270b5deae3259751df18bce81 Author: Hiroki Hasegawa Date: Wed Mar 20 20:54:34 2019 +0900 add #0 xxxã•ã‚“ã®README_2ã‚’è¿½åŠ  commit f81c813a1ead9a968c109671e6d83934debcab2e Author: Hiroki Hasegawa Date: Wed Mar 20 20:54:34 2019 +0900 add #0 xxxã•ã‚“ã®README_1ã‚’è¿½åŠ  æŒ‡å®šã—ãŸå±¥æ­´ã®å‰Šé™¤ $ git rebase --interactive 41cc21bb53a8597270b5deae3259751df18bce81 ã¨ã™ã‚‹ã¨ã€ã‚¿ãƒ–ãŒè¡¨ç¤ºã•ã‚Œã€æŒ‡å®šã®ã‚³ãƒŸãƒƒãƒˆIDã®å±¥æ­´ãŒè¡¨ç¤ºã•ã‚Œã‚‹ pick b1b5c0f add #0 xxxxxxxxxx ã€æŒ¿å…¥ãƒ¢ãƒ¼ãƒ‰ã€ã«å¤‰æ›´ã—ã€ã“ã®ä¸€è¡Œã®pickã‚’editã«å¤‰æ›´ã€‚ãã®å¾Œã€ :w ã¨ã—ã¦ä¿å­˜ã€‚ãã®å¾Œã€ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ã€Ctrl+Cã€ã‚’æŠ¼ã—ã€ :qa! ã§çµ‚äº†ã€‚ commit --amendã«mã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤‰æ›´ã€‚ $ git commit --amend -m=\"\" rebase --continueã‚’å®Ÿè¡Œã—ã€å¤‰æ›´ã‚’åæ˜ ã•ã›ã‚‹ã€‚ $ git rebase --continue Successfully rebased and updated refs/heads/develop. pushã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€![rejected] develop -> develop (non-fast-forward)ã¨ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã®ã§ã€ $ git merge --allow-unrelated-histories ã§è§£æ±ºã—ã€pushã™ã‚‹ã€‚ ï¼Šã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆAuthoråã¨Commiteråã®å¤‰æ›´ï¼‰ï¼Š ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æŒ‡å®šã—ã¦ã€rebaseã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ $ git rebase --interactive 41cc21bb53a8597270b5deae3259751df18bce81 commit --amendã«reset-authorã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã¦ã€configã§è¨­å®šã—ãŸåå‰ã‚’Authoråã¨Comitteråã«é©ç”¨ã™ã‚‹ã€‚ $ git commit --amend --reset-author rebase --continueã‚’å®Ÿè¡Œã—ã€å¤‰æ›´ã‚’åæ˜ ã•ã›ã‚‹ã€‚ $ git rebase --continue Successfully rebased and updated refs/heads/develop. éå»ã®å…¨ã¦ã®ã‚³ãƒŸãƒƒãƒˆã«å¯¾ã—ã¦ã€Authoråã¨Committeråã‚’é©ç”¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚‚ã‚ã‚‹ã€‚ã—ã‹ã—ã€å±é™ºãªæ–¹æ³•ã§ã‚ã‚‹ãŸã‚ã€å€‹äººåˆ©ç”¨ã®ãƒªãƒã‚¸ãƒˆãƒªã®ã¿ã§ç”¨ã„ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¹ãã§ã‚ã‚‹ã€‚ #!/bin/bash git filter-branch -f --env-filter \" # Authoråã‹Committeråã®ã„ãšã‚Œã‹ãŒèª¤ã£ã¦ã„ã‚Œã°é©ç”¨ã—ã¾ã™ã€‚ if [ ${GIT_AUTHOR_NAME}=\"Hiroki-Hasegawa\" -o ${GIT_COMMITTER_NAME}=\"Hiroki-Hasegawa\" ] ; then export GIT_AUTHOR_NAME=\"hiroki-it\" export GIT_AUTHOR_EMAIL=\"example@gmail.com\" export GIT_COMMITTER_NAME=\"hiroki-it\" export GIT_COMMITTER_EMAIL=\"example@gmail.com\" fi\" ãƒ»rebase --onto ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã®æ´¾ç”Ÿå…ƒã‚’å¤‰æ›´ã€‚ $ git rebase --onto ãƒ»rebase --interactive --root ä¸€ç•ªå¤ã„ã€æœ€åˆã®å±¥æ­´ã‚’å‰Šé™¤ã€‚ ï¼ˆï¼‘ï¼‰å¤‰æ›´ã‚¿ãƒ–ã®è¡¨ç¤º $ git rebase --interactive --root ã¨ã™ã‚‹ã¨ã€æœ€åˆã®å±¥æ­´ãŒè¨˜è¿°ã•ã‚ŒãŸã‚¿ãƒ–ãŒè¡¨ç¤ºã•ã‚Œã‚‹ pick b1b5c0f add #0 xxxxxxxxxx ï¼ˆï¼’ï¼‰pick b1b5c0f add #0 xxxxxxxxxxã®è¡Œã‚’å‰Šé™¤ã—ã¦ä¿å­˜ã—ã€ã‚¿ãƒ–ã‚’é–‰ã˜ã€ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ã€Ctrl+Cã€ã‚’æŠ¼ã™ã€‚ :qa! ã“ã“ã§æœªçŸ¥ã®ã‚¨ãƒ©ãƒ¼ CONFLICT (modify/delete): README.md deleted in HEAD and modified in 37bee65... update #0 README.mdã«æœ¬ãƒ¬ãƒã‚¸ãƒˆãƒªã®ã‚¿ã‚¤ãƒˆãƒ«ã¨å¼•ç”¨ã‚’è¨˜è¼‰ ã—ãŸ. Version 37bee65... update #0 README.mdã«æœ¬ãƒ¬ãƒã‚¸ãƒˆãƒªã®ã‚¿ã‚¤ãƒˆãƒ«ã¨å¼•ç”¨ã‚’è¨˜è¼‰ã—ãŸ of README.md left in tree. error: could not apply 37bee65... update #0 README.mdã«æœ¬ãƒ¬ãƒã‚¸ãƒˆãƒªã®ã‚¿ã‚¤ãƒˆãƒ«ã¨å¼•ç”¨ã‚’è¨˜è¼‰ã—ãŸ Resolve all conflicts manually, mark them as resolved with \"git add/rm \", then run \"git rebase --continue\". You can instead skip this commit: run \"git rebase --skip\". To abort and get back to the state before \"git rebase\", run \"git rebase --abort\". Could not apply 37bee65... update #0 README.mdã«æœ¬ãƒ¬ãƒã‚¸ãƒˆãƒªã®ã‚¿ã‚¤ãƒˆãƒ«ã¨å¼•ç”¨ã‚’è¨˜è¼‰ã—ãŸ ãƒ»rebase --abort ã‚„ã‚Šã‹ã‘ã®rebaseã‚’å–ã‚Šæ¶ˆã—ã€‚ ä½œæ¥­ä¸­ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«ãŠã‘ã‚‹(master|REBASE-i)ãŒã€(master)ã«å¤‰æ›´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ã‚‚ç¢ºèªå¯èƒ½ã€‚ hasegawahiroki@Hiroki-Fujitsu MINGW64 /c/Projects/Symfony2_Nyumon $ git rebase --interactive hasegawahiroki@Hiroki-Fujitsu MINGW64 /c/Projects/Symfony2_Nyumon (master|REBASE-i) $ git rebase --abort hasegawahiroki@Hiroki-Fujitsu MINGW64 /c/Projects/Symfony2_Nyumon (master) $ pull ãƒ»ã‚³ãƒãƒ³ãƒ‰çµ„ã¿åˆã‚ã› å…¨ã¦ã®ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã‚’pullã™ã‚‹ã€‚ $ git branch -r \\ | grep -v \"\\->\" \\ | grep -v main \\ | while read remote; do git branch --track \"${remote#origin/}\" \"$remote\"; done $ git fetch --all $ git pull --all push ãƒ»push -u origin ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæˆã—ãŸãƒ–ãƒ©ãƒ³ãƒã‚’ã€ãƒªãƒ¢ãƒ¼ãƒˆã«pushã™ã‚‹ã€‚ã‚³ãƒŸãƒƒãƒˆã¯ç„¡ãã¦ã‚‚è‰¯ã„ã€‚ ãƒ»push origin :master ãƒˆãƒ©ã‚¦ãƒã‚³ãƒãƒ³ãƒ‰ ãƒ»push --delete origin ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã®ã‚¿ã‚°ã‚’å‰Šé™¤ã™ã‚‹ã€‚ $ git push --delete origin v1.0.0 ãªãŠã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚¿ã‚°ã¯åˆ¥ã«å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ $ git tag -d v1.0.0 ãƒ»push --tags ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚³ãƒŸãƒƒãƒˆã«ä»˜ä¸ã—ãŸã‚¿ã‚°ã‚’ãƒªãƒ¢ãƒ¼ãƒˆã«pushã™ã‚‹ã€‚ show-branch ä½œæ¥­ãƒ–ãƒ©ãƒ³ãƒã®æ´¾ç”Ÿå…ƒã«ãªã£ã¦ã„ã‚‹ãƒ–ãƒ©ãƒ³ãƒã‚’ç¢ºèªã€‚ $ git show-branch \\ | grep \"*\" \\ | grep -v \"$(git rev-parse --abbrev-ref HEAD)\" \\ | head -1 \\ | awk -F\"[]~^[]\" \"{print $2}\" filter-branch ãƒ»filter-branch -f --env-filter å…¨ã¦ã®ã‚³ãƒŸãƒƒãƒˆã®åå‰ã¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä¸Šæ›¸ãã™ã‚‹ã€‚ $ git filter-branch -f --env-filter \\ \"GIT_AUTHOR_NAME=\"hiroki-it\"; \\ GIT_AUTHOR_EMAIL=\"example@gmail.com\"; \\ GIT_COMMITTER_NAME=\"hiroki-it\"; \\ GIT_COMMITTER_EMAIL=\"example@gmail.com\";\" \\ HEAD ãƒ»filter-branch -f --tree-filter å…¨ã¦ã®ã‚³ãƒŸãƒƒãƒˆã«å¯¾ã—ã¦ã€æŒ‡å®šã—ãŸå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ï¼Šä¾‹ï¼Š å…¨ã¦ã®ã‚³ãƒŸãƒƒãƒˆã«å¯¾ã—ã¦ã€ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã™ã‚‹å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚åŠ ãˆã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã«å¯¾ã—ã¦ã‚¬ãƒ¼ãƒ™ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰å®Œå…¨ã«å‰Šé™¤ã§ãã‚‹ã€‚ $ git filter-branch -f --tree-filter \\ 'rm -f ' HEAD # ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ $ git gc --aggressive --prune=now "},"public/statistic_analysis/statistic_analysis_r.html":{"url":"public/statistic_analysis/statistic_analysis_r.html","title":"ğŸ“– ï¸Rè¨€èª","keywords":"","body":"çµ±è¨ˆè§£æ ã¯ã˜ã‚ã« æœ¬ã‚µã‚¤ãƒˆã«ã¤ãã¾ã—ã¦ã€ä»¥ä¸‹ã‚’ã”èªè­˜ã®ã»ã©å®œã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ å‚è€ƒï¼šhttps://hiroki-it.github.io/tech-notebook-gitbook/ ãƒ‡ãƒ¼ã‚¿è§£æã§æ°—ã‚’ã¤ã‘ã‚‹ã“ã¨ ãƒ‡ãƒ¼ã‚¿åˆ†æã«ã‚ˆã£ã¦ã€ä½•ã‚’æ˜ã‚‰ã‹ã«ã—ãŸã„ã®ã‹ã€‚ æ˜ã‚‰ã‹ã«ã™ã‚‹ã“ã¨ã®ãŸã‚ã«ã€ã©ã®ãƒ‡ãƒ¼ã‚¿åˆ†æãŒå¿…è¦ãªã®ã‹ã€‚ å¿…è¦ãªãƒ‡ãƒ¼ã‚¿åˆ†æã®ãŸã‚ã«ã€ã©ã‚“ãªå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã‹ã€‚ 01. ç›¸é–¢åˆ†æ ãƒ‡ãƒ¼ã‚¿ã«ã€ã©ã®ç¨‹åº¦ã®ç›´ç·šçš„é–¢ä¿‚ãŒã‚ã‚‹ã‹ã‚’æ¤œå‡ºã™ã‚‹åˆ†ææ‰‹æ³•ã€‚å›å¸°åˆ†æã‚’è¡Œã†ã‹å¦ã‹ã®åˆ¤æ–­ææ–™ã«ãªã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã€‚ sample 02. ç·šå½¢å›å¸°åˆ†æ å› æœé–¢ä¿‚ãŒã‚ã‚Šãã†ãªãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€æ¨ªè»¸ã‚’åŸå› ã€ã¾ãŸç¸¦è»¸ã‚’çµæœã¨ã—ã€æœ€ã‚‚å½“ã¦ã¯ã¾ã‚Šã®è‰¯ã„ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã‚’æ¨å®šã™ã‚‹åˆ†ææ‰‹æ³•ã€‚ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ãŒé«˜ã‘ã‚Œã°å› æœé–¢ä¿‚ã®è¨¼æ˜ã«ãªã‚Šã€ã¾ãŸãƒ¢ãƒ‡ãƒ«ã«åŸå› ã‚’ä»£å…¥ã™ã‚‹ã“ã¨ã§çµæœã‚’äºˆæ¸¬ã§ãã‚‹ã€‚ å˜å›å¸°åˆ†æ åŸå› ã¨çµæœãŒä¸€ã¤ãšã¤ã¨ä»®å®šã—ãŸæ™‚ã«ã€æœ€ã‚‚å½“ã¦ã¯ã¾ã‚Šã®è‰¯ã„ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã‚’æ¨å®šã§ãã‚‹ã€‚ ãƒ»å›å¸°æ–¹ç¨‹å¼ ï¼Šå®Ÿè£…ä¾‹ï¼Š # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã€‚ sample |t|) # (Intercept) 1.099e+01 2.405e+00 4.571 3.11e-05 *** # ç´”åºƒå‘Š 2.239e-05 2.927e-05 0.765 0.448 # // ç´”åºƒå‘Šã®å›å¸°ä¿‚æ•°ã®på€¤ > 0.05 ã‚ˆã‚Šã€å› æœé–¢ä¿‚ãŒãªã„å¯èƒ½æ€§ã€‚ é‡å›å¸°åˆ†æ åŸå› ãŒäºŒã¤ä»¥ä¸Šã§çµæœãŒä¸€ã¤ã¨ä»®å®šã—ãŸæ™‚ã«ã€æœ€ã‚‚å½“ã¦ã¯ã¾ã‚Šã®è‰¯ã„ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã‚’æ¨å®šã§ãã‚‹ã€‚ãŸã ã—ã€ã‚°ãƒ©ãƒ•ã§ã¯ã€ãƒ¢ãƒ‡ãƒ«ã¯å¹³é¢ã§è¡¨ã•ã‚Œã‚‹ã€‚ ãƒ»å›å¸°æ–¹ç¨‹å¼ ï¼Šå®Ÿè£…ä¾‹ï¼Š # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã€‚ sample |t|) # (Intercept) 8.857 1.007 8.797 1.69e-11 *** # days.æœˆæ›œæ—¥ 5.286 1.744 3.031 0.003957 ** # days.ç«æ›œæ—¥ 4.893 1.670 2.930 0.005212 ** # days.æ°´æ›œæ—¥ 6.143 1.670 3.679 0.000601 *** # days.æœ¨æ›œæ—¥ 5.893 1.670 3.529 0.000944 *** # days.é‡‘æ›œæ—¥ 4.393 1.670 2.631 0.011479 * # // æœˆã€æ°´ã€é‡‘ã®å›å¸°ä¿‚æ•°ã®på€¤ 02-02. éç·šå½¢å›å¸°åˆ†æ å› æœé–¢ä¿‚ãŒã‚ã‚Šãã†ãªãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€æ¨ªè»¸ã‚’åŸå› ã€ã¾ãŸç¸¦è»¸ã‚’çµæœã¨ã—ã€æœ€ã‚‚å½“ã¦ã¯ã¾ã‚Šã®è‰¯ã„éç·šå½¢ãƒ¢ãƒ‡ãƒ«ã‚’æ¨å®šã™ã‚‹åˆ†ææ‰‹æ³•ã€‚ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ãŒé«˜ã‘ã‚Œã°å› æœé–¢ä¿‚ã®è¨¼æ˜ã«ãªã‚Šã€ã¾ãŸãƒ¢ãƒ‡ãƒ«ã«åŸå› ã‚’ä»£å…¥ã™ã‚‹ã“ã¨ã§çµæœã‚’äºˆæ¸¬ã§ãã‚‹ã€‚éç·šå½¢ãƒ¢ãƒ‡ãƒ«ã‚’æ¨å®šã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ¢ãƒ‡ãƒ«ã‚’ä¸€èˆ¬åŒ–ã—ã€ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°åˆ†æ èª¬æ˜å¤‰æ•°ãŒè³ªçš„å¤‰æ•°ã®å ´åˆã€æœ€ã‚‚å½“ã¦ã¯ã¾ã‚Šã®è‰¯ã„éç·šå½¢ãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯åˆ†å¸ƒï¼‰ã‚’æ¨å®šã™ã‚‹ã€‚ ãƒ»å›å¸°æ–¹ç¨‹å¼ ï¼Šå®Ÿè£…ä¾‹ï¼Š # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã€‚ sample 03. æ±ºå®šæœ¨åˆ†æ ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€æœ€ã‚‚å½“ã¦ã¯ã¾ã‚Šã®è‰¯ã„æ±ºå®šæœ¨ãƒ¢ãƒ‡ãƒ«ã‚’æ¨å®šã™ã‚‹åˆ†ææ‰‹æ³•ã€‚ åˆ†é¡æœ¨åˆ†æ æ±ºå®šæœ¨ãƒ¢ãƒ‡ãƒ«ã‚’åˆ†é¡ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ç”¨ã„ã‚‹å ´åˆã®æ±ºå®šæœ¨åˆ†æã€‚ ãƒ»å›³è§£ä¾‹ èµ¤ã„ç‚¹ï¼šè¢«é¨“è€…ãŒæš‘ã„ã¨æ„Ÿã˜ãŸæ—¥ é’ã„ç‚¹ï¼šè¢«é¨“è€…ãŒæš‘ããªã„ã¨æ„Ÿã˜ãŸæ—¥ ï¼Šå®Ÿè£…ä¾‹ï¼Š # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã€‚ sample 04. éšå±¤ã‚¯ãƒ©ã‚¹ã‚¿åˆ†æ ãƒ‡ãƒ¼ã‚¿ã‚’ã€ä¼¼ã¦ã„ã‚‹é †ã«éšå±¤çš„ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼ˆã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ï¼‰ã—ã¦ã„ãåˆ†ææ‰‹æ³•ã€‚ãƒ‡ãƒ¼ã‚¿é–“ã®åŒä¸€æ€§ã‚’æ˜ã‚‰ã‹ã«ã§ãã‚‹ã€‚ ï¼Šå®Ÿè£…ä¾‹ï¼Š # ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã€‚ sample1 05. ã‚°ãƒ©ãƒ•ç”Ÿæˆé–¢æ•° ggplot() ggplot()ï¼šã‚°ãƒ©ãƒ•ã®ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’æº–å‚™ geom_XXX()ï¼šã‚°ãƒ©ãƒ•ã‚’ãƒ—ãƒ­ãƒƒãƒˆ theme()ï¼šã‚°ãƒ©ãƒ•ã‚’è¿½åŠ åŠ å·¥ "}}